(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const o of l.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerPolicy&&(l.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?l.credentials="include":i.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(i){if(i.ep)return;i.ep=!0;const l=r(i);fetch(i.href,l)}})();var td={exports:{}},qc={};var Rp;function xS(){if(Rp)return qc;Rp=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function r(n,i,l){var o=null;if(l!==void 0&&(o=""+l),i.key!==void 0&&(o=""+i.key),"key"in i){l={};for(var u in i)u!=="key"&&(l[u]=i[u])}else l=i;return i=l.ref,{$$typeof:e,type:n,key:o,ref:i!==void 0?i:null,props:l}}return qc.Fragment=t,qc.jsx=r,qc.jsxs=r,qc}var Dp;function pS(){return Dp||(Dp=1,td.exports=xS()),td.exports}var b=pS(),rd={exports:{}},ut={};var Fp;function vS(){if(Fp)return ut;Fp=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),o=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),p=Symbol.for("react.activity"),v=Symbol.iterator;function _(I){return I===null||typeof I!="object"?null:(I=v&&I[v]||I["@@iterator"],typeof I=="function"?I:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,S={};function k(I,A,z){this.props=I,this.context=A,this.refs=S,this.updater=z||w}k.prototype.isReactComponent={},k.prototype.setState=function(I,A){if(typeof I!="object"&&typeof I!="function"&&I!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,I,A,"setState")},k.prototype.forceUpdate=function(I){this.updater.enqueueForceUpdate(this,I,"forceUpdate")};function R(){}R.prototype=k.prototype;function T(I,A,z){this.props=I,this.context=A,this.refs=S,this.updater=z||w}var B=T.prototype=new R;B.constructor=T,y(B,k.prototype),B.isPureReactComponent=!0;var X=Array.isArray;function M(){}var N={H:null,A:null,T:null,S:null},Z=Object.prototype.hasOwnProperty;function q(I,A,z){var U=z.ref;return{$$typeof:e,type:I,key:A,ref:U!==void 0?U:null,props:z}}function he(I,A){return q(I.type,A,I.props)}function Y(I){return typeof I=="object"&&I!==null&&I.$$typeof===e}function Q(I){var A={"=":"=0",":":"=2"};return"$"+I.replace(/[=:]/g,function(z){return A[z]})}var pe=/\/+/g;function Ce(I,A){return typeof I=="object"&&I!==null&&I.key!=null?Q(""+I.key):A.toString(36)}function _e(I){switch(I.status){case"fulfilled":return I.value;case"rejected":throw I.reason;default:switch(typeof I.status=="string"?I.then(M,M):(I.status="pending",I.then(function(A){I.status==="pending"&&(I.status="fulfilled",I.value=A)},function(A){I.status==="pending"&&(I.status="rejected",I.reason=A)})),I.status){case"fulfilled":return I.value;case"rejected":throw I.reason}}throw I}function te(I,A,z,U,G){var ne=typeof I;(ne==="undefined"||ne==="boolean")&&(I=null);var we=!1;if(I===null)we=!0;else switch(ne){case"bigint":case"string":case"number":we=!0;break;case"object":switch(I.$$typeof){case e:case t:we=!0;break;case g:return we=I._init,te(we(I._payload),A,z,U,G)}}if(we)return G=G(I),we=U===""?"."+Ce(I,0):U,X(G)?(z="",we!=null&&(z=we.replace(pe,"$&/")+"/"),te(G,A,z,"",function(Ne){return Ne})):G!=null&&(Y(G)&&(G=he(G,z+(G.key==null||I&&I.key===G.key?"":(""+G.key).replace(pe,"$&/")+"/")+we)),A.push(G)),1;we=0;var Te=U===""?".":U+":";if(X(I))for(var Se=0;Se<I.length;Se++)U=I[Se],ne=Te+Ce(U,Se),we+=te(U,A,z,ne,G);else if(Se=_(I),typeof Se=="function")for(I=Se.call(I),Se=0;!(U=I.next()).done;)U=U.value,ne=Te+Ce(U,Se++),we+=te(U,A,z,ne,G);else if(ne==="object"){if(typeof I.then=="function")return te(_e(I),A,z,U,G);throw A=String(I),Error("Objects are not valid as a React child (found: "+(A==="[object Object]"?"object with keys {"+Object.keys(I).join(", ")+"}":A)+"). If you meant to render a collection of children, use an array instead.")}return we}function se(I,A,z){if(I==null)return I;var U=[],G=0;return te(I,U,"","",function(ne){return A.call(z,ne,G++)}),U}function ge(I){if(I._status===-1){var A=I._result;A=A(),A.then(function(z){(I._status===0||I._status===-1)&&(I._status=1,I._result=z)},function(z){(I._status===0||I._status===-1)&&(I._status=2,I._result=z)}),I._status===-1&&(I._status=0,I._result=A)}if(I._status===1)return I._result.default;throw I._result}var J=typeof reportError=="function"?reportError:function(I){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var A=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof I=="object"&&I!==null&&typeof I.message=="string"?String(I.message):String(I),error:I});if(!window.dispatchEvent(A))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",I);return}console.error(I)},Oe={map:se,forEach:function(I,A,z){se(I,function(){A.apply(this,arguments)},z)},count:function(I){var A=0;return se(I,function(){A++}),A},toArray:function(I){return se(I,function(A){return A})||[]},only:function(I){if(!Y(I))throw Error("React.Children.only expected to receive a single React element child.");return I}};return ut.Activity=p,ut.Children=Oe,ut.Component=k,ut.Fragment=r,ut.Profiler=i,ut.PureComponent=T,ut.StrictMode=n,ut.Suspense=h,ut.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=N,ut.__COMPILER_RUNTIME={__proto__:null,c:function(I){return N.H.useMemoCache(I)}},ut.cache=function(I){return function(){return I.apply(null,arguments)}},ut.cacheSignal=function(){return null},ut.cloneElement=function(I,A,z){if(I==null)throw Error("The argument must be a React element, but you passed "+I+".");var U=y({},I.props),G=I.key;if(A!=null)for(ne in A.key!==void 0&&(G=""+A.key),A)!Z.call(A,ne)||ne==="key"||ne==="__self"||ne==="__source"||ne==="ref"&&A.ref===void 0||(U[ne]=A[ne]);var ne=arguments.length-2;if(ne===1)U.children=z;else if(1<ne){for(var we=Array(ne),Te=0;Te<ne;Te++)we[Te]=arguments[Te+2];U.children=we}return q(I.type,G,U)},ut.createContext=function(I){return I={$$typeof:o,_currentValue:I,_currentValue2:I,_threadCount:0,Provider:null,Consumer:null},I.Provider=I,I.Consumer={$$typeof:l,_context:I},I},ut.createElement=function(I,A,z){var U,G={},ne=null;if(A!=null)for(U in A.key!==void 0&&(ne=""+A.key),A)Z.call(A,U)&&U!=="key"&&U!=="__self"&&U!=="__source"&&(G[U]=A[U]);var we=arguments.length-2;if(we===1)G.children=z;else if(1<we){for(var Te=Array(we),Se=0;Se<we;Se++)Te[Se]=arguments[Se+2];G.children=Te}if(I&&I.defaultProps)for(U in we=I.defaultProps,we)G[U]===void 0&&(G[U]=we[U]);return q(I,ne,G)},ut.createRef=function(){return{current:null}},ut.forwardRef=function(I){return{$$typeof:u,render:I}},ut.isValidElement=Y,ut.lazy=function(I){return{$$typeof:g,_payload:{_status:-1,_result:I},_init:ge}},ut.memo=function(I,A){return{$$typeof:d,type:I,compare:A===void 0?null:A}},ut.startTransition=function(I){var A=N.T,z={};N.T=z;try{var U=I(),G=N.S;G!==null&&G(z,U),typeof U=="object"&&U!==null&&typeof U.then=="function"&&U.then(M,J)}catch(ne){J(ne)}finally{A!==null&&z.types!==null&&(A.types=z.types),N.T=A}},ut.unstable_useCacheRefresh=function(){return N.H.useCacheRefresh()},ut.use=function(I){return N.H.use(I)},ut.useActionState=function(I,A,z){return N.H.useActionState(I,A,z)},ut.useCallback=function(I,A){return N.H.useCallback(I,A)},ut.useContext=function(I){return N.H.useContext(I)},ut.useDebugValue=function(){},ut.useDeferredValue=function(I,A){return N.H.useDeferredValue(I,A)},ut.useEffect=function(I,A){return N.H.useEffect(I,A)},ut.useEffectEvent=function(I){return N.H.useEffectEvent(I)},ut.useId=function(){return N.H.useId()},ut.useImperativeHandle=function(I,A,z){return N.H.useImperativeHandle(I,A,z)},ut.useInsertionEffect=function(I,A){return N.H.useInsertionEffect(I,A)},ut.useLayoutEffect=function(I,A){return N.H.useLayoutEffect(I,A)},ut.useMemo=function(I,A){return N.H.useMemo(I,A)},ut.useOptimistic=function(I,A){return N.H.useOptimistic(I,A)},ut.useReducer=function(I,A,z){return N.H.useReducer(I,A,z)},ut.useRef=function(I){return N.H.useRef(I)},ut.useState=function(I){return N.H.useState(I)},ut.useSyncExternalStore=function(I,A,z){return N.H.useSyncExternalStore(I,A,z)},ut.useTransition=function(){return N.H.useTransition()},ut.version="19.2.3",ut}var Mp;function em(){return Mp||(Mp=1,rd.exports=vS()),rd.exports}var Xe=em(),ad={exports:{}},Xc={},nd={exports:{}},id={};var Lp;function yS(){return Lp||(Lp=1,(function(e){function t(te,se){var ge=te.length;te.push(se);e:for(;0<ge;){var J=ge-1>>>1,Oe=te[J];if(0<i(Oe,se))te[J]=se,te[ge]=Oe,ge=J;else break e}}function r(te){return te.length===0?null:te[0]}function n(te){if(te.length===0)return null;var se=te[0],ge=te.pop();if(ge!==se){te[0]=ge;e:for(var J=0,Oe=te.length,I=Oe>>>1;J<I;){var A=2*(J+1)-1,z=te[A],U=A+1,G=te[U];if(0>i(z,ge))U<Oe&&0>i(G,z)?(te[J]=G,te[U]=ge,J=U):(te[J]=z,te[A]=ge,J=A);else if(U<Oe&&0>i(G,ge))te[J]=G,te[U]=ge,J=U;else break e}}return se}function i(te,se){var ge=te.sortIndex-se.sortIndex;return ge!==0?ge:te.id-se.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var o=Date,u=o.now();e.unstable_now=function(){return o.now()-u}}var h=[],d=[],g=1,p=null,v=3,_=!1,w=!1,y=!1,S=!1,k=typeof setTimeout=="function"?setTimeout:null,R=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;function B(te){for(var se=r(d);se!==null;){if(se.callback===null)n(d);else if(se.startTime<=te)n(d),se.sortIndex=se.expirationTime,t(h,se);else break;se=r(d)}}function X(te){if(y=!1,B(te),!w)if(r(h)!==null)w=!0,M||(M=!0,Q());else{var se=r(d);se!==null&&_e(X,se.startTime-te)}}var M=!1,N=-1,Z=5,q=-1;function he(){return S?!0:!(e.unstable_now()-q<Z)}function Y(){if(S=!1,M){var te=e.unstable_now();q=te;var se=!0;try{e:{w=!1,y&&(y=!1,R(N),N=-1),_=!0;var ge=v;try{t:{for(B(te),p=r(h);p!==null&&!(p.expirationTime>te&&he());){var J=p.callback;if(typeof J=="function"){p.callback=null,v=p.priorityLevel;var Oe=J(p.expirationTime<=te);if(te=e.unstable_now(),typeof Oe=="function"){p.callback=Oe,B(te),se=!0;break t}p===r(h)&&n(h),B(te)}else n(h);p=r(h)}if(p!==null)se=!0;else{var I=r(d);I!==null&&_e(X,I.startTime-te),se=!1}}break e}finally{p=null,v=ge,_=!1}se=void 0}}finally{se?Q():M=!1}}}var Q;if(typeof T=="function")Q=function(){T(Y)};else if(typeof MessageChannel<"u"){var pe=new MessageChannel,Ce=pe.port2;pe.port1.onmessage=Y,Q=function(){Ce.postMessage(null)}}else Q=function(){k(Y,0)};function _e(te,se){N=k(function(){te(e.unstable_now())},se)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(te){te.callback=null},e.unstable_forceFrameRate=function(te){0>te||125<te?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Z=0<te?Math.floor(1e3/te):5},e.unstable_getCurrentPriorityLevel=function(){return v},e.unstable_next=function(te){switch(v){case 1:case 2:case 3:var se=3;break;default:se=v}var ge=v;v=se;try{return te()}finally{v=ge}},e.unstable_requestPaint=function(){S=!0},e.unstable_runWithPriority=function(te,se){switch(te){case 1:case 2:case 3:case 4:case 5:break;default:te=3}var ge=v;v=te;try{return se()}finally{v=ge}},e.unstable_scheduleCallback=function(te,se,ge){var J=e.unstable_now();switch(typeof ge=="object"&&ge!==null?(ge=ge.delay,ge=typeof ge=="number"&&0<ge?J+ge:J):ge=J,te){case 1:var Oe=-1;break;case 2:Oe=250;break;case 5:Oe=1073741823;break;case 4:Oe=1e4;break;default:Oe=5e3}return Oe=ge+Oe,te={id:g++,callback:se,priorityLevel:te,startTime:ge,expirationTime:Oe,sortIndex:-1},ge>J?(te.sortIndex=ge,t(d,te),r(h)===null&&te===r(d)&&(y?(R(N),N=-1):y=!0,_e(X,ge-J))):(te.sortIndex=Oe,t(h,te),w||_||(w=!0,M||(M=!0,Q()))),te},e.unstable_shouldYield=he,e.unstable_wrapCallback=function(te){var se=v;return function(){var ge=v;v=se;try{return te.apply(this,arguments)}finally{v=ge}}}})(id)),id}var Bp;function _S(){return Bp||(Bp=1,nd.exports=yS()),nd.exports}var sd={exports:{}},Zr={};var Ip;function wS(){if(Ip)return Zr;Ip=1;var e=em();function t(h){var d="https://react.dev/errors/"+h;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)d+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+h+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var n={d:{f:r,r:function(){throw Error(t(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},i=Symbol.for("react.portal");function l(h,d,g){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:p==null?null:""+p,children:h,containerInfo:d,implementation:g}}var o=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(h,d){if(h==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return Zr.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,Zr.createPortal=function(h,d){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(t(299));return l(h,d,null,g)},Zr.flushSync=function(h){var d=o.T,g=n.p;try{if(o.T=null,n.p=2,h)return h()}finally{o.T=d,n.p=g,n.d.f()}},Zr.preconnect=function(h,d){typeof h=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,n.d.C(h,d))},Zr.prefetchDNS=function(h){typeof h=="string"&&n.d.D(h)},Zr.preinit=function(h,d){if(typeof h=="string"&&d&&typeof d.as=="string"){var g=d.as,p=u(g,d.crossOrigin),v=typeof d.integrity=="string"?d.integrity:void 0,_=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;g==="style"?n.d.S(h,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:p,integrity:v,fetchPriority:_}):g==="script"&&n.d.X(h,{crossOrigin:p,integrity:v,fetchPriority:_,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},Zr.preinitModule=function(h,d){if(typeof h=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var g=u(d.as,d.crossOrigin);n.d.M(h,{crossOrigin:g,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&n.d.M(h)},Zr.preload=function(h,d){if(typeof h=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var g=d.as,p=u(g,d.crossOrigin);n.d.L(h,g,{crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},Zr.preloadModule=function(h,d){if(typeof h=="string")if(d){var g=u(d.as,d.crossOrigin);n.d.m(h,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:g,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else n.d.m(h)},Zr.requestFormReset=function(h){n.d.r(h)},Zr.unstable_batchedUpdates=function(h,d){return h(d)},Zr.useFormState=function(h,d,g){return o.H.useFormState(h,d,g)},Zr.useFormStatus=function(){return o.H.useHostTransitionStatus()},Zr.version="19.2.3",Zr}var Up;function bS(){if(Up)return sd.exports;Up=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),sd.exports=wS(),sd.exports}var jp;function SS(){if(jp)return Xc;jp=1;var e=_S(),t=em(),r=bS();function n(a){var s="https://react.dev/errors/"+a;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)s+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+a+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function l(a){var s=a,c=a;if(a.alternate)for(;s.return;)s=s.return;else{a=s;do s=a,(s.flags&4098)!==0&&(c=s.return),a=s.return;while(a)}return s.tag===3?c:null}function o(a){if(a.tag===13){var s=a.memoizedState;if(s===null&&(a=a.alternate,a!==null&&(s=a.memoizedState)),s!==null)return s.dehydrated}return null}function u(a){if(a.tag===31){var s=a.memoizedState;if(s===null&&(a=a.alternate,a!==null&&(s=a.memoizedState)),s!==null)return s.dehydrated}return null}function h(a){if(l(a)!==a)throw Error(n(188))}function d(a){var s=a.alternate;if(!s){if(s=l(a),s===null)throw Error(n(188));return s!==a?null:a}for(var c=a,f=s;;){var m=c.return;if(m===null)break;var x=m.alternate;if(x===null){if(f=m.return,f!==null){c=f;continue}break}if(m.child===x.child){for(x=m.child;x;){if(x===c)return h(m),a;if(x===f)return h(m),s;x=x.sibling}throw Error(n(188))}if(c.return!==f.return)c=m,f=x;else{for(var E=!1,O=m.child;O;){if(O===c){E=!0,c=m,f=x;break}if(O===f){E=!0,f=m,c=x;break}O=O.sibling}if(!E){for(O=x.child;O;){if(O===c){E=!0,c=x,f=m;break}if(O===f){E=!0,f=x,c=m;break}O=O.sibling}if(!E)throw Error(n(189))}}if(c.alternate!==f)throw Error(n(190))}if(c.tag!==3)throw Error(n(188));return c.stateNode.current===c?a:s}function g(a){var s=a.tag;if(s===5||s===26||s===27||s===6)return a;for(a=a.child;a!==null;){if(s=g(a),s!==null)return s;a=a.sibling}return null}var p=Object.assign,v=Symbol.for("react.element"),_=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),y=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),k=Symbol.for("react.profiler"),R=Symbol.for("react.consumer"),T=Symbol.for("react.context"),B=Symbol.for("react.forward_ref"),X=Symbol.for("react.suspense"),M=Symbol.for("react.suspense_list"),N=Symbol.for("react.memo"),Z=Symbol.for("react.lazy"),q=Symbol.for("react.activity"),he=Symbol.for("react.memo_cache_sentinel"),Y=Symbol.iterator;function Q(a){return a===null||typeof a!="object"?null:(a=Y&&a[Y]||a["@@iterator"],typeof a=="function"?a:null)}var pe=Symbol.for("react.client.reference");function Ce(a){if(a==null)return null;if(typeof a=="function")return a.$$typeof===pe?null:a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case y:return"Fragment";case k:return"Profiler";case S:return"StrictMode";case X:return"Suspense";case M:return"SuspenseList";case q:return"Activity"}if(typeof a=="object")switch(a.$$typeof){case w:return"Portal";case T:return a.displayName||"Context";case R:return(a._context.displayName||"Context")+".Consumer";case B:var s=a.render;return a=a.displayName,a||(a=s.displayName||s.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case N:return s=a.displayName||null,s!==null?s:Ce(a.type)||"Memo";case Z:s=a._payload,a=a._init;try{return Ce(a(s))}catch{}}return null}var _e=Array.isArray,te=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,se=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ge={pending:!1,data:null,method:null,action:null},J=[],Oe=-1;function I(a){return{current:a}}function A(a){0>Oe||(a.current=J[Oe],J[Oe]=null,Oe--)}function z(a,s){Oe++,J[Oe]=a.current,a.current=s}var U=I(null),G=I(null),ne=I(null),we=I(null);function Te(a,s){switch(z(ne,s),z(G,a),z(U,null),s.nodeType){case 9:case 11:a=(a=s.documentElement)&&(a=a.namespaceURI)?ep(a):0;break;default:if(a=s.tagName,s=s.namespaceURI)s=ep(s),a=tp(s,a);else switch(a){case"svg":a=1;break;case"math":a=2;break;default:a=0}}A(U),z(U,a)}function Se(){A(U),A(G),A(ne)}function Ne(a){a.memoizedState!==null&&z(we,a);var s=U.current,c=tp(s,a.type);s!==c&&(z(G,a),z(U,c))}function ot(a){G.current===a&&(A(U),A(G)),we.current===a&&(A(we),Hc._currentValue=ge)}var V,Nt;function lt(a){if(V===void 0)try{throw Error()}catch(c){var s=c.stack.trim().match(/\n( *(at )?)/);V=s&&s[1]||"",Nt=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+V+a+Nt}var Tt=!1;function ft(a,s){if(!a||Tt)return"";Tt=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var f={DetermineComponentFrameRoot:function(){try{if(s){var Ee=function(){throw Error()};if(Object.defineProperty(Ee.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ee,[])}catch(me){var de=me}Reflect.construct(a,[],Ee)}else{try{Ee.call()}catch(me){de=me}a.call(Ee.prototype)}}else{try{throw Error()}catch(me){de=me}(Ee=a())&&typeof Ee.catch=="function"&&Ee.catch(function(){})}}catch(me){if(me&&de&&typeof me.stack=="string")return[me.stack,de.stack]}return[null,null]}};f.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(f.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(f.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var x=f.DetermineComponentFrameRoot(),E=x[0],O=x[1];if(E&&O){var K=E.split(`
`),le=O.split(`
`);for(m=f=0;f<K.length&&!K[f].includes("DetermineComponentFrameRoot");)f++;for(;m<le.length&&!le[m].includes("DetermineComponentFrameRoot");)m++;if(f===K.length||m===le.length)for(f=K.length-1,m=le.length-1;1<=f&&0<=m&&K[f]!==le[m];)m--;for(;1<=f&&0<=m;f--,m--)if(K[f]!==le[m]){if(f!==1||m!==1)do if(f--,m--,0>m||K[f]!==le[m]){var ye=`
`+K[f].replace(" at new "," at ");return a.displayName&&ye.includes("<anonymous>")&&(ye=ye.replace("<anonymous>",a.displayName)),ye}while(1<=f&&0<=m);break}}}finally{Tt=!1,Error.prepareStackTrace=c}return(c=a?a.displayName||a.name:"")?lt(c):""}function je(a,s){switch(a.tag){case 26:case 27:case 5:return lt(a.type);case 16:return lt("Lazy");case 13:return a.child!==s&&s!==null?lt("Suspense Fallback"):lt("Suspense");case 19:return lt("SuspenseList");case 0:case 15:return ft(a.type,!1);case 11:return ft(a.type.render,!1);case 1:return ft(a.type,!0);case 31:return lt("Activity");default:return""}}function zt(a){try{var s="",c=null;do s+=je(a,c),c=a,a=a.return;while(a);return s}catch(f){return`
Error generating stack: `+f.message+`
`+f.stack}}var gr=Object.prototype.hasOwnProperty,Kr=e.unstable_scheduleCallback,Fr=e.unstable_cancelCallback,Ga=e.unstable_shouldYield,da=e.unstable_requestPaint,_t=e.unstable_now,Aa=e.unstable_getCurrentPriorityLevel,Yr=e.unstable_ImmediatePriority,Tn=e.unstable_UserBlockingPriority,Mt=e.unstable_NormalPriority,Jr=e.unstable_LowPriority,ht=e.unstable_IdlePriority,Kt=e.log,Qr=e.unstable_setDisableYieldValue,qt=null,ar=null;function Ca(a){if(typeof Kt=="function"&&Qr(a),ar&&typeof ar.setStrictMode=="function")try{ar.setStrictMode(qt,a)}catch{}}var jr=Math.clz32?Math.clz32:Vs,tc=Math.log,Hs=Math.LN2;function Vs(a){return a>>>=0,a===0?32:31-(tc(a)/Hs|0)|0}var In=256,mi=262144,qa=4194304;function ma(a){var s=a&42;if(s!==0)return s;switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return a&261888;case 262144:case 524288:case 1048576:case 2097152:return a&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return a&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return a}}function Xa(a,s,c){var f=a.pendingLanes;if(f===0)return 0;var m=0,x=a.suspendedLanes,E=a.pingedLanes;a=a.warmLanes;var O=f&134217727;return O!==0?(f=O&~x,f!==0?m=ma(f):(E&=O,E!==0?m=ma(E):c||(c=O&~a,c!==0&&(m=ma(c))))):(O=f&~x,O!==0?m=ma(O):E!==0?m=ma(E):c||(c=f&~a,c!==0&&(m=ma(c)))),m===0?0:s!==0&&s!==m&&(s&x)===0&&(x=m&-m,c=s&-s,x>=c||x===32&&(c&4194048)!==0)?s:m}function Un(a,s){return(a.pendingLanes&~(a.suspendedLanes&~a.pingedLanes)&s)===0}function rc(a,s){switch(a){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function gi(){var a=qa;return qa<<=1,(qa&62914560)===0&&(qa=4194304),a}function Na(a){for(var s=[],c=0;31>c;c++)s.push(a);return s}function jn(a,s){a.pendingLanes|=s,s!==268435456&&(a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0)}function ac(a,s,c,f,m,x){var E=a.pendingLanes;a.pendingLanes=c,a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0,a.expiredLanes&=c,a.entangledLanes&=c,a.errorRecoveryDisabledLanes&=c,a.shellSuspendCounter=0;var O=a.entanglements,K=a.expirationTimes,le=a.hiddenUpdates;for(c=E&~c;0<c;){var ye=31-jr(c),Ee=1<<ye;O[ye]=0,K[ye]=-1;var de=le[ye];if(de!==null)for(le[ye]=null,ye=0;ye<de.length;ye++){var me=de[ye];me!==null&&(me.lane&=-536870913)}c&=~Ee}f!==0&&$s(a,f,0),x!==0&&m===0&&a.tag!==0&&(a.suspendedLanes|=x&~(E&~s))}function $s(a,s,c){a.pendingLanes|=s,a.suspendedLanes&=~s;var f=31-jr(s);a.entangledLanes|=s,a.entanglements[f]=a.entanglements[f]|1073741824|c&261930}function kn(a,s){var c=a.entangledLanes|=s;for(a=a.entanglements;c;){var f=31-jr(c),m=1<<f;m&s|a[f]&s&&(a[f]|=s),c&=~m}}function Wa(a,s){var c=s&-s;return c=(c&42)!==0?1:xi(c),(c&(a.suspendedLanes|s))!==0?0:c}function xi(a){switch(a){case 2:a=1;break;case 8:a=4;break;case 32:a=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:a=128;break;case 268435456:a=134217728;break;default:a=0}return a}function ga(a){return a&=-a,2<a?8<a?(a&134217727)!==0?32:268435456:8:2}function C(){var a=se.p;return a!==0?a:(a=window.event,a===void 0?32:Ep(a.type))}function j(a,s){var c=se.p;try{return se.p=a,s()}finally{se.p=c}}var D=Math.random().toString(36).slice(2),F="__reactFiber$"+D,L="__reactProps$"+D,H="__reactContainer$"+D,ce="__reactEvents$"+D,ve="__reactListeners$"+D,oe="__reactHandles$"+D,ue="__reactResources$"+D,fe="__reactMarker$"+D;function Re(a){delete a[F],delete a[L],delete a[ce],delete a[ve],delete a[oe]}function Me(a){var s=a[F];if(s)return s;for(var c=a.parentNode;c;){if(s=c[H]||c[F]){if(c=s.alternate,s.child!==null||c!==null&&c.child!==null)for(a=cp(a);a!==null;){if(c=a[F])return c;a=cp(a)}return s}a=c,c=a.parentNode}return null}function ze(a){if(a=a[F]||a[H]){var s=a.tag;if(s===5||s===6||s===13||s===31||s===26||s===27||s===3)return a}return null}function P(a){var s=a.tag;if(s===5||s===26||s===27||s===6)return a.stateNode;throw Error(n(33))}function W(a){var s=a[ue];return s||(s=a[ue]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function re(a){a[fe]=!0}var ke=new Set,De={};function Fe(a,s){Le(a,s),Le(a+"Capture",s)}function Le(a,s){for(De[a]=s,a=0;a<s.length;a++)ke.add(s[a])}var Ge=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),$e={},Ve={};function Qe(a){return gr.call(Ve,a)?!0:gr.call($e,a)?!1:Ge.test(a)?Ve[a]=!0:($e[a]=!0,!1)}function Je(a,s,c){if(Qe(s))if(c===null)a.removeAttribute(s);else{switch(typeof c){case"undefined":case"function":case"symbol":a.removeAttribute(s);return;case"boolean":var f=s.toLowerCase().slice(0,5);if(f!=="data-"&&f!=="aria-"){a.removeAttribute(s);return}}a.setAttribute(s,""+c)}}function He(a,s,c){if(c===null)a.removeAttribute(s);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(s);return}a.setAttribute(s,""+c)}}function Pe(a,s,c,f){if(f===null)a.removeAttribute(c);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(c);return}a.setAttributeNS(s,c,""+f)}}function Ue(a){switch(typeof a){case"bigint":case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function We(a){var s=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function vt(a,s,c){var f=Object.getOwnPropertyDescriptor(a.constructor.prototype,s);if(!a.hasOwnProperty(s)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var m=f.get,x=f.set;return Object.defineProperty(a,s,{configurable:!0,get:function(){return m.call(this)},set:function(E){c=""+E,x.call(this,E)}}),Object.defineProperty(a,s,{enumerable:f.enumerable}),{getValue:function(){return c},setValue:function(E){c=""+E},stopTracking:function(){a._valueTracker=null,delete a[s]}}}}function Ke(a){if(!a._valueTracker){var s=We(a)?"checked":"value";a._valueTracker=vt(a,s,""+a[s])}}function lr(a){if(!a)return!1;var s=a._valueTracker;if(!s)return!0;var c=s.getValue(),f="";return a&&(f=We(a)?a.checked?"true":"false":a.value),a=f,a!==c?(s.setValue(a),!0):!1}function Yt(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}var xa=/[\n"\\]/g;function Mr(a){return a.replace(xa,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function nc(a,s,c,f,m,x,E,O){a.name="",E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"?a.type=E:a.removeAttribute("type"),s!=null?E==="number"?(s===0&&a.value===""||a.value!=s)&&(a.value=""+Ue(s)):a.value!==""+Ue(s)&&(a.value=""+Ue(s)):E!=="submit"&&E!=="reset"||a.removeAttribute("value"),s!=null?Ku(a,E,Ue(s)):c!=null?Ku(a,E,Ue(c)):f!=null&&a.removeAttribute("value"),m==null&&x!=null&&(a.defaultChecked=!!x),m!=null&&(a.checked=m&&typeof m!="function"&&typeof m!="symbol"),O!=null&&typeof O!="function"&&typeof O!="symbol"&&typeof O!="boolean"?a.name=""+Ue(O):a.removeAttribute("name")}function Po(a,s,c,f,m,x,E,O){if(x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"&&(a.type=x),s!=null||c!=null){if(!(x!=="submit"&&x!=="reset"||s!=null)){Ke(a);return}c=c!=null?""+Ue(c):"",s=s!=null?""+Ue(s):c,O||s===a.value||(a.value=s),a.defaultValue=s}f=f??m,f=typeof f!="function"&&typeof f!="symbol"&&!!f,a.checked=O?a.checked:!!f,a.defaultChecked=!!f,E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"&&(a.name=E),Ke(a)}function Ku(a,s,c){s==="number"&&Yt(a.ownerDocument)===a||a.defaultValue===""+c||(a.defaultValue=""+c)}function Gs(a,s,c,f){if(a=a.options,s){s={};for(var m=0;m<c.length;m++)s["$"+c[m]]=!0;for(c=0;c<a.length;c++)m=s.hasOwnProperty("$"+a[c].value),a[c].selected!==m&&(a[c].selected=m),m&&f&&(a[c].defaultSelected=!0)}else{for(c=""+Ue(c),s=null,m=0;m<a.length;m++){if(a[m].value===c){a[m].selected=!0,f&&(a[m].defaultSelected=!0);return}s!==null||a[m].disabled||(s=a[m])}s!==null&&(s.selected=!0)}}function Km(a,s,c){if(s!=null&&(s=""+Ue(s),s!==a.value&&(a.value=s),c==null)){a.defaultValue!==s&&(a.defaultValue=s);return}a.defaultValue=c!=null?""+Ue(c):""}function Ym(a,s,c,f){if(s==null){if(f!=null){if(c!=null)throw Error(n(92));if(_e(f)){if(1<f.length)throw Error(n(93));f=f[0]}c=f}c==null&&(c=""),s=c}c=Ue(s),a.defaultValue=c,f=a.textContent,f===c&&f!==""&&f!==null&&(a.value=f),Ke(a)}function qs(a,s){if(s){var c=a.firstChild;if(c&&c===a.lastChild&&c.nodeType===3){c.nodeValue=s;return}}a.textContent=s}var fw=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Jm(a,s,c){var f=s.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?f?a.setProperty(s,""):s==="float"?a.cssFloat="":a[s]="":f?a.setProperty(s,c):typeof c!="number"||c===0||fw.has(s)?s==="float"?a.cssFloat=c:a[s]=(""+c).trim():a[s]=c+"px"}function Qm(a,s,c){if(s!=null&&typeof s!="object")throw Error(n(62));if(a=a.style,c!=null){for(var f in c)!c.hasOwnProperty(f)||s!=null&&s.hasOwnProperty(f)||(f.indexOf("--")===0?a.setProperty(f,""):f==="float"?a.cssFloat="":a[f]="");for(var m in s)f=s[m],s.hasOwnProperty(m)&&c[m]!==f&&Jm(a,m,f)}else for(var x in s)s.hasOwnProperty(x)&&Jm(a,x,s[x])}function Yu(a){if(a.indexOf("-")===-1)return!1;switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var hw=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),dw=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function zo(a){return dw.test(""+a)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":a}function Pn(){}var Ju=null;function Qu(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var Xs=null,Ws=null;function Zm(a){var s=ze(a);if(s&&(a=s.stateNode)){var c=a[L]||null;e:switch(a=s.stateNode,s.type){case"input":if(nc(a,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),s=c.name,c.type==="radio"&&s!=null){for(c=a;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+Mr(""+s)+'"][type="radio"]'),s=0;s<c.length;s++){var f=c[s];if(f!==a&&f.form===a.form){var m=f[L]||null;if(!m)throw Error(n(90));nc(f,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(s=0;s<c.length;s++)f=c[s],f.form===a.form&&lr(f)}break e;case"textarea":Km(a,c.value,c.defaultValue);break e;case"select":s=c.value,s!=null&&Gs(a,!!c.multiple,s,!1)}}}var Zu=!1;function e1(a,s,c){if(Zu)return a(s,c);Zu=!0;try{var f=a(s);return f}finally{if(Zu=!1,(Xs!==null||Ws!==null)&&(C0(),Xs&&(s=Xs,a=Ws,Ws=Xs=null,Zm(s),a)))for(s=0;s<a.length;s++)Zm(a[s])}}function ic(a,s){var c=a.stateNode;if(c===null)return null;var f=c[L]||null;if(f===null)return null;c=f[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(a=a.type,f=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!f;break e;default:a=!1}if(a)return null;if(c&&typeof c!="function")throw Error(n(231,s,typeof c));return c}var zn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ef=!1;if(zn)try{var sc={};Object.defineProperty(sc,"passive",{get:function(){ef=!0}}),window.addEventListener("test",sc,sc),window.removeEventListener("test",sc,sc)}catch{ef=!1}var pi=null,tf=null,Ho=null;function t1(){if(Ho)return Ho;var a,s=tf,c=s.length,f,m="value"in pi?pi.value:pi.textContent,x=m.length;for(a=0;a<c&&s[a]===m[a];a++);var E=c-a;for(f=1;f<=E&&s[c-f]===m[x-f];f++);return Ho=m.slice(a,1<f?1-f:void 0)}function Vo(a){var s=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&s===13&&(a=13)):a=s,a===10&&(a=13),32<=a||a===13?a:0}function $o(){return!0}function r1(){return!1}function pa(a){function s(c,f,m,x,E){this._reactName=c,this._targetInst=m,this.type=f,this.nativeEvent=x,this.target=E,this.currentTarget=null;for(var O in a)a.hasOwnProperty(O)&&(c=a[O],this[O]=c?c(x):x[O]);return this.isDefaultPrevented=(x.defaultPrevented!=null?x.defaultPrevented:x.returnValue===!1)?$o:r1,this.isPropagationStopped=r1,this}return p(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=$o)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=$o)},persist:function(){},isPersistent:$o}),s}var ts={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Go=pa(ts),lc=p({},ts,{view:0,detail:0}),mw=pa(lc),rf,af,cc,qo=p({},lc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:sf,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==cc&&(cc&&a.type==="mousemove"?(rf=a.screenX-cc.screenX,af=a.screenY-cc.screenY):af=rf=0,cc=a),rf)},movementY:function(a){return"movementY"in a?a.movementY:af}}),a1=pa(qo),gw=p({},qo,{dataTransfer:0}),xw=pa(gw),pw=p({},lc,{relatedTarget:0}),nf=pa(pw),vw=p({},ts,{animationName:0,elapsedTime:0,pseudoElement:0}),yw=pa(vw),_w=p({},ts,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),ww=pa(_w),bw=p({},ts,{data:0}),n1=pa(bw),Sw={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ew={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Tw={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function kw(a){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(a):(a=Tw[a])?!!s[a]:!1}function sf(){return kw}var Aw=p({},lc,{key:function(a){if(a.key){var s=Sw[a.key]||a.key;if(s!=="Unidentified")return s}return a.type==="keypress"?(a=Vo(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?Ew[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:sf,charCode:function(a){return a.type==="keypress"?Vo(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?Vo(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),Cw=pa(Aw),Nw=p({},qo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),i1=pa(Nw),Ow=p({},lc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:sf}),Rw=pa(Ow),Dw=p({},ts,{propertyName:0,elapsedTime:0,pseudoElement:0}),Fw=pa(Dw),Mw=p({},qo,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),Lw=pa(Mw),Bw=p({},ts,{newState:0,oldState:0}),Iw=pa(Bw),Uw=[9,13,27,32],lf=zn&&"CompositionEvent"in window,oc=null;zn&&"documentMode"in document&&(oc=document.documentMode);var jw=zn&&"TextEvent"in window&&!oc,s1=zn&&(!lf||oc&&8<oc&&11>=oc),l1=" ",c1=!1;function o1(a,s){switch(a){case"keyup":return Uw.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function u1(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var Ks=!1;function Pw(a,s){switch(a){case"compositionend":return u1(s);case"keypress":return s.which!==32?null:(c1=!0,l1);case"textInput":return a=s.data,a===l1&&c1?null:a;default:return null}}function zw(a,s){if(Ks)return a==="compositionend"||!lf&&o1(a,s)?(a=t1(),Ho=tf=pi=null,Ks=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return s1&&s.locale!=="ko"?null:s.data;default:return null}}var Hw={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function f1(a){var s=a&&a.nodeName&&a.nodeName.toLowerCase();return s==="input"?!!Hw[a.type]:s==="textarea"}function h1(a,s,c,f){Xs?Ws?Ws.push(f):Ws=[f]:Xs=f,s=L0(s,"onChange"),0<s.length&&(c=new Go("onChange","change",null,c,f),a.push({event:c,listeners:s}))}var uc=null,fc=null;function Vw(a){Wx(a,0)}function Xo(a){var s=P(a);if(lr(s))return a}function d1(a,s){if(a==="change")return s}var m1=!1;if(zn){var cf;if(zn){var of="oninput"in document;if(!of){var g1=document.createElement("div");g1.setAttribute("oninput","return;"),of=typeof g1.oninput=="function"}cf=of}else cf=!1;m1=cf&&(!document.documentMode||9<document.documentMode)}function x1(){uc&&(uc.detachEvent("onpropertychange",p1),fc=uc=null)}function p1(a){if(a.propertyName==="value"&&Xo(fc)){var s=[];h1(s,fc,a,Qu(a)),e1(Vw,s)}}function $w(a,s,c){a==="focusin"?(x1(),uc=s,fc=c,uc.attachEvent("onpropertychange",p1)):a==="focusout"&&x1()}function Gw(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return Xo(fc)}function qw(a,s){if(a==="click")return Xo(s)}function Xw(a,s){if(a==="input"||a==="change")return Xo(s)}function Ww(a,s){return a===s&&(a!==0||1/a===1/s)||a!==a&&s!==s}var Oa=typeof Object.is=="function"?Object.is:Ww;function hc(a,s){if(Oa(a,s))return!0;if(typeof a!="object"||a===null||typeof s!="object"||s===null)return!1;var c=Object.keys(a),f=Object.keys(s);if(c.length!==f.length)return!1;for(f=0;f<c.length;f++){var m=c[f];if(!gr.call(s,m)||!Oa(a[m],s[m]))return!1}return!0}function v1(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function y1(a,s){var c=v1(a);a=0;for(var f;c;){if(c.nodeType===3){if(f=a+c.textContent.length,a<=s&&f>=s)return{node:c,offset:s-a};a=f}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=v1(c)}}function _1(a,s){return a&&s?a===s?!0:a&&a.nodeType===3?!1:s&&s.nodeType===3?_1(a,s.parentNode):"contains"in a?a.contains(s):a.compareDocumentPosition?!!(a.compareDocumentPosition(s)&16):!1:!1}function w1(a){a=a!=null&&a.ownerDocument!=null&&a.ownerDocument.defaultView!=null?a.ownerDocument.defaultView:window;for(var s=Yt(a.document);s instanceof a.HTMLIFrameElement;){try{var c=typeof s.contentWindow.location.href=="string"}catch{c=!1}if(c)a=s.contentWindow;else break;s=Yt(a.document)}return s}function uf(a){var s=a&&a.nodeName&&a.nodeName.toLowerCase();return s&&(s==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||s==="textarea"||a.contentEditable==="true")}var Kw=zn&&"documentMode"in document&&11>=document.documentMode,Ys=null,ff=null,dc=null,hf=!1;function b1(a,s,c){var f=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;hf||Ys==null||Ys!==Yt(f)||(f=Ys,"selectionStart"in f&&uf(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),dc&&hc(dc,f)||(dc=f,f=L0(ff,"onSelect"),0<f.length&&(s=new Go("onSelect","select",null,s,c),a.push({event:s,listeners:f}),s.target=Ys)))}function rs(a,s){var c={};return c[a.toLowerCase()]=s.toLowerCase(),c["Webkit"+a]="webkit"+s,c["Moz"+a]="moz"+s,c}var Js={animationend:rs("Animation","AnimationEnd"),animationiteration:rs("Animation","AnimationIteration"),animationstart:rs("Animation","AnimationStart"),transitionrun:rs("Transition","TransitionRun"),transitionstart:rs("Transition","TransitionStart"),transitioncancel:rs("Transition","TransitionCancel"),transitionend:rs("Transition","TransitionEnd")},df={},S1={};zn&&(S1=document.createElement("div").style,"AnimationEvent"in window||(delete Js.animationend.animation,delete Js.animationiteration.animation,delete Js.animationstart.animation),"TransitionEvent"in window||delete Js.transitionend.transition);function as(a){if(df[a])return df[a];if(!Js[a])return a;var s=Js[a],c;for(c in s)if(s.hasOwnProperty(c)&&c in S1)return df[a]=s[c];return a}var E1=as("animationend"),T1=as("animationiteration"),k1=as("animationstart"),Yw=as("transitionrun"),Jw=as("transitionstart"),Qw=as("transitioncancel"),A1=as("transitionend"),C1=new Map,mf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");mf.push("scrollEnd");function dn(a,s){C1.set(a,s),Fe(s,[a])}var Wo=typeof reportError=="function"?reportError:function(a){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof a=="object"&&a!==null&&typeof a.message=="string"?String(a.message):String(a),error:a});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",a);return}console.error(a)},Ka=[],Qs=0,gf=0;function Ko(){for(var a=Qs,s=gf=Qs=0;s<a;){var c=Ka[s];Ka[s++]=null;var f=Ka[s];Ka[s++]=null;var m=Ka[s];Ka[s++]=null;var x=Ka[s];if(Ka[s++]=null,f!==null&&m!==null){var E=f.pending;E===null?m.next=m:(m.next=E.next,E.next=m),f.pending=m}x!==0&&N1(c,m,x)}}function Yo(a,s,c,f){Ka[Qs++]=a,Ka[Qs++]=s,Ka[Qs++]=c,Ka[Qs++]=f,gf|=f,a.lanes|=f,a=a.alternate,a!==null&&(a.lanes|=f)}function xf(a,s,c,f){return Yo(a,s,c,f),Jo(a)}function ns(a,s){return Yo(a,null,null,s),Jo(a)}function N1(a,s,c){a.lanes|=c;var f=a.alternate;f!==null&&(f.lanes|=c);for(var m=!1,x=a.return;x!==null;)x.childLanes|=c,f=x.alternate,f!==null&&(f.childLanes|=c),x.tag===22&&(a=x.stateNode,a===null||a._visibility&1||(m=!0)),a=x,x=x.return;return a.tag===3?(x=a.stateNode,m&&s!==null&&(m=31-jr(c),a=x.hiddenUpdates,f=a[m],f===null?a[m]=[s]:f.push(s),s.lane=c|536870912),x):null}function Jo(a){if(50<Lc)throw Lc=0,Th=null,Error(n(185));for(var s=a.return;s!==null;)a=s,s=a.return;return a.tag===3?a.stateNode:null}var Zs={};function Zw(a,s,c,f){this.tag=a,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ra(a,s,c,f){return new Zw(a,s,c,f)}function pf(a){return a=a.prototype,!(!a||!a.isReactComponent)}function Hn(a,s){var c=a.alternate;return c===null?(c=Ra(a.tag,s,a.key,a.mode),c.elementType=a.elementType,c.type=a.type,c.stateNode=a.stateNode,c.alternate=a,a.alternate=c):(c.pendingProps=s,c.type=a.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=a.flags&65011712,c.childLanes=a.childLanes,c.lanes=a.lanes,c.child=a.child,c.memoizedProps=a.memoizedProps,c.memoizedState=a.memoizedState,c.updateQueue=a.updateQueue,s=a.dependencies,c.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},c.sibling=a.sibling,c.index=a.index,c.ref=a.ref,c.refCleanup=a.refCleanup,c}function O1(a,s){a.flags&=65011714;var c=a.alternate;return c===null?(a.childLanes=0,a.lanes=s,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=c.childLanes,a.lanes=c.lanes,a.child=c.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=c.memoizedProps,a.memoizedState=c.memoizedState,a.updateQueue=c.updateQueue,a.type=c.type,s=c.dependencies,a.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),a}function Qo(a,s,c,f,m,x){var E=0;if(f=a,typeof a=="function")pf(a)&&(E=1);else if(typeof a=="string")E=nS(a,c,U.current)?26:a==="html"||a==="head"||a==="body"?27:5;else e:switch(a){case q:return a=Ra(31,c,s,m),a.elementType=q,a.lanes=x,a;case y:return is(c.children,m,x,s);case S:E=8,m|=24;break;case k:return a=Ra(12,c,s,m|2),a.elementType=k,a.lanes=x,a;case X:return a=Ra(13,c,s,m),a.elementType=X,a.lanes=x,a;case M:return a=Ra(19,c,s,m),a.elementType=M,a.lanes=x,a;default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case T:E=10;break e;case R:E=9;break e;case B:E=11;break e;case N:E=14;break e;case Z:E=16,f=null;break e}E=29,c=Error(n(130,a===null?"null":typeof a,"")),f=null}return s=Ra(E,c,s,m),s.elementType=a,s.type=f,s.lanes=x,s}function is(a,s,c,f){return a=Ra(7,a,f,s),a.lanes=c,a}function vf(a,s,c){return a=Ra(6,a,null,s),a.lanes=c,a}function R1(a){var s=Ra(18,null,null,0);return s.stateNode=a,s}function yf(a,s,c){return s=Ra(4,a.children!==null?a.children:[],a.key,s),s.lanes=c,s.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},s}var D1=new WeakMap;function Ya(a,s){if(typeof a=="object"&&a!==null){var c=D1.get(a);return c!==void 0?c:(s={value:a,source:s,stack:zt(s)},D1.set(a,s),s)}return{value:a,source:s,stack:zt(s)}}var el=[],tl=0,Zo=null,mc=0,Ja=[],Qa=0,vi=null,An=1,Cn="";function Vn(a,s){el[tl++]=mc,el[tl++]=Zo,Zo=a,mc=s}function F1(a,s,c){Ja[Qa++]=An,Ja[Qa++]=Cn,Ja[Qa++]=vi,vi=a;var f=An;a=Cn;var m=32-jr(f)-1;f&=~(1<<m),c+=1;var x=32-jr(s)+m;if(30<x){var E=m-m%5;x=(f&(1<<E)-1).toString(32),f>>=E,m-=E,An=1<<32-jr(s)+m|c<<m|f,Cn=x+a}else An=1<<x|c<<m|f,Cn=a}function _f(a){a.return!==null&&(Vn(a,1),F1(a,1,0))}function wf(a){for(;a===Zo;)Zo=el[--tl],el[tl]=null,mc=el[--tl],el[tl]=null;for(;a===vi;)vi=Ja[--Qa],Ja[Qa]=null,Cn=Ja[--Qa],Ja[Qa]=null,An=Ja[--Qa],Ja[Qa]=null}function M1(a,s){Ja[Qa++]=An,Ja[Qa++]=Cn,Ja[Qa++]=vi,An=s.id,Cn=s.overflow,vi=a}var Pr=null,Jt=null,kt=!1,yi=null,Za=!1,bf=Error(n(519));function _i(a){var s=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw gc(Ya(s,a)),bf}function L1(a){var s=a.stateNode,c=a.type,f=a.memoizedProps;switch(s[F]=a,s[L]=f,c){case"dialog":bt("cancel",s),bt("close",s);break;case"iframe":case"object":case"embed":bt("load",s);break;case"video":case"audio":for(c=0;c<Ic.length;c++)bt(Ic[c],s);break;case"source":bt("error",s);break;case"img":case"image":case"link":bt("error",s),bt("load",s);break;case"details":bt("toggle",s);break;case"input":bt("invalid",s),Po(s,f.value,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name,!0);break;case"select":bt("invalid",s);break;case"textarea":bt("invalid",s),Ym(s,f.value,f.defaultValue,f.children)}c=f.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||s.textContent===""+c||f.suppressHydrationWarning===!0||Qx(s.textContent,c)?(f.popover!=null&&(bt("beforetoggle",s),bt("toggle",s)),f.onScroll!=null&&bt("scroll",s),f.onScrollEnd!=null&&bt("scrollend",s),f.onClick!=null&&(s.onclick=Pn),s=!0):s=!1,s||_i(a,!0)}function B1(a){for(Pr=a.return;Pr;)switch(Pr.tag){case 5:case 31:case 13:Za=!1;return;case 27:case 3:Za=!0;return;default:Pr=Pr.return}}function rl(a){if(a!==Pr)return!1;if(!kt)return B1(a),kt=!0,!1;var s=a.tag,c;if((c=s!==3&&s!==27)&&((c=s===5)&&(c=a.type,c=!(c!=="form"&&c!=="button")||Ph(a.type,a.memoizedProps)),c=!c),c&&Jt&&_i(a),B1(a),s===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(n(317));Jt=lp(a)}else if(s===31){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(n(317));Jt=lp(a)}else s===27?(s=Jt,Mi(a.type)?(a=Gh,Gh=null,Jt=a):Jt=s):Jt=Pr?tn(a.stateNode.nextSibling):null;return!0}function ss(){Jt=Pr=null,kt=!1}function Sf(){var a=yi;return a!==null&&(wa===null?wa=a:wa.push.apply(wa,a),yi=null),a}function gc(a){yi===null?yi=[a]:yi.push(a)}var Ef=I(null),ls=null,$n=null;function wi(a,s,c){z(Ef,s._currentValue),s._currentValue=c}function Gn(a){a._currentValue=Ef.current,A(Ef)}function Tf(a,s,c){for(;a!==null;){var f=a.alternate;if((a.childLanes&s)!==s?(a.childLanes|=s,f!==null&&(f.childLanes|=s)):f!==null&&(f.childLanes&s)!==s&&(f.childLanes|=s),a===c)break;a=a.return}}function kf(a,s,c,f){var m=a.child;for(m!==null&&(m.return=a);m!==null;){var x=m.dependencies;if(x!==null){var E=m.child;x=x.firstContext;e:for(;x!==null;){var O=x;x=m;for(var K=0;K<s.length;K++)if(O.context===s[K]){x.lanes|=c,O=x.alternate,O!==null&&(O.lanes|=c),Tf(x.return,c,a),f||(E=null);break e}x=O.next}}else if(m.tag===18){if(E=m.return,E===null)throw Error(n(341));E.lanes|=c,x=E.alternate,x!==null&&(x.lanes|=c),Tf(E,c,a),E=null}else E=m.child;if(E!==null)E.return=m;else for(E=m;E!==null;){if(E===a){E=null;break}if(m=E.sibling,m!==null){m.return=E.return,E=m;break}E=E.return}m=E}}function al(a,s,c,f){a=null;for(var m=s,x=!1;m!==null;){if(!x){if((m.flags&524288)!==0)x=!0;else if((m.flags&262144)!==0)break}if(m.tag===10){var E=m.alternate;if(E===null)throw Error(n(387));if(E=E.memoizedProps,E!==null){var O=m.type;Oa(m.pendingProps.value,E.value)||(a!==null?a.push(O):a=[O])}}else if(m===we.current){if(E=m.alternate,E===null)throw Error(n(387));E.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(a!==null?a.push(Hc):a=[Hc])}m=m.return}a!==null&&kf(s,a,c,f),s.flags|=262144}function e0(a){for(a=a.firstContext;a!==null;){if(!Oa(a.context._currentValue,a.memoizedValue))return!0;a=a.next}return!1}function cs(a){ls=a,$n=null,a=a.dependencies,a!==null&&(a.firstContext=null)}function zr(a){return I1(ls,a)}function t0(a,s){return ls===null&&cs(a),I1(a,s)}function I1(a,s){var c=s._currentValue;if(s={context:s,memoizedValue:c,next:null},$n===null){if(a===null)throw Error(n(308));$n=s,a.dependencies={lanes:0,firstContext:s},a.flags|=524288}else $n=$n.next=s;return c}var eb=typeof AbortController<"u"?AbortController:function(){var a=[],s=this.signal={aborted:!1,addEventListener:function(c,f){a.push(f)}};this.abort=function(){s.aborted=!0,a.forEach(function(c){return c()})}},tb=e.unstable_scheduleCallback,rb=e.unstable_NormalPriority,wr={$$typeof:T,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Af(){return{controller:new eb,data:new Map,refCount:0}}function xc(a){a.refCount--,a.refCount===0&&tb(rb,function(){a.controller.abort()})}var pc=null,Cf=0,nl=0,il=null;function ab(a,s){if(pc===null){var c=pc=[];Cf=0,nl=Rh(),il={status:"pending",value:void 0,then:function(f){c.push(f)}}}return Cf++,s.then(U1,U1),s}function U1(){if(--Cf===0&&pc!==null){il!==null&&(il.status="fulfilled");var a=pc;pc=null,nl=0,il=null;for(var s=0;s<a.length;s++)(0,a[s])()}}function nb(a,s){var c=[],f={status:"pending",value:null,reason:null,then:function(m){c.push(m)}};return a.then(function(){f.status="fulfilled",f.value=s;for(var m=0;m<c.length;m++)(0,c[m])(s)},function(m){for(f.status="rejected",f.reason=m,m=0;m<c.length;m++)(0,c[m])(void 0)}),f}var j1=te.S;te.S=function(a,s){bx=_t(),typeof s=="object"&&s!==null&&typeof s.then=="function"&&ab(a,s),j1!==null&&j1(a,s)};var os=I(null);function Nf(){var a=os.current;return a!==null?a:Xt.pooledCache}function r0(a,s){s===null?z(os,os.current):z(os,s.pool)}function P1(){var a=Nf();return a===null?null:{parent:wr._currentValue,pool:a}}var sl=Error(n(460)),Of=Error(n(474)),a0=Error(n(542)),n0={then:function(){}};function z1(a){return a=a.status,a==="fulfilled"||a==="rejected"}function H1(a,s,c){switch(c=a[c],c===void 0?a.push(s):c!==s&&(s.then(Pn,Pn),s=c),s.status){case"fulfilled":return s.value;case"rejected":throw a=s.reason,$1(a),a;default:if(typeof s.status=="string")s.then(Pn,Pn);else{if(a=Xt,a!==null&&100<a.shellSuspendCounter)throw Error(n(482));a=s,a.status="pending",a.then(function(f){if(s.status==="pending"){var m=s;m.status="fulfilled",m.value=f}},function(f){if(s.status==="pending"){var m=s;m.status="rejected",m.reason=f}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw a=s.reason,$1(a),a}throw fs=s,sl}}function us(a){try{var s=a._init;return s(a._payload)}catch(c){throw c!==null&&typeof c=="object"&&typeof c.then=="function"?(fs=c,sl):c}}var fs=null;function V1(){if(fs===null)throw Error(n(459));var a=fs;return fs=null,a}function $1(a){if(a===sl||a===a0)throw Error(n(483))}var ll=null,vc=0;function i0(a){var s=vc;return vc+=1,ll===null&&(ll=[]),H1(ll,a,s)}function yc(a,s){s=s.props.ref,a.ref=s!==void 0?s:null}function s0(a,s){throw s.$$typeof===v?Error(n(525)):(a=Object.prototype.toString.call(s),Error(n(31,a==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":a)))}function G1(a){function s(ae,ee){if(a){var ie=ae.deletions;ie===null?(ae.deletions=[ee],ae.flags|=16):ie.push(ee)}}function c(ae,ee){if(!a)return null;for(;ee!==null;)s(ae,ee),ee=ee.sibling;return null}function f(ae){for(var ee=new Map;ae!==null;)ae.key!==null?ee.set(ae.key,ae):ee.set(ae.index,ae),ae=ae.sibling;return ee}function m(ae,ee){return ae=Hn(ae,ee),ae.index=0,ae.sibling=null,ae}function x(ae,ee,ie){return ae.index=ie,a?(ie=ae.alternate,ie!==null?(ie=ie.index,ie<ee?(ae.flags|=67108866,ee):ie):(ae.flags|=67108866,ee)):(ae.flags|=1048576,ee)}function E(ae){return a&&ae.alternate===null&&(ae.flags|=67108866),ae}function O(ae,ee,ie,be){return ee===null||ee.tag!==6?(ee=vf(ie,ae.mode,be),ee.return=ae,ee):(ee=m(ee,ie),ee.return=ae,ee)}function K(ae,ee,ie,be){var et=ie.type;return et===y?ye(ae,ee,ie.props.children,be,ie.key):ee!==null&&(ee.elementType===et||typeof et=="object"&&et!==null&&et.$$typeof===Z&&us(et)===ee.type)?(ee=m(ee,ie.props),yc(ee,ie),ee.return=ae,ee):(ee=Qo(ie.type,ie.key,ie.props,null,ae.mode,be),yc(ee,ie),ee.return=ae,ee)}function le(ae,ee,ie,be){return ee===null||ee.tag!==4||ee.stateNode.containerInfo!==ie.containerInfo||ee.stateNode.implementation!==ie.implementation?(ee=yf(ie,ae.mode,be),ee.return=ae,ee):(ee=m(ee,ie.children||[]),ee.return=ae,ee)}function ye(ae,ee,ie,be,et){return ee===null||ee.tag!==7?(ee=is(ie,ae.mode,be,et),ee.return=ae,ee):(ee=m(ee,ie),ee.return=ae,ee)}function Ee(ae,ee,ie){if(typeof ee=="string"&&ee!==""||typeof ee=="number"||typeof ee=="bigint")return ee=vf(""+ee,ae.mode,ie),ee.return=ae,ee;if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case _:return ie=Qo(ee.type,ee.key,ee.props,null,ae.mode,ie),yc(ie,ee),ie.return=ae,ie;case w:return ee=yf(ee,ae.mode,ie),ee.return=ae,ee;case Z:return ee=us(ee),Ee(ae,ee,ie)}if(_e(ee)||Q(ee))return ee=is(ee,ae.mode,ie,null),ee.return=ae,ee;if(typeof ee.then=="function")return Ee(ae,i0(ee),ie);if(ee.$$typeof===T)return Ee(ae,t0(ae,ee),ie);s0(ae,ee)}return null}function de(ae,ee,ie,be){var et=ee!==null?ee.key:null;if(typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint")return et!==null?null:O(ae,ee,""+ie,be);if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case _:return ie.key===et?K(ae,ee,ie,be):null;case w:return ie.key===et?le(ae,ee,ie,be):null;case Z:return ie=us(ie),de(ae,ee,ie,be)}if(_e(ie)||Q(ie))return et!==null?null:ye(ae,ee,ie,be,null);if(typeof ie.then=="function")return de(ae,ee,i0(ie),be);if(ie.$$typeof===T)return de(ae,ee,t0(ae,ie),be);s0(ae,ie)}return null}function me(ae,ee,ie,be,et){if(typeof be=="string"&&be!==""||typeof be=="number"||typeof be=="bigint")return ae=ae.get(ie)||null,O(ee,ae,""+be,et);if(typeof be=="object"&&be!==null){switch(be.$$typeof){case _:return ae=ae.get(be.key===null?ie:be.key)||null,K(ee,ae,be,et);case w:return ae=ae.get(be.key===null?ie:be.key)||null,le(ee,ae,be,et);case Z:return be=us(be),me(ae,ee,ie,be,et)}if(_e(be)||Q(be))return ae=ae.get(ie)||null,ye(ee,ae,be,et,null);if(typeof be.then=="function")return me(ae,ee,ie,i0(be),et);if(be.$$typeof===T)return me(ae,ee,ie,t0(ee,be),et);s0(ee,be)}return null}function qe(ae,ee,ie,be){for(var et=null,Ot=null,Ye=ee,gt=ee=0,Et=null;Ye!==null&&gt<ie.length;gt++){Ye.index>gt?(Et=Ye,Ye=null):Et=Ye.sibling;var Rt=de(ae,Ye,ie[gt],be);if(Rt===null){Ye===null&&(Ye=Et);break}a&&Ye&&Rt.alternate===null&&s(ae,Ye),ee=x(Rt,ee,gt),Ot===null?et=Rt:Ot.sibling=Rt,Ot=Rt,Ye=Et}if(gt===ie.length)return c(ae,Ye),kt&&Vn(ae,gt),et;if(Ye===null){for(;gt<ie.length;gt++)Ye=Ee(ae,ie[gt],be),Ye!==null&&(ee=x(Ye,ee,gt),Ot===null?et=Ye:Ot.sibling=Ye,Ot=Ye);return kt&&Vn(ae,gt),et}for(Ye=f(Ye);gt<ie.length;gt++)Et=me(Ye,ae,gt,ie[gt],be),Et!==null&&(a&&Et.alternate!==null&&Ye.delete(Et.key===null?gt:Et.key),ee=x(Et,ee,gt),Ot===null?et=Et:Ot.sibling=Et,Ot=Et);return a&&Ye.forEach(function(ji){return s(ae,ji)}),kt&&Vn(ae,gt),et}function rt(ae,ee,ie,be){if(ie==null)throw Error(n(151));for(var et=null,Ot=null,Ye=ee,gt=ee=0,Et=null,Rt=ie.next();Ye!==null&&!Rt.done;gt++,Rt=ie.next()){Ye.index>gt?(Et=Ye,Ye=null):Et=Ye.sibling;var ji=de(ae,Ye,Rt.value,be);if(ji===null){Ye===null&&(Ye=Et);break}a&&Ye&&ji.alternate===null&&s(ae,Ye),ee=x(ji,ee,gt),Ot===null?et=ji:Ot.sibling=ji,Ot=ji,Ye=Et}if(Rt.done)return c(ae,Ye),kt&&Vn(ae,gt),et;if(Ye===null){for(;!Rt.done;gt++,Rt=ie.next())Rt=Ee(ae,Rt.value,be),Rt!==null&&(ee=x(Rt,ee,gt),Ot===null?et=Rt:Ot.sibling=Rt,Ot=Rt);return kt&&Vn(ae,gt),et}for(Ye=f(Ye);!Rt.done;gt++,Rt=ie.next())Rt=me(Ye,ae,gt,Rt.value,be),Rt!==null&&(a&&Rt.alternate!==null&&Ye.delete(Rt.key===null?gt:Rt.key),ee=x(Rt,ee,gt),Ot===null?et=Rt:Ot.sibling=Rt,Ot=Rt);return a&&Ye.forEach(function(gS){return s(ae,gS)}),kt&&Vn(ae,gt),et}function $t(ae,ee,ie,be){if(typeof ie=="object"&&ie!==null&&ie.type===y&&ie.key===null&&(ie=ie.props.children),typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case _:e:{for(var et=ie.key;ee!==null;){if(ee.key===et){if(et=ie.type,et===y){if(ee.tag===7){c(ae,ee.sibling),be=m(ee,ie.props.children),be.return=ae,ae=be;break e}}else if(ee.elementType===et||typeof et=="object"&&et!==null&&et.$$typeof===Z&&us(et)===ee.type){c(ae,ee.sibling),be=m(ee,ie.props),yc(be,ie),be.return=ae,ae=be;break e}c(ae,ee);break}else s(ae,ee);ee=ee.sibling}ie.type===y?(be=is(ie.props.children,ae.mode,be,ie.key),be.return=ae,ae=be):(be=Qo(ie.type,ie.key,ie.props,null,ae.mode,be),yc(be,ie),be.return=ae,ae=be)}return E(ae);case w:e:{for(et=ie.key;ee!==null;){if(ee.key===et)if(ee.tag===4&&ee.stateNode.containerInfo===ie.containerInfo&&ee.stateNode.implementation===ie.implementation){c(ae,ee.sibling),be=m(ee,ie.children||[]),be.return=ae,ae=be;break e}else{c(ae,ee);break}else s(ae,ee);ee=ee.sibling}be=yf(ie,ae.mode,be),be.return=ae,ae=be}return E(ae);case Z:return ie=us(ie),$t(ae,ee,ie,be)}if(_e(ie))return qe(ae,ee,ie,be);if(Q(ie)){if(et=Q(ie),typeof et!="function")throw Error(n(150));return ie=et.call(ie),rt(ae,ee,ie,be)}if(typeof ie.then=="function")return $t(ae,ee,i0(ie),be);if(ie.$$typeof===T)return $t(ae,ee,t0(ae,ie),be);s0(ae,ie)}return typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint"?(ie=""+ie,ee!==null&&ee.tag===6?(c(ae,ee.sibling),be=m(ee,ie),be.return=ae,ae=be):(c(ae,ee),be=vf(ie,ae.mode,be),be.return=ae,ae=be),E(ae)):c(ae,ee)}return function(ae,ee,ie,be){try{vc=0;var et=$t(ae,ee,ie,be);return ll=null,et}catch(Ye){if(Ye===sl||Ye===a0)throw Ye;var Ot=Ra(29,Ye,null,ae.mode);return Ot.lanes=be,Ot.return=ae,Ot}}}var hs=G1(!0),q1=G1(!1),bi=!1;function Rf(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Df(a,s){a=a.updateQueue,s.updateQueue===a&&(s.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,callbacks:null})}function Si(a){return{lane:a,tag:0,payload:null,callback:null,next:null}}function Ei(a,s,c){var f=a.updateQueue;if(f===null)return null;if(f=f.shared,(Ft&2)!==0){var m=f.pending;return m===null?s.next=s:(s.next=m.next,m.next=s),f.pending=s,s=Jo(a),N1(a,null,c),s}return Yo(a,f,s,c),Jo(a)}function _c(a,s,c){if(s=s.updateQueue,s!==null&&(s=s.shared,(c&4194048)!==0)){var f=s.lanes;f&=a.pendingLanes,c|=f,s.lanes=c,kn(a,c)}}function Ff(a,s){var c=a.updateQueue,f=a.alternate;if(f!==null&&(f=f.updateQueue,c===f)){var m=null,x=null;if(c=c.firstBaseUpdate,c!==null){do{var E={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};x===null?m=x=E:x=x.next=E,c=c.next}while(c!==null);x===null?m=x=s:x=x.next=s}else m=x=s;c={baseState:f.baseState,firstBaseUpdate:m,lastBaseUpdate:x,shared:f.shared,callbacks:f.callbacks},a.updateQueue=c;return}a=c.lastBaseUpdate,a===null?c.firstBaseUpdate=s:a.next=s,c.lastBaseUpdate=s}var Mf=!1;function wc(){if(Mf){var a=il;if(a!==null)throw a}}function bc(a,s,c,f){Mf=!1;var m=a.updateQueue;bi=!1;var x=m.firstBaseUpdate,E=m.lastBaseUpdate,O=m.shared.pending;if(O!==null){m.shared.pending=null;var K=O,le=K.next;K.next=null,E===null?x=le:E.next=le,E=K;var ye=a.alternate;ye!==null&&(ye=ye.updateQueue,O=ye.lastBaseUpdate,O!==E&&(O===null?ye.firstBaseUpdate=le:O.next=le,ye.lastBaseUpdate=K))}if(x!==null){var Ee=m.baseState;E=0,ye=le=K=null,O=x;do{var de=O.lane&-536870913,me=de!==O.lane;if(me?(St&de)===de:(f&de)===de){de!==0&&de===nl&&(Mf=!0),ye!==null&&(ye=ye.next={lane:0,tag:O.tag,payload:O.payload,callback:null,next:null});e:{var qe=a,rt=O;de=s;var $t=c;switch(rt.tag){case 1:if(qe=rt.payload,typeof qe=="function"){Ee=qe.call($t,Ee,de);break e}Ee=qe;break e;case 3:qe.flags=qe.flags&-65537|128;case 0:if(qe=rt.payload,de=typeof qe=="function"?qe.call($t,Ee,de):qe,de==null)break e;Ee=p({},Ee,de);break e;case 2:bi=!0}}de=O.callback,de!==null&&(a.flags|=64,me&&(a.flags|=8192),me=m.callbacks,me===null?m.callbacks=[de]:me.push(de))}else me={lane:de,tag:O.tag,payload:O.payload,callback:O.callback,next:null},ye===null?(le=ye=me,K=Ee):ye=ye.next=me,E|=de;if(O=O.next,O===null){if(O=m.shared.pending,O===null)break;me=O,O=me.next,me.next=null,m.lastBaseUpdate=me,m.shared.pending=null}}while(!0);ye===null&&(K=Ee),m.baseState=K,m.firstBaseUpdate=le,m.lastBaseUpdate=ye,x===null&&(m.shared.lanes=0),Ni|=E,a.lanes=E,a.memoizedState=Ee}}function X1(a,s){if(typeof a!="function")throw Error(n(191,a));a.call(s)}function W1(a,s){var c=a.callbacks;if(c!==null)for(a.callbacks=null,a=0;a<c.length;a++)X1(c[a],s)}var cl=I(null),l0=I(0);function K1(a,s){a=ei,z(l0,a),z(cl,s),ei=a|s.baseLanes}function Lf(){z(l0,ei),z(cl,cl.current)}function Bf(){ei=l0.current,A(cl),A(l0)}var Da=I(null),en=null;function Ti(a){var s=a.alternate;z(xr,xr.current&1),z(Da,a),en===null&&(s===null||cl.current!==null||s.memoizedState!==null)&&(en=a)}function If(a){z(xr,xr.current),z(Da,a),en===null&&(en=a)}function Y1(a){a.tag===22?(z(xr,xr.current),z(Da,a),en===null&&(en=a)):ki()}function ki(){z(xr,xr.current),z(Da,Da.current)}function Fa(a){A(Da),en===a&&(en=null),A(xr)}var xr=I(0);function c0(a){for(var s=a;s!==null;){if(s.tag===13){var c=s.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||Vh(c)||$h(c)))return s}else if(s.tag===19&&(s.memoizedProps.revealOrder==="forwards"||s.memoizedProps.revealOrder==="backwards"||s.memoizedProps.revealOrder==="unstable_legacy-backwards"||s.memoizedProps.revealOrder==="together")){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break;for(;s.sibling===null;){if(s.return===null||s.return===a)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var qn=0,dt=null,Ht=null,br=null,o0=!1,ol=!1,ds=!1,u0=0,Sc=0,ul=null,ib=0;function cr(){throw Error(n(321))}function Uf(a,s){if(s===null)return!1;for(var c=0;c<s.length&&c<a.length;c++)if(!Oa(a[c],s[c]))return!1;return!0}function jf(a,s,c,f,m,x){return qn=x,dt=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,te.H=a===null||a.memoizedState===null?Fg:eh,ds=!1,x=c(f,m),ds=!1,ol&&(x=Q1(s,c,f,m)),J1(a),x}function J1(a){te.H=kc;var s=Ht!==null&&Ht.next!==null;if(qn=0,br=Ht=dt=null,o0=!1,Sc=0,ul=null,s)throw Error(n(300));a===null||Sr||(a=a.dependencies,a!==null&&e0(a)&&(Sr=!0))}function Q1(a,s,c,f){dt=a;var m=0;do{if(ol&&(ul=null),Sc=0,ol=!1,25<=m)throw Error(n(301));if(m+=1,br=Ht=null,a.updateQueue!=null){var x=a.updateQueue;x.lastEffect=null,x.events=null,x.stores=null,x.memoCache!=null&&(x.memoCache.index=0)}te.H=Mg,x=s(c,f)}while(ol);return x}function sb(){var a=te.H,s=a.useState()[0];return s=typeof s.then=="function"?Ec(s):s,a=a.useState()[0],(Ht!==null?Ht.memoizedState:null)!==a&&(dt.flags|=1024),s}function Pf(){var a=u0!==0;return u0=0,a}function zf(a,s,c){s.updateQueue=a.updateQueue,s.flags&=-2053,a.lanes&=~c}function Hf(a){if(o0){for(a=a.memoizedState;a!==null;){var s=a.queue;s!==null&&(s.pending=null),a=a.next}o0=!1}qn=0,br=Ht=dt=null,ol=!1,Sc=u0=0,ul=null}function oa(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return br===null?dt.memoizedState=br=a:br=br.next=a,br}function pr(){if(Ht===null){var a=dt.alternate;a=a!==null?a.memoizedState:null}else a=Ht.next;var s=br===null?dt.memoizedState:br.next;if(s!==null)br=s,Ht=a;else{if(a===null)throw dt.alternate===null?Error(n(467)):Error(n(310));Ht=a,a={memoizedState:Ht.memoizedState,baseState:Ht.baseState,baseQueue:Ht.baseQueue,queue:Ht.queue,next:null},br===null?dt.memoizedState=br=a:br=br.next=a}return br}function f0(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ec(a){var s=Sc;return Sc+=1,ul===null&&(ul=[]),a=H1(ul,a,s),s=dt,(br===null?s.memoizedState:br.next)===null&&(s=s.alternate,te.H=s===null||s.memoizedState===null?Fg:eh),a}function h0(a){if(a!==null&&typeof a=="object"){if(typeof a.then=="function")return Ec(a);if(a.$$typeof===T)return zr(a)}throw Error(n(438,String(a)))}function Vf(a){var s=null,c=dt.updateQueue;if(c!==null&&(s=c.memoCache),s==null){var f=dt.alternate;f!==null&&(f=f.updateQueue,f!==null&&(f=f.memoCache,f!=null&&(s={data:f.data.map(function(m){return m.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),c===null&&(c=f0(),dt.updateQueue=c),c.memoCache=s,c=s.data[s.index],c===void 0)for(c=s.data[s.index]=Array(a),f=0;f<a;f++)c[f]=he;return s.index++,c}function Xn(a,s){return typeof s=="function"?s(a):s}function d0(a){var s=pr();return $f(s,Ht,a)}function $f(a,s,c){var f=a.queue;if(f===null)throw Error(n(311));f.lastRenderedReducer=c;var m=a.baseQueue,x=f.pending;if(x!==null){if(m!==null){var E=m.next;m.next=x.next,x.next=E}s.baseQueue=m=x,f.pending=null}if(x=a.baseState,m===null)a.memoizedState=x;else{s=m.next;var O=E=null,K=null,le=s,ye=!1;do{var Ee=le.lane&-536870913;if(Ee!==le.lane?(St&Ee)===Ee:(qn&Ee)===Ee){var de=le.revertLane;if(de===0)K!==null&&(K=K.next={lane:0,revertLane:0,gesture:null,action:le.action,hasEagerState:le.hasEagerState,eagerState:le.eagerState,next:null}),Ee===nl&&(ye=!0);else if((qn&de)===de){le=le.next,de===nl&&(ye=!0);continue}else Ee={lane:0,revertLane:le.revertLane,gesture:null,action:le.action,hasEagerState:le.hasEagerState,eagerState:le.eagerState,next:null},K===null?(O=K=Ee,E=x):K=K.next=Ee,dt.lanes|=de,Ni|=de;Ee=le.action,ds&&c(x,Ee),x=le.hasEagerState?le.eagerState:c(x,Ee)}else de={lane:Ee,revertLane:le.revertLane,gesture:le.gesture,action:le.action,hasEagerState:le.hasEagerState,eagerState:le.eagerState,next:null},K===null?(O=K=de,E=x):K=K.next=de,dt.lanes|=Ee,Ni|=Ee;le=le.next}while(le!==null&&le!==s);if(K===null?E=x:K.next=O,!Oa(x,a.memoizedState)&&(Sr=!0,ye&&(c=il,c!==null)))throw c;a.memoizedState=x,a.baseState=E,a.baseQueue=K,f.lastRenderedState=x}return m===null&&(f.lanes=0),[a.memoizedState,f.dispatch]}function Gf(a){var s=pr(),c=s.queue;if(c===null)throw Error(n(311));c.lastRenderedReducer=a;var f=c.dispatch,m=c.pending,x=s.memoizedState;if(m!==null){c.pending=null;var E=m=m.next;do x=a(x,E.action),E=E.next;while(E!==m);Oa(x,s.memoizedState)||(Sr=!0),s.memoizedState=x,s.baseQueue===null&&(s.baseState=x),c.lastRenderedState=x}return[x,f]}function Z1(a,s,c){var f=dt,m=pr(),x=kt;if(x){if(c===void 0)throw Error(n(407));c=c()}else c=s();var E=!Oa((Ht||m).memoizedState,c);if(E&&(m.memoizedState=c,Sr=!0),m=m.queue,Wf(rg.bind(null,f,m,a),[a]),m.getSnapshot!==s||E||br!==null&&br.memoizedState.tag&1){if(f.flags|=2048,fl(9,{destroy:void 0},tg.bind(null,f,m,c,s),null),Xt===null)throw Error(n(349));x||(qn&127)!==0||eg(f,s,c)}return c}function eg(a,s,c){a.flags|=16384,a={getSnapshot:s,value:c},s=dt.updateQueue,s===null?(s=f0(),dt.updateQueue=s,s.stores=[a]):(c=s.stores,c===null?s.stores=[a]:c.push(a))}function tg(a,s,c,f){s.value=c,s.getSnapshot=f,ag(s)&&ng(a)}function rg(a,s,c){return c(function(){ag(s)&&ng(a)})}function ag(a){var s=a.getSnapshot;a=a.value;try{var c=s();return!Oa(a,c)}catch{return!0}}function ng(a){var s=ns(a,2);s!==null&&ba(s,a,2)}function qf(a){var s=oa();if(typeof a=="function"){var c=a;if(a=c(),ds){Ca(!0);try{c()}finally{Ca(!1)}}}return s.memoizedState=s.baseState=a,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xn,lastRenderedState:a},s}function ig(a,s,c,f){return a.baseState=c,$f(a,Ht,typeof f=="function"?f:Xn)}function lb(a,s,c,f,m){if(x0(a))throw Error(n(485));if(a=s.action,a!==null){var x={payload:m,action:a,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(E){x.listeners.push(E)}};te.T!==null?c(!0):x.isTransition=!1,f(x),c=s.pending,c===null?(x.next=s.pending=x,sg(s,x)):(x.next=c.next,s.pending=c.next=x)}}function sg(a,s){var c=s.action,f=s.payload,m=a.state;if(s.isTransition){var x=te.T,E={};te.T=E;try{var O=c(m,f),K=te.S;K!==null&&K(E,O),lg(a,s,O)}catch(le){Xf(a,s,le)}finally{x!==null&&E.types!==null&&(x.types=E.types),te.T=x}}else try{x=c(m,f),lg(a,s,x)}catch(le){Xf(a,s,le)}}function lg(a,s,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(f){cg(a,s,f)},function(f){return Xf(a,s,f)}):cg(a,s,c)}function cg(a,s,c){s.status="fulfilled",s.value=c,og(s),a.state=c,s=a.pending,s!==null&&(c=s.next,c===s?a.pending=null:(c=c.next,s.next=c,sg(a,c)))}function Xf(a,s,c){var f=a.pending;if(a.pending=null,f!==null){f=f.next;do s.status="rejected",s.reason=c,og(s),s=s.next;while(s!==f)}a.action=null}function og(a){a=a.listeners;for(var s=0;s<a.length;s++)(0,a[s])()}function ug(a,s){return s}function fg(a,s){if(kt){var c=Xt.formState;if(c!==null){e:{var f=dt;if(kt){if(Jt){t:{for(var m=Jt,x=Za;m.nodeType!==8;){if(!x){m=null;break t}if(m=tn(m.nextSibling),m===null){m=null;break t}}x=m.data,m=x==="F!"||x==="F"?m:null}if(m){Jt=tn(m.nextSibling),f=m.data==="F!";break e}}_i(f)}f=!1}f&&(s=c[0])}}return c=oa(),c.memoizedState=c.baseState=s,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ug,lastRenderedState:s},c.queue=f,c=Og.bind(null,dt,f),f.dispatch=c,f=qf(!1),x=Zf.bind(null,dt,!1,f.queue),f=oa(),m={state:s,dispatch:null,action:a,pending:null},f.queue=m,c=lb.bind(null,dt,m,x,c),m.dispatch=c,f.memoizedState=a,[s,c,!1]}function hg(a){var s=pr();return dg(s,Ht,a)}function dg(a,s,c){if(s=$f(a,s,ug)[0],a=d0(Xn)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var f=Ec(s)}catch(E){throw E===sl?a0:E}else f=s;s=pr();var m=s.queue,x=m.dispatch;return c!==s.memoizedState&&(dt.flags|=2048,fl(9,{destroy:void 0},cb.bind(null,m,c),null)),[f,x,a]}function cb(a,s){a.action=s}function mg(a){var s=pr(),c=Ht;if(c!==null)return dg(s,c,a);pr(),s=s.memoizedState,c=pr();var f=c.queue.dispatch;return c.memoizedState=a,[s,f,!1]}function fl(a,s,c,f){return a={tag:a,create:c,deps:f,inst:s,next:null},s=dt.updateQueue,s===null&&(s=f0(),dt.updateQueue=s),c=s.lastEffect,c===null?s.lastEffect=a.next=a:(f=c.next,c.next=a,a.next=f,s.lastEffect=a),a}function gg(){return pr().memoizedState}function m0(a,s,c,f){var m=oa();dt.flags|=a,m.memoizedState=fl(1|s,{destroy:void 0},c,f===void 0?null:f)}function g0(a,s,c,f){var m=pr();f=f===void 0?null:f;var x=m.memoizedState.inst;Ht!==null&&f!==null&&Uf(f,Ht.memoizedState.deps)?m.memoizedState=fl(s,x,c,f):(dt.flags|=a,m.memoizedState=fl(1|s,x,c,f))}function xg(a,s){m0(8390656,8,a,s)}function Wf(a,s){g0(2048,8,a,s)}function ob(a){dt.flags|=4;var s=dt.updateQueue;if(s===null)s=f0(),dt.updateQueue=s,s.events=[a];else{var c=s.events;c===null?s.events=[a]:c.push(a)}}function pg(a){var s=pr().memoizedState;return ob({ref:s,nextImpl:a}),function(){if((Ft&2)!==0)throw Error(n(440));return s.impl.apply(void 0,arguments)}}function vg(a,s){return g0(4,2,a,s)}function yg(a,s){return g0(4,4,a,s)}function _g(a,s){if(typeof s=="function"){a=a();var c=s(a);return function(){typeof c=="function"?c():s(null)}}if(s!=null)return a=a(),s.current=a,function(){s.current=null}}function wg(a,s,c){c=c!=null?c.concat([a]):null,g0(4,4,_g.bind(null,s,a),c)}function Kf(){}function bg(a,s){var c=pr();s=s===void 0?null:s;var f=c.memoizedState;return s!==null&&Uf(s,f[1])?f[0]:(c.memoizedState=[a,s],a)}function Sg(a,s){var c=pr();s=s===void 0?null:s;var f=c.memoizedState;if(s!==null&&Uf(s,f[1]))return f[0];if(f=a(),ds){Ca(!0);try{a()}finally{Ca(!1)}}return c.memoizedState=[f,s],f}function Yf(a,s,c){return c===void 0||(qn&1073741824)!==0&&(St&261930)===0?a.memoizedState=s:(a.memoizedState=c,a=Ex(),dt.lanes|=a,Ni|=a,c)}function Eg(a,s,c,f){return Oa(c,s)?c:cl.current!==null?(a=Yf(a,c,f),Oa(a,s)||(Sr=!0),a):(qn&42)===0||(qn&1073741824)!==0&&(St&261930)===0?(Sr=!0,a.memoizedState=c):(a=Ex(),dt.lanes|=a,Ni|=a,s)}function Tg(a,s,c,f,m){var x=se.p;se.p=x!==0&&8>x?x:8;var E=te.T,O={};te.T=O,Zf(a,!1,s,c);try{var K=m(),le=te.S;if(le!==null&&le(O,K),K!==null&&typeof K=="object"&&typeof K.then=="function"){var ye=nb(K,f);Tc(a,s,ye,Ba(a))}else Tc(a,s,f,Ba(a))}catch(Ee){Tc(a,s,{then:function(){},status:"rejected",reason:Ee},Ba())}finally{se.p=x,E!==null&&O.types!==null&&(E.types=O.types),te.T=E}}function ub(){}function Jf(a,s,c,f){if(a.tag!==5)throw Error(n(476));var m=kg(a).queue;Tg(a,m,s,ge,c===null?ub:function(){return Ag(a),c(f)})}function kg(a){var s=a.memoizedState;if(s!==null)return s;s={memoizedState:ge,baseState:ge,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xn,lastRenderedState:ge},next:null};var c={};return s.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xn,lastRenderedState:c},next:null},a.memoizedState=s,a=a.alternate,a!==null&&(a.memoizedState=s),s}function Ag(a){var s=kg(a);s.next===null&&(s=a.alternate.memoizedState),Tc(a,s.next.queue,{},Ba())}function Qf(){return zr(Hc)}function Cg(){return pr().memoizedState}function Ng(){return pr().memoizedState}function fb(a){for(var s=a.return;s!==null;){switch(s.tag){case 24:case 3:var c=Ba();a=Si(c);var f=Ei(s,a,c);f!==null&&(ba(f,s,c),_c(f,s,c)),s={cache:Af()},a.payload=s;return}s=s.return}}function hb(a,s,c){var f=Ba();c={lane:f,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},x0(a)?Rg(s,c):(c=xf(a,s,c,f),c!==null&&(ba(c,a,f),Dg(c,s,f)))}function Og(a,s,c){var f=Ba();Tc(a,s,c,f)}function Tc(a,s,c,f){var m={lane:f,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null};if(x0(a))Rg(s,m);else{var x=a.alternate;if(a.lanes===0&&(x===null||x.lanes===0)&&(x=s.lastRenderedReducer,x!==null))try{var E=s.lastRenderedState,O=x(E,c);if(m.hasEagerState=!0,m.eagerState=O,Oa(O,E))return Yo(a,s,m,0),Xt===null&&Ko(),!1}catch{}if(c=xf(a,s,m,f),c!==null)return ba(c,a,f),Dg(c,s,f),!0}return!1}function Zf(a,s,c,f){if(f={lane:2,revertLane:Rh(),gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},x0(a)){if(s)throw Error(n(479))}else s=xf(a,c,f,2),s!==null&&ba(s,a,2)}function x0(a){var s=a.alternate;return a===dt||s!==null&&s===dt}function Rg(a,s){ol=o0=!0;var c=a.pending;c===null?s.next=s:(s.next=c.next,c.next=s),a.pending=s}function Dg(a,s,c){if((c&4194048)!==0){var f=s.lanes;f&=a.pendingLanes,c|=f,s.lanes=c,kn(a,c)}}var kc={readContext:zr,use:h0,useCallback:cr,useContext:cr,useEffect:cr,useImperativeHandle:cr,useLayoutEffect:cr,useInsertionEffect:cr,useMemo:cr,useReducer:cr,useRef:cr,useState:cr,useDebugValue:cr,useDeferredValue:cr,useTransition:cr,useSyncExternalStore:cr,useId:cr,useHostTransitionStatus:cr,useFormState:cr,useActionState:cr,useOptimistic:cr,useMemoCache:cr,useCacheRefresh:cr};kc.useEffectEvent=cr;var Fg={readContext:zr,use:h0,useCallback:function(a,s){return oa().memoizedState=[a,s===void 0?null:s],a},useContext:zr,useEffect:xg,useImperativeHandle:function(a,s,c){c=c!=null?c.concat([a]):null,m0(4194308,4,_g.bind(null,s,a),c)},useLayoutEffect:function(a,s){return m0(4194308,4,a,s)},useInsertionEffect:function(a,s){m0(4,2,a,s)},useMemo:function(a,s){var c=oa();s=s===void 0?null:s;var f=a();if(ds){Ca(!0);try{a()}finally{Ca(!1)}}return c.memoizedState=[f,s],f},useReducer:function(a,s,c){var f=oa();if(c!==void 0){var m=c(s);if(ds){Ca(!0);try{c(s)}finally{Ca(!1)}}}else m=s;return f.memoizedState=f.baseState=m,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:m},f.queue=a,a=a.dispatch=hb.bind(null,dt,a),[f.memoizedState,a]},useRef:function(a){var s=oa();return a={current:a},s.memoizedState=a},useState:function(a){a=qf(a);var s=a.queue,c=Og.bind(null,dt,s);return s.dispatch=c,[a.memoizedState,c]},useDebugValue:Kf,useDeferredValue:function(a,s){var c=oa();return Yf(c,a,s)},useTransition:function(){var a=qf(!1);return a=Tg.bind(null,dt,a.queue,!0,!1),oa().memoizedState=a,[!1,a]},useSyncExternalStore:function(a,s,c){var f=dt,m=oa();if(kt){if(c===void 0)throw Error(n(407));c=c()}else{if(c=s(),Xt===null)throw Error(n(349));(St&127)!==0||eg(f,s,c)}m.memoizedState=c;var x={value:c,getSnapshot:s};return m.queue=x,xg(rg.bind(null,f,x,a),[a]),f.flags|=2048,fl(9,{destroy:void 0},tg.bind(null,f,x,c,s),null),c},useId:function(){var a=oa(),s=Xt.identifierPrefix;if(kt){var c=Cn,f=An;c=(f&~(1<<32-jr(f)-1)).toString(32)+c,s="_"+s+"R_"+c,c=u0++,0<c&&(s+="H"+c.toString(32)),s+="_"}else c=ib++,s="_"+s+"r_"+c.toString(32)+"_";return a.memoizedState=s},useHostTransitionStatus:Qf,useFormState:fg,useActionState:fg,useOptimistic:function(a){var s=oa();s.memoizedState=s.baseState=a;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=c,s=Zf.bind(null,dt,!0,c),c.dispatch=s,[a,s]},useMemoCache:Vf,useCacheRefresh:function(){return oa().memoizedState=fb.bind(null,dt)},useEffectEvent:function(a){var s=oa(),c={impl:a};return s.memoizedState=c,function(){if((Ft&2)!==0)throw Error(n(440));return c.impl.apply(void 0,arguments)}}},eh={readContext:zr,use:h0,useCallback:bg,useContext:zr,useEffect:Wf,useImperativeHandle:wg,useInsertionEffect:vg,useLayoutEffect:yg,useMemo:Sg,useReducer:d0,useRef:gg,useState:function(){return d0(Xn)},useDebugValue:Kf,useDeferredValue:function(a,s){var c=pr();return Eg(c,Ht.memoizedState,a,s)},useTransition:function(){var a=d0(Xn)[0],s=pr().memoizedState;return[typeof a=="boolean"?a:Ec(a),s]},useSyncExternalStore:Z1,useId:Cg,useHostTransitionStatus:Qf,useFormState:hg,useActionState:hg,useOptimistic:function(a,s){var c=pr();return ig(c,Ht,a,s)},useMemoCache:Vf,useCacheRefresh:Ng};eh.useEffectEvent=pg;var Mg={readContext:zr,use:h0,useCallback:bg,useContext:zr,useEffect:Wf,useImperativeHandle:wg,useInsertionEffect:vg,useLayoutEffect:yg,useMemo:Sg,useReducer:Gf,useRef:gg,useState:function(){return Gf(Xn)},useDebugValue:Kf,useDeferredValue:function(a,s){var c=pr();return Ht===null?Yf(c,a,s):Eg(c,Ht.memoizedState,a,s)},useTransition:function(){var a=Gf(Xn)[0],s=pr().memoizedState;return[typeof a=="boolean"?a:Ec(a),s]},useSyncExternalStore:Z1,useId:Cg,useHostTransitionStatus:Qf,useFormState:mg,useActionState:mg,useOptimistic:function(a,s){var c=pr();return Ht!==null?ig(c,Ht,a,s):(c.baseState=a,[a,c.queue.dispatch])},useMemoCache:Vf,useCacheRefresh:Ng};Mg.useEffectEvent=pg;function th(a,s,c,f){s=a.memoizedState,c=c(f,s),c=c==null?s:p({},s,c),a.memoizedState=c,a.lanes===0&&(a.updateQueue.baseState=c)}var rh={enqueueSetState:function(a,s,c){a=a._reactInternals;var f=Ba(),m=Si(f);m.payload=s,c!=null&&(m.callback=c),s=Ei(a,m,f),s!==null&&(ba(s,a,f),_c(s,a,f))},enqueueReplaceState:function(a,s,c){a=a._reactInternals;var f=Ba(),m=Si(f);m.tag=1,m.payload=s,c!=null&&(m.callback=c),s=Ei(a,m,f),s!==null&&(ba(s,a,f),_c(s,a,f))},enqueueForceUpdate:function(a,s){a=a._reactInternals;var c=Ba(),f=Si(c);f.tag=2,s!=null&&(f.callback=s),s=Ei(a,f,c),s!==null&&(ba(s,a,c),_c(s,a,c))}};function Lg(a,s,c,f,m,x,E){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(f,x,E):s.prototype&&s.prototype.isPureReactComponent?!hc(c,f)||!hc(m,x):!0}function Bg(a,s,c,f){a=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(c,f),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(c,f),s.state!==a&&rh.enqueueReplaceState(s,s.state,null)}function ms(a,s){var c=s;if("ref"in s){c={};for(var f in s)f!=="ref"&&(c[f]=s[f])}if(a=a.defaultProps){c===s&&(c=p({},c));for(var m in a)c[m]===void 0&&(c[m]=a[m])}return c}function Ig(a){Wo(a)}function Ug(a){console.error(a)}function jg(a){Wo(a)}function p0(a,s){try{var c=a.onUncaughtError;c(s.value,{componentStack:s.stack})}catch(f){setTimeout(function(){throw f})}}function Pg(a,s,c){try{var f=a.onCaughtError;f(c.value,{componentStack:c.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function ah(a,s,c){return c=Si(c),c.tag=3,c.payload={element:null},c.callback=function(){p0(a,s)},c}function zg(a){return a=Si(a),a.tag=3,a}function Hg(a,s,c,f){var m=c.type.getDerivedStateFromError;if(typeof m=="function"){var x=f.value;a.payload=function(){return m(x)},a.callback=function(){Pg(s,c,f)}}var E=c.stateNode;E!==null&&typeof E.componentDidCatch=="function"&&(a.callback=function(){Pg(s,c,f),typeof m!="function"&&(Oi===null?Oi=new Set([this]):Oi.add(this));var O=f.stack;this.componentDidCatch(f.value,{componentStack:O!==null?O:""})})}function db(a,s,c,f,m){if(c.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){if(s=c.alternate,s!==null&&al(s,c,m,!0),c=Da.current,c!==null){switch(c.tag){case 31:case 13:return en===null?N0():c.alternate===null&&or===0&&(or=3),c.flags&=-257,c.flags|=65536,c.lanes=m,f===n0?c.flags|=16384:(s=c.updateQueue,s===null?c.updateQueue=new Set([f]):s.add(f),Ch(a,f,m)),!1;case 22:return c.flags|=65536,f===n0?c.flags|=16384:(s=c.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([f])},c.updateQueue=s):(c=s.retryQueue,c===null?s.retryQueue=new Set([f]):c.add(f)),Ch(a,f,m)),!1}throw Error(n(435,c.tag))}return Ch(a,f,m),N0(),!1}if(kt)return s=Da.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=m,f!==bf&&(a=Error(n(422),{cause:f}),gc(Ya(a,c)))):(f!==bf&&(s=Error(n(423),{cause:f}),gc(Ya(s,c))),a=a.current.alternate,a.flags|=65536,m&=-m,a.lanes|=m,f=Ya(f,c),m=ah(a.stateNode,f,m),Ff(a,m),or!==4&&(or=2)),!1;var x=Error(n(520),{cause:f});if(x=Ya(x,c),Mc===null?Mc=[x]:Mc.push(x),or!==4&&(or=2),s===null)return!0;f=Ya(f,c),c=s;do{switch(c.tag){case 3:return c.flags|=65536,a=m&-m,c.lanes|=a,a=ah(c.stateNode,f,a),Ff(c,a),!1;case 1:if(s=c.type,x=c.stateNode,(c.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(Oi===null||!Oi.has(x))))return c.flags|=65536,m&=-m,c.lanes|=m,m=zg(m),Hg(m,a,c,f),Ff(c,m),!1}c=c.return}while(c!==null);return!1}var nh=Error(n(461)),Sr=!1;function Hr(a,s,c,f){s.child=a===null?q1(s,null,c,f):hs(s,a.child,c,f)}function Vg(a,s,c,f,m){c=c.render;var x=s.ref;if("ref"in f){var E={};for(var O in f)O!=="ref"&&(E[O]=f[O])}else E=f;return cs(s),f=jf(a,s,c,E,x,m),O=Pf(),a!==null&&!Sr?(zf(a,s,m),Wn(a,s,m)):(kt&&O&&_f(s),s.flags|=1,Hr(a,s,f,m),s.child)}function $g(a,s,c,f,m){if(a===null){var x=c.type;return typeof x=="function"&&!pf(x)&&x.defaultProps===void 0&&c.compare===null?(s.tag=15,s.type=x,Gg(a,s,x,f,m)):(a=Qo(c.type,null,f,s,s.mode,m),a.ref=s.ref,a.return=s,s.child=a)}if(x=a.child,!hh(a,m)){var E=x.memoizedProps;if(c=c.compare,c=c!==null?c:hc,c(E,f)&&a.ref===s.ref)return Wn(a,s,m)}return s.flags|=1,a=Hn(x,f),a.ref=s.ref,a.return=s,s.child=a}function Gg(a,s,c,f,m){if(a!==null){var x=a.memoizedProps;if(hc(x,f)&&a.ref===s.ref)if(Sr=!1,s.pendingProps=f=x,hh(a,m))(a.flags&131072)!==0&&(Sr=!0);else return s.lanes=a.lanes,Wn(a,s,m)}return ih(a,s,c,f,m)}function qg(a,s,c,f){var m=f.children,x=a!==null?a.memoizedState:null;if(a===null&&s.stateNode===null&&(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),f.mode==="hidden"){if((s.flags&128)!==0){if(x=x!==null?x.baseLanes|c:c,a!==null){for(f=s.child=a.child,m=0;f!==null;)m=m|f.lanes|f.childLanes,f=f.sibling;f=m&~x}else f=0,s.child=null;return Xg(a,s,x,c,f)}if((c&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},a!==null&&r0(s,x!==null?x.cachePool:null),x!==null?K1(s,x):Lf(),Y1(s);else return f=s.lanes=536870912,Xg(a,s,x!==null?x.baseLanes|c:c,c,f)}else x!==null?(r0(s,x.cachePool),K1(s,x),ki(),s.memoizedState=null):(a!==null&&r0(s,null),Lf(),ki());return Hr(a,s,m,c),s.child}function Ac(a,s){return a!==null&&a.tag===22||s.stateNode!==null||(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),s.sibling}function Xg(a,s,c,f,m){var x=Nf();return x=x===null?null:{parent:wr._currentValue,pool:x},s.memoizedState={baseLanes:c,cachePool:x},a!==null&&r0(s,null),Lf(),Y1(s),a!==null&&al(a,s,f,!0),s.childLanes=m,null}function v0(a,s){return s=_0({mode:s.mode,children:s.children},a.mode),s.ref=a.ref,a.child=s,s.return=a,s}function Wg(a,s,c){return hs(s,a.child,null,c),a=v0(s,s.pendingProps),a.flags|=2,Fa(s),s.memoizedState=null,a}function mb(a,s,c){var f=s.pendingProps,m=(s.flags&128)!==0;if(s.flags&=-129,a===null){if(kt){if(f.mode==="hidden")return a=v0(s,f),s.lanes=536870912,Ac(null,a);if(If(s),(a=Jt)?(a=sp(a,Za),a=a!==null&&a.data==="&"?a:null,a!==null&&(s.memoizedState={dehydrated:a,treeContext:vi!==null?{id:An,overflow:Cn}:null,retryLane:536870912,hydrationErrors:null},c=R1(a),c.return=s,s.child=c,Pr=s,Jt=null)):a=null,a===null)throw _i(s);return s.lanes=536870912,null}return v0(s,f)}var x=a.memoizedState;if(x!==null){var E=x.dehydrated;if(If(s),m)if(s.flags&256)s.flags&=-257,s=Wg(a,s,c);else if(s.memoizedState!==null)s.child=a.child,s.flags|=128,s=null;else throw Error(n(558));else if(Sr||al(a,s,c,!1),m=(c&a.childLanes)!==0,Sr||m){if(f=Xt,f!==null&&(E=Wa(f,c),E!==0&&E!==x.retryLane))throw x.retryLane=E,ns(a,E),ba(f,a,E),nh;N0(),s=Wg(a,s,c)}else a=x.treeContext,Jt=tn(E.nextSibling),Pr=s,kt=!0,yi=null,Za=!1,a!==null&&M1(s,a),s=v0(s,f),s.flags|=4096;return s}return a=Hn(a.child,{mode:f.mode,children:f.children}),a.ref=s.ref,s.child=a,a.return=s,a}function y0(a,s){var c=s.ref;if(c===null)a!==null&&a.ref!==null&&(s.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(n(284));(a===null||a.ref!==c)&&(s.flags|=4194816)}}function ih(a,s,c,f,m){return cs(s),c=jf(a,s,c,f,void 0,m),f=Pf(),a!==null&&!Sr?(zf(a,s,m),Wn(a,s,m)):(kt&&f&&_f(s),s.flags|=1,Hr(a,s,c,m),s.child)}function Kg(a,s,c,f,m,x){return cs(s),s.updateQueue=null,c=Q1(s,f,c,m),J1(a),f=Pf(),a!==null&&!Sr?(zf(a,s,x),Wn(a,s,x)):(kt&&f&&_f(s),s.flags|=1,Hr(a,s,c,x),s.child)}function Yg(a,s,c,f,m){if(cs(s),s.stateNode===null){var x=Zs,E=c.contextType;typeof E=="object"&&E!==null&&(x=zr(E)),x=new c(f,x),s.memoizedState=x.state!==null&&x.state!==void 0?x.state:null,x.updater=rh,s.stateNode=x,x._reactInternals=s,x=s.stateNode,x.props=f,x.state=s.memoizedState,x.refs={},Rf(s),E=c.contextType,x.context=typeof E=="object"&&E!==null?zr(E):Zs,x.state=s.memoizedState,E=c.getDerivedStateFromProps,typeof E=="function"&&(th(s,c,E,f),x.state=s.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof x.getSnapshotBeforeUpdate=="function"||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(E=x.state,typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount(),E!==x.state&&rh.enqueueReplaceState(x,x.state,null),bc(s,f,x,m),wc(),x.state=s.memoizedState),typeof x.componentDidMount=="function"&&(s.flags|=4194308),f=!0}else if(a===null){x=s.stateNode;var O=s.memoizedProps,K=ms(c,O);x.props=K;var le=x.context,ye=c.contextType;E=Zs,typeof ye=="object"&&ye!==null&&(E=zr(ye));var Ee=c.getDerivedStateFromProps;ye=typeof Ee=="function"||typeof x.getSnapshotBeforeUpdate=="function",O=s.pendingProps!==O,ye||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(O||le!==E)&&Bg(s,x,f,E),bi=!1;var de=s.memoizedState;x.state=de,bc(s,f,x,m),wc(),le=s.memoizedState,O||de!==le||bi?(typeof Ee=="function"&&(th(s,c,Ee,f),le=s.memoizedState),(K=bi||Lg(s,c,K,f,de,le,E))?(ye||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount()),typeof x.componentDidMount=="function"&&(s.flags|=4194308)):(typeof x.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=f,s.memoizedState=le),x.props=f,x.state=le,x.context=E,f=K):(typeof x.componentDidMount=="function"&&(s.flags|=4194308),f=!1)}else{x=s.stateNode,Df(a,s),E=s.memoizedProps,ye=ms(c,E),x.props=ye,Ee=s.pendingProps,de=x.context,le=c.contextType,K=Zs,typeof le=="object"&&le!==null&&(K=zr(le)),O=c.getDerivedStateFromProps,(le=typeof O=="function"||typeof x.getSnapshotBeforeUpdate=="function")||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(E!==Ee||de!==K)&&Bg(s,x,f,K),bi=!1,de=s.memoizedState,x.state=de,bc(s,f,x,m),wc();var me=s.memoizedState;E!==Ee||de!==me||bi||a!==null&&a.dependencies!==null&&e0(a.dependencies)?(typeof O=="function"&&(th(s,c,O,f),me=s.memoizedState),(ye=bi||Lg(s,c,ye,f,de,me,K)||a!==null&&a.dependencies!==null&&e0(a.dependencies))?(le||typeof x.UNSAFE_componentWillUpdate!="function"&&typeof x.componentWillUpdate!="function"||(typeof x.componentWillUpdate=="function"&&x.componentWillUpdate(f,me,K),typeof x.UNSAFE_componentWillUpdate=="function"&&x.UNSAFE_componentWillUpdate(f,me,K)),typeof x.componentDidUpdate=="function"&&(s.flags|=4),typeof x.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof x.componentDidUpdate!="function"||E===a.memoizedProps&&de===a.memoizedState||(s.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||E===a.memoizedProps&&de===a.memoizedState||(s.flags|=1024),s.memoizedProps=f,s.memoizedState=me),x.props=f,x.state=me,x.context=K,f=ye):(typeof x.componentDidUpdate!="function"||E===a.memoizedProps&&de===a.memoizedState||(s.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||E===a.memoizedProps&&de===a.memoizedState||(s.flags|=1024),f=!1)}return x=f,y0(a,s),f=(s.flags&128)!==0,x||f?(x=s.stateNode,c=f&&typeof c.getDerivedStateFromError!="function"?null:x.render(),s.flags|=1,a!==null&&f?(s.child=hs(s,a.child,null,m),s.child=hs(s,null,c,m)):Hr(a,s,c,m),s.memoizedState=x.state,a=s.child):a=Wn(a,s,m),a}function Jg(a,s,c,f){return ss(),s.flags|=256,Hr(a,s,c,f),s.child}var sh={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function lh(a){return{baseLanes:a,cachePool:P1()}}function ch(a,s,c){return a=a!==null?a.childLanes&~c:0,s&&(a|=La),a}function Qg(a,s,c){var f=s.pendingProps,m=!1,x=(s.flags&128)!==0,E;if((E=x)||(E=a!==null&&a.memoizedState===null?!1:(xr.current&2)!==0),E&&(m=!0,s.flags&=-129),E=(s.flags&32)!==0,s.flags&=-33,a===null){if(kt){if(m?Ti(s):ki(),(a=Jt)?(a=sp(a,Za),a=a!==null&&a.data!=="&"?a:null,a!==null&&(s.memoizedState={dehydrated:a,treeContext:vi!==null?{id:An,overflow:Cn}:null,retryLane:536870912,hydrationErrors:null},c=R1(a),c.return=s,s.child=c,Pr=s,Jt=null)):a=null,a===null)throw _i(s);return $h(a)?s.lanes=32:s.lanes=536870912,null}var O=f.children;return f=f.fallback,m?(ki(),m=s.mode,O=_0({mode:"hidden",children:O},m),f=is(f,m,c,null),O.return=s,f.return=s,O.sibling=f,s.child=O,f=s.child,f.memoizedState=lh(c),f.childLanes=ch(a,E,c),s.memoizedState=sh,Ac(null,f)):(Ti(s),oh(s,O))}var K=a.memoizedState;if(K!==null&&(O=K.dehydrated,O!==null)){if(x)s.flags&256?(Ti(s),s.flags&=-257,s=uh(a,s,c)):s.memoizedState!==null?(ki(),s.child=a.child,s.flags|=128,s=null):(ki(),O=f.fallback,m=s.mode,f=_0({mode:"visible",children:f.children},m),O=is(O,m,c,null),O.flags|=2,f.return=s,O.return=s,f.sibling=O,s.child=f,hs(s,a.child,null,c),f=s.child,f.memoizedState=lh(c),f.childLanes=ch(a,E,c),s.memoizedState=sh,s=Ac(null,f));else if(Ti(s),$h(O)){if(E=O.nextSibling&&O.nextSibling.dataset,E)var le=E.dgst;E=le,f=Error(n(419)),f.stack="",f.digest=E,gc({value:f,source:null,stack:null}),s=uh(a,s,c)}else if(Sr||al(a,s,c,!1),E=(c&a.childLanes)!==0,Sr||E){if(E=Xt,E!==null&&(f=Wa(E,c),f!==0&&f!==K.retryLane))throw K.retryLane=f,ns(a,f),ba(E,a,f),nh;Vh(O)||N0(),s=uh(a,s,c)}else Vh(O)?(s.flags|=192,s.child=a.child,s=null):(a=K.treeContext,Jt=tn(O.nextSibling),Pr=s,kt=!0,yi=null,Za=!1,a!==null&&M1(s,a),s=oh(s,f.children),s.flags|=4096);return s}return m?(ki(),O=f.fallback,m=s.mode,K=a.child,le=K.sibling,f=Hn(K,{mode:"hidden",children:f.children}),f.subtreeFlags=K.subtreeFlags&65011712,le!==null?O=Hn(le,O):(O=is(O,m,c,null),O.flags|=2),O.return=s,f.return=s,f.sibling=O,s.child=f,Ac(null,f),f=s.child,O=a.child.memoizedState,O===null?O=lh(c):(m=O.cachePool,m!==null?(K=wr._currentValue,m=m.parent!==K?{parent:K,pool:K}:m):m=P1(),O={baseLanes:O.baseLanes|c,cachePool:m}),f.memoizedState=O,f.childLanes=ch(a,E,c),s.memoizedState=sh,Ac(a.child,f)):(Ti(s),c=a.child,a=c.sibling,c=Hn(c,{mode:"visible",children:f.children}),c.return=s,c.sibling=null,a!==null&&(E=s.deletions,E===null?(s.deletions=[a],s.flags|=16):E.push(a)),s.child=c,s.memoizedState=null,c)}function oh(a,s){return s=_0({mode:"visible",children:s},a.mode),s.return=a,a.child=s}function _0(a,s){return a=Ra(22,a,null,s),a.lanes=0,a}function uh(a,s,c){return hs(s,a.child,null,c),a=oh(s,s.pendingProps.children),a.flags|=2,s.memoizedState=null,a}function Zg(a,s,c){a.lanes|=s;var f=a.alternate;f!==null&&(f.lanes|=s),Tf(a.return,s,c)}function fh(a,s,c,f,m,x){var E=a.memoizedState;E===null?a.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:f,tail:c,tailMode:m,treeForkCount:x}:(E.isBackwards=s,E.rendering=null,E.renderingStartTime=0,E.last=f,E.tail=c,E.tailMode=m,E.treeForkCount=x)}function ex(a,s,c){var f=s.pendingProps,m=f.revealOrder,x=f.tail;f=f.children;var E=xr.current,O=(E&2)!==0;if(O?(E=E&1|2,s.flags|=128):E&=1,z(xr,E),Hr(a,s,f,c),f=kt?mc:0,!O&&a!==null&&(a.flags&128)!==0)e:for(a=s.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&Zg(a,c,s);else if(a.tag===19)Zg(a,c,s);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break e;for(;a.sibling===null;){if(a.return===null||a.return===s)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}switch(m){case"forwards":for(c=s.child,m=null;c!==null;)a=c.alternate,a!==null&&c0(a)===null&&(m=c),c=c.sibling;c=m,c===null?(m=s.child,s.child=null):(m=c.sibling,c.sibling=null),fh(s,!1,m,c,x,f);break;case"backwards":case"unstable_legacy-backwards":for(c=null,m=s.child,s.child=null;m!==null;){if(a=m.alternate,a!==null&&c0(a)===null){s.child=m;break}a=m.sibling,m.sibling=c,c=m,m=a}fh(s,!0,c,null,x,f);break;case"together":fh(s,!1,null,null,void 0,f);break;default:s.memoizedState=null}return s.child}function Wn(a,s,c){if(a!==null&&(s.dependencies=a.dependencies),Ni|=s.lanes,(c&s.childLanes)===0)if(a!==null){if(al(a,s,c,!1),(c&s.childLanes)===0)return null}else return null;if(a!==null&&s.child!==a.child)throw Error(n(153));if(s.child!==null){for(a=s.child,c=Hn(a,a.pendingProps),s.child=c,c.return=s;a.sibling!==null;)a=a.sibling,c=c.sibling=Hn(a,a.pendingProps),c.return=s;c.sibling=null}return s.child}function hh(a,s){return(a.lanes&s)!==0?!0:(a=a.dependencies,!!(a!==null&&e0(a)))}function gb(a,s,c){switch(s.tag){case 3:Te(s,s.stateNode.containerInfo),wi(s,wr,a.memoizedState.cache),ss();break;case 27:case 5:Ne(s);break;case 4:Te(s,s.stateNode.containerInfo);break;case 10:wi(s,s.type,s.memoizedProps.value);break;case 31:if(s.memoizedState!==null)return s.flags|=128,If(s),null;break;case 13:var f=s.memoizedState;if(f!==null)return f.dehydrated!==null?(Ti(s),s.flags|=128,null):(c&s.child.childLanes)!==0?Qg(a,s,c):(Ti(s),a=Wn(a,s,c),a!==null?a.sibling:null);Ti(s);break;case 19:var m=(a.flags&128)!==0;if(f=(c&s.childLanes)!==0,f||(al(a,s,c,!1),f=(c&s.childLanes)!==0),m){if(f)return ex(a,s,c);s.flags|=128}if(m=s.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),z(xr,xr.current),f)break;return null;case 22:return s.lanes=0,qg(a,s,c,s.pendingProps);case 24:wi(s,wr,a.memoizedState.cache)}return Wn(a,s,c)}function tx(a,s,c){if(a!==null)if(a.memoizedProps!==s.pendingProps)Sr=!0;else{if(!hh(a,c)&&(s.flags&128)===0)return Sr=!1,gb(a,s,c);Sr=(a.flags&131072)!==0}else Sr=!1,kt&&(s.flags&1048576)!==0&&F1(s,mc,s.index);switch(s.lanes=0,s.tag){case 16:e:{var f=s.pendingProps;if(a=us(s.elementType),s.type=a,typeof a=="function")pf(a)?(f=ms(a,f),s.tag=1,s=Yg(null,s,a,f,c)):(s.tag=0,s=ih(null,s,a,f,c));else{if(a!=null){var m=a.$$typeof;if(m===B){s.tag=11,s=Vg(null,s,a,f,c);break e}else if(m===N){s.tag=14,s=$g(null,s,a,f,c);break e}}throw s=Ce(a)||a,Error(n(306,s,""))}}return s;case 0:return ih(a,s,s.type,s.pendingProps,c);case 1:return f=s.type,m=ms(f,s.pendingProps),Yg(a,s,f,m,c);case 3:e:{if(Te(s,s.stateNode.containerInfo),a===null)throw Error(n(387));f=s.pendingProps;var x=s.memoizedState;m=x.element,Df(a,s),bc(s,f,null,c);var E=s.memoizedState;if(f=E.cache,wi(s,wr,f),f!==x.cache&&kf(s,[wr],c,!0),wc(),f=E.element,x.isDehydrated)if(x={element:f,isDehydrated:!1,cache:E.cache},s.updateQueue.baseState=x,s.memoizedState=x,s.flags&256){s=Jg(a,s,f,c);break e}else if(f!==m){m=Ya(Error(n(424)),s),gc(m),s=Jg(a,s,f,c);break e}else for(a=s.stateNode.containerInfo,a.nodeType===9?a=a.body:a=a.nodeName==="HTML"?a.ownerDocument.body:a,Jt=tn(a.firstChild),Pr=s,kt=!0,yi=null,Za=!0,c=q1(s,null,f,c),s.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling;else{if(ss(),f===m){s=Wn(a,s,c);break e}Hr(a,s,f,c)}s=s.child}return s;case 26:return y0(a,s),a===null?(c=hp(s.type,null,s.pendingProps,null))?s.memoizedState=c:kt||(c=s.type,a=s.pendingProps,f=B0(ne.current).createElement(c),f[F]=s,f[L]=a,Vr(f,c,a),re(f),s.stateNode=f):s.memoizedState=hp(s.type,a.memoizedProps,s.pendingProps,a.memoizedState),null;case 27:return Ne(s),a===null&&kt&&(f=s.stateNode=op(s.type,s.pendingProps,ne.current),Pr=s,Za=!0,m=Jt,Mi(s.type)?(Gh=m,Jt=tn(f.firstChild)):Jt=m),Hr(a,s,s.pendingProps.children,c),y0(a,s),a===null&&(s.flags|=4194304),s.child;case 5:return a===null&&kt&&((m=f=Jt)&&(f=Gb(f,s.type,s.pendingProps,Za),f!==null?(s.stateNode=f,Pr=s,Jt=tn(f.firstChild),Za=!1,m=!0):m=!1),m||_i(s)),Ne(s),m=s.type,x=s.pendingProps,E=a!==null?a.memoizedProps:null,f=x.children,Ph(m,x)?f=null:E!==null&&Ph(m,E)&&(s.flags|=32),s.memoizedState!==null&&(m=jf(a,s,sb,null,null,c),Hc._currentValue=m),y0(a,s),Hr(a,s,f,c),s.child;case 6:return a===null&&kt&&((a=c=Jt)&&(c=qb(c,s.pendingProps,Za),c!==null?(s.stateNode=c,Pr=s,Jt=null,a=!0):a=!1),a||_i(s)),null;case 13:return Qg(a,s,c);case 4:return Te(s,s.stateNode.containerInfo),f=s.pendingProps,a===null?s.child=hs(s,null,f,c):Hr(a,s,f,c),s.child;case 11:return Vg(a,s,s.type,s.pendingProps,c);case 7:return Hr(a,s,s.pendingProps,c),s.child;case 8:return Hr(a,s,s.pendingProps.children,c),s.child;case 12:return Hr(a,s,s.pendingProps.children,c),s.child;case 10:return f=s.pendingProps,wi(s,s.type,f.value),Hr(a,s,f.children,c),s.child;case 9:return m=s.type._context,f=s.pendingProps.children,cs(s),m=zr(m),f=f(m),s.flags|=1,Hr(a,s,f,c),s.child;case 14:return $g(a,s,s.type,s.pendingProps,c);case 15:return Gg(a,s,s.type,s.pendingProps,c);case 19:return ex(a,s,c);case 31:return mb(a,s,c);case 22:return qg(a,s,c,s.pendingProps);case 24:return cs(s),f=zr(wr),a===null?(m=Nf(),m===null&&(m=Xt,x=Af(),m.pooledCache=x,x.refCount++,x!==null&&(m.pooledCacheLanes|=c),m=x),s.memoizedState={parent:f,cache:m},Rf(s),wi(s,wr,m)):((a.lanes&c)!==0&&(Df(a,s),bc(s,null,null,c),wc()),m=a.memoizedState,x=s.memoizedState,m.parent!==f?(m={parent:f,cache:f},s.memoizedState=m,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=m),wi(s,wr,f)):(f=x.cache,wi(s,wr,f),f!==m.cache&&kf(s,[wr],c,!0))),Hr(a,s,s.pendingProps.children,c),s.child;case 29:throw s.pendingProps}throw Error(n(156,s.tag))}function Kn(a){a.flags|=4}function dh(a,s,c,f,m){if((s=(a.mode&32)!==0)&&(s=!1),s){if(a.flags|=16777216,(m&335544128)===m)if(a.stateNode.complete)a.flags|=8192;else if(Cx())a.flags|=8192;else throw fs=n0,Of}else a.flags&=-16777217}function rx(a,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)a.flags&=-16777217;else if(a.flags|=16777216,!pp(s))if(Cx())a.flags|=8192;else throw fs=n0,Of}function w0(a,s){s!==null&&(a.flags|=4),a.flags&16384&&(s=a.tag!==22?gi():536870912,a.lanes|=s,gl|=s)}function Cc(a,s){if(!kt)switch(a.tailMode){case"hidden":s=a.tail;for(var c=null;s!==null;)s.alternate!==null&&(c=s),s=s.sibling;c===null?a.tail=null:c.sibling=null;break;case"collapsed":c=a.tail;for(var f=null;c!==null;)c.alternate!==null&&(f=c),c=c.sibling;f===null?s||a.tail===null?a.tail=null:a.tail.sibling=null:f.sibling=null}}function Qt(a){var s=a.alternate!==null&&a.alternate.child===a.child,c=0,f=0;if(s)for(var m=a.child;m!==null;)c|=m.lanes|m.childLanes,f|=m.subtreeFlags&65011712,f|=m.flags&65011712,m.return=a,m=m.sibling;else for(m=a.child;m!==null;)c|=m.lanes|m.childLanes,f|=m.subtreeFlags,f|=m.flags,m.return=a,m=m.sibling;return a.subtreeFlags|=f,a.childLanes=c,s}function xb(a,s,c){var f=s.pendingProps;switch(wf(s),s.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Qt(s),null;case 1:return Qt(s),null;case 3:return c=s.stateNode,f=null,a!==null&&(f=a.memoizedState.cache),s.memoizedState.cache!==f&&(s.flags|=2048),Gn(wr),Se(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(a===null||a.child===null)&&(rl(s)?Kn(s):a===null||a.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,Sf())),Qt(s),null;case 26:var m=s.type,x=s.memoizedState;return a===null?(Kn(s),x!==null?(Qt(s),rx(s,x)):(Qt(s),dh(s,m,null,f,c))):x?x!==a.memoizedState?(Kn(s),Qt(s),rx(s,x)):(Qt(s),s.flags&=-16777217):(a=a.memoizedProps,a!==f&&Kn(s),Qt(s),dh(s,m,a,f,c)),null;case 27:if(ot(s),c=ne.current,m=s.type,a!==null&&s.stateNode!=null)a.memoizedProps!==f&&Kn(s);else{if(!f){if(s.stateNode===null)throw Error(n(166));return Qt(s),null}a=U.current,rl(s)?L1(s):(a=op(m,f,c),s.stateNode=a,Kn(s))}return Qt(s),null;case 5:if(ot(s),m=s.type,a!==null&&s.stateNode!=null)a.memoizedProps!==f&&Kn(s);else{if(!f){if(s.stateNode===null)throw Error(n(166));return Qt(s),null}if(x=U.current,rl(s))L1(s);else{var E=B0(ne.current);switch(x){case 1:x=E.createElementNS("http://www.w3.org/2000/svg",m);break;case 2:x=E.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;default:switch(m){case"svg":x=E.createElementNS("http://www.w3.org/2000/svg",m);break;case"math":x=E.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;case"script":x=E.createElement("div"),x.innerHTML="<script><\/script>",x=x.removeChild(x.firstChild);break;case"select":x=typeof f.is=="string"?E.createElement("select",{is:f.is}):E.createElement("select"),f.multiple?x.multiple=!0:f.size&&(x.size=f.size);break;default:x=typeof f.is=="string"?E.createElement(m,{is:f.is}):E.createElement(m)}}x[F]=s,x[L]=f;e:for(E=s.child;E!==null;){if(E.tag===5||E.tag===6)x.appendChild(E.stateNode);else if(E.tag!==4&&E.tag!==27&&E.child!==null){E.child.return=E,E=E.child;continue}if(E===s)break e;for(;E.sibling===null;){if(E.return===null||E.return===s)break e;E=E.return}E.sibling.return=E.return,E=E.sibling}s.stateNode=x;e:switch(Vr(x,m,f),m){case"button":case"input":case"select":case"textarea":f=!!f.autoFocus;break e;case"img":f=!0;break e;default:f=!1}f&&Kn(s)}}return Qt(s),dh(s,s.type,a===null?null:a.memoizedProps,s.pendingProps,c),null;case 6:if(a&&s.stateNode!=null)a.memoizedProps!==f&&Kn(s);else{if(typeof f!="string"&&s.stateNode===null)throw Error(n(166));if(a=ne.current,rl(s)){if(a=s.stateNode,c=s.memoizedProps,f=null,m=Pr,m!==null)switch(m.tag){case 27:case 5:f=m.memoizedProps}a[F]=s,a=!!(a.nodeValue===c||f!==null&&f.suppressHydrationWarning===!0||Qx(a.nodeValue,c)),a||_i(s,!0)}else a=B0(a).createTextNode(f),a[F]=s,s.stateNode=a}return Qt(s),null;case 31:if(c=s.memoizedState,a===null||a.memoizedState!==null){if(f=rl(s),c!==null){if(a===null){if(!f)throw Error(n(318));if(a=s.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(n(557));a[F]=s}else ss(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;Qt(s),a=!1}else c=Sf(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=c),a=!0;if(!a)return s.flags&256?(Fa(s),s):(Fa(s),null);if((s.flags&128)!==0)throw Error(n(558))}return Qt(s),null;case 13:if(f=s.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(m=rl(s),f!==null&&f.dehydrated!==null){if(a===null){if(!m)throw Error(n(318));if(m=s.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(n(317));m[F]=s}else ss(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;Qt(s),m=!1}else m=Sf(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=m),m=!0;if(!m)return s.flags&256?(Fa(s),s):(Fa(s),null)}return Fa(s),(s.flags&128)!==0?(s.lanes=c,s):(c=f!==null,a=a!==null&&a.memoizedState!==null,c&&(f=s.child,m=null,f.alternate!==null&&f.alternate.memoizedState!==null&&f.alternate.memoizedState.cachePool!==null&&(m=f.alternate.memoizedState.cachePool.pool),x=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(x=f.memoizedState.cachePool.pool),x!==m&&(f.flags|=2048)),c!==a&&c&&(s.child.flags|=8192),w0(s,s.updateQueue),Qt(s),null);case 4:return Se(),a===null&&Lh(s.stateNode.containerInfo),Qt(s),null;case 10:return Gn(s.type),Qt(s),null;case 19:if(A(xr),f=s.memoizedState,f===null)return Qt(s),null;if(m=(s.flags&128)!==0,x=f.rendering,x===null)if(m)Cc(f,!1);else{if(or!==0||a!==null&&(a.flags&128)!==0)for(a=s.child;a!==null;){if(x=c0(a),x!==null){for(s.flags|=128,Cc(f,!1),a=x.updateQueue,s.updateQueue=a,w0(s,a),s.subtreeFlags=0,a=c,c=s.child;c!==null;)O1(c,a),c=c.sibling;return z(xr,xr.current&1|2),kt&&Vn(s,f.treeForkCount),s.child}a=a.sibling}f.tail!==null&&_t()>k0&&(s.flags|=128,m=!0,Cc(f,!1),s.lanes=4194304)}else{if(!m)if(a=c0(x),a!==null){if(s.flags|=128,m=!0,a=a.updateQueue,s.updateQueue=a,w0(s,a),Cc(f,!0),f.tail===null&&f.tailMode==="hidden"&&!x.alternate&&!kt)return Qt(s),null}else 2*_t()-f.renderingStartTime>k0&&c!==536870912&&(s.flags|=128,m=!0,Cc(f,!1),s.lanes=4194304);f.isBackwards?(x.sibling=s.child,s.child=x):(a=f.last,a!==null?a.sibling=x:s.child=x,f.last=x)}return f.tail!==null?(a=f.tail,f.rendering=a,f.tail=a.sibling,f.renderingStartTime=_t(),a.sibling=null,c=xr.current,z(xr,m?c&1|2:c&1),kt&&Vn(s,f.treeForkCount),a):(Qt(s),null);case 22:case 23:return Fa(s),Bf(),f=s.memoizedState!==null,a!==null?a.memoizedState!==null!==f&&(s.flags|=8192):f&&(s.flags|=8192),f?(c&536870912)!==0&&(s.flags&128)===0&&(Qt(s),s.subtreeFlags&6&&(s.flags|=8192)):Qt(s),c=s.updateQueue,c!==null&&w0(s,c.retryQueue),c=null,a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(c=a.memoizedState.cachePool.pool),f=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(f=s.memoizedState.cachePool.pool),f!==c&&(s.flags|=2048),a!==null&&A(os),null;case 24:return c=null,a!==null&&(c=a.memoizedState.cache),s.memoizedState.cache!==c&&(s.flags|=2048),Gn(wr),Qt(s),null;case 25:return null;case 30:return null}throw Error(n(156,s.tag))}function pb(a,s){switch(wf(s),s.tag){case 1:return a=s.flags,a&65536?(s.flags=a&-65537|128,s):null;case 3:return Gn(wr),Se(),a=s.flags,(a&65536)!==0&&(a&128)===0?(s.flags=a&-65537|128,s):null;case 26:case 27:case 5:return ot(s),null;case 31:if(s.memoizedState!==null){if(Fa(s),s.alternate===null)throw Error(n(340));ss()}return a=s.flags,a&65536?(s.flags=a&-65537|128,s):null;case 13:if(Fa(s),a=s.memoizedState,a!==null&&a.dehydrated!==null){if(s.alternate===null)throw Error(n(340));ss()}return a=s.flags,a&65536?(s.flags=a&-65537|128,s):null;case 19:return A(xr),null;case 4:return Se(),null;case 10:return Gn(s.type),null;case 22:case 23:return Fa(s),Bf(),a!==null&&A(os),a=s.flags,a&65536?(s.flags=a&-65537|128,s):null;case 24:return Gn(wr),null;case 25:return null;default:return null}}function ax(a,s){switch(wf(s),s.tag){case 3:Gn(wr),Se();break;case 26:case 27:case 5:ot(s);break;case 4:Se();break;case 31:s.memoizedState!==null&&Fa(s);break;case 13:Fa(s);break;case 19:A(xr);break;case 10:Gn(s.type);break;case 22:case 23:Fa(s),Bf(),a!==null&&A(os);break;case 24:Gn(wr)}}function Nc(a,s){try{var c=s.updateQueue,f=c!==null?c.lastEffect:null;if(f!==null){var m=f.next;c=m;do{if((c.tag&a)===a){f=void 0;var x=c.create,E=c.inst;f=x(),E.destroy=f}c=c.next}while(c!==m)}}catch(O){Bt(s,s.return,O)}}function Ai(a,s,c){try{var f=s.updateQueue,m=f!==null?f.lastEffect:null;if(m!==null){var x=m.next;f=x;do{if((f.tag&a)===a){var E=f.inst,O=E.destroy;if(O!==void 0){E.destroy=void 0,m=s;var K=c,le=O;try{le()}catch(ye){Bt(m,K,ye)}}}f=f.next}while(f!==x)}}catch(ye){Bt(s,s.return,ye)}}function nx(a){var s=a.updateQueue;if(s!==null){var c=a.stateNode;try{W1(s,c)}catch(f){Bt(a,a.return,f)}}}function ix(a,s,c){c.props=ms(a.type,a.memoizedProps),c.state=a.memoizedState;try{c.componentWillUnmount()}catch(f){Bt(a,s,f)}}function Oc(a,s){try{var c=a.ref;if(c!==null){switch(a.tag){case 26:case 27:case 5:var f=a.stateNode;break;case 30:f=a.stateNode;break;default:f=a.stateNode}typeof c=="function"?a.refCleanup=c(f):c.current=f}}catch(m){Bt(a,s,m)}}function Nn(a,s){var c=a.ref,f=a.refCleanup;if(c!==null)if(typeof f=="function")try{f()}catch(m){Bt(a,s,m)}finally{a.refCleanup=null,a=a.alternate,a!=null&&(a.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(m){Bt(a,s,m)}else c.current=null}function sx(a){var s=a.type,c=a.memoizedProps,f=a.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":c.autoFocus&&f.focus();break e;case"img":c.src?f.src=c.src:c.srcSet&&(f.srcset=c.srcSet)}}catch(m){Bt(a,a.return,m)}}function mh(a,s,c){try{var f=a.stateNode;jb(f,a.type,c,s),f[L]=s}catch(m){Bt(a,a.return,m)}}function lx(a){return a.tag===5||a.tag===3||a.tag===26||a.tag===27&&Mi(a.type)||a.tag===4}function gh(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||lx(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.tag===27&&Mi(a.type)||a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function xh(a,s,c){var f=a.tag;if(f===5||f===6)a=a.stateNode,s?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(a,s):(s=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,s.appendChild(a),c=c._reactRootContainer,c!=null||s.onclick!==null||(s.onclick=Pn));else if(f!==4&&(f===27&&Mi(a.type)&&(c=a.stateNode,s=null),a=a.child,a!==null))for(xh(a,s,c),a=a.sibling;a!==null;)xh(a,s,c),a=a.sibling}function b0(a,s,c){var f=a.tag;if(f===5||f===6)a=a.stateNode,s?c.insertBefore(a,s):c.appendChild(a);else if(f!==4&&(f===27&&Mi(a.type)&&(c=a.stateNode),a=a.child,a!==null))for(b0(a,s,c),a=a.sibling;a!==null;)b0(a,s,c),a=a.sibling}function cx(a){var s=a.stateNode,c=a.memoizedProps;try{for(var f=a.type,m=s.attributes;m.length;)s.removeAttributeNode(m[0]);Vr(s,f,c),s[F]=a,s[L]=c}catch(x){Bt(a,a.return,x)}}var Yn=!1,Er=!1,ph=!1,ox=typeof WeakSet=="function"?WeakSet:Set,Lr=null;function vb(a,s){if(a=a.containerInfo,Uh=V0,a=w1(a),uf(a)){if("selectionStart"in a)var c={start:a.selectionStart,end:a.selectionEnd};else e:{c=(c=a.ownerDocument)&&c.defaultView||window;var f=c.getSelection&&c.getSelection();if(f&&f.rangeCount!==0){c=f.anchorNode;var m=f.anchorOffset,x=f.focusNode;f=f.focusOffset;try{c.nodeType,x.nodeType}catch{c=null;break e}var E=0,O=-1,K=-1,le=0,ye=0,Ee=a,de=null;t:for(;;){for(var me;Ee!==c||m!==0&&Ee.nodeType!==3||(O=E+m),Ee!==x||f!==0&&Ee.nodeType!==3||(K=E+f),Ee.nodeType===3&&(E+=Ee.nodeValue.length),(me=Ee.firstChild)!==null;)de=Ee,Ee=me;for(;;){if(Ee===a)break t;if(de===c&&++le===m&&(O=E),de===x&&++ye===f&&(K=E),(me=Ee.nextSibling)!==null)break;Ee=de,de=Ee.parentNode}Ee=me}c=O===-1||K===-1?null:{start:O,end:K}}else c=null}c=c||{start:0,end:0}}else c=null;for(jh={focusedElem:a,selectionRange:c},V0=!1,Lr=s;Lr!==null;)if(s=Lr,a=s.child,(s.subtreeFlags&1028)!==0&&a!==null)a.return=s,Lr=a;else for(;Lr!==null;){switch(s=Lr,x=s.alternate,a=s.flags,s.tag){case 0:if((a&4)!==0&&(a=s.updateQueue,a=a!==null?a.events:null,a!==null))for(c=0;c<a.length;c++)m=a[c],m.ref.impl=m.nextImpl;break;case 11:case 15:break;case 1:if((a&1024)!==0&&x!==null){a=void 0,c=s,m=x.memoizedProps,x=x.memoizedState,f=c.stateNode;try{var qe=ms(c.type,m);a=f.getSnapshotBeforeUpdate(qe,x),f.__reactInternalSnapshotBeforeUpdate=a}catch(rt){Bt(c,c.return,rt)}}break;case 3:if((a&1024)!==0){if(a=s.stateNode.containerInfo,c=a.nodeType,c===9)Hh(a);else if(c===1)switch(a.nodeName){case"HEAD":case"HTML":case"BODY":Hh(a);break;default:a.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((a&1024)!==0)throw Error(n(163))}if(a=s.sibling,a!==null){a.return=s.return,Lr=a;break}Lr=s.return}}function ux(a,s,c){var f=c.flags;switch(c.tag){case 0:case 11:case 15:Qn(a,c),f&4&&Nc(5,c);break;case 1:if(Qn(a,c),f&4)if(a=c.stateNode,s===null)try{a.componentDidMount()}catch(E){Bt(c,c.return,E)}else{var m=ms(c.type,s.memoizedProps);s=s.memoizedState;try{a.componentDidUpdate(m,s,a.__reactInternalSnapshotBeforeUpdate)}catch(E){Bt(c,c.return,E)}}f&64&&nx(c),f&512&&Oc(c,c.return);break;case 3:if(Qn(a,c),f&64&&(a=c.updateQueue,a!==null)){if(s=null,c.child!==null)switch(c.child.tag){case 27:case 5:s=c.child.stateNode;break;case 1:s=c.child.stateNode}try{W1(a,s)}catch(E){Bt(c,c.return,E)}}break;case 27:s===null&&f&4&&cx(c);case 26:case 5:Qn(a,c),s===null&&f&4&&sx(c),f&512&&Oc(c,c.return);break;case 12:Qn(a,c);break;case 31:Qn(a,c),f&4&&dx(a,c);break;case 13:Qn(a,c),f&4&&mx(a,c),f&64&&(a=c.memoizedState,a!==null&&(a=a.dehydrated,a!==null&&(c=Ab.bind(null,c),Xb(a,c))));break;case 22:if(f=c.memoizedState!==null||Yn,!f){s=s!==null&&s.memoizedState!==null||Er,m=Yn;var x=Er;Yn=f,(Er=s)&&!x?Zn(a,c,(c.subtreeFlags&8772)!==0):Qn(a,c),Yn=m,Er=x}break;case 30:break;default:Qn(a,c)}}function fx(a){var s=a.alternate;s!==null&&(a.alternate=null,fx(s)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(s=a.stateNode,s!==null&&Re(s)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}var rr=null,va=!1;function Jn(a,s,c){for(c=c.child;c!==null;)hx(a,s,c),c=c.sibling}function hx(a,s,c){if(ar&&typeof ar.onCommitFiberUnmount=="function")try{ar.onCommitFiberUnmount(qt,c)}catch{}switch(c.tag){case 26:Er||Nn(c,s),Jn(a,s,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:Er||Nn(c,s);var f=rr,m=va;Mi(c.type)&&(rr=c.stateNode,va=!1),Jn(a,s,c),jc(c.stateNode),rr=f,va=m;break;case 5:Er||Nn(c,s);case 6:if(f=rr,m=va,rr=null,Jn(a,s,c),rr=f,va=m,rr!==null)if(va)try{(rr.nodeType===9?rr.body:rr.nodeName==="HTML"?rr.ownerDocument.body:rr).removeChild(c.stateNode)}catch(x){Bt(c,s,x)}else try{rr.removeChild(c.stateNode)}catch(x){Bt(c,s,x)}break;case 18:rr!==null&&(va?(a=rr,np(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,c.stateNode),Sl(a)):np(rr,c.stateNode));break;case 4:f=rr,m=va,rr=c.stateNode.containerInfo,va=!0,Jn(a,s,c),rr=f,va=m;break;case 0:case 11:case 14:case 15:Ai(2,c,s),Er||Ai(4,c,s),Jn(a,s,c);break;case 1:Er||(Nn(c,s),f=c.stateNode,typeof f.componentWillUnmount=="function"&&ix(c,s,f)),Jn(a,s,c);break;case 21:Jn(a,s,c);break;case 22:Er=(f=Er)||c.memoizedState!==null,Jn(a,s,c),Er=f;break;default:Jn(a,s,c)}}function dx(a,s){if(s.memoizedState===null&&(a=s.alternate,a!==null&&(a=a.memoizedState,a!==null))){a=a.dehydrated;try{Sl(a)}catch(c){Bt(s,s.return,c)}}}function mx(a,s){if(s.memoizedState===null&&(a=s.alternate,a!==null&&(a=a.memoizedState,a!==null&&(a=a.dehydrated,a!==null))))try{Sl(a)}catch(c){Bt(s,s.return,c)}}function yb(a){switch(a.tag){case 31:case 13:case 19:var s=a.stateNode;return s===null&&(s=a.stateNode=new ox),s;case 22:return a=a.stateNode,s=a._retryCache,s===null&&(s=a._retryCache=new ox),s;default:throw Error(n(435,a.tag))}}function S0(a,s){var c=yb(a);s.forEach(function(f){if(!c.has(f)){c.add(f);var m=Cb.bind(null,a,f);f.then(m,m)}})}function ya(a,s){var c=s.deletions;if(c!==null)for(var f=0;f<c.length;f++){var m=c[f],x=a,E=s,O=E;e:for(;O!==null;){switch(O.tag){case 27:if(Mi(O.type)){rr=O.stateNode,va=!1;break e}break;case 5:rr=O.stateNode,va=!1;break e;case 3:case 4:rr=O.stateNode.containerInfo,va=!0;break e}O=O.return}if(rr===null)throw Error(n(160));hx(x,E,m),rr=null,va=!1,x=m.alternate,x!==null&&(x.return=null),m.return=null}if(s.subtreeFlags&13886)for(s=s.child;s!==null;)gx(s,a),s=s.sibling}var mn=null;function gx(a,s){var c=a.alternate,f=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:ya(s,a),_a(a),f&4&&(Ai(3,a,a.return),Nc(3,a),Ai(5,a,a.return));break;case 1:ya(s,a),_a(a),f&512&&(Er||c===null||Nn(c,c.return)),f&64&&Yn&&(a=a.updateQueue,a!==null&&(f=a.callbacks,f!==null&&(c=a.shared.hiddenCallbacks,a.shared.hiddenCallbacks=c===null?f:c.concat(f))));break;case 26:var m=mn;if(ya(s,a),_a(a),f&512&&(Er||c===null||Nn(c,c.return)),f&4){var x=c!==null?c.memoizedState:null;if(f=a.memoizedState,c===null)if(f===null)if(a.stateNode===null){e:{f=a.type,c=a.memoizedProps,m=m.ownerDocument||m;t:switch(f){case"title":x=m.getElementsByTagName("title")[0],(!x||x[fe]||x[F]||x.namespaceURI==="http://www.w3.org/2000/svg"||x.hasAttribute("itemprop"))&&(x=m.createElement(f),m.head.insertBefore(x,m.querySelector("head > title"))),Vr(x,f,c),x[F]=a,re(x),f=x;break e;case"link":var E=gp("link","href",m).get(f+(c.href||""));if(E){for(var O=0;O<E.length;O++)if(x=E[O],x.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&x.getAttribute("rel")===(c.rel==null?null:c.rel)&&x.getAttribute("title")===(c.title==null?null:c.title)&&x.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){E.splice(O,1);break t}}x=m.createElement(f),Vr(x,f,c),m.head.appendChild(x);break;case"meta":if(E=gp("meta","content",m).get(f+(c.content||""))){for(O=0;O<E.length;O++)if(x=E[O],x.getAttribute("content")===(c.content==null?null:""+c.content)&&x.getAttribute("name")===(c.name==null?null:c.name)&&x.getAttribute("property")===(c.property==null?null:c.property)&&x.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&x.getAttribute("charset")===(c.charSet==null?null:c.charSet)){E.splice(O,1);break t}}x=m.createElement(f),Vr(x,f,c),m.head.appendChild(x);break;default:throw Error(n(468,f))}x[F]=a,re(x),f=x}a.stateNode=f}else xp(m,a.type,a.stateNode);else a.stateNode=mp(m,f,a.memoizedProps);else x!==f?(x===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):x.count--,f===null?xp(m,a.type,a.stateNode):mp(m,f,a.memoizedProps)):f===null&&a.stateNode!==null&&mh(a,a.memoizedProps,c.memoizedProps)}break;case 27:ya(s,a),_a(a),f&512&&(Er||c===null||Nn(c,c.return)),c!==null&&f&4&&mh(a,a.memoizedProps,c.memoizedProps);break;case 5:if(ya(s,a),_a(a),f&512&&(Er||c===null||Nn(c,c.return)),a.flags&32){m=a.stateNode;try{qs(m,"")}catch(qe){Bt(a,a.return,qe)}}f&4&&a.stateNode!=null&&(m=a.memoizedProps,mh(a,m,c!==null?c.memoizedProps:m)),f&1024&&(ph=!0);break;case 6:if(ya(s,a),_a(a),f&4){if(a.stateNode===null)throw Error(n(162));f=a.memoizedProps,c=a.stateNode;try{c.nodeValue=f}catch(qe){Bt(a,a.return,qe)}}break;case 3:if(j0=null,m=mn,mn=I0(s.containerInfo),ya(s,a),mn=m,_a(a),f&4&&c!==null&&c.memoizedState.isDehydrated)try{Sl(s.containerInfo)}catch(qe){Bt(a,a.return,qe)}ph&&(ph=!1,xx(a));break;case 4:f=mn,mn=I0(a.stateNode.containerInfo),ya(s,a),_a(a),mn=f;break;case 12:ya(s,a),_a(a);break;case 31:ya(s,a),_a(a),f&4&&(f=a.updateQueue,f!==null&&(a.updateQueue=null,S0(a,f)));break;case 13:ya(s,a),_a(a),a.child.flags&8192&&a.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(T0=_t()),f&4&&(f=a.updateQueue,f!==null&&(a.updateQueue=null,S0(a,f)));break;case 22:m=a.memoizedState!==null;var K=c!==null&&c.memoizedState!==null,le=Yn,ye=Er;if(Yn=le||m,Er=ye||K,ya(s,a),Er=ye,Yn=le,_a(a),f&8192)e:for(s=a.stateNode,s._visibility=m?s._visibility&-2:s._visibility|1,m&&(c===null||K||Yn||Er||gs(a)),c=null,s=a;;){if(s.tag===5||s.tag===26){if(c===null){K=c=s;try{if(x=K.stateNode,m)E=x.style,typeof E.setProperty=="function"?E.setProperty("display","none","important"):E.display="none";else{O=K.stateNode;var Ee=K.memoizedProps.style,de=Ee!=null&&Ee.hasOwnProperty("display")?Ee.display:null;O.style.display=de==null||typeof de=="boolean"?"":(""+de).trim()}}catch(qe){Bt(K,K.return,qe)}}}else if(s.tag===6){if(c===null){K=s;try{K.stateNode.nodeValue=m?"":K.memoizedProps}catch(qe){Bt(K,K.return,qe)}}}else if(s.tag===18){if(c===null){K=s;try{var me=K.stateNode;m?ip(me,!0):ip(K.stateNode,!1)}catch(qe){Bt(K,K.return,qe)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===a)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break e;for(;s.sibling===null;){if(s.return===null||s.return===a)break e;c===s&&(c=null),s=s.return}c===s&&(c=null),s.sibling.return=s.return,s=s.sibling}f&4&&(f=a.updateQueue,f!==null&&(c=f.retryQueue,c!==null&&(f.retryQueue=null,S0(a,c))));break;case 19:ya(s,a),_a(a),f&4&&(f=a.updateQueue,f!==null&&(a.updateQueue=null,S0(a,f)));break;case 30:break;case 21:break;default:ya(s,a),_a(a)}}function _a(a){var s=a.flags;if(s&2){try{for(var c,f=a.return;f!==null;){if(lx(f)){c=f;break}f=f.return}if(c==null)throw Error(n(160));switch(c.tag){case 27:var m=c.stateNode,x=gh(a);b0(a,x,m);break;case 5:var E=c.stateNode;c.flags&32&&(qs(E,""),c.flags&=-33);var O=gh(a);b0(a,O,E);break;case 3:case 4:var K=c.stateNode.containerInfo,le=gh(a);xh(a,le,K);break;default:throw Error(n(161))}}catch(ye){Bt(a,a.return,ye)}a.flags&=-3}s&4096&&(a.flags&=-4097)}function xx(a){if(a.subtreeFlags&1024)for(a=a.child;a!==null;){var s=a;xx(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),a=a.sibling}}function Qn(a,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)ux(a,s.alternate,s),s=s.sibling}function gs(a){for(a=a.child;a!==null;){var s=a;switch(s.tag){case 0:case 11:case 14:case 15:Ai(4,s,s.return),gs(s);break;case 1:Nn(s,s.return);var c=s.stateNode;typeof c.componentWillUnmount=="function"&&ix(s,s.return,c),gs(s);break;case 27:jc(s.stateNode);case 26:case 5:Nn(s,s.return),gs(s);break;case 22:s.memoizedState===null&&gs(s);break;case 30:gs(s);break;default:gs(s)}a=a.sibling}}function Zn(a,s,c){for(c=c&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var f=s.alternate,m=a,x=s,E=x.flags;switch(x.tag){case 0:case 11:case 15:Zn(m,x,c),Nc(4,x);break;case 1:if(Zn(m,x,c),f=x,m=f.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch(le){Bt(f,f.return,le)}if(f=x,m=f.updateQueue,m!==null){var O=f.stateNode;try{var K=m.shared.hiddenCallbacks;if(K!==null)for(m.shared.hiddenCallbacks=null,m=0;m<K.length;m++)X1(K[m],O)}catch(le){Bt(f,f.return,le)}}c&&E&64&&nx(x),Oc(x,x.return);break;case 27:cx(x);case 26:case 5:Zn(m,x,c),c&&f===null&&E&4&&sx(x),Oc(x,x.return);break;case 12:Zn(m,x,c);break;case 31:Zn(m,x,c),c&&E&4&&dx(m,x);break;case 13:Zn(m,x,c),c&&E&4&&mx(m,x);break;case 22:x.memoizedState===null&&Zn(m,x,c),Oc(x,x.return);break;case 30:break;default:Zn(m,x,c)}s=s.sibling}}function vh(a,s){var c=null;a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(c=a.memoizedState.cachePool.pool),a=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(a=s.memoizedState.cachePool.pool),a!==c&&(a!=null&&a.refCount++,c!=null&&xc(c))}function yh(a,s){a=null,s.alternate!==null&&(a=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==a&&(s.refCount++,a!=null&&xc(a))}function gn(a,s,c,f){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)px(a,s,c,f),s=s.sibling}function px(a,s,c,f){var m=s.flags;switch(s.tag){case 0:case 11:case 15:gn(a,s,c,f),m&2048&&Nc(9,s);break;case 1:gn(a,s,c,f);break;case 3:gn(a,s,c,f),m&2048&&(a=null,s.alternate!==null&&(a=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==a&&(s.refCount++,a!=null&&xc(a)));break;case 12:if(m&2048){gn(a,s,c,f),a=s.stateNode;try{var x=s.memoizedProps,E=x.id,O=x.onPostCommit;typeof O=="function"&&O(E,s.alternate===null?"mount":"update",a.passiveEffectDuration,-0)}catch(K){Bt(s,s.return,K)}}else gn(a,s,c,f);break;case 31:gn(a,s,c,f);break;case 13:gn(a,s,c,f);break;case 23:break;case 22:x=s.stateNode,E=s.alternate,s.memoizedState!==null?x._visibility&2?gn(a,s,c,f):Rc(a,s):x._visibility&2?gn(a,s,c,f):(x._visibility|=2,hl(a,s,c,f,(s.subtreeFlags&10256)!==0||!1)),m&2048&&vh(E,s);break;case 24:gn(a,s,c,f),m&2048&&yh(s.alternate,s);break;default:gn(a,s,c,f)}}function hl(a,s,c,f,m){for(m=m&&((s.subtreeFlags&10256)!==0||!1),s=s.child;s!==null;){var x=a,E=s,O=c,K=f,le=E.flags;switch(E.tag){case 0:case 11:case 15:hl(x,E,O,K,m),Nc(8,E);break;case 23:break;case 22:var ye=E.stateNode;E.memoizedState!==null?ye._visibility&2?hl(x,E,O,K,m):Rc(x,E):(ye._visibility|=2,hl(x,E,O,K,m)),m&&le&2048&&vh(E.alternate,E);break;case 24:hl(x,E,O,K,m),m&&le&2048&&yh(E.alternate,E);break;default:hl(x,E,O,K,m)}s=s.sibling}}function Rc(a,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var c=a,f=s,m=f.flags;switch(f.tag){case 22:Rc(c,f),m&2048&&vh(f.alternate,f);break;case 24:Rc(c,f),m&2048&&yh(f.alternate,f);break;default:Rc(c,f)}s=s.sibling}}var Dc=8192;function dl(a,s,c){if(a.subtreeFlags&Dc)for(a=a.child;a!==null;)vx(a,s,c),a=a.sibling}function vx(a,s,c){switch(a.tag){case 26:dl(a,s,c),a.flags&Dc&&a.memoizedState!==null&&iS(c,mn,a.memoizedState,a.memoizedProps);break;case 5:dl(a,s,c);break;case 3:case 4:var f=mn;mn=I0(a.stateNode.containerInfo),dl(a,s,c),mn=f;break;case 22:a.memoizedState===null&&(f=a.alternate,f!==null&&f.memoizedState!==null?(f=Dc,Dc=16777216,dl(a,s,c),Dc=f):dl(a,s,c));break;default:dl(a,s,c)}}function yx(a){var s=a.alternate;if(s!==null&&(a=s.child,a!==null)){s.child=null;do s=a.sibling,a.sibling=null,a=s;while(a!==null)}}function Fc(a){var s=a.deletions;if((a.flags&16)!==0){if(s!==null)for(var c=0;c<s.length;c++){var f=s[c];Lr=f,wx(f,a)}yx(a)}if(a.subtreeFlags&10256)for(a=a.child;a!==null;)_x(a),a=a.sibling}function _x(a){switch(a.tag){case 0:case 11:case 15:Fc(a),a.flags&2048&&Ai(9,a,a.return);break;case 3:Fc(a);break;case 12:Fc(a);break;case 22:var s=a.stateNode;a.memoizedState!==null&&s._visibility&2&&(a.return===null||a.return.tag!==13)?(s._visibility&=-3,E0(a)):Fc(a);break;default:Fc(a)}}function E0(a){var s=a.deletions;if((a.flags&16)!==0){if(s!==null)for(var c=0;c<s.length;c++){var f=s[c];Lr=f,wx(f,a)}yx(a)}for(a=a.child;a!==null;){switch(s=a,s.tag){case 0:case 11:case 15:Ai(8,s,s.return),E0(s);break;case 22:c=s.stateNode,c._visibility&2&&(c._visibility&=-3,E0(s));break;default:E0(s)}a=a.sibling}}function wx(a,s){for(;Lr!==null;){var c=Lr;switch(c.tag){case 0:case 11:case 15:Ai(8,c,s);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var f=c.memoizedState.cachePool.pool;f!=null&&f.refCount++}break;case 24:xc(c.memoizedState.cache)}if(f=c.child,f!==null)f.return=c,Lr=f;else e:for(c=a;Lr!==null;){f=Lr;var m=f.sibling,x=f.return;if(fx(f),f===c){Lr=null;break e}if(m!==null){m.return=x,Lr=m;break e}Lr=x}}}var _b={getCacheForType:function(a){var s=zr(wr),c=s.data.get(a);return c===void 0&&(c=a(),s.data.set(a,c)),c},cacheSignal:function(){return zr(wr).controller.signal}},wb=typeof WeakMap=="function"?WeakMap:Map,Ft=0,Xt=null,wt=null,St=0,Lt=0,Ma=null,Ci=!1,ml=!1,_h=!1,ei=0,or=0,Ni=0,xs=0,wh=0,La=0,gl=0,Mc=null,wa=null,bh=!1,T0=0,bx=0,k0=1/0,A0=null,Oi=null,Nr=0,Ri=null,xl=null,ti=0,Sh=0,Eh=null,Sx=null,Lc=0,Th=null;function Ba(){return(Ft&2)!==0&&St!==0?St&-St:te.T!==null?Rh():C()}function Ex(){if(La===0)if((St&536870912)===0||kt){var a=mi;mi<<=1,(mi&3932160)===0&&(mi=262144),La=a}else La=536870912;return a=Da.current,a!==null&&(a.flags|=32),La}function ba(a,s,c){(a===Xt&&(Lt===2||Lt===9)||a.cancelPendingCommit!==null)&&(pl(a,0),Di(a,St,La,!1)),jn(a,c),((Ft&2)===0||a!==Xt)&&(a===Xt&&((Ft&2)===0&&(xs|=c),or===4&&Di(a,St,La,!1)),On(a))}function Tx(a,s,c){if((Ft&6)!==0)throw Error(n(327));var f=!c&&(s&127)===0&&(s&a.expiredLanes)===0||Un(a,s),m=f?Eb(a,s):Ah(a,s,!0),x=f;do{if(m===0){ml&&!f&&Di(a,s,0,!1);break}else{if(c=a.current.alternate,x&&!bb(c)){m=Ah(a,s,!1),x=!1;continue}if(m===2){if(x=s,a.errorRecoveryDisabledLanes&x)var E=0;else E=a.pendingLanes&-536870913,E=E!==0?E:E&536870912?536870912:0;if(E!==0){s=E;e:{var O=a;m=Mc;var K=O.current.memoizedState.isDehydrated;if(K&&(pl(O,E).flags|=256),E=Ah(O,E,!1),E!==2){if(_h&&!K){O.errorRecoveryDisabledLanes|=x,xs|=x,m=4;break e}x=wa,wa=m,x!==null&&(wa===null?wa=x:wa.push.apply(wa,x))}m=E}if(x=!1,m!==2)continue}}if(m===1){pl(a,0),Di(a,s,0,!0);break}e:{switch(f=a,x=m,x){case 0:case 1:throw Error(n(345));case 4:if((s&4194048)!==s)break;case 6:Di(f,s,La,!Ci);break e;case 2:wa=null;break;case 3:case 5:break;default:throw Error(n(329))}if((s&62914560)===s&&(m=T0+300-_t(),10<m)){if(Di(f,s,La,!Ci),Xa(f,0,!0)!==0)break e;ti=s,f.timeoutHandle=rp(kx.bind(null,f,c,wa,A0,bh,s,La,xs,gl,Ci,x,"Throttled",-0,0),m);break e}kx(f,c,wa,A0,bh,s,La,xs,gl,Ci,x,null,-0,0)}}break}while(!0);On(a)}function kx(a,s,c,f,m,x,E,O,K,le,ye,Ee,de,me){if(a.timeoutHandle=-1,Ee=s.subtreeFlags,Ee&8192||(Ee&16785408)===16785408){Ee={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Pn},vx(s,x,Ee);var qe=(x&62914560)===x?T0-_t():(x&4194048)===x?bx-_t():0;if(qe=sS(Ee,qe),qe!==null){ti=x,a.cancelPendingCommit=qe(Mx.bind(null,a,s,x,c,f,m,E,O,K,ye,Ee,null,de,me)),Di(a,x,E,!le);return}}Mx(a,s,x,c,f,m,E,O,K)}function bb(a){for(var s=a;;){var c=s.tag;if((c===0||c===11||c===15)&&s.flags&16384&&(c=s.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var f=0;f<c.length;f++){var m=c[f],x=m.getSnapshot;m=m.value;try{if(!Oa(x(),m))return!1}catch{return!1}}if(c=s.child,s.subtreeFlags&16384&&c!==null)c.return=s,s=c;else{if(s===a)break;for(;s.sibling===null;){if(s.return===null||s.return===a)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function Di(a,s,c,f){s&=~wh,s&=~xs,a.suspendedLanes|=s,a.pingedLanes&=~s,f&&(a.warmLanes|=s),f=a.expirationTimes;for(var m=s;0<m;){var x=31-jr(m),E=1<<x;f[x]=-1,m&=~E}c!==0&&$s(a,c,s)}function C0(){return(Ft&6)===0?(Bc(0),!1):!0}function kh(){if(wt!==null){if(Lt===0)var a=wt.return;else a=wt,$n=ls=null,Hf(a),ll=null,vc=0,a=wt;for(;a!==null;)ax(a.alternate,a),a=a.return;wt=null}}function pl(a,s){var c=a.timeoutHandle;c!==-1&&(a.timeoutHandle=-1,Hb(c)),c=a.cancelPendingCommit,c!==null&&(a.cancelPendingCommit=null,c()),ti=0,kh(),Xt=a,wt=c=Hn(a.current,null),St=s,Lt=0,Ma=null,Ci=!1,ml=Un(a,s),_h=!1,gl=La=wh=xs=Ni=or=0,wa=Mc=null,bh=!1,(s&8)!==0&&(s|=s&32);var f=a.entangledLanes;if(f!==0)for(a=a.entanglements,f&=s;0<f;){var m=31-jr(f),x=1<<m;s|=a[m],f&=~x}return ei=s,Ko(),c}function Ax(a,s){dt=null,te.H=kc,s===sl||s===a0?(s=V1(),Lt=3):s===Of?(s=V1(),Lt=4):Lt=s===nh?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,Ma=s,wt===null&&(or=1,p0(a,Ya(s,a.current)))}function Cx(){var a=Da.current;return a===null?!0:(St&4194048)===St?en===null:(St&62914560)===St||(St&536870912)!==0?a===en:!1}function Nx(){var a=te.H;return te.H=kc,a===null?kc:a}function Ox(){var a=te.A;return te.A=_b,a}function N0(){or=4,Ci||(St&4194048)!==St&&Da.current!==null||(ml=!0),(Ni&134217727)===0&&(xs&134217727)===0||Xt===null||Di(Xt,St,La,!1)}function Ah(a,s,c){var f=Ft;Ft|=2;var m=Nx(),x=Ox();(Xt!==a||St!==s)&&(A0=null,pl(a,s)),s=!1;var E=or;e:do try{if(Lt!==0&&wt!==null){var O=wt,K=Ma;switch(Lt){case 8:kh(),E=6;break e;case 3:case 2:case 9:case 6:Da.current===null&&(s=!0);var le=Lt;if(Lt=0,Ma=null,vl(a,O,K,le),c&&ml){E=0;break e}break;default:le=Lt,Lt=0,Ma=null,vl(a,O,K,le)}}Sb(),E=or;break}catch(ye){Ax(a,ye)}while(!0);return s&&a.shellSuspendCounter++,$n=ls=null,Ft=f,te.H=m,te.A=x,wt===null&&(Xt=null,St=0,Ko()),E}function Sb(){for(;wt!==null;)Rx(wt)}function Eb(a,s){var c=Ft;Ft|=2;var f=Nx(),m=Ox();Xt!==a||St!==s?(A0=null,k0=_t()+500,pl(a,s)):ml=Un(a,s);e:do try{if(Lt!==0&&wt!==null){s=wt;var x=Ma;t:switch(Lt){case 1:Lt=0,Ma=null,vl(a,s,x,1);break;case 2:case 9:if(z1(x)){Lt=0,Ma=null,Dx(s);break}s=function(){Lt!==2&&Lt!==9||Xt!==a||(Lt=7),On(a)},x.then(s,s);break e;case 3:Lt=7;break e;case 4:Lt=5;break e;case 7:z1(x)?(Lt=0,Ma=null,Dx(s)):(Lt=0,Ma=null,vl(a,s,x,7));break;case 5:var E=null;switch(wt.tag){case 26:E=wt.memoizedState;case 5:case 27:var O=wt;if(E?pp(E):O.stateNode.complete){Lt=0,Ma=null;var K=O.sibling;if(K!==null)wt=K;else{var le=O.return;le!==null?(wt=le,O0(le)):wt=null}break t}}Lt=0,Ma=null,vl(a,s,x,5);break;case 6:Lt=0,Ma=null,vl(a,s,x,6);break;case 8:kh(),or=6;break e;default:throw Error(n(462))}}Tb();break}catch(ye){Ax(a,ye)}while(!0);return $n=ls=null,te.H=f,te.A=m,Ft=c,wt!==null?0:(Xt=null,St=0,Ko(),or)}function Tb(){for(;wt!==null&&!Ga();)Rx(wt)}function Rx(a){var s=tx(a.alternate,a,ei);a.memoizedProps=a.pendingProps,s===null?O0(a):wt=s}function Dx(a){var s=a,c=s.alternate;switch(s.tag){case 15:case 0:s=Kg(c,s,s.pendingProps,s.type,void 0,St);break;case 11:s=Kg(c,s,s.pendingProps,s.type.render,s.ref,St);break;case 5:Hf(s);default:ax(c,s),s=wt=O1(s,ei),s=tx(c,s,ei)}a.memoizedProps=a.pendingProps,s===null?O0(a):wt=s}function vl(a,s,c,f){$n=ls=null,Hf(s),ll=null,vc=0;var m=s.return;try{if(db(a,m,s,c,St)){or=1,p0(a,Ya(c,a.current)),wt=null;return}}catch(x){if(m!==null)throw wt=m,x;or=1,p0(a,Ya(c,a.current)),wt=null;return}s.flags&32768?(kt||f===1?a=!0:ml||(St&536870912)!==0?a=!1:(Ci=a=!0,(f===2||f===9||f===3||f===6)&&(f=Da.current,f!==null&&f.tag===13&&(f.flags|=16384))),Fx(s,a)):O0(s)}function O0(a){var s=a;do{if((s.flags&32768)!==0){Fx(s,Ci);return}a=s.return;var c=xb(s.alternate,s,ei);if(c!==null){wt=c;return}if(s=s.sibling,s!==null){wt=s;return}wt=s=a}while(s!==null);or===0&&(or=5)}function Fx(a,s){do{var c=pb(a.alternate,a);if(c!==null){c.flags&=32767,wt=c;return}if(c=a.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!s&&(a=a.sibling,a!==null)){wt=a;return}wt=a=c}while(a!==null);or=6,wt=null}function Mx(a,s,c,f,m,x,E,O,K){a.cancelPendingCommit=null;do R0();while(Nr!==0);if((Ft&6)!==0)throw Error(n(327));if(s!==null){if(s===a.current)throw Error(n(177));if(x=s.lanes|s.childLanes,x|=gf,ac(a,c,x,E,O,K),a===Xt&&(wt=Xt=null,St=0),xl=s,Ri=a,ti=c,Sh=x,Eh=m,Sx=f,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(a.callbackNode=null,a.callbackPriority=0,Nb(Mt,function(){return jx(),null})):(a.callbackNode=null,a.callbackPriority=0),f=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||f){f=te.T,te.T=null,m=se.p,se.p=2,E=Ft,Ft|=4;try{vb(a,s,c)}finally{Ft=E,se.p=m,te.T=f}}Nr=1,Lx(),Bx(),Ix()}}function Lx(){if(Nr===1){Nr=0;var a=Ri,s=xl,c=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||c){c=te.T,te.T=null;var f=se.p;se.p=2;var m=Ft;Ft|=4;try{gx(s,a);var x=jh,E=w1(a.containerInfo),O=x.focusedElem,K=x.selectionRange;if(E!==O&&O&&O.ownerDocument&&_1(O.ownerDocument.documentElement,O)){if(K!==null&&uf(O)){var le=K.start,ye=K.end;if(ye===void 0&&(ye=le),"selectionStart"in O)O.selectionStart=le,O.selectionEnd=Math.min(ye,O.value.length);else{var Ee=O.ownerDocument||document,de=Ee&&Ee.defaultView||window;if(de.getSelection){var me=de.getSelection(),qe=O.textContent.length,rt=Math.min(K.start,qe),$t=K.end===void 0?rt:Math.min(K.end,qe);!me.extend&&rt>$t&&(E=$t,$t=rt,rt=E);var ae=y1(O,rt),ee=y1(O,$t);if(ae&&ee&&(me.rangeCount!==1||me.anchorNode!==ae.node||me.anchorOffset!==ae.offset||me.focusNode!==ee.node||me.focusOffset!==ee.offset)){var ie=Ee.createRange();ie.setStart(ae.node,ae.offset),me.removeAllRanges(),rt>$t?(me.addRange(ie),me.extend(ee.node,ee.offset)):(ie.setEnd(ee.node,ee.offset),me.addRange(ie))}}}}for(Ee=[],me=O;me=me.parentNode;)me.nodeType===1&&Ee.push({element:me,left:me.scrollLeft,top:me.scrollTop});for(typeof O.focus=="function"&&O.focus(),O=0;O<Ee.length;O++){var be=Ee[O];be.element.scrollLeft=be.left,be.element.scrollTop=be.top}}V0=!!Uh,jh=Uh=null}finally{Ft=m,se.p=f,te.T=c}}a.current=s,Nr=2}}function Bx(){if(Nr===2){Nr=0;var a=Ri,s=xl,c=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||c){c=te.T,te.T=null;var f=se.p;se.p=2;var m=Ft;Ft|=4;try{ux(a,s.alternate,s)}finally{Ft=m,se.p=f,te.T=c}}Nr=3}}function Ix(){if(Nr===4||Nr===3){Nr=0,da();var a=Ri,s=xl,c=ti,f=Sx;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?Nr=5:(Nr=0,xl=Ri=null,Ux(a,a.pendingLanes));var m=a.pendingLanes;if(m===0&&(Oi=null),ga(c),s=s.stateNode,ar&&typeof ar.onCommitFiberRoot=="function")try{ar.onCommitFiberRoot(qt,s,void 0,(s.current.flags&128)===128)}catch{}if(f!==null){s=te.T,m=se.p,se.p=2,te.T=null;try{for(var x=a.onRecoverableError,E=0;E<f.length;E++){var O=f[E];x(O.value,{componentStack:O.stack})}}finally{te.T=s,se.p=m}}(ti&3)!==0&&R0(),On(a),m=a.pendingLanes,(c&261930)!==0&&(m&42)!==0?a===Th?Lc++:(Lc=0,Th=a):Lc=0,Bc(0)}}function Ux(a,s){(a.pooledCacheLanes&=s)===0&&(s=a.pooledCache,s!=null&&(a.pooledCache=null,xc(s)))}function R0(){return Lx(),Bx(),Ix(),jx()}function jx(){if(Nr!==5)return!1;var a=Ri,s=Sh;Sh=0;var c=ga(ti),f=te.T,m=se.p;try{se.p=32>c?32:c,te.T=null,c=Eh,Eh=null;var x=Ri,E=ti;if(Nr=0,xl=Ri=null,ti=0,(Ft&6)!==0)throw Error(n(331));var O=Ft;if(Ft|=4,_x(x.current),px(x,x.current,E,c),Ft=O,Bc(0,!1),ar&&typeof ar.onPostCommitFiberRoot=="function")try{ar.onPostCommitFiberRoot(qt,x)}catch{}return!0}finally{se.p=m,te.T=f,Ux(a,s)}}function Px(a,s,c){s=Ya(c,s),s=ah(a.stateNode,s,2),a=Ei(a,s,2),a!==null&&(jn(a,2),On(a))}function Bt(a,s,c){if(a.tag===3)Px(a,a,c);else for(;s!==null;){if(s.tag===3){Px(s,a,c);break}else if(s.tag===1){var f=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(Oi===null||!Oi.has(f))){a=Ya(c,a),c=zg(2),f=Ei(s,c,2),f!==null&&(Hg(c,f,s,a),jn(f,2),On(f));break}}s=s.return}}function Ch(a,s,c){var f=a.pingCache;if(f===null){f=a.pingCache=new wb;var m=new Set;f.set(s,m)}else m=f.get(s),m===void 0&&(m=new Set,f.set(s,m));m.has(c)||(_h=!0,m.add(c),a=kb.bind(null,a,s,c),s.then(a,a))}function kb(a,s,c){var f=a.pingCache;f!==null&&f.delete(s),a.pingedLanes|=a.suspendedLanes&c,a.warmLanes&=~c,Xt===a&&(St&c)===c&&(or===4||or===3&&(St&62914560)===St&&300>_t()-T0?(Ft&2)===0&&pl(a,0):wh|=c,gl===St&&(gl=0)),On(a)}function zx(a,s){s===0&&(s=gi()),a=ns(a,s),a!==null&&(jn(a,s),On(a))}function Ab(a){var s=a.memoizedState,c=0;s!==null&&(c=s.retryLane),zx(a,c)}function Cb(a,s){var c=0;switch(a.tag){case 31:case 13:var f=a.stateNode,m=a.memoizedState;m!==null&&(c=m.retryLane);break;case 19:f=a.stateNode;break;case 22:f=a.stateNode._retryCache;break;default:throw Error(n(314))}f!==null&&f.delete(s),zx(a,c)}function Nb(a,s){return Kr(a,s)}var D0=null,yl=null,Nh=!1,F0=!1,Oh=!1,Fi=0;function On(a){a!==yl&&a.next===null&&(yl===null?D0=yl=a:yl=yl.next=a),F0=!0,Nh||(Nh=!0,Rb())}function Bc(a,s){if(!Oh&&F0){Oh=!0;do for(var c=!1,f=D0;f!==null;){if(a!==0){var m=f.pendingLanes;if(m===0)var x=0;else{var E=f.suspendedLanes,O=f.pingedLanes;x=(1<<31-jr(42|a)+1)-1,x&=m&~(E&~O),x=x&201326741?x&201326741|1:x?x|2:0}x!==0&&(c=!0,Gx(f,x))}else x=St,x=Xa(f,f===Xt?x:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),(x&3)===0||Un(f,x)||(c=!0,Gx(f,x));f=f.next}while(c);Oh=!1}}function Ob(){Hx()}function Hx(){F0=Nh=!1;var a=0;Fi!==0&&zb()&&(a=Fi);for(var s=_t(),c=null,f=D0;f!==null;){var m=f.next,x=Vx(f,s);x===0?(f.next=null,c===null?D0=m:c.next=m,m===null&&(yl=c)):(c=f,(a!==0||(x&3)!==0)&&(F0=!0)),f=m}Nr!==0&&Nr!==5||Bc(a),Fi!==0&&(Fi=0)}function Vx(a,s){for(var c=a.suspendedLanes,f=a.pingedLanes,m=a.expirationTimes,x=a.pendingLanes&-62914561;0<x;){var E=31-jr(x),O=1<<E,K=m[E];K===-1?((O&c)===0||(O&f)!==0)&&(m[E]=rc(O,s)):K<=s&&(a.expiredLanes|=O),x&=~O}if(s=Xt,c=St,c=Xa(a,a===s?c:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),f=a.callbackNode,c===0||a===s&&(Lt===2||Lt===9)||a.cancelPendingCommit!==null)return f!==null&&f!==null&&Fr(f),a.callbackNode=null,a.callbackPriority=0;if((c&3)===0||Un(a,c)){if(s=c&-c,s===a.callbackPriority)return s;switch(f!==null&&Fr(f),ga(c)){case 2:case 8:c=Tn;break;case 32:c=Mt;break;case 268435456:c=ht;break;default:c=Mt}return f=$x.bind(null,a),c=Kr(c,f),a.callbackPriority=s,a.callbackNode=c,s}return f!==null&&f!==null&&Fr(f),a.callbackPriority=2,a.callbackNode=null,2}function $x(a,s){if(Nr!==0&&Nr!==5)return a.callbackNode=null,a.callbackPriority=0,null;var c=a.callbackNode;if(R0()&&a.callbackNode!==c)return null;var f=St;return f=Xa(a,a===Xt?f:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),f===0?null:(Tx(a,f,s),Vx(a,_t()),a.callbackNode!=null&&a.callbackNode===c?$x.bind(null,a):null)}function Gx(a,s){if(R0())return null;Tx(a,s,!0)}function Rb(){Vb(function(){(Ft&6)!==0?Kr(Yr,Ob):Hx()})}function Rh(){if(Fi===0){var a=nl;a===0&&(a=In,In<<=1,(In&261888)===0&&(In=256)),Fi=a}return Fi}function qx(a){return a==null||typeof a=="symbol"||typeof a=="boolean"?null:typeof a=="function"?a:zo(""+a)}function Xx(a,s){var c=s.ownerDocument.createElement("input");return c.name=s.name,c.value=s.value,a.id&&c.setAttribute("form",a.id),s.parentNode.insertBefore(c,s),a=new FormData(a),c.parentNode.removeChild(c),a}function Db(a,s,c,f,m){if(s==="submit"&&c&&c.stateNode===m){var x=qx((m[L]||null).action),E=f.submitter;E&&(s=(s=E[L]||null)?qx(s.formAction):E.getAttribute("formAction"),s!==null&&(x=s,E=null));var O=new Go("action","action",null,f,m);a.push({event:O,listeners:[{instance:null,listener:function(){if(f.defaultPrevented){if(Fi!==0){var K=E?Xx(m,E):new FormData(m);Jf(c,{pending:!0,data:K,method:m.method,action:x},null,K)}}else typeof x=="function"&&(O.preventDefault(),K=E?Xx(m,E):new FormData(m),Jf(c,{pending:!0,data:K,method:m.method,action:x},x,K))},currentTarget:m}]})}}for(var Dh=0;Dh<mf.length;Dh++){var Fh=mf[Dh],Fb=Fh.toLowerCase(),Mb=Fh[0].toUpperCase()+Fh.slice(1);dn(Fb,"on"+Mb)}dn(E1,"onAnimationEnd"),dn(T1,"onAnimationIteration"),dn(k1,"onAnimationStart"),dn("dblclick","onDoubleClick"),dn("focusin","onFocus"),dn("focusout","onBlur"),dn(Yw,"onTransitionRun"),dn(Jw,"onTransitionStart"),dn(Qw,"onTransitionCancel"),dn(A1,"onTransitionEnd"),Le("onMouseEnter",["mouseout","mouseover"]),Le("onMouseLeave",["mouseout","mouseover"]),Le("onPointerEnter",["pointerout","pointerover"]),Le("onPointerLeave",["pointerout","pointerover"]),Fe("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Fe("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Fe("onBeforeInput",["compositionend","keypress","textInput","paste"]),Fe("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Fe("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Fe("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ic="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Lb=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ic));function Wx(a,s){s=(s&4)!==0;for(var c=0;c<a.length;c++){var f=a[c],m=f.event;f=f.listeners;e:{var x=void 0;if(s)for(var E=f.length-1;0<=E;E--){var O=f[E],K=O.instance,le=O.currentTarget;if(O=O.listener,K!==x&&m.isPropagationStopped())break e;x=O,m.currentTarget=le;try{x(m)}catch(ye){Wo(ye)}m.currentTarget=null,x=K}else for(E=0;E<f.length;E++){if(O=f[E],K=O.instance,le=O.currentTarget,O=O.listener,K!==x&&m.isPropagationStopped())break e;x=O,m.currentTarget=le;try{x(m)}catch(ye){Wo(ye)}m.currentTarget=null,x=K}}}}function bt(a,s){var c=s[ce];c===void 0&&(c=s[ce]=new Set);var f=a+"__bubble";c.has(f)||(Kx(s,a,2,!1),c.add(f))}function Mh(a,s,c){var f=0;s&&(f|=4),Kx(c,a,f,s)}var M0="_reactListening"+Math.random().toString(36).slice(2);function Lh(a){if(!a[M0]){a[M0]=!0,ke.forEach(function(c){c!=="selectionchange"&&(Lb.has(c)||Mh(c,!1,a),Mh(c,!0,a))});var s=a.nodeType===9?a:a.ownerDocument;s===null||s[M0]||(s[M0]=!0,Mh("selectionchange",!1,s))}}function Kx(a,s,c,f){switch(Ep(s)){case 2:var m=oS;break;case 8:m=uS;break;default:m=Yh}c=m.bind(null,s,c,a),m=void 0,!ef||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(m=!0),f?m!==void 0?a.addEventListener(s,c,{capture:!0,passive:m}):a.addEventListener(s,c,!0):m!==void 0?a.addEventListener(s,c,{passive:m}):a.addEventListener(s,c,!1)}function Bh(a,s,c,f,m){var x=f;if((s&1)===0&&(s&2)===0&&f!==null)e:for(;;){if(f===null)return;var E=f.tag;if(E===3||E===4){var O=f.stateNode.containerInfo;if(O===m)break;if(E===4)for(E=f.return;E!==null;){var K=E.tag;if((K===3||K===4)&&E.stateNode.containerInfo===m)return;E=E.return}for(;O!==null;){if(E=Me(O),E===null)return;if(K=E.tag,K===5||K===6||K===26||K===27){f=x=E;continue e}O=O.parentNode}}f=f.return}e1(function(){var le=x,ye=Qu(c),Ee=[];e:{var de=C1.get(a);if(de!==void 0){var me=Go,qe=a;switch(a){case"keypress":if(Vo(c)===0)break e;case"keydown":case"keyup":me=Cw;break;case"focusin":qe="focus",me=nf;break;case"focusout":qe="blur",me=nf;break;case"beforeblur":case"afterblur":me=nf;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":me=a1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":me=xw;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":me=Rw;break;case E1:case T1:case k1:me=yw;break;case A1:me=Fw;break;case"scroll":case"scrollend":me=mw;break;case"wheel":me=Lw;break;case"copy":case"cut":case"paste":me=ww;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":me=i1;break;case"toggle":case"beforetoggle":me=Iw}var rt=(s&4)!==0,$t=!rt&&(a==="scroll"||a==="scrollend"),ae=rt?de!==null?de+"Capture":null:de;rt=[];for(var ee=le,ie;ee!==null;){var be=ee;if(ie=be.stateNode,be=be.tag,be!==5&&be!==26&&be!==27||ie===null||ae===null||(be=ic(ee,ae),be!=null&&rt.push(Uc(ee,be,ie))),$t)break;ee=ee.return}0<rt.length&&(de=new me(de,qe,null,c,ye),Ee.push({event:de,listeners:rt}))}}if((s&7)===0){e:{if(de=a==="mouseover"||a==="pointerover",me=a==="mouseout"||a==="pointerout",de&&c!==Ju&&(qe=c.relatedTarget||c.fromElement)&&(Me(qe)||qe[H]))break e;if((me||de)&&(de=ye.window===ye?ye:(de=ye.ownerDocument)?de.defaultView||de.parentWindow:window,me?(qe=c.relatedTarget||c.toElement,me=le,qe=qe?Me(qe):null,qe!==null&&($t=l(qe),rt=qe.tag,qe!==$t||rt!==5&&rt!==27&&rt!==6)&&(qe=null)):(me=null,qe=le),me!==qe)){if(rt=a1,be="onMouseLeave",ae="onMouseEnter",ee="mouse",(a==="pointerout"||a==="pointerover")&&(rt=i1,be="onPointerLeave",ae="onPointerEnter",ee="pointer"),$t=me==null?de:P(me),ie=qe==null?de:P(qe),de=new rt(be,ee+"leave",me,c,ye),de.target=$t,de.relatedTarget=ie,be=null,Me(ye)===le&&(rt=new rt(ae,ee+"enter",qe,c,ye),rt.target=ie,rt.relatedTarget=$t,be=rt),$t=be,me&&qe)t:{for(rt=Bb,ae=me,ee=qe,ie=0,be=ae;be;be=rt(be))ie++;be=0;for(var et=ee;et;et=rt(et))be++;for(;0<ie-be;)ae=rt(ae),ie--;for(;0<be-ie;)ee=rt(ee),be--;for(;ie--;){if(ae===ee||ee!==null&&ae===ee.alternate){rt=ae;break t}ae=rt(ae),ee=rt(ee)}rt=null}else rt=null;me!==null&&Yx(Ee,de,me,rt,!1),qe!==null&&$t!==null&&Yx(Ee,$t,qe,rt,!0)}}e:{if(de=le?P(le):window,me=de.nodeName&&de.nodeName.toLowerCase(),me==="select"||me==="input"&&de.type==="file")var Ot=d1;else if(f1(de))if(m1)Ot=Xw;else{Ot=Gw;var Ye=$w}else me=de.nodeName,!me||me.toLowerCase()!=="input"||de.type!=="checkbox"&&de.type!=="radio"?le&&Yu(le.elementType)&&(Ot=d1):Ot=qw;if(Ot&&(Ot=Ot(a,le))){h1(Ee,Ot,c,ye);break e}Ye&&Ye(a,de,le),a==="focusout"&&le&&de.type==="number"&&le.memoizedProps.value!=null&&Ku(de,"number",de.value)}switch(Ye=le?P(le):window,a){case"focusin":(f1(Ye)||Ye.contentEditable==="true")&&(Ys=Ye,ff=le,dc=null);break;case"focusout":dc=ff=Ys=null;break;case"mousedown":hf=!0;break;case"contextmenu":case"mouseup":case"dragend":hf=!1,b1(Ee,c,ye);break;case"selectionchange":if(Kw)break;case"keydown":case"keyup":b1(Ee,c,ye)}var gt;if(lf)e:{switch(a){case"compositionstart":var Et="onCompositionStart";break e;case"compositionend":Et="onCompositionEnd";break e;case"compositionupdate":Et="onCompositionUpdate";break e}Et=void 0}else Ks?o1(a,c)&&(Et="onCompositionEnd"):a==="keydown"&&c.keyCode===229&&(Et="onCompositionStart");Et&&(s1&&c.locale!=="ko"&&(Ks||Et!=="onCompositionStart"?Et==="onCompositionEnd"&&Ks&&(gt=t1()):(pi=ye,tf="value"in pi?pi.value:pi.textContent,Ks=!0)),Ye=L0(le,Et),0<Ye.length&&(Et=new n1(Et,a,null,c,ye),Ee.push({event:Et,listeners:Ye}),gt?Et.data=gt:(gt=u1(c),gt!==null&&(Et.data=gt)))),(gt=jw?Pw(a,c):zw(a,c))&&(Et=L0(le,"onBeforeInput"),0<Et.length&&(Ye=new n1("onBeforeInput","beforeinput",null,c,ye),Ee.push({event:Ye,listeners:Et}),Ye.data=gt)),Db(Ee,a,le,c,ye)}Wx(Ee,s)})}function Uc(a,s,c){return{instance:a,listener:s,currentTarget:c}}function L0(a,s){for(var c=s+"Capture",f=[];a!==null;){var m=a,x=m.stateNode;if(m=m.tag,m!==5&&m!==26&&m!==27||x===null||(m=ic(a,c),m!=null&&f.unshift(Uc(a,m,x)),m=ic(a,s),m!=null&&f.push(Uc(a,m,x))),a.tag===3)return f;a=a.return}return[]}function Bb(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5&&a.tag!==27);return a||null}function Yx(a,s,c,f,m){for(var x=s._reactName,E=[];c!==null&&c!==f;){var O=c,K=O.alternate,le=O.stateNode;if(O=O.tag,K!==null&&K===f)break;O!==5&&O!==26&&O!==27||le===null||(K=le,m?(le=ic(c,x),le!=null&&E.unshift(Uc(c,le,K))):m||(le=ic(c,x),le!=null&&E.push(Uc(c,le,K)))),c=c.return}E.length!==0&&a.push({event:s,listeners:E})}var Ib=/\r\n?/g,Ub=/\u0000|\uFFFD/g;function Jx(a){return(typeof a=="string"?a:""+a).replace(Ib,`
`).replace(Ub,"")}function Qx(a,s){return s=Jx(s),Jx(a)===s}function Vt(a,s,c,f,m,x){switch(c){case"children":typeof f=="string"?s==="body"||s==="textarea"&&f===""||qs(a,f):(typeof f=="number"||typeof f=="bigint")&&s!=="body"&&qs(a,""+f);break;case"className":He(a,"class",f);break;case"tabIndex":He(a,"tabindex",f);break;case"dir":case"role":case"viewBox":case"width":case"height":He(a,c,f);break;case"style":Qm(a,f,x);break;case"data":if(s!=="object"){He(a,"data",f);break}case"src":case"href":if(f===""&&(s!=="a"||c!=="href")){a.removeAttribute(c);break}if(f==null||typeof f=="function"||typeof f=="symbol"||typeof f=="boolean"){a.removeAttribute(c);break}f=zo(""+f),a.setAttribute(c,f);break;case"action":case"formAction":if(typeof f=="function"){a.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof x=="function"&&(c==="formAction"?(s!=="input"&&Vt(a,s,"name",m.name,m,null),Vt(a,s,"formEncType",m.formEncType,m,null),Vt(a,s,"formMethod",m.formMethod,m,null),Vt(a,s,"formTarget",m.formTarget,m,null)):(Vt(a,s,"encType",m.encType,m,null),Vt(a,s,"method",m.method,m,null),Vt(a,s,"target",m.target,m,null)));if(f==null||typeof f=="symbol"||typeof f=="boolean"){a.removeAttribute(c);break}f=zo(""+f),a.setAttribute(c,f);break;case"onClick":f!=null&&(a.onclick=Pn);break;case"onScroll":f!=null&&bt("scroll",a);break;case"onScrollEnd":f!=null&&bt("scrollend",a);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(n(61));if(c=f.__html,c!=null){if(m.children!=null)throw Error(n(60));a.innerHTML=c}}break;case"multiple":a.multiple=f&&typeof f!="function"&&typeof f!="symbol";break;case"muted":a.muted=f&&typeof f!="function"&&typeof f!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(f==null||typeof f=="function"||typeof f=="boolean"||typeof f=="symbol"){a.removeAttribute("xlink:href");break}c=zo(""+f),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":f!=null&&typeof f!="function"&&typeof f!="symbol"?a.setAttribute(c,""+f):a.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":f&&typeof f!="function"&&typeof f!="symbol"?a.setAttribute(c,""):a.removeAttribute(c);break;case"capture":case"download":f===!0?a.setAttribute(c,""):f!==!1&&f!=null&&typeof f!="function"&&typeof f!="symbol"?a.setAttribute(c,f):a.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":f!=null&&typeof f!="function"&&typeof f!="symbol"&&!isNaN(f)&&1<=f?a.setAttribute(c,f):a.removeAttribute(c);break;case"rowSpan":case"start":f==null||typeof f=="function"||typeof f=="symbol"||isNaN(f)?a.removeAttribute(c):a.setAttribute(c,f);break;case"popover":bt("beforetoggle",a),bt("toggle",a),Je(a,"popover",f);break;case"xlinkActuate":Pe(a,"http://www.w3.org/1999/xlink","xlink:actuate",f);break;case"xlinkArcrole":Pe(a,"http://www.w3.org/1999/xlink","xlink:arcrole",f);break;case"xlinkRole":Pe(a,"http://www.w3.org/1999/xlink","xlink:role",f);break;case"xlinkShow":Pe(a,"http://www.w3.org/1999/xlink","xlink:show",f);break;case"xlinkTitle":Pe(a,"http://www.w3.org/1999/xlink","xlink:title",f);break;case"xlinkType":Pe(a,"http://www.w3.org/1999/xlink","xlink:type",f);break;case"xmlBase":Pe(a,"http://www.w3.org/XML/1998/namespace","xml:base",f);break;case"xmlLang":Pe(a,"http://www.w3.org/XML/1998/namespace","xml:lang",f);break;case"xmlSpace":Pe(a,"http://www.w3.org/XML/1998/namespace","xml:space",f);break;case"is":Je(a,"is",f);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=hw.get(c)||c,Je(a,c,f))}}function Ih(a,s,c,f,m,x){switch(c){case"style":Qm(a,f,x);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(n(61));if(c=f.__html,c!=null){if(m.children!=null)throw Error(n(60));a.innerHTML=c}}break;case"children":typeof f=="string"?qs(a,f):(typeof f=="number"||typeof f=="bigint")&&qs(a,""+f);break;case"onScroll":f!=null&&bt("scroll",a);break;case"onScrollEnd":f!=null&&bt("scrollend",a);break;case"onClick":f!=null&&(a.onclick=Pn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!De.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(m=c.endsWith("Capture"),s=c.slice(2,m?c.length-7:void 0),x=a[L]||null,x=x!=null?x[c]:null,typeof x=="function"&&a.removeEventListener(s,x,m),typeof f=="function")){typeof x!="function"&&x!==null&&(c in a?a[c]=null:a.hasAttribute(c)&&a.removeAttribute(c)),a.addEventListener(s,f,m);break e}c in a?a[c]=f:f===!0?a.setAttribute(c,""):Je(a,c,f)}}}function Vr(a,s,c){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":bt("error",a),bt("load",a);var f=!1,m=!1,x;for(x in c)if(c.hasOwnProperty(x)){var E=c[x];if(E!=null)switch(x){case"src":f=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,s));default:Vt(a,s,x,E,c,null)}}m&&Vt(a,s,"srcSet",c.srcSet,c,null),f&&Vt(a,s,"src",c.src,c,null);return;case"input":bt("invalid",a);var O=x=E=m=null,K=null,le=null;for(f in c)if(c.hasOwnProperty(f)){var ye=c[f];if(ye!=null)switch(f){case"name":m=ye;break;case"type":E=ye;break;case"checked":K=ye;break;case"defaultChecked":le=ye;break;case"value":x=ye;break;case"defaultValue":O=ye;break;case"children":case"dangerouslySetInnerHTML":if(ye!=null)throw Error(n(137,s));break;default:Vt(a,s,f,ye,c,null)}}Po(a,x,O,K,le,E,m,!1);return;case"select":bt("invalid",a),f=E=x=null;for(m in c)if(c.hasOwnProperty(m)&&(O=c[m],O!=null))switch(m){case"value":x=O;break;case"defaultValue":E=O;break;case"multiple":f=O;default:Vt(a,s,m,O,c,null)}s=x,c=E,a.multiple=!!f,s!=null?Gs(a,!!f,s,!1):c!=null&&Gs(a,!!f,c,!0);return;case"textarea":bt("invalid",a),x=m=f=null;for(E in c)if(c.hasOwnProperty(E)&&(O=c[E],O!=null))switch(E){case"value":f=O;break;case"defaultValue":m=O;break;case"children":x=O;break;case"dangerouslySetInnerHTML":if(O!=null)throw Error(n(91));break;default:Vt(a,s,E,O,c,null)}Ym(a,f,m,x);return;case"option":for(K in c)c.hasOwnProperty(K)&&(f=c[K],f!=null)&&(K==="selected"?a.selected=f&&typeof f!="function"&&typeof f!="symbol":Vt(a,s,K,f,c,null));return;case"dialog":bt("beforetoggle",a),bt("toggle",a),bt("cancel",a),bt("close",a);break;case"iframe":case"object":bt("load",a);break;case"video":case"audio":for(f=0;f<Ic.length;f++)bt(Ic[f],a);break;case"image":bt("error",a),bt("load",a);break;case"details":bt("toggle",a);break;case"embed":case"source":case"link":bt("error",a),bt("load",a);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(le in c)if(c.hasOwnProperty(le)&&(f=c[le],f!=null))switch(le){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,s));default:Vt(a,s,le,f,c,null)}return;default:if(Yu(s)){for(ye in c)c.hasOwnProperty(ye)&&(f=c[ye],f!==void 0&&Ih(a,s,ye,f,c,void 0));return}}for(O in c)c.hasOwnProperty(O)&&(f=c[O],f!=null&&Vt(a,s,O,f,c,null))}function jb(a,s,c,f){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,x=null,E=null,O=null,K=null,le=null,ye=null;for(me in c){var Ee=c[me];if(c.hasOwnProperty(me)&&Ee!=null)switch(me){case"checked":break;case"value":break;case"defaultValue":K=Ee;default:f.hasOwnProperty(me)||Vt(a,s,me,null,f,Ee)}}for(var de in f){var me=f[de];if(Ee=c[de],f.hasOwnProperty(de)&&(me!=null||Ee!=null))switch(de){case"type":x=me;break;case"name":m=me;break;case"checked":le=me;break;case"defaultChecked":ye=me;break;case"value":E=me;break;case"defaultValue":O=me;break;case"children":case"dangerouslySetInnerHTML":if(me!=null)throw Error(n(137,s));break;default:me!==Ee&&Vt(a,s,de,me,f,Ee)}}nc(a,E,O,K,le,ye,x,m);return;case"select":me=E=O=de=null;for(x in c)if(K=c[x],c.hasOwnProperty(x)&&K!=null)switch(x){case"value":break;case"multiple":me=K;default:f.hasOwnProperty(x)||Vt(a,s,x,null,f,K)}for(m in f)if(x=f[m],K=c[m],f.hasOwnProperty(m)&&(x!=null||K!=null))switch(m){case"value":de=x;break;case"defaultValue":O=x;break;case"multiple":E=x;default:x!==K&&Vt(a,s,m,x,f,K)}s=O,c=E,f=me,de!=null?Gs(a,!!c,de,!1):!!f!=!!c&&(s!=null?Gs(a,!!c,s,!0):Gs(a,!!c,c?[]:"",!1));return;case"textarea":me=de=null;for(O in c)if(m=c[O],c.hasOwnProperty(O)&&m!=null&&!f.hasOwnProperty(O))switch(O){case"value":break;case"children":break;default:Vt(a,s,O,null,f,m)}for(E in f)if(m=f[E],x=c[E],f.hasOwnProperty(E)&&(m!=null||x!=null))switch(E){case"value":de=m;break;case"defaultValue":me=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(n(91));break;default:m!==x&&Vt(a,s,E,m,f,x)}Km(a,de,me);return;case"option":for(var qe in c)de=c[qe],c.hasOwnProperty(qe)&&de!=null&&!f.hasOwnProperty(qe)&&(qe==="selected"?a.selected=!1:Vt(a,s,qe,null,f,de));for(K in f)de=f[K],me=c[K],f.hasOwnProperty(K)&&de!==me&&(de!=null||me!=null)&&(K==="selected"?a.selected=de&&typeof de!="function"&&typeof de!="symbol":Vt(a,s,K,de,f,me));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var rt in c)de=c[rt],c.hasOwnProperty(rt)&&de!=null&&!f.hasOwnProperty(rt)&&Vt(a,s,rt,null,f,de);for(le in f)if(de=f[le],me=c[le],f.hasOwnProperty(le)&&de!==me&&(de!=null||me!=null))switch(le){case"children":case"dangerouslySetInnerHTML":if(de!=null)throw Error(n(137,s));break;default:Vt(a,s,le,de,f,me)}return;default:if(Yu(s)){for(var $t in c)de=c[$t],c.hasOwnProperty($t)&&de!==void 0&&!f.hasOwnProperty($t)&&Ih(a,s,$t,void 0,f,de);for(ye in f)de=f[ye],me=c[ye],!f.hasOwnProperty(ye)||de===me||de===void 0&&me===void 0||Ih(a,s,ye,de,f,me);return}}for(var ae in c)de=c[ae],c.hasOwnProperty(ae)&&de!=null&&!f.hasOwnProperty(ae)&&Vt(a,s,ae,null,f,de);for(Ee in f)de=f[Ee],me=c[Ee],!f.hasOwnProperty(Ee)||de===me||de==null&&me==null||Vt(a,s,Ee,de,f,me)}function Zx(a){switch(a){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Pb(){if(typeof performance.getEntriesByType=="function"){for(var a=0,s=0,c=performance.getEntriesByType("resource"),f=0;f<c.length;f++){var m=c[f],x=m.transferSize,E=m.initiatorType,O=m.duration;if(x&&O&&Zx(E)){for(E=0,O=m.responseEnd,f+=1;f<c.length;f++){var K=c[f],le=K.startTime;if(le>O)break;var ye=K.transferSize,Ee=K.initiatorType;ye&&Zx(Ee)&&(K=K.responseEnd,E+=ye*(K<O?1:(O-le)/(K-le)))}if(--f,s+=8*(x+E)/(m.duration/1e3),a++,10<a)break}}if(0<a)return s/a/1e6}return navigator.connection&&(a=navigator.connection.downlink,typeof a=="number")?a:5}var Uh=null,jh=null;function B0(a){return a.nodeType===9?a:a.ownerDocument}function ep(a){switch(a){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function tp(a,s){if(a===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return a===1&&s==="foreignObject"?0:a}function Ph(a,s){return a==="textarea"||a==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var zh=null;function zb(){var a=window.event;return a&&a.type==="popstate"?a===zh?!1:(zh=a,!0):(zh=null,!1)}var rp=typeof setTimeout=="function"?setTimeout:void 0,Hb=typeof clearTimeout=="function"?clearTimeout:void 0,ap=typeof Promise=="function"?Promise:void 0,Vb=typeof queueMicrotask=="function"?queueMicrotask:typeof ap<"u"?function(a){return ap.resolve(null).then(a).catch($b)}:rp;function $b(a){setTimeout(function(){throw a})}function Mi(a){return a==="head"}function np(a,s){var c=s,f=0;do{var m=c.nextSibling;if(a.removeChild(c),m&&m.nodeType===8)if(c=m.data,c==="/$"||c==="/&"){if(f===0){a.removeChild(m),Sl(s);return}f--}else if(c==="$"||c==="$?"||c==="$~"||c==="$!"||c==="&")f++;else if(c==="html")jc(a.ownerDocument.documentElement);else if(c==="head"){c=a.ownerDocument.head,jc(c);for(var x=c.firstChild;x;){var E=x.nextSibling,O=x.nodeName;x[fe]||O==="SCRIPT"||O==="STYLE"||O==="LINK"&&x.rel.toLowerCase()==="stylesheet"||c.removeChild(x),x=E}}else c==="body"&&jc(a.ownerDocument.body);c=m}while(c);Sl(s)}function ip(a,s){var c=a;a=0;do{var f=c.nextSibling;if(c.nodeType===1?s?(c._stashedDisplay=c.style.display,c.style.display="none"):(c.style.display=c._stashedDisplay||"",c.getAttribute("style")===""&&c.removeAttribute("style")):c.nodeType===3&&(s?(c._stashedText=c.nodeValue,c.nodeValue=""):c.nodeValue=c._stashedText||""),f&&f.nodeType===8)if(c=f.data,c==="/$"){if(a===0)break;a--}else c!=="$"&&c!=="$?"&&c!=="$~"&&c!=="$!"||a++;c=f}while(c)}function Hh(a){var s=a.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var c=s;switch(s=s.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":Hh(c),Re(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}a.removeChild(c)}}function Gb(a,s,c,f){for(;a.nodeType===1;){var m=c;if(a.nodeName.toLowerCase()!==s.toLowerCase()){if(!f&&(a.nodeName!=="INPUT"||a.type!=="hidden"))break}else if(f){if(!a[fe])switch(s){case"meta":if(!a.hasAttribute("itemprop"))break;return a;case"link":if(x=a.getAttribute("rel"),x==="stylesheet"&&a.hasAttribute("data-precedence"))break;if(x!==m.rel||a.getAttribute("href")!==(m.href==null||m.href===""?null:m.href)||a.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||a.getAttribute("title")!==(m.title==null?null:m.title))break;return a;case"style":if(a.hasAttribute("data-precedence"))break;return a;case"script":if(x=a.getAttribute("src"),(x!==(m.src==null?null:m.src)||a.getAttribute("type")!==(m.type==null?null:m.type)||a.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&x&&a.hasAttribute("async")&&!a.hasAttribute("itemprop"))break;return a;default:return a}}else if(s==="input"&&a.type==="hidden"){var x=m.name==null?null:""+m.name;if(m.type==="hidden"&&a.getAttribute("name")===x)return a}else return a;if(a=tn(a.nextSibling),a===null)break}return null}function qb(a,s,c){if(s==="")return null;for(;a.nodeType!==3;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!c||(a=tn(a.nextSibling),a===null))return null;return a}function sp(a,s){for(;a.nodeType!==8;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!s||(a=tn(a.nextSibling),a===null))return null;return a}function Vh(a){return a.data==="$?"||a.data==="$~"}function $h(a){return a.data==="$!"||a.data==="$?"&&a.ownerDocument.readyState!=="loading"}function Xb(a,s){var c=a.ownerDocument;if(a.data==="$~")a._reactRetry=s;else if(a.data!=="$?"||c.readyState!=="loading")s();else{var f=function(){s(),c.removeEventListener("DOMContentLoaded",f)};c.addEventListener("DOMContentLoaded",f),a._reactRetry=f}}function tn(a){for(;a!=null;a=a.nextSibling){var s=a.nodeType;if(s===1||s===3)break;if(s===8){if(s=a.data,s==="$"||s==="$!"||s==="$?"||s==="$~"||s==="&"||s==="F!"||s==="F")break;if(s==="/$"||s==="/&")return null}}return a}var Gh=null;function lp(a){a=a.nextSibling;for(var s=0;a;){if(a.nodeType===8){var c=a.data;if(c==="/$"||c==="/&"){if(s===0)return tn(a.nextSibling);s--}else c!=="$"&&c!=="$!"&&c!=="$?"&&c!=="$~"&&c!=="&"||s++}a=a.nextSibling}return null}function cp(a){a=a.previousSibling;for(var s=0;a;){if(a.nodeType===8){var c=a.data;if(c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"){if(s===0)return a;s--}else c!=="/$"&&c!=="/&"||s++}a=a.previousSibling}return null}function op(a,s,c){switch(s=B0(c),a){case"html":if(a=s.documentElement,!a)throw Error(n(452));return a;case"head":if(a=s.head,!a)throw Error(n(453));return a;case"body":if(a=s.body,!a)throw Error(n(454));return a;default:throw Error(n(451))}}function jc(a){for(var s=a.attributes;s.length;)a.removeAttributeNode(s[0]);Re(a)}var rn=new Map,up=new Set;function I0(a){return typeof a.getRootNode=="function"?a.getRootNode():a.nodeType===9?a:a.ownerDocument}var ri=se.d;se.d={f:Wb,r:Kb,D:Yb,C:Jb,L:Qb,m:Zb,X:tS,S:eS,M:rS};function Wb(){var a=ri.f(),s=C0();return a||s}function Kb(a){var s=ze(a);s!==null&&s.tag===5&&s.type==="form"?Ag(s):ri.r(a)}var _l=typeof document>"u"?null:document;function fp(a,s,c){var f=_l;if(f&&typeof s=="string"&&s){var m=Mr(s);m='link[rel="'+a+'"][href="'+m+'"]',typeof c=="string"&&(m+='[crossorigin="'+c+'"]'),up.has(m)||(up.add(m),a={rel:a,crossOrigin:c,href:s},f.querySelector(m)===null&&(s=f.createElement("link"),Vr(s,"link",a),re(s),f.head.appendChild(s)))}}function Yb(a){ri.D(a),fp("dns-prefetch",a,null)}function Jb(a,s){ri.C(a,s),fp("preconnect",a,s)}function Qb(a,s,c){ri.L(a,s,c);var f=_l;if(f&&a&&s){var m='link[rel="preload"][as="'+Mr(s)+'"]';s==="image"&&c&&c.imageSrcSet?(m+='[imagesrcset="'+Mr(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(m+='[imagesizes="'+Mr(c.imageSizes)+'"]')):m+='[href="'+Mr(a)+'"]';var x=m;switch(s){case"style":x=wl(a);break;case"script":x=bl(a)}rn.has(x)||(a=p({rel:"preload",href:s==="image"&&c&&c.imageSrcSet?void 0:a,as:s},c),rn.set(x,a),f.querySelector(m)!==null||s==="style"&&f.querySelector(Pc(x))||s==="script"&&f.querySelector(zc(x))||(s=f.createElement("link"),Vr(s,"link",a),re(s),f.head.appendChild(s)))}}function Zb(a,s){ri.m(a,s);var c=_l;if(c&&a){var f=s&&typeof s.as=="string"?s.as:"script",m='link[rel="modulepreload"][as="'+Mr(f)+'"][href="'+Mr(a)+'"]',x=m;switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":x=bl(a)}if(!rn.has(x)&&(a=p({rel:"modulepreload",href:a},s),rn.set(x,a),c.querySelector(m)===null)){switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(zc(x)))return}f=c.createElement("link"),Vr(f,"link",a),re(f),c.head.appendChild(f)}}}function eS(a,s,c){ri.S(a,s,c);var f=_l;if(f&&a){var m=W(f).hoistableStyles,x=wl(a);s=s||"default";var E=m.get(x);if(!E){var O={loading:0,preload:null};if(E=f.querySelector(Pc(x)))O.loading=5;else{a=p({rel:"stylesheet",href:a,"data-precedence":s},c),(c=rn.get(x))&&qh(a,c);var K=E=f.createElement("link");re(K),Vr(K,"link",a),K._p=new Promise(function(le,ye){K.onload=le,K.onerror=ye}),K.addEventListener("load",function(){O.loading|=1}),K.addEventListener("error",function(){O.loading|=2}),O.loading|=4,U0(E,s,f)}E={type:"stylesheet",instance:E,count:1,state:O},m.set(x,E)}}}function tS(a,s){ri.X(a,s);var c=_l;if(c&&a){var f=W(c).hoistableScripts,m=bl(a),x=f.get(m);x||(x=c.querySelector(zc(m)),x||(a=p({src:a,async:!0},s),(s=rn.get(m))&&Xh(a,s),x=c.createElement("script"),re(x),Vr(x,"link",a),c.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},f.set(m,x))}}function rS(a,s){ri.M(a,s);var c=_l;if(c&&a){var f=W(c).hoistableScripts,m=bl(a),x=f.get(m);x||(x=c.querySelector(zc(m)),x||(a=p({src:a,async:!0,type:"module"},s),(s=rn.get(m))&&Xh(a,s),x=c.createElement("script"),re(x),Vr(x,"link",a),c.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},f.set(m,x))}}function hp(a,s,c,f){var m=(m=ne.current)?I0(m):null;if(!m)throw Error(n(446));switch(a){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(s=wl(c.href),c=W(m).hoistableStyles,f=c.get(s),f||(f={type:"style",instance:null,count:0,state:null},c.set(s,f)),f):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){a=wl(c.href);var x=W(m).hoistableStyles,E=x.get(a);if(E||(m=m.ownerDocument||m,E={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},x.set(a,E),(x=m.querySelector(Pc(a)))&&!x._p&&(E.instance=x,E.state.loading=5),rn.has(a)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},rn.set(a,c),x||aS(m,a,c,E.state))),s&&f===null)throw Error(n(528,""));return E}if(s&&f!==null)throw Error(n(529,""));return null;case"script":return s=c.async,c=c.src,typeof c=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=bl(c),c=W(m).hoistableScripts,f=c.get(s),f||(f={type:"script",instance:null,count:0,state:null},c.set(s,f)),f):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,a))}}function wl(a){return'href="'+Mr(a)+'"'}function Pc(a){return'link[rel="stylesheet"]['+a+"]"}function dp(a){return p({},a,{"data-precedence":a.precedence,precedence:null})}function aS(a,s,c,f){a.querySelector('link[rel="preload"][as="style"]['+s+"]")?f.loading=1:(s=a.createElement("link"),f.preload=s,s.addEventListener("load",function(){return f.loading|=1}),s.addEventListener("error",function(){return f.loading|=2}),Vr(s,"link",c),re(s),a.head.appendChild(s))}function bl(a){return'[src="'+Mr(a)+'"]'}function zc(a){return"script[async]"+a}function mp(a,s,c){if(s.count++,s.instance===null)switch(s.type){case"style":var f=a.querySelector('style[data-href~="'+Mr(c.href)+'"]');if(f)return s.instance=f,re(f),f;var m=p({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return f=(a.ownerDocument||a).createElement("style"),re(f),Vr(f,"style",m),U0(f,c.precedence,a),s.instance=f;case"stylesheet":m=wl(c.href);var x=a.querySelector(Pc(m));if(x)return s.state.loading|=4,s.instance=x,re(x),x;f=dp(c),(m=rn.get(m))&&qh(f,m),x=(a.ownerDocument||a).createElement("link"),re(x);var E=x;return E._p=new Promise(function(O,K){E.onload=O,E.onerror=K}),Vr(x,"link",f),s.state.loading|=4,U0(x,c.precedence,a),s.instance=x;case"script":return x=bl(c.src),(m=a.querySelector(zc(x)))?(s.instance=m,re(m),m):(f=c,(m=rn.get(x))&&(f=p({},c),Xh(f,m)),a=a.ownerDocument||a,m=a.createElement("script"),re(m),Vr(m,"link",f),a.head.appendChild(m),s.instance=m);case"void":return null;default:throw Error(n(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(f=s.instance,s.state.loading|=4,U0(f,c.precedence,a));return s.instance}function U0(a,s,c){for(var f=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=f.length?f[f.length-1]:null,x=m,E=0;E<f.length;E++){var O=f[E];if(O.dataset.precedence===s)x=O;else if(x!==m)break}x?x.parentNode.insertBefore(a,x.nextSibling):(s=c.nodeType===9?c.head:c,s.insertBefore(a,s.firstChild))}function qh(a,s){a.crossOrigin==null&&(a.crossOrigin=s.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=s.referrerPolicy),a.title==null&&(a.title=s.title)}function Xh(a,s){a.crossOrigin==null&&(a.crossOrigin=s.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=s.referrerPolicy),a.integrity==null&&(a.integrity=s.integrity)}var j0=null;function gp(a,s,c){if(j0===null){var f=new Map,m=j0=new Map;m.set(c,f)}else m=j0,f=m.get(c),f||(f=new Map,m.set(c,f));if(f.has(a))return f;for(f.set(a,null),c=c.getElementsByTagName(a),m=0;m<c.length;m++){var x=c[m];if(!(x[fe]||x[F]||a==="link"&&x.getAttribute("rel")==="stylesheet")&&x.namespaceURI!=="http://www.w3.org/2000/svg"){var E=x.getAttribute(s)||"";E=a+E;var O=f.get(E);O?O.push(x):f.set(E,[x])}}return f}function xp(a,s,c){a=a.ownerDocument||a,a.head.insertBefore(c,s==="title"?a.querySelector("head > title"):null)}function nS(a,s,c){if(c===1||s.itemProp!=null)return!1;switch(a){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;return s.rel==="stylesheet"?(a=s.disabled,typeof s.precedence=="string"&&a==null):!0;case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function pp(a){return!(a.type==="stylesheet"&&(a.state.loading&3)===0)}function iS(a,s,c,f){if(c.type==="stylesheet"&&(typeof f.media!="string"||matchMedia(f.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var m=wl(f.href),x=s.querySelector(Pc(m));if(x){s=x._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(a.count++,a=P0.bind(a),s.then(a,a)),c.state.loading|=4,c.instance=x,re(x);return}x=s.ownerDocument||s,f=dp(f),(m=rn.get(m))&&qh(f,m),x=x.createElement("link"),re(x);var E=x;E._p=new Promise(function(O,K){E.onload=O,E.onerror=K}),Vr(x,"link",f),c.instance=x}a.stylesheets===null&&(a.stylesheets=new Map),a.stylesheets.set(c,s),(s=c.state.preload)&&(c.state.loading&3)===0&&(a.count++,c=P0.bind(a),s.addEventListener("load",c),s.addEventListener("error",c))}}var Wh=0;function sS(a,s){return a.stylesheets&&a.count===0&&H0(a,a.stylesheets),0<a.count||0<a.imgCount?function(c){var f=setTimeout(function(){if(a.stylesheets&&H0(a,a.stylesheets),a.unsuspend){var x=a.unsuspend;a.unsuspend=null,x()}},6e4+s);0<a.imgBytes&&Wh===0&&(Wh=62500*Pb());var m=setTimeout(function(){if(a.waitingForImages=!1,a.count===0&&(a.stylesheets&&H0(a,a.stylesheets),a.unsuspend)){var x=a.unsuspend;a.unsuspend=null,x()}},(a.imgBytes>Wh?50:800)+s);return a.unsuspend=c,function(){a.unsuspend=null,clearTimeout(f),clearTimeout(m)}}:null}function P0(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)H0(this,this.stylesheets);else if(this.unsuspend){var a=this.unsuspend;this.unsuspend=null,a()}}}var z0=null;function H0(a,s){a.stylesheets=null,a.unsuspend!==null&&(a.count++,z0=new Map,s.forEach(lS,a),z0=null,P0.call(a))}function lS(a,s){if(!(s.state.loading&4)){var c=z0.get(a);if(c)var f=c.get(null);else{c=new Map,z0.set(a,c);for(var m=a.querySelectorAll("link[data-precedence],style[data-precedence]"),x=0;x<m.length;x++){var E=m[x];(E.nodeName==="LINK"||E.getAttribute("media")!=="not all")&&(c.set(E.dataset.precedence,E),f=E)}f&&c.set(null,f)}m=s.instance,E=m.getAttribute("data-precedence"),x=c.get(E)||f,x===f&&c.set(null,m),c.set(E,m),this.count++,f=P0.bind(this),m.addEventListener("load",f),m.addEventListener("error",f),x?x.parentNode.insertBefore(m,x.nextSibling):(a=a.nodeType===9?a.head:a,a.insertBefore(m,a.firstChild)),s.state.loading|=4}}var Hc={$$typeof:T,Provider:null,Consumer:null,_currentValue:ge,_currentValue2:ge,_threadCount:0};function cS(a,s,c,f,m,x,E,O,K){this.tag=1,this.containerInfo=a,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Na(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Na(0),this.hiddenUpdates=Na(null),this.identifierPrefix=f,this.onUncaughtError=m,this.onCaughtError=x,this.onRecoverableError=E,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=K,this.incompleteTransitions=new Map}function vp(a,s,c,f,m,x,E,O,K,le,ye,Ee){return a=new cS(a,s,c,E,K,le,ye,Ee,O),s=1,x===!0&&(s|=24),x=Ra(3,null,null,s),a.current=x,x.stateNode=a,s=Af(),s.refCount++,a.pooledCache=s,s.refCount++,x.memoizedState={element:f,isDehydrated:c,cache:s},Rf(x),a}function yp(a){return a?(a=Zs,a):Zs}function _p(a,s,c,f,m,x){m=yp(m),f.context===null?f.context=m:f.pendingContext=m,f=Si(s),f.payload={element:c},x=x===void 0?null:x,x!==null&&(f.callback=x),c=Ei(a,f,s),c!==null&&(ba(c,a,s),_c(c,a,s))}function wp(a,s){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var c=a.retryLane;a.retryLane=c!==0&&c<s?c:s}}function Kh(a,s){wp(a,s),(a=a.alternate)&&wp(a,s)}function bp(a){if(a.tag===13||a.tag===31){var s=ns(a,67108864);s!==null&&ba(s,a,67108864),Kh(a,67108864)}}function Sp(a){if(a.tag===13||a.tag===31){var s=Ba();s=xi(s);var c=ns(a,s);c!==null&&ba(c,a,s),Kh(a,s)}}var V0=!0;function oS(a,s,c,f){var m=te.T;te.T=null;var x=se.p;try{se.p=2,Yh(a,s,c,f)}finally{se.p=x,te.T=m}}function uS(a,s,c,f){var m=te.T;te.T=null;var x=se.p;try{se.p=8,Yh(a,s,c,f)}finally{se.p=x,te.T=m}}function Yh(a,s,c,f){if(V0){var m=Jh(f);if(m===null)Bh(a,s,f,$0,c),Tp(a,f);else if(hS(m,a,s,c,f))f.stopPropagation();else if(Tp(a,f),s&4&&-1<fS.indexOf(a)){for(;m!==null;){var x=ze(m);if(x!==null)switch(x.tag){case 3:if(x=x.stateNode,x.current.memoizedState.isDehydrated){var E=ma(x.pendingLanes);if(E!==0){var O=x;for(O.pendingLanes|=2,O.entangledLanes|=2;E;){var K=1<<31-jr(E);O.entanglements[1]|=K,E&=~K}On(x),(Ft&6)===0&&(k0=_t()+500,Bc(0))}}break;case 31:case 13:O=ns(x,2),O!==null&&ba(O,x,2),C0(),Kh(x,2)}if(x=Jh(f),x===null&&Bh(a,s,f,$0,c),x===m)break;m=x}m!==null&&f.stopPropagation()}else Bh(a,s,f,null,c)}}function Jh(a){return a=Qu(a),Qh(a)}var $0=null;function Qh(a){if($0=null,a=Me(a),a!==null){var s=l(a);if(s===null)a=null;else{var c=s.tag;if(c===13){if(a=o(s),a!==null)return a;a=null}else if(c===31){if(a=u(s),a!==null)return a;a=null}else if(c===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;a=null}else s!==a&&(a=null)}}return $0=a,null}function Ep(a){switch(a){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Aa()){case Yr:return 2;case Tn:return 8;case Mt:case Jr:return 32;case ht:return 268435456;default:return 32}default:return 32}}var Zh=!1,Li=null,Bi=null,Ii=null,Vc=new Map,$c=new Map,Ui=[],fS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Tp(a,s){switch(a){case"focusin":case"focusout":Li=null;break;case"dragenter":case"dragleave":Bi=null;break;case"mouseover":case"mouseout":Ii=null;break;case"pointerover":case"pointerout":Vc.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":$c.delete(s.pointerId)}}function Gc(a,s,c,f,m,x){return a===null||a.nativeEvent!==x?(a={blockedOn:s,domEventName:c,eventSystemFlags:f,nativeEvent:x,targetContainers:[m]},s!==null&&(s=ze(s),s!==null&&bp(s)),a):(a.eventSystemFlags|=f,s=a.targetContainers,m!==null&&s.indexOf(m)===-1&&s.push(m),a)}function hS(a,s,c,f,m){switch(s){case"focusin":return Li=Gc(Li,a,s,c,f,m),!0;case"dragenter":return Bi=Gc(Bi,a,s,c,f,m),!0;case"mouseover":return Ii=Gc(Ii,a,s,c,f,m),!0;case"pointerover":var x=m.pointerId;return Vc.set(x,Gc(Vc.get(x)||null,a,s,c,f,m)),!0;case"gotpointercapture":return x=m.pointerId,$c.set(x,Gc($c.get(x)||null,a,s,c,f,m)),!0}return!1}function kp(a){var s=Me(a.target);if(s!==null){var c=l(s);if(c!==null){if(s=c.tag,s===13){if(s=o(c),s!==null){a.blockedOn=s,j(a.priority,function(){Sp(c)});return}}else if(s===31){if(s=u(c),s!==null){a.blockedOn=s,j(a.priority,function(){Sp(c)});return}}else if(s===3&&c.stateNode.current.memoizedState.isDehydrated){a.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}a.blockedOn=null}function G0(a){if(a.blockedOn!==null)return!1;for(var s=a.targetContainers;0<s.length;){var c=Jh(a.nativeEvent);if(c===null){c=a.nativeEvent;var f=new c.constructor(c.type,c);Ju=f,c.target.dispatchEvent(f),Ju=null}else return s=ze(c),s!==null&&bp(s),a.blockedOn=c,!1;s.shift()}return!0}function Ap(a,s,c){G0(a)&&c.delete(s)}function dS(){Zh=!1,Li!==null&&G0(Li)&&(Li=null),Bi!==null&&G0(Bi)&&(Bi=null),Ii!==null&&G0(Ii)&&(Ii=null),Vc.forEach(Ap),$c.forEach(Ap)}function q0(a,s){a.blockedOn===s&&(a.blockedOn=null,Zh||(Zh=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,dS)))}var X0=null;function Cp(a){X0!==a&&(X0=a,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){X0===a&&(X0=null);for(var s=0;s<a.length;s+=3){var c=a[s],f=a[s+1],m=a[s+2];if(typeof f!="function"){if(Qh(f||c)===null)continue;break}var x=ze(c);x!==null&&(a.splice(s,3),s-=3,Jf(x,{pending:!0,data:m,method:c.method,action:f},f,m))}}))}function Sl(a){function s(K){return q0(K,a)}Li!==null&&q0(Li,a),Bi!==null&&q0(Bi,a),Ii!==null&&q0(Ii,a),Vc.forEach(s),$c.forEach(s);for(var c=0;c<Ui.length;c++){var f=Ui[c];f.blockedOn===a&&(f.blockedOn=null)}for(;0<Ui.length&&(c=Ui[0],c.blockedOn===null);)kp(c),c.blockedOn===null&&Ui.shift();if(c=(a.ownerDocument||a).$$reactFormReplay,c!=null)for(f=0;f<c.length;f+=3){var m=c[f],x=c[f+1],E=m[L]||null;if(typeof x=="function")E||Cp(c);else if(E){var O=null;if(x&&x.hasAttribute("formAction")){if(m=x,E=x[L]||null)O=E.formAction;else if(Qh(m)!==null)continue}else O=E.action;typeof O=="function"?c[f+1]=O:(c.splice(f,3),f-=3),Cp(c)}}}function Np(){function a(x){x.canIntercept&&x.info==="react-transition"&&x.intercept({handler:function(){return new Promise(function(E){return m=E})},focusReset:"manual",scroll:"manual"})}function s(){m!==null&&(m(),m=null),f||setTimeout(c,20)}function c(){if(!f&&!navigation.transition){var x=navigation.currentEntry;x&&x.url!=null&&navigation.navigate(x.url,{state:x.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var f=!1,m=null;return navigation.addEventListener("navigate",a),navigation.addEventListener("navigatesuccess",s),navigation.addEventListener("navigateerror",s),setTimeout(c,100),function(){f=!0,navigation.removeEventListener("navigate",a),navigation.removeEventListener("navigatesuccess",s),navigation.removeEventListener("navigateerror",s),m!==null&&(m(),m=null)}}}function ed(a){this._internalRoot=a}W0.prototype.render=ed.prototype.render=function(a){var s=this._internalRoot;if(s===null)throw Error(n(409));var c=s.current,f=Ba();_p(c,f,a,s,null,null)},W0.prototype.unmount=ed.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var s=a.containerInfo;_p(a.current,2,null,a,null,null),C0(),s[H]=null}};function W0(a){this._internalRoot=a}W0.prototype.unstable_scheduleHydration=function(a){if(a){var s=C();a={blockedOn:null,target:a,priority:s};for(var c=0;c<Ui.length&&s!==0&&s<Ui[c].priority;c++);Ui.splice(c,0,a),c===0&&kp(a)}};var Op=t.version;if(Op!=="19.2.3")throw Error(n(527,Op,"19.2.3"));se.findDOMNode=function(a){var s=a._reactInternals;if(s===void 0)throw typeof a.render=="function"?Error(n(188)):(a=Object.keys(a).join(","),Error(n(268,a)));return a=d(s),a=a!==null?g(a):null,a=a===null?null:a.stateNode,a};var mS={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:te,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var K0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!K0.isDisabled&&K0.supportsFiber)try{qt=K0.inject(mS),ar=K0}catch{}}return Xc.createRoot=function(a,s){if(!i(a))throw Error(n(299));var c=!1,f="",m=Ig,x=Ug,E=jg;return s!=null&&(s.unstable_strictMode===!0&&(c=!0),s.identifierPrefix!==void 0&&(f=s.identifierPrefix),s.onUncaughtError!==void 0&&(m=s.onUncaughtError),s.onCaughtError!==void 0&&(x=s.onCaughtError),s.onRecoverableError!==void 0&&(E=s.onRecoverableError)),s=vp(a,1,!1,null,null,c,f,null,m,x,E,Np),a[H]=s.current,Lh(a),new ed(s)},Xc.hydrateRoot=function(a,s,c){if(!i(a))throw Error(n(299));var f=!1,m="",x=Ig,E=Ug,O=jg,K=null;return c!=null&&(c.unstable_strictMode===!0&&(f=!0),c.identifierPrefix!==void 0&&(m=c.identifierPrefix),c.onUncaughtError!==void 0&&(x=c.onUncaughtError),c.onCaughtError!==void 0&&(E=c.onCaughtError),c.onRecoverableError!==void 0&&(O=c.onRecoverableError),c.formState!==void 0&&(K=c.formState)),s=vp(a,1,!0,s,c??null,f,m,K,x,E,O,Np),s.context=yp(null),c=s.current,f=Ba(),f=xi(f),m=Si(f),m.callback=null,Ei(c,m,f),c=f,s.current.lanes=c,jn(s,c),On(s),a[H]=s.current,Lh(a),new W0(s)},Xc.version="19.2.3",Xc}var Pp;function ES(){if(Pp)return ad.exports;Pp=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),ad.exports=SS(),ad.exports}var TS=ES();const kS=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),AS=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,n)=>n?n.toUpperCase():r.toLowerCase()),zp=e=>{const t=AS(e);return t.charAt(0).toUpperCase()+t.slice(1)},Oy=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim(),CS=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};var NS={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const OS=Xe.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:i="",children:l,iconNode:o,...u},h)=>Xe.createElement("svg",{ref:h,...NS,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:Oy("lucide",i),...!l&&!CS(u)&&{"aria-hidden":"true"},...u},[...o.map(([d,g])=>Xe.createElement(d,g)),...Array.isArray(l)?l:[l]]));const mr=(e,t)=>{const r=Xe.forwardRef(({className:n,...i},l)=>Xe.createElement(OS,{ref:l,iconNode:t,className:Oy(`lucide-${kS(zp(e))}`,`lucide-${e}`,n),...i}));return r.displayName=zp(e),r};const RS=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],Ry=mr("chart-column",RS);const DS=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],FS=mr("chevron-right",DS);const MS=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Lu=mr("circle-check",MS);const LS=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],tm=mr("clipboard-list",LS);const BS=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Bu=mr("download",BS);const IS=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],US=mr("eye-off",IS);const jS=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],PS=mr("eye",jS);const zS=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],HS=mr("file-down",zS);const VS=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],Dy=mr("file-spreadsheet",VS);const $S=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],GS=mr("layout-dashboard",$S);const qS=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],XS=mr("menu",qS);const WS=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],xu=mr("package",WS);const KS=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],YS=mr("pen",KS);const JS=[["path",{d:"m10.5 20.5 10-10a4.95 4.95 0 1 0-7-7l-10 10a4.95 4.95 0 1 0 7 7Z",key:"wa1lgi"}],["path",{d:"m8.5 8.5 7 7",key:"rvfmvr"}]],Fy=mr("pill",JS);const QS=[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]],Kl=mr("refresh-ccw",QS);const ZS=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],rm=mr("search",ZS);const eE=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],tE=mr("tag",eE);const rE=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],oo=mr("trash-2",rE);const aE=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],nE=mr("trending-down",aE);const iE=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Ls=mr("triangle-alert",iE);const sE=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Yl=mr("upload",sE);const lE=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],My=mr("x",lE);function cE({editingMed:e,onClose:t,onSubmit:r}){return b.jsx("div",{className:"fixed inset-0 bg-slate-900/60 backdrop-blur-sm flex items-center justify-center z-50 p-4 font-sans",children:b.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-lg overflow-hidden",children:[b.jsxs("div",{className:"p-6 border-b border-slate-100 flex justify-between items-center bg-slate-50",children:[b.jsx("h3",{className:"text-lg font-bold text-slate-800",children:e?"Editar Medicamento":"Nuevo Medicamento"}),b.jsx("button",{type:"button",onClick:t,className:"text-slate-400 hover:text-slate-600 transition-colors",children:b.jsx(My,{size:24})})]}),b.jsxs("form",{onSubmit:r,className:"p-6 grid grid-cols-2 gap-4",children:[b.jsxs("div",{className:"col-span-2",children:[b.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase mb-1",children:"Nombre Comercial"}),b.jsx("input",{required:!0,name:"name",defaultValue:e?.name,className:"w-full border p-2.5 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm transition-all",placeholder:"Ej. Amoxicilina 500mg"})]}),b.jsxs("div",{children:[b.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase mb-1",children:"Categora"}),b.jsxs("select",{name:"category",defaultValue:e?.category,className:"w-full border p-2.5 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm bg-white",children:[b.jsx("option",{children:"Analgsico"}),b.jsx("option",{children:"Antibitico"}),b.jsx("option",{children:"Antiinflamatorio"}),b.jsx("option",{children:"Insumo Mdico"}),b.jsx("option",{children:"Protector Gstrico"})]})]}),b.jsxs("div",{children:[b.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase mb-1",children:"Unidad"}),b.jsx("input",{name:"unit",defaultValue:e?.unit||"Tabletas",className:"w-full border p-2.5 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm",placeholder:"Cajas, Tabletas..."})]}),b.jsxs("div",{children:[b.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase mb-1",children:"Lote"}),b.jsx("input",{name:"batch",defaultValue:e?.batch,className:"w-full border p-2.5 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm font-mono",placeholder:"LOT-000"})]}),b.jsxs("div",{children:[b.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase mb-1",children:"Vencimiento"}),b.jsx("input",{type:"date",name:"expiry_date",defaultValue:e?.expiry_date,className:"w-full border p-2.5 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm font-mono"})]}),b.jsxs("div",{children:[b.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase mb-1",children:"Stock Inicial"}),b.jsx("input",{type:"number",name:"stock",defaultValue:e?.stock||0,className:"w-full border p-2.5 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm font-mono"})]}),b.jsxs("div",{children:[b.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase mb-1",children:"Stock Mnimo"}),b.jsx("input",{type:"number",name:"min_stock",defaultValue:e?.min_stock||10,className:"w-full border p-2.5 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm font-mono"})]}),b.jsxs("div",{className:"col-span-2 pt-4 flex space-x-3",children:[b.jsx("button",{type:"button",onClick:t,className:"flex-1 border border-slate-200 py-3 rounded-xl hover:bg-slate-50 font-semibold transition-colors text-sm",children:"Cancelar"}),b.jsx("button",{type:"submit",className:"flex-1 bg-blue-600 text-white py-3 rounded-xl hover:bg-blue-700 font-semibold shadow-lg shadow-blue-200 transition-all text-sm",children:e?"Guardar Cambios":"Registrar"})]})]})]})})}function oE({activeTab:e}){const t=e==="dashboard"?"Resumen General":e==="inventory"?"Gestin de Inventario":e==="catalog"?"Catlogo de Productos":e==="consumption-monthly"?"Consumo Mensual":e==="consumption-summary"?"Resumen de Consumo":e==="order-request"?"Solicitud Pedido":e==="tertiary-packaging"?"Empaque Terciario":e==="categories"?"Categoras":"Alertas de Stock";return b.jsx("header",{className:"flex justify-between items-center mb-8",children:b.jsxs("div",{children:[b.jsx("h2",{className:"text-2xl font-bold text-slate-800 capitalize",children:t}),b.jsx("p",{className:"text-slate-500",children:"Sistema central de suministros mdicos."})]})})}function ai({id:e,icon:t,label:r,activeTab:n,isSidebarOpen:i,onSelect:l}){return b.jsxs("button",{onClick:()=>l(e),className:`w-full flex items-center space-x-3 p-3 rounded-lg transition-colors ${n===e?"bg-blue-600 text-white shadow-md":"text-slate-600 hover:bg-blue-50"}`,children:[b.jsx(t,{size:20}),i&&b.jsx("span",{className:"font-medium",children:r})]})}function uE({activeTab:e,isSidebarOpen:t,onSelectTab:r,onToggleSidebar:n}){return b.jsxs("aside",{className:`bg-white border-r border-slate-200 transition-all duration-300 flex flex-col ${t?"w-64":"w-20"}`,children:[b.jsxs("div",{className:"p-6 flex items-center space-x-3 border-b border-slate-100",children:[b.jsx("div",{className:"bg-blue-600 p-2 rounded-lg text-white",children:b.jsx(xu,{size:24})}),t&&b.jsxs("h1",{className:"text-xl font-bold tracking-tight text-blue-900 leading-none",children:["BODEGA",b.jsx("br",{}),b.jsx("span",{className:"text-sm font-normal text-slate-500 tracking-normal",children:"PharmaStock v1.1"})]})]}),b.jsxs("nav",{className:"flex-1 p-4 space-y-2 mt-4",children:[b.jsx(ai,{id:"dashboard",icon:GS,label:"Panel de Control",activeTab:e,isSidebarOpen:t,onSelect:r}),b.jsx(ai,{id:"inventory",icon:Fy,label:"Inventario",activeTab:e,isSidebarOpen:t,onSelect:r}),b.jsx(ai,{id:"catalog",icon:Dy,label:"Catlogo",activeTab:e,isSidebarOpen:t,onSelect:r}),b.jsx(ai,{id:"consumption-monthly",icon:Yl,label:"Consumo mensual",activeTab:e,isSidebarOpen:t,onSelect:r}),b.jsx(ai,{id:"consumption-summary",icon:Ry,label:"Resumen consumo",activeTab:e,isSidebarOpen:t,onSelect:r}),b.jsx(ai,{id:"order-request",icon:tm,label:"Solicitud Pedido",activeTab:e,isSidebarOpen:t,onSelect:r}),b.jsx(ai,{id:"tertiary-packaging",icon:xu,label:"Empaque Terciario",activeTab:e,isSidebarOpen:t,onSelect:r}),b.jsx(ai,{id:"categories",icon:tE,label:"Categoras",activeTab:e,isSidebarOpen:t,onSelect:r}),b.jsx(ai,{id:"alerts",icon:Ls,label:"Alertas de Stock",activeTab:e,isSidebarOpen:t,onSelect:r})]}),b.jsx("div",{className:"p-4 border-t border-slate-100",children:b.jsx("button",{onClick:n,className:"p-2 hover:bg-slate-100 rounded-lg text-slate-400 w-full flex justify-center",children:t?b.jsx(My,{size:20}):b.jsx(XS,{size:20})})})]})}function fE({lowStockItems:e,onEditMedication:t}){return b.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.map(r=>b.jsxs("div",{className:"bg-white p-6 rounded-xl border-l-4 border-red-500 shadow-sm flex flex-col justify-between",children:[b.jsxs("div",{children:[b.jsxs("div",{className:"flex justify-between items-start mb-4",children:[b.jsx("h3",{className:"text-lg font-bold text-slate-800",children:r.name}),b.jsx("div",{className:"bg-red-100 p-2 rounded-full text-red-600",children:b.jsx(Ls,{size:20})})]}),b.jsxs("div",{className:"space-y-2 mb-6 text-sm text-slate-600",children:[b.jsxs("p",{className:"flex justify-between",children:[b.jsx("span",{children:"Categora:"})," ",b.jsx("span",{className:"font-semibold",children:r.category})]}),b.jsxs("p",{className:"flex justify-between",children:[b.jsx("span",{children:"Stock Mnimo:"})," ",b.jsx("span",{className:"font-semibold",children:r.min_stock})]}),b.jsxs("p",{className:"flex justify-between",children:[b.jsx("span",{children:"Stock Actual:"})," ",b.jsx("span",{className:"font-bold text-red-600 text-base",children:r.stock})]})]})]}),b.jsx("button",{type:"button",onClick:()=>t(r),className:"w-full bg-blue-600 hover:bg-blue-700 text-white py-2 rounded-lg font-medium transition-colors",children:"Generar Orden de Compra"})]},r.id)),e.length===0&&b.jsxs("div",{className:"col-span-full py-20 text-center bg-white border border-dashed border-slate-300 rounded-2xl",children:[b.jsx("div",{className:"bg-green-100 text-green-600 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4",children:b.jsx(xu,{size:32})}),b.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"Todo en Orden!"}),b.jsx("p",{className:"text-slate-500 max-w-sm mx-auto",children:"No hay medicamentos que requieran atencin inmediata por falta de inventario."})]})]})}function hE({medications:e,excelStatus:t,fileInputRef:r,onChooseFile:n,onDownloadTemplate:i,onFileChange:l,onEditMedication:o,onDeleteMedication:u,onClearCatalog:h}){const d=p=>{const v=String(p??"").trim();return v.length<=50?{display:v,full:v}:{display:`${v.slice(0,50)}`,full:v}},g=Xe.useMemo(()=>{const p=_=>{const w=String(_||"").replace(/\D/g,"");return w.length<4?Number.POSITIVE_INFINITY:Number.parseInt(w.slice(-4),10)},v=_=>String(_||"").trim().startsWith("1-10");return[...e||[]].sort((_,w)=>{const y=_?.siges_code||"",S=w?.siges_code||"",k=v(y),R=v(S);if(k!==R)return k?-1:1;const T=p(y),B=p(S);return T!==B?T-B:String(y).localeCompare(String(S),"es",{numeric:!0,sensitivity:"base"})})},[e]);return b.jsx("div",{className:"space-y-6",children:b.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[b.jsxs("div",{className:"lg:col-span-1 bg-white p-6 rounded-2xl border border-slate-200 shadow-sm",children:[b.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[b.jsx("div",{className:"bg-green-100 text-green-600 p-2 rounded-lg",children:b.jsx(Yl,{size:20})}),b.jsx("h3",{className:"font-bold text-slate-800",children:"Importar CSV"})]}),b.jsxs("p",{className:"text-sm text-slate-500 mb-6 leading-relaxed",children:["Cargue su catlogo masivamente. El archivo debe contener las columnas: ",b.jsx("br",{}),b.jsx("code",{className:"bg-slate-100 px-1 rounded text-blue-600 font-mono text-xs",children:"CodigoSIGES, ClasificadorSICOP, IdentificadorSICOP, Medicamento, Categoria, Lote, Vencimiento, Stock, StockMinimo, Unidad"})]}),b.jsx("input",{type:"file",ref:r,onChange:l,accept:".csv",className:"hidden"}),b.jsxs("button",{type:"button",onClick:n,className:"w-full flex flex-col items-center justify-center border-2 border-dashed border-slate-300 rounded-xl py-10 hover:border-blue-400 hover:bg-blue-50 transition-all group",children:[b.jsx(Dy,{size:40,className:"text-slate-300 group-hover:text-blue-500 mb-2 transition-colors"}),b.jsx("span",{className:"text-sm font-semibold text-slate-600 group-hover:text-blue-700",children:"Seleccionar archivo CSV"}),b.jsx("span",{className:"text-xs text-slate-400 mt-1",children:"Soporta .csv"})]}),t.message&&b.jsxs("div",{className:`mt-4 p-3 rounded-lg text-xs flex items-center space-x-2 ${t.type==="success"?"bg-green-50 text-green-700 border border-green-100":t.type==="error"?"bg-red-50 text-red-700 border border-red-100":"bg-blue-50 text-blue-700 border border-blue-100"}`,children:[t.type==="success"?b.jsx(Lu,{size:16}):b.jsx(Ls,{size:16}),b.jsx("span",{children:t.message})]})]}),b.jsxs("div",{className:"lg:col-span-2 bg-white rounded-2xl border border-slate-200 shadow-sm overflow-hidden",children:[b.jsxs("div",{className:"p-4 border-b border-slate-100 bg-slate-50 flex justify-between items-center",children:[b.jsx("h3",{className:"font-bold text-slate-800",children:"Vista Previa del Catlogo"}),b.jsxs("div",{className:"flex items-center gap-3",children:[b.jsxs("button",{type:"button",onClick:()=>{!e?.length||!window.confirm("Desea eliminar todo el catlogo? Esta accin no se puede deshacer.")||h?.()},disabled:!e?.length,className:"text-xs text-red-600 font-bold flex items-center space-x-1 hover:underline disabled:opacity-40 disabled:hover:no-underline",children:[b.jsx(oo,{size:14}),b.jsx("span",{children:"Eliminar Catlogo"})]}),b.jsxs("button",{type:"button",onClick:i,className:"text-xs text-blue-600 font-bold flex items-center space-x-1 hover:underline",children:[b.jsx(Bu,{size:14}),b.jsx("span",{children:"Descargar Plantilla"})]})]})]}),b.jsx("div",{className:"max-h-[400px] overflow-y-auto",children:b.jsxs("table",{className:"w-full text-left",children:[b.jsx("thead",{className:"sticky top-0 bg-white shadow-sm text-slate-500 text-[10px] uppercase font-bold",children:b.jsxs("tr",{children:[b.jsx("th",{className:"px-6 py-3",children:"Cdigo SIGES"}),b.jsx("th",{className:"px-6 py-3",children:"Clasificador SICOP"}),b.jsx("th",{className:"px-6 py-3",children:"Identificador SICOP"}),b.jsx("th",{className:"px-6 py-3",children:"Medicamento"}),b.jsx("th",{className:"px-6 py-3 text-center",children:"Acciones"})]})}),b.jsx("tbody",{className:"divide-y divide-slate-100",children:g.map(p=>b.jsxs("tr",{className:"hover:bg-slate-50 transition-colors group",children:[b.jsx("td",{className:"px-6 py-3 text-sm text-slate-700 font-mono",children:p.siges_code||""}),b.jsx("td",{className:"px-6 py-3 text-sm text-slate-700 font-mono",children:p.sicop_classifier||""}),b.jsx("td",{className:"px-6 py-3 text-sm text-slate-700 font-mono",children:p.sicop_identifier||""}),b.jsx("td",{className:"px-6 py-3 text-sm font-medium text-slate-700",title:d(p.name).full,children:d(p.name).display}),b.jsx("td",{className:"px-6 py-3",children:b.jsxs("div",{className:"flex justify-center space-x-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[b.jsx("button",{type:"button",onClick:()=>o?.(p),className:"p-1.5 text-slate-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg","aria-label":"Editar",title:"Editar",children:b.jsx(YS,{size:14})}),b.jsx("button",{type:"button",onClick:()=>u?.(p.id),className:"p-1.5 text-slate-400 hover:text-red-600 hover:bg-red-50 rounded-lg","aria-label":"Eliminar",title:"Eliminar",children:b.jsx(oo,{size:14})})]})})]},p.id))})]})})]})]})})}function Rd(e){const t=typeof e=="number"?e:Number(String(e??"").replace(/,/g,""));return Number.isFinite(t)?t:0}function El(e){const t=Rd(e);return new Intl.NumberFormat("es-CR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(t)}function Ly(e){return e.length?e.reduce((t,r)=>t+r,0)/e.length:0}function dE(e){if(e.length<=1)return 0;const t=Ly(e),r=e.reduce((n,i)=>n+(i-t)**2,0)/e.length;return Math.sqrt(r)}function mE({siges_code:e,medication_name:t}){const r=String(e??"").trim();if(r)return`code:${r}`;const n=String(t??"").trim().toLowerCase();return n?`name:${n}`:""}function Hp(e){const t=String(e||"").replace(/\D/g,"");return t.length<4?Number.POSITIVE_INFINITY:Number.parseInt(t.slice(-4),10)}function Vp(e){return String(e||"").trim().startsWith("110")}function gE({status:e}){if(!e?.message)return null;const t=e.type==="success"?"bg-emerald-50 border-emerald-200 text-emerald-800":e.type==="error"?"bg-rose-50 border-rose-200 text-rose-800":"bg-blue-50 border-blue-200 text-blue-800";return b.jsx("div",{className:`border rounded-lg px-4 py-3 text-sm ${t}`,children:b.jsx("span",{children:e.message})})}function xE({months:e,onRefresh:t,status:r}){const n=(e??[]).slice(0,3),i=n.map(M=>String(M?.label??"").trim()).filter(Boolean),[l,o]=Xe.useState(""),[u,h]=Xe.useState(!0),[d,g]=Xe.useState(50),[p,v]=Xe.useState(1),_=Xe.useMemo(()=>{const M=new Map;return n.forEach((N,Z)=>{const q=N?.items??[];for(const he of q){const Y=String(he?.siges_code??"").trim(),Q=String(he?.medication_name??"").trim(),pe=mE({siges_code:Y,medication_name:Q});if(!pe)continue;const Ce=M.get(pe)??{siges_code:Y,medication_name:Q,perMonth:[0,0,0]};Ce.siges_code=Ce.siges_code||Y,Ce.medication_name=Ce.medication_name||Q,Ce.perMonth[Z]+=Rd(he?.quantity),M.set(pe,Ce)}}),Array.from(M.values()).map(N=>{const Z=N.perMonth.slice(0,3),q=Ly(Z),he=dE(Z);return{...N,avg:q,sd:he,total:q+he}})},[n]),w=Xe.useMemo(()=>{const M=l.trim().toLowerCase(),N=u?_.filter(q=>Rd(q.total)>0):_;return(M?N.filter(q=>`${q.siges_code} ${q.medication_name}`.toLowerCase().includes(M)):N).sort((q,he)=>{const Y=q?.siges_code||"",Q=he?.siges_code||"",pe=Vp(Y),Ce=Vp(Q);if(pe!==Ce)return pe?-1:1;const _e=Hp(Y),te=Hp(Q);return _e!==te?_e-te:String(Y).localeCompare(String(Q),"es",{numeric:!0,sensitivity:"base"})})},[u,_,l]),y=w.length,S=Math.max(1,Number(d)||50),k=Math.max(1,Math.ceil(y/S)),R=Math.min(Math.max(p,1),k),T=Xe.useMemo(()=>{const M=(R-1)*S;return w.slice(M,M+S)},[w,R,S]),B=y===0?0:(R-1)*S+1,X=Math.min(R*S,y);return b.jsxs("div",{className:"space-y-6",children:[b.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-5",children:[b.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[b.jsxs("div",{className:"space-y-1",children:[b.jsx("h3",{className:"font-semibold text-slate-800",children:"Resumen de consumo"}),b.jsx("p",{className:"text-xs text-slate-500",children:"Muestra por medicamento: cdigo, consumos de los ltimos 3 meses, promedio, desviacin estndar y total (promedio + desviacin)."})]}),b.jsx("div",{className:"flex flex-wrap items-center gap-2",children:b.jsxs("button",{type:"button",onClick:t,className:"px-3 py-2 rounded-lg border border-slate-200 text-slate-700 hover:bg-slate-50 text-sm flex items-center gap-2",children:[b.jsx(Kl,{size:16}),"Sincronizar"]})})]}),b.jsx("div",{className:"mt-4",children:b.jsx(gE,{status:r})})]}),b.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm overflow-hidden",children:[b.jsxs("div",{className:"p-4 border-b border-slate-100 bg-slate-50 flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[b.jsxs("div",{className:"flex items-center gap-2",children:[b.jsx("div",{className:"bg-blue-50 text-blue-600 p-2 rounded-lg",children:b.jsx(Ry,{size:18})}),b.jsx("h3",{className:"font-bold text-slate-800",children:"Consumo por medicamento (ltimos 3 meses)"})]}),b.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[b.jsx("button",{type:"button",onClick:()=>{h(M=>!M),v(1)},className:"px-3 py-2 rounded-lg border border-slate-200 text-slate-700 hover:bg-slate-50 text-sm",title:"Oculta medicamentos con consumo 0 en los ltimos 3 meses",children:u?"Mostrar sin consumo":"Ocultar sin consumo"}),b.jsx("input",{value:l,onChange:M=>{o(M.target.value),v(1)},placeholder:"Buscar por cdigo o medicamento...",className:"w-72 border border-slate-200 rounded-lg px-3 py-2 text-sm bg-white"})]})]}),n.length===0?b.jsx("div",{className:"p-8 text-center text-slate-500 text-sm",children:"No hay consumos cargados."}):b.jsxs(b.Fragment,{children:[b.jsx("div",{className:"overflow-x-auto",children:b.jsxs("table",{className:"w-full min-w-[1100px] text-left",children:[b.jsx("thead",{className:"sticky top-0 z-10 bg-slate-50 text-slate-500 text-[10px] uppercase font-bold shadow-sm",children:b.jsxs("tr",{children:[b.jsx("th",{className:"px-4 py-4 whitespace-nowrap w-36 text-center",children:"Cdigo SIGES"}),b.jsx("th",{className:"px-4 py-4 whitespace-nowrap text-center",children:"Medicamento"}),b.jsx("th",{className:"px-3 py-4 text-center whitespace-nowrap w-32",children:i[2]??"Mes 3"}),b.jsx("th",{className:"px-3 py-4 text-center whitespace-nowrap w-32",children:i[1]??"Mes 2"}),b.jsx("th",{className:"px-3 py-4 text-center whitespace-nowrap w-32",children:i[0]??"Mes 1"}),b.jsx("th",{className:"px-3 py-4 text-center whitespace-nowrap w-28",children:"Promedio"}),b.jsx("th",{className:"px-3 py-4 text-center whitespace-nowrap w-28",children:"Desv. Est."}),b.jsx("th",{className:"px-3 py-4 text-center whitespace-nowrap w-36",children:"Total (Prom.+Desv.)"})]})}),b.jsxs("tbody",{className:"divide-y divide-slate-100",children:[T.map((M,N)=>b.jsxs("tr",{className:"hover:bg-slate-50",children:[b.jsx("td",{className:"px-4 py-4 text-xs text-slate-600 font-mono whitespace-nowrap text-center",children:M.siges_code||""}),b.jsx("td",{className:"px-4 py-4 text-sm font-medium text-slate-700 whitespace-normal break-words",children:M.medication_name}),b.jsx("td",{className:"px-3 py-4 text-center font-mono text-sm tabular-nums",children:El(M.perMonth[2]??0)}),b.jsx("td",{className:"px-3 py-4 text-center font-mono text-sm tabular-nums",children:El(M.perMonth[1]??0)}),b.jsx("td",{className:"px-3 py-4 text-center font-mono text-sm tabular-nums",children:El(M.perMonth[0]??0)}),b.jsx("td",{className:"px-3 py-4 text-center font-mono text-sm tabular-nums",children:El(M.avg)}),b.jsx("td",{className:"px-3 py-4 text-center font-mono text-sm tabular-nums",children:El(M.sd)}),b.jsx("td",{className:"px-3 py-4 text-center font-mono text-sm font-bold text-blue-700 tabular-nums",children:El(M.total)})]},`${M.siges_code||M.medication_name}-${N}`)),T.length===0&&b.jsx("tr",{children:b.jsx("td",{colSpan:8,className:"px-6 py-10 text-center text-sm text-slate-400",children:"No hay resultados."})})]})]})}),b.jsxs("div",{className:"p-4 border-t border-slate-100 bg-slate-50 flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[b.jsx("div",{className:"text-xs text-slate-500",children:y===0?"0 resultados":`Mostrando ${B}-${X} de ${y}`}),b.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[b.jsx("label",{className:"text-xs text-slate-500",children:"Filas"}),b.jsx("select",{value:S,onChange:M=>{g(Number(M.target.value)||50),v(1)},className:"border border-slate-200 rounded-lg px-2 py-1 text-xs bg-white",children:[25,50,100,200].map(M=>b.jsx("option",{value:M,children:M},M))}),b.jsx("button",{type:"button",onClick:()=>v(M=>Math.max(1,M-1)),disabled:R<=1,className:"px-3 py-1.5 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 disabled:opacity-40 disabled:hover:bg-white",children:"Anterior"}),b.jsxs("span",{className:"text-xs text-slate-600",children:["Pgina ",R," de ",k]}),b.jsx("button",{type:"button",onClick:()=>v(M=>Math.min(k,M+1)),disabled:R>=k,className:"px-3 py-1.5 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 disabled:opacity-40 disabled:hover:bg-white",children:"Siguiente"})]})]})]})]})]})}function Y0({title:e,value:t,icon:r,color:n}){const i={blue:"bg-blue-50 text-blue-600 border-blue-100",red:"bg-red-50 text-red-600 border-red-100",green:"bg-green-50 text-green-600 border-green-100",purple:"bg-purple-50 text-purple-600 border-purple-100"},l=typeof t=="number"?new Intl.NumberFormat("en-US",{minimumFractionDigits:0,maximumFractionDigits:e==="Total Unidades"?2:0}).format(t):t;return b.jsxs("div",{className:"p-6 rounded-2xl border bg-white shadow-sm flex items-center space-x-4",children:[b.jsx("div",{className:`p-4 rounded-xl ${i[n]||i.blue}`,children:b.jsx(r,{size:24})}),b.jsxs("div",{children:[b.jsx("p",{className:"text-sm font-medium text-slate-500",children:e}),b.jsx("p",{className:"text-2xl font-bold text-slate-800",children:l})]})]})}function pE({stats:e,consumptions:t,lowStockItems:r,onViewAllConsumptions:n,onEditMedication:i}){return b.jsxs("div",{className:"space-y-8",children:[b.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[b.jsx(Y0,{title:"Total Medicamentos",value:e.totalItems,icon:Fy,color:"blue"}),b.jsx(Y0,{title:"Stock Crtico",value:e.lowStockCount,icon:Ls,color:"red"}),b.jsx(Y0,{title:"Total Unidades",value:e.totalStockValue,icon:xu,color:"green"}),b.jsx(Y0,{title:"Consumos Recientes",value:e.recentConsumptions,icon:tm,color:"purple"})]}),b.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[b.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[b.jsxs("div",{className:"flex justify-between items-center mb-4",children:[b.jsx("h3",{className:"font-bold text-slate-800",children:"ltimos Consumos"}),b.jsxs("button",{type:"button",onClick:n,className:"text-blue-600 text-sm flex items-center hover:underline",children:["Ver todo ",b.jsx(FS,{size:14})]})]}),b.jsx("div",{className:"space-y-4",children:t.slice(0,5).map(l=>b.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-lg",children:[b.jsxs("div",{className:"flex items-center space-x-3",children:[b.jsx("div",{className:"bg-white p-2 rounded-md shadow-sm border border-slate-100 text-slate-400",children:b.jsx(nE,{size:16})}),b.jsxs("div",{children:[b.jsx("p",{className:"font-semibold text-sm",children:l.medication_name}),b.jsx("p",{className:"text-xs text-slate-500",children:l.siges_code||l.date||""})]})]}),b.jsxs("div",{className:"text-right",children:[b.jsx("p",{className:"text-sm font-bold text-slate-800",children:l.quantity}),b.jsx("p",{className:"text-xs text-slate-500 font-mono",children:l.cost??l.user??""})]})]},l.id))})]}),b.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[b.jsxs("div",{className:"flex justify-between items-center mb-4",children:[b.jsx("h3",{className:"font-bold text-slate-800",children:"Medicamentos Agotndose"}),b.jsxs("span",{className:"bg-red-100 text-red-700 text-xs px-2 py-1 rounded-full font-bold",children:[r.length," Alertas"]})]}),b.jsx("div",{className:"space-y-4",children:r.length>0?r.map(l=>b.jsxs("div",{className:"flex items-center justify-between p-3 border-l-4 border-red-500 bg-red-50 rounded-r-lg",children:[b.jsxs("div",{children:[b.jsx("p",{className:"font-semibold text-sm text-slate-800",children:l.name}),b.jsxs("p",{className:"text-xs text-slate-500",children:["Mnimo: ",l.min_stock," | Actual: ",l.stock]})]}),b.jsx("button",{type:"button",onClick:()=>i(l),className:"text-xs bg-white border border-red-200 text-red-600 px-3 py-1 rounded hover:bg-red-100 transition-colors",children:"Reponer"})]},l.id)):b.jsx("div",{className:"text-center py-8",children:b.jsx("p",{className:"text-slate-400 text-sm italic",children:"No hay alertas activas de inventario."})})})]})]})]})}function vE({inventoryType:e,onInventoryTypeChange:t,inventoryStatus:r,fileInputRef:n,onChooseFile:i,onFileChange:l,onDownloadTemplate:o,onRefresh:u,canClear:h,onClearInventory:d,hideNoMovement:g,canToggleHideNoMovement:p,onToggleHideNoMovement:v,search:_,onSearchChange:w,items:y,totalItems:S,page:k,pageSize:R,onPageChange:T,onPageSizeChange:B}){const X=String(e||"772"),M=X==="771",N=X==="total",Z=N?"w-[260px] max-w-[260px]":"max-w-[620px]",q=ge=>{const J=Number(ge);return Number.isFinite(J)?J.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):String(ge??"0")},he=ge=>{const J=String(ge??"").trim();if(!J)return"S/N";const Oe=J.match(/^(\d{4})-(\d{2})-(\d{2})/);if(Oe)return`${Oe[3]}/${Oe[2]}/${Oe[1]}`;const I=new Date(J);if(!Number.isNaN(I.getTime())){const A=String(I.getDate()).padStart(2,"0"),z=String(I.getMonth()+1).padStart(2,"0"),U=String(I.getFullYear());return`${A}/${z}/${U}`}return J},Y=ge=>{if(!ge)return"";const J=String(ge.batch||"").trim()||"S/N",Oe=he(ge.expiry_date),I=q(ge.stock);return`${J} (${Oe}): ${I}`},Q=Number(S)||0,pe=Number(R)||50,Ce=Math.max(1,Math.ceil(Q/pe)),_e=Math.min(Math.max(Number(k)||1,1),Ce),te=Q===0?0:(_e-1)*pe+1,se=Math.min(_e*pe,Q);return b.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden",children:[b.jsxs("div",{className:"p-4 border-b border-slate-100 bg-slate-50 flex flex-col gap-3",children:[b.jsxs("div",{className:"flex flex-wrap gap-3 items-center justify-between",children:[b.jsx("div",{className:"flex items-center gap-2",children:[{key:"772",label:"Inventario 772"},{key:"771",label:"Inventario 771"},{key:"total",label:"Inventario total"}].map(ge=>b.jsx("button",{type:"button",onClick:()=>t?.(ge.key),className:`px-3 py-1.5 rounded-lg text-xs font-bold border transition-colors ${X===ge.key?"bg-blue-600 text-white border-blue-600":"bg-white text-slate-600 border-slate-200 hover:bg-blue-50 hover:text-blue-700"}`,children:ge.label},ge.key))}),b.jsxs("div",{className:"flex items-center gap-2",children:[b.jsxs("button",{type:"button",onClick:u,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 flex items-center gap-2",title:"Sincronizar inventarios",children:[b.jsx(Kl,{size:14}),"Sincronizar"]}),N&&b.jsxs("button",{type:"button",onClick:()=>v?.(),disabled:!p,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 flex items-center gap-2 disabled:opacity-40 disabled:hover:bg-white",title:p?"Oculta medicamentos sin consumo en los ltimos 4 meses.":"No hay consumos cargados para filtrar.",children:[g?b.jsx(PS,{size:14}):b.jsx(US,{size:14}),g?"Mostrar sin movimiento":"Ocultar sin movimiento (4 meses)"]}),!N&&b.jsxs(b.Fragment,{children:[b.jsx("input",{type:"file",ref:n,onChange:l,accept:M?".xml":".csv",className:"hidden"}),b.jsxs("button",{type:"button",onClick:i,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-blue-50 hover:text-blue-700 flex items-center gap-2",children:[b.jsx(Yl,{size:14}),M?"Cargar XML":"Cargar CSV"]}),b.jsxs("button",{type:"button",onClick:()=>o?.(e),className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 flex items-center gap-2",children:[b.jsx(Bu,{size:14}),"Plantilla"]}),b.jsxs("button",{type:"button",onClick:()=>d?.(e),disabled:!h,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-red-200 text-red-600 hover:bg-red-50 flex items-center gap-2 disabled:opacity-40 disabled:hover:bg-white",title:"Eliminar toda la carga de este inventario",children:[b.jsx(oo,{size:14}),"Eliminar carga"]})]})]})]}),r?.message&&b.jsxs("div",{className:`p-3 rounded-lg text-xs flex items-center gap-2 ${r.type==="success"?"bg-green-50 text-green-700 border border-green-100":r.type==="error"?"bg-red-50 text-red-700 border border-red-100":"bg-blue-50 text-blue-700 border border-blue-100"}`,children:[r.type==="success"?b.jsx(Lu,{size:16}):b.jsx(Ls,{size:16}),b.jsx("span",{children:r.message})]}),b.jsxs("div",{className:"relative w-72",children:[b.jsx(rm,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:18}),b.jsx("input",{type:"text",value:_,onChange:ge=>w(ge.target.value),placeholder:"Buscar medicamento...",className:"w-full pl-10 pr-4 py-2 border border-slate-200 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 outline-none"})]})]}),b.jsx("div",{className:"overflow-x-auto",children:b.jsxs("table",{className:"min-w-max w-full text-left",children:[b.jsx("thead",{className:"bg-slate-50 text-slate-500 text-[10px] uppercase font-bold",children:b.jsxs("tr",{children:[b.jsx("th",{className:"px-6 py-4 text-center whitespace-nowrap",children:"Cdigo SIGES"}),b.jsx("th",{className:`px-6 py-4 whitespace-nowrap ${Z}`,children:"Medicamento"}),N&&b.jsx("th",{className:"px-6 py-4 text-center whitespace-nowrap",children:"Inv. 772"}),(M||N)&&b.jsx("th",{className:"px-6 py-4 whitespace-nowrap",children:"Lotes 771 (venc. / cant.)"}),N&&b.jsx("th",{className:"px-6 py-4 text-center whitespace-nowrap",children:"Inv. 771"}),b.jsx("th",{className:"px-6 py-4 text-center whitespace-nowrap",children:N?"Inventario total":"Inventario"})]})}),b.jsxs("tbody",{className:"divide-y divide-slate-100",children:[y.map(ge=>b.jsxs("tr",{className:"hover:bg-slate-50 transition-colors group text-sm",children:[b.jsx("td",{className:"px-6 py-4 text-slate-700 font-mono text-center whitespace-nowrap",children:ge.siges_code||""}),b.jsx("td",{className:`px-6 py-4 ${Z} text-slate-700`,children:b.jsx("span",{className:"block truncate",children:ge.name})}),N&&b.jsx("td",{className:"px-6 py-4 text-center whitespace-nowrap text-slate-700 font-mono",children:q(ge.stock772)}),(M||N)&&b.jsx("td",{className:`px-6 py-4 text-slate-600 font-mono ${N?"text-center":""}`,children:b.jsx("div",{className:`flex flex-col gap-1 ${N?"items-center":""}`,children:Array.isArray(ge.lots)&&ge.lots.length>0?ge.lots.map(J=>b.jsx("div",{className:"whitespace-nowrap",children:Y(J)},J.id||`${J.batch}-${J.expiry_date}`)):b.jsx("div",{className:"whitespace-nowrap",children:N?"":Y(ge)})})}),N&&b.jsx("td",{className:"px-6 py-4 text-center whitespace-nowrap text-slate-700 font-mono",children:q(ge.stock771)}),b.jsx("td",{className:"px-6 py-4 text-center whitespace-nowrap text-slate-800",children:b.jsx("span",{className:"font-bold",children:q(ge.stock)})})]},ge.id)),y.length===0&&b.jsx("tr",{children:b.jsxs("td",{colSpan:N?6:M?4:3,className:"px-6 py-10 text-center text-sm text-slate-400",children:['No hay resultados para "',_,'".']})})]})]})}),b.jsxs("div",{className:"p-4 border-t border-slate-100 bg-slate-50 flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[b.jsx("div",{className:"text-xs text-slate-500",children:Q===0?"0 resultados":`Mostrando ${te}-${se} de ${Q}`}),b.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[b.jsx("label",{className:"text-xs text-slate-500",children:"Filas"}),b.jsx("select",{value:pe,onChange:ge=>B?.(Number(ge.target.value)||50),className:"border border-slate-200 rounded-lg px-2 py-1 text-xs bg-white",children:[25,50,100,200].map(ge=>b.jsx("option",{value:ge,children:ge},ge))}),b.jsx("button",{type:"button",onClick:()=>T?.(_e-1),disabled:_e<=1,className:"px-3 py-1.5 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 disabled:opacity-40 disabled:hover:bg-white",children:"Anterior"}),b.jsxs("span",{className:"text-xs text-slate-600",children:["Pgina ",_e," de ",Ce]}),b.jsx("button",{type:"button",onClick:()=>T?.(_e+1),disabled:_e>=Ce,className:"px-3 py-1.5 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 disabled:opacity-40 disabled:hover:bg-white",children:"Siguiente"})]})]})]})}function yE({status:e}){if(!e?.message)return null;const t=e.type==="success"?"bg-emerald-50 border-emerald-200 text-emerald-800":e.type==="error"?"bg-rose-50 border-rose-200 text-rose-800":"bg-blue-50 border-blue-200 text-blue-800";return b.jsx("div",{className:`border rounded-lg px-4 py-3 text-sm ${t}`,children:b.jsx("span",{children:e.message})})}function _E({months:e,selectedMonthId:t,onSelectMonth:r,monthlyStatus:n,fileInputRef:i,onChooseFile:l,onFileChange:o,onDownloadTemplate:u,onRefresh:h}){const d=e.find(v=>v.id===t)||null,g=v=>{const _=typeof v=="number"?v:Number(v);return Number.isFinite(_)?new Intl.NumberFormat("es-CR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(_):""},p=v=>{const _=typeof v=="number"?v:Number(v);return Number.isFinite(_)?new Intl.NumberFormat("es-CR",{style:"currency",currency:"CRC",minimumFractionDigits:2,maximumFractionDigits:2}).format(_):""};return b.jsxs("div",{className:"space-y-4",children:[b.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-5",children:[b.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[b.jsxs("div",{className:"space-y-1",children:[b.jsx("h3",{className:"font-semibold text-slate-800",children:"Importar consumo mensual"}),b.jsxs("p",{className:"text-xs text-slate-500",children:["Recomendado: nombre del archivo ",b.jsx("span",{className:"font-mono",children:"Enero 2025.csv"})," (se usa como nombre del mes)."]})]}),b.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[b.jsx("input",{type:"file",ref:i,onChange:o,accept:".csv",className:"hidden"}),b.jsxs("button",{type:"button",onClick:u,className:"px-3 py-2 rounded-lg border border-slate-200 text-slate-700 hover:bg-slate-50 text-sm flex items-center gap-2",children:[b.jsx(HS,{size:16}),"Descargar plantilla"]}),b.jsxs("button",{type:"button",onClick:h,className:"px-3 py-2 rounded-lg border border-slate-200 text-slate-700 hover:bg-slate-50 text-sm flex items-center gap-2",children:[b.jsx(Kl,{size:16}),"Sincronizar"]}),b.jsxs("button",{type:"button",onClick:l,className:"px-3 py-2 rounded-lg bg-blue-600 hover:bg-blue-700 text-white text-sm flex items-center gap-2",children:[b.jsx(Yl,{size:16}),"Importar CSV"]})]})]}),b.jsx("div",{className:"mt-4",children:b.jsx(yE,{status:n})}),b.jsxs("div",{className:"mt-4 flex flex-col gap-2 md:flex-row md:items-center",children:[b.jsx("label",{className:"text-xs font-semibold text-slate-600",children:"Mes cargado"}),b.jsxs("select",{className:"border border-slate-200 rounded-lg px-3 py-2 text-sm bg-white",value:t??"",onChange:v=>r(v.target.value||null),children:[b.jsx("option",{value:"",children:"Seleccione un mes..."}),e.map(v=>b.jsx("option",{value:v.id,children:v.label},v.id))]})]})]}),b.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden",children:[b.jsxs("div",{className:"px-6 py-4 border-b border-slate-100 flex items-center justify-between",children:[b.jsx("h4",{className:"font-semibold text-slate-800",children:d?`Detalle: ${d.label}`:"Detalle del mes"}),d&&b.jsxs("span",{className:"text-xs text-slate-500",children:[d.items.length," registros"]})]}),d?d.items.length===0?b.jsx("div",{className:"p-8 text-center text-slate-500 text-sm",children:"No hay consumos en este mes."}):b.jsxs("table",{className:"w-full text-left",children:[b.jsx("thead",{className:"bg-slate-50 text-slate-500 text-[10px] uppercase font-bold",children:b.jsxs("tr",{children:[b.jsx("th",{className:"px-6 py-4 whitespace-nowrap w-32 text-center",children:"Cdigo SIGES"}),b.jsx("th",{className:"px-6 py-4",children:"Medicamento"}),b.jsx("th",{className:"px-6 py-4 text-center whitespace-nowrap",children:"Consumo"}),b.jsx("th",{className:"px-6 py-4 text-center whitespace-nowrap",children:"Costo"})]})}),b.jsx("tbody",{className:"divide-y divide-slate-100",children:d.items.map(v=>b.jsxs("tr",{className:"hover:bg-slate-50",children:[b.jsx("td",{className:"px-6 py-4 text-xs text-slate-500 font-mono whitespace-nowrap w-32 text-center",children:v.siges_code||""}),b.jsx("td",{className:"px-6 py-4 text-sm font-medium",children:v.medication_name}),b.jsx("td",{className:"px-6 py-4 text-center text-slate-800 font-semibold text-sm tabular-nums",children:g(v.quantity)}),b.jsx("td",{className:"px-6 py-4 text-center text-slate-700 text-sm font-mono tabular-nums",children:p(v.cost)})]},v.id))})]}):b.jsx("div",{className:"p-8 text-center text-slate-500 text-sm",children:"Importa un CSV y selecciona un mes para ver el detalle."})]})]})}function Hi(e){const t=typeof e=="number"?e:Number(String(e??"").trim().replace(/\s/g,"").replace(/,/g,""));return Number.isFinite(t)?t:0}function J0(e){const t=Hi(e);return new Intl.NumberFormat("es-CR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(t)}function By(e){return e.length?e.reduce((t,r)=>t+r,0)/e.length:0}function wE(e){if(e.length<=1)return 0;const t=By(e),r=e.reduce((n,i)=>n+(i-t)**2,0)/e.length;return Math.sqrt(r)}function bE({siges_code:e,medication_name:t}){const r=String(e??"").trim();if(r)return`code:${r}`;const n=String(t??"").trim().toLowerCase();return n?`name:${n}`:""}function $p(e){const t=String(e||"").replace(/\D/g,"");return t.length<4?Number.POSITIVE_INFINITY:Number.parseInt(t.slice(-4),10)}function Gp(e){return String(e||"").trim().startsWith("110")}function qp({status:e}){if(!e?.message)return null;const t=e.type==="success"?"bg-emerald-50 border-emerald-200 text-emerald-800":e.type==="error"?"bg-rose-50 border-rose-200 text-rose-800":"bg-blue-50 border-blue-200 text-blue-800";return b.jsx("div",{className:`border rounded-lg px-4 py-3 text-sm ${t}`,children:b.jsx("span",{children:e.message})})}function SE({medications:e,months:t,tertiaryPackaging:r,inventoryStatus:n,monthlyStatus:i,onRefreshInventories:l,onRefreshConsumptions:o}){const[u,h]=Xe.useState(3),[d,g]=Xe.useState(""),[p,v]=Xe.useState(!0),[_,w]=Xe.useState(50),[y,S]=Xe.useState(1),k=Xe.useMemo(()=>{const Y=(t??[]).slice(0,3),Q=Y.map(ge=>String(ge?.label??"").trim()).filter(Boolean),pe=new Map;for(const ge of r??[]){const J=String(ge?.siges_code??"").trim();if(!J)continue;const Oe=Hi(ge?.tertiary_quantity);Oe>0&&pe.set(J,Oe)}const Ce=new Map;for(const ge of e??[]){const J=String(ge?.siges_code??"").trim();if(!J)continue;const Oe=String(ge?.inventory_type||"772"),I=Ce.get(J)??{inv771:0,inv772:0};Oe==="771"&&(I.inv771+=Hi(ge?.stock)),Oe==="772"&&(I.inv772+=Hi(ge?.stock)),Ce.set(J,I)}const _e=new Map;Y.forEach((ge,J)=>{const Oe=ge?.items??[];for(const I of Oe){const A=String(I?.siges_code??"").trim(),z=String(I?.medication_name??"").trim(),U=bE({siges_code:A,medication_name:z});if(!U)continue;const G=_e.get(U)??{siges_code:A,medication_name:z,perMonth:[0,0,0]};G.siges_code=G.siges_code||A,G.medication_name=G.medication_name||z,G.perMonth[J]+=Hi(I?.quantity),_e.set(U,G)}});const te=Math.max(0,Number(u)||0),se=Array.from(_e.values()).map(ge=>{const J=ge.perMonth.slice(0,3),Oe=By(J),I=wE(J),A=Oe+I,z=String(ge.siges_code??"").trim(),U=Ce.get(z)??{inv771:0,inv772:0},G=Hi(U.inv771)+Hi(U.inv772),ne=A*te-G,we=Math.max(0,ne),Te=pe.get(z)??0,Se=Te>0?we===0?0:Math.ceil(we/Te)*Te:we;return{siges_code:z,medication_name:ge.medication_name,consumoTotal:A,invTotal:G,empaqueTerciario:Te,pedido:Se}});return{monthLabels:Q,rows:se}},[e,t,u,r]),R=k.monthLabels??[],T=Xe.useMemo(()=>{const Y=d.trim().toLowerCase(),Q=k.rows??[],pe=p?Q.filter(_e=>Hi(_e.pedido)>0):Q;return(Y?pe.filter(_e=>`${_e.siges_code} ${_e.medication_name}`.toLowerCase().includes(Y)):pe).sort((_e,te)=>{const se=_e?.siges_code||"",ge=te?.siges_code||"",J=Gp(se),Oe=Gp(ge);if(J!==Oe)return J?-1:1;const I=$p(se),A=$p(ge);return I!==A?I-A:String(se).localeCompare(String(ge),"es",{numeric:!0,sensitivity:"base"})})},[k.rows,p,d]),B=T.length,X=Math.max(1,Number(_)||50),M=Math.max(1,Math.ceil(B/X)),N=Math.min(Math.max(y,1),M),Z=B===0?0:(N-1)*X+1,q=Math.min(N*X,B),he=Xe.useMemo(()=>{const Y=(N-1)*X;return T.slice(Y,Y+X)},[T,N,X]);return b.jsxs("div",{className:"space-y-6",children:[b.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-5",children:[b.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[b.jsxs("div",{className:"space-y-1",children:[b.jsx("h3",{className:"font-semibold text-slate-800",children:"Solicitud Pedido"}),b.jsx("p",{className:"text-xs text-slate-500",children:"Pedido = (Consumo total  Meses)  (Inventario total). Consumo total = Promedio + Desv. Est. Inventario total = Inv. 772 + Inv. 771."})]}),b.jsx("div",{className:"flex flex-wrap items-center gap-2",children:b.jsxs("button",{type:"button",onClick:()=>{o?.(),l?.()},className:"px-3 py-2 rounded-lg border border-slate-200 text-slate-700 hover:bg-slate-50 text-sm flex items-center gap-2",children:[b.jsx(Kl,{size:16}),"Sincronizar"]})})]}),b.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-3 gap-3",children:[b.jsxs("div",{className:"md:col-span-1",children:[b.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase mb-1",children:"Meses a pedir"}),b.jsx("input",{type:"number",min:0,step:1,value:u,onChange:Y=>{h(Number(Y.target.value)||0),S(1)},className:"w-full border border-slate-200 rounded-lg px-3 py-2 text-sm bg-white"})]}),b.jsxs("div",{className:"md:col-span-2 flex flex-col gap-2",children:[b.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase mb-1",children:"Filtros"}),b.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[b.jsx("button",{type:"button",onClick:()=>{v(Y=>!Y),S(1)},className:"px-3 py-2 rounded-lg border border-slate-200 text-slate-700 hover:bg-slate-50 text-sm",children:p?"Mostrar pedido 0":"Ocultar pedido 0"}),b.jsx("input",{value:d,onChange:Y=>{g(Y.target.value),S(1)},placeholder:"Buscar por cdigo o medicamento...",className:"flex-1 min-w-72 border border-slate-200 rounded-lg px-3 py-2 text-sm bg-white"})]})]})]}),b.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-3",children:[b.jsx(qp,{status:n}),b.jsx(qp,{status:i})]})]}),b.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm overflow-hidden",children:[b.jsxs("div",{className:"p-4 border-b border-slate-100 bg-slate-50 flex items-center justify-between",children:[b.jsxs("div",{className:"flex items-center gap-3",children:[b.jsx("div",{className:"bg-blue-50 text-blue-600 p-2 rounded-lg",children:b.jsx(tm,{size:18})}),b.jsxs("div",{children:[b.jsx("h3",{className:"font-bold text-slate-800",children:"Clculo por medicamento"}),b.jsxs("p",{className:"text-xs text-slate-500",children:["Meses usados: ",R.length?R.slice().reverse().join(", "):"Sin datos"]})]})]}),b.jsxs("span",{className:"text-xs text-slate-500",children:[B," filas"]})]}),b.jsx("div",{className:"overflow-auto max-h-[70vh]",children:b.jsxs("table",{className:"w-full min-w-[860px] text-left",children:[b.jsx("thead",{className:"sticky top-0 z-10 bg-slate-50 text-slate-500 text-[10px] uppercase font-bold shadow-sm",children:b.jsxs("tr",{children:[b.jsx("th",{className:"px-4 py-4 whitespace-nowrap w-36 text-center",children:"Cdigo"}),b.jsx("th",{className:"px-4 py-4 whitespace-nowrap",children:"Medicamento"}),b.jsx("th",{className:"px-3 py-4 text-center whitespace-nowrap w-40",children:"Consumo total"}),b.jsx("th",{className:"px-3 py-4 text-center whitespace-nowrap w-40",children:"Inventario total"}),b.jsx("th",{className:"px-3 py-4 text-center whitespace-nowrap w-40",children:"Empaque terciario"}),b.jsx("th",{className:"px-3 py-4 text-center whitespace-nowrap w-40",children:"Pedido"})]})}),b.jsxs("tbody",{className:"divide-y divide-slate-100",children:[he.map((Y,Q)=>b.jsxs("tr",{className:"hover:bg-slate-50",children:[b.jsx("td",{className:"px-4 py-4 text-xs text-slate-600 font-mono whitespace-nowrap text-center",children:Y.siges_code||""}),b.jsx("td",{className:"px-4 py-4 text-sm font-medium text-slate-700 whitespace-normal break-words",children:Y.medication_name}),b.jsx("td",{className:"px-3 py-4 text-center font-mono text-sm tabular-nums",children:J0(Y.consumoTotal)}),b.jsx("td",{className:"px-3 py-4 text-center font-mono text-sm tabular-nums",children:J0(Y.invTotal)}),b.jsx("td",{className:"px-3 py-4 text-center font-mono text-sm tabular-nums",children:Y.empaqueTerciario?J0(Y.empaqueTerciario):""}),b.jsx("td",{className:"px-3 py-4 text-center font-mono text-sm font-bold text-blue-700 tabular-nums",children:J0(Y.pedido)})]},`${Y.siges_code||Y.medication_name}-${Q}`)),he.length===0&&b.jsx("tr",{children:b.jsx("td",{colSpan:6,className:"px-6 py-10 text-center text-sm text-slate-400",children:"No hay resultados."})})]})]})}),b.jsxs("div",{className:"p-4 border-t border-slate-100 bg-slate-50 flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[b.jsx("div",{className:"text-xs text-slate-500",children:B===0?"0 resultados":`Mostrando ${Z}-${q} de ${B}`}),b.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[b.jsx("label",{className:"text-xs text-slate-500",children:"Filas"}),b.jsx("select",{value:X,onChange:Y=>{w(Number(Y.target.value)||50),S(1)},className:"border border-slate-200 rounded-lg px-2 py-1 text-xs bg-white",children:[25,50,100,200].map(Y=>b.jsx("option",{value:Y,children:Y},Y))}),b.jsx("button",{type:"button",onClick:()=>S(Y=>Math.max(1,Y-1)),disabled:N<=1,className:"px-3 py-1.5 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 disabled:opacity-40 disabled:hover:bg-white",children:"Anterior"}),b.jsxs("span",{className:"text-xs text-slate-600",children:["Pgina ",N," de ",M]}),b.jsx("button",{type:"button",onClick:()=>S(Y=>Math.min(M,Y+1)),disabled:N>=M,className:"px-3 py-1.5 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 disabled:opacity-40 disabled:hover:bg-white",children:"Siguiente"})]})]})]})]})}function EE({status:e,fileInputRef:t,onChooseFile:r,onFileChange:n,onDownloadTemplate:i,onRefresh:l,canClear:o,onClear:u,search:h,onSearchChange:d,items:g,totalItems:p,page:v,pageSize:_,onPageChange:w,onPageSizeChange:y}){const S=N=>{const Z=Number(N);return Number.isFinite(Z)?Z.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):String(N??"0")},k=Number(p)||0,R=Number(_)||50,T=Math.max(1,Math.ceil(k/R)),B=Math.min(Math.max(Number(v)||1,1),T),X=k===0?0:(B-1)*R+1,M=Math.min(B*R,k);return b.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden",children:[b.jsxs("div",{className:"p-4 border-b border-slate-100 bg-slate-50 flex flex-col gap-3",children:[b.jsxs("div",{className:"flex flex-wrap gap-3 items-center justify-between",children:[b.jsxs("div",{className:"relative w-80",children:[b.jsx(rm,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:18}),b.jsx("input",{type:"text",value:h,onChange:N=>d?.(N.target.value),placeholder:"Buscar por cdigo o medicamento...",className:"w-full pl-10 pr-4 py-2 border border-slate-200 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 outline-none"})]}),b.jsxs("div",{className:"flex items-center gap-2",children:[b.jsx("input",{type:"file",ref:t,onChange:n,accept:".xlsx",className:"hidden"}),b.jsxs("button",{type:"button",onClick:l,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 flex items-center gap-2",title:"Sincronizar empaque terciario",children:[b.jsx(Kl,{size:14}),"Sincronizar"]}),b.jsxs("button",{type:"button",onClick:r,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-blue-50 hover:text-blue-700 flex items-center gap-2",children:[b.jsx(Yl,{size:14}),"Cargar XLSX"]}),b.jsxs("button",{type:"button",onClick:i,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 flex items-center gap-2",children:[b.jsx(Bu,{size:14}),"Plantilla"]}),b.jsxs("button",{type:"button",onClick:u,disabled:!o,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-red-200 text-red-600 hover:bg-red-50 flex items-center gap-2 disabled:opacity-40 disabled:hover:bg-white",title:"Eliminar toda la carga",children:[b.jsx(oo,{size:14}),"Eliminar carga"]})]})]}),e?.message&&b.jsxs("div",{className:`p-3 rounded-lg text-xs flex items-center gap-2 ${e.type==="success"?"bg-green-50 text-green-700 border border-green-100":e.type==="error"?"bg-red-50 text-red-700 border border-red-100":"bg-blue-50 text-blue-700 border border-blue-100"}`,children:[e.type==="success"?b.jsx(Lu,{size:16}):b.jsx(Ls,{size:16}),b.jsx("span",{children:e.message})]})]}),b.jsx("div",{className:"overflow-x-auto",children:b.jsxs("table",{className:"min-w-max w-full text-left",children:[b.jsx("thead",{className:"bg-slate-50 text-slate-500 text-[10px] uppercase font-bold",children:b.jsxs("tr",{children:[b.jsx("th",{className:"px-6 py-4 text-center whitespace-nowrap",children:"Cdigo SIGES"}),b.jsx("th",{className:"px-6 py-4 whitespace-nowrap",children:"Medicamento"}),b.jsx("th",{className:"px-6 py-4 text-center whitespace-nowrap",children:"Empaque terciario"})]})}),b.jsxs("tbody",{className:"divide-y divide-slate-100",children:[g.map(N=>b.jsxs("tr",{className:"hover:bg-slate-50 transition-colors group text-sm",children:[b.jsx("td",{className:"px-6 py-4 text-slate-700 font-mono text-center whitespace-nowrap",children:N.siges_code}),b.jsx("td",{className:"px-6 py-4 text-slate-700 max-w-[520px]",children:b.jsx("span",{className:"block truncate",children:N.medication_name})}),b.jsx("td",{className:"px-6 py-4 text-center whitespace-nowrap text-slate-800 font-mono",children:S(N.tertiary_quantity)})]},N.id)),g.length===0&&b.jsx("tr",{children:b.jsxs("td",{colSpan:3,className:"px-6 py-10 text-center text-sm text-slate-400",children:['No hay resultados para "',h,'".']})})]})]})}),b.jsxs("div",{className:"p-4 border-t border-slate-100 bg-slate-50 flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[b.jsx("div",{className:"text-xs text-slate-500",children:k===0?"0 resultados":`Mostrando ${X}-${M} de ${k}`}),b.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[b.jsx("label",{className:"text-xs text-slate-500",children:"Filas"}),b.jsx("select",{value:R,onChange:N=>y?.(Number(N.target.value)||50),className:"border border-slate-200 rounded-lg px-2 py-1 text-xs bg-white",children:[25,50,100,200].map(N=>b.jsx("option",{value:N,children:N},N))}),b.jsx("button",{type:"button",onClick:()=>w?.(B-1),disabled:B<=1,className:"px-3 py-1.5 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 disabled:opacity-40 disabled:hover:bg-white",children:"Anterior"}),b.jsxs("span",{className:"text-xs text-slate-600",children:["Pgina ",B," de ",T]}),b.jsx("button",{type:"button",onClick:()=>w?.(B+1),disabled:B>=T,className:"px-3 py-1.5 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 disabled:opacity-40 disabled:hover:bg-white",children:"Siguiente"})]})]})]})}const TE=["Ordinario","Fro","Estupefaciente","Psicotrpico","Alcohol","Suero","Compra Local"];function kE({status:e,fileInputRef:t,onChooseFile:r,onFileChange:n,onDownloadTemplate:i,onRefresh:l,canClear:o,onClear:u,search:h,onSearchChange:d,items:g,totalItems:p,page:v,pageSize:_,onPageChange:w,onPageSizeChange:y}){const S=Number(p)||0,k=Number(_)||50,R=Math.max(1,Math.ceil(S/k)),T=Math.min(Math.max(Number(v)||1,1),R),B=S===0?0:(T-1)*k+1,X=Math.min(T*k,S);return b.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden",children:[b.jsxs("div",{className:"p-4 border-b border-slate-100 bg-slate-50 flex flex-col gap-3",children:[b.jsxs("div",{className:"flex flex-wrap gap-3 items-center justify-between",children:[b.jsxs("div",{className:"relative w-80",children:[b.jsx(rm,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:18}),b.jsx("input",{type:"text",value:h,onChange:M=>d?.(M.target.value),placeholder:"Buscar por cdigo o medicamento...",className:"w-full pl-10 pr-4 py-2 border border-slate-200 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 outline-none"})]}),b.jsxs("div",{className:"flex items-center gap-2",children:[b.jsx("input",{type:"file",ref:t,onChange:n,accept:".xlsx",className:"hidden"}),b.jsxs("button",{type:"button",onClick:l,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 flex items-center gap-2",title:"Sincronizar categoras",children:[b.jsx(Kl,{size:14}),"Sincronizar"]}),b.jsxs("button",{type:"button",onClick:r,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-blue-50 hover:text-blue-700 flex items-center gap-2",children:[b.jsx(Yl,{size:14}),"Cargar XLSX"]}),b.jsxs("button",{type:"button",onClick:i,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 flex items-center gap-2",children:[b.jsx(Bu,{size:14}),"Plantilla"]}),b.jsxs("button",{type:"button",onClick:u,disabled:!o,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-red-200 text-red-600 hover:bg-red-50 flex items-center gap-2 disabled:opacity-40 disabled:hover:bg-white",title:"Eliminar toda la carga",children:[b.jsx(oo,{size:14}),"Eliminar carga"]})]})]}),b.jsxs("div",{className:"text-[11px] text-slate-500",children:["Categoras permitidas: ",TE.join(", "),"."]}),e?.message&&b.jsxs("div",{className:`p-3 rounded-lg text-xs flex items-center gap-2 ${e.type==="success"?"bg-green-50 text-green-700 border border-green-100":e.type==="error"?"bg-red-50 text-red-700 border border-red-100":"bg-blue-50 text-blue-700 border border-blue-100"}`,children:[e.type==="success"?b.jsx(Lu,{size:16}):b.jsx(Ls,{size:16}),b.jsx("span",{children:e.message})]})]}),b.jsx("div",{className:"overflow-x-auto",children:b.jsxs("table",{className:"min-w-max w-full text-left",children:[b.jsx("thead",{className:"bg-slate-50 text-slate-500 text-[10px] uppercase font-bold",children:b.jsxs("tr",{children:[b.jsx("th",{className:"px-6 py-4 text-center whitespace-nowrap",children:"Cdigo"}),b.jsx("th",{className:"px-6 py-4 whitespace-nowrap",children:"Medicamento"}),b.jsx("th",{className:"px-6 py-4 text-center whitespace-nowrap",children:"Categora"})]})}),b.jsxs("tbody",{className:"divide-y divide-slate-100",children:[g.map(M=>b.jsxs("tr",{className:"hover:bg-slate-50 transition-colors group text-sm",children:[b.jsx("td",{className:"px-6 py-4 text-slate-700 font-mono text-center whitespace-nowrap",children:M.siges_code}),b.jsx("td",{className:"px-6 py-4 text-slate-700 max-w-[520px]",children:b.jsx("span",{className:"block truncate",children:M.medication_name})}),b.jsx("td",{className:"px-6 py-4 text-center whitespace-nowrap text-slate-800 font-mono",children:M.category})]},M.id)),g.length===0&&b.jsx("tr",{children:b.jsxs("td",{colSpan:3,className:"px-6 py-10 text-center text-sm text-slate-400",children:['No hay resultados para "',h,'".']})})]})]})}),b.jsxs("div",{className:"p-4 border-t border-slate-100 bg-slate-50 flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[b.jsx("div",{className:"text-xs text-slate-500",children:S===0?"0 resultados":`Mostrando ${B}-${X} de ${S}`}),b.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[b.jsx("label",{className:"text-xs text-slate-500",children:"Filas"}),b.jsx("select",{value:k,onChange:M=>y?.(Number(M.target.value)||50),className:"border border-slate-200 rounded-lg px-2 py-1 text-xs bg-white",children:[25,50,100,200].map(M=>b.jsx("option",{value:M,children:M},M))}),b.jsx("button",{type:"button",onClick:()=>w?.(T-1),disabled:T<=1,className:"px-3 py-1.5 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 disabled:opacity-40 disabled:hover:bg-white",children:"Anterior"}),b.jsxs("span",{className:"text-xs text-slate-600",children:["Pgina ",T," de ",R]}),b.jsx("button",{type:"button",onClick:()=>w?.(T+1),disabled:T>=R,className:"px-3 py-1.5 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 disabled:opacity-40 disabled:hover:bg-white",children:"Siguiente"})]})]})]})}function AE(e){return e.replace(/^\uFEFF/,"")}function CE(e){const t=(e.match(/,/g)||[]).length;return(e.match(/;/g)||[]).length>t?";":","}function Iy(e){const t=AE(e).replace(/\r\n/g,`
`).replace(/\r/g,`
`),r=[];let n=[],i="",l=!1,o=0;const u=t.split(`
`)[0]||"",h=CE(u);for(;o<t.length;){const g=t[o];if(l){if(g==='"'){if(t[o+1]==='"'){i+='"',o+=2;continue}l=!1,o+=1;continue}i+=g,o+=1;continue}if(g==='"'){l=!0,o+=1;continue}if(g===h){n.push(i),i="",o+=1;continue}if(g===`
`){n.push(i),i="",n.every(v=>String(v||"").trim()==="")||r.push(n),n=[],o+=1;continue}i+=g,o+=1}return n.push(i),n.every(g=>String(g||"").trim()==="")||r.push(n),{rows:r,delimiter:h}}function Xp(e){const{rows:t}=Iy(e);return t}function NE(e){return String(e||"").trim().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]/g,"")}function OE(e){const t={nombre:"Nombre",name:"Nombre",categoria:"Categoria",category:"Categoria",codigosiges:"CodigoSIGES",codsiges:"CodigoSIGES",siges:"CodigoSIGES",codigosicop:"IdentificadorSICOP",identificadorsicop:"IdentificadorSICOP",identificac:"IdentificadorSICOP",identificador:"IdentificadorSICOP",idsicop:"IdentificadorSICOP",clasificadorsicop:"ClasificadorSICOP",clasificador:"ClasificadorSICOP",sicopclasificador:"ClasificadorSICOP",sicopidentificador:"IdentificadorSICOP",medicamento:"Medicamento",descripcionsicop:"Medicamento",descripcion:"Medicamento",lote:"Lote",batch:"Lote",vencimiento:"Vencimiento",expirydate:"Vencimiento",stock:"Stock",stockminimo:"StockMinimo",minstock:"StockMinimo",unidad:"Unidad",unit:"Unidad",producto:"Medicamento",item:"Medicamento",cantidad:"Cantidad",consumo:"Cantidad",salida:"Cantidad",responsable:"Responsable",usuario:"Responsable",user:"Responsable",motivo:"Motivo",destino:"Motivo",observacion:"Motivo",fecha:"Fecha",fechahora:"Fecha",date:"Fecha"};return e.map(r=>t[NE(r)]||String(r||"").trim())}function ld(e){if(e instanceof Date&&!Number.isNaN(e.getTime()))return e.toISOString().slice(0,10);const t=String(e??"").trim();if(!t)return new Date().toISOString().slice(0,10);const r=t.slice(0,10);if(/^\d{4}-\d{2}-\d{2}$/.test(r))return r;const n=new Date(t);return Number.isNaN(n.getTime())?new Date().toISOString().slice(0,10):n.toISOString().slice(0,10)}function Gl(e,t){const r=String(e??"");return r.includes('"')||r.includes(`
`)||r.includes("\r")||r.includes(t)?`"${r.replace(/"/g,'""')}"`:r}function RE(){const t=["CodigoSIGES","ClasificadorSICOP","IdentificadorSICOP","Medicamento","Categoria","Lote","Vencimiento","Stock","StockMinimo","Unidad"],r=["SIG-0001","SICOP-CL-01","SICOP-ID-0001","Paracetamol","Analgsico","LOT-2025-01","2027-12-31",100,20,"Tabletas"],i=`\uFEFF${[t.map(h=>Gl(h,";")).join(";"),r.map(h=>Gl(h,";")).join(";")].join(`
`)}
`,l=new Blob([i],{type:"text/csv;charset=utf-8"}),o=URL.createObjectURL(l),u=document.createElement("a");u.href=o,u.download="plantilla_catalogo.csv",document.body.appendChild(u),u.click(),u.remove(),URL.revokeObjectURL(o)}function DE(){const t=["CodigoSIGES","Medicamento","Consumo","Costo"],r=["110-16-0010","Paracetamol",1555.85,148621015e-2],i=`\uFEFF${[t.map(h=>Gl(h,";")).join(";"),r.map(h=>Gl(h,";")).join(";")].join(`
`)}
`,l=new Blob([i],{type:"text/csv;charset=utf-8"}),o=URL.createObjectURL(l),u=document.createElement("a");u.href=o,u.download="plantilla_consumo_mensual.csv",document.body.appendChild(u),u.click(),u.remove(),URL.revokeObjectURL(o)}function Wp(e){const{rows:t}=Iy(e);if(t.length===0)return[];const r=t[0],n=OE(r);return t.slice(1).map(l=>{const o={};for(let u=0;u<n.length;u+=1){const h=n[u];h&&(o[h]=l[u]??"")}return o})}function FE(e){const t=String(e||"772").trim()||"772",r=";",n=["CodigoSIGES","ClasificadorSICOP","IdentificadorSICOP","Medicamento","Categoria","Lote","Vencimiento","Stock","StockMinimo","Unidad"],i=["SIG-0001","SICOP-CL-01","SICOP-ID-0001","Paracetamol","General","LOT-2025-01","2027-12-31",100,20,"Tabletas"],o=`\uFEFF${[n.map(g=>Gl(g,r)).join(r),i.map(g=>Gl(g,r)).join(r)].join(`
`)}
`,u=new Blob([o],{type:"text/csv;charset=utf-8"}),h=URL.createObjectURL(u),d=document.createElement("a");d.href=h,d.download=`plantilla_inventario_${t}.csv`,document.body.appendChild(d),d.click(),d.remove(),URL.revokeObjectURL(h)}function ME(e){const t=String(e||"771").trim()||"771",r=`<?xml version="1.0" encoding="UTF-8"?>
<Inventario tipo="${t}">
  <Item>
    <CodigoSIGES>110-16-0010</CodigoSIGES>
    <Medicamento>Paracetamol</Medicamento>
    <Lote>LOT-2025-01</Lote>
    <Vencimiento>2027-12-31</Vencimiento>
    <Inventario>100</Inventario>
  </Item>
</Inventario>
`,n=new Blob([r],{type:"application/xml;charset=utf-8"}),i=URL.createObjectURL(n),l=document.createElement("a");l.href=i,l.download=`plantilla_inventario_${t}.xml`,document.body.appendChild(l),l.click(),l.remove(),URL.revokeObjectURL(i)}function Iu(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function LE(e,t,r,n){function i(l){return l instanceof r?l:new r(function(o){o(l)})}return new(r||(r=Promise))(function(l,o){function u(g){try{d(n.next(g))}catch(p){o(p)}}function h(g){try{d(n.throw(g))}catch(p){o(p)}}function d(g){g.done?l(g.value):i(g.value).then(u,h)}d((n=n.apply(e,t||[])).next())})}const BE=e=>e?(...t)=>e(...t):(...t)=>fetch(...t);class am extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class IE extends am{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class Kp extends am{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class Yp extends am{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Dd;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(Dd||(Dd={}));class UE{constructor(t,{headers:r={},customFetch:n,region:i=Dd.Any}={}){this.url=t,this.headers=r,this.region=i,this.fetch=BE(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return LE(this,arguments,void 0,function*(r,n={}){var i;let l,o;try{const{headers:u,method:h,body:d,signal:g,timeout:p}=n;let v={},{region:_}=n;_||(_=this.region);const w=new URL(`${this.url}/${r}`);_&&_!=="any"&&(v["x-region"]=_,w.searchParams.set("forceFunctionRegion",_));let y;d&&(u&&!Object.prototype.hasOwnProperty.call(u,"Content-Type")||!u)?typeof Blob<"u"&&d instanceof Blob||d instanceof ArrayBuffer?(v["Content-Type"]="application/octet-stream",y=d):typeof d=="string"?(v["Content-Type"]="text/plain",y=d):typeof FormData<"u"&&d instanceof FormData?y=d:(v["Content-Type"]="application/json",y=JSON.stringify(d)):y=d;let S=g;p&&(o=new AbortController,l=setTimeout(()=>o.abort(),p),g?(S=o.signal,g.addEventListener("abort",()=>o.abort())):S=o.signal);const k=yield this.fetch(w.toString(),{method:h||"POST",headers:Object.assign(Object.assign(Object.assign({},v),this.headers),u),body:y,signal:S}).catch(X=>{throw new IE(X)}),R=k.headers.get("x-relay-error");if(R&&R==="true")throw new Kp(k);if(!k.ok)throw new Yp(k);let T=((i=k.headers.get("Content-Type"))!==null&&i!==void 0?i:"text/plain").split(";")[0].trim(),B;return T==="application/json"?B=yield k.json():T==="application/octet-stream"||T==="application/pdf"?B=yield k.blob():T==="text/event-stream"?B=k:T==="multipart/form-data"?B=yield k.formData():B=yield k.text(),{data:B,error:null,response:k}}catch(u){return{data:null,error:u,response:u instanceof Yp||u instanceof Kp?u.context:void 0}}finally{l&&clearTimeout(l)}})}}var jE=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}},PE=class{constructor(e){var t,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(t=e.shouldThrowOnError)!==null&&t!==void 0?t:!1,this.signal=e.signal,this.isMaybeSingle=(r=e.isMaybeSingle)!==null&&r!==void 0?r:!1,e.fetch?this.fetch=e.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){var r=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let i=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async l=>{let o=null,u=null,h=null,d=l.status,g=l.statusText;if(l.ok){var p,v;if(r.method!=="HEAD"){var _;const k=await l.text();k===""||(r.headers.get("Accept")==="text/csv"||r.headers.get("Accept")&&(!((_=r.headers.get("Accept"))===null||_===void 0)&&_.includes("application/vnd.pgrst.plan+text"))?u=k:u=JSON.parse(k))}const y=(p=r.headers.get("Prefer"))===null||p===void 0?void 0:p.match(/count=(exact|planned|estimated)/),S=(v=l.headers.get("content-range"))===null||v===void 0?void 0:v.split("/");y&&S&&S.length>1&&(h=parseInt(S[1])),r.isMaybeSingle&&r.method==="GET"&&Array.isArray(u)&&(u.length>1?(o={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,h=null,d=406,g="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{var w;const y=await l.text();try{o=JSON.parse(y),Array.isArray(o)&&l.status===404&&(u=[],o=null,d=200,g="OK")}catch{l.status===404&&y===""?(d=204,g="No Content"):o={message:y}}if(o&&r.isMaybeSingle&&(!(o==null||(w=o.details)===null||w===void 0)&&w.includes("0 rows"))&&(o=null,d=200,g="OK"),o&&r.shouldThrowOnError)throw new jE(o)}return{error:o,data:u,count:h,status:d,statusText:g}});return this.shouldThrowOnError||(i=i.catch(l=>{var o;let u="";const h=l?.cause;if(h){var d,g,p,v;const w=(d=h?.message)!==null&&d!==void 0?d:"",y=(g=h?.code)!==null&&g!==void 0?g:"";u=`${(p=l?.name)!==null&&p!==void 0?p:"FetchError"}: ${l?.message}`,u+=`

Caused by: ${(v=h?.name)!==null&&v!==void 0?v:"Error"}: ${w}`,y&&(u+=` (${y})`),h?.stack&&(u+=`
${h.stack}`)}else{var _;u=(_=l?.stack)!==null&&_!==void 0?_:""}return{error:{message:`${(o=l?.name)!==null&&o!==void 0?o:"FetchError"}: ${l?.message}`,details:u,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),i.then(e,t)}returns(){return this}overrideTypes(){return this}},zE=class extends PE{select(e){let t=!1;const r=(e??"*").split("").map(n=>/\s/.test(n)&&!t?"":(n==='"'&&(t=!t),n)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:n,referencedTable:i=n}={}){const l=i?`${i}.order`:"order",o=this.url.searchParams.get(l);return this.url.searchParams.set(l,`${o?`${o},`:""}${e}.${t?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const n=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(n,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:n=r}={}){const i=typeof n>"u"?"offset":`${n}.offset`,l=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(l,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:n=!1,wal:i=!1,format:l="text"}={}){var o;const u=[e?"analyze":null,t?"verbose":null,r?"settings":null,n?"buffers":null,i?"wal":null].filter(Boolean).join("|"),h=(o=this.headers.get("Accept"))!==null&&o!==void 0?o:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${l}; for="${h}"; options=${u};`),l==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};const Jp=new RegExp("[,()]");var Ml=class extends zE{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}regexMatch(e,t){return this.url.searchParams.append(e,`match.${t}`),this}regexIMatch(e,t){return this.url.searchParams.append(e,`imatch.${t}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}isDistinct(e,t){return this.url.searchParams.append(e,`isdistinct.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map(n=>typeof n=="string"&&Jp.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}notIn(e,t){const r=Array.from(new Set(t)).map(n=>typeof n=="string"&&Jp.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`not.in.(${r})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:n}={}){let i="";n==="plain"?i="pl":n==="phrase"?i="ph":n==="websearch"&&(i="w");const l=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${i}fts${l}.${t}`),this}match(e){return Object.entries(e).forEach(([t,r])=>{this.url.searchParams.append(t,`eq.${r}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const n=r?`${r}.or`:"or";return this.url.searchParams.append(n,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}},HE=class{constructor(e,{headers:t={},schema:r,fetch:n}){this.url=e,this.headers=new Headers(t),this.schema=r,this.fetch=n}select(e,t){const{head:r=!1,count:n}=t??{},i=r?"HEAD":"GET";let l=!1;const o=(e??"*").split("").map(u=>/\s/.test(u)&&!l?"":(u==='"'&&(l=!l),u)).join("");return this.url.searchParams.set("select",o),n&&this.headers.append("Prefer",`count=${n}`),new Ml({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(e,{count:t,defaultToNull:r=!0}={}){var n;const i="POST";if(t&&this.headers.append("Prefer",`count=${t}`),r||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const l=e.reduce((o,u)=>o.concat(Object.keys(u)),[]);if(l.length>0){const o=[...new Set(l)].map(u=>`"${u}"`);this.url.searchParams.set("columns",o.join(","))}}return new Ml({method:i,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:n,defaultToNull:i=!0}={}){var l;const o="POST";if(this.headers.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),t!==void 0&&this.url.searchParams.set("on_conflict",t),n&&this.headers.append("Prefer",`count=${n}`),i||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const u=e.reduce((h,d)=>h.concat(Object.keys(d)),[]);if(u.length>0){const h=[...new Set(u)].map(d=>`"${d}"`);this.url.searchParams.set("columns",h.join(","))}}return new Ml({method:o,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}update(e,{count:t}={}){var r;const n="PATCH";return t&&this.headers.append("Prefer",`count=${t}`),new Ml({method:n,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:e}={}){var t;const r="DELETE";return e&&this.headers.append("Prefer",`count=${e}`),new Ml({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}},VE=class Uy{constructor(t,{headers:r={},schema:n,fetch:i}={}){this.url=t,this.headers=new Headers(r),this.schemaName=n,this.fetch=i}from(t){if(!t||typeof t!="string"||t.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new HE(new URL(`${this.url}/${t}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new Uy(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:i=!1,count:l}={}){var o;let u;const h=new URL(`${this.url}/rpc/${t}`);let d;n||i?(u=n?"HEAD":"GET",Object.entries(r).filter(([p,v])=>v!==void 0).map(([p,v])=>[p,Array.isArray(v)?`{${v.join(",")}}`:`${v}`]).forEach(([p,v])=>{h.searchParams.append(p,v)})):(u="POST",d=r);const g=new Headers(this.headers);return l&&g.set("Prefer",`count=${l}`),new Ml({method:u,url:h,headers:g,schema:this.schemaName,body:d,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}};class $E{constructor(){}static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const n=r.node,i=parseInt(n.replace(/^v/,"").split(".")[0]);return i>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${i} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${i} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const GE="2.89.0",qE=`realtime-js/${GE}`,jy="1.0.0",XE="2.0.0",Qp=jy,Fd=1e4,WE=1e3,KE=100;var Vi;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(Vi||(Vi={}));var Or;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Or||(Or={}));var _n;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(_n||(_n={}));var Md;(function(e){e.websocket="websocket"})(Md||(Md={}));var _s;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(_s||(_s={}));class YE{constructor(t){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=t??[]}encode(t,r){if(t.event===this.BROADCAST_EVENT&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(t));let n=[t.join_ref,t.ref,t.topic,t.event,t.payload];return r(JSON.stringify(n))}_binaryEncodeUserBroadcastPush(t){var r;return this._isArrayBuffer((r=t.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var r,n;const i=(n=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:new ArrayBuffer(0);return this._encodeUserBroadcastPush(t,this.BINARY_ENCODING,i)}_encodeJsonUserBroadcastPush(t){var r,n;const i=(n=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:{},o=new TextEncoder().encode(JSON.stringify(i)).buffer;return this._encodeUserBroadcastPush(t,this.JSON_ENCODING,o)}_encodeUserBroadcastPush(t,r,n){var i,l;const o=t.topic,u=(i=t.ref)!==null&&i!==void 0?i:"",h=(l=t.join_ref)!==null&&l!==void 0?l:"",d=t.payload.event,g=this.allowedMetadataKeys?this._pick(t.payload,this.allowedMetadataKeys):{},p=Object.keys(g).length===0?"":JSON.stringify(g);if(h.length>255)throw new Error(`joinRef length ${h.length} exceeds maximum of 255`);if(u.length>255)throw new Error(`ref length ${u.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`topic length ${o.length} exceeds maximum of 255`);if(d.length>255)throw new Error(`userEvent length ${d.length} exceeds maximum of 255`);if(p.length>255)throw new Error(`metadata length ${p.length} exceeds maximum of 255`);const v=this.USER_BROADCAST_PUSH_META_LENGTH+h.length+u.length+o.length+d.length+p.length,_=new ArrayBuffer(this.HEADER_LENGTH+v);let w=new DataView(_),y=0;w.setUint8(y++,this.KINDS.userBroadcastPush),w.setUint8(y++,h.length),w.setUint8(y++,u.length),w.setUint8(y++,o.length),w.setUint8(y++,d.length),w.setUint8(y++,p.length),w.setUint8(y++,r),Array.from(h,k=>w.setUint8(y++,k.charCodeAt(0))),Array.from(u,k=>w.setUint8(y++,k.charCodeAt(0))),Array.from(o,k=>w.setUint8(y++,k.charCodeAt(0))),Array.from(d,k=>w.setUint8(y++,k.charCodeAt(0))),Array.from(p,k=>w.setUint8(y++,k.charCodeAt(0)));var S=new Uint8Array(_.byteLength+n.byteLength);return S.set(new Uint8Array(_),0),S.set(new Uint8Array(n),_.byteLength),S.buffer}decode(t,r){if(this._isArrayBuffer(t)){let n=this._binaryDecode(t);return r(n)}if(typeof t=="string"){const n=JSON.parse(t),[i,l,o,u,h]=n;return r({join_ref:i,ref:l,topic:o,event:u,payload:h})}return r({})}_binaryDecode(t){const r=new DataView(t),n=r.getUint8(0),i=new TextDecoder;if(n===this.KINDS.userBroadcast)return this._decodeUserBroadcast(t,r,i)}_decodeUserBroadcast(t,r,n){const i=r.getUint8(1),l=r.getUint8(2),o=r.getUint8(3),u=r.getUint8(4);let h=this.HEADER_LENGTH+4;const d=n.decode(t.slice(h,h+i));h=h+i;const g=n.decode(t.slice(h,h+l));h=h+l;const p=n.decode(t.slice(h,h+o));h=h+o;const v=t.slice(h,t.byteLength),_=u===this.JSON_ENCODING?JSON.parse(n.decode(v)):v,w={type:this.BROADCAST_EVENT,event:g,payload:_};return o>0&&(w.meta=JSON.parse(p)),{join_ref:null,ref:null,topic:d,event:this.BROADCAST_EVENT,payload:w}}_isArrayBuffer(t){var r;return t instanceof ArrayBuffer||((r=t?.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(t,r){return!t||typeof t!="object"?{}:Object.fromEntries(Object.entries(t).filter(([n])=>r.includes(n)))}}class Py{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Wt;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(Wt||(Wt={}));const Zp=(e,t,r={})=>{var n;const i=(n=r.skipTypes)!==null&&n!==void 0?n:[];return t?Object.keys(t).reduce((l,o)=>(l[o]=JE(o,e,t,i),l),{}):{}},JE=(e,t,r,n)=>{const i=t.find(u=>u.name===e),l=i?.type,o=r[e];return l&&!n.includes(l)?zy(l,o):Ld(o)},zy=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return tT(t,r)}switch(e){case Wt.bool:return QE(t);case Wt.float4:case Wt.float8:case Wt.int2:case Wt.int4:case Wt.int8:case Wt.numeric:case Wt.oid:return ZE(t);case Wt.json:case Wt.jsonb:return eT(t);case Wt.timestamp:return rT(t);case Wt.abstime:case Wt.date:case Wt.daterange:case Wt.int4range:case Wt.int8range:case Wt.money:case Wt.reltime:case Wt.text:case Wt.time:case Wt.timestamptz:case Wt.timetz:case Wt.tsrange:case Wt.tstzrange:return Ld(t);default:return Ld(t)}},Ld=e=>e,QE=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},ZE=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},eT=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e},tT=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let l;const o=e.slice(1,r);try{l=JSON.parse("["+o+"]")}catch{l=o?o.split(","):[]}return l.map(u=>zy(t,u))}return e},rT=e=>typeof e=="string"?e.replace(" ","T"):e,Hy=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class cd{constructor(t,r,n={},i=Fd){this.channel=t,this.event=r,this.payload=n,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var ev;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(ev||(ev={}));class Zc{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=r?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},i=>{const{onJoin:l,onLeave:o,onSync:u}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Zc.syncState(this.state,i,l,o),this.pendingDiffs.forEach(h=>{this.state=Zc.syncDiff(this.state,h,l,o)}),this.pendingDiffs=[],u()}),this.channel._on(n.diff,{},i=>{const{onJoin:l,onLeave:o,onSync:u}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=Zc.syncDiff(this.state,i,l,o),u())}),this.onJoin((i,l,o)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:l,newPresences:o})}),this.onLeave((i,l,o)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:l,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,i){const l=this.cloneDeep(t),o=this.transformState(r),u={},h={};return this.map(l,(d,g)=>{o[d]||(h[d]=g)}),this.map(o,(d,g)=>{const p=l[d];if(p){const v=g.map(S=>S.presence_ref),_=p.map(S=>S.presence_ref),w=g.filter(S=>_.indexOf(S.presence_ref)<0),y=p.filter(S=>v.indexOf(S.presence_ref)<0);w.length>0&&(u[d]=w),y.length>0&&(h[d]=y)}else u[d]=g}),this.syncDiff(l,{joins:u,leaves:h},n,i)}static syncDiff(t,r,n,i){const{joins:l,leaves:o}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),i||(i=()=>{}),this.map(l,(u,h)=>{var d;const g=(d=t[u])!==null&&d!==void 0?d:[];if(t[u]=this.cloneDeep(h),g.length>0){const p=t[u].map(_=>_.presence_ref),v=g.filter(_=>p.indexOf(_.presence_ref)<0);t[u].unshift(...v)}n(u,g,h)}),this.map(o,(u,h)=>{let d=t[u];if(!d)return;const g=h.map(p=>p.presence_ref);d=d.filter(p=>g.indexOf(p.presence_ref)<0),t[u]=d,i(u,d,h),d.length===0&&delete t[u]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const i=t[n];return"metas"in i?r[n]=i.metas.map(l=>(l.presence_ref=l.phx_ref,delete l.phx_ref,delete l.phx_ref_prev,l)):r[n]=i,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var tv;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(tv||(tv={}));var eo;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(eo||(eo={}));var ni;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(ni||(ni={}));class Ul{constructor(t,r={config:{}},n){var i,l;if(this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=Or.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new cd(this,_n.join,this.params,this.timeout),this.rejoinTimer=new Py(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Or.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Or.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=Or.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Or.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=Or.errored,this.rejoinTimer.scheduleTimeout())}),this._on(_n.reply,{},(o,u)=>{this._trigger(this._replyEventName(u),o)}),this.presence=new Zc(this),this.broadcastEndpointURL=Hy(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((l=(i=this.params.config)===null||i===void 0?void 0:i.broadcast)===null||l===void 0)&&l.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var n,i,l;if(this.socket.isConnected()||this.socket.connect(),this.state==Or.closed){const{config:{broadcast:o,presence:u,private:h}}=this.params,d=(i=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(_=>_.filter))!==null&&i!==void 0?i:[],g=!!this.bindings[eo.PRESENCE]&&this.bindings[eo.PRESENCE].length>0||((l=this.params.config.presence)===null||l===void 0?void 0:l.enabled)===!0,p={},v={broadcast:o,presence:Object.assign(Object.assign({},u),{enabled:g}),postgres_changes:d,private:h};this.socket.accessTokenValue&&(p.access_token=this.socket.accessTokenValue),this._onError(_=>t?.(ni.CHANNEL_ERROR,_)),this._onClose(()=>t?.(ni.CLOSED)),this.updateJoinPayload(Object.assign({config:v},p)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:_})=>{var w;if(this.socket._isManualToken()||this.socket.setAuth(),_===void 0){t?.(ni.SUBSCRIBED);return}else{const y=this.bindings.postgres_changes,S=(w=y?.length)!==null&&w!==void 0?w:0,k=[];for(let R=0;R<S;R++){const T=y[R],{filter:{event:B,schema:X,table:M,filter:N}}=T,Z=_&&_[R];if(Z&&Z.event===B&&Ul.isFilterValueEqual(Z.schema,X)&&Ul.isFilterValueEqual(Z.table,M)&&Ul.isFilterValueEqual(Z.filter,N))k.push(Object.assign(Object.assign({},T),{id:Z.id}));else{this.unsubscribe(),this.state=Or.errored,t?.(ni.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=k,t&&t(ni.SUBSCRIBED);return}}).receive("error",_=>{this.state=Or.errored,t?.(ni.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(_).join(", ")||"error")))}).receive("timeout",()=>{t?.(ni.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===Or.joined&&t===eo.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(t,r,n)}async httpSend(t,r,n={}){var i;if(r==null)return Promise.reject("Payload is required for httpSend()");const l={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(l.Authorization=`Bearer ${this.socket.accessTokenValue}`);const o={method:"POST",headers:l,body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:r,private:this.private}]})},u=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(i=n.timeout)!==null&&i!==void 0?i:this.timeout);if(u.status===202)return{success:!0};let h=u.statusText;try{const d=await u.json();h=d.error||d.message||h}catch{}return Promise.reject(new Error(h))}async send(t,r={}){var n,i;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:l,payload:o}=t,u={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(u.Authorization=`Bearer ${this.socket.accessTokenValue}`);const h={method:"POST",headers:u,body:JSON.stringify({messages:[{topic:this.subTopic,event:l,payload:o,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,h,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((i=d.body)===null||i===void 0?void 0:i.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(l=>{var o,u,h;const d=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((h=(u=(o=this.params)===null||o===void 0?void 0:o.config)===null||u===void 0?void 0:u.broadcast)===null||h===void 0)&&h.ack)&&l("ok"),d.receive("ok",()=>l("ok")),d.receive("error",()=>l("error")),d.receive("timeout",()=>l("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Or.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(_n.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(i=>{n=new cd(this,_n.leave,{},t),n.receive("ok",()=>{r(),i("ok")}).receive("timeout",()=>{r(),i("timed out")}).receive("error",()=>{i("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n?.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Or.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const i=new AbortController,l=setTimeout(()=>i.abort(),n),o=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:i.signal}));return clearTimeout(l),o}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new cd(this,t,r,n);return this._canPush()?i.send():this._addToPushBuffer(i),i}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>KE){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var i,l;const o=t.toLocaleLowerCase(),{close:u,error:h,leave:d,join:g}=_n;if(n&&[u,h,d,g].indexOf(o)>=0&&n!==this._joinRef())return;let v=this._onMessage(o,r,n);if(r&&!v)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(_=>{var w,y,S;return((w=_.filter)===null||w===void 0?void 0:w.event)==="*"||((S=(y=_.filter)===null||y===void 0?void 0:y.event)===null||S===void 0?void 0:S.toLocaleLowerCase())===o}).map(_=>_.callback(v,n)):(l=this.bindings[o])===null||l===void 0||l.filter(_=>{var w,y,S,k,R,T;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in _){const B=_.id,X=(w=_.filter)===null||w===void 0?void 0:w.event;return B&&((y=r.ids)===null||y===void 0?void 0:y.includes(B))&&(X==="*"||X?.toLocaleLowerCase()===((S=r.data)===null||S===void 0?void 0:S.type.toLocaleLowerCase()))}else{const B=(R=(k=_?.filter)===null||k===void 0?void 0:k.event)===null||R===void 0?void 0:R.toLocaleLowerCase();return B==="*"||B===((T=r?.event)===null||T===void 0?void 0:T.toLocaleLowerCase())}else return _.type.toLocaleLowerCase()===o}).map(_=>{if(typeof v=="object"&&"ids"in v){const w=v.data,{schema:y,table:S,commit_timestamp:k,type:R,errors:T}=w;v=Object.assign(Object.assign({},{schema:y,table:S,commit_timestamp:k,eventType:R,new:{},old:{},errors:T}),this._getPayloadRecords(w))}_.callback(v,n)})}_isClosed(){return this.state===Or.closed}_isJoined(){return this.state===Or.joined}_isJoining(){return this.state===Or.joining}_isLeaving(){return this.state===Or.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const i=t.toLocaleLowerCase(),l={type:i,filter:r,callback:n};return this.bindings[i]?this.bindings[i].push(l):this.bindings[i]=[l],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(i=>{var l;return!(((l=i.type)===null||l===void 0?void 0:l.toLocaleLowerCase())===n&&Ul.isEqual(i.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}static isFilterValueEqual(t,r){return(t??void 0)===(r??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(_n.close,{},t)}_onError(t){this._on(_n.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Or.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=Zp(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=Zp(t.columns,t.old_record)),r}}const od=()=>{},Q0={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},aT=[1e3,2e3,5e3,1e4],nT=1e4,iT=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class sT{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Fd,this.transport=null,this.heartbeatIntervalMs=Q0.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=od,this.ref=0,this.reconnectTimer=null,this.vsn=Qp,this.logger=od,this.conn=null,this.sendBuffer=[],this.serializer=new YE,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=i=>i?(...l)=>i(...l):(...l)=>fetch(...l),!(!((n=r?.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${Md.websocket}`,this.httpEndpoint=Hy(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=$E.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Vi.connecting:return _s.Connecting;case Vi.open:return _s.Open;case Vi.closing:return _s.Closing;default:return _s.Closed}}isConnected(){return this.connectionState()===_s.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,i=this.getChannels().find(l=>l.topic===n);if(i)return i;{const l=new Ul(`realtime:${t}`,r,this);return this.channels.push(l),l}}push(t){const{topic:r,event:n,payload:i,ref:l}=t,o=()=>{this.encode(t,u=>{var h;(h=this.conn)===null||h===void 0||h.send(u)})};this.log("push",`${r} ${n} (${l})`,i),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(WE,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},Q0.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(d){this.log("error","error in heartbeat callback",d)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:i,payload:l,ref:o}=r,u=o?`(${o})`:"",h=l.status||"";this.log("receive",`${h} ${n} ${i} ${u}`.trim(),l),this.channels.filter(d=>d._isMember(n)).forEach(d=>d._trigger(i,l,o)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t),this.conn.readyState===Vi.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===Vi.open||this.conn.readyState===Vi.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this._terminateWorker()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(_n.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",i=new URLSearchParams(r);return`${t}${n}${i}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([iT],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r,n=!1;if(t)r=t,n=!0;else if(this.accessToken)try{r=await this.accessToken()}catch(i){this.log("error","Error fetching access token from callback",i),r=this.accessTokenValue}else r=this.accessTokenValue;n?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(i=>{const l={access_token:r,version:qE};r&&i.updateJoinPayload(l),i.joinedOnce&&i._isJoined()&&i._push(_n.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this._isManualToken()||this.setAuth().catch(r=>{this.log("error",`Error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(i){this.log("error",`error in ${t} callback`,i)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new Py(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Q0.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,i,l,o,u,h,d,g,p,v,_;switch(this.transport=(r=t?.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t?.timeout)!==null&&n!==void 0?n:Fd,this.heartbeatIntervalMs=(i=t?.heartbeatIntervalMs)!==null&&i!==void 0?i:Q0.HEARTBEAT_INTERVAL,this.worker=(l=t?.worker)!==null&&l!==void 0?l:!1,this.accessToken=(o=t?.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(u=t?.heartbeatCallback)!==null&&u!==void 0?u:od,this.vsn=(h=t?.vsn)!==null&&h!==void 0?h:Qp,t?.params&&(this.params=t.params),t?.logger&&(this.logger=t.logger),(t?.logLevel||t?.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(d=t?.reconnectAfterMs)!==null&&d!==void 0?d:(w=>aT[w-1]||nT),this.vsn){case jy:this.encode=(g=t?.encode)!==null&&g!==void 0?g:((w,y)=>y(JSON.stringify(w))),this.decode=(p=t?.decode)!==null&&p!==void 0?p:((w,y)=>y(JSON.parse(w)));break;case XE:this.encode=(v=t?.encode)!==null&&v!==void 0?v:this.serializer.encode.bind(this.serializer),this.decode=(_=t?.decode)!==null&&_!==void 0?_:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t?.workerUrl}}}var uo=class extends Error{constructor(e,t){super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown=t.icebergType==="CommitStateUnknownException"||[500,502,504].includes(t.status)&&t.icebergType?.includes("CommitState")===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function lT(e,t,r){const n=new URL(t,e);if(r)for(const[i,l]of Object.entries(r))l!==void 0&&n.searchParams.set(i,l);return n.toString()}async function cT(e){return!e||e.type==="none"?{}:e.type==="bearer"?{Authorization:`Bearer ${e.token}`}:e.type==="header"?{[e.name]:e.value}:e.type==="custom"?await e.getHeaders():{}}function oT(e){const t=e.fetchImpl??globalThis.fetch;return{async request({method:r,path:n,query:i,body:l,headers:o}){const u=lT(e.baseUrl,n,i),h=await cT(e.auth),d=await t(u,{method:r,headers:{...l?{"Content-Type":"application/json"}:{},...h,...o},body:l?JSON.stringify(l):void 0}),g=await d.text(),p=(d.headers.get("content-type")||"").includes("application/json"),v=p&&g?JSON.parse(g):g;if(!d.ok){const _=p?v:void 0,w=_?.error;throw new uo(w?.message??`Request failed with status ${d.status}`,{status:d.status,icebergType:w?.type,icebergCode:w?.code,details:_})}return{status:d.status,headers:d.headers,data:v}}}}function Z0(e){return e.join("")}var uT=class{constructor(e,t=""){this.client=e,this.prefix=t}async listNamespaces(e){const t=e?{parent:Z0(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(n=>({namespace:n}))}async createNamespace(e,t){const r={namespace:e.namespace,properties:t?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Z0(e.namespace)}`})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Z0(e.namespace)}`})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Z0(e.namespace)}`}),!0}catch(t){if(t instanceof uo&&t.status===404)return!1;throw t}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(r){if(r instanceof uo&&r.status===409)return;throw r}}};function Tl(e){return e.join("")}var fT=class{constructor(e,t="",r){this.client=e,this.prefix=t,this.accessDelegation=r}async listTables(e){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Tl(e.namespace)}/tables`})).data.identifiers}async createTable(e,t){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Tl(e.namespace)}/tables`,body:t,headers:r})).data.metadata}async updateTable(e,t){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Tl(e.namespace)}/tables/${e.name}`,body:t});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(e,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Tl(e.namespace)}/tables/${e.name}`,query:{purgeRequested:String(t?.purge??!1)}})}async loadTable(e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Tl(e.namespace)}/tables/${e.name}`,headers:t})).data.metadata}async tableExists(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Tl(e.namespace)}/tables/${e.name}`,headers:t}),!0}catch(r){if(r instanceof uo&&r.status===404)return!1;throw r}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(r){if(r instanceof uo&&r.status===409)return await this.loadTable({namespace:e.namespace,name:t.name});throw r}}},hT=class{constructor(e){let t="v1";e.catalogName&&(t+=`/${e.catalogName}`);const r=e.baseUrl.endsWith("/")?e.baseUrl:`${e.baseUrl}/`;this.client=oT({baseUrl:r,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=e.accessDelegation?.join(","),this.namespaceOps=new uT(this.client,t),this.tableOps=new fT(this.client,t,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}},Uu=class extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}};function nr(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}var dT=class extends Uu{constructor(e,t,r){super(e),this.name="StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Bd=class extends Uu{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}};const nm=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),mT=()=>Response,Id=e=>{if(Array.isArray(e))return e.map(r=>Id(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const i=r.replace(/([-_][a-z])/gi,l=>l.toUpperCase().replace(/[-_]/g,""));t[i]=Id(n)}),t},gT=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},xT=e=>!e||typeof e!="string"||e.length===0||e.length>100||e.trim()!==e||e.includes("/")||e.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(e);function fo(e){"@babel/helpers - typeof";return fo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fo(e)}function pT(e,t){if(fo(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(fo(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vT(e){var t=pT(e,"string");return fo(t)=="symbol"?t:t+""}function yT(e,t,r){return(t=vT(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rv(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function nt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rv(Object(r),!0).forEach(function(n){yT(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rv(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}const ud=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},_T=async(e,t,r)=>{e instanceof await mT()&&!r?.noResolveJson?e.json().then(n=>{const i=e.status||500,l=n?.statusCode||i+"";t(new dT(ud(n),i,l))}).catch(n=>{t(new Bd(ud(n),n))}):t(new Bd(ud(e),e))},wT=(e,t,r,n)=>{const i={method:e,headers:t?.headers||{}};return e==="GET"||!n?i:(gT(n)?(i.headers=nt({"Content-Type":"application/json"},t?.headers),i.body=JSON.stringify(n)):i.body=n,t?.duplex&&(i.duplex=t.duplex),nt(nt({},i),r))};async function Ro(e,t,r,n,i,l){return new Promise((o,u)=>{e(r,wT(t,n,i,l)).then(h=>{if(!h.ok)throw h;return n?.noResolveJson?h:h.json()}).then(h=>o(h)).catch(h=>_T(h,u,n))})}async function ho(e,t,r,n){return Ro(e,"GET",t,r,n)}async function yn(e,t,r,n,i){return Ro(e,"POST",t,n,i,r)}async function Ud(e,t,r,n,i){return Ro(e,"PUT",t,n,i,r)}async function bT(e,t,r,n){return Ro(e,"HEAD",t,nt(nt({},r),{},{noResolveJson:!0}),n)}async function im(e,t,r,n,i){return Ro(e,"DELETE",t,n,i,r)}var ST=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}async execute(){var e=this;try{return{data:(await e.downloadFn()).body,error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(nr(t))return{data:null,error:t};throw t}}};let Vy;Vy=Symbol.toStringTag;var ET=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[Vy]="BlobDownloadBuilder",this.promise=null}asStream(){return new ST(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var e=this;try{return{data:await(await e.downloadFn()).blob(),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(nr(t))return{data:null,error:t};throw t}}};const TT={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},av={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var kT=class{constructor(e,t={},r,n){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=r,this.fetch=nm(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(e,t,r,n){var i=this;try{let l;const o=nt(nt({},av),n);let u=nt(nt({},i.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const h=o.metadata;typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",o.cacheControl),h&&l.append("metadata",i.encodeMetadata(h)),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.has("cacheControl")||l.append("cacheControl",o.cacheControl),h&&!l.has("metadata")&&l.append("metadata",i.encodeMetadata(h))):(l=r,u["cache-control"]=`max-age=${o.cacheControl}`,u["content-type"]=o.contentType,h&&(u["x-metadata"]=i.toBase64(i.encodeMetadata(h))),(typeof ReadableStream<"u"&&l instanceof ReadableStream||l&&typeof l=="object"&&"pipe"in l&&typeof l.pipe=="function")&&!o.duplex&&(o.duplex="half")),n?.headers&&(u=nt(nt({},u),n.headers));const d=i._removeEmptyFolders(t),g=i._getFinalPath(d),p=await(e=="PUT"?Ud:yn)(i.fetch,`${i.url}/object/${g}`,l,nt({headers:u},o?.duplex?{duplex:o.duplex}:{}));return{data:{path:d,id:p.Id,fullPath:p.Key},error:null}}catch(l){if(i.shouldThrowOnError)throw l;if(nr(l))return{data:null,error:l};throw l}}async upload(e,t,r){return this.uploadOrUpdate("POST",e,t,r)}async uploadToSignedUrl(e,t,r,n){var i=this;const l=i._removeEmptyFolders(e),o=i._getFinalPath(l),u=new URL(i.url+`/object/upload/sign/${o}`);u.searchParams.set("token",t);try{let h;const d=nt({upsert:av.upsert},n),g=nt(nt({},i.headers),{"x-upsert":String(d.upsert)});return typeof Blob<"u"&&r instanceof Blob?(h=new FormData,h.append("cacheControl",d.cacheControl),h.append("",r)):typeof FormData<"u"&&r instanceof FormData?(h=r,h.append("cacheControl",d.cacheControl)):(h=r,g["cache-control"]=`max-age=${d.cacheControl}`,g["content-type"]=d.contentType),{data:{path:l,fullPath:(await Ud(i.fetch,u.toString(),h,{headers:g})).Key},error:null}}catch(h){if(i.shouldThrowOnError)throw h;if(nr(h))return{data:null,error:h};throw h}}async createSignedUploadUrl(e,t){var r=this;try{let n=r._getFinalPath(e);const i=nt({},r.headers);t?.upsert&&(i["x-upsert"]="true");const l=await yn(r.fetch,`${r.url}/object/upload/sign/${n}`,{},{headers:i}),o=new URL(r.url+l.url),u=o.searchParams.get("token");if(!u)throw new Uu("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:u},error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(nr(n))return{data:null,error:n};throw n}}async update(e,t,r){return this.uploadOrUpdate("PUT",e,t,r)}async move(e,t,r){var n=this;try{return{data:await yn(n.fetch,`${n.url}/object/move`,{bucketId:n.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r?.destinationBucket},{headers:n.headers}),error:null}}catch(i){if(n.shouldThrowOnError)throw i;if(nr(i))return{data:null,error:i};throw i}}async copy(e,t,r){var n=this;try{return{data:{path:(await yn(n.fetch,`${n.url}/object/copy`,{bucketId:n.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r?.destinationBucket},{headers:n.headers})).Key},error:null}}catch(i){if(n.shouldThrowOnError)throw i;if(nr(i))return{data:null,error:i};throw i}}async createSignedUrl(e,t,r){var n=this;try{let i=n._getFinalPath(e),l=await yn(n.fetch,`${n.url}/object/sign/${i}`,nt({expiresIn:t},r?.transform?{transform:r.transform}:{}),{headers:n.headers});const o=r?.download?`&download=${r.download===!0?"":r.download}`:"";return l={signedUrl:encodeURI(`${n.url}${l.signedURL}${o}`)},{data:l,error:null}}catch(i){if(n.shouldThrowOnError)throw i;if(nr(i))return{data:null,error:i};throw i}}async createSignedUrls(e,t,r){var n=this;try{const i=await yn(n.fetch,`${n.url}/object/sign/${n.bucketId}`,{expiresIn:t,paths:e},{headers:n.headers}),l=r?.download?`&download=${r.download===!0?"":r.download}`:"";return{data:i.map(o=>nt(nt({},o),{},{signedUrl:o.signedURL?encodeURI(`${n.url}${o.signedURL}${l}`):null})),error:null}}catch(i){if(n.shouldThrowOnError)throw i;if(nr(i))return{data:null,error:i};throw i}}download(e,t){const r=typeof t?.transform<"u"?"render/image/authenticated":"object",n=this.transformOptsToQueryString(t?.transform||{}),i=n?`?${n}`:"",l=this._getFinalPath(e),o=()=>ho(this.fetch,`${this.url}/${r}/${l}${i}`,{headers:this.headers,noResolveJson:!0});return new ET(o,this.shouldThrowOnError)}async info(e){var t=this;const r=t._getFinalPath(e);try{return{data:Id(await ho(t.fetch,`${t.url}/object/info/${r}`,{headers:t.headers})),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(nr(n))return{data:null,error:n};throw n}}async exists(e){var t=this;const r=t._getFinalPath(e);try{return await bT(t.fetch,`${t.url}/object/${r}`,{headers:t.headers}),{data:!0,error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(nr(n)&&n instanceof Bd){const i=n.originalError;if([400,404].includes(i?.status))return{data:!1,error:n}}throw n}}getPublicUrl(e,t){const r=this._getFinalPath(e),n=[],i=t?.download?`download=${t.download===!0?"":t.download}`:"";i!==""&&n.push(i);const l=typeof t?.transform<"u"?"render/image":"object",o=this.transformOptsToQueryString(t?.transform||{});o!==""&&n.push(o);let u=n.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${r}${u}`)}}}async remove(e){var t=this;try{return{data:await im(t.fetch,`${t.url}/object/${t.bucketId}`,{prefixes:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(nr(r))return{data:null,error:r};throw r}}async list(e,t,r){var n=this;try{const i=nt(nt(nt({},TT),t),{},{prefix:e||""});return{data:await yn(n.fetch,`${n.url}/object/list/${n.bucketId}`,i,{headers:n.headers},r),error:null}}catch(i){if(n.shouldThrowOnError)throw i;if(nr(i))return{data:null,error:i};throw i}}async listV2(e,t){var r=this;try{const n=nt({},e);return{data:await yn(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,n,{headers:r.headers},t),error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(nr(n))return{data:null,error:n};throw n}}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}};const $y="2.89.0",Gy={"X-Client-Info":`storage-js/${$y}`};var AT=class{constructor(e,t={},r,n){this.shouldThrowOnError=!1;const i=new URL(e);n?.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase.")),this.url=i.href.replace(/\/$/,""),this.headers=nt(nt({},Gy),t),this.fetch=nm(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(e){var t=this;try{const r=t.listBucketOptionsToQueryString(e);return{data:await ho(t.fetch,`${t.url}/bucket${r}`,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(nr(r))return{data:null,error:r};throw r}}async getBucket(e){var t=this;try{return{data:await ho(t.fetch,`${t.url}/bucket/${e}`,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(nr(r))return{data:null,error:r};throw r}}async createBucket(e,t={public:!1}){var r=this;try{return{data:await yn(r.fetch,`${r.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}),error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(nr(n))return{data:null,error:n};throw n}}async updateBucket(e,t){var r=this;try{return{data:await Ud(r.fetch,`${r.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}),error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(nr(n))return{data:null,error:n};throw n}}async emptyBucket(e){var t=this;try{return{data:await yn(t.fetch,`${t.url}/bucket/${e}/empty`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(nr(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await im(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(nr(r))return{data:null,error:r};throw r}}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}},CT=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=nt(nt({},Gy),t),this.fetch=nm(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var t=this;try{return{data:await yn(t.fetch,`${t.url}/bucket`,{name:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(nr(r))return{data:null,error:r};throw r}}async listBuckets(e){var t=this;try{const r=new URLSearchParams;e?.limit!==void 0&&r.set("limit",e.limit.toString()),e?.offset!==void 0&&r.set("offset",e.offset.toString()),e?.sortColumn&&r.set("sortColumn",e.sortColumn),e?.sortOrder&&r.set("sortOrder",e.sortOrder),e?.search&&r.set("search",e.search);const n=r.toString(),i=n?`${t.url}/bucket?${n}`:`${t.url}/bucket`;return{data:await ho(t.fetch,i,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(nr(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await im(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(nr(r))return{data:null,error:r};throw r}}from(e){var t=this;if(!xT(e))throw new Uu("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new hT({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:async()=>t.headers},fetch:this.fetch}),n=this.shouldThrowOnError;return new Proxy(r,{get(i,l){const o=i[l];return typeof o!="function"?o:async(...u)=>{try{return{data:await o.apply(i,u),error:null}}catch(h){if(n)throw h;return{data:null,error:h}}}}})}};const sm={"X-Client-Info":`storage-js/${$y}`,"Content-Type":"application/json"};var qy=class extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function Pa(e){return typeof e=="object"&&e!==null&&"__isStorageVectorsError"in e}var fd=class extends qy{constructor(e,t,r){super(e),this.name="StorageVectorsApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},NT=class extends qy{constructor(e,t){super(e),this.name="StorageVectorsUnknownError",this.originalError=t}};const lm=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),OT=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},nv=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),RT=async(e,t,r)=>{if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!r?.noResolveJson){const n=e.status||500,i=e;if(typeof i.json=="function")i.json().then(l=>{const o=l?.statusCode||l?.code||n+"";t(new fd(nv(l),n,o))}).catch(()=>{const l=n+"";t(new fd(i.statusText||`HTTP ${n} error`,n,l))});else{const l=n+"";t(new fd(i.statusText||`HTTP ${n} error`,n,l))}}else t(new NT(nv(e),e))},DT=(e,t,r,n)=>{const i={method:e,headers:t?.headers||{}};return n?(OT(n)?(i.headers=nt({"Content-Type":"application/json"},t?.headers),i.body=JSON.stringify(n)):i.body=n,nt(nt({},i),r)):i};async function FT(e,t,r,n,i,l){return new Promise((o,u)=>{e(r,DT(t,n,i,l)).then(h=>{if(!h.ok)throw h;if(n?.noResolveJson)return h;const d=h.headers.get("content-type");return!d||!d.includes("application/json")?{}:h.json()}).then(h=>o(h)).catch(h=>RT(h,u,n))})}async function za(e,t,r,n,i){return FT(e,"POST",t,n,i,r)}var MT=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=nt(nt({},sm),t),this.fetch=lm(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(e){var t=this;try{return{data:await za(t.fetch,`${t.url}/CreateIndex`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Pa(r))return{data:null,error:r};throw r}}async getIndex(e,t){var r=this;try{return{data:await za(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers}),error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(Pa(n))return{data:null,error:n};throw n}}async listIndexes(e){var t=this;try{return{data:await za(t.fetch,`${t.url}/ListIndexes`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Pa(r))return{data:null,error:r};throw r}}async deleteIndex(e,t){var r=this;try{return{data:await za(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers})||{},error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(Pa(n))return{data:null,error:n};throw n}}},LT=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=nt(nt({},sm),t),this.fetch=lm(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(e){var t=this;try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await za(t.fetch,`${t.url}/PutVectors`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Pa(r))return{data:null,error:r};throw r}}async getVectors(e){var t=this;try{return{data:await za(t.fetch,`${t.url}/GetVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Pa(r))return{data:null,error:r};throw r}}async listVectors(e){var t=this;try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:await za(t.fetch,`${t.url}/ListVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Pa(r))return{data:null,error:r};throw r}}async queryVectors(e){var t=this;try{return{data:await za(t.fetch,`${t.url}/QueryVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Pa(r))return{data:null,error:r};throw r}}async deleteVectors(e){var t=this;try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await za(t.fetch,`${t.url}/DeleteVectors`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Pa(r))return{data:null,error:r};throw r}}},BT=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=nt(nt({},sm),t),this.fetch=lm(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var t=this;try{return{data:await za(t.fetch,`${t.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Pa(r))return{data:null,error:r};throw r}}async getBucket(e){var t=this;try{return{data:await za(t.fetch,`${t.url}/GetVectorBucket`,{vectorBucketName:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Pa(r))return{data:null,error:r};throw r}}async listBuckets(e={}){var t=this;try{return{data:await za(t.fetch,`${t.url}/ListVectorBuckets`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Pa(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await za(t.fetch,`${t.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Pa(r))return{data:null,error:r};throw r}}},IT=class extends BT{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new UT(this.url,this.headers,e,this.fetch)}async createBucket(e){var t=()=>super.createBucket,r=this;return t().call(r,e)}async getBucket(e){var t=()=>super.getBucket,r=this;return t().call(r,e)}async listBuckets(e={}){var t=()=>super.listBuckets,r=this;return t().call(r,e)}async deleteBucket(e){var t=()=>super.deleteBucket,r=this;return t().call(r,e)}},UT=class extends MT{constructor(e,t,r,n){super(e,t,n),this.vectorBucketName=r}async createIndex(e){var t=()=>super.createIndex,r=this;return t().call(r,nt(nt({},e),{},{vectorBucketName:r.vectorBucketName}))}async listIndexes(e={}){var t=()=>super.listIndexes,r=this;return t().call(r,nt(nt({},e),{},{vectorBucketName:r.vectorBucketName}))}async getIndex(e){var t=()=>super.getIndex,r=this;return t().call(r,r.vectorBucketName,e)}async deleteIndex(e){var t=()=>super.deleteIndex,r=this;return t().call(r,r.vectorBucketName,e)}index(e){return new jT(this.url,this.headers,this.vectorBucketName,e,this.fetch)}},jT=class extends LT{constructor(e,t,r,n,i){super(e,t,i),this.vectorBucketName=r,this.indexName=n}async putVectors(e){var t=()=>super.putVectors,r=this;return t().call(r,nt(nt({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async getVectors(e){var t=()=>super.getVectors,r=this;return t().call(r,nt(nt({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async listVectors(e={}){var t=()=>super.listVectors,r=this;return t().call(r,nt(nt({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async queryVectors(e){var t=()=>super.queryVectors,r=this;return t().call(r,nt(nt({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async deleteVectors(e){var t=()=>super.deleteVectors,r=this;return t().call(r,nt(nt({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}},PT=class extends AT{constructor(e,t={},r,n){super(e,t,r,n)}from(e){return new kT(this.url,this.headers,e,this.fetch)}get vectors(){return new IT(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new CT(this.url+"/iceberg",this.headers,this.fetch)}};const Xy="2.89.0",Ll=30*1e3,jd=3,hd=jd*Ll,zT="http://localhost:9999",HT="supabase.auth.token",VT={"X-Client-Info":`gotrue-js/${Xy}`},Pd="X-Supabase-Api-Version",Wy={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},$T=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,GT=600*1e3;class mo extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Ze(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class qT extends mo{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function XT(e){return Ze(e)&&e.name==="AuthApiError"}class ws extends mo{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class ui extends mo{constructor(t,r,n,i){super(t,n,i),this.name=r,this.status=n}}class Ia extends ui{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function WT(e){return Ze(e)&&e.name==="AuthSessionMissingError"}class kl extends ui{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class eu extends ui{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class tu extends ui{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function KT(e){return Ze(e)&&e.name==="AuthImplicitGrantRedirectError"}class iv extends ui{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class YT extends ui{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class zd extends ui{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function dd(e){return Ze(e)&&e.name==="AuthRetryableFetchError"}class sv extends ui{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class Hd extends ui{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const pu="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),lv=` 	
\r=`.split(""),JT=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<lv.length;t+=1)e[lv[t].charCodeAt(0)]=-2;for(let t=0;t<pu.length;t+=1)e[pu[t].charCodeAt(0)]=t;return e})();function cv(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(pu[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(pu[n]),t.queuedBits-=6}}function Ky(e,t,r){const n=JT[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function ov(e){const t=[],r=o=>{t.push(String.fromCodePoint(o))},n={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},l=o=>{e4(o,n,r)};for(let o=0;o<e.length;o+=1)Ky(e.charCodeAt(o),i,l);return t.join("")}function QT(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function ZT(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const i=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|i)+65536,r+=1}QT(n,t)}}function e4(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if((e>>7-n&1)===0){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function Pl(e){const t=[],r={queue:0,queuedBits:0},n=i=>{t.push(i)};for(let i=0;i<e.length;i+=1)Ky(e.charCodeAt(i),r,n);return new Uint8Array(t)}function t4(e){const t=[];return ZT(e,r=>t.push(r)),new Uint8Array(t)}function Ss(e){const t=[],r={queue:0,queuedBits:0},n=i=>{t.push(i)};return e.forEach(i=>cv(i,r,n)),cv(null,r,n),t.join("")}function r4(e){return Math.round(Date.now()/1e3)+e}function a4(){return Symbol("auth-callback")}const Gr=()=>typeof window<"u"&&typeof document<"u",ps={tested:!1,writable:!1},Yy=()=>{if(!Gr())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(ps.tested)return ps.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),ps.tested=!0,ps.writable=!0}catch{ps.tested=!0,ps.writable=!1}return ps.writable};function n4(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((i,l)=>{t[l]=i})}catch{}return r.searchParams.forEach((n,i)=>{t[i]=n}),t}const Jy=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),i4=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Bl=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},vs=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},$r=async(e,t)=>{await e.removeItem(t)};class ju{constructor(){this.promise=new ju.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}ju.promiseConstructor=Promise;function md(e){const t=e.split(".");if(t.length!==3)throw new Hd("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!$T.test(t[n]))throw new Hd("JWT not in base64url format");return{header:JSON.parse(ov(t[0])),payload:JSON.parse(ov(t[1])),signature:Pl(t[2]),raw:{header:t[0],payload:t[1]}}}async function s4(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function l4(e,t){return new Promise((n,i)=>{(async()=>{for(let l=0;l<1/0;l++)try{const o=await e(l);if(!t(l,null,o)){n(o);return}}catch(o){if(!t(l,o)){i(o);return}}})()})}function c4(e){return("0"+e.toString(16)).substr(-2)}function o4(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let i="";for(let l=0;l<56;l++)i+=r.charAt(Math.floor(Math.random()*n));return i}return crypto.getRandomValues(t),Array.from(t,c4).join("")}async function u4(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),i=new Uint8Array(n);return Array.from(i).map(l=>String.fromCharCode(l)).join("")}async function f4(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await u4(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Al(e,t,r=!1){const n=o4();let i=n;r&&(i+="/PASSWORD_RECOVERY"),await Bl(e,`${t}-code-verifier`,i);const l=await f4(n);return[l,n===l?"plain":"s256"]}const h4=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function d4(e){const t=e.headers.get(Pd);if(!t||!t.match(h4))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function m4(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function g4(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const x4=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Cl(e){if(!x4.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function gd(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function p4(e,t){return new Proxy(e,{get:(r,n,i)=>{if(n==="__isInsecureUserWarningProxy")return!0;if(typeof n=="symbol"){const l=n.toString();if(l==="Symbol(Symbol.toPrimitive)"||l==="Symbol(Symbol.toStringTag)"||l==="Symbol(util.inspect.custom)"||l==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,n,i)}return!t.value&&typeof n=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(r,n,i)}})}function uv(e){return JSON.parse(JSON.stringify(e))}const ys=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),v4=[502,503,504];async function fv(e){var t;if(!i4(e))throw new zd(ys(e),0);if(v4.includes(e.status))throw new zd(ys(e),e.status);let r;try{r=await e.json()}catch(l){throw new ws(ys(l),l)}let n;const i=d4(e);if(i&&i.getTime()>=Wy["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new sv(ys(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new Ia}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((l,o)=>l&&typeof o=="string",!0))throw new sv(ys(r),e.status,r.weak_password.reasons);throw new qT(ys(r),e.status||500,n)}const y4=(e,t,r,n)=>{const i={method:e,headers:t?.headers||{}};return e==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t?.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),r))};async function at(e,t,r,n){var i;const l=Object.assign({},n?.headers);l[Pd]||(l[Pd]=Wy["2024-01-01"].name),n?.jwt&&(l.Authorization=`Bearer ${n.jwt}`);const o=(i=n?.query)!==null&&i!==void 0?i:{};n?.redirectTo&&(o.redirect_to=n.redirectTo);const u=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",h=await _4(e,t,r+u,{headers:l,noResolveJson:n?.noResolveJson},{},n?.body);return n?.xform?n?.xform(h):{data:Object.assign({},h),error:null}}async function _4(e,t,r,n,i,l){const o=y4(t,n,i,l);let u;try{u=await e(r,Object.assign({},o))}catch(h){throw console.error(h),new zd(ys(h),0)}if(u.ok||await fv(u),n?.noResolveJson)return u;try{return await u.json()}catch(h){await fv(h)}}function vn(e){var t;let r=null;S4(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=r4(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function hv(e){const t=vn(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function Gi(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function w4(e){return{data:e,error:null}}function b4(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:l}=e,o=Iu(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),u={action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:l},h=Object.assign({},o);return{data:{properties:u,user:h},error:null}}function dv(e){return e}function S4(e){return e.access_token&&e.refresh_token&&e.expires_in}const xd=["global","local","others"];class E4{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=Jy(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=xd[0]){if(xd.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${xd.join(", ")}`);try{return await at(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Ze(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await at(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Gi})}catch(n){if(Ze(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=Iu(t,["options"]),i=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(i.new_email=n?.newEmail,delete i.newEmail),await at(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:b4,redirectTo:r?.redirectTo})}catch(r){if(Ze(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await at(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Gi})}catch(r){if(Ze(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,i,l,o,u,h;try{const d={nextPage:null,lastPage:0,total:0},g=await at(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t?.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(l=(i=t?.perPage)===null||i===void 0?void 0:i.toString())!==null&&l!==void 0?l:""},xform:dv});if(g.error)throw g.error;const p=await g.json(),v=(o=g.headers.get("x-total-count"))!==null&&o!==void 0?o:0,_=(h=(u=g.headers.get("link"))===null||u===void 0?void 0:u.split(","))!==null&&h!==void 0?h:[];return _.length>0&&(_.forEach(w=>{const y=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),S=JSON.parse(w.split(";")[1].split("=")[1]);d[`${S}Page`]=y}),d.total=parseInt(v)),{data:Object.assign(Object.assign({},p),d),error:null}}catch(d){if(Ze(d))return{data:{users:[]},error:d};throw d}}async getUserById(t){Cl(t);try{return await at(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Gi})}catch(r){if(Ze(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){Cl(t);try{return await at(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:Gi})}catch(n){if(Ze(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){Cl(t);try{return await at(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:Gi})}catch(n){if(Ze(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){Cl(t.userId);try{const{data:r,error:n}=await at(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:r,error:n}}catch(r){if(Ze(r))return{data:null,error:r};throw r}}async _deleteFactor(t){Cl(t.userId),Cl(t.id);try{return{data:await at(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Ze(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,n,i,l,o,u,h;try{const d={nextPage:null,lastPage:0,total:0},g=await at(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t?.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(l=(i=t?.perPage)===null||i===void 0?void 0:i.toString())!==null&&l!==void 0?l:""},xform:dv});if(g.error)throw g.error;const p=await g.json(),v=(o=g.headers.get("x-total-count"))!==null&&o!==void 0?o:0,_=(h=(u=g.headers.get("link"))===null||u===void 0?void 0:u.split(","))!==null&&h!==void 0?h:[];return _.length>0&&(_.forEach(w=>{const y=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),S=JSON.parse(w.split(";")[1].split("=")[1]);d[`${S}Page`]=y}),d.total=parseInt(v)),{data:Object.assign(Object.assign({},p),d),error:null}}catch(d){if(Ze(d))return{data:{clients:[]},error:d};throw d}}async _createOAuthClient(t){try{return await at(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Ze(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await at(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Ze(r))return{data:null,error:r};throw r}}async _updateOAuthClient(t,r){try{return await at(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:r,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Ze(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(t){try{return await at(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Ze(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await at(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Ze(r))return{data:null,error:r};throw r}}}function mv(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const Nl={debug:!!(globalThis&&Yy()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Qy extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class T4 extends Qy{}async function k4(e,t,r){Nl.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),Nl.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async i=>{if(i){Nl.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,i.name);try{return await r()}finally{Nl.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,i.name)}}else{if(t===0)throw Nl.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new T4(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Nl.debug)try{const l=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(l,null,"  "))}catch(l){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",l)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function A4(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function Zy(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function C4(e){return parseInt(e,16)}function N4(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,n=>n.toString(16).padStart(2,"0")).join("")}function O4(e){var t;const{chainId:r,domain:n,expirationTime:i,issuedAt:l=new Date,nonce:o,notBefore:u,requestId:h,resources:d,scheme:g,uri:p,version:v}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!p)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(v!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${v}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const _=Zy(e.address),w=g?`${g}://${n}`:n,y=e.statement?`${e.statement}
`:"",S=`${w} wants you to sign in with your Ethereum account:
${_}

${y}`;let k=`URI: ${p}
Version: ${v}
Chain ID: ${r}${o?`
Nonce: ${o}`:""}
Issued At: ${l.toISOString()}`;if(i&&(k+=`
Expiration Time: ${i.toISOString()}`),u&&(k+=`
Not Before: ${u.toISOString()}`),h&&(k+=`
Request ID: ${h}`),d){let R=`
Resources:`;for(const T of d){if(!T||typeof T!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${T}`);R+=`
- ${T}`}k+=R}return`${S}
${k}`}class Cr extends Error{constructor({message:t,code:r,cause:n,name:i}){var l;super(t,{cause:n}),this.__isWebAuthnError=!0,this.name=(l=i??(n instanceof Error?n.name:void 0))!==null&&l!==void 0?l:"Unknown Error",this.code=r}}class vu extends Cr{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function R4({error:e,options:t}){var r,n,i;const{publicKey:l}=t;if(!l)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Cr({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=l.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new Cr({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((n=l.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new Cr({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((i=l.authenticatorSelection)===null||i===void 0?void 0:i.userVerification)==="required")return new Cr({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new Cr({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new Cr({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return l.pubKeyCredParams.filter(u=>u.type==="public-key").length===0?new Cr({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new Cr({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const o=window.location.hostname;if(e_(o)){if(l.rp.id!==o)return new Cr({message:`The RP ID "${l.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Cr({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(l.user.id.byteLength<1||l.user.id.byteLength>64)return new Cr({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new Cr({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Cr({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function D4({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Cr({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new Cr({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const n=window.location.hostname;if(e_(n)){if(r.rpId!==n)return new Cr({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Cr({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new Cr({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Cr({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class F4{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const M4=new F4;function L4(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:n}=e,i=Iu(e,["challenge","user","excludeCredentials"]),l=Pl(t).buffer,o=Object.assign(Object.assign({},r),{id:Pl(r.id).buffer}),u=Object.assign(Object.assign({},i),{challenge:l,user:o});if(n&&n.length>0){u.excludeCredentials=new Array(n.length);for(let h=0;h<n.length;h++){const d=n[h];u.excludeCredentials[h]=Object.assign(Object.assign({},d),{id:Pl(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return u}function B4(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,n=Iu(e,["challenge","allowCredentials"]),i=Pl(t).buffer,l=Object.assign(Object.assign({},n),{challenge:i});if(r&&r.length>0){l.allowCredentials=new Array(r.length);for(let o=0;o<r.length;o++){const u=r[o];l.allowCredentials[o]=Object.assign(Object.assign({},u),{id:Pl(u.id).buffer,type:u.type||"public-key",transports:u.transports})}}return l}function I4(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:Ss(new Uint8Array(e.response.attestationObject)),clientDataJSON:Ss(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function U4(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,n=e.getClientExtensionResults(),i=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:Ss(new Uint8Array(i.authenticatorData)),clientDataJSON:Ss(new Uint8Array(i.clientDataJSON)),signature:Ss(new Uint8Array(i.signature)),userHandle:i.userHandle?Ss(new Uint8Array(i.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function e_(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function gv(){var e,t;return!!(Gr()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator?.credentials)===null||t===void 0?void 0:t.get)=="function")}async function j4(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new vu("Browser returned unexpected credential type",t)}:{data:null,error:new vu("Empty credential response",t)}}catch(t){return{data:null,error:R4({error:t,options:e})}}}async function P4(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new vu("Browser returned unexpected credential type",t)}:{data:null,error:new vu("Empty credential response",t)}}catch(t){return{data:null,error:D4({error:t,options:e})}}}const z4={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},H4={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function yu(...e){const t=i=>i!==null&&typeof i=="object"&&!Array.isArray(i),r=i=>i instanceof ArrayBuffer||ArrayBuffer.isView(i),n={};for(const i of e)if(i)for(const l in i){const o=i[l];if(o!==void 0)if(Array.isArray(o))n[l]=o;else if(r(o))n[l]=o;else if(t(o)){const u=n[l];t(u)?n[l]=yu(u,o):n[l]=yu(o)}else n[l]=o}return n}function V4(e,t){return yu(z4,e,t||{})}function $4(e,t){return yu(H4,e,t||{})}class G4{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:n,signal:i},l){try{const{data:o,error:u}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!o)return{data:null,error:u};const h=i??M4.createNewAbortSignal();if(o.webauthn.type==="create"){const{user:d}=o.webauthn.credential_options.publicKey;d.name||(d.name=`${d.id}:${n}`),d.displayName||(d.displayName=d.name)}switch(o.webauthn.type){case"create":{const d=V4(o.webauthn.credential_options.publicKey,l?.create),{data:g,error:p}=await j4({publicKey:d,signal:h});return g?{data:{factorId:t,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:g}},error:null}:{data:null,error:p}}case"request":{const d=$4(o.webauthn.credential_options.publicKey,l?.request),{data:g,error:p}=await P4(Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:d,signal:h}));return g?{data:{factorId:t,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:g}},error:null}:{data:null,error:p}}}}catch(o){return Ze(o)?{data:null,error:o}:{data:null,error:new ws("Unexpected error in challenge",o)}}}async _verify({challengeId:t,factorId:r,webauthn:n}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:n})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:i}={}},l){if(!r)return{data:null,error:new mo("rpId is required for WebAuthn authentication")};try{if(!gv())return{data:null,error:new ws("Browser does not support WebAuthn",null)};const{data:o,error:u}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:n},signal:i},{request:l});if(!o)return{data:null,error:u};const{webauthn:h}=o;return this._verify({factorId:t,challengeId:o.challengeId,webauthn:{type:h.type,rpId:r,rpOrigins:n,credential_response:h.credential_response}})}catch(o){return Ze(o)?{data:null,error:o}:{data:null,error:new ws("Unexpected error in authenticate",o)}}}async _register({friendlyName:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:i}={}},l){if(!r)return{data:null,error:new mo("rpId is required for WebAuthn registration")};try{if(!gv())return{data:null,error:new ws("Browser does not support WebAuthn",null)};const{data:o,error:u}=await this._enroll({friendlyName:t});if(!o)return await this.client.mfa.listFactors().then(g=>{var p;return(p=g.data)===null||p===void 0?void 0:p.all.find(v=>v.factor_type==="webauthn"&&v.friendly_name===t&&v.status!=="unverified")}).then(g=>g?this.client.mfa.unenroll({factorId:g?.id}):void 0),{data:null,error:u};const{data:h,error:d}=await this._challenge({factorId:o.id,friendlyName:o.friendly_name,webauthn:{rpId:r,rpOrigins:n},signal:i},{create:l});return h?this._verify({factorId:o.id,challengeId:h.challengeId,webauthn:{rpId:r,rpOrigins:n,type:h.webauthn.type,credential_response:h.webauthn.credential_response}}):{data:null,error:d}}catch(o){return Ze(o)?{data:null,error:o}:{data:null,error:new ws("Unexpected error in register",o)}}}}A4();const q4={url:zT,storageKey:HT,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:VT,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function xv(e,t,r){return await r()}const Ol={};class go{get jwks(){var t,r;return(r=(t=Ol[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){Ol[this.storageKey]=Object.assign(Object.assign({},Ol[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=Ol[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){Ol[this.storageKey]=Object.assign(Object.assign({},Ol[this.storageKey]),{cachedAt:t})}constructor(t){var r,n,i;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const l=Object.assign(Object.assign({},q4),t);if(this.storageKey=l.storageKey,this.instanceID=(r=go.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,go.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!l.debug,typeof l.debug=="function"&&(this.logger=l.debug),this.instanceID>0&&Gr()){const o=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(o),this.logDebugMessages&&console.trace(o)}if(this.persistSession=l.persistSession,this.autoRefreshToken=l.autoRefreshToken,this.admin=new E4({url:l.url,headers:l.headers,fetch:l.fetch}),this.url=l.url,this.headers=l.headers,this.fetch=Jy(l.fetch),this.lock=l.lock||xv,this.detectSessionInUrl=l.detectSessionInUrl,this.flowType=l.flowType,this.hasCustomAuthorizationHeader=l.hasCustomAuthorizationHeader,this.throwOnError=l.throwOnError,l.lock?this.lock=l.lock:this.persistSession&&Gr()&&(!((n=globalThis?.navigator)===null||n===void 0)&&n.locks)?this.lock=k4:this.lock=xv,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new G4(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(l.storage?this.storage=l.storage:Yy()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=mv(this.memoryStorage)),l.userStorage&&(this.userStorage=l.userStorage)):(this.memoryStorage={},this.storage=mv(this.memoryStorage)),Gr()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(i=this.broadcastChannel)===null||i===void 0||i.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${Xy}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let r={},n="none";if(Gr()&&(r=n4(window.location.href),this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce")),Gr()&&this.detectSessionInUrl&&n!=="none"){const{data:i,error:l}=await this._getSessionFromURL(r,n);if(l){if(this._debug("#_initialize()","error detecting session from URL",l),KT(l)){const h=(t=l.details)===null||t===void 0?void 0:t.code;if(h==="identity_already_exists"||h==="identity_not_found"||h==="single_identity_not_deletable")return{error:l}}return await this._removeSession(),{error:l}}const{session:o,redirectType:u}=i;return this._debug("#_initialize()","detected session in URL",o,"redirect type",u),await this._saveSession(o),setTimeout(async()=>{u==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Ze(r)?this._returnResult({error:r}):this._returnResult({error:new ws("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,i;try{const l=await at(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t?.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(i=t?.options)===null||i===void 0?void 0:i.captchaToken}},xform:vn}),{data:o,error:u}=l;if(u||!o)return this._returnResult({data:{user:null,session:null},error:u});const h=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",h)),this._returnResult({data:{user:d,session:h},error:null})}catch(l){if(Ze(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async signUp(t){var r,n,i;try{let l;if("email"in t){const{email:g,password:p,options:v}=t;let _=null,w=null;this.flowType==="pkce"&&([_,w]=await Al(this.storage,this.storageKey)),l=await at(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:v?.emailRedirectTo,body:{email:g,password:p,data:(r=v?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:v?.captchaToken},code_challenge:_,code_challenge_method:w},xform:vn})}else if("phone"in t){const{phone:g,password:p,options:v}=t;l=await at(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:g,password:p,data:(n=v?.data)!==null&&n!==void 0?n:{},channel:(i=v?.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:v?.captchaToken}},xform:vn})}else throw new eu("You must provide either an email or phone number and a password");const{data:o,error:u}=l;if(u||!o)return await $r(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:u});const h=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",h)),this._returnResult({data:{user:d,session:h},error:null})}catch(l){if(await $r(this.storage,`${this.storageKey}-code-verifier`),Ze(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async signInWithPassword(t){try{let r;if("email"in t){const{email:l,password:o,options:u}=t;r=await at(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:l,password:o,gotrue_meta_security:{captcha_token:u?.captchaToken}},xform:hv})}else if("phone"in t){const{phone:l,password:o,options:u}=t;r=await at(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:l,password:o,gotrue_meta_security:{captcha_token:u?.captchaToken}},xform:hv})}else throw new eu("You must provide either an email or phone number and a password");const{data:n,error:i}=r;if(i)return this._returnResult({data:{user:null,session:null},error:i});if(!n||!n.session||!n.user){const l=new kl;return this._returnResult({data:{user:null,session:null},error:l})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:i})}catch(r){if(Ze(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(t){var r,n,i,l;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(i=t.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(l=t.options)===null||l===void 0?void 0:l.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,n,i,l,o,u,h,d,g,p,v;let _,w;if("message"in t)_=t.message,w=t.signature;else{const{chain:y,wallet:S,statement:k,options:R}=t;let T;if(Gr())if(typeof S=="object")T=S;else{const q=window;if("ethereum"in q&&typeof q.ethereum=="object"&&"request"in q.ethereum&&typeof q.ethereum.request=="function")T=q.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof S!="object"||!R?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");T=S}const B=new URL((r=R?.url)!==null&&r!==void 0?r:window.location.href),X=await T.request({method:"eth_requestAccounts"}).then(q=>q).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!X||X.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const M=Zy(X[0]);let N=(n=R?.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!N){const q=await T.request({method:"eth_chainId"});N=C4(q)}const Z={domain:B.host,address:M,statement:k,uri:B.href,version:"1",chainId:N,nonce:(i=R?.signInWithEthereum)===null||i===void 0?void 0:i.nonce,issuedAt:(o=(l=R?.signInWithEthereum)===null||l===void 0?void 0:l.issuedAt)!==null&&o!==void 0?o:new Date,expirationTime:(u=R?.signInWithEthereum)===null||u===void 0?void 0:u.expirationTime,notBefore:(h=R?.signInWithEthereum)===null||h===void 0?void 0:h.notBefore,requestId:(d=R?.signInWithEthereum)===null||d===void 0?void 0:d.requestId,resources:(g=R?.signInWithEthereum)===null||g===void 0?void 0:g.resources};_=O4(Z),w=await T.request({method:"personal_sign",params:[N4(_),M]})}try{const{data:y,error:S}=await at(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:_,signature:w},!((p=t.options)===null||p===void 0)&&p.captchaToken?{gotrue_meta_security:{captcha_token:(v=t.options)===null||v===void 0?void 0:v.captchaToken}}:null),xform:vn});if(S)throw S;if(!y||!y.session||!y.user){const k=new kl;return this._returnResult({data:{user:null,session:null},error:k})}return y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("SIGNED_IN",y.session)),this._returnResult({data:Object.assign({},y),error:S})}catch(y){if(Ze(y))return this._returnResult({data:{user:null,session:null},error:y});throw y}}async signInWithSolana(t){var r,n,i,l,o,u,h,d,g,p,v,_;let w,y;if("message"in t)w=t.message,y=t.signature;else{const{chain:S,wallet:k,statement:R,options:T}=t;let B;if(Gr())if(typeof k=="object")B=k;else{const M=window;if("solana"in M&&typeof M.solana=="object"&&("signIn"in M.solana&&typeof M.solana.signIn=="function"||"signMessage"in M.solana&&typeof M.solana.signMessage=="function"))B=M.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof k!="object"||!T?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");B=k}const X=new URL((r=T?.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in B&&B.signIn){const M=await B.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},T?.signInWithSolana),{version:"1",domain:X.host,uri:X.href}),R?{statement:R}:null));let N;if(Array.isArray(M)&&M[0]&&typeof M[0]=="object")N=M[0];else if(M&&typeof M=="object"&&"signedMessage"in M&&"signature"in M)N=M;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in N&&"signature"in N&&(typeof N.signedMessage=="string"||N.signedMessage instanceof Uint8Array)&&N.signature instanceof Uint8Array)w=typeof N.signedMessage=="string"?N.signedMessage:new TextDecoder().decode(N.signedMessage),y=N.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in B)||typeof B.signMessage!="function"||!("publicKey"in B)||typeof B!="object"||!B.publicKey||!("toBase58"in B.publicKey)||typeof B.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");w=[`${X.host} wants you to sign in with your Solana account:`,B.publicKey.toBase58(),...R?["",R,""]:[""],"Version: 1",`URI: ${X.href}`,`Issued At: ${(i=(n=T?.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((l=T?.signInWithSolana)===null||l===void 0)&&l.notBefore?[`Not Before: ${T.signInWithSolana.notBefore}`]:[],...!((o=T?.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${T.signInWithSolana.expirationTime}`]:[],...!((u=T?.signInWithSolana)===null||u===void 0)&&u.chainId?[`Chain ID: ${T.signInWithSolana.chainId}`]:[],...!((h=T?.signInWithSolana)===null||h===void 0)&&h.nonce?[`Nonce: ${T.signInWithSolana.nonce}`]:[],...!((d=T?.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${T.signInWithSolana.requestId}`]:[],...!((p=(g=T?.signInWithSolana)===null||g===void 0?void 0:g.resources)===null||p===void 0)&&p.length?["Resources",...T.signInWithSolana.resources.map(N=>`- ${N}`)]:[]].join(`
`);const M=await B.signMessage(new TextEncoder().encode(w),"utf8");if(!M||!(M instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");y=M}}try{const{data:S,error:k}=await at(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:w,signature:Ss(y)},!((v=t.options)===null||v===void 0)&&v.captchaToken?{gotrue_meta_security:{captcha_token:(_=t.options)===null||_===void 0?void 0:_.captchaToken}}:null),xform:vn});if(k)throw k;if(!S||!S.session||!S.user){const R=new kl;return this._returnResult({data:{user:null,session:null},error:R})}return S.session&&(await this._saveSession(S.session),await this._notifyAllSubscribers("SIGNED_IN",S.session)),this._returnResult({data:Object.assign({},S),error:k})}catch(S){if(Ze(S))return this._returnResult({data:{user:null,session:null},error:S});throw S}}async _exchangeCodeForSession(t){const r=await vs(this.storage,`${this.storageKey}-code-verifier`),[n,i]=(r??"").split("/");try{if(!n&&this.flowType==="pkce")throw new YT;const{data:l,error:o}=await at(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:vn});if(await $r(this.storage,`${this.storageKey}-code-verifier`),o)throw o;if(!l||!l.session||!l.user){const u=new kl;return this._returnResult({data:{user:null,session:null,redirectType:null},error:u})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:Object.assign(Object.assign({},l),{redirectType:i??null}),error:o})}catch(l){if(await $r(this.storage,`${this.storageKey}-code-verifier`),Ze(l))return this._returnResult({data:{user:null,session:null,redirectType:null},error:l});throw l}}async signInWithIdToken(t){try{const{options:r,provider:n,token:i,access_token:l,nonce:o}=t,u=await at(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:i,access_token:l,nonce:o,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:vn}),{data:h,error:d}=u;if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!h||!h.session||!h.user){const g=new kl;return this._returnResult({data:{user:null,session:null},error:g})}return h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",h.session)),this._returnResult({data:h,error:d})}catch(r){if(Ze(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(t){var r,n,i,l,o;try{if("email"in t){const{email:u,options:h}=t;let d=null,g=null;this.flowType==="pkce"&&([d,g]=await Al(this.storage,this.storageKey));const{error:p}=await at(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:u,data:(r=h?.data)!==null&&r!==void 0?r:{},create_user:(n=h?.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:h?.captchaToken},code_challenge:d,code_challenge_method:g},redirectTo:h?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:p})}if("phone"in t){const{phone:u,options:h}=t,{data:d,error:g}=await at(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:u,data:(i=h?.data)!==null&&i!==void 0?i:{},create_user:(l=h?.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:h?.captchaToken},channel:(o=h?.channel)!==null&&o!==void 0?o:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:d?.message_id},error:g})}throw new eu("You must provide either an email or phone number.")}catch(u){if(await $r(this.storage,`${this.storageKey}-code-verifier`),Ze(u))return this._returnResult({data:{user:null,session:null},error:u});throw u}}async verifyOtp(t){var r,n;try{let i,l;"options"in t&&(i=(r=t.options)===null||r===void 0?void 0:r.redirectTo,l=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:o,error:u}=await at(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:l}}),redirectTo:i,xform:vn});if(u)throw u;if(!o)throw new Error("An error occurred on token verification.");const h=o.session,d=o.user;return h?.access_token&&(await this._saveSession(h),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",h)),this._returnResult({data:{user:d,session:h},error:null})}catch(i){if(Ze(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithSSO(t){var r,n,i,l,o;try{let u=null,h=null;this.flowType==="pkce"&&([u,h]=await Al(this.storage,this.storageKey));const d=await at(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((i=t?.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:u,code_challenge_method:h}),headers:this.headers,xform:w4});return!((l=d.data)===null||l===void 0)&&l.url&&Gr()&&!(!((o=t.options)===null||o===void 0)&&o.skipBrowserRedirect)&&window.location.assign(d.data.url),this._returnResult(d)}catch(u){if(await $r(this.storage,`${this.storageKey}-code-verifier`),Ze(u))return this._returnResult({data:null,error:u});throw u}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new Ia;const{error:i}=await at(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:i})})}catch(t){if(Ze(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:i,options:l}=t,{error:o}=await at(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:i,gotrue_meta_security:{captcha_token:l?.captchaToken}},redirectTo:l?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}else if("phone"in t){const{phone:n,type:i,options:l}=t,{data:o,error:u}=await at(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:i,gotrue_meta_security:{captcha_token:l?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:o?.message_id},error:u})}throw new eu("You must provide either an email or phone number and a type")}catch(r){if(Ze(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await vs(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<hd:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const o=await vs(this.userStorage,this.storageKey+"-user");o?.user?t.user=o.user:t.user=gd()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const o={value:this.suppressGetSessionWarning};t.user=p4(t.user,o),o.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:i,error:l}=await this._callRefreshToken(t.refresh_token);return l?this._returnResult({data:{session:null},error:l}):this._returnResult({data:{session:i},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){if(t)return await this._getUser(t);await this.initializePromise;const r=await this._acquireLock(-1,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(t){try{return t?await at(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Gi}):await this._useSession(async r=>{var n,i,l;const{data:o,error:u}=r;if(u)throw u;return!(!((n=o.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Ia}:await at(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(l=(i=o.session)===null||i===void 0?void 0:i.access_token)!==null&&l!==void 0?l:void 0,xform:Gi})})}catch(r){if(Ze(r))return WT(r)&&(await this._removeSession(),await $r(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:i,error:l}=n;if(l)throw l;if(!i.session)throw new Ia;const o=i.session;let u=null,h=null;this.flowType==="pkce"&&t.email!=null&&([u,h]=await Al(this.storage,this.storageKey));const{data:d,error:g}=await at(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:u,code_challenge_method:h}),jwt:o.access_token,xform:Gi});if(g)throw g;return o.user=d.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),this._returnResult({data:{user:o.user},error:null})})}catch(n){if(await $r(this.storage,`${this.storageKey}-code-verifier`),Ze(n))return this._returnResult({data:{user:null},error:n});throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Ia;const r=Date.now()/1e3;let n=r,i=!0,l=null;const{payload:o}=md(t.access_token);if(o.exp&&(n=o.exp,i=n<=r),i){const{data:u,error:h}=await this._callRefreshToken(t.refresh_token);if(h)return this._returnResult({data:{user:null,session:null},error:h});if(!u)return{data:{user:null,session:null},error:null};l=u}else{const{data:u,error:h}=await this._getUser(t.access_token);if(h)throw h;l={access_token:t.access_token,refresh_token:t.refresh_token,user:u.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)}return this._returnResult({data:{user:l.user,session:l},error:null})}catch(r){if(Ze(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:o,error:u}=r;if(u)throw u;t=(n=o.session)!==null&&n!==void 0?n:void 0}if(!t?.refresh_token)throw new Ia;const{data:i,error:l}=await this._callRefreshToken(t.refresh_token);return l?this._returnResult({data:{user:null,session:null},error:l}):i?this._returnResult({data:{user:i.user,session:i},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(Ze(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(t,r){try{if(!Gr())throw new tu("No browser detected.");if(t.error||t.error_description||t.error_code)throw new tu(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new iv("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new tu("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new iv("No code detected.");const{data:R,error:T}=await this._exchangeCodeForSession(t.code);if(T)throw T;const B=new URL(window.location.href);return B.searchParams.delete("code"),window.history.replaceState(window.history.state,"",B.toString()),{data:{session:R.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:i,access_token:l,refresh_token:o,expires_in:u,expires_at:h,token_type:d}=t;if(!l||!u||!o||!d)throw new tu("No session defined in URL");const g=Math.round(Date.now()/1e3),p=parseInt(u);let v=g+p;h&&(v=parseInt(h));const _=v-g;_*1e3<=Ll&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${_}s, should have been closer to ${p}s`);const w=v-p;g-w>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",w,v,g):g-w<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",w,v,g);const{data:y,error:S}=await this._getUser(l);if(S)throw S;const k={provider_token:n,provider_refresh_token:i,access_token:l,expires_in:p,expires_at:v,refresh_token:o,token_type:d,user:y.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:k,redirectType:t.type},error:null})}catch(n){if(Ze(n))return this._returnResult({data:{session:null,redirectType:null},error:n});throw n}}_isImplicitGrantCallback(t){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),t):!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await vs(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:i,error:l}=r;if(l)return this._returnResult({error:l});const o=(n=i.session)===null||n===void 0?void 0:n.access_token;if(o){const{error:u}=await this.admin.signOut(o,t);if(u&&!(XT(u)&&(u.status===404||u.status===401||u.status===403)))return this._returnResult({error:u})}return t!=="others"&&(await this._removeSession(),await $r(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const r=a4(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,i;try{const{data:{session:l},error:o}=r;if(o)throw o;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",l)),this._debug("INITIAL_SESSION","callback id",t,"session",l)}catch(l){await((i=this.stateChangeEmitters.get(t))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",l),console.error(l)}})}async resetPasswordForEmail(t,r={}){let n=null,i=null;this.flowType==="pkce"&&([n,i]=await Al(this.storage,this.storageKey,!0));try{return await at(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:i,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(l){if(await $r(this.storage,`${this.storageKey}-code-verifier`),Ze(l))return this._returnResult({data:null,error:l});throw l}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return this._returnResult({data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(r){if(Ze(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:n,error:i}=await this._useSession(async l=>{var o,u,h,d,g;const{data:p,error:v}=l;if(v)throw v;const _=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(o=t.options)===null||o===void 0?void 0:o.redirectTo,scopes:(u=t.options)===null||u===void 0?void 0:u.scopes,queryParams:(h=t.options)===null||h===void 0?void 0:h.queryParams,skipBrowserRedirect:!0});return await at(this.fetch,"GET",_,{headers:this.headers,jwt:(g=(d=p.session)===null||d===void 0?void 0:d.access_token)!==null&&g!==void 0?g:void 0})});if(i)throw i;return Gr()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n?.url),this._returnResult({data:{provider:t.provider,url:n?.url},error:null})}catch(n){if(Ze(n))return this._returnResult({data:{provider:t.provider,url:null},error:n});throw n}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var n;try{const{error:i,data:{session:l}}=r;if(i)throw i;const{options:o,provider:u,token:h,access_token:d,nonce:g}=t,p=await at(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=l?.access_token)!==null&&n!==void 0?n:void 0,body:{provider:u,id_token:h,access_token:d,nonce:g,link_identity:!0,gotrue_meta_security:{captcha_token:o?.captchaToken}},xform:vn}),{data:v,error:_}=p;return _?this._returnResult({data:{user:null,session:null},error:_}):!v||!v.session||!v.user?this._returnResult({data:{user:null,session:null},error:new kl}):(v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers("USER_UPDATED",v.session)),this._returnResult({data:v,error:_}))}catch(i){if(await $r(this.storage,`${this.storageKey}-code-verifier`),Ze(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,i;const{data:l,error:o}=r;if(o)throw o;return await at(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(i=(n=l.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0})})}catch(r){if(Ze(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await l4(async i=>(i>0&&await s4(200*Math.pow(2,i-1)),this._debug(r,"refreshing attempt",i),await at(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:vn})),(i,l)=>{const o=200*Math.pow(2,i);return l&&dd(l)&&Date.now()+o-n<Ll})}catch(n){if(this._debug(r,"error",n),Ze(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),Gr()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const i=await vs(this.storage,this.storageKey);if(i&&this.userStorage){let o=await vs(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:i.user},await Bl(this.userStorage,this.storageKey+"-user",o)),i.user=(t=o?.user)!==null&&t!==void 0?t:gd()}else if(i&&!i.user&&!i.user){const o=await vs(this.storage,this.storageKey+"-user");o&&o?.user?(i.user=o.user,await $r(this.storage,this.storageKey+"-user"),await Bl(this.storage,this.storageKey,i)):i.user=gd()}if(this._debug(n,"session from storage",i),!this._isValidSession(i)){this._debug(n,"session is not valid"),i!==null&&await this._removeSession();return}const l=((r=i.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<hd;if(this._debug(n,`session has${l?"":" not"} expired with margin of ${hd}s`),l){if(this.autoRefreshToken&&i.refresh_token){const{error:o}=await this._callRefreshToken(i.refresh_token);o&&(console.error(o),dd(o)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(i.user&&i.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:u}=await this._getUser(i.access_token);!u&&o?.user?(i.user=o.user,await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(n,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(n,"error",i),console.error(i);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new Ia;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new ju;const{data:l,error:o}=await this._refreshAccessToken(t);if(o)throw o;if(!l.session)throw new Ia;await this._saveSession(l.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",l.session);const u={data:l.session,error:null};return this.refreshingDeferred.resolve(u),u}catch(l){if(this._debug(i,"error",l),Ze(l)){const o={data:null,error:l};return dd(l)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(o),o}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(l),l}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(t,r,n=!0){const i=`#_notifyAllSubscribers(${t})`;this._debug(i,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const l=[],o=Array.from(this.stateChangeEmitters.values()).map(async u=>{try{await u.callback(t,r)}catch(h){l.push(h)}});if(await Promise.all(o),l.length>0){for(let u=0;u<l.length;u+=1)console.error(l[u]);throw l[0]}}finally{this._debug(i,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await $r(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await Bl(this.userStorage,this.storageKey+"-user",{user:r.user});const i=Object.assign({},r);delete i.user;const l=uv(i);await Bl(this.storage,this.storageKey,l)}else{const i=uv(r);await Bl(this.storage,this.storageKey,i)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await $r(this.storage,this.storageKey),await $r(this.storage,this.storageKey+"-code-verifier"),await $r(this.storage,this.storageKey+"-user"),this.userStorage&&await $r(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Gr()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Ll);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((n.expires_at*1e3-t)/Ll);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${Ll}ms, refresh threshold is ${jd} ticks`),i<=jd&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof Qy)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Gr()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const i=[`provider=${encodeURIComponent(r)}`];if(n?.redirectTo&&i.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n?.scopes&&i.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[l,o]=await Al(this.storage,this.storageKey),u=new URLSearchParams({code_challenge:`${encodeURIComponent(l)}`,code_challenge_method:`${encodeURIComponent(o)}`});i.push(u.toString())}if(n?.queryParams){const l=new URLSearchParams(n.queryParams);i.push(l.toString())}return n?.skipBrowserRedirect&&i.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${i.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:i,error:l}=r;return l?this._returnResult({data:null,error:l}):await at(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=i?.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Ze(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,i;const{data:l,error:o}=r;if(o)return this._returnResult({data:null,error:o});const u=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:h,error:d}=await at(this.fetch,"POST",`${this.url}/factors`,{body:u,headers:this.headers,jwt:(n=l?.session)===null||n===void 0?void 0:n.access_token});return d?this._returnResult({data:null,error:d}):(t.factorType==="totp"&&h.type==="totp"&&(!((i=h?.totp)===null||i===void 0)&&i.qr_code)&&(h.totp.qr_code=`data:image/svg+xml;utf-8,${h.totp.qr_code}`),this._returnResult({data:h,error:null}))})}catch(r){if(Ze(r))return this._returnResult({data:null,error:r});throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:l}=r;if(l)return this._returnResult({data:null,error:l});const o=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?I4(t.webauthn.credential_response):U4(t.webauthn.credential_response)})}:{code:t.code}),{data:u,error:h}=await at(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:o,headers:this.headers,jwt:(n=i?.session)===null||n===void 0?void 0:n.access_token});return h?this._returnResult({data:null,error:h}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+u.expires_in},u)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",u),this._returnResult({data:u,error:h}))})}catch(r){if(Ze(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:l}=r;if(l)return this._returnResult({data:null,error:l});const o=await at(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(n=i?.session)===null||n===void 0?void 0:n.access_token});if(o.error)return o;const{data:u}=o;if(u.type!=="webauthn")return{data:u,error:null};switch(u.webauthn.type){case"create":return{data:Object.assign(Object.assign({},u),{webauthn:Object.assign(Object.assign({},u.webauthn),{credential_options:Object.assign(Object.assign({},u.webauthn.credential_options),{publicKey:L4(u.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},u),{webauthn:Object.assign(Object.assign({},u.webauthn),{credential_options:Object.assign(Object.assign({},u.webauthn.credential_options),{publicKey:B4(u.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(Ze(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?this._returnResult({data:null,error:n}):await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:n}=await this.getUser();if(n)return{data:null,error:n};const i={all:[],phone:[],totp:[],webauthn:[]};for(const l of(t=r?.factors)!==null&&t!==void 0?t:[])i.all.push(l),l.status==="verified"&&i[l.factor_type].push(l);return{data:i,error:null}}async _getAuthenticatorAssuranceLevel(){var t,r;const{data:{session:n},error:i}=await this.getSession();if(i)return this._returnResult({data:null,error:i});if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:l}=md(n.access_token);let o=null;l.aal&&(o=l.aal);let u=o;((r=(t=n.user.factors)===null||t===void 0?void 0:t.filter(g=>g.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(u="aal2");const d=l.amr||[];return{data:{currentLevel:o,nextLevel:u,currentAuthenticationMethods:d},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async r=>{const{data:{session:n},error:i}=r;return i?this._returnResult({data:null,error:i}):n?await at(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:n.access_token,xform:l=>({data:l,error:null})}):this._returnResult({data:null,error:new Ia})})}catch(r){if(Ze(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:i},error:l}=n;if(l)return this._returnResult({data:null,error:l});if(!i)return this._returnResult({data:null,error:new Ia});const o=await at(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"approve"},xform:u=>({data:u,error:null})});return o.data&&o.data.redirect_url&&Gr()&&!r?.skipBrowserRedirect&&window.location.assign(o.data.redirect_url),o})}catch(n){if(Ze(n))return this._returnResult({data:null,error:n});throw n}}async _denyAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:i},error:l}=n;if(l)return this._returnResult({data:null,error:l});if(!i)return this._returnResult({data:null,error:new Ia});const o=await at(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"deny"},xform:u=>({data:u,error:null})});return o.data&&o.data.redirect_url&&Gr()&&!r?.skipBrowserRedirect&&window.location.assign(o.data.redirect_url),o})}catch(n){if(Ze(n))return this._returnResult({data:null,error:n});throw n}}async _listOAuthGrants(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;return n?this._returnResult({data:null,error:n}):r?await at(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new Ia})})}catch(t){if(Ze(t))return this._returnResult({data:null,error:t});throw t}}async _revokeOAuthGrant(t){try{return await this._useSession(async r=>{const{data:{session:n},error:i}=r;return i?this._returnResult({data:null,error:i}):n?(await at(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,query:{client_id:t.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new Ia})})}catch(r){if(Ze(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(u=>u.kid===t);if(n)return n;const i=Date.now();if(n=this.jwks.keys.find(u=>u.kid===t),n&&this.jwks_cached_at+GT>i)return n;const{data:l,error:o}=await at(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!l.keys||l.keys.length===0||(this.jwks=l,this.jwks_cached_at=i,n=l.keys.find(u=>u.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:_,error:w}=await this.getSession();if(w||!_.session)return this._returnResult({data:null,error:w});n=_.session.access_token}const{header:i,payload:l,signature:o,raw:{header:u,payload:h}}=md(n);r?.allowExpired||m4(l.exp);const d=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(i.kid,r?.keys?{keys:r.keys}:r?.jwks);if(!d){const{error:_}=await this.getUser(n);if(_)throw _;return{data:{claims:l,header:i,signature:o},error:null}}const g=g4(i.alg),p=await crypto.subtle.importKey("jwk",d,g,!0,["verify"]);if(!await crypto.subtle.verify(g,p,o,t4(`${u}.${h}`)))throw new Hd("Invalid JWT signature");return{data:{claims:l,header:i,signature:o},error:null}}catch(n){if(Ze(n))return this._returnResult({data:null,error:n});throw n}}}go.nextInstanceID={};const X4=go,W4="2.89.0";let Kc="";typeof Deno<"u"?Kc="deno":typeof document<"u"?Kc="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Kc="react-native":Kc="node";const K4={"X-Client-Info":`supabase-js-${Kc}/${W4}`},Y4={headers:K4},J4={schema:"public"},Q4={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Z4={};function xo(e){"@babel/helpers - typeof";return xo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xo(e)}function ek(e,t){if(xo(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(xo(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tk(e){var t=ek(e,"string");return xo(t)=="symbol"?t:t+""}function rk(e,t,r){return(t=tk(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pv(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function ur(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?pv(Object(r),!0).forEach(function(n){rk(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pv(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}const ak=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),nk=()=>Headers,ik=(e,t,r)=>{const n=ak(r),i=nk();return async(l,o)=>{var u;const h=(u=await t())!==null&&u!==void 0?u:e;let d=new i(o?.headers);return d.has("apikey")||d.set("apikey",e),d.has("Authorization")||d.set("Authorization",`Bearer ${h}`),n(l,ur(ur({},o),{},{headers:d}))}};function sk(e){return e.endsWith("/")?e:e+"/"}function lk(e,t){var r,n;const{db:i,auth:l,realtime:o,global:u}=e,{db:h,auth:d,realtime:g,global:p}=t,v={db:ur(ur({},h),i),auth:ur(ur({},d),l),realtime:ur(ur({},g),o),storage:{},global:ur(ur(ur({},p),u),{},{headers:ur(ur({},(r=p?.headers)!==null&&r!==void 0?r:{}),(n=u?.headers)!==null&&n!==void 0?n:{})}),accessToken:async()=>""};return e.accessToken?v.accessToken=e.accessToken:delete v.accessToken,v}function ck(e){const t=e?.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(sk(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var ok=class extends X4{constructor(e){super(e)}},uk=class{constructor(e,t,r){var n,i;this.supabaseUrl=e,this.supabaseKey=t;const l=ck(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const o=`sb-${l.hostname.split(".")[0]}-auth-token`,u={db:J4,realtime:Z4,auth:ur(ur({},Q4),{},{storageKey:o}),global:Y4},h=lk(r??{},u);if(this.storageKey=(n=h.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(i=h.global.headers)!==null&&i!==void 0?i:{},h.accessToken)this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(g,p)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(p)} is not possible`)}});else{var d;this.auth=this._initSupabaseAuthClient((d=h.auth)!==null&&d!==void 0?d:{},this.headers,h.global.fetch)}this.fetch=ik(t,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(ur({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.accessToken&&this.accessToken().then(g=>this.realtime.setAuth(g)).catch(g=>console.warn("Failed to set initial Realtime auth token:",g)),this.rest=new VE(new URL("rest/v1",l).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),this.storage=new PT(this.storageUrl.href,this.headers,this.fetch,r?.storage),h.accessToken||this._listenForAuthEvents()}get functions(){return new UE(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e=this,t,r;if(e.accessToken)return await e.accessToken();const{data:n}=await e.auth.getSession();return(t=(r=n.session)===null||r===void 0?void 0:r.access_token)!==null&&t!==void 0?t:e.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,userStorage:i,storageKey:l,flowType:o,lock:u,debug:h,throwOnError:d},g,p){const v={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new ok({url:this.authUrl.href,headers:ur(ur({},v),g),storageKey:l,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,userStorage:i,flowType:o,lock:u,debug:h,throwOnError:d,fetch:p,hasCustomAuthorizationHeader:Object.keys(this.headers).some(_=>_.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new sT(this.realtimeUrl.href,ur(ur({},e),{},{params:ur(ur({},{apikey:this.supabaseKey}),e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",t?.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const fk=(e,t,r)=>new uk(e,t,r);function hk(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}hk()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const _u="",dk="",$i=!!_u,ru=(()=>{try{return _u&&new URL(_u).hostname.split(".")[0]||null}catch{return null}})(),au="supabase",vv=$i?fk(_u,dk,{auth:{persistSession:!0,autoRefreshToken:!0}}):null,ea={medications:"bodegapp:medications",monthlyBatches:"bodegapp:monthlyBatches",selectedMonthlyBatchId:"bodegapp:selectedMonthlyBatchId",tertiaryPackaging:"bodegapp:tertiaryPackaging",medicationCategories:"bodegapp:medicationCategories"},mk=[{id:1,inventory_type:"772",name:"Paracetamol",siges_code:"SIG-0001",sicop_classifier:"SICOP-CL-01",sicop_identifier:"SICOP-ID-0001",category:"Analgsico",batch:"LOT-2023-01",expiry_date:"2025-12-30",stock:500,min_stock:100,unit:"Tabletas"},{id:2,inventory_type:"772",name:"Amoxicilina",siges_code:"SIG-0002",sicop_classifier:"SICOP-CL-02",sicop_identifier:"SICOP-ID-0002",category:"Antibiotico",batch:"LOT-2023-05",expiry_date:"2024-06-15",stock:45,min_stock:50,unit:"Cpsulas"},{id:3,inventory_type:"772",name:"Ibuprofeno",siges_code:"SIG-0003",sicop_classifier:"SICOP-CL-03",sicop_identifier:"SICOP-ID-0003",category:"Antiinflamatorio",batch:"LOT-2023-09",expiry_date:"2026-01-20",stock:120,min_stock:40,unit:"Jarabe"},{id:4,inventory_type:"772",name:"Omeprazol",siges_code:"SIG-0004",sicop_classifier:"SICOP-CL-04",sicop_identifier:"SICOP-ID-0004",category:"Protector Gstrico",batch:"LOT-2023-12",expiry_date:"2025-03-10",stock:15,min_stock:30,unit:"Cpsulas"}];function t_(e){try{return JSON.parse(e)}catch{return null}}function nu(e){const t=window.localStorage.getItem(e);if(!t)return null;const r=t_(t);return Array.isArray(r)?r:null}function xn(e,t){window.localStorage.setItem(e,JSON.stringify(t))}const gk={async getMedications(){return nu(ea.medications)??mk},async clearMedicationsByInventoryType(e){const t=String(e||"772"),n=(await this.getMedications()??[]).filter(i=>String(i.inventory_type||"772")!==t);return xn(ea.medications,n),n},async upsertMedication(e){const t=await this.getMedications()??[],r=e?.id,n=r==null?[...t,e]:t.some(i=>i.id===r)?t.map(i=>i.id===r?e:i):[...t,e];return xn(ea.medications,n),e},async upsertMedications(e){const t=await this.getMedications()??[],r=new Map(t.map(i=>[i.id,i]));for(const i of e)r.set(i.id,i);const n=Array.from(r.values());return xn(ea.medications,n),n},async deleteMedication(e){const r=(await this.getMedications()??[]).filter(n=>n.id!==e);xn(ea.medications,r)},async clearMedications(){xn(ea.medications,[])},async getMonthlyBatches(){return(nu(ea.monthlyBatches)??[]).map(t=>({...t,id:t?.id!=null?String(t.id):t.id}))},async saveMonthlyBatch(e){const t=await this.getMonthlyBatches()??[],r={...e,id:e?.id!=null?String(e.id):e.id},n=[r,...t.filter(i=>String(i.id)!==String(r.id))];return xn(ea.monthlyBatches,n),r},async getSelectedMonthlyBatchId(){const e=window.localStorage.getItem(ea.selectedMonthlyBatchId),t=e?t_(e)??e:null;return t==null?null:String(t)},async setSelectedMonthlyBatchId(e){xn(ea.selectedMonthlyBatchId,e)},async getTertiaryPackaging(){return nu(ea.tertiaryPackaging)??[]},async upsertTertiaryPackaging(e){const t=await this.getTertiaryPackaging()??[],r=new Map(t.map(i=>[String(i.siges_code||"").trim(),i]));for(const i of e??[]){const l=String(i?.siges_code||"").trim();l&&r.set(l,{...i,siges_code:l})}const n=Array.from(r.values());return xn(ea.tertiaryPackaging,n),n},async clearTertiaryPackaging(){xn(ea.tertiaryPackaging,[])},async getMedicationCategories(){return nu(ea.medicationCategories)??[]},async upsertMedicationCategories(e){const t=await this.getMedicationCategories()??[],r=new Map(t.map(i=>[String(i.siges_code||"").trim(),i]));for(const i of e??[]){const l=String(i?.siges_code||"").trim();l&&r.set(l,{...i,siges_code:l})}const n=Array.from(r.values());return xn(ea.medicationCategories,n),n},async clearMedicationCategories(){xn(ea.medicationCategories,[])}};function Sa(){if(!vv)throw new Error("Supabase no est configurado (faltan VITE_SUPABASE_URL / VITE_SUPABASE_ANON_KEY).");return vv}function yv(e){return e?.id?e:globalThis.crypto?.randomUUID?{...e,id:globalThis.crypto.randomUUID()}:{...e,id:String(Date.now())}}const xk={async getMedications(){const e=Sa(),t=1e3;let r=0;const n=[];for(;;){const{data:i,error:l}=await e.from("medications").select("*").order("created_at",{ascending:!0}).range(r,r+t-1);if(l)throw l;const o=i??[];if(n.push(...o),o.length<t)break;r+=t}return n},async clearMedicationsByInventoryType(e){const t=Sa(),r=String(e||"772"),{error:n}=await t.from("medications").delete().eq("inventory_type",r);if(n)throw n},async upsertMedication(e){const t=Sa(),r=yv(e),{data:n,error:i}=await t.from("medications").upsert(r,{onConflict:"id"}).select("*").single();if(i)throw i;return n},async upsertMedications(e){const t=Sa(),r=(e??[]).map(yv),{data:n,error:i}=await t.from("medications").upsert(r,{onConflict:"id"}).select("*");if(i)throw i;return n??[]},async deleteMedication(e){const t=Sa(),{error:r}=await t.from("medications").delete().eq("id",e);if(r)throw r},async clearMedications(){const e=Sa(),{error:t}=await e.from("medications").delete().neq("id","00000000-0000-0000-0000-000000000000");if(t)throw t},async getMonthlyBatches(){const e=Sa(),{data:t,error:r}=await e.from("monthly_batches").select("id,label,items:monthly_batch_items(id,siges_code,medication_name,quantity,cost)").order("created_at",{ascending:!1});if(r)throw r;return(t??[]).map(n=>({...n,items:n.items??[]}))},async saveMonthlyBatch({id:e,label:t,items:r}){const n=Sa(),{data:i,error:l}=await n.from("monthly_batches").upsert({id:e,label:t},{onConflict:"label"}).select("id,label").single();if(l)throw l;const{error:o}=await n.from("monthly_batch_items").delete().eq("batch_id",i.id);if(o)throw o;const u=(r??[]).map(h=>({id:globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():String(Date.now())+Math.random(),batch_id:i.id,siges_code:h.siges_code,medication_name:h.medication_name,quantity:h.quantity,cost:h.cost}));if(u.length>0){const{error:h}=await n.from("monthly_batch_items").insert(u);if(h)throw h}return{...i,items:r}},async getSelectedMonthlyBatchId(){return null},async setSelectedMonthlyBatchId(){},async getTertiaryPackaging(){const e=Sa(),{data:t,error:r}=await e.from("tertiary_packaging").select("*").order("siges_code",{ascending:!0});if(r)throw r;return t??[]},async upsertTertiaryPackaging(e){const t=Sa(),n=(e??[]).map(o=>({id:o?.id||(globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():String(Date.now())+Math.random()),siges_code:String(o?.siges_code||"").trim(),medication_name:String(o?.medication_name||"").trim(),tertiary_quantity:Number(o?.tertiary_quantity)||0})).filter(o=>!!o.siges_code);if(n.length===0)return[];const{data:i,error:l}=await t.from("tertiary_packaging").upsert(n,{onConflict:"siges_code"}).select("*");if(l)throw l;return i??[]},async clearTertiaryPackaging(){const e=Sa(),{error:t}=await e.from("tertiary_packaging").delete().neq("id","00000000-0000-0000-0000-000000000000");if(t)throw t},async getMedicationCategories(){const e=Sa(),{data:t,error:r}=await e.from("medication_categories").select("*").order("siges_code",{ascending:!0});if(r)throw r;return t??[]},async upsertMedicationCategories(e){const t=Sa(),n=(e??[]).map(o=>({id:o?.id||(globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():String(Date.now())+Math.random()),siges_code:String(o?.siges_code||"").trim(),medication_name:String(o?.medication_name||"").trim(),category:String(o?.category||"").trim()})).filter(o=>!!(o.siges_code&&o.category));if(n.length===0)return[];const{data:i,error:l}=await t.from("medication_categories").upsert(n,{onConflict:"siges_code"}).select("*");if(l)throw l;return i??[]},async clearMedicationCategories(){const e=Sa(),{error:t}=await e.from("medication_categories").delete().neq("id","00000000-0000-0000-0000-000000000000");if(t)throw t}},It=$i?xk:gk;var wu={};wu.version="0.18.5";var r_=1252,pk=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],cm={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},om=function(e){pk.indexOf(e)!=-1&&(r_=cm[0]=e)};function vk(){om(1252)}var wn=function(e){om(e)};function um(){wn(1200),vk()}function _v(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function yk(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function a_(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Yc=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?yk(e.slice(2)):t==254&&r==255?a_(e.slice(2)):t==65279?e.slice(1):e},iu=function(t){return String.fromCharCode(t)},wv=function(t){return String.fromCharCode(t)},po,qi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function vo(e){for(var t="",r=0,n=0,i=0,l=0,o=0,u=0,h=0,d=0;d<e.length;)r=e.charCodeAt(d++),l=r>>2,n=e.charCodeAt(d++),o=(r&3)<<4|n>>4,i=e.charCodeAt(d++),u=(n&15)<<2|i>>6,h=i&63,isNaN(n)?u=h=64:isNaN(i)&&(h=64),t+=qi.charAt(l)+qi.charAt(o)+qi.charAt(u)+qi.charAt(h);return t}function $a(e){var t="",r=0,n=0,i=0,l=0,o=0,u=0,h=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<e.length;)l=qi.indexOf(e.charAt(d++)),o=qi.indexOf(e.charAt(d++)),r=l<<2|o>>4,t+=String.fromCharCode(r),u=qi.indexOf(e.charAt(d++)),n=(o&15)<<4|u>>2,u!==64&&(t+=String.fromCharCode(n)),h=qi.indexOf(e.charAt(d++)),i=(u&3)<<6|h,h!==64&&(t+=String.fromCharCode(i));return t}var pt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),fi=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function Wi(e){return pt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function bv(e){return pt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Ha=function(t){return pt?fi(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Pu(e){if(typeof ArrayBuffer>"u")return Ha(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Qi(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function _k(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function fm(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return fm(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Ir=pt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:fi(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),i=0;for(t=0,r=0;t<e.length;r+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(l){return Array.isArray(l)?l:[].slice.call(l)}))};function wk(e){for(var t=[],r=0,n=e.length+250,i=Wi(e.length+255),l=0;l<e.length;++l){var o=e.charCodeAt(l);if(o<128)i[r++]=o;else if(o<2048)i[r++]=192|o>>6&31,i[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var u=e.charCodeAt(++l)&1023;i[r++]=240|o>>8&7,i[r++]=128|o>>2&63,i[r++]=128|u>>6&15|(o&3)<<4,i[r++]=128|u&63}else i[r++]=224|o>>12&15,i[r++]=128|o>>6&63,i[r++]=128|o&63;r>n&&(t.push(i.slice(0,r)),r=0,i=Wi(65535),n=65530)}return t.push(i.slice(0,r)),Ir(t)}var ha=/\u0000/g,Jc=/[\u0001-\u0006]/g;function zl(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function bn(e,t){var r=""+e;return r.length>=t?r:fr("0",t-r.length)+r}function hm(e,t){var r=""+e;return r.length>=t?r:fr(" ",t-r.length)+r}function bu(e,t){var r=""+e;return r.length>=t?r:r+fr(" ",t-r.length)}function bk(e,t){var r=""+Math.round(e);return r.length>=t?r:fr("0",t-r.length)+r}function Sk(e,t){var r=""+e;return r.length>=t?r:fr("0",t-r.length)+r}var Sv=Math.pow(2,32);function Rl(e,t){if(e>Sv||e<-Sv)return bk(e,t);var r=Math.round(e);return Sk(r,t)}function Su(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Ev=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],pd=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Ek(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var it={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Tv={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Tk={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Eu(e,t,r){for(var n=e<0?-1:1,i=e*n,l=0,o=1,u=0,h=1,d=0,g=0,p=Math.floor(i);d<t&&(p=Math.floor(i),u=p*o+l,g=p*d+h,!(i-p<5e-8));)i=1/(i-p),l=o,o=u,h=d,d=g;if(g>t&&(d>t?(g=h,u=l):(g=d,u=o)),!r)return[0,n*u,g];var v=Math.floor(n*u/g);return[v,n*u-v*g,g]}function Es(e,t,r){if(e>2958465||e<0)return null;var n=e|0,i=Math.floor(86400*(e-n)),l=0,o=[],u={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),t&&t.date1904&&(n+=1462),u.u>.9999&&(u.u=0,++i==86400&&(u.T=i=0,++n,++u.D)),n===60)o=r?[1317,10,29]:[1900,2,29],l=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],l=6;else{n>60&&--n;var h=new Date(1900,0,1);h.setDate(h.getDate()+n-1),o=[h.getFullYear(),h.getMonth()+1,h.getDate()],l=h.getDay(),n<60&&(l=(l+6)%7),r&&(l=Rk(h,o))}return u.y=o[0],u.m=o[1],u.d=o[2],u.S=i%60,i=Math.floor(i/60),u.M=i%60,i=Math.floor(i/60),u.H=i,u.q=l,u}var n_=new Date(1899,11,31,0,0,0),kk=n_.getTime(),Ak=new Date(1900,2,1,0,0,0);function i_(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=Ak&&(r+=1440*60*1e3),(r-(kk+(e.getTimezoneOffset()-n_.getTimezoneOffset())*6e4))/(1440*60*1e3)}function dm(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Ck(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Nk(e){var t=e<0?12:11,r=dm(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function Ok(e){var t=dm(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function yo(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=Nk(e):t===10?r=e.toFixed(10).substr(0,12):r=Ok(e),dm(Ck(r.toUpperCase()))}function Ns(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):yo(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return fn(14,i_(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Rk(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function Dk(e,t,r,n){var i="",l=0,o=0,u=r.y,h,d=0;switch(e){case 98:u=r.y+543;case 121:switch(t.length){case 1:case 2:h=u%100,d=2;break;default:h=u%1e4,d=4;break}break;case 109:switch(t.length){case 1:case 2:h=r.m,d=t.length;break;case 3:return pd[r.m-1][1];case 5:return pd[r.m-1][0];default:return pd[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:h=r.d,d=t.length;break;case 3:return Ev[r.q][0];default:return Ev[r.q][1]}break;case 104:switch(t.length){case 1:case 2:h=1+(r.H+11)%12,d=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:h=r.H,d=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:h=r.M,d=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?bn(r.S,t.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,l=Math.round(o*(r.S+r.u)),l>=60*o&&(l=0),t==="s"?l===0?"0":""+l/o:(i=bn(l,2+n),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":h=r.D*24+r.H;break;case"[m]":case"[mm]":h=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":h=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}d=t.length===3?1:2;break;case 101:h=u,d=1;break}var g=d>0?bn(h,d):"";return g}function Xi(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var s_=/%/g;function Fk(e,t,r){var n=t.replace(s_,""),i=t.length-n.length;return si(e,n,r*Math.pow(10,2*i))+fr("%",i)}function Mk(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return si(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function l_(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+l_(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var l=Math.floor(Math.log(t)*Math.LOG10E)%i;if(l<0&&(l+=i),r=(t/Math.pow(10,l)).toPrecision(n+1+(i+l)%i),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+l):r+="E+"+(o-l);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,h,d,g){return h+d+g.substr(0,(i+l)%i)+"."+g.substr(l)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var c_=/# (\?+)( ?)\/( ?)(\d+)/;function Lk(e,t,r){var n=parseInt(e[4],10),i=Math.round(t*n),l=Math.floor(i/n),o=i-l*n,u=n;return r+(l===0?"":""+l)+" "+(o===0?fr(" ",e[1].length+1+e[4].length):hm(o,e[1].length)+e[2]+"/"+e[3]+bn(u,e[4].length))}function Bk(e,t,r){return r+(t===0?"":""+t)+fr(" ",e[1].length+2+e[4].length)}var o_=/^#*0*\.([0#]+)/,u_=/\).*[0#]/,f_=/\(###\) ###\\?-####/;function ua(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function kv(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Av(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function Ik(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function Uk(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function nn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(u_)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?nn("n",n,r):"("+nn("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Mk(e,t,r);if(t.indexOf("%")!==-1)return Fk(e,t,r);if(t.indexOf("E")!==-1)return l_(t,r);if(t.charCodeAt(0)===36)return"$"+nn(e,t.substr(t.charAt(1)==" "?2:1),r);var i,l,o,u,h=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+Rl(h,t.length);if(t.match(/^[#?]+$/))return i=Rl(r,0),i==="0"&&(i=""),i.length>t.length?i:ua(t.substr(0,t.length-i.length))+i;if(l=t.match(c_))return Lk(l,h,d);if(t.match(/^#+0+$/))return d+Rl(h,t.length-t.indexOf("0"));if(l=t.match(o_))return i=kv(r,l[1].length).replace(/^([^\.]+)$/,"$1."+ua(l[1])).replace(/\.$/,"."+ua(l[1])).replace(/\.(\d*)$/,function(w,y){return"."+y+fr("0",ua(l[1]).length-y.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),l=t.match(/^(0*)\.(#*)$/))return d+kv(h,l[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=t.match(/^#{1,3},##0(\.?)$/))return d+Xi(Rl(h,0));if(l=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+nn(e,t,-r):Xi(""+(Math.floor(r)+Ik(r,l[1].length)))+"."+bn(Av(r,l[1].length),l[1].length);if(l=t.match(/^#,#*,#0/))return nn(e,t.replace(/^#,#*,/,""),r);if(l=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=zl(nn(e,t.replace(/[\\-]/g,""),r)),o=0,zl(zl(t.replace(/\\/g,"")).replace(/[0#]/g,function(w){return o<i.length?i.charAt(o++):w==="0"?"0":""}));if(t.match(f_))return i=nn(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var g="";if(l=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(l[4].length,7),u=Eu(h,Math.pow(10,o)-1,!1),i=""+d,g=si("n",l[1],u[1]),g.charAt(g.length-1)==" "&&(g=g.substr(0,g.length-1)+"0"),i+=g+l[2]+"/"+l[3],g=bu(u[2],o),g.length<l[4].length&&(g=ua(l[4].substr(l[4].length-g.length))+g),i+=g,i;if(l=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(l[1].length,l[4].length),7),u=Eu(h,Math.pow(10,o)-1,!0),d+(u[0]||(u[1]?"":"0"))+" "+(u[1]?hm(u[1],o)+l[2]+"/"+l[3]+bu(u[2],o):fr(" ",2*o+1+l[2].length+l[3].length));if(l=t.match(/^[#0?]+$/))return i=Rl(r,0),t.length<=i.length?i:ua(t.substr(0,t.length-i.length))+i;if(l=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var p=t.indexOf(".")-o,v=t.length-i.length-p;return ua(t.substr(0,p)+i+t.substr(t.length-v))}if(l=t.match(/^00,000\.([#0]*0)$/))return o=Av(r,l[1].length),r<0?"-"+nn(e,t,-r):Xi(Uk(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?bn(0,3-w.length):"")+w})+"."+bn(o,l[1].length);switch(t){case"###,##0.00":return nn(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var _=Xi(Rl(h,0));return _!=="0"?d+_:"";case"###,###.00":return nn(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return nn(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function jk(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return si(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function Pk(e,t,r){var n=t.replace(s_,""),i=t.length-n.length;return si(e,n,r*Math.pow(10,2*i))+fr("%",i)}function h_(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+h_(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var l=Math.floor(Math.log(t)*Math.LOG10E)%i;if(l<0&&(l+=i),r=(t/Math.pow(10,l)).toPrecision(n+1+(i+l)%i),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+l):r+="E+"+(o-l),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,h,d,g){return h+d+g.substr(0,(i+l)%i)+"."+g.substr(l)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Dn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(u_)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Dn("n",n,r):"("+Dn("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return jk(e,t,r);if(t.indexOf("%")!==-1)return Pk(e,t,r);if(t.indexOf("E")!==-1)return h_(t,r);if(t.charCodeAt(0)===36)return"$"+Dn(e,t.substr(t.charAt(1)==" "?2:1),r);var i,l,o,u,h=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+bn(h,t.length);if(t.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>t.length?i:ua(t.substr(0,t.length-i.length))+i;if(l=t.match(c_))return Bk(l,h,d);if(t.match(/^#+0+$/))return d+bn(h,t.length-t.indexOf("0"));if(l=t.match(o_))return i=(""+r).replace(/^([^\.]+)$/,"$1."+ua(l[1])).replace(/\.$/,"."+ua(l[1])),i=i.replace(/\.(\d*)$/,function(w,y){return"."+y+fr("0",ua(l[1]).length-y.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),l=t.match(/^(0*)\.(#*)$/))return d+(""+h).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=t.match(/^#{1,3},##0(\.?)$/))return d+Xi(""+h);if(l=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Dn(e,t,-r):Xi(""+r)+"."+fr("0",l[1].length);if(l=t.match(/^#,#*,#0/))return Dn(e,t.replace(/^#,#*,/,""),r);if(l=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=zl(Dn(e,t.replace(/[\\-]/g,""),r)),o=0,zl(zl(t.replace(/\\/g,"")).replace(/[0#]/g,function(w){return o<i.length?i.charAt(o++):w==="0"?"0":""}));if(t.match(f_))return i=Dn(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var g="";if(l=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(l[4].length,7),u=Eu(h,Math.pow(10,o)-1,!1),i=""+d,g=si("n",l[1],u[1]),g.charAt(g.length-1)==" "&&(g=g.substr(0,g.length-1)+"0"),i+=g+l[2]+"/"+l[3],g=bu(u[2],o),g.length<l[4].length&&(g=ua(l[4].substr(l[4].length-g.length))+g),i+=g,i;if(l=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(l[1].length,l[4].length),7),u=Eu(h,Math.pow(10,o)-1,!0),d+(u[0]||(u[1]?"":"0"))+" "+(u[1]?hm(u[1],o)+l[2]+"/"+l[3]+bu(u[2],o):fr(" ",2*o+1+l[2].length+l[3].length));if(l=t.match(/^[#0?]+$/))return i=""+r,t.length<=i.length?i:ua(t.substr(0,t.length-i.length))+i;if(l=t.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var p=t.indexOf(".")-o,v=t.length-i.length-p;return ua(t.substr(0,p)+i+t.substr(t.length-v))}if(l=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Dn(e,t,-r):Xi(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?bn(0,3-w.length):"")+w})+"."+bn(0,l[1].length);switch(t){case"###,###":case"##,###":case"#,###":var _=Xi(""+h);return _!=="0"?d+_:"";default:if(t.match(/\.[0#?]*$/))return Dn(e,t.slice(0,t.lastIndexOf(".")),r)+ua(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function si(e,t,r){return(r|0)===r?Dn(e,t,r):nn(e,t,r)}function zk(e){for(var t=[],r=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(i,n-i),i=n+1}if(t[t.length]=e.substr(i),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var d_=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Jl(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":Su(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(d_))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function Hk(e,t,r,n){for(var i=[],l="",o=0,u="",h="t",d,g,p,v="H";o<e.length;)switch(u=e.charAt(o)){case"G":if(!Su(e,o))throw new Error("unrecognized character "+u+" in "+e);i[i.length]={t:"G",v:"General"},o+=7;break;case'"':for(l="";(p=e.charCodeAt(++o))!==34&&o<e.length;)l+=String.fromCharCode(p);i[i.length]={t:"t",v:l},++o;break;case"\\":var _=e.charAt(++o),w=_==="("||_===")"?_:"t";i[i.length]={t:w,v:_},++o;break;case"_":i[i.length]={t:"t",v:" "},o+=2;break;case"@":i[i.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(d==null&&(d=Es(t,r,e.charAt(o+1)==="2"),d==null))return"";i[i.length]={t:"X",v:e.substr(o,2)},h=u,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||d==null&&(d=Es(t,r),d==null))return"";for(l=u;++o<e.length&&e.charAt(o).toLowerCase()===u;)l+=u;u==="m"&&h.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=v),i[i.length]={t:u,v:l},h=u;break;case"A":case"a":case"":var y={t:u,v:u};if(d==null&&(d=Es(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(d!=null&&(y.v=d.H>=12?"P":"A"),y.t="T",v="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(d!=null&&(y.v=d.H>=12?"PM":"AM"),y.t="T",o+=5,v="h"):e.substr(o,5).toUpperCase()==="/"?(d!=null&&(y.v=d.H>=12?"":""),y.t="T",o+=5,v="h"):(y.t="t",++o),d==null&&y.t==="T")return"";i[i.length]=y,h=u;break;case"[":for(l=u;e.charAt(o++)!=="]"&&o<e.length;)l+=e.charAt(o);if(l.slice(-1)!=="]")throw'unterminated "[" block: |'+l+"|";if(l.match(d_)){if(d==null&&(d=Es(t,r),d==null))return"";i[i.length]={t:"Z",v:l.toLowerCase()},h=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",Jl(e)||(i[i.length]={t:"t",v:l}));break;case".":if(d!=null){for(l=u;++o<e.length&&(u=e.charAt(o))==="0";)l+=u;i[i.length]={t:"s",v:l};break}case"0":case"#":for(l=u;++o<e.length&&"0#?.,E+-%".indexOf(u=e.charAt(o))>-1;)l+=u;i[i.length]={t:"n",v:l};break;case"?":for(l=u;e.charAt(++o)===u;)l+=u;i[i.length]={t:u,v:l},h=u;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":i[i.length]={t:n===1?"t":u,v:u},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=u;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)l+=e.charAt(o);i[i.length]={t:"D",v:l};break;case" ":i[i.length]={t:u,v:u},++o;break;case"$":i[i.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+e);i[i.length]={t:"t",v:u},++o;break}var S=0,k=0,R;for(o=i.length-1,h="t";o>=0;--o)switch(i[o].t){case"h":case"H":i[o].t=v,h="h",S<1&&(S=1);break;case"s":(R=i[o].v.match(/\.0+$/))&&(k=Math.max(k,R[0].length-1)),S<3&&(S=3);case"d":case"y":case"M":case"e":h=i[o].t;break;case"m":h==="s"&&(i[o].t="M",S<2&&(S=2));break;case"X":break;case"Z":S<1&&i[o].v.match(/[Hh]/)&&(S=1),S<2&&i[o].v.match(/[Mm]/)&&(S=2),S<3&&i[o].v.match(/[Ss]/)&&(S=3)}switch(S){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var T="",B;for(o=0;o<i.length;++o)switch(i[o].t){case"t":case"T":case" ":case"D":break;case"X":i[o].v="",i[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[o].v=Dk(i[o].t.charCodeAt(0),i[o].v,d,k),i[o].t="t";break;case"n":case"?":for(B=o+1;i[B]!=null&&((u=i[B].t)==="?"||u==="D"||(u===" "||u==="t")&&i[B+1]!=null&&(i[B+1].t==="?"||i[B+1].t==="t"&&i[B+1].v==="/")||i[o].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(i[B].v==="/"||i[B].v===" "&&i[B+1]!=null&&i[B+1].t=="?"));)i[o].v+=i[B].v,i[B]={v:"",t:";"},++B;T+=i[o].v,o=B-1;break;case"G":i[o].t="t",i[o].v=Ns(t,r);break}var X="",M,N;if(T.length>0){T.charCodeAt(0)==40?(M=t<0&&T.charCodeAt(0)===45?-t:t,N=si("n",T,M)):(M=t<0&&n>1?-t:t,N=si("n",T,M),M<0&&i[0]&&i[0].t=="t"&&(N=N.substr(1),i[0].v="-"+i[0].v)),B=N.length-1;var Z=i.length;for(o=0;o<i.length;++o)if(i[o]!=null&&i[o].t!="t"&&i[o].v.indexOf(".")>-1){Z=o;break}var q=i.length;if(Z===i.length&&N.indexOf("E")===-1){for(o=i.length-1;o>=0;--o)i[o]==null||"n?".indexOf(i[o].t)===-1||(B>=i[o].v.length-1?(B-=i[o].v.length,i[o].v=N.substr(B+1,i[o].v.length)):B<0?i[o].v="":(i[o].v=N.substr(0,B+1),B=-1),i[o].t="t",q=o);B>=0&&q<i.length&&(i[q].v=N.substr(0,B+1)+i[q].v)}else if(Z!==i.length&&N.indexOf("E")===-1){for(B=N.indexOf(".")-1,o=Z;o>=0;--o)if(!(i[o]==null||"n?".indexOf(i[o].t)===-1)){for(g=i[o].v.indexOf(".")>-1&&o===Z?i[o].v.indexOf(".")-1:i[o].v.length-1,X=i[o].v.substr(g+1);g>=0;--g)B>=0&&(i[o].v.charAt(g)==="0"||i[o].v.charAt(g)==="#")&&(X=N.charAt(B--)+X);i[o].v=X,i[o].t="t",q=o}for(B>=0&&q<i.length&&(i[q].v=N.substr(0,B+1)+i[q].v),B=N.indexOf(".")+1,o=Z;o<i.length;++o)if(!(i[o]==null||"n?(".indexOf(i[o].t)===-1&&o!==Z)){for(g=i[o].v.indexOf(".")>-1&&o===Z?i[o].v.indexOf(".")+1:0,X=i[o].v.substr(0,g);g<i[o].v.length;++g)B<N.length&&(X+=N.charAt(B++));i[o].v=X,i[o].t="t",q=o}}}for(o=0;o<i.length;++o)i[o]!=null&&"n?".indexOf(i[o].t)>-1&&(M=n>1&&t<0&&o>0&&i[o-1].v==="-"?-t:t,i[o].v=si(i[o].t,i[o].v,M),i[o].t="t");var he="";for(o=0;o!==i.length;++o)i[o]!=null&&(he+=i[o].v);return he}var Cv=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Nv(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function Vk(e,t){var r=zk(e),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var l=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,l];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(Cv),u=r[1].match(Cv);return Nv(t,o)?[n,r[0]]:Nv(t,u)?[n,r[1]]:[n,r[o!=null&&u!=null?2:1]]}return[n,l]}function fn(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:it)[e],n==null&&(n=r.table&&r.table[Tv[e]]||it[Tv[e]]),n==null&&(n=Tk[e]||"General");break}if(Su(n,0))return Ns(t,r);t instanceof Date&&(t=i_(t,r.date1904));var i=Vk(n,t);if(Su(i[1]))return Ns(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return Hk(i[1],t,r,i[0])}function li(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(it[r]==null){t<0&&(t=r);continue}if(it[r]==e){t=r;break}}t<0&&(t=391)}return it[t]=e,t}function zu(e){for(var t=0;t!=392;++t)e[t]!==void 0&&li(e[t],t)}function Ql(){it=Ek()}var $k={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},m_=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Gk(e){var t=typeof e=="number"?it[e]:e;return t=t.replace(m_,"(\\d+)"),new RegExp("^"+t+"$")}function qk(e,t,r){var n=-1,i=-1,l=-1,o=-1,u=-1,h=-1;(t.match(m_)||[]).forEach(function(p,v){var _=parseInt(r[v+1],10);switch(p.toLowerCase().charAt(0)){case"y":n=_;break;case"d":l=_;break;case"h":o=_;break;case"s":h=_;break;case"m":o>=0?u=_:i=_;break}}),h>=0&&u==-1&&i>=0&&(u=i,i=-1);var d=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(l>=1?l:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var g=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(h>=0?h:0)).slice(-2);return o==-1&&u==-1&&h==-1?d:n==-1&&i==-1&&l==-1?g:d+"T"+g}var Xk=(function(){var e={};e.version="1.2.0";function t(){for(var N=0,Z=new Array(256),q=0;q!=256;++q)N=q,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,Z[q]=N;return typeof Int32Array<"u"?new Int32Array(Z):Z}var r=t();function n(N){var Z=0,q=0,he=0,Y=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(he=0;he!=256;++he)Y[he]=N[he];for(he=0;he!=256;++he)for(q=N[he],Z=256+he;Z<4096;Z+=256)q=Y[Z]=q>>>8^N[q&255];var Q=[];for(he=1;he!=16;++he)Q[he-1]=typeof Int32Array<"u"?Y.subarray(he*256,he*256+256):Y.slice(he*256,he*256+256);return Q}var i=n(r),l=i[0],o=i[1],u=i[2],h=i[3],d=i[4],g=i[5],p=i[6],v=i[7],_=i[8],w=i[9],y=i[10],S=i[11],k=i[12],R=i[13],T=i[14];function B(N,Z){for(var q=Z^-1,he=0,Y=N.length;he<Y;)q=q>>>8^r[(q^N.charCodeAt(he++))&255];return~q}function X(N,Z){for(var q=Z^-1,he=N.length-15,Y=0;Y<he;)q=T[N[Y++]^q&255]^R[N[Y++]^q>>8&255]^k[N[Y++]^q>>16&255]^S[N[Y++]^q>>>24]^y[N[Y++]]^w[N[Y++]]^_[N[Y++]]^v[N[Y++]]^p[N[Y++]]^g[N[Y++]]^d[N[Y++]]^h[N[Y++]]^u[N[Y++]]^o[N[Y++]]^l[N[Y++]]^r[N[Y++]];for(he+=15;Y<he;)q=q>>>8^r[(q^N[Y++])&255];return~q}function M(N,Z){for(var q=Z^-1,he=0,Y=N.length,Q=0,pe=0;he<Y;)Q=N.charCodeAt(he++),Q<128?q=q>>>8^r[(q^Q)&255]:Q<2048?(q=q>>>8^r[(q^(192|Q>>6&31))&255],q=q>>>8^r[(q^(128|Q&63))&255]):Q>=55296&&Q<57344?(Q=(Q&1023)+64,pe=N.charCodeAt(he++)&1023,q=q>>>8^r[(q^(240|Q>>8&7))&255],q=q>>>8^r[(q^(128|Q>>2&63))&255],q=q>>>8^r[(q^(128|pe>>6&15|(Q&3)<<4))&255],q=q>>>8^r[(q^(128|pe&63))&255]):(q=q>>>8^r[(q^(224|Q>>12&15))&255],q=q>>>8^r[(q^(128|Q>>6&63))&255],q=q>>>8^r[(q^(128|Q&63))&255]);return~q}return e.table=r,e.bstr=B,e.buf=X,e.str=M,e})(),tt=(function(){var t={};t.version="1.2.1";function r(C,j){for(var D=C.split("/"),F=j.split("/"),L=0,H=0,ce=Math.min(D.length,F.length);L<ce;++L){if(H=D[L].length-F[L].length)return H;if(D[L]!=F[L])return D[L]<F[L]?-1:1}return D.length-F.length}function n(C){if(C.charAt(C.length-1)=="/")return C.slice(0,-1).indexOf("/")===-1?C:n(C.slice(0,-1));var j=C.lastIndexOf("/");return j===-1?C:C.slice(0,j+1)}function i(C){if(C.charAt(C.length-1)=="/")return i(C.slice(0,-1));var j=C.lastIndexOf("/");return j===-1?C:C.slice(j+1)}function l(C,j){typeof j=="string"&&(j=new Date(j));var D=j.getHours();D=D<<6|j.getMinutes(),D=D<<5|j.getSeconds()>>>1,C.write_shift(2,D);var F=j.getFullYear()-1980;F=F<<4|j.getMonth()+1,F=F<<5|j.getDate(),C.write_shift(2,F)}function o(C){var j=C.read_shift(2)&65535,D=C.read_shift(2)&65535,F=new Date,L=D&31;D>>>=5;var H=D&15;D>>>=4,F.setMilliseconds(0),F.setFullYear(D+1980),F.setMonth(H-1),F.setDate(L);var ce=j&31;j>>>=5;var ve=j&63;return j>>>=6,F.setHours(j),F.setMinutes(ve),F.setSeconds(ce<<1),F}function u(C){Xr(C,0);for(var j={},D=0;C.l<=C.length-4;){var F=C.read_shift(2),L=C.read_shift(2),H=C.l+L,ce={};F===21589&&(D=C.read_shift(1),D&1&&(ce.mtime=C.read_shift(4)),L>5&&(D&2&&(ce.atime=C.read_shift(4)),D&4&&(ce.ctime=C.read_shift(4))),ce.mtime&&(ce.mt=new Date(ce.mtime*1e3))),C.l=H,j[F]=ce}return j}var h;function d(){return h||(h={})}function g(C,j){if(C[0]==80&&C[1]==75)return In(C,j);if((C[0]|32)==109&&(C[1]|32)==105)return jn(C,j);if(C.length<512)throw new Error("CFB file size "+C.length+" < 512");var D=3,F=512,L=0,H=0,ce=0,ve=0,oe=0,ue=[],fe=C.slice(0,512);Xr(fe,0);var Re=p(fe);switch(D=Re[0],D){case 3:F=512;break;case 4:F=4096;break;case 0:if(Re[1]==0)return In(C,j);default:throw new Error("Major Version: Expected 3 or 4 saw "+D)}F!==512&&(fe=C.slice(0,F),Xr(fe,28));var Me=C.slice(0,F);v(fe,D);var ze=fe.read_shift(4,"i");if(D===3&&ze!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ze);fe.l+=4,ce=fe.read_shift(4,"i"),fe.l+=4,fe.chk("00100000","Mini Stream Cutoff Size: "),ve=fe.read_shift(4,"i"),L=fe.read_shift(4,"i"),oe=fe.read_shift(4,"i"),H=fe.read_shift(4,"i");for(var P=-1,W=0;W<109&&(P=fe.read_shift(4,"i"),!(P<0));++W)ue[W]=P;var re=_(C,F);S(oe,H,re,F,ue);var ke=R(re,ce,ue,F);ke[ce].name="!Directory",L>0&&ve!==pe&&(ke[ve].name="!MiniFAT"),ke[ue[0]].name="!FAT",ke.fat_addrs=ue,ke.ssz=F;var De={},Fe=[],Le=[],Ge=[];T(ce,ke,re,Fe,L,De,Le,ve),w(Le,Ge,Fe),Fe.shift();var $e={FileIndex:Le,FullPaths:Ge};return j&&j.raw&&($e.raw={header:Me,sectors:re}),$e}function p(C){if(C[C.l]==80&&C[C.l+1]==75)return[0,0];C.chk(Ce,"Header Signature: "),C.l+=16;var j=C.read_shift(2,"u");return[C.read_shift(2,"u"),j]}function v(C,j){var D=9;switch(C.l+=2,D=C.read_shift(2)){case 9:if(j!=3)throw new Error("Sector Shift: Expected 9 saw "+D);break;case 12:if(j!=4)throw new Error("Sector Shift: Expected 12 saw "+D);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+D)}C.chk("0600","Mini Sector Shift: "),C.chk("000000000000","Reserved: ")}function _(C,j){for(var D=Math.ceil(C.length/j)-1,F=[],L=1;L<D;++L)F[L-1]=C.slice(L*j,(L+1)*j);return F[D-1]=C.slice(D*j),F}function w(C,j,D){for(var F=0,L=0,H=0,ce=0,ve=0,oe=D.length,ue=[],fe=[];F<oe;++F)ue[F]=fe[F]=F,j[F]=D[F];for(;ve<fe.length;++ve)F=fe[ve],L=C[F].L,H=C[F].R,ce=C[F].C,ue[F]===F&&(L!==-1&&ue[L]!==L&&(ue[F]=ue[L]),H!==-1&&ue[H]!==H&&(ue[F]=ue[H])),ce!==-1&&(ue[ce]=F),L!==-1&&F!=ue[F]&&(ue[L]=ue[F],fe.lastIndexOf(L)<ve&&fe.push(L)),H!==-1&&F!=ue[F]&&(ue[H]=ue[F],fe.lastIndexOf(H)<ve&&fe.push(H));for(F=1;F<oe;++F)ue[F]===F&&(H!==-1&&ue[H]!==H?ue[F]=ue[H]:L!==-1&&ue[L]!==L&&(ue[F]=ue[L]));for(F=1;F<oe;++F)if(C[F].type!==0){if(ve=F,ve!=ue[ve])do ve=ue[ve],j[F]=j[ve]+"/"+j[F];while(ve!==0&&ue[ve]!==-1&&ve!=ue[ve]);ue[F]=-1}for(j[0]+="/",F=1;F<oe;++F)C[F].type!==2&&(j[F]+="/")}function y(C,j,D){for(var F=C.start,L=C.size,H=[],ce=F;D&&L>0&&ce>=0;)H.push(j.slice(ce*Q,ce*Q+Q)),L-=Q,ce=bs(D,ce*4);return H.length===0?xe(0):Ir(H).slice(0,C.size)}function S(C,j,D,F,L){var H=pe;if(C===pe){if(j!==0)throw new Error("DIFAT chain shorter than expected")}else if(C!==-1){var ce=D[C],ve=(F>>>2)-1;if(!ce)return;for(var oe=0;oe<ve&&(H=bs(ce,oe*4))!==pe;++oe)L.push(H);S(bs(ce,F-4),j-1,D,F,L)}}function k(C,j,D,F,L){var H=[],ce=[];L||(L=[]);var ve=F-1,oe=0,ue=0;for(oe=j;oe>=0;){L[oe]=!0,H[H.length]=oe,ce.push(C[oe]);var fe=D[Math.floor(oe*4/F)];if(ue=oe*4&ve,F<4+ue)throw new Error("FAT boundary crossed: "+oe+" 4 "+F);if(!C[fe])break;oe=bs(C[fe],ue)}return{nodes:H,data:zv([ce])}}function R(C,j,D,F){var L=C.length,H=[],ce=[],ve=[],oe=[],ue=F-1,fe=0,Re=0,Me=0,ze=0;for(fe=0;fe<L;++fe)if(ve=[],Me=fe+j,Me>=L&&(Me-=L),!ce[Me]){oe=[];var P=[];for(Re=Me;Re>=0;){P[Re]=!0,ce[Re]=!0,ve[ve.length]=Re,oe.push(C[Re]);var W=D[Math.floor(Re*4/F)];if(ze=Re*4&ue,F<4+ze)throw new Error("FAT boundary crossed: "+Re+" 4 "+F);if(!C[W]||(Re=bs(C[W],ze),P[Re]))break}H[Me]={nodes:ve,data:zv([oe])}}return H}function T(C,j,D,F,L,H,ce,ve){for(var oe=0,ue=F.length?2:0,fe=j[C].data,Re=0,Me=0,ze;Re<fe.length;Re+=128){var P=fe.slice(Re,Re+128);Xr(P,64),Me=P.read_shift(2),ze=_m(P,0,Me-ue),F.push(ze);var W={name:ze,type:P.read_shift(1),color:P.read_shift(1),L:P.read_shift(4,"i"),R:P.read_shift(4,"i"),C:P.read_shift(4,"i"),clsid:P.read_shift(16),state:P.read_shift(4,"i"),start:0,size:0},re=P.read_shift(2)+P.read_shift(2)+P.read_shift(2)+P.read_shift(2);re!==0&&(W.ct=B(P,P.l-8));var ke=P.read_shift(2)+P.read_shift(2)+P.read_shift(2)+P.read_shift(2);ke!==0&&(W.mt=B(P,P.l-8)),W.start=P.read_shift(4,"i"),W.size=P.read_shift(4,"i"),W.size<0&&W.start<0&&(W.size=W.type=0,W.start=pe,W.name=""),W.type===5?(oe=W.start,L>0&&oe!==pe&&(j[oe].name="!StreamData")):W.size>=4096?(W.storage="fat",j[W.start]===void 0&&(j[W.start]=k(D,W.start,j.fat_addrs,j.ssz)),j[W.start].name=W.name,W.content=j[W.start].data.slice(0,W.size)):(W.storage="minifat",W.size<0?W.size=0:oe!==pe&&W.start!==pe&&j[oe]&&(W.content=y(W,j[oe].data,(j[ve]||{}).data))),W.content&&Xr(W.content,0),H[ze]=W,ce.push(W)}}function B(C,j){return new Date((ja(C,j+4)/1e7*Math.pow(2,32)+ja(C,j)/1e7-11644473600)*1e3)}function X(C,j){return d(),g(h.readFileSync(C),j)}function M(C,j){var D=j&&j.type;switch(D||pt&&Buffer.isBuffer(C)&&(D="buffer"),D||"base64"){case"file":return X(C,j);case"base64":return g(Ha($a(C)),j);case"binary":return g(Ha(C),j)}return g(C,j)}function N(C,j){var D=j||{},F=D.root||"Root Entry";if(C.FullPaths||(C.FullPaths=[]),C.FileIndex||(C.FileIndex=[]),C.FullPaths.length!==C.FileIndex.length)throw new Error("inconsistent CFB structure");C.FullPaths.length===0&&(C.FullPaths[0]=F+"/",C.FileIndex[0]={name:F,type:5}),D.CLSID&&(C.FileIndex[0].clsid=D.CLSID),Z(C)}function Z(C){var j="Sh33tJ5";if(!tt.find(C,"/"+j)){var D=xe(4);D[0]=55,D[1]=D[3]=50,D[2]=54,C.FileIndex.push({name:j,type:2,content:D,size:4,L:69,R:69,C:69}),C.FullPaths.push(C.FullPaths[0]+j),q(C)}}function q(C,j){N(C);for(var D=!1,F=!1,L=C.FullPaths.length-1;L>=0;--L){var H=C.FileIndex[L];switch(H.type){case 0:F?D=!0:(C.FileIndex.pop(),C.FullPaths.pop());break;case 1:case 2:case 5:F=!0,isNaN(H.R*H.L*H.C)&&(D=!0),H.R>-1&&H.L>-1&&H.R==H.L&&(D=!0);break;default:D=!0;break}}if(!(!D&&!j)){var ce=new Date(1987,1,19),ve=0,oe=Object.create?Object.create(null):{},ue=[];for(L=0;L<C.FullPaths.length;++L)oe[C.FullPaths[L]]=!0,C.FileIndex[L].type!==0&&ue.push([C.FullPaths[L],C.FileIndex[L]]);for(L=0;L<ue.length;++L){var fe=n(ue[L][0]);F=oe[fe],F||(ue.push([fe,{name:i(fe).replace("/",""),type:1,clsid:te,ct:ce,mt:ce,content:null}]),oe[fe]=!0)}for(ue.sort(function(ze,P){return r(ze[0],P[0])}),C.FullPaths=[],C.FileIndex=[],L=0;L<ue.length;++L)C.FullPaths[L]=ue[L][0],C.FileIndex[L]=ue[L][1];for(L=0;L<ue.length;++L){var Re=C.FileIndex[L],Me=C.FullPaths[L];if(Re.name=i(Me).replace("/",""),Re.L=Re.R=Re.C=-(Re.color=1),Re.size=Re.content?Re.content.length:0,Re.start=0,Re.clsid=Re.clsid||te,L===0)Re.C=ue.length>1?1:-1,Re.size=0,Re.type=5;else if(Me.slice(-1)=="/"){for(ve=L+1;ve<ue.length&&n(C.FullPaths[ve])!=Me;++ve);for(Re.C=ve>=ue.length?-1:ve,ve=L+1;ve<ue.length&&n(C.FullPaths[ve])!=n(Me);++ve);Re.R=ve>=ue.length?-1:ve,Re.type=1}else n(C.FullPaths[L+1]||"")==n(Me)&&(Re.R=L+1),Re.type=2}}}function he(C,j){var D=j||{};if(D.fileType=="mad")return ac(C,D);if(q(C),D.fileType==="zip")return qa(C,D);var F=(function(ze){for(var P=0,W=0,re=0;re<ze.FileIndex.length;++re){var ke=ze.FileIndex[re];if(ke.content){var De=ke.content.length;De>0&&(De<4096?P+=De+63>>6:W+=De+511>>9)}}for(var Fe=ze.FullPaths.length+3>>2,Le=P+7>>3,Ge=P+127>>7,$e=Le+W+Fe+Ge,Ve=$e+127>>7,Qe=Ve<=109?0:Math.ceil((Ve-109)/127);$e+Ve+Qe+127>>7>Ve;)Qe=++Ve<=109?0:Math.ceil((Ve-109)/127);var Je=[1,Qe,Ve,Ge,Fe,W,P,0];return ze.FileIndex[0].size=P<<6,Je[7]=(ze.FileIndex[0].start=Je[0]+Je[1]+Je[2]+Je[3]+Je[4]+Je[5])+(Je[6]+7>>3),Je})(C),L=xe(F[7]<<9),H=0,ce=0;{for(H=0;H<8;++H)L.write_shift(1,_e[H]);for(H=0;H<8;++H)L.write_shift(2,0);for(L.write_shift(2,62),L.write_shift(2,3),L.write_shift(2,65534),L.write_shift(2,9),L.write_shift(2,6),H=0;H<3;++H)L.write_shift(2,0);for(L.write_shift(4,0),L.write_shift(4,F[2]),L.write_shift(4,F[0]+F[1]+F[2]+F[3]-1),L.write_shift(4,0),L.write_shift(4,4096),L.write_shift(4,F[3]?F[0]+F[1]+F[2]-1:pe),L.write_shift(4,F[3]),L.write_shift(-4,F[1]?F[0]-1:pe),L.write_shift(4,F[1]),H=0;H<109;++H)L.write_shift(-4,H<F[2]?F[1]+H:-1)}if(F[1])for(ce=0;ce<F[1];++ce){for(;H<236+ce*127;++H)L.write_shift(-4,H<F[2]?F[1]+H:-1);L.write_shift(-4,ce===F[1]-1?pe:ce+1)}var ve=function(ze){for(ce+=ze;H<ce-1;++H)L.write_shift(-4,H+1);ze&&(++H,L.write_shift(-4,pe))};for(ce=H=0,ce+=F[1];H<ce;++H)L.write_shift(-4,se.DIFSECT);for(ce+=F[2];H<ce;++H)L.write_shift(-4,se.FATSECT);ve(F[3]),ve(F[4]);for(var oe=0,ue=0,fe=C.FileIndex[0];oe<C.FileIndex.length;++oe)fe=C.FileIndex[oe],fe.content&&(ue=fe.content.length,!(ue<4096)&&(fe.start=ce,ve(ue+511>>9)));for(ve(F[6]+7>>3);L.l&511;)L.write_shift(-4,se.ENDOFCHAIN);for(ce=H=0,oe=0;oe<C.FileIndex.length;++oe)fe=C.FileIndex[oe],fe.content&&(ue=fe.content.length,!(!ue||ue>=4096)&&(fe.start=ce,ve(ue+63>>6)));for(;L.l&511;)L.write_shift(-4,se.ENDOFCHAIN);for(H=0;H<F[4]<<2;++H){var Re=C.FullPaths[H];if(!Re||Re.length===0){for(oe=0;oe<17;++oe)L.write_shift(4,0);for(oe=0;oe<3;++oe)L.write_shift(4,-1);for(oe=0;oe<12;++oe)L.write_shift(4,0);continue}fe=C.FileIndex[H],H===0&&(fe.start=fe.size?fe.start-1:pe);var Me=H===0&&D.root||fe.name;if(ue=2*(Me.length+1),L.write_shift(64,Me,"utf16le"),L.write_shift(2,ue),L.write_shift(1,fe.type),L.write_shift(1,fe.color),L.write_shift(-4,fe.L),L.write_shift(-4,fe.R),L.write_shift(-4,fe.C),fe.clsid)L.write_shift(16,fe.clsid,"hex");else for(oe=0;oe<4;++oe)L.write_shift(4,0);L.write_shift(4,fe.state||0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,fe.start),L.write_shift(4,fe.size),L.write_shift(4,0)}for(H=1;H<C.FileIndex.length;++H)if(fe=C.FileIndex[H],fe.size>=4096)if(L.l=fe.start+1<<9,pt&&Buffer.isBuffer(fe.content))fe.content.copy(L,L.l,0,fe.size),L.l+=fe.size+511&-512;else{for(oe=0;oe<fe.size;++oe)L.write_shift(1,fe.content[oe]);for(;oe&511;++oe)L.write_shift(1,0)}for(H=1;H<C.FileIndex.length;++H)if(fe=C.FileIndex[H],fe.size>0&&fe.size<4096)if(pt&&Buffer.isBuffer(fe.content))fe.content.copy(L,L.l,0,fe.size),L.l+=fe.size+63&-64;else{for(oe=0;oe<fe.size;++oe)L.write_shift(1,fe.content[oe]);for(;oe&63;++oe)L.write_shift(1,0)}if(pt)L.l=L.length;else for(;L.l<L.length;)L.write_shift(1,0);return L}function Y(C,j){var D=C.FullPaths.map(function(oe){return oe.toUpperCase()}),F=D.map(function(oe){var ue=oe.split("/");return ue[ue.length-(oe.slice(-1)=="/"?2:1)]}),L=!1;j.charCodeAt(0)===47?(L=!0,j=D[0].slice(0,-1)+j):L=j.indexOf("/")!==-1;var H=j.toUpperCase(),ce=L===!0?D.indexOf(H):F.indexOf(H);if(ce!==-1)return C.FileIndex[ce];var ve=!H.match(Jc);for(H=H.replace(ha,""),ve&&(H=H.replace(Jc,"!")),ce=0;ce<D.length;++ce)if((ve?D[ce].replace(Jc,"!"):D[ce]).replace(ha,"")==H||(ve?F[ce].replace(Jc,"!"):F[ce]).replace(ha,"")==H)return C.FileIndex[ce];return null}var Q=64,pe=-2,Ce="d0cf11e0a1b11ae1",_e=[208,207,17,224,161,177,26,225],te="00000000000000000000000000000000",se={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:pe,FREESECT:-1,HEADER_SIGNATURE:Ce,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:te,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ge(C,j,D){d();var F=he(C,D);h.writeFileSync(j,F)}function J(C){for(var j=new Array(C.length),D=0;D<C.length;++D)j[D]=String.fromCharCode(C[D]);return j.join("")}function Oe(C,j){var D=he(C,j);switch(j&&j.type||"buffer"){case"file":return d(),h.writeFileSync(j.filename,D),D;case"binary":return typeof D=="string"?D:J(D);case"base64":return vo(typeof D=="string"?D:J(D));case"buffer":if(pt)return Buffer.isBuffer(D)?D:fi(D);case"array":return typeof D=="string"?Ha(D):D}return D}var I;function A(C){try{var j=C.InflateRaw,D=new j;if(D._processChunk(new Uint8Array([3,0]),D._finishFlushFlag),D.bytesRead)I=C;else throw new Error("zlib does not expose bytesRead")}catch(F){console.error("cannot use native zlib: "+(F.message||F))}}function z(C,j){if(!I)return Hs(C,j);var D=I.InflateRaw,F=new D,L=F._processChunk(C.slice(C.l),F._finishFlushFlag);return C.l+=F.bytesRead,L}function U(C){return I?I.deflateRawSync(C):ht(C)}var G=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ne=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],we=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Te(C){var j=(C<<1|C<<11)&139536|(C<<5|C<<15)&558144;return(j>>16|j>>8|j)&255}for(var Se=typeof Uint8Array<"u",Ne=Se?new Uint8Array(256):[],ot=0;ot<256;++ot)Ne[ot]=Te(ot);function V(C,j){var D=Ne[C&255];return j<=8?D>>>8-j:(D=D<<8|Ne[C>>8&255],j<=16?D>>>16-j:(D=D<<8|Ne[C>>16&255],D>>>24-j))}function Nt(C,j){var D=j&7,F=j>>>3;return(C[F]|(D<=6?0:C[F+1]<<8))>>>D&3}function lt(C,j){var D=j&7,F=j>>>3;return(C[F]|(D<=5?0:C[F+1]<<8))>>>D&7}function Tt(C,j){var D=j&7,F=j>>>3;return(C[F]|(D<=4?0:C[F+1]<<8))>>>D&15}function ft(C,j){var D=j&7,F=j>>>3;return(C[F]|(D<=3?0:C[F+1]<<8))>>>D&31}function je(C,j){var D=j&7,F=j>>>3;return(C[F]|(D<=1?0:C[F+1]<<8))>>>D&127}function zt(C,j,D){var F=j&7,L=j>>>3,H=(1<<D)-1,ce=C[L]>>>F;return D<8-F||(ce|=C[L+1]<<8-F,D<16-F)||(ce|=C[L+2]<<16-F,D<24-F)||(ce|=C[L+3]<<24-F),ce&H}function gr(C,j,D){var F=j&7,L=j>>>3;return F<=5?C[L]|=(D&7)<<F:(C[L]|=D<<F&255,C[L+1]=(D&7)>>8-F),j+3}function Kr(C,j,D){var F=j&7,L=j>>>3;return D=(D&1)<<F,C[L]|=D,j+1}function Fr(C,j,D){var F=j&7,L=j>>>3;return D<<=F,C[L]|=D&255,D>>>=8,C[L+1]=D,j+8}function Ga(C,j,D){var F=j&7,L=j>>>3;return D<<=F,C[L]|=D&255,D>>>=8,C[L+1]=D&255,C[L+2]=D>>>8,j+16}function da(C,j){var D=C.length,F=2*D>j?2*D:j+5,L=0;if(D>=j)return C;if(pt){var H=bv(F);if(C.copy)C.copy(H);else for(;L<C.length;++L)H[L]=C[L];return H}else if(Se){var ce=new Uint8Array(F);if(ce.set)ce.set(C);else for(;L<D;++L)ce[L]=C[L];return ce}return C.length=F,C}function _t(C){for(var j=new Array(C),D=0;D<C;++D)j[D]=0;return j}function Aa(C,j,D){var F=1,L=0,H=0,ce=0,ve=0,oe=C.length,ue=Se?new Uint16Array(32):_t(32);for(H=0;H<32;++H)ue[H]=0;for(H=oe;H<D;++H)C[H]=0;oe=C.length;var fe=Se?new Uint16Array(oe):_t(oe);for(H=0;H<oe;++H)ue[L=C[H]]++,F<L&&(F=L),fe[H]=0;for(ue[0]=0,H=1;H<=F;++H)ue[H+16]=ve=ve+ue[H-1]<<1;for(H=0;H<oe;++H)ve=C[H],ve!=0&&(fe[H]=ue[ve+16]++);var Re=0;for(H=0;H<oe;++H)if(Re=C[H],Re!=0)for(ve=V(fe[H],F)>>F-Re,ce=(1<<F+4-Re)-1;ce>=0;--ce)j[ve|ce<<Re]=Re&15|H<<4;return F}var Yr=Se?new Uint16Array(512):_t(512),Tn=Se?new Uint16Array(32):_t(32);if(!Se){for(var Mt=0;Mt<512;++Mt)Yr[Mt]=0;for(Mt=0;Mt<32;++Mt)Tn[Mt]=0}(function(){for(var C=[],j=0;j<32;j++)C.push(5);Aa(C,Tn,32);var D=[];for(j=0;j<=143;j++)D.push(8);for(;j<=255;j++)D.push(9);for(;j<=279;j++)D.push(7);for(;j<=287;j++)D.push(8);Aa(D,Yr,288)})();var Jr=(function(){for(var j=Se?new Uint8Array(32768):[],D=0,F=0;D<we.length-1;++D)for(;F<we[D+1];++F)j[F]=D;for(;F<32768;++F)j[F]=29;var L=Se?new Uint8Array(259):[];for(D=0,F=0;D<ne.length-1;++D)for(;F<ne[D+1];++F)L[F]=D;function H(ve,oe){for(var ue=0;ue<ve.length;){var fe=Math.min(65535,ve.length-ue),Re=ue+fe==ve.length;for(oe.write_shift(1,+Re),oe.write_shift(2,fe),oe.write_shift(2,~fe&65535);fe-- >0;)oe[oe.l++]=ve[ue++]}return oe.l}function ce(ve,oe){for(var ue=0,fe=0,Re=Se?new Uint16Array(32768):[];fe<ve.length;){var Me=Math.min(65535,ve.length-fe);if(Me<10){for(ue=gr(oe,ue,+(fe+Me==ve.length)),ue&7&&(ue+=8-(ue&7)),oe.l=ue/8|0,oe.write_shift(2,Me),oe.write_shift(2,~Me&65535);Me-- >0;)oe[oe.l++]=ve[fe++];ue=oe.l*8;continue}ue=gr(oe,ue,+(fe+Me==ve.length)+2);for(var ze=0;Me-- >0;){var P=ve[fe];ze=(ze<<5^P)&32767;var W=-1,re=0;if((W=Re[ze])&&(W|=fe&-32768,W>fe&&(W-=32768),W<fe))for(;ve[W+re]==ve[fe+re]&&re<250;)++re;if(re>2){P=L[re],P<=22?ue=Fr(oe,ue,Ne[P+1]>>1)-1:(Fr(oe,ue,3),ue+=5,Fr(oe,ue,Ne[P-23]>>5),ue+=3);var ke=P<8?0:P-4>>2;ke>0&&(Ga(oe,ue,re-ne[P]),ue+=ke),P=j[fe-W],ue=Fr(oe,ue,Ne[P]>>3),ue-=3;var De=P<4?0:P-2>>1;De>0&&(Ga(oe,ue,fe-W-we[P]),ue+=De);for(var Fe=0;Fe<re;++Fe)Re[ze]=fe&32767,ze=(ze<<5^ve[fe])&32767,++fe;Me-=re-1}else P<=143?P=P+48:ue=Kr(oe,ue,1),ue=Fr(oe,ue,Ne[P]),Re[ze]=fe&32767,++fe}ue=Fr(oe,ue,0)-1}return oe.l=(ue+7)/8|0,oe.l}return function(oe,ue){return oe.length<8?H(oe,ue):ce(oe,ue)}})();function ht(C){var j=xe(50+Math.floor(C.length*1.1)),D=Jr(C,j);return j.slice(0,D)}var Kt=Se?new Uint16Array(32768):_t(32768),Qr=Se?new Uint16Array(32768):_t(32768),qt=Se?new Uint16Array(128):_t(128),ar=1,Ca=1;function jr(C,j){var D=ft(C,j)+257;j+=5;var F=ft(C,j)+1;j+=5;var L=Tt(C,j)+4;j+=4;for(var H=0,ce=Se?new Uint8Array(19):_t(19),ve=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],oe=1,ue=Se?new Uint8Array(8):_t(8),fe=Se?new Uint8Array(8):_t(8),Re=ce.length,Me=0;Me<L;++Me)ce[G[Me]]=H=lt(C,j),oe<H&&(oe=H),ue[H]++,j+=3;var ze=0;for(ue[0]=0,Me=1;Me<=oe;++Me)fe[Me]=ze=ze+ue[Me-1]<<1;for(Me=0;Me<Re;++Me)(ze=ce[Me])!=0&&(ve[Me]=fe[ze]++);var P=0;for(Me=0;Me<Re;++Me)if(P=ce[Me],P!=0){ze=Ne[ve[Me]]>>8-P;for(var W=(1<<7-P)-1;W>=0;--W)qt[ze|W<<P]=P&7|Me<<3}var re=[];for(oe=1;re.length<D+F;)switch(ze=qt[je(C,j)],j+=ze&7,ze>>>=3){case 16:for(H=3+Nt(C,j),j+=2,ze=re[re.length-1];H-- >0;)re.push(ze);break;case 17:for(H=3+lt(C,j),j+=3;H-- >0;)re.push(0);break;case 18:for(H=11+je(C,j),j+=7;H-- >0;)re.push(0);break;default:re.push(ze),oe<ze&&(oe=ze);break}var ke=re.slice(0,D),De=re.slice(D);for(Me=D;Me<286;++Me)ke[Me]=0;for(Me=F;Me<30;++Me)De[Me]=0;return ar=Aa(ke,Kt,286),Ca=Aa(De,Qr,30),j}function tc(C,j){if(C[0]==3&&!(C[1]&3))return[Wi(j),2];for(var D=0,F=0,L=bv(j||1<<18),H=0,ce=L.length>>>0,ve=0,oe=0;(F&1)==0;){if(F=lt(C,D),D+=3,F>>>1)F>>1==1?(ve=9,oe=5):(D=jr(C,D),ve=ar,oe=Ca);else{D&7&&(D+=8-(D&7));var ue=C[D>>>3]|C[(D>>>3)+1]<<8;if(D+=32,ue>0)for(!j&&ce<H+ue&&(L=da(L,H+ue),ce=L.length);ue-- >0;)L[H++]=C[D>>>3],D+=8;continue}for(;;){!j&&ce<H+32767&&(L=da(L,H+32767),ce=L.length);var fe=zt(C,D,ve),Re=F>>>1==1?Yr[fe]:Kt[fe];if(D+=Re&15,Re>>>=4,(Re>>>8&255)===0)L[H++]=Re;else{if(Re==256)break;Re-=257;var Me=Re<8?0:Re-4>>2;Me>5&&(Me=0);var ze=H+ne[Re];Me>0&&(ze+=zt(C,D,Me),D+=Me),fe=zt(C,D,oe),Re=F>>>1==1?Tn[fe]:Qr[fe],D+=Re&15,Re>>>=4;var P=Re<4?0:Re-2>>1,W=we[Re];for(P>0&&(W+=zt(C,D,P),D+=P),!j&&ce<ze&&(L=da(L,ze+100),ce=L.length);H<ze;)L[H]=L[H-W],++H}}}return j?[L,D+7>>>3]:[L.slice(0,H),D+7>>>3]}function Hs(C,j){var D=C.slice(C.l||0),F=tc(D,j);return C.l+=F[1],F[0]}function Vs(C,j){if(C)typeof console<"u"&&console.error(j);else throw new Error(j)}function In(C,j){var D=C;Xr(D,0);var F=[],L=[],H={FileIndex:F,FullPaths:L};N(H,{root:j.root});for(var ce=D.length-4;(D[ce]!=80||D[ce+1]!=75||D[ce+2]!=5||D[ce+3]!=6)&&ce>=0;)--ce;D.l=ce+4,D.l+=4;var ve=D.read_shift(2);D.l+=6;var oe=D.read_shift(4);for(D.l=oe,ce=0;ce<ve;++ce){D.l+=20;var ue=D.read_shift(4),fe=D.read_shift(4),Re=D.read_shift(2),Me=D.read_shift(2),ze=D.read_shift(2);D.l+=8;var P=D.read_shift(4),W=u(D.slice(D.l+Re,D.l+Re+Me));D.l+=Re+Me+ze;var re=D.l;D.l=P+4,mi(D,ue,fe,H,W),D.l=re}return H}function mi(C,j,D,F,L){C.l+=2;var H=C.read_shift(2),ce=C.read_shift(2),ve=o(C);if(H&8257)throw new Error("Unsupported ZIP encryption");for(var oe=C.read_shift(4),ue=C.read_shift(4),fe=C.read_shift(4),Re=C.read_shift(2),Me=C.read_shift(2),ze="",P=0;P<Re;++P)ze+=String.fromCharCode(C[C.l++]);if(Me){var W=u(C.slice(C.l,C.l+Me));(W[21589]||{}).mt&&(ve=W[21589].mt),((L||{})[21589]||{}).mt&&(ve=L[21589].mt)}C.l+=Me;var re=C.slice(C.l,C.l+ue);switch(ce){case 8:re=z(C,fe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ce)}var ke=!1;H&8&&(oe=C.read_shift(4),oe==134695760&&(oe=C.read_shift(4),ke=!0),ue=C.read_shift(4),fe=C.read_shift(4)),ue!=j&&Vs(ke,"Bad compressed size: "+j+" != "+ue),fe!=D&&Vs(ke,"Bad uncompressed size: "+D+" != "+fe),kn(F,ze,re,{unsafe:!0,mt:ve})}function qa(C,j){var D=j||{},F=[],L=[],H=xe(1),ce=D.compression?8:0,ve=0,oe=0,ue=0,fe=0,Re=0,Me=C.FullPaths[0],ze=Me,P=C.FileIndex[0],W=[],re=0;for(oe=1;oe<C.FullPaths.length;++oe)if(ze=C.FullPaths[oe].slice(Me.length),P=C.FileIndex[oe],!(!P.size||!P.content||ze=="Sh33tJ5")){var ke=fe,De=xe(ze.length);for(ue=0;ue<ze.length;++ue)De.write_shift(1,ze.charCodeAt(ue)&127);De=De.slice(0,De.l),W[Re]=Xk.buf(P.content,0);var Fe=P.content;ce==8&&(Fe=U(Fe)),H=xe(30),H.write_shift(4,67324752),H.write_shift(2,20),H.write_shift(2,ve),H.write_shift(2,ce),P.mt?l(H,P.mt):H.write_shift(4,0),H.write_shift(-4,W[Re]),H.write_shift(4,Fe.length),H.write_shift(4,P.content.length),H.write_shift(2,De.length),H.write_shift(2,0),fe+=H.length,F.push(H),fe+=De.length,F.push(De),fe+=Fe.length,F.push(Fe),H=xe(46),H.write_shift(4,33639248),H.write_shift(2,0),H.write_shift(2,20),H.write_shift(2,ve),H.write_shift(2,ce),H.write_shift(4,0),H.write_shift(-4,W[Re]),H.write_shift(4,Fe.length),H.write_shift(4,P.content.length),H.write_shift(2,De.length),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(4,0),H.write_shift(4,ke),re+=H.l,L.push(H),re+=De.length,L.push(De),++Re}return H=xe(22),H.write_shift(4,101010256),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(2,Re),H.write_shift(2,Re),H.write_shift(4,re),H.write_shift(4,fe),H.write_shift(2,0),Ir([Ir(F),Ir(L),H])}var ma={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Xa(C,j){if(C.ctype)return C.ctype;var D=C.name||"",F=D.match(/\.([^\.]+)$/);return F&&ma[F[1]]||j&&(F=(D=j).match(/[\.\\]([^\.\\])+$/),F&&ma[F[1]])?ma[F[1]]:"application/octet-stream"}function Un(C){for(var j=vo(C),D=[],F=0;F<j.length;F+=76)D.push(j.slice(F,F+76));return D.join(`\r
`)+`\r
`}function rc(C){var j=C.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ue){var fe=ue.charCodeAt(0).toString(16).toUpperCase();return"="+(fe.length==1?"0"+fe:fe)});j=j.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),j.charAt(0)==`
`&&(j="=0D"+j.slice(1)),j=j.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var D=[],F=j.split(`\r
`),L=0;L<F.length;++L){var H=F[L];if(H.length==0){D.push("");continue}for(var ce=0;ce<H.length;){var ve=76,oe=H.slice(ce,ce+ve);oe.charAt(ve-1)=="="?ve--:oe.charAt(ve-2)=="="?ve-=2:oe.charAt(ve-3)=="="&&(ve-=3),oe=H.slice(ce,ce+ve),ce+=ve,ce<H.length&&(oe+="="),D.push(oe)}}return D.join(`\r
`)}function gi(C){for(var j=[],D=0;D<C.length;++D){for(var F=C[D];D<=C.length&&F.charAt(F.length-1)=="=";)F=F.slice(0,F.length-1)+C[++D];j.push(F)}for(var L=0;L<j.length;++L)j[L]=j[L].replace(/[=][0-9A-Fa-f]{2}/g,function(H){return String.fromCharCode(parseInt(H.slice(1),16))});return Ha(j.join(`\r
`))}function Na(C,j,D){for(var F="",L="",H="",ce,ve=0;ve<10;++ve){var oe=j[ve];if(!oe||oe.match(/^\s*$/))break;var ue=oe.match(/^(.*?):\s*([^\s].*)$/);if(ue)switch(ue[1].toLowerCase()){case"content-location":F=ue[2].trim();break;case"content-type":H=ue[2].trim();break;case"content-transfer-encoding":L=ue[2].trim();break}}switch(++ve,L.toLowerCase()){case"base64":ce=Ha($a(j.slice(ve).join("")));break;case"quoted-printable":ce=gi(j.slice(ve));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+L)}var fe=kn(C,F.slice(D.length),ce,{unsafe:!0});H&&(fe.ctype=H)}function jn(C,j){if(J(C.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var D=j&&j.root||"",F=(pt&&Buffer.isBuffer(C)?C.toString("binary"):J(C)).split(`\r
`),L=0,H="";for(L=0;L<F.length;++L)if(H=F[L],!!/^Content-Location:/i.test(H)&&(H=H.slice(H.indexOf("file")),D||(D=H.slice(0,H.lastIndexOf("/")+1)),H.slice(0,D.length)!=D))for(;D.length>0&&(D=D.slice(0,D.length-1),D=D.slice(0,D.lastIndexOf("/")+1),H.slice(0,D.length)!=D););var ce=(F[1]||"").match(/boundary="(.*?)"/);if(!ce)throw new Error("MAD cannot find boundary");var ve="--"+(ce[1]||""),oe=[],ue=[],fe={FileIndex:oe,FullPaths:ue};N(fe);var Re,Me=0;for(L=0;L<F.length;++L){var ze=F[L];ze!==ve&&ze!==ve+"--"||(Me++&&Na(fe,F.slice(Re,L),D),Re=L)}return fe}function ac(C,j){var D=j||{},F=D.boundary||"SheetJS";F="------="+F;for(var L=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+F.slice(2)+'"',"","",""],H=C.FullPaths[0],ce=H,ve=C.FileIndex[0],oe=1;oe<C.FullPaths.length;++oe)if(ce=C.FullPaths[oe].slice(H.length),ve=C.FileIndex[oe],!(!ve.size||!ve.content||ce=="Sh33tJ5")){ce=ce.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(re){return"_x"+re.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(re){return"_u"+re.charCodeAt(0).toString(16)+"_"});for(var ue=ve.content,fe=pt&&Buffer.isBuffer(ue)?ue.toString("binary"):J(ue),Re=0,Me=Math.min(1024,fe.length),ze=0,P=0;P<=Me;++P)(ze=fe.charCodeAt(P))>=32&&ze<128&&++Re;var W=Re>=Me*4/5;L.push(F),L.push("Content-Location: "+(D.root||"file:///C:/SheetJS/")+ce),L.push("Content-Transfer-Encoding: "+(W?"quoted-printable":"base64")),L.push("Content-Type: "+Xa(ve,ce)),L.push(""),L.push(W?rc(fe):Un(fe))}return L.push(F+`--\r
`),L.join(`\r
`)}function $s(C){var j={};return N(j,C),j}function kn(C,j,D,F){var L=F&&F.unsafe;L||N(C);var H=!L&&tt.find(C,j);if(!H){var ce=C.FullPaths[0];j.slice(0,ce.length)==ce?ce=j:(ce.slice(-1)!="/"&&(ce+="/"),ce=(ce+j).replace("//","/")),H={name:i(j),type:2},C.FileIndex.push(H),C.FullPaths.push(ce),L||tt.utils.cfb_gc(C)}return H.content=D,H.size=D?D.length:0,F&&(F.CLSID&&(H.clsid=F.CLSID),F.mt&&(H.mt=F.mt),F.ct&&(H.ct=F.ct)),H}function Wa(C,j){N(C);var D=tt.find(C,j);if(D){for(var F=0;F<C.FileIndex.length;++F)if(C.FileIndex[F]==D)return C.FileIndex.splice(F,1),C.FullPaths.splice(F,1),!0}return!1}function xi(C,j,D){N(C);var F=tt.find(C,j);if(F){for(var L=0;L<C.FileIndex.length;++L)if(C.FileIndex[L]==F)return C.FileIndex[L].name=i(D),C.FullPaths[L]=D,!0}return!1}function ga(C){q(C,!0)}return t.find=Y,t.read=M,t.parse=g,t.write=Oe,t.writeFile=ge,t.utils={cfb_new:$s,cfb_add:kn,cfb_del:Wa,cfb_mov:xi,cfb_gc:ga,ReadShift:to,CheckField:B_,prep_blob:Xr,bconcat:Ir,use_zlib:A,_deflateRaw:ht,_inflateRaw:Hs,consts:se},t})();function Wk(e){return typeof e=="string"?Pu(e):Array.isArray(e)?_k(e):e}function Do(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Pu(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Mn(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var i=new Blob([Wk(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,e);if(typeof saveAs<"u")return saveAs(i,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var l=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(l)},6e4),chrome.downloads.download({url:l,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=l,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(l)},6e4),l}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var u=File(e);return u.open("w"),u.encoding="binary",Array.isArray(t)&&(t=Qi(t)),u.write(t),u.close(),t}catch(h){if(!h.message||!h.message.match(/onstruct/))throw h}throw new Error("cannot save file "+e)}function Kk(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function dr(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function Ov(e,t){for(var r=[],n=dr(e),i=0;i!==n.length;++i)r[e[n[i]][t]]==null&&(r[e[n[i]][t]]=n[i]);return r}function Hu(e){for(var t=[],r=dr(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function Vu(e){for(var t=[],r=dr(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function Yk(e){for(var t=[],r=dr(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var Tu=new Date(1899,11,30,0,0,0);function Dr(e,t){var r=e.getTime(),n=Tu.getTime()+(e.getTimezoneOffset()-Tu.getTimezoneOffset())*6e4;return(r-n)/(1440*60*1e3)}var g_=new Date,Jk=Tu.getTime()+(g_.getTimezoneOffset()-Tu.getTimezoneOffset())*6e4,Rv=g_.getTimezoneOffset();function $u(e){var t=new Date;return t.setTime(e*24*60*60*1e3+Jk),t.getTimezoneOffset()!==Rv&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Rv)*6e4),t}function Qk(e){var t=0,r=0,n=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var l=1;l!=i.length;++l)if(i[l]){switch(r=1,l>3&&(n=!0),i[l].slice(i[l].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[l].slice(i[l].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(i[l],10)}return t}var Dv=new Date("2017-02-19T19:06:09.000Z"),x_=isNaN(Dv.getFullYear())?new Date("2/19/17"):Dv,Zk=x_.getFullYear()==2017;function er(e,t){var r=new Date(e);if(Zk)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(x_.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],l=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(l=new Date(l.getTime()-l.getTimezoneOffset()*60*1e3)),l}function Os(e,t){if(pt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Mn(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Mn(a_(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Mn(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Mn(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(l){return r[l]||l})}catch{}for(var n=[],i=0;i!=e.length;++i)n.push(String.fromCharCode(e[i]));return n.join("")}function tr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=tr(e[r]));return t}function fr(e,t){for(var r="";r.length<t;)r+=e;return r}function Sn(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,l){return r=-r,l}),!isNaN(t=Number(n)))?t/r:t}var eA=["january","february","march","april","may","june","july","august","september","october","november","december"];function ql(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),i=t.getMonth(),l=t.getDate();if(isNaN(l))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&eA.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||l>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var tA=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(e||typeof n=="string")return r.split(n);for(var l=r.split(n),o=[l[0]],u=1;u<l.length;++u)o.push(i),o.push(l[u]);return o}})();function p_(e){return e?e.content&&e.type?Os(e.content,!0):e.data?Yc(e.data):e.asNodeBuffer&&pt?Yc(e.asNodeBuffer().toString("binary")):e.asBinary?Yc(e.asBinary()):e._data&&e._data.getContent?Yc(Os(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function v_(e){if(!e)return null;if(e.data)return _v(e.data);if(e.asNodeBuffer&&pt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?_v(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function rA(e){return e&&e.name.slice(-4)===".bin"?v_(e):p_(e)}function cn(e,t){for(var r=e.FullPaths||dr(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),l=0;l<r.length;++l){var o=r[l].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||i==o)return e.files?e.files[r[l]]:e.FileIndex[l]}return null}function mm(e,t){var r=cn(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function kr(e,t,r){if(!r)return rA(mm(e,t));if(!t)return null;try{return kr(e,t)}catch{return null}}function Va(e,t,r){if(!r)return p_(mm(e,t));if(!t)return null;try{return Va(e,t)}catch{return null}}function aA(e,t,r){return v_(mm(e,t))}function Fv(e){for(var t=e.FullPaths||dr(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function xt(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return pt?n=fi(r):n=wk(r),tt.utils.cfb_add(e,t,n)}tt.utils.cfb_add(e,t,r)}else e.file(t,r)}function gm(){return tt.utils.cfb_new()}function y_(e,t){switch(t.type){case"base64":return tt.read(e,{type:"base64"});case"binary":return tt.read(e,{type:"binary"});case"buffer":case"array":return tt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Qc(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var _r=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,nA=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Mv=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,iA=/<[^>]*>/g,ca=_r.match(Mv)?Mv:iA,sA=/<\w*:/,lA=/<(\/?)\w+:/;function ct(e,t,r){for(var n={},i=0,l=0;i!==e.length&&!((l=e.charCodeAt(i))===32||l===10||l===13);++i);if(t||(n[0]=e.slice(0,i)),i===e.length)return n;var o=e.match(nA),u=0,h="",d=0,g="",p="",v=1;if(o)for(d=0;d!=o.length;++d){for(p=o[d],l=0;l!=p.length&&p.charCodeAt(l)!==61;++l);for(g=p.slice(0,l).trim();p.charCodeAt(l+1)==32;)++l;for(v=(i=p.charCodeAt(l+1))==34||i==39?1:0,h=p.slice(l+1+v,p.length-v),u=0;u!=g.length&&g.charCodeAt(u)!==58;++u);if(u===g.length)g.indexOf("_")>0&&(g=g.slice(0,g.indexOf("_"))),n[g]=h,n[g.toLowerCase()]=h;else{var _=(u===5&&g.slice(0,5)==="xmlns"?"xmlns":"")+g.slice(u+1);if(n[_]&&g.slice(u-3,u)=="ext")continue;n[_]=h,n[_.toLowerCase()]=h}}return n}function Ln(e){return e.replace(lA,"<$1")}var __={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},xm=Hu(__),At=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",l=i.indexOf("<![CDATA[");if(l==-1)return i.replace(e,function(u,h){return __[u]||String.fromCharCode(parseInt(h,u.indexOf("x")>-1?16:10))||u}).replace(t,function(u,h){return String.fromCharCode(parseInt(h,16))});var o=i.indexOf("]]>");return r(i.slice(0,l))+i.slice(l+9,o)+r(i.slice(o+3))}})(),pm=/[&<>'"]/g,cA=/[\u0000-\u0008\u000b-\u001f]/g;function Pt(e){var t=e+"";return t.replace(pm,function(r){return xm[r]}).replace(cA,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Lv(e){return Pt(e).replace(/ /g,"_x0020_")}var w_=/[\u0000-\u001f]/g;function vm(e){var t=e+"";return t.replace(pm,function(r){return xm[r]}).replace(/\n/g,"<br/>").replace(w_,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function oA(e){var t=e+"";return t.replace(pm,function(r){return xm[r]}).replace(w_,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var Bv=(function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}})();function uA(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Zt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function vd(e){for(var t="",r=0,n=0,i=0,l=0,o=0,u=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(i=e.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=i&63,t+=String.fromCharCode(o);continue}if(l=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(i&63)<<6|l&63);continue}o=e.charCodeAt(r++),u=((n&7)<<18|(i&63)<<12|(l&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(u>>>10&1023)),t+=String.fromCharCode(56320+(u&1023))}return t}function Iv(e){var t=Wi(2*e.length),r,n,i=1,l=0,o=0,u;for(n=0;n<e.length;n+=i)i=1,(u=e.charCodeAt(n))<128?r=u:u<224?(r=(u&31)*64+(e.charCodeAt(n+1)&63),i=2):u<240?(r=(u&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),i=3):(i=4,r=(u&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[l++]=o&255,t[l++]=o>>>8,o=0),t[l++]=r%256,t[l++]=r>>>8;return t.slice(0,l).toString("ucs2")}function Uv(e){return fi(e,"binary").toString("utf8")}var su="foo bar baz",Gt=pt&&(Uv(su)==vd(su)&&Uv||Iv(su)==vd(su)&&Iv)||vd,Mn=pt?function(e){return fi(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,i=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},_o=(function(){var e={};return function(r,n){var i=r+"|"+(n||"");return e[i]?e[i]:e[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}})(),b_=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)n=n.replace(e[i][0],e[i][1]);return n}})(),fA=(function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),hA=/<\/?(?:vt:)?variant>/g,dA=/<(?:vt:)([^>]*)>([\s\S]*)</;function jv(e,t){var r=ct(e),n=e.match(fA(r.baseType))||[],i=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(l){var o=l.replace(hA,"").match(dA);o&&i.push({v:Gt(o[2]),t:o[1]})}),i}var S_=/(^\s|\s$|\n)/;function Wr(e,t){return"<"+e+(t.match(S_)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function wo(e){return dr(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Be(e,t,r){return"<"+e+(r!=null?wo(r):"")+(t!=null?(t.match(S_)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Vd(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function mA(e,t){switch(typeof e){case"string":var r=Be("vt:lpwstr",Pt(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Be((e|0)==e?"vt:i4":"vt:r8",Pt(String(e)));case"boolean":return Be("vt:bool",e?"true":"false")}if(e instanceof Date)return Be("vt:filetime",Vd(e));throw new Error("Unable to serialize "+e)}function ym(e){if(pt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Gt(Qi(fm(e)));throw new Error("Bad input format: expected Buffer or string")}var bo=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Rr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Bs=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Ua={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function gA(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,l=5;l>=0;--l)i=i*256+e[t+l];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function xA(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,i=0,l=0,o=n?-t:t;isFinite(o)?o==0?i=l=0:(i=Math.floor(Math.log(o)/Math.LN2),l=o*Math.pow(2,52-i),i<=-1023&&(!isFinite(l)||l<Math.pow(2,52))?i=-1022:(l-=Math.pow(2,52),i+=1023)):(i=2047,l=isNaN(t)?26985:0);for(var u=0;u<=5;++u,l/=256)e[r+u]=l&255;e[r+6]=(i&15)<<4|l&15,e[r+7]=i>>4|n}var Pv=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,l=e[0][n].length;i<l;i+=r)t.push.apply(t,e[0][n].slice(i,i+r));return t},zv=pt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:fi(t)})):Pv(e)}:Pv,Hv=function(e,t,r){for(var n=[],i=t;i<r;i+=2)n.push(String.fromCharCode(ii(e,i)));return n.join("").replace(ha,"")},_m=pt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(ha,""):Hv(e,t,r)}:Hv,Vv=function(e,t,r){for(var n=[],i=t;i<t+r;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},E_=pt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Vv(e,t,r)}:Vv,$v=function(e,t,r){for(var n=[],i=t;i<r;i++)n.push(String.fromCharCode(Il(e,i)));return n.join("")},Fo=pt?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):$v(t,r,n)}:$v,T_=function(e,t){var r=ja(e,t);return r>0?Fo(e,t+4,t+4+r-1):""},k_=T_,A_=function(e,t){var r=ja(e,t);return r>0?Fo(e,t+4,t+4+r-1):""},C_=A_,N_=function(e,t){var r=2*ja(e,t);return r>0?Fo(e,t+4,t+4+r-1):""},O_=N_,R_=function(t,r){var n=ja(t,r);return n>0?_m(t,r+4,r+4+n):""},D_=R_,F_=function(e,t){var r=ja(e,t);return r>0?Fo(e,t+4,t+4+r):""},M_=F_,L_=function(e,t){return gA(e,t)},ku=L_,wm=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};pt&&(k_=function(t,r){if(!Buffer.isBuffer(t))return T_(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},C_=function(t,r){if(!Buffer.isBuffer(t))return A_(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},O_=function(t,r){if(!Buffer.isBuffer(t))return N_(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},D_=function(t,r){if(!Buffer.isBuffer(t))return R_(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},M_=function(t,r){if(!Buffer.isBuffer(t))return F_(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},ku=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):L_(t,r)},wm=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Il=function(e,t){return e[t]},ii=function(e,t){return e[t+1]*256+e[t]},pA=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},ja=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},bs=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},vA=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function to(e,t){var r="",n,i,l=[],o,u,h,d;switch(t){case"dbcs":if(d=this.l,pt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(h=0;h<e;++h)r+=String.fromCharCode(ii(this,d)),d+=2;e*=2;break;case"utf8":r=Fo(this,this.l,this.l+e);break;case"utf16le":e*=2,r=_m(this,this.l,this.l+e);break;case"wstr":return to.call(this,e,"dbcs");case"lpstr-ansi":r=k_(this,this.l),e=4+ja(this,this.l);break;case"lpstr-cp":r=C_(this,this.l),e=4+ja(this,this.l);break;case"lpwstr":r=O_(this,this.l),e=4+2*ja(this,this.l);break;case"lpp4":e=4+ja(this,this.l),r=D_(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+ja(this,this.l),r=M_(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=Il(this,this.l+e++))!==0;)l.push(iu(o));r=l.join("");break;case"_wstr":for(e=0,r="";(o=ii(this,this.l+e))!==0;)l.push(iu(o)),e+=2;e+=2,r=l.join("");break;case"dbcs-cont":for(r="",d=this.l,h=0;h<e;++h){if(this.lens&&this.lens.indexOf(d)!==-1)return o=Il(this,d),this.l=d+1,u=to.call(this,e-h,o?"dbcs-cont":"sbcs-cont"),l.join("")+u;l.push(iu(ii(this,d))),d+=2}r=l.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",d=this.l,h=0;h!=e;++h){if(this.lens&&this.lens.indexOf(d)!==-1)return o=Il(this,d),this.l=d+1,u=to.call(this,e-h,o?"dbcs-cont":"sbcs-cont"),l.join("")+u;l.push(iu(Il(this,d))),d+=1}r=l.join("");break;default:switch(e){case 1:return n=Il(this,this.l),this.l++,n;case 2:return n=(t==="i"?pA:ii)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(n=(e>0?bs:vA)(this,this.l),this.l+=4,n):(i=ja(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=ku(this,this.l):i=ku([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:r=E_(this,this.l,e);break}}return this.l+=e,r}var yA=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},_A=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},wA=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function bA(e,t,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=t.length;++i)wA(this,t.charCodeAt(i),this.l+2*i);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;n=t.length}else if(r==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var l=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var o=t.charCodeAt(i);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<l;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,yA(this,t,this.l);break;case 8:if(n=8,r==="f"){xA(this,t,this.l);break}case 16:break;case-4:n=4,_A(this,t,this.l);break}return this.l+=n,this}function B_(e,t){var r=E_(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Xr(e,t){e.l=t,e.read_shift=to,e.chk=B_,e.write_shift=bA}function la(e,t){e.l+=t}function xe(e){var t=Wi(e);return Xr(t,0),t}function hi(e,t,r){if(e){var n,i,l;Xr(e,e.l||0);for(var o=e.length,u=0,h=0;e.l<o;){u=e.read_shift(1),u&128&&(u=(u&127)+((e.read_shift(1)&127)<<7));var d=Co[u]||Co[65535];for(n=e.read_shift(1),l=n&127,i=1;i<4&&n&128;++i)l+=((n=e.read_shift(1))&127)<<7*i;h=e.l+l;var g=d.f&&d.f(e,l,r);if(e.l=h,t(g,d,u))return}}}function Ta(){var e=[],t=pt?256:2048,r=function(d){var g=xe(d);return Xr(g,0),g},n=r(t),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},l=function(d){return n&&d<n.length-n.l?n:(i(),n=r(Math.max(d+1,t)))},o=function(){return i(),Ir(e)},u=function(d){i(),n=d,n.l==null&&(n.l=n.length),l(t)};return{next:l,push:u,end:o,_bufs:e}}function Ae(e,t,r,n){var i=+t,l;if(!isNaN(i)){n||(n=Co[i].p||(r||[]).length||0),l=1+(i>=128?1:0)+1,n>=128&&++l,n>=16384&&++l,n>=2097152&&++l;var o=e.next(l);i<=127?o.write_shift(1,i):(o.write_shift(1,(i&127)+128),o.write_shift(1,i>>7));for(var u=0;u!=4;++u)if(n>=128)o.write_shift(1,(n&127)+128),n>>=7;else{o.write_shift(1,n);break}n>0&&wm(r)&&e.push(r)}}function ro(e,t,r){var n=tr(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Gv(e,t,r){var n=tr(e);return n.s=ro(n.s,t.s,r),n.e=ro(n.e,t.s,r),n}function ao(e,t){if(e.cRel&&e.c<0)for(e=tr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=tr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=st(e);return!e.cRel&&e.cRel!=null&&(r=TA(r)),!e.rRel&&e.rRel!=null&&(r=SA(r)),r}function yd(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+ir(e.s.c)+":"+(e.e.cRel?"":"$")+ir(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+yr(e.s.r)+":"+(e.e.rRel?"":"$")+yr(e.e.r):ao(e.s,t.biff)+":"+ao(e.e,t.biff)}function bm(e){return parseInt(EA(e),10)-1}function yr(e){return""+(e+1)}function SA(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function EA(e){return e.replace(/\$(\d+)$/,"$1")}function Sm(e){for(var t=kA(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function ir(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function TA(e){return e.replace(/^([A-Z])/,"$$$1")}function kA(e){return e.replace(/^\$([A-Z])/,"$1")}function AA(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function sr(e){for(var t=0,r=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function st(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function ka(e){var t=e.indexOf(":");return t==-1?{s:sr(e),e:sr(e)}:{s:sr(e.slice(0,t)),e:sr(e.slice(t+1))}}function mt(e,t){return typeof t>"u"||typeof t=="number"?mt(e.s,e.e):(typeof e!="string"&&(e=st(e)),typeof t!="string"&&(t=st(t)),e==t?e:e+":"+t)}function Ct(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,l=e.length;for(r=0;n<l&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.s.c=--r,r=0;n<l&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(t.s.r=--r,n===l||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=l&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.e.c=--r,r=0;n!=l&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return t.e.r=--r,t}function qv(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=fn(e.z,r?Dr(t):t)}catch{}try{return e.w=fn((e.XF||{}).numFmtId||(r?14:0),r?Dr(t):t)}catch{return""+t}}function oi(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?di[e.v]||e.v:t==null?qv(e,e.v):qv(e,t))}function Zi(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function I_(e,t,r){var n=r||{},i=e?Array.isArray(e):n.dense,l=e||(i?[]:{}),o=0,u=0;if(l&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var h=typeof n.origin=="string"?sr(n.origin):n.origin;o=h.r,u=h.c}l["!ref"]||(l["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(l["!ref"]){var g=Ct(l["!ref"]);d.s.c=g.s.c,d.s.r=g.s.r,d.e.c=Math.max(d.e.c,g.e.c),d.e.r=Math.max(d.e.r,g.e.r),o==-1&&(d.e.r=o=g.e.r+1)}for(var p=0;p!=t.length;++p)if(t[p]){if(!Array.isArray(t[p]))throw new Error("aoa_to_sheet expects an array of arrays");for(var v=0;v!=t[p].length;++v)if(!(typeof t[p][v]>"u")){var _={v:t[p][v]},w=o+p,y=u+v;if(d.s.r>w&&(d.s.r=w),d.s.c>y&&(d.s.c=y),d.e.r<w&&(d.e.r=w),d.e.c<y&&(d.e.c=y),t[p][v]&&typeof t[p][v]=="object"&&!Array.isArray(t[p][v])&&!(t[p][v]instanceof Date))_=t[p][v];else if(Array.isArray(_.v)&&(_.f=t[p][v][1],_.v=_.v[0]),_.v===null)if(_.f)_.t="n";else if(n.nullError)_.t="e",_.v=0;else if(n.sheetStubs)_.t="z";else continue;else typeof _.v=="number"?_.t="n":typeof _.v=="boolean"?_.t="b":_.v instanceof Date?(_.z=n.dateNF||it[14],n.cellDates?(_.t="d",_.w=fn(_.z,Dr(_.v))):(_.t="n",_.v=Dr(_.v),_.w=fn(_.z,_.v))):_.t="s";if(i)l[w]||(l[w]=[]),l[w][y]&&l[w][y].z&&(_.z=l[w][y].z),l[w][y]=_;else{var S=st({c:y,r:w});l[S]&&l[S].z&&(_.z=l[S].z),l[S]=_}}}return d.s.c<1e7&&(l["!ref"]=mt(d)),l}function Zl(e,t){return I_(null,e,t)}function CA(e){return e.read_shift(4,"i")}function En(e,t){return t||(t=xe(4)),t.write_shift(4,e),t}function sa(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Ur(e,t){var r=!1;return t==null&&(r=!0,t=xe(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function NA(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function OA(e,t){return t||(t=xe(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Em(e,t){var r=e.l,n=e.read_shift(1),i=sa(e),l=[],o={t:i,h:i};if((n&1)!==0){for(var u=e.read_shift(4),h=0;h!=u;++h)l.push(NA(e));o.r=l}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}function RA(e,t){var r=!1;return t==null&&(r=!0,t=xe(15+4*e.t.length)),t.write_shift(1,0),Ur(e.t,t),r?t.slice(0,t.l):t}var DA=Em;function FA(e,t){var r=!1;return t==null&&(r=!0,t=xe(23+4*e.t.length)),t.write_shift(1,1),Ur(e.t,t),t.write_shift(4,1),OA({},t),r?t.slice(0,t.l):t}function hn(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Is(e,t){return t==null&&(t=xe(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Us(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function js(e,t){return t==null&&(t=xe(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var MA=sa,U_=Ur;function Tm(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Au(e,t){var r=!1;return t==null&&(r=!0,t=xe(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var LA=sa,$d=Tm,km=Au;function Am(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var i=n===0?ku([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):bs(t,0)>>2;return r?i/100:i}function j_(e,t){t==null&&(t=xe(4));var r=0,n=0,i=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?i:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function P_(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function BA(e,t){return t||(t=xe(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Ps=P_,ec=BA;function ia(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Rs(e,t){return(t||xe(8)).write_shift(8,e,"f")}function IA(e){var t={},r=e.read_shift(1),n=r>>>1,i=e.read_shift(1),l=e.read_shift(2,"i"),o=e.read_shift(1),u=e.read_shift(1),h=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=i;var d=Ts[i];d&&(t.rgb=Eo(d));break;case 2:t.rgb=Eo([o,u,h]);break;case 3:t.theme=i;break}return l!=0&&(t.tint=l>0?l/32767:l/32768),t}function Cu(e,t){if(t||(t=xe(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function UA(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function jA(e,t){t||(t=xe(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function z_(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function PA(e){return z_(e,1)}function zA(e){return z_(e,2)}var Cm=2,Ea=3,lu=11,Xv=12,Nu=19,cu=64,HA=65,VA=71,$A=4108,GA=4126,Br=80,H_=81,qA=[Br,H_],Gd={1:{n:"CodePage",t:Cm},2:{n:"Category",t:Br},3:{n:"PresentationFormat",t:Br},4:{n:"ByteCount",t:Ea},5:{n:"LineCount",t:Ea},6:{n:"ParagraphCount",t:Ea},7:{n:"SlideCount",t:Ea},8:{n:"NoteCount",t:Ea},9:{n:"HiddenCount",t:Ea},10:{n:"MultimediaClipCount",t:Ea},11:{n:"ScaleCrop",t:lu},12:{n:"HeadingPairs",t:$A},13:{n:"TitlesOfParts",t:GA},14:{n:"Manager",t:Br},15:{n:"Company",t:Br},16:{n:"LinksUpToDate",t:lu},17:{n:"CharacterCount",t:Ea},19:{n:"SharedDoc",t:lu},22:{n:"HyperlinksChanged",t:lu},23:{n:"AppVersion",t:Ea,p:"version"},24:{n:"DigSig",t:HA},26:{n:"ContentType",t:Br},27:{n:"ContentStatus",t:Br},28:{n:"Language",t:Br},29:{n:"Version",t:Br},255:{},2147483648:{n:"Locale",t:Nu},2147483651:{n:"Behavior",t:Nu},1919054434:{}},qd={1:{n:"CodePage",t:Cm},2:{n:"Title",t:Br},3:{n:"Subject",t:Br},4:{n:"Author",t:Br},5:{n:"Keywords",t:Br},6:{n:"Comments",t:Br},7:{n:"Template",t:Br},8:{n:"LastAuthor",t:Br},9:{n:"RevNumber",t:Br},10:{n:"EditTime",t:cu},11:{n:"LastPrinted",t:cu},12:{n:"CreatedDate",t:cu},13:{n:"ModifiedDate",t:cu},14:{n:"PageCount",t:Ea},15:{n:"WordCount",t:Ea},16:{n:"CharCount",t:Ea},17:{n:"Thumbnail",t:VA},18:{n:"Application",t:Br},19:{n:"DocSecurity",t:Ea},255:{},2147483648:{n:"Locale",t:Nu},2147483651:{n:"Behavior",t:Nu},1919054434:{}},Wv={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},XA=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function WA(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var KA=WA([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Ts=tr(KA),di={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},V_={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Xd={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},ou={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Nm(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function YA(e){var t=Nm();if(!e||!e.match)return t;var r={};if((e.match(ca)||[]).forEach(function(n){var i=ct(n);switch(i[0].replace(sA,"<")){case"<?xml":break;case"<Types":t.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":t[Xd[i.ContentType]]!==void 0&&t[Xd[i.ContentType]].push(i.PartName);break}}),t.xmlns!==Rr.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function $_(e,t){var r=Yk(Xd),n=[],i;n[n.length]=_r,n[n.length]=Be("Types",null,{xmlns:Rr.CT,"xmlns:xsd":Rr.xsd,"xmlns:xsi":Rr.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(h){return Be("Default",null,{Extension:h[0],ContentType:h[1]})}));var l=function(h){e[h]&&e[h].length>0&&(i=e[h][0],n[n.length]=Be("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:ou[h][t.bookType]||ou[h].xlsx}))},o=function(h){(e[h]||[]).forEach(function(d){n[n.length]=Be("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:ou[h][t.bookType]||ou[h].xlsx})})},u=function(h){(e[h]||[]).forEach(function(d){n[n.length]=Be("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:r[h][0]})})};return l("workbooks"),o("sheets"),o("charts"),u("themes"),["strs","styles"].forEach(l),["coreprops","extprops","custprops"].forEach(u),u("vba"),u("comments"),u("threadedcomments"),u("drawings"),o("metadata"),u("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var yt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function So(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function no(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(ca)||[]).forEach(function(i){var l=ct(i);if(l[0]==="<Relationship"){var o={};o.Type=l.Type,o.Target=l.Target,o.Id=l.Id,l.TargetMode&&(o.TargetMode=l.TargetMode);var u=l.TargetMode==="External"?l.Target:Qc(l.Target,t);r[u]=o,n[l.Id]=o}}),r["!id"]=n,r}function Hl(e){var t=[_r,Be("Relationships",null,{xmlns:Rr.RELS})];return dr(e["!id"]).forEach(function(r){t[t.length]=Be("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function jt(e,t,r,n,i,l){if(i||(i={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,i.Id="rId"+t,i.Type=n,i.Target=r,[yt.HLINK,yt.XPATH,yt.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,t}var JA="application/vnd.oasis.opendocument.spreadsheet";function QA(e,t){for(var r=ym(e),n,i;n=bo.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=ct(n[0],!1),i.path=="/"&&i.type!==JA)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function ZA(e){var t=[_r];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function Kv(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function e3(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function t3(e){var t=[_r];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(Kv(e[r][0],e[r][1])),t.push(e3("",e[r][0]));return t.push(Kv("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function G_(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+wu.version+"</meta:generator></office:meta></office:document-meta>"}var un=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],r3=(function(){for(var e=new Array(un.length),t=0;t<un.length;++t){var r=un[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e})();function q_(e){var t={};e=Gt(e);for(var r=0;r<un.length;++r){var n=un[r],i=e.match(r3[r]);i!=null&&i.length>0&&(t[n[1]]=At(i[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=er(t[n[1]]))}return t}function _d(e,t,r,n,i){i[e]!=null||t==null||t===""||(i[e]=t,t=Pt(t),n[n.length]=r?Be(e,t,r):Wr(e,t))}function X_(e,t){var r=t||{},n=[_r,Be("cp:coreProperties",null,{"xmlns:cp":Rr.CORE_PROPS,"xmlns:dc":Rr.dc,"xmlns:dcterms":Rr.dcterms,"xmlns:dcmitype":Rr.dcmitype,"xmlns:xsi":Rr.xsi})],i={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&_d("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Vd(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),e.ModifiedDate!=null&&_d("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Vd(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var l=0;l!=un.length;++l){var o=un[l],u=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:e?e[o[1]]:null;u===!0?u="1":u===!1?u="0":typeof u=="number"&&(u=String(u)),u!=null&&_d(o[0],u,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var ks=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],W_=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function K_(e,t,r,n){var i=[];if(typeof e=="string")i=jv(e,n);else for(var l=0;l<e.length;++l)i=i.concat(e[l].map(function(g){return{v:g}}));var o=typeof t=="string"?jv(t,n).map(function(g){return g.v}):t,u=0,h=0;if(o.length>0)for(var d=0;d!==i.length;d+=2){switch(h=+i[d+1].v,i[d].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=h,r.SheetNames=o.slice(u,u+h);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=h,r.DefinedNames=o.slice(u,u+h);break;case"Charts":case"Diagramme":r.Chartsheets=h,r.ChartNames=o.slice(u,u+h);break}u+=h}}function a3(e,t,r){var n={};return t||(t={}),e=Gt(e),ks.forEach(function(i){var l=(e.match(_o(i[0]))||[])[1];switch(i[2]){case"string":l&&(t[i[1]]=At(l));break;case"bool":t[i[1]]=l==="true";break;case"raw":var o=e.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));o&&o.length>0&&(n[i[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&K_(n.HeadingPairs,n.TitlesOfParts,t,r),t}function Y_(e){var t=[],r=Be;return e||(e={}),e.Application="SheetJS",t[t.length]=_r,t[t.length]=Be("Properties",null,{xmlns:Rr.EXT_PROPS,"xmlns:vt":Rr.vt}),ks.forEach(function(n){if(e[n[1]]!==void 0){var i;switch(n[2]){case"string":i=Pt(String(e[n[1]]));break;case"bool":i=e[n[1]]?"true":"false";break}i!==void 0&&(t[t.length]=r(n[0],i))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Pt(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var n3=/<[^>]+>[^<]*/g;function i3(e,t){var r={},n="",i=e.match(n3);if(i)for(var l=0;l!=i.length;++l){var o=i[l],u=ct(o);switch(u[0]){case"<?xml":break;case"<Properties":break;case"<property":n=At(u.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var h=o.split(">"),d=h[0].slice(4),g=h[1];switch(d){case"lpstr":case"bstr":case"lpwstr":r[n]=At(g);break;case"bool":r[n]=Zt(g);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(g,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(g);break;case"filetime":case"date":r[n]=er(g);break;case"cy":case"error":r[n]=At(g);break;default:if(d.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,d,h)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return r}function J_(e){var t=[_r,Be("Properties",null,{xmlns:Rr.CUST_PROPS,"xmlns:vt":Rr.vt})];if(!e)return t.join("");var r=1;return dr(e).forEach(function(i){++r,t[t.length]=Be("property",mA(e[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Pt(i)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Wd={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},wd;function s3(e,t,r){wd||(wd=Hu(Wd)),t=wd[t]||t,e[t]=r}function l3(e,t){var r=[];return dr(Wd).map(function(n){for(var i=0;i<un.length;++i)if(un[i][1]==n)return un[i];for(i=0;i<ks.length;++i)if(ks[i][1]==n)return ks[i];throw n}).forEach(function(n){if(e[n[1]]!=null){var i=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];n[2]==="date"&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"Z")),typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(Wr(Wd[n[1]]||n[1],i))}}),Be("DocumentProperties",r.join(""),{xmlns:Ua.o})}function c3(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return e&&dr(e).forEach(function(l){if(Object.prototype.hasOwnProperty.call(e,l)){for(var o=0;o<un.length;++o)if(l==un[o][1])return;for(o=0;o<ks.length;++o)if(l==ks[o][1])return;for(o=0;o<r.length;++o)if(l==r[o])return;var u=e[l],h="string";typeof u=="number"?(h="float",u=String(u)):u===!0||u===!1?(h="boolean",u=u?"1":"0"):u=String(u),i.push(Be(Lv(l),u,{"dt:dt":h}))}}),t&&dr(t).forEach(function(l){if(Object.prototype.hasOwnProperty.call(t,l)&&!(e&&Object.prototype.hasOwnProperty.call(e,l))){var o=t[l],u="string";typeof o=="number"?(u="float",o=String(o)):o===!0||o===!1?(u="boolean",o=o?"1":"0"):o instanceof Date?(u="dateTime.tz",o=o.toISOString()):o=String(o),i.push(Be(Lv(l),o,{"dt:dt":u}))}}),"<"+n+' xmlns="'+Ua.o+'">'+i.join("")+"</"+n+">"}function Om(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function o3(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var l=n/Math.pow(2,32)|0;l>0&&(n=n%Math.pow(2,32),i+=l);var o=xe(8);return o.write_shift(4,n),o.write_shift(4,i),o}function Q_(e,t,r){var n=e.l,i=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return i}function Z_(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function e2(e,t,r){return t===31?Z_(e):Q_(e,t,r)}function Kd(e,t,r){return e2(e,t,r===!1?0:4)}function u3(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return e2(e,t,0)}function f3(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var i=e.l;r[n]=e.read_shift(0,"lpwstr").replace(ha,""),e.l-i&2&&(e.l+=2)}return r}function h3(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(ha,"");return r}function d3(e){var t=e.l,r=Ou(e,H_);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=Ou(e,Ea);return[r,n]}function m3(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(d3(e));return r}function Yv(e,t){for(var r=e.read_shift(4),n={},i=0;i!=r;++i){var l=e.read_shift(4),o=e.read_shift(4);n[l]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(ha,"").replace(Jc,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function t2(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function g3(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Ou(e,t,r){var n=e.read_shift(2),i,l=r||{};if(e.l+=2,t!==Xv&&n!==t&&qA.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===Xv?n:t){case 2:return i=e.read_shift(2,"i"),l.raw||(e.l+=2),i;case 3:return i=e.read_shift(4,"i"),i;case 11:return e.read_shift(4)!==0;case 19:return i=e.read_shift(4),i;case 30:return Q_(e,n,4).replace(ha,"");case 31:return Z_(e);case 64:return Om(e);case 65:return t2(e);case 71:return g3(e);case 80:return Kd(e,n,!l.raw).replace(ha,"");case 81:return u3(e,n).replace(ha,"");case 4108:return m3(e);case 4126:case 4127:return n==4127?f3(e):h3(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function Jv(e,t){var r=xe(4),n=xe(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=xe(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=o3(t);break;case 31:case 80:for(n=xe(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Ir([r,n])}function Qv(e,t){var r=e.l,n=e.read_shift(4),i=e.read_shift(4),l=[],o=0,u=0,h=-1,d={};for(o=0;o!=i;++o){var g=e.read_shift(4),p=e.read_shift(4);l[o]=[g,p+r]}l.sort(function(R,T){return R[1]-T[1]});var v={};for(o=0;o!=i;++o){if(e.l!==l[o][1]){var _=!0;if(o>0&&t)switch(t[l[o-1][0]].t){case 2:e.l+2===l[o][1]&&(e.l+=2,_=!1);break;case 80:e.l<=l[o][1]&&(e.l=l[o][1],_=!1);break;case 4108:e.l<=l[o][1]&&(e.l=l[o][1],_=!1);break}if((!t||o==0)&&e.l<=l[o][1]&&(_=!1,e.l=l[o][1]),_)throw new Error("Read Error: Expected address "+l[o][1]+" at "+e.l+" :"+o)}if(t){var w=t[l[o][0]];if(v[w.n]=Ou(e,w.t,{raw:!0}),w.p==="version"&&(v[w.n]=String(v[w.n]>>16)+"."+("0000"+String(v[w.n]&65535)).slice(-4)),w.n=="CodePage")switch(v[w.n]){case 0:v[w.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:wn(u=v[w.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+v[w.n])}}else if(l[o][0]===1){if(u=v.CodePage=Ou(e,Cm),wn(u),h!==-1){var y=e.l;e.l=l[h][1],d=Yv(e,u),e.l=y}}else if(l[o][0]===0){if(u===0){h=o,e.l=l[o+1][1];continue}d=Yv(e,u)}else{var S=d[l[o][0]],k;switch(e[e.l]){case 65:e.l+=4,k=t2(e);break;case 30:e.l+=4,k=Kd(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,k=Kd(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,k=e.read_shift(4,"i");break;case 19:e.l+=4,k=e.read_shift(4);break;case 5:e.l+=4,k=e.read_shift(8,"f");break;case 11:e.l+=4,k=vr(e,4);break;case 64:e.l+=4,k=er(Om(e));break;default:throw new Error("unparsed value: "+e[e.l])}v[S]=k}}return e.l=r+n,v}var r2=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function x3(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Zv(e,t,r){var n=xe(8),i=[],l=[],o=8,u=0,h=xe(8),d=xe(8);if(h.write_shift(4,2),h.write_shift(4,1200),d.write_shift(4,1),l.push(h),i.push(d),o+=8+h.length,!t){d=xe(8),d.write_shift(4,0),i.unshift(d);var g=[xe(4)];for(g[0].write_shift(4,e.length),u=0;u<e.length;++u){var p=e[u][0];for(h=xe(8+2*(p.length+1)+(p.length%2?0:2)),h.write_shift(4,u+2),h.write_shift(4,p.length+1),h.write_shift(0,p,"dbcs");h.l!=h.length;)h.write_shift(1,0);g.push(h)}h=Ir(g),l.unshift(h),o+=8+h.length}for(u=0;u<e.length;++u)if(!(t&&!t[e[u][0]])&&!(r2.indexOf(e[u][0])>-1||W_.indexOf(e[u][0])>-1)&&e[u][1]!=null){var v=e[u][1],_=0;if(t){_=+t[e[u][0]];var w=r[_];if(w.p=="version"&&typeof v=="string"){var y=v.split(".");v=(+y[0]<<16)+(+y[1]||0)}h=Jv(w.t,v)}else{var S=x3(v);S==-1&&(S=31,v=String(v)),h=Jv(S,v)}l.push(h),d=xe(8),d.write_shift(4,t?_:2+u),i.push(d),o+=8+h.length}var k=8*(l.length+1);for(u=0;u<l.length;++u)i[u].write_shift(4,k),k+=l[u].length;return n.write_shift(4,o),n.write_shift(4,l.length),Ir([n].concat(i).concat(l))}function ey(e,t,r){var n=e.content;if(!n)return{};Xr(n,0);var i,l,o,u,h=0;n.chk("feff","Byte Order: "),n.read_shift(2);var d=n.read_shift(4),g=n.read_shift(16);if(g!==tt.utils.consts.HEADER_CLSID&&g!==r)throw new Error("Bad PropertySet CLSID "+g);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(l=n.read_shift(16),u=n.read_shift(4),i===1&&u!==n.l)throw new Error("Length mismatch: "+u+" !== "+n.l);i===2&&(o=n.read_shift(16),h=n.read_shift(4));var p=Qv(n,t),v={SystemIdentifier:d};for(var _ in p)v[_]=p[_];if(v.FMTID=l,i===1)return v;if(h-n.l==2&&(n.l+=2),n.l!==h)throw new Error("Length mismatch 2: "+n.l+" !== "+h);var w;try{w=Qv(n,null)}catch{}for(_ in w)v[_]=w[_];return v.FMTID=[l,o],v}function ty(e,t,r,n,i,l){var o=xe(i?68:48),u=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,tt.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,i?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,i?68:48);var h=Zv(e,r,n);if(u.push(h),i){var d=Zv(i,null,null);o.write_shift(16,l,"hex"),o.write_shift(4,68+h.length),u.push(d)}return Ir(u)}function Pi(e,t){return e.read_shift(t),null}function p3(e,t){t||(t=xe(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function v3(e,t,r){for(var n=[],i=e.l+t;e.l<i;)n.push(r(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return n}function vr(e,t){return e.read_shift(t)===1}function fa(e,t){return t||(t=xe(2)),t.write_shift(2,+!!e),t}function Ar(e){return e.read_shift(2,"u")}function on(e,t){return t||(t=xe(2)),t.write_shift(2,e),t}function a2(e,t){return v3(e,t,Ar)}function y3(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function n2(e,t,r){return r||(r=xe(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function Mo(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var l=e.read_shift(1);l&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var o=n?e.read_shift(n,i):"";return o}function _3(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,i=r&8,l=1+(r&1),o=0,u,h={};i&&(o=e.read_shift(2)),n&&(u=e.read_shift(4));var d=l==2?"dbcs-cont":"sbcs-cont",g=t===0?"":e.read_shift(t,d);return i&&(e.l+=4*o),n&&(e.l+=u),h.t=g,i||(h.raw="<t>"+h.t+"</t>",h.r=h.t),h}function w3(e){var t=e.t||"",r=xe(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=xe(2*t.length);n.write_shift(2*t.length,t,"utf16le");var i=[r,n];return Ir(i)}function Ds(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function Lo(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):Ds(e,n,r)}function zs(e,t,r){if(r.biff>5)return Lo(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function i2(e,t,r){return r||(r=xe(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function b3(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function S3(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var i=e.read_shift((n?t-24:t)>>1,"utf16le").replace(ha,"");return n&&(e.l+=24),i}function E3(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=e.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var l=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(l>>1,"utf16le").replace(ha,"");return r+o}function T3(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return S3(e);case"0303000000000000c000000000000046":return E3(e);default:throw new Error("Unsupported Moniker "+r)}}function uu(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(ha,""):"";return r}function ry(e,t){t||(t=xe(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function k3(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=e.read_shift(2);e.l+=2;var l,o,u,h,d="",g,p;i&16&&(l=uu(e,r-e.l)),i&128&&(o=uu(e,r-e.l)),(i&257)===257&&(u=uu(e,r-e.l)),(i&257)===1&&(h=T3(e,r-e.l)),i&8&&(d=uu(e,r-e.l)),i&32&&(g=e.read_shift(16)),i&64&&(p=Om(e)),e.l=r;var v=o||u||h||"";v&&d&&(v+="#"+d),v||(v="#"+d),i&2&&v.charAt(0)=="/"&&v.charAt(1)!="/"&&(v="file://"+v);var _={Target:v};return g&&(_.guid=g),p&&(_.time=p),l&&(_.Tooltip=l),_}function A3(e){var t=xe(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),l=i>-1?31:23;switch(n.charAt(0)){case"#":l=28;break;case".":l&=-3;break}t.write_shift(4,2),t.write_shift(4,l);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)t.write_shift(4,o[r]);if(l==28)n=n.slice(1),ry(n,t);else if(l&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));var u=i>-1?n.slice(0,i):n;for(t.write_shift(4,2*(u.length+1)),r=0;r<u.length;++r)t.write_shift(2,u.charCodeAt(r));t.write_shift(2,0),l&8&&ry(i>-1?n.slice(i+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));for(var h=0;n.slice(h*3,h*3+3)=="../"||n.slice(h*3,h*3+3)=="..\\";)++h;for(t.write_shift(2,h),t.write_shift(4,n.length-3*h+1),r=0;r<n.length-3*h;++r)t.write_shift(1,n.charCodeAt(r+3*h)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function s2(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),i=e.read_shift(1);return[t,r,n,i]}function l2(e,t){var r=s2(e);return r[3]=0,r}function Bn(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function Fs(e,t,r,n){return n||(n=xe(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function C3(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function N3(e,t,r){return t===0?"":zs(e,t,r)}function O3(e,t,r){var n=r.biff>8?4:2,i=e.read_shift(n),l=e.read_shift(n,"i"),o=e.read_shift(n,"i");return[i,l,o]}function c2(e){var t=e.read_shift(2),r=Am(e);return[t,r]}function R3(e,t,r){e.l+=4,t-=4;var n=e.l+t,i=Mo(e,t,r),l=e.read_shift(2);if(n-=e.l,l!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+l);return e.l+=l,i}function Gu(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);return{s:{c:n,r:t},e:{c:i,r}}}function o2(e,t){return t||(t=xe(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function u2(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),i=e.read_shift(1);return{s:{c:n,r:t},e:{c:i,r}}}var D3=u2;function f2(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function F3(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function M3(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function ta(e){e.l+=2,e.l+=e.read_shift(2)}var L3={0:ta,4:ta,5:ta,6:ta,7:M3,8:ta,9:ta,10:ta,11:ta,12:ta,13:F3,14:ta,15:ta,16:ta,17:ta,18:ta,19:ta,20:ta,21:f2};function B3(e,t){for(var r=e.l+t,n=[];e.l<r;){var i=e.read_shift(2);e.l-=2;try{n.push(L3[i](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function fu(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function Rm(e,t,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var l=xe(i);return l.write_shift(2,n),l.write_shift(2,t),i>4&&l.write_shift(2,29282),i>6&&l.write_shift(2,1997),i>8&&(l.write_shift(2,49161),l.write_shift(2,1),l.write_shift(2,1798),l.write_shift(2,0)),l}function I3(e,t){return t===0||e.read_shift(2),1200}function U3(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,i=zs(e,0,r);return e.read_shift(t+n-e.l),i}function j3(e,t){var r=!t||t.biff==8,n=xe(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function P3(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function z3(e,t,r){var n=e.read_shift(4),i=e.read_shift(1)&3,l=e.read_shift(1);switch(l){case 0:l="Worksheet";break;case 1:l="Macrosheet";break;case 2:l="Chartsheet";break;case 6:l="VBAModule";break}var o=Mo(e,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:i,dt:l,name:o}}function H3(e,t){var r=!t||t.biff>=8?2:1,n=xe(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function V3(e,t){for(var r=e.l+t,n=e.read_shift(4),i=e.read_shift(4),l=[],o=0;o!=i&&e.l<r;++o)l.push(_3(e));return l.Count=n,l.Unique=i,l}function $3(e,t){var r=xe(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],i=0;i<e.length;++i)n[i]=w3(e[i]);var l=Ir([r].concat(n));return l.parts=[r.length].concat(n.map(function(o){return o.length})),l}function G3(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function q3(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function X3(e){var t=C3(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function W3(e){return e.read_shift(2),e.read_shift(4)}function ay(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var i=e.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var l={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[l,i]}function K3(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),l=e.read_shift(2),o=e.read_shift(2),u=e.read_shift(2),h=e.read_shift(2),d=e.read_shift(2);return{Pos:[t,r],Dim:[n,i],Flags:l,CurTab:o,FirstTab:u,Selected:h,TabRatio:d}}function Y3(){var e=xe(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function J3(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function Q3(e){var t=xe(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function Z3(){}function eC(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=Mo(e,0,r),n}function tC(e,t){var r=e.name||"Arial",n=t&&t.biff==5,i=n?15+r.length:16+2*r.length,l=xe(i);return l.write_shift(2,e.sz*20),l.write_shift(4,0),l.write_shift(2,400),l.write_shift(4,0),l.write_shift(2,0),l.write_shift(1,r.length),n||l.write_shift(1,1),l.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),l}function rC(e){var t=Bn(e);return t.isst=e.read_shift(4),t}function aC(e,t,r,n){var i=xe(10);return Fs(e,t,n,i),i.write_shift(4,r),i}function nC(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,i=Bn(e);r.biff==2&&e.l++;var l=Lo(e,n-e.l,r);return i.val=l,i}function iC(e,t,r,n,i){var l=!i||i.biff==8,o=xe(8+ +l+(1+l)*r.length);return Fs(e,t,n,o),o.write_shift(2,r.length),l&&o.write_shift(1,1),o.write_shift((1+l)*r.length,r,l?"utf16le":"sbcs"),o}function sC(e,t,r){var n=e.read_shift(2),i=zs(e,0,r);return[n,i]}function lC(e,t,r,n){var i=r&&r.biff==5;n||(n=xe(i?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(i?1:2,t.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le");var l=n.length>n.l?n.slice(0,n.l):n;return l.l==null&&(l.l=l.length),l}var cC=zs;function ny(e,t,r){var n=e.l+t,i=r.biff==8||!r.biff?4:2,l=e.read_shift(i),o=e.read_shift(i),u=e.read_shift(2),h=e.read_shift(2);return e.l=n,{s:{r:l,c:u},e:{r:o,c:h}}}function oC(e,t){var r=t.biff==8||!t.biff?4:2,n=xe(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function uC(e){var t=e.read_shift(2),r=e.read_shift(2),n=c2(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function fC(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),l=[];e.l<r;)l.push(c2(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(l.length!=o-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:o,rkrec:l}}function hC(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),l=[];e.l<r;)l.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(l.length!=o-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:o,ixfe:l}}function dC(e,t,r,n){var i={},l=e.read_shift(4),o=e.read_shift(4),u=e.read_shift(4),h=e.read_shift(2);return i.patternType=XA[u>>26],n.cellStyles&&(i.alc=l&7,i.fWrap=l>>3&1,i.alcV=l>>4&7,i.fJustLast=l>>7&1,i.trot=l>>8&255,i.cIndent=l>>16&15,i.fShrinkToFit=l>>20&1,i.iReadOrder=l>>22&2,i.fAtrNum=l>>26&1,i.fAtrFnt=l>>27&1,i.fAtrAlc=l>>28&1,i.fAtrBdr=l>>29&1,i.fAtrPat=l>>30&1,i.fAtrProt=l>>31&1,i.dgLeft=o&15,i.dgRight=o>>4&15,i.dgTop=o>>8&15,i.dgBottom=o>>12&15,i.icvLeft=o>>16&127,i.icvRight=o>>23&127,i.grbitDiag=o>>30&3,i.icvTop=u&127,i.icvBottom=u>>7&127,i.icvDiag=u>>14&127,i.dgDiag=u>>21&15,i.icvFore=h&127,i.icvBack=h>>7&127,i.fsxButton=h>>14&1),i}function mC(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=dC(e,t,n.fStyle,r),n}function iy(e,t,r,n){var i=r&&r.biff==5;n||(n=xe(i?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var l=0;return e.numFmtId>0&&i&&(l|=1024),n.write_shift(4,l),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function gC(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function xC(e){var t=xe(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function sy(e,t,r){var n=Bn(e);(r.biff==2||t==9)&&++e.l;var i=y3(e);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function pC(e,t,r,n,i,l){var o=xe(8);return Fs(e,t,n,o),n2(r,l,o),o}function vC(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Bn(e),i=ia(e);return n.val=i,n}function yC(e,t,r,n){var i=xe(14);return Fs(e,t,n,i),Rs(r,i),i}var ly=N3;function _C(e,t,r){var n=e.l+t,i=e.read_shift(2),l=e.read_shift(2);if(r.sbcch=l,l==1025||l==14849)return[l,i];if(l<1||l>255)throw new Error("Unexpected SupBook type: "+l);for(var o=Ds(e,l),u=[];n>e.l;)u.push(Lo(e));return[l,i,o,u]}function cy(e,t,r){var n=e.read_shift(2),i,l={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=R3(e,t-2,r)),l.body=i||e.read_shift(t-2),typeof i=="string"&&(l.Name=i),l}var wC=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function oy(e,t,r){var n=e.l+t,i=e.read_shift(2),l=e.read_shift(1),o=e.read_shift(1),u=e.read_shift(r&&r.biff==2?1:2),h=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),h=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var d=Ds(e,o,r);i&32&&(d=wC[d.charCodeAt(0)]);var g=n-e.l;r&&r.biff==2&&--g;var p=n==e.l||u===0||!(g>0)?[]:BO(e,g,r,u);return{chKey:l,Name:d,itab:h,rgce:p}}function h2(e,t,r){if(r.biff<8)return bC(e,t,r);for(var n=[],i=e.l+t,l=e.read_shift(r.biff>8?4:2);l--!==0;)n.push(O3(e,r.biff>8?12:6,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function bC(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=Mo(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function SC(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),i=e.read_shift(2),l=Ds(e,n,r),o=Ds(e,i,r);return[l,o]}function EC(e,t,r){var n=u2(e);e.l++;var i=e.read_shift(1);return t-=8,[IO(e,t,r),i,n]}function uy(e,t,r){var n=D3(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,MO(e,t,r)]}function TC(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function kC(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),i=e.read_shift(2),l=e.read_shift(2),o=e.read_shift(2),u=zs(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:i},u,o,l]}}function AC(e,t,r){return kC(e,t,r)}function CC(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(Gu(e));return r}function NC(e){var t=xe(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)o2(e[r],t);return t}function OC(e,t,r){if(r&&r.biff<8)return DC(e,t,r);var n=f2(e),i=B3(e,t-22,n[1]);return{cmo:n,ft:i}}var RC={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=r,{fmt:n}}};function DC(e,t,r){e.l+=4;var n=e.read_shift(2),i=e.read_shift(2),l=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((RC[n]||la)(e,t,r)),{cmo:[i,n,l],ft:o}}function FC(e,t,r){var n=e.l,i="";try{e.l+=4;var l=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(l)==-1?e.l+=6:o=b3(e,6,r);var u=e.read_shift(2);e.read_shift(2),Ar(e,2);var h=e.read_shift(2);e.l+=h;for(var d=1;d<e.lens.length-1;++d){if(e.l-n!=e.lens[d])throw new Error("TxO: bad continue record");var g=e[e.l],p=Ds(e,e.lens[d+1]-e.lens[d]-1);if(i+=p,i.length>=(g?u:2*u))break}if(i.length!==u&&i.length!==u*2)throw new Error("cchText: "+u+" != "+i.length);return e.l=n+t,{t:i}}catch{return e.l=n+t,{t:i}}}function MC(e,t){var r=Gu(e);e.l+=16;var n=k3(e,t-24);return[r,n]}function LC(e){var t=xe(24),r=sr(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)t.write_shift(1,parseInt(n[i],16));return Ir([t,A3(e[1])])}function BC(e,t){e.read_shift(2);var r=Gu(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(ha,""),[r,n]}function IC(e){var t=e[1].Tooltip,r=xe(10+2*(t.length+1));r.write_shift(2,2048);var n=sr(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<t.length;++i)r.write_shift(2,t.charCodeAt(i));return r.write_shift(2,0),r}function UC(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=Wv[r]||r,r=e.read_shift(2),t[1]=Wv[r]||r,t}function jC(e){return e||(e=xe(4)),e.write_shift(2,1),e.write_shift(2,1),e}function PC(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(l2(e));return r}function zC(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(l2(e));return r}function HC(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function d2(e,t,r){if(!r.cellStyles)return la(e,t);var n=r&&r.biff>=12?4:2,i=e.read_shift(n),l=e.read_shift(n),o=e.read_shift(n),u=e.read_shift(n),h=e.read_shift(2);n==2&&(e.l+=2);var d={s:i,e:l,w:o,ixfe:u,flags:h};return(r.biff>=5||!r.biff)&&(d.level=h>>8&7),d}function VC(e,t){var r=xe(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function $C(e,t){var r={};return t<32||(e.l+=16,r.header=ia(e),r.footer=ia(e),e.l+=2),r}function GC(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var i=e.read_shift(1);return e.l+=3,i&16&&(n.area=!0),n}function qC(e){for(var t=xe(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var XC=Bn,WC=a2,KC=Lo;function YC(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,i}function JC(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Bn(e);++e.l;var i=zs(e,t-7,r);return n.t="str",n.val=i,n}function QC(e){var t=Bn(e);++e.l;var r=ia(e);return t.t="n",t.val=r,t}function ZC(e,t,r){var n=xe(15);return jo(n,e,t),n.write_shift(8,r,"f"),n}function e6(e){var t=Bn(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function t6(e,t,r){var n=xe(9);return jo(n,e,t),n.write_shift(2,r),n}function r6(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function a6(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function n6(e,t,r){var n=e.l+t,i=Bn(e),l=e.read_shift(2),o=Ds(e,l,r);return e.l=n,i.t="str",i.val=o,i}var i6=[2,3,48,49,131,139,140,245],Yd=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Hu({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(u,h){var d=[],g=Wi(1);switch(h.type){case"base64":g=Ha($a(u));break;case"binary":g=Ha(u);break;case"buffer":case"array":g=u;break}Xr(g,0);var p=g.read_shift(1),v=!!(p&136),_=!1,w=!1;switch(p){case 2:break;case 3:break;case 48:_=!0,v=!0;break;case 49:_=!0,v=!0;break;case 131:break;case 139:break;case 140:w=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+p.toString(16))}var y=0,S=521;p==2&&(y=g.read_shift(2)),g.l+=3,p!=2&&(y=g.read_shift(4)),y>1048576&&(y=1e6),p!=2&&(S=g.read_shift(2));var k=g.read_shift(2),R=h.codepage||1252;p!=2&&(g.l+=16,g.read_shift(1),g[g.l]!==0&&(R=e[g[g.l]]),g.l+=1,g.l+=2),w&&(g.l+=36);for(var T=[],B={},X=Math.min(g.length,p==2?521:S-10-(_?264:0)),M=w?32:11;g.l<X&&g[g.l]!=13;)switch(B={},B.name=po.utils.decode(R,g.slice(g.l,g.l+M)).replace(/[\u0000\r\n].*$/g,""),g.l+=M,B.type=String.fromCharCode(g.read_shift(1)),p!=2&&!w&&(B.offset=g.read_shift(4)),B.len=g.read_shift(1),p==2&&(B.offset=g.read_shift(2)),B.dec=g.read_shift(1),B.name.length&&T.push(B),p!=2&&(g.l+=w?13:14),B.type){case"B":(!_||B.len!=8)&&h.WTF&&console.log("Skipping "+B.name+":"+B.type);break;case"G":case"P":h.WTF&&console.log("Skipping "+B.name+":"+B.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+B.type)}if(g[g.l]!==13&&(g.l=S-1),g.read_shift(1)!==13)throw new Error("DBF Terminator not found "+g.l+" "+g[g.l]);g.l=S;var N=0,Z=0;for(d[0]=[],Z=0;Z!=T.length;++Z)d[0][Z]=T[Z].name;for(;y-- >0;){if(g[g.l]===42){g.l+=k;continue}for(++g.l,d[++N]=[],Z=0,Z=0;Z!=T.length;++Z){var q=g.slice(g.l,g.l+T[Z].len);g.l+=T[Z].len,Xr(q,0);var he=po.utils.decode(R,q);switch(T[Z].type){case"C":he.trim().length&&(d[N][Z]=he.replace(/\s+$/,""));break;case"D":he.length===8?d[N][Z]=new Date(+he.slice(0,4),+he.slice(4,6)-1,+he.slice(6,8)):d[N][Z]=he;break;case"F":d[N][Z]=parseFloat(he.trim());break;case"+":case"I":d[N][Z]=w?q.read_shift(-4,"i")^2147483648:q.read_shift(4,"i");break;case"L":switch(he.trim().toUpperCase()){case"Y":case"T":d[N][Z]=!0;break;case"N":case"F":d[N][Z]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+he+"|")}break;case"M":if(!v)throw new Error("DBF Unexpected MEMO for type "+p.toString(16));d[N][Z]="##MEMO##"+(w?parseInt(he.trim(),10):q.read_shift(4));break;case"N":he=he.replace(/\u0000/g,"").trim(),he&&he!="."&&(d[N][Z]=+he||0);break;case"@":d[N][Z]=new Date(q.read_shift(-8,"f")-621356832e5);break;case"T":d[N][Z]=new Date((q.read_shift(4)-2440588)*864e5+q.read_shift(4));break;case"Y":d[N][Z]=q.read_shift(4,"i")/1e4+q.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[N][Z]=-q.read_shift(-8,"f");break;case"B":if(_&&T[Z].len==8){d[N][Z]=q.read_shift(8,"f");break}case"G":case"P":q.l+=T[Z].len;break;case"0":if(T[Z].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+T[Z].type)}}}if(p!=2&&g.l<g.length&&g[g.l++]!=26)throw new Error("DBF EOF Marker missing "+(g.l-1)+" of "+g.length+" "+g[g.l-1].toString(16));return h&&h.sheetRows&&(d=d.slice(0,h.sheetRows)),h.DBF=T,d}function n(u,h){var d=h||{};d.dateNF||(d.dateNF="yyyymmdd");var g=Zl(r(u,d),d);return g["!cols"]=d.DBF.map(function(p){return{wch:p.len,DBF:p}}),delete d.DBF,g}function i(u,h){try{return Zi(n(u,h),h)}catch(d){if(h&&h.WTF)throw d}return{SheetNames:[],Sheets:{}}}var l={B:8,C:250,L:1,D:8,"?":0,"":0};function o(u,h){var d=h||{};if(+d.codepage>=0&&wn(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var g=Ta(),p=Mu(u,{header:1,raw:!0,cellDates:!0}),v=p[0],_=p.slice(1),w=u["!cols"]||[],y=0,S=0,k=0,R=1;for(y=0;y<v.length;++y){if(((w[y]||{}).DBF||{}).name){v[y]=w[y].DBF.name,++k;continue}if(v[y]!=null){if(++k,typeof v[y]=="number"&&(v[y]=v[y].toString(10)),typeof v[y]!="string")throw new Error("DBF Invalid column name "+v[y]+" |"+typeof v[y]+"|");if(v.indexOf(v[y])!==y){for(S=0;S<1024;++S)if(v.indexOf(v[y]+"_"+S)==-1){v[y]+="_"+S;break}}}}var T=Ct(u["!ref"]),B=[],X=[],M=[];for(y=0;y<=T.e.c-T.s.c;++y){var N="",Z="",q=0,he=[];for(S=0;S<_.length;++S)_[S][y]!=null&&he.push(_[S][y]);if(he.length==0||v[y]==null){B[y]="?";continue}for(S=0;S<he.length;++S){switch(typeof he[S]){case"number":Z="B";break;case"string":Z="C";break;case"boolean":Z="L";break;case"object":Z=he[S]instanceof Date?"D":"C";break;default:Z="C"}q=Math.max(q,String(he[S]).length),N=N&&N!=Z?"C":Z}q>250&&(q=250),Z=((w[y]||{}).DBF||{}).type,Z=="C"&&w[y].DBF.len>q&&(q=w[y].DBF.len),N=="B"&&Z=="N"&&(N="N",M[y]=w[y].DBF.dec,q=w[y].DBF.len),X[y]=N=="C"||Z=="N"?q:l[N]||0,R+=X[y],B[y]=N}var Y=g.next(32);for(Y.write_shift(4,318902576),Y.write_shift(4,_.length),Y.write_shift(2,296+32*k),Y.write_shift(2,R),y=0;y<4;++y)Y.write_shift(4,0);for(Y.write_shift(4,0|(+t[r_]||3)<<8),y=0,S=0;y<v.length;++y)if(v[y]!=null){var Q=g.next(32),pe=(v[y].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);Q.write_shift(1,pe,"sbcs"),Q.write_shift(1,B[y]=="?"?"C":B[y],"sbcs"),Q.write_shift(4,S),Q.write_shift(1,X[y]||l[B[y]]||0),Q.write_shift(1,M[y]||0),Q.write_shift(1,2),Q.write_shift(4,0),Q.write_shift(1,0),Q.write_shift(4,0),Q.write_shift(4,0),S+=X[y]||l[B[y]]||0}var Ce=g.next(264);for(Ce.write_shift(4,13),y=0;y<65;++y)Ce.write_shift(4,0);for(y=0;y<_.length;++y){var _e=g.next(R);for(_e.write_shift(1,0),S=0;S<v.length;++S)if(v[S]!=null)switch(B[S]){case"L":_e.write_shift(1,_[y][S]==null?63:_[y][S]?84:70);break;case"B":_e.write_shift(8,_[y][S]||0,"f");break;case"N":var te="0";for(typeof _[y][S]=="number"&&(te=_[y][S].toFixed(M[S]||0)),k=0;k<X[S]-te.length;++k)_e.write_shift(1,32);_e.write_shift(1,te,"sbcs");break;case"D":_[y][S]?(_e.write_shift(4,("0000"+_[y][S].getFullYear()).slice(-4),"sbcs"),_e.write_shift(2,("00"+(_[y][S].getMonth()+1)).slice(-2),"sbcs"),_e.write_shift(2,("00"+_[y][S].getDate()).slice(-2),"sbcs")):_e.write_shift(8,"00000000","sbcs");break;case"C":var se=String(_[y][S]!=null?_[y][S]:"").slice(0,X[S]);for(_e.write_shift(1,se,"sbcs"),k=0;k<X[S]-se.length;++k)_e.write_shift(1,32);break}}return g.next(1).write_shift(1,26),g.end()}return{to_workbook:i,to_sheet:n,from_sheet:o}})(),m2=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+dr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(v,_){var w=e[_];return typeof w=="number"?wv(w):w},n=function(v,_,w){var y=_.charCodeAt(0)-32<<4|w.charCodeAt(0)-48;return y==59?v:wv(y)};e["|"]=254;function i(v,_){switch(_.type){case"base64":return l($a(v),_);case"binary":return l(v,_);case"buffer":return l(pt&&Buffer.isBuffer(v)?v.toString("binary"):Qi(v),_);case"array":return l(Os(v),_)}throw new Error("Unrecognized type "+_.type)}function l(v,_){var w=v.split(/[\n\r]+/),y=-1,S=-1,k=0,R=0,T=[],B=[],X=null,M={},N=[],Z=[],q=[],he=0,Y;for(+_.codepage>=0&&wn(+_.codepage);k!==w.length;++k){he=0;var Q=w[k].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),pe=Q.replace(/;;/g,"\0").split(";").map(function(G){return G.replace(/\u0000/g,";")}),Ce=pe[0],_e;if(Q.length>0)switch(Ce){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":pe[1].charAt(0)=="P"&&B.push(Q.slice(3).replace(/;;/g,";"));break;case"C":var te=!1,se=!1,ge=!1,J=!1,Oe=-1,I=-1;for(R=1;R<pe.length;++R)switch(pe[R].charAt(0)){case"A":break;case"X":S=parseInt(pe[R].slice(1))-1,se=!0;break;case"Y":for(y=parseInt(pe[R].slice(1))-1,se||(S=0),Y=T.length;Y<=y;++Y)T[Y]=[];break;case"K":_e=pe[R].slice(1),_e.charAt(0)==='"'?_e=_e.slice(1,_e.length-1):_e==="TRUE"?_e=!0:_e==="FALSE"?_e=!1:isNaN(Sn(_e))?isNaN(ql(_e).getDate())||(_e=er(_e)):(_e=Sn(_e),X!==null&&Jl(X)&&(_e=$u(_e))),te=!0;break;case"E":J=!0;var A=Vl(pe[R].slice(1),{r:y,c:S});T[y][S]=[T[y][S],A];break;case"S":ge=!0,T[y][S]=[T[y][S],"S5S"];break;case"G":break;case"R":Oe=parseInt(pe[R].slice(1))-1;break;case"C":I=parseInt(pe[R].slice(1))-1;break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+Q)}if(te&&(T[y][S]&&T[y][S].length==2?T[y][S][0]=_e:T[y][S]=_e,X=null),ge){if(J)throw new Error("SYLK shared formula cannot have own formula");var z=Oe>-1&&T[Oe][I];if(!z||!z[1])throw new Error("SYLK shared formula cannot find base");T[y][S][1]=D2(z[1],{r:y-Oe,c:S-I})}break;case"F":var U=0;for(R=1;R<pe.length;++R)switch(pe[R].charAt(0)){case"X":S=parseInt(pe[R].slice(1))-1,++U;break;case"Y":for(y=parseInt(pe[R].slice(1))-1,Y=T.length;Y<=y;++Y)T[Y]=[];break;case"M":he=parseInt(pe[R].slice(1))/20;break;case"F":break;case"G":break;case"P":X=B[parseInt(pe[R].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(q=pe[R].slice(1).split(" "),Y=parseInt(q[0],10);Y<=parseInt(q[1],10);++Y)he=parseInt(q[2],10),Z[Y-1]=he===0?{hidden:!0}:{wch:he},Ki(Z[Y-1]);break;case"C":S=parseInt(pe[R].slice(1))-1,Z[S]||(Z[S]={});break;case"R":y=parseInt(pe[R].slice(1))-1,N[y]||(N[y]={}),he>0?(N[y].hpt=he,N[y].hpx=Wl(he)):he===0&&(N[y].hidden=!0);break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+Q)}U<1&&(X=null);break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+Q)}}return N.length>0&&(M["!rows"]=N),Z.length>0&&(M["!cols"]=Z),_&&_.sheetRows&&(T=T.slice(0,_.sheetRows)),[T,M]}function o(v,_){var w=i(v,_),y=w[0],S=w[1],k=Zl(y,_);return dr(S).forEach(function(R){k[R]=S[R]}),k}function u(v,_){return Zi(o(v,_),_)}function h(v,_,w,y){var S="C;Y"+(w+1)+";X"+(y+1)+";K";switch(v.t){case"n":S+=v.v||0,v.f&&!v.F&&(S+=";E"+Im(v.f,{r:w,c:y}));break;case"b":S+=v.v?"TRUE":"FALSE";break;case"e":S+=v.w||v.v;break;case"d":S+='"'+(v.w||v.v)+'"';break;case"s":S+='"'+v.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return S}function d(v,_){_.forEach(function(w,y){var S="F;W"+(y+1)+" "+(y+1)+" ";w.hidden?S+="0":(typeof w.width=="number"&&!w.wpx&&(w.wpx=To(w.width)),typeof w.wpx=="number"&&!w.wch&&(w.wch=ko(w.wpx)),typeof w.wch=="number"&&(S+=Math.round(w.wch))),S.charAt(S.length-1)!=" "&&v.push(S)})}function g(v,_){_.forEach(function(w,y){var S="F;";w.hidden?S+="M0;":w.hpt?S+="M"+20*w.hpt+";":w.hpx&&(S+="M"+20*Ao(w.hpx)+";"),S.length>2&&v.push(S+"R"+(y+1))})}function p(v,_){var w=["ID;PWXL;N;E"],y=[],S=Ct(v["!ref"]),k,R=Array.isArray(v),T=`\r
`;w.push("P;PGeneral"),w.push("F;P0;DG0G8;M255"),v["!cols"]&&d(w,v["!cols"]),v["!rows"]&&g(w,v["!rows"]),w.push("B;Y"+(S.e.r-S.s.r+1)+";X"+(S.e.c-S.s.c+1)+";D"+[S.s.c,S.s.r,S.e.c,S.e.r].join(" "));for(var B=S.s.r;B<=S.e.r;++B)for(var X=S.s.c;X<=S.e.c;++X){var M=st({r:B,c:X});k=R?(v[B]||[])[X]:v[M],!(!k||k.v==null&&(!k.f||k.F))&&y.push(h(k,v,B,X))}return w.join(T)+T+y.join(T)+T+"E"+T}return{to_workbook:u,to_sheet:o,from_sheet:p}})(),g2=(function(){function e(l,o){switch(o.type){case"base64":return t($a(l),o);case"binary":return t(l,o);case"buffer":return t(pt&&Buffer.isBuffer(l)?l.toString("binary"):Qi(l),o);case"array":return t(Os(l),o)}throw new Error("Unrecognized type "+o.type)}function t(l,o){for(var u=l.split(`
`),h=-1,d=-1,g=0,p=[];g!==u.length;++g){if(u[g].trim()==="BOT"){p[++h]=[],d=0;continue}if(!(h<0)){var v=u[g].trim().split(","),_=v[0],w=v[1];++g;for(var y=u[g]||"";(y.match(/["]/g)||[]).length&1&&g<u.length-1;)y+=`
`+u[++g];switch(y=y.trim(),+_){case-1:if(y==="BOT"){p[++h]=[],d=0;continue}else if(y!=="EOD")throw new Error("Unrecognized DIF special command "+y);break;case 0:y==="TRUE"?p[h][d]=!0:y==="FALSE"?p[h][d]=!1:isNaN(Sn(w))?isNaN(ql(w).getDate())?p[h][d]=w:p[h][d]=er(w):p[h][d]=Sn(w),++d;break;case 1:y=y.slice(1,y.length-1),y=y.replace(/""/g,'"'),y&&y.match(/^=".*"$/)&&(y=y.slice(2,-1)),p[h][d++]=y!==""?y:null;break}if(y==="EOD")break}}return o&&o.sheetRows&&(p=p.slice(0,o.sheetRows)),p}function r(l,o){return Zl(e(l,o),o)}function n(l,o){return Zi(r(l,o),o)}var i=(function(){var l=function(h,d,g,p,v){h.push(d),h.push(g+","+p),h.push('"'+v.replace(/"/g,'""')+'"')},o=function(h,d,g,p){h.push(d+","+g),h.push(d==1?'"'+p.replace(/"/g,'""')+'"':p)};return function(h){var d=[],g=Ct(h["!ref"]),p,v=Array.isArray(h);l(d,"TABLE",0,1,"sheetjs"),l(d,"VECTORS",0,g.e.r-g.s.r+1,""),l(d,"TUPLES",0,g.e.c-g.s.c+1,""),l(d,"DATA",0,0,"");for(var _=g.s.r;_<=g.e.r;++_){o(d,-1,0,"BOT");for(var w=g.s.c;w<=g.e.c;++w){var y=st({r:_,c:w});if(p=v?(h[_]||[])[w]:h[y],!p){o(d,1,0,"");continue}switch(p.t){case"n":var S=p.w;!S&&p.v!=null&&(S=p.v),S==null?p.f&&!p.F?o(d,1,0,"="+p.f):o(d,1,0,""):o(d,0,S,"V");break;case"b":o(d,0,p.v?1:0,p.v?"TRUE":"FALSE");break;case"s":o(d,1,0,isNaN(p.v)?p.v:'="'+p.v+'"');break;case"d":p.w||(p.w=fn(p.z||it[14],Dr(er(p.v)))),o(d,0,p.w,"V");break;default:o(d,1,0,"")}}}o(d,-1,0,"EOD");var k=`\r
`,R=d.join(k);return R}})();return{to_workbook:n,to_sheet:r,from_sheet:i}})(),x2=(function(){function e(p){return p.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(p){return p.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(p,v){for(var _=p.split(`
`),w=-1,y=-1,S=0,k=[];S!==_.length;++S){var R=_[S].trim().split(":");if(R[0]==="cell"){var T=sr(R[1]);if(k.length<=T.r)for(w=k.length;w<=T.r;++w)k[w]||(k[w]=[]);switch(w=T.r,y=T.c,R[2]){case"t":k[w][y]=e(R[3]);break;case"v":k[w][y]=+R[3];break;case"vtf":var B=R[R.length-1];case"vtc":R[3]==="nl"?k[w][y]=!!+R[4]:k[w][y]=+R[4],R[2]=="vtf"&&(k[w][y]=[k[w][y],B])}}}return v&&v.sheetRows&&(k=k.slice(0,v.sheetRows)),k}function n(p,v){return Zl(r(p,v),v)}function i(p,v){return Zi(n(p,v),v)}var l=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),h="--SocialCalcSpreadsheetControlSave--";function d(p){if(!p||!p["!ref"])return"";for(var v=[],_=[],w,y="",S=ka(p["!ref"]),k=Array.isArray(p),R=S.s.r;R<=S.e.r;++R)for(var T=S.s.c;T<=S.e.c;++T)if(y=st({r:R,c:T}),w=k?(p[R]||[])[T]:p[y],!(!w||w.v==null||w.t==="z")){switch(_=["cell",y,"t"],w.t){case"s":case"str":_.push(t(w.v));break;case"n":w.f?(_[2]="vtf",_[3]="n",_[4]=w.v,_[5]=t(w.f)):(_[2]="v",_[3]=w.v);break;case"b":_[2]="vt"+(w.f?"f":"c"),_[3]="nl",_[4]=w.v?"1":"0",_[5]=t(w.f||(w.v?"TRUE":"FALSE"));break;case"d":var B=Dr(er(w.v));_[2]="vtc",_[3]="nd",_[4]=""+B,_[5]=w.w||fn(w.z||it[14],B);break;case"e":continue}v.push(_.join(":"))}return v.push("sheet:c:"+(S.e.c-S.s.c+1)+":r:"+(S.e.r-S.s.r+1)+":tvf:1"),v.push("valueformat:1:text-wiki"),v.join(`
`)}function g(p){return[l,o,u,o,d(p),h].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:g}})(),Xl=(function(){function e(g,p,v,_,w){w.raw?p[v][_]=g:g===""||(g==="TRUE"?p[v][_]=!0:g==="FALSE"?p[v][_]=!1:isNaN(Sn(g))?isNaN(ql(g).getDate())?p[v][_]=g:p[v][_]=er(g):p[v][_]=Sn(g))}function t(g,p){var v=p||{},_=[];if(!g||g.length===0)return _;for(var w=g.split(/[\r\n]/),y=w.length-1;y>=0&&w[y].length===0;)--y;for(var S=10,k=0,R=0;R<=y;++R)k=w[R].indexOf(" "),k==-1?k=w[R].length:k++,S=Math.max(S,k);for(R=0;R<=y;++R){_[R]=[];var T=0;for(e(w[R].slice(0,S).trim(),_,R,T,v),T=1;T<=(w[R].length-S)/10+1;++T)e(w[R].slice(S+(T-1)*10,S+T*10).trim(),_,R,T,v)}return v.sheetRows&&(_=_.slice(0,v.sheetRows)),_}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(g){for(var p={},v=!1,_=0,w=0;_<g.length;++_)(w=g.charCodeAt(_))==34?v=!v:!v&&w in r&&(p[w]=(p[w]||0)+1);w=[];for(_ in p)Object.prototype.hasOwnProperty.call(p,_)&&w.push([p[_],_]);if(!w.length){p=n;for(_ in p)Object.prototype.hasOwnProperty.call(p,_)&&w.push([p[_],_])}return w.sort(function(y,S){return y[0]-S[0]||n[y[1]]-n[S[1]]}),r[w.pop()[1]]||44}function l(g,p){var v=p||{},_="",w=v.dense?[]:{},y={s:{c:0,r:0},e:{c:0,r:0}};g.slice(0,4)=="sep="?g.charCodeAt(5)==13&&g.charCodeAt(6)==10?(_=g.charAt(4),g=g.slice(7)):g.charCodeAt(5)==13||g.charCodeAt(5)==10?(_=g.charAt(4),g=g.slice(6)):_=i(g.slice(0,1024)):v&&v.FS?_=v.FS:_=i(g.slice(0,1024));var S=0,k=0,R=0,T=0,B=0,X=_.charCodeAt(0),M=!1,N=0,Z=g.charCodeAt(0);g=g.replace(/\r\n/mg,`
`);var q=v.dateNF!=null?Gk(v.dateNF):null;function he(){var Y=g.slice(T,B),Q={};if(Y.charAt(0)=='"'&&Y.charAt(Y.length-1)=='"'&&(Y=Y.slice(1,-1).replace(/""/g,'"')),Y.length===0)Q.t="z";else if(v.raw)Q.t="s",Q.v=Y;else if(Y.trim().length===0)Q.t="s",Q.v=Y;else if(Y.charCodeAt(0)==61)Y.charCodeAt(1)==34&&Y.charCodeAt(Y.length-1)==34?(Q.t="s",Q.v=Y.slice(2,-1).replace(/""/g,'"')):_N(Y)?(Q.t="n",Q.f=Y.slice(1)):(Q.t="s",Q.v=Y);else if(Y=="TRUE")Q.t="b",Q.v=!0;else if(Y=="FALSE")Q.t="b",Q.v=!1;else if(!isNaN(R=Sn(Y)))Q.t="n",v.cellText!==!1&&(Q.w=Y),Q.v=R;else if(!isNaN(ql(Y).getDate())||q&&Y.match(q)){Q.z=v.dateNF||it[14];var pe=0;q&&Y.match(q)&&(Y=qk(Y,v.dateNF,Y.match(q)||[]),pe=1),v.cellDates?(Q.t="d",Q.v=er(Y,pe)):(Q.t="n",Q.v=Dr(er(Y,pe))),v.cellText!==!1&&(Q.w=fn(Q.z,Q.v instanceof Date?Dr(Q.v):Q.v)),v.cellNF||delete Q.z}else Q.t="s",Q.v=Y;if(Q.t=="z"||(v.dense?(w[S]||(w[S]=[]),w[S][k]=Q):w[st({c:k,r:S})]=Q),T=B+1,Z=g.charCodeAt(T),y.e.c<k&&(y.e.c=k),y.e.r<S&&(y.e.r=S),N==X)++k;else if(k=0,++S,v.sheetRows&&v.sheetRows<=S)return!0}e:for(;B<g.length;++B)switch(N=g.charCodeAt(B)){case 34:Z===34&&(M=!M);break;case X:case 10:case 13:if(!M&&he())break e;break}return B-T>0&&he(),w["!ref"]=mt(y),w}function o(g,p){return!(p&&p.PRN)||p.FS||g.slice(0,4)=="sep="||g.indexOf("	")>=0||g.indexOf(",")>=0||g.indexOf(";")>=0?l(g,p):Zl(t(g,p),p)}function u(g,p){var v="",_=p.type=="string"?[0,0,0,0]:Gm(g,p);switch(p.type){case"base64":v=$a(g);break;case"binary":v=g;break;case"buffer":p.codepage==65001?v=g.toString("utf8"):p.codepage&&typeof po<"u"||(v=pt&&Buffer.isBuffer(g)?g.toString("binary"):Qi(g));break;case"array":v=Os(g);break;case"string":v=g;break;default:throw new Error("Unrecognized type "+p.type)}return _[0]==239&&_[1]==187&&_[2]==191?v=Gt(v.slice(3)):p.type!="string"&&p.type!="buffer"&&p.codepage==65001?v=Gt(v):p.type=="binary"&&typeof po<"u",v.slice(0,19)=="socialcalc:version:"?x2.to_sheet(p.type=="string"?v:Gt(v),p):o(v,p)}function h(g,p){return Zi(u(g,p),p)}function d(g){for(var p=[],v=Ct(g["!ref"]),_,w=Array.isArray(g),y=v.s.r;y<=v.e.r;++y){for(var S=[],k=v.s.c;k<=v.e.c;++k){var R=st({r:y,c:k});if(_=w?(g[y]||[])[k]:g[R],!_||_.v==null){S.push("          ");continue}for(var T=(_.w||(oi(_),_.w)||"").slice(0,10);T.length<10;)T+=" ";S.push(T+(k===0?" ":""))}p.push(S.join(""))}return p.join(`
`)}return{to_workbook:h,to_sheet:u,from_sheet:d}})();function s6(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var i=m2.to_workbook(e,r);return r.WTF=n,i}catch(l){if(r.WTF=n,!l.message.match(/SYLK bad record ID/)&&n)throw l;return Xl.to_workbook(e,t)}}var As=(function(){function e(A,z,U){if(A){Xr(A,A.l||0);for(var G=U.Enum||Oe;A.l<A.length;){var ne=A.read_shift(2),we=G[ne]||G[65535],Te=A.read_shift(2),Se=A.l+Te,Ne=we.f&&we.f(A,Te,U);if(A.l=Se,z(Ne,we,ne))return}}}function t(A,z){switch(z.type){case"base64":return r(Ha($a(A)),z);case"binary":return r(Ha(A),z);case"buffer":case"array":return r(A,z)}throw"Unsupported type "+z.type}function r(A,z){if(!A)return A;var U=z||{},G=U.dense?[]:{},ne="Sheet1",we="",Te=0,Se={},Ne=[],ot=[],V={s:{r:0,c:0},e:{r:0,c:0}},Nt=U.sheetRows||0;if(A[2]==0&&(A[3]==8||A[3]==9)&&A.length>=16&&A[14]==5&&A[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(A[2]==2)U.Enum=Oe,e(A,function(je,zt,gr){switch(gr){case 0:U.vers=je,je>=4096&&(U.qpro=!0);break;case 6:V=je;break;case 204:je&&(we=je);break;case 222:we=je;break;case 15:case 51:U.qpro||(je[1].v=je[1].v.slice(1));case 13:case 14:case 16:gr==14&&(je[2]&112)==112&&(je[2]&15)>1&&(je[2]&15)<15&&(je[1].z=U.dateNF||it[14],U.cellDates&&(je[1].t="d",je[1].v=$u(je[1].v))),U.qpro&&je[3]>Te&&(G["!ref"]=mt(V),Se[ne]=G,Ne.push(ne),G=U.dense?[]:{},V={s:{r:0,c:0},e:{r:0,c:0}},Te=je[3],ne=we||"Sheet"+(Te+1),we="");var Kr=U.dense?(G[je[0].r]||[])[je[0].c]:G[st(je[0])];if(Kr){Kr.t=je[1].t,Kr.v=je[1].v,je[1].z!=null&&(Kr.z=je[1].z),je[1].f!=null&&(Kr.f=je[1].f);break}U.dense?(G[je[0].r]||(G[je[0].r]=[]),G[je[0].r][je[0].c]=je[1]):G[st(je[0])]=je[1];break}},U);else if(A[2]==26||A[2]==14)U.Enum=I,A[2]==14&&(U.qpro=!0,A.l=0),e(A,function(je,zt,gr){switch(gr){case 204:ne=je;break;case 22:je[1].v=je[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(je[3]>Te&&(G["!ref"]=mt(V),Se[ne]=G,Ne.push(ne),G=U.dense?[]:{},V={s:{r:0,c:0},e:{r:0,c:0}},Te=je[3],ne="Sheet"+(Te+1)),Nt>0&&je[0].r>=Nt)break;U.dense?(G[je[0].r]||(G[je[0].r]=[]),G[je[0].r][je[0].c]=je[1]):G[st(je[0])]=je[1],V.e.c<je[0].c&&(V.e.c=je[0].c),V.e.r<je[0].r&&(V.e.r=je[0].r);break;case 27:je[14e3]&&(ot[je[14e3][0]]=je[14e3][1]);break;case 1537:ot[je[0]]=je[1],je[0]==Te&&(ne=je[1]);break}},U);else throw new Error("Unrecognized LOTUS BOF "+A[2]);if(G["!ref"]=mt(V),Se[we||ne]=G,Ne.push(we||ne),!ot.length)return{SheetNames:Ne,Sheets:Se};for(var lt={},Tt=[],ft=0;ft<ot.length;++ft)Se[Ne[ft]]?(Tt.push(ot[ft]||Ne[ft]),lt[ot[ft]]=Se[ot[ft]]||Se[Ne[ft]]):(Tt.push(ot[ft]),lt[ot[ft]]={"!ref":"A1"});return{SheetNames:Tt,Sheets:lt}}function n(A,z){var U=z||{};if(+U.codepage>=0&&wn(+U.codepage),U.type=="string")throw new Error("Cannot write WK1 to JS string");var G=Ta(),ne=Ct(A["!ref"]),we=Array.isArray(A),Te=[];Ie(G,0,l(1030)),Ie(G,6,h(ne));for(var Se=Math.min(ne.e.r,8191),Ne=ne.s.r;Ne<=Se;++Ne)for(var ot=yr(Ne),V=ne.s.c;V<=ne.e.c;++V){Ne===ne.s.r&&(Te[V]=ir(V));var Nt=Te[V]+ot,lt=we?(A[Ne]||[])[V]:A[Nt];if(!(!lt||lt.t=="z"))if(lt.t=="n")(lt.v|0)==lt.v&&lt.v>=-32768&&lt.v<=32767?Ie(G,13,_(Ne,V,lt.v)):Ie(G,14,y(Ne,V,lt.v));else{var Tt=oi(lt);Ie(G,15,p(Ne,V,Tt.slice(0,239)))}}return Ie(G,1),G.end()}function i(A,z){var U=z||{};if(+U.codepage>=0&&wn(+U.codepage),U.type=="string")throw new Error("Cannot write WK3 to JS string");var G=Ta();Ie(G,0,o(A));for(var ne=0,we=0;ne<A.SheetNames.length;++ne)(A.Sheets[A.SheetNames[ne]]||{})["!ref"]&&Ie(G,27,J(A.SheetNames[ne],we++));var Te=0;for(ne=0;ne<A.SheetNames.length;++ne){var Se=A.Sheets[A.SheetNames[ne]];if(!(!Se||!Se["!ref"])){for(var Ne=Ct(Se["!ref"]),ot=Array.isArray(Se),V=[],Nt=Math.min(Ne.e.r,8191),lt=Ne.s.r;lt<=Nt;++lt)for(var Tt=yr(lt),ft=Ne.s.c;ft<=Ne.e.c;++ft){lt===Ne.s.r&&(V[ft]=ir(ft));var je=V[ft]+Tt,zt=ot?(Se[lt]||[])[ft]:Se[je];if(!(!zt||zt.t=="z"))if(zt.t=="n")Ie(G,23,he(lt,ft,Te,zt.v));else{var gr=oi(zt);Ie(G,22,N(lt,ft,Te,gr.slice(0,239)))}}++Te}}return Ie(G,1),G.end()}function l(A){var z=xe(2);return z.write_shift(2,A),z}function o(A){var z=xe(26);z.write_shift(2,4096),z.write_shift(2,4),z.write_shift(4,0);for(var U=0,G=0,ne=0,we=0;we<A.SheetNames.length;++we){var Te=A.SheetNames[we],Se=A.Sheets[Te];if(!(!Se||!Se["!ref"])){++ne;var Ne=ka(Se["!ref"]);U<Ne.e.r&&(U=Ne.e.r),G<Ne.e.c&&(G=Ne.e.c)}}return U>8191&&(U=8191),z.write_shift(2,U),z.write_shift(1,ne),z.write_shift(1,G),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(1,1),z.write_shift(1,2),z.write_shift(4,0),z.write_shift(4,0),z}function u(A,z,U){var G={s:{c:0,r:0},e:{c:0,r:0}};return z==8&&U.qpro?(G.s.c=A.read_shift(1),A.l++,G.s.r=A.read_shift(2),G.e.c=A.read_shift(1),A.l++,G.e.r=A.read_shift(2),G):(G.s.c=A.read_shift(2),G.s.r=A.read_shift(2),z==12&&U.qpro&&(A.l+=2),G.e.c=A.read_shift(2),G.e.r=A.read_shift(2),z==12&&U.qpro&&(A.l+=2),G.s.c==65535&&(G.s.c=G.e.c=G.s.r=G.e.r=0),G)}function h(A){var z=xe(8);return z.write_shift(2,A.s.c),z.write_shift(2,A.s.r),z.write_shift(2,A.e.c),z.write_shift(2,A.e.r),z}function d(A,z,U){var G=[{c:0,r:0},{t:"n",v:0},0,0];return U.qpro&&U.vers!=20768?(G[0].c=A.read_shift(1),G[3]=A.read_shift(1),G[0].r=A.read_shift(2),A.l+=2):(G[2]=A.read_shift(1),G[0].c=A.read_shift(2),G[0].r=A.read_shift(2)),G}function g(A,z,U){var G=A.l+z,ne=d(A,z,U);if(ne[1].t="s",U.vers==20768){A.l++;var we=A.read_shift(1);return ne[1].v=A.read_shift(we,"utf8"),ne}return U.qpro&&A.l++,ne[1].v=A.read_shift(G-A.l,"cstr"),ne}function p(A,z,U){var G=xe(7+U.length);G.write_shift(1,255),G.write_shift(2,z),G.write_shift(2,A),G.write_shift(1,39);for(var ne=0;ne<G.length;++ne){var we=U.charCodeAt(ne);G.write_shift(1,we>=128?95:we)}return G.write_shift(1,0),G}function v(A,z,U){var G=d(A,z,U);return G[1].v=A.read_shift(2,"i"),G}function _(A,z,U){var G=xe(7);return G.write_shift(1,255),G.write_shift(2,z),G.write_shift(2,A),G.write_shift(2,U,"i"),G}function w(A,z,U){var G=d(A,z,U);return G[1].v=A.read_shift(8,"f"),G}function y(A,z,U){var G=xe(13);return G.write_shift(1,255),G.write_shift(2,z),G.write_shift(2,A),G.write_shift(8,U,"f"),G}function S(A,z,U){var G=A.l+z,ne=d(A,z,U);if(ne[1].v=A.read_shift(8,"f"),U.qpro)A.l=G;else{var we=A.read_shift(2);B(A.slice(A.l,A.l+we),ne),A.l+=we}return ne}function k(A,z,U){var G=z&32768;return z&=-32769,z=(G?A:0)+(z>=8192?z-16384:z),(G?"":"$")+(U?ir(z):yr(z))}var R={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},T=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function B(A,z){Xr(A,0);for(var U=[],G=0,ne="",we="",Te="",Se="";A.l<A.length;){var Ne=A[A.l++];switch(Ne){case 0:U.push(A.read_shift(8,"f"));break;case 1:we=k(z[0].c,A.read_shift(2),!0),ne=k(z[0].r,A.read_shift(2),!1),U.push(we+ne);break;case 2:{var ot=k(z[0].c,A.read_shift(2),!0),V=k(z[0].r,A.read_shift(2),!1);we=k(z[0].c,A.read_shift(2),!0),ne=k(z[0].r,A.read_shift(2),!1),U.push(ot+V+":"+we+ne)}break;case 3:if(A.l<A.length){console.error("WK1 premature formula end");return}break;case 4:U.push("("+U.pop()+")");break;case 5:U.push(A.read_shift(2));break;case 6:{for(var Nt="";Ne=A[A.l++];)Nt+=String.fromCharCode(Ne);U.push('"'+Nt.replace(/"/g,'""')+'"')}break;case 8:U.push("-"+U.pop());break;case 23:U.push("+"+U.pop());break;case 22:U.push("NOT("+U.pop()+")");break;case 20:case 21:Se=U.pop(),Te=U.pop(),U.push(["AND","OR"][Ne-20]+"("+Te+","+Se+")");break;default:if(Ne<32&&T[Ne])Se=U.pop(),Te=U.pop(),U.push(Te+T[Ne]+Se);else if(R[Ne]){if(G=R[Ne][1],G==69&&(G=A[A.l++]),G>U.length){console.error("WK1 bad formula parse 0x"+Ne.toString(16)+":|"+U.join("|")+"|");return}var lt=U.slice(-G);U.length-=G,U.push(R[Ne][0]+"("+lt.join(",")+")")}else return Ne<=7?console.error("WK1 invalid opcode "+Ne.toString(16)):Ne<=24?console.error("WK1 unsupported op "+Ne.toString(16)):Ne<=30?console.error("WK1 invalid opcode "+Ne.toString(16)):Ne<=115?console.error("WK1 unsupported function opcode "+Ne.toString(16)):console.error("WK1 unrecognized opcode "+Ne.toString(16))}}U.length==1?z[1].f=""+U[0]:console.error("WK1 bad formula parse |"+U.join("|")+"|")}function X(A){var z=[{c:0,r:0},{t:"n",v:0},0];return z[0].r=A.read_shift(2),z[3]=A[A.l++],z[0].c=A[A.l++],z}function M(A,z){var U=X(A);return U[1].t="s",U[1].v=A.read_shift(z-4,"cstr"),U}function N(A,z,U,G){var ne=xe(6+G.length);ne.write_shift(2,A),ne.write_shift(1,U),ne.write_shift(1,z),ne.write_shift(1,39);for(var we=0;we<G.length;++we){var Te=G.charCodeAt(we);ne.write_shift(1,Te>=128?95:Te)}return ne.write_shift(1,0),ne}function Z(A,z){var U=X(A);U[1].v=A.read_shift(2);var G=U[1].v>>1;if(U[1].v&1)switch(G&7){case 0:G=(G>>3)*5e3;break;case 1:G=(G>>3)*500;break;case 2:G=(G>>3)/20;break;case 3:G=(G>>3)/200;break;case 4:G=(G>>3)/2e3;break;case 5:G=(G>>3)/2e4;break;case 6:G=(G>>3)/16;break;case 7:G=(G>>3)/64;break}return U[1].v=G,U}function q(A,z){var U=X(A),G=A.read_shift(4),ne=A.read_shift(4),we=A.read_shift(2);if(we==65535)return G===0&&ne===3221225472?(U[1].t="e",U[1].v=15):G===0&&ne===3489660928?(U[1].t="e",U[1].v=42):U[1].v=0,U;var Te=we&32768;return we=(we&32767)-16446,U[1].v=(1-Te*2)*(ne*Math.pow(2,we+32)+G*Math.pow(2,we)),U}function he(A,z,U,G){var ne=xe(14);if(ne.write_shift(2,A),ne.write_shift(1,U),ne.write_shift(1,z),G==0)return ne.write_shift(4,0),ne.write_shift(4,0),ne.write_shift(2,65535),ne;var we=0,Te=0,Se=0,Ne=0;return G<0&&(we=1,G=-G),Te=Math.log2(G)|0,G/=Math.pow(2,Te-31),Ne=G>>>0,(Ne&2147483648)==0&&(G/=2,++Te,Ne=G>>>0),G-=Ne,Ne|=2147483648,Ne>>>=0,G*=Math.pow(2,32),Se=G>>>0,ne.write_shift(4,Se),ne.write_shift(4,Ne),Te+=16383+(we?32768:0),ne.write_shift(2,Te),ne}function Y(A,z){var U=q(A);return A.l+=z-14,U}function Q(A,z){var U=X(A),G=A.read_shift(4);return U[1].v=G>>6,U}function pe(A,z){var U=X(A),G=A.read_shift(8,"f");return U[1].v=G,U}function Ce(A,z){var U=pe(A);return A.l+=z-10,U}function _e(A,z){return A[A.l+z-1]==0?A.read_shift(z,"cstr"):""}function te(A,z){var U=A[A.l++];U>z-1&&(U=z-1);for(var G="";G.length<U;)G+=String.fromCharCode(A[A.l++]);return G}function se(A,z,U){if(!(!U.qpro||z<21)){var G=A.read_shift(1);A.l+=17,A.l+=1,A.l+=2;var ne=A.read_shift(z-21,"cstr");return[G,ne]}}function ge(A,z){for(var U={},G=A.l+z;A.l<G;){var ne=A.read_shift(2);if(ne==14e3){for(U[ne]=[0,""],U[ne][0]=A.read_shift(2);A[A.l];)U[ne][1]+=String.fromCharCode(A[A.l]),A.l++;A.l++}}return U}function J(A,z){var U=xe(5+A.length);U.write_shift(2,14e3),U.write_shift(2,z);for(var G=0;G<A.length;++G){var ne=A.charCodeAt(G);U[U.l++]=ne>127?95:ne}return U[U.l++]=0,U}var Oe={0:{n:"BOF",f:Ar},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:v},14:{n:"NUMBER",f:w},15:{n:"LABEL",f:g},16:{n:"FORMULA",f:S},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:g},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:_e},222:{n:"SHEETNAMELP",f:te},65535:{n:""}},I={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:M},23:{n:"NUMBER17",f:q},24:{n:"NUMBER18",f:Z},25:{n:"FORMULA19",f:Y},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ge},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:Q},38:{n:"??"},39:{n:"NUMBER27",f:pe},40:{n:"FORMULA28",f:Ce},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:_e},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:se},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:t}})();function l6(e){var t={},r=e.match(ca),n=0,i=!1;if(r)for(;n!=r.length;++n){var l=ct(r[n]);switch(l[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!l.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(l.val=="1")break;t.cp=cm[parseInt(l.val,10)];break;case"<outline":if(!l.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=l.val;break;case"<sz":t.sz=l.val;break;case"<strike":if(!l.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!l.val)break;switch(l.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(l.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(l.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":l.rgb&&(t.color=l.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=l.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=l.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(l[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+l[0])}}return t}var c6=(function(){var e=_o("t"),t=_o("rPr");function r(l){var o=l.match(e);if(!o)return{t:"s",v:""};var u={t:"s",v:At(o[1])},h=l.match(t);return h&&(u.s=l6(h[1])),u}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(i).map(r).filter(function(u){return u.v})}})(),o6=(function(){var t=/(\r\n|\n)/g;function r(i,l,o){var u=[];i.u&&u.push("text-decoration: underline;"),i.uval&&u.push("text-underline-style:"+i.uval+";"),i.sz&&u.push("font-size:"+i.sz+"pt;"),i.outline&&u.push("text-effect: outline;"),i.shadow&&u.push("text-shadow: auto;"),l.push('<span style="'+u.join("")+'">'),i.b&&(l.push("<b>"),o.push("</b>")),i.i&&(l.push("<i>"),o.push("</i>")),i.strike&&(l.push("<s>"),o.push("</s>"));var h=i.valign||"";return h=="superscript"||h=="super"?h="sup":h=="subscript"&&(h="sub"),h!=""&&(l.push("<"+h+">"),o.push("</"+h+">")),o.push("</span>"),i}function n(i){var l=[[],i.v,[]];return i.v?(i.s&&r(i.s,l[0],l[2]),l[0].join("")+l[1].replace(t,"<br/>")+l[2].join("")):""}return function(l){return l.map(n).join("")}})(),u6=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,f6=/<(?:\w+:)?r>/,h6=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Dm(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=At(Gt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Gt(e),r&&(n.h=vm(n.t))):e.match(f6)&&(n.r=Gt(e),n.t=At(Gt((e.replace(h6,"").match(u6)||[]).join("").replace(ca,""))),r&&(n.h=o6(c6(n.r)))),n):{t:""}}var d6=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,m6=/<(?:\w+:)?(?:si|sstItem)>/g,g6=/<\/(?:\w+:)?(?:si|sstItem)>/;function x6(e,t){var r=[],n="";if(!e)return r;var i=e.match(d6);if(i){n=i[2].replace(m6,"").split(g6);for(var l=0;l!=n.length;++l){var o=Dm(n[l].trim(),t);o!=null&&(r[r.length]=o)}i=ct(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}var p6=/^\s|\s$|[\t\n\r]/;function p2(e,t){if(!t.bookSST)return"";var r=[_r];r[r.length]=Be("sst",null,{xmlns:Bs[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var i=e[n],l="<si>";i.r?l+=i.r:(l+="<t",i.t||(i.t=""),i.t.match(p6)&&(l+=' xml:space="preserve"'),l+=">"+Pt(i.t)+"</t>"),l+="</si>",r[r.length]=l}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function v6(e){return[e.read_shift(4),e.read_shift(4)]}function y6(e,t){var r=[],n=!1;return hi(e,function(l,o,u){switch(u){case 159:r.Count=l[0],r.Unique=l[1];break;case 19:r.push(l);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}),r}function _6(e,t){return t||(t=xe(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var w6=RA;function b6(e){var t=Ta();Ae(t,159,_6(e));for(var r=0;r<e.length;++r)Ae(t,19,w6(e[r]));return Ae(t,160),t.end()}function v2(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function ci(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function S6(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=ci(e,4),t.U=ci(e,4),t.W=ci(e,4),t}function E6(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},i=e.read_shift(4),l=[];i-- >0;)l.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=l,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function T6(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(E6(e));return t}function k6(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function A6(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=ci(e,4),t.U=ci(e,4),t.W=ci(e,4),t}function C6(e){var t=A6(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function y2(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function _2(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function N6(e){var t=ci(e);switch(t.Minor){case 2:return[t.Minor,O6(e)];case 3:return[t.Minor,R6()];case 4:return[t.Minor,D6(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function O6(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=y2(e,r),i=_2(e,e.length-e.l);return{t:"Std",h:n,v:i}}function R6(){throw new Error("File is password-protected: ECMA-376 Extensible")}function D6(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(ca,function(l){var o=ct(l);switch(Ln(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(u){n[u]=o[u]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function F6(e,t){var r={},n=r.EncryptionVersionInfo=ci(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var i=e.read_shift(4);return t-=4,r.EncryptionHeader=y2(e,i),t-=i,r.EncryptionVerifier=_2(e,t),r}function M6(e){var t={},r=t.EncryptionVersionInfo=ci(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function Fm(e){var t=0,r,n=v2(e),i=n.length+1,l,o,u,h,d;for(r=Wi(i),r[0]=n.length,l=1;l!=i;++l)r[l]=n[l-1];for(l=i-1;l>=0;--l)o=r[l],u=(t&16384)===0?0:1,h=t<<1&32767,d=u|h,t=d^o;return t^52811}var w2=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},i=function(o,u){return n(o^u)},l=function(o){for(var u=t[o.length-1],h=104,d=o.length-1;d>=0;--d)for(var g=o[d],p=0;p!=7;++p)g&64&&(u^=r[h]),g*=2,--h;return u};return function(o){for(var u=v2(o),h=l(u),d=u.length,g=Wi(16),p=0;p!=16;++p)g[p]=0;var v,_,w;for((d&1)===1&&(v=h>>8,g[d]=i(e[0],v),--d,v=h&255,_=u[u.length-1],g[d]=i(_,v));d>0;)--d,v=h>>8,g[d]=i(u[d],v),--d,v=h&255,g[d]=i(u[d],v);for(d=15,w=15-u.length;w>0;)v=h>>8,g[d]=i(e[w],v),--d,--w,v=h&255,g[d]=i(u[d],v),--d,--w;return g}})(),L6=function(e,t,r,n,i){i||(i=t),n||(n=w2(e));var l,o;for(l=0;l!=t.length;++l)o=t[l],o^=n[r],o=(o>>5|o<<3)&255,i[l]=o,++r;return[i,r,n]},B6=function(e){var t=0,r=w2(e);return function(n){var i=L6("",n,t,r);return t=i[1],i[0]}};function I6(e,t,r,n){var i={key:Ar(e),verificationBytes:Ar(e)};return r.password&&(i.verifier=Fm(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=B6(r.password)),i}function U6(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=M6(e):n.Data=F6(e,t),n}function j6(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?U6(e,t-2,n):I6(e,r.biff>=8?t:t-2,r,n),n}var b2=(function(){function e(i,l){switch(l.type){case"base64":return t($a(i),l);case"binary":return t(i,l);case"buffer":return t(pt&&Buffer.isBuffer(i)?i.toString("binary"):Qi(i),l);case"array":return t(Os(i),l)}throw new Error("Unrecognized type "+l.type)}function t(i,l){var o=l||{},u=o.dense?[]:{},h=i.match(/\\trowd.*?\\row\b/g);if(!h.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:h.length-1}};return h.forEach(function(g,p){Array.isArray(u)&&(u[p]=[]);for(var v=/\\\w+\b/g,_=0,w,y=-1;w=v.exec(g);){switch(w[0]){case"\\cell":var S=g.slice(_,v.lastIndex-w[0].length);if(S[0]==" "&&(S=S.slice(1)),++y,S.length){var k={v:S,t:"s"};Array.isArray(u)?u[p][y]=k:u[st({r:p,c:y})]=k}break}_=v.lastIndex}y>d.e.c&&(d.e.c=y)}),u["!ref"]=mt(d),u}function r(i,l){return Zi(e(i,l),l)}function n(i){for(var l=["{\\rtf1\\ansi"],o=Ct(i["!ref"]),u,h=Array.isArray(i),d=o.s.r;d<=o.e.r;++d){l.push("\\trowd\\trautofit1");for(var g=o.s.c;g<=o.e.c;++g)l.push("\\cellx"+(g+1));for(l.push("\\pard\\intbl"),g=o.s.c;g<=o.e.c;++g){var p=st({r:d,c:g});u=h?(i[d]||[])[g]:i[p],!(!u||u.v==null&&(!u.f||u.F))&&(l.push(" "+(u.w||(oi(u),u.w))),l.push("\\cell"))}l.push("\\pard\\intbl\\row")}return l.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}})();function P6(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Eo(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function z6(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,i=Math.max(t,r,n),l=Math.min(t,r,n),o=i-l;if(o===0)return[0,0,t];var u=0,h=0,d=i+l;switch(h=o/(d>1?2-d:d),i){case t:u=((r-n)/o+6)%6;break;case r:u=(n-t)/o+2;break;case n:u=(t-r)/o+4;break}return[u/6,h,d/2]}function H6(e){var t=e[0],r=e[1],n=e[2],i=r*2*(n<.5?n:1-n),l=n-i/2,o=[l,l,l],u=6*t,h;if(r!==0)switch(u|0){case 0:case 6:h=i*u,o[0]+=i,o[1]+=h;break;case 1:h=i*(2-u),o[0]+=h,o[1]+=i;break;case 2:h=i*(u-2),o[1]+=i,o[2]+=h;break;case 3:h=i*(4-u),o[1]+=h,o[2]+=i;break;case 4:h=i*(u-4),o[2]+=i,o[0]+=h;break;case 5:h=i*(6-u),o[2]+=h,o[0]+=i;break}for(var d=0;d!=3;++d)o[d]=Math.round(o[d]*255);return o}function Ru(e,t){if(t===0)return e;var r=z6(P6(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Eo(H6(r))}var S2=6,V6=15,$6=1,na=S2;function To(e){return Math.floor((e+Math.round(128/na)/256)*na)}function ko(e){return Math.floor((e-5)/na*100+.5)/100}function Du(e){return Math.round((e*na+5)/na*256)/256}function bd(e){return Du(ko(To(e)))}function Mm(e){var t=Math.abs(e-bd(e)),r=na;if(t>.005)for(na=$6;na<V6;++na)Math.abs(e-bd(e))<=t&&(t=Math.abs(e-bd(e)),r=na);na=r}function Ki(e){e.width?(e.wpx=To(e.width),e.wch=ko(e.wpx),e.MDW=na):e.wpx?(e.wch=ko(e.wpx),e.width=Du(e.wch),e.MDW=na):typeof e.wch=="number"&&(e.width=Du(e.wch),e.wpx=To(e.width),e.MDW=na),e.customWidth&&delete e.customWidth}var G6=96,E2=G6;function Ao(e){return e*96/E2}function Wl(e){return e*E2/96}var q6={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function X6(e,t,r,n){t.Borders=[];var i={},l=!1;(e[0].match(ca)||[]).forEach(function(o){var u=ct(o);switch(Ln(u[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},u.diagonalUp&&(i.diagonalUp=Zt(u.diagonalUp)),u.diagonalDown&&(i.diagonalDown=Zt(u.diagonalDown)),t.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(n&&n.WTF&&!l)throw new Error("unrecognized "+u[0]+" in borders")}})}function W6(e,t,r,n){t.Fills=[];var i={},l=!1;(e[0].match(ca)||[]).forEach(function(o){var u=ct(o);switch(Ln(u[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},t.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":u.patternType&&(i.patternType=u.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),u.indexed&&(i.bgColor.indexed=parseInt(u.indexed,10)),u.theme&&(i.bgColor.theme=parseInt(u.theme,10)),u.tint&&(i.bgColor.tint=parseFloat(u.tint)),u.rgb&&(i.bgColor.rgb=u.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),u.theme&&(i.fgColor.theme=parseInt(u.theme,10)),u.tint&&(i.fgColor.tint=parseFloat(u.tint)),u.rgb!=null&&(i.fgColor.rgb=u.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(n&&n.WTF&&!l)throw new Error("unrecognized "+u[0]+" in fills")}})}function K6(e,t,r,n){t.Fonts=[];var i={},l=!1;(e[0].match(ca)||[]).forEach(function(o){var u=ct(o);switch(Ln(u[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(i),i={};break;case"<name":u.val&&(i.name=Gt(u.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=u.val?Zt(u.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=u.val?Zt(u.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(u.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=u.val?Zt(u.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=u.val?Zt(u.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=u.val?Zt(u.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=u.val?Zt(u.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=u.val?Zt(u.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":u.val&&(i.sz=+u.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":u.val&&(i.vertAlign=u.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":u.val&&(i.family=parseInt(u.val,10));break;case"<family/>":case"</family>":break;case"<scheme":u.val&&(i.scheme=u.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(u.val=="1")break;u.codepage=cm[parseInt(u.val,10)];break;case"<color":if(i.color||(i.color={}),u.auto&&(i.color.auto=Zt(u.auto)),u.rgb)i.color.rgb=u.rgb.slice(-6);else if(u.indexed){i.color.index=parseInt(u.indexed,10);var h=Ts[i.color.index];i.color.index==81&&(h=Ts[1]),h||(h=Ts[1]),i.color.rgb=h[0].toString(16)+h[1].toString(16)+h[2].toString(16)}else u.theme&&(i.color.theme=parseInt(u.theme,10),u.tint&&(i.color.tint=parseFloat(u.tint)),u.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=Ru(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":l=!0;break;case"</AlternateContent>":l=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(n&&n.WTF&&!l)throw new Error("unrecognized "+u[0]+" in fonts")}})}function Y6(e,t,r){t.NumberFmt=[];for(var n=dr(it),i=0;i<n.length;++i)t.NumberFmt[n[i]]=it[n[i]];var l=e[0].match(ca);if(l)for(i=0;i<l.length;++i){var o=ct(l[i]);switch(Ln(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var u=At(Gt(o.formatCode)),h=parseInt(o.numFmtId,10);if(t.NumberFmt[h]=u,h>0){if(h>392){for(h=392;h>60&&t.NumberFmt[h]!=null;--h);t.NumberFmt[h]=u}li(u,h)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function J6(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Be("numFmt",null,{numFmtId:n,formatCode:Pt(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Be("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var hu=["numFmtId","fillId","fontId","borderId","xfId"],du=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function Q6(e,t,r){t.CellXf=[];var n,i=!1;(e[0].match(ca)||[]).forEach(function(l){var o=ct(l),u=0;switch(Ln(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],u=0;u<hu.length;++u)n[hu[u]]&&(n[hu[u]]=parseInt(n[hu[u]],10));for(u=0;u<du.length;++u)n[du[u]]&&(n[du[u]]=Zt(n[du[u]]));if(t.NumberFmt&&n.numFmtId>392){for(u=392;u>60;--u)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[u]){n.numFmtId=u;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var h={};o.vertical&&(h.vertical=o.vertical),o.horizontal&&(h.horizontal=o.horizontal),o.textRotation!=null&&(h.textRotation=o.textRotation),o.indent&&(h.indent=o.indent),o.wrapText&&(h.wrapText=Zt(o.wrapText)),n.alignment=h;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function Z6(e){var t=[];return t[t.length]=Be("cellXfs",null),e.forEach(function(r){t[t.length]=Be("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Be("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var e8=(function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,l=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(u,h,d){var g={};if(!u)return g;u=u.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var p;return(p=u.match(t))&&Y6(p,g,d),(p=u.match(i))&&K6(p,g,h,d),(p=u.match(n))&&W6(p,g,h,d),(p=u.match(l))&&X6(p,g,h,d),(p=u.match(r))&&Q6(p,g,d),g}})();function T2(e,t){var r=[_r,Be("styleSheet",null,{xmlns:Bs[0],"xmlns:vt":Rr.vt})],n;return e.SSF&&(n=J6(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=Z6(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function t8(e,t){var r=e.read_shift(2),n=sa(e);return[r,n]}function r8(e,t,r){r||(r=xe(6+4*t.length)),r.write_shift(2,e),Ur(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function a8(e,t,r){var n={};n.sz=e.read_shift(2)/20;var i=UA(e);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var l=e.read_shift(2);switch(l===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(n.underline=o);var u=e.read_shift(1);u>0&&(n.family=u);var h=e.read_shift(1);switch(h>0&&(n.charset=h),e.l++,n.color=IA(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=sa(e),n}function n8(e,t){t||(t=xe(153)),t.write_shift(2,e.sz*20),jA(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Cu(e.color,t);var n=0;return n=2,t.write_shift(1,n),Ur(e.name,t),t.length>t.l?t.slice(0,t.l):t}var i8=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Sd,s8=la;function fy(e,t){t||(t=xe(84)),Sd||(Sd=Hu(i8));var r=Sd[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(Cu({auto:1},t),Cu({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function l8(e,t){var r=e.l+t,n=e.read_shift(2),i=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:i}}function k2(e,t,r){r||(r=xe(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Wc(e,t){return t||(t=xe(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var c8=la;function o8(e,t){return t||(t=xe(51)),t.write_shift(1,0),Wc(null,t),Wc(null,t),Wc(null,t),Wc(null,t),Wc(null,t),t.length>t.l?t.slice(0,t.l):t}function u8(e,t){return t||(t=xe(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Au(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function f8(e,t,r){var n=xe(2052);return n.write_shift(4,e),Au(t,n),Au(r,n),n.length>n.l?n.slice(0,n.l):n}function h8(e,t,r){var n={};n.NumberFmt=[];for(var i in it)n.NumberFmt[i]=it[i];n.CellXf=[],n.Fonts=[];var l=[],o=!1;return hi(e,function(h,d,g){switch(g){case 44:n.NumberFmt[h[0]]=h[1],li(h[1],h[0]);break;case 43:n.Fonts.push(h),h.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(h.color.rgb=Ru(t.themeElements.clrScheme[h.color.theme].rgb,h.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:l[l.length-1]==617&&n.CellXf.push(h);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:l.push(g),o=!0;break;case 38:l.pop(),o=!1;break;default:if(d.T>0)l.push(g);else if(d.T<0)l.pop();else if(!o||r.WTF&&l[l.length-1]!=37)throw new Error("Unexpected record 0x"+g.toString(16))}}),n}function d8(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&++r}),r!=0&&(Ae(e,615,En(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&Ae(e,44,r8(i,t[i]))}),Ae(e,616))}}function m8(e){var t=1;Ae(e,611,En(t)),Ae(e,43,n8({sz:12,color:{theme:1},name:"Calibri",family:2})),Ae(e,612)}function g8(e){var t=2;Ae(e,603,En(t)),Ae(e,45,fy({patternType:"none"})),Ae(e,45,fy({patternType:"gray125"})),Ae(e,604)}function x8(e){var t=1;Ae(e,613,En(t)),Ae(e,46,o8()),Ae(e,614)}function p8(e){var t=1;Ae(e,626,En(t)),Ae(e,47,k2({numFmtId:0},65535)),Ae(e,627)}function v8(e,t){Ae(e,617,En(t.length)),t.forEach(function(r){Ae(e,47,k2(r,0))}),Ae(e,618)}function y8(e){var t=1;Ae(e,619,En(t)),Ae(e,48,u8({xfId:0,name:"Normal"})),Ae(e,620)}function _8(e){var t=0;Ae(e,505,En(t)),Ae(e,506)}function w8(e){var t=0;Ae(e,508,f8(t,"TableStyleMedium9","PivotStyleMedium4")),Ae(e,509)}function b8(e,t){var r=Ta();return Ae(r,278),d8(r,e.SSF),m8(r),g8(r),x8(r),p8(r),v8(r,t.cellXfs),y8(r),_8(r),w8(r),Ae(r,279),r.end()}var S8=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function E8(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(ca)||[]).forEach(function(i){var l=ct(i);switch(l[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=l.val;break;case"<a:sysClr":n.rgb=l.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":l[0].charAt(1)==="/"?(t.themeElements.clrScheme[S8.indexOf(l[0])]=n,n={}):n.name=l[0].slice(3,l[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+l[0]+" in clrScheme")}})}function T8(){}function k8(){}var A8=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,C8=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,N8=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function O8(e,t,r){t.themeElements={};var n;[["clrScheme",A8,E8],["fontScheme",C8,T8],["fmtScheme",N8,k8]].forEach(function(i){if(!(n=e.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,t,r)})}var R8=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function A2(e,t){(!e||e.length===0)&&(e=Lm());var r,n={};if(!(r=e.match(R8)))throw new Error("themeElements not found in theme");return O8(r[0],n,t),n.raw=e,n}function Lm(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[_r];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function D8(e,t,r){var n=e.l+t,i=e.read_shift(4);if(i!==124226){if(!r.cellStyles){e.l=n;return}var l=e.slice(e.l);e.l=n;var o;try{o=y_(l,{type:"array"})}catch{return}var u=Va(o,"theme/theme/theme1.xml",!0);if(u)return A2(u,r)}}function F8(e){return e.read_shift(4)}function M8(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=L8(e,4);break;case 2:t.xclrValue=s2(e);break;case 3:t.xclrValue=F8(e);break;case 4:e.l+=4;break}return e.l+=8,t}function L8(e,t){return la(e,t)}function B8(e,t){return la(e,t)}function I8(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=M8(e);break;case 6:n[1]=B8(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function U8(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var i=e.read_shift(2),l=[];i-- >0;)l.push(I8(e,r-e.l));return{ixfe:n,ext:l}}function j8(e,t){t.forEach(function(r){r[0]})}function P8(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:sa(e)}}function z8(e){var t=xe(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Ur(e.name,t),t.slice(0,t.l)}function H8(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function V8(e){var t=xe(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function $8(e,t){var r=xe(8+2*t.length);return r.write_shift(4,e),Ur(t,r),r.slice(0,r.l)}function G8(e){return e.l+=4,e.read_shift(4)!=0}function q8(e,t){var r=xe(8);return r.write_shift(4,e),r.write_shift(4,1),r}function X8(e,t,r){var n={Types:[],Cell:[],Value:[]},i=r||{},l=[],o=!1,u=2;return hi(e,function(h,d,g){switch(g){case 335:n.Types.push({name:h.name});break;case 51:h.forEach(function(p){u==1?n.Cell.push({type:n.Types[p[0]-1].name,index:p[1]}):u==0&&n.Value.push({type:n.Types[p[0]-1].name,index:p[1]})});break;case 337:u=h?1:0;break;case 338:u=2;break;case 35:l.push(g),o=!0;break;case 36:l.pop(),o=!1;break;default:if(!d.T){if(!o||i.WTF&&l[l.length-1]!=35)throw new Error("Unexpected record 0x"+g.toString(16))}}}),n}function W8(){var e=Ta();return Ae(e,332),Ae(e,334,En(1)),Ae(e,335,z8({name:"XLDAPR",version:12e4,flags:3496657072})),Ae(e,336),Ae(e,339,$8(1,"XLDAPR")),Ae(e,52),Ae(e,35,En(514)),Ae(e,4096,En(0)),Ae(e,4097,on(1)),Ae(e,36),Ae(e,53),Ae(e,340),Ae(e,337,q8(1)),Ae(e,51,V8([[1,0]])),Ae(e,338),Ae(e,333),e.end()}function K8(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var i=!1,l=2,o;return e.replace(ca,function(u){var h=ct(u);switch(Ln(h[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:h.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<n.Types.length;++d)n.Types[d].name==h.name&&(o=n.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":l==1?n.Cell.push({type:n.Types[h.t-1].name,index:+h.v}):l==0&&n.Value.push({type:n.Types[h.t-1].name,index:+h.v});break;case"</rc>":break;case"<cellMetadata":l=1;break;case"</cellMetadata>":l=2;break;case"<valueMetadata":l=0;break;case"</valueMetadata>":l=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+h.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+h[0]+" in metadata")}return u}),n}function C2(){var e=[_r];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function Y8(e){var t=[];if(!e)return t;var r=1;return(e.match(ca)||[]).forEach(function(n){var i=ct(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,t.push(i);break}}),t}function J8(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=st(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function Q8(e,t,r){var n=[];return hi(e,function(l,o,u){switch(u){case 63:n.push(l);break;default:if(!o.T)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function Z8(e,t,r,n){if(!e)return e;var i=n||{},l=!1;hi(e,function(u,h,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:l=!0;break;case 36:l=!1;break;default:if(!h.T){if(!l||i.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},i)}function eN(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var jl=1024;function N2(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[Be("xml",null,{"xmlns:v":Ua.v,"xmlns:o":Ua.o,"xmlns:x":Ua.x,"xmlns:mv":Ua.mv}).replace(/\/>/,">"),Be("o:shapelayout",Be("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Be("v:shapetype",[Be("v:stroke",null,{joinstyle:"miter"}),Be("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];jl<e*1e3;)jl+=1e3;return t.forEach(function(l){var o=sr(l[0]),u={color2:"#BEFF82",type:"gradient"};u.type=="gradient"&&(u.angle="-180");var h=u.type=="gradient"?Be("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=Be("v:fill",h,u),g={on:"t",obscured:"t"};++jl,i=i.concat(["<v:shape"+wo({id:"_x0000_s"+jl,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(l[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,Be("v:shadow",null,g),Be("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Wr("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),Wr("x:AutoFill","False"),Wr("x:Row",String(o.r)),Wr("x:Column",String(o.c)),l[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function hy(e,t,r,n){var i=Array.isArray(e),l;t.forEach(function(o){var u=sr(o.ref);if(i?(e[u.r]||(e[u.r]=[]),l=e[u.r][u.c]):l=e[o.ref],!l){l={t:"z"},i?e[u.r][u.c]=l:e[o.ref]=l;var h=Ct(e["!ref"]||"BDWGO1000001:A1");h.s.r>u.r&&(h.s.r=u.r),h.e.r<u.r&&(h.e.r=u.r),h.s.c>u.c&&(h.s.c=u.c),h.e.c<u.c&&(h.e.c=u.c);var d=mt(h);d!==e["!ref"]&&(e["!ref"]=d)}l.c||(l.c=[]);var g={a:o.author,t:o.t,r:o.r,T:r};o.h&&(g.h=o.h);for(var p=l.c.length-1;p>=0;--p){if(!r&&l.c[p].T)return;r&&!l.c[p].T&&l.c.splice(p,1)}if(r&&n){for(p=0;p<n.length;++p)if(g.a==n[p].id){g.a=n[p].name||g.a;break}}l.c.push(g)})}function tN(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var u=o.match(/<(?:\w+:)?author[^>]*>(.*)/);u&&r.push(u[1])}});var l=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return l&&l[1]&&l[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var u=o.match(/<(?:\w+:)?comment[^>]*>/);if(u){var h=ct(u[0]),d={author:h.authorId&&r[h.authorId]||"sheetjsghost",ref:h.ref,guid:h.guid},g=sr(h.ref);if(!(t.sheetRows&&t.sheetRows<=g.r)){var p=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),v=!!p&&!!p[1]&&Dm(p[1])||{r:"",t:"",h:""};d.r=v.r,v.r=="<t></t>"&&(v.t=v.h=""),d.t=(v.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(d.h=v.h),n.push(d)}}}}),n}function O2(e){var t=[_r,Be("comments",null,{xmlns:Bs[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(i){var l=Pt(i.a);r.indexOf(l)==-1&&(r.push(l),t.push("<author>"+l+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),t.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var i=0,l=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(h){h.a&&(i=r.indexOf(Pt(h.a))),l.push(h.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),l.length<=1)t.push(Wr("t",Pt(l[0]||"")));else{for(var o=`Comment:
    `+l[0]+`
`,u=1;u<l.length;++u)o+=`Reply:
    `+l[u]+`
`;t.push(Wr("t",Pt(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function rN(e,t){var r=[],n=!1,i={},l=0;return e.replace(ca,function(u,h){var d=ct(u);switch(Ln(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":l=h+u.length;break;case"</text>":i.t=e.slice(l,h).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return u}),r}function aN(e,t,r){var n=[_r,Be("ThreadedComments",null,{xmlns:Rr.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(i){var l="";(i[1]||[]).forEach(function(o,u){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var h={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};u==0?l=h.id:h.parentId=l,o.ID=h.id,o.a&&(h.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),n.push(Be("threadedComment",Wr("text",o.t||""),h))})}),n.push("</ThreadedComments>"),n.join("")}function nN(e,t){var r=[],n=!1;return e.replace(ca,function(l){var o=ct(l);switch(Ln(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return l}),r}function iN(e){var t=[_r,Be("personList",null,{xmlns:Rr.TCMNT,"xmlns:x":Bs[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Be("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function sN(e){var t={};t.iauthor=e.read_shift(4);var r=Ps(e);return t.rfx=r.s,t.ref=st(r.s),e.l+=16,t}function lN(e,t){return t==null&&(t=xe(36)),t.write_shift(4,e[1].iauthor),ec(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var cN=sa;function oN(e){return Ur(e.slice(0,54))}function uN(e,t){var r=[],n=[],i={},l=!1;return hi(e,function(u,h,d){switch(d){case 632:n.push(u);break;case 635:i=u;break;case 637:i.t=u.t,i.h=u.h,i.r=u.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,t.sheetRows&&i.rfx&&t.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!h.T){if(!l||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),r}function fN(e){var t=Ta(),r=[];return Ae(t,628),Ae(t,630),e.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),Ae(t,632,oN(i.a)))})}),Ae(t,631),Ae(t,633),e.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var l={s:sr(n[0]),e:sr(n[0])};Ae(t,635,lN([l,i])),i.t&&i.t.length>0&&Ae(t,637,FA(i)),Ae(t,636),delete i.iauthor})}),Ae(t,634),Ae(t,629),t.end()}var hN="application/vnd.ms-office.vbaProject";function dN(e){var t=tt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");tt.utils.cfb_add(t,i,e.FileIndex[n].content)}}),tt.write(t)}function mN(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&tt.utils.cfb_add(e,i,t.FileIndex[n].content)}})}var R2=["xlsb","xlsm","xlam","biff8","xla"];function gN(){return{"!type":"dialog"}}function xN(){return{"!type":"dialog"}}function pN(){return{"!type":"macro"}}function vN(){return{"!type":"macro"}}var Vl=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,i,l,o){var u=!1,h=!1;l.length==0?h=!0:l.charAt(0)=="["&&(h=!0,l=l.slice(1,-1)),o.length==0?u=!0:o.charAt(0)=="["&&(u=!0,o=o.slice(1,-1));var d=l.length>0?parseInt(l,10)|0:0,g=o.length>0?parseInt(o,10)|0:0;return u?g+=t.c:--g,h?d+=t.r:--d,i+(u?"":"$")+ir(g)+(h?"":"$")+yr(d)}return function(i,l){return t=l,i.replace(e,r)}})(),Bm=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Im=(function(){return function(t,r){return t.replace(Bm,function(n,i,l,o,u,h){var d=Sm(o)-(l?0:r.c),g=bm(h)-(u?0:r.r),p=g==0?"":u?g+1:"["+g+"]",v=d==0?"":l?d+1:"["+d+"]";return i+"R"+p+"C"+v})}})();function D2(e,t){return e.replace(Bm,function(r,n,i,l,o,u){return n+(i=="$"?i+l:ir(Sm(l)+t.c))+(o=="$"?o+u:yr(bm(u)+t.r))})}function yN(e,t,r){var n=ka(t),i=n.s,l=sr(r),o={r:l.r-i.r,c:l.c-i.c};return D2(e,o)}function _N(e){return e.length!=1}function dy(e){return e.replace(/_xlfn\./g,"")}function Tr(e){e.l+=1}function Yi(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function F2(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return M2(e);r.biff==12&&(n=4)}var i=e.read_shift(n),l=e.read_shift(n),o=Yi(e),u=Yi(e);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:l,c:u[0],cRel:u[1],rRel:u[2]}}}function M2(e){var t=Yi(e),r=Yi(e),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function wN(e,t,r){if(r.biff<8)return M2(e);var n=e.read_shift(r.biff==12?4:2),i=e.read_shift(r.biff==12?4:2),l=Yi(e),o=Yi(e);return{s:{r:n,c:l[0],cRel:l[1],rRel:l[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function L2(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return bN(e);var n=e.read_shift(r&&r.biff==12?4:2),i=Yi(e);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function bN(e){var t=Yi(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function SN(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function EN(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return TN(e);var i=e.read_shift(n>=12?4:2),l=e.read_shift(2),o=(l&16384)>>14,u=(l&32768)>>15;if(l&=16383,u==1)for(;i>524287;)i-=1048576;if(o==1)for(;l>8191;)l=l-16384;return{r:i,c:l,cRel:o,rRel:u}}function TN(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),i==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:i,rRel:n}}function kN(e,t,r){var n=(e[e.l++]&96)>>5,i=F2(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function AN(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),l=8;if(r)switch(r.biff){case 5:e.l+=12,l=6;break;case 12:l=12;break}var o=F2(e,l,r);return[n,i,o]}function CN(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function NN(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),l=8;if(r)switch(r.biff){case 5:e.l+=12,l=6;break;case 12:l=12;break}return e.l+=l,[n,i]}function ON(e,t,r){var n=(e[e.l++]&96)>>5,i=wN(e,t-1,r);return[n,i]}function RN(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function my(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function DN(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),i=[],l=0;l<=n;++l)i.push(e.read_shift(r&&r.biff==2?1:2));return i}function FN(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function MN(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function LN(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function BN(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function B2(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function IN(e){return e.read_shift(2),B2(e)}function UN(e){return e.read_shift(2),B2(e)}function jN(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=L2(e,0,r);return[n,i]}function PN(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=EN(e,0,r);return[n,i]}function zN(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var l=L2(e,0,r);return[n,i,l]}function HN(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(r&&r.biff<=3?1:2);return[GO[i],j2[i],n]}function VN(e,t,r){var n=e[e.l++],i=e.read_shift(1),l=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:$N(e);return[i,(l[0]===0?j2:$O)[l[1]]]}function $N(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function GN(e,t,r){e.l+=r&&r.biff==2?3:4}function qN(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function XN(e){return e.l++,di[e.read_shift(1)]}function WN(e){return e.l++,e.read_shift(2)}function KN(e){return e.l++,e.read_shift(1)!==0}function YN(e){return e.l++,ia(e)}function JN(e,t,r){return e.l++,Mo(e,t-1,r)}function QN(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=vr(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=di[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=ia(e);break;case 2:r[1]=zs(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function ZN(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),i=[],l=0;l!=n;++l)i.push((r.biff==12?Ps:Gu)(e));return i}function eO(e,t,r){var n=0,i=0;r.biff==12?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var l=0,o=[];l!=n&&(o[l]=[]);++l)for(var u=0;u!=i;++u)o[l][u]=QN(e,r.biff);return o}function tO(e,t,r){var n=e.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,l=e.read_shift(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,l]}function rO(e,t,r){if(r.biff==5)return aO(e);var n=e.read_shift(1)>>>5&3,i=e.read_shift(2),l=e.read_shift(4);return[n,i,l]}function aO(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function nO(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function iO(e,t,r){var n=e.read_shift(1)>>>5&3,i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function sO(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function lO(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),l=4;if(r)switch(r.biff){case 5:l=15;break;case 12:l=6;break}return e.l+=l,[n,i]}var cO=la,oO=la,uO=la;function Bo(e,t,r){return e.l+=2,[SN(e)]}function Um(e){return e.l+=6,[]}var fO=Bo,hO=Um,dO=Um,mO=Bo;function I2(e){return e.l+=2,[Ar(e),e.read_shift(2)&1]}var gO=Bo,xO=I2,pO=Um,vO=Bo,yO=Bo,_O=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function wO(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),l=e.read_shift(2),o=_O[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:n,c:i,C:l}}function bO(e){return e.l+=2,[e.read_shift(4)]}function SO(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function EO(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function TO(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function kO(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function AO(e){return e.l+=4,[0,0]}var gy={1:{n:"PtgExp",f:qN},2:{n:"PtgTbl",f:uO},3:{n:"PtgAdd",f:Tr},4:{n:"PtgSub",f:Tr},5:{n:"PtgMul",f:Tr},6:{n:"PtgDiv",f:Tr},7:{n:"PtgPower",f:Tr},8:{n:"PtgConcat",f:Tr},9:{n:"PtgLt",f:Tr},10:{n:"PtgLe",f:Tr},11:{n:"PtgEq",f:Tr},12:{n:"PtgGe",f:Tr},13:{n:"PtgGt",f:Tr},14:{n:"PtgNe",f:Tr},15:{n:"PtgIsect",f:Tr},16:{n:"PtgUnion",f:Tr},17:{n:"PtgRange",f:Tr},18:{n:"PtgUplus",f:Tr},19:{n:"PtgUminus",f:Tr},20:{n:"PtgPercent",f:Tr},21:{n:"PtgParen",f:Tr},22:{n:"PtgMissArg",f:Tr},23:{n:"PtgStr",f:JN},26:{n:"PtgSheet",f:SO},27:{n:"PtgEndSheet",f:EO},28:{n:"PtgErr",f:XN},29:{n:"PtgBool",f:KN},30:{n:"PtgInt",f:WN},31:{n:"PtgNum",f:YN},32:{n:"PtgArray",f:RN},33:{n:"PtgFunc",f:HN},34:{n:"PtgFuncVar",f:VN},35:{n:"PtgName",f:tO},36:{n:"PtgRef",f:jN},37:{n:"PtgArea",f:kN},38:{n:"PtgMemArea",f:nO},39:{n:"PtgMemErr",f:cO},40:{n:"PtgMemNoMem",f:oO},41:{n:"PtgMemFunc",f:iO},42:{n:"PtgRefErr",f:sO},43:{n:"PtgAreaErr",f:CN},44:{n:"PtgRefN",f:PN},45:{n:"PtgAreaN",f:ON},46:{n:"PtgMemAreaN",f:TO},47:{n:"PtgMemNoMemN",f:kO},57:{n:"PtgNameX",f:rO},58:{n:"PtgRef3d",f:zN},59:{n:"PtgArea3d",f:AN},60:{n:"PtgRefErr3d",f:lO},61:{n:"PtgAreaErr3d",f:NN},255:{}},CO={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},NO={1:{n:"PtgElfLel",f:I2},2:{n:"PtgElfRw",f:vO},3:{n:"PtgElfCol",f:fO},6:{n:"PtgElfRwV",f:yO},7:{n:"PtgElfColV",f:mO},10:{n:"PtgElfRadical",f:gO},11:{n:"PtgElfRadicalS",f:pO},13:{n:"PtgElfColS",f:hO},15:{n:"PtgElfColSV",f:dO},16:{n:"PtgElfRadicalLel",f:xO},25:{n:"PtgList",f:wO},29:{n:"PtgSxName",f:bO},255:{}},OO={0:{n:"PtgAttrNoop",f:AO},1:{n:"PtgAttrSemi",f:BN},2:{n:"PtgAttrIf",f:MN},4:{n:"PtgAttrChoose",f:DN},8:{n:"PtgAttrGoto",f:FN},16:{n:"PtgAttrSum",f:GN},32:{n:"PtgAttrBaxcel",f:my},33:{n:"PtgAttrBaxcel",f:my},64:{n:"PtgAttrSpace",f:IN},65:{n:"PtgAttrSpaceSemi",f:UN},128:{n:"PtgAttrIfError",f:LN},255:{}};function Io(e,t,r,n){if(n.biff<8)return la(e,t);for(var i=e.l+t,l=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=eO(e,0,n),l.push(r[o][1]);break;case"PtgMemArea":r[o][2]=ZN(e,r[o][1],n),l.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=e.read_shift(4),l.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=i-e.l,t!==0&&l.push(la(e,t)),l}function Uo(e,t,r){for(var n=e.l+t,i,l,o=[];n!=e.l;)t=n-e.l,l=e[e.l],i=gy[l]||gy[CO[l]],(l===24||l===25)&&(i=(l===24?NO:OO)[e[e.l+1]]),!i||!i.f?la(e,t):o.push([i.n,i.f(e,t,r)]);return o}function RO(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],i=[],l=0;l<n.length;++l){var o=n[l];o?o[0]===2?i.push('"'+o[1].replace(/"/g,'""')+'"'):i.push(o[1]):i.push("")}t.push(i.join(","))}return t.join(";")}var DO={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function FO(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function U2(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[n[0]][0]){case 357:return i=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(l){return l.Name}).join(";;");default:return e[n[0]][0][3]?(i=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function xy(e,t,r){var n=U2(e,t,r);return n=="#REF"?n:FO(n,r)}function aa(e,t,r,n,i){var l=i&&i.biff||8,o={s:{c:0,r:0}},u=[],h,d,g,p=0,v=0,_,w="";if(!e[0]||!e[0][0])return"";for(var y=-1,S="",k=0,R=e[0].length;k<R;++k){var T=e[0][k];switch(T[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(h=u.pop(),d=u.pop(),y>=0){switch(e[0][y][1][0]){case 0:S=fr(" ",e[0][y][1][1]);break;case 1:S=fr("\r",e[0][y][1][1]);break;default:if(S="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][y][1][0])}d=d+S,y=-1}u.push(d+DO[T[0]]+h);break;case"PtgIsect":h=u.pop(),d=u.pop(),u.push(d+" "+h);break;case"PtgUnion":h=u.pop(),d=u.pop(),u.push(d+","+h);break;case"PtgRange":h=u.pop(),d=u.pop(),u.push(d+":"+h);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":g=ro(T[1][1],o,i),u.push(ao(g,l));break;case"PtgRefN":g=r?ro(T[1][1],r,i):T[1][1],u.push(ao(g,l));break;case"PtgRef3d":p=T[1][1],g=ro(T[1][2],o,i),w=xy(n,p,i),u.push(w+"!"+ao(g,l));break;case"PtgFunc":case"PtgFuncVar":var B=T[1][0],X=T[1][1];B||(B=0),B&=127;var M=B==0?[]:u.slice(-B);u.length-=B,X==="User"&&(X=M.shift()),u.push(X+"("+M.join(",")+")");break;case"PtgBool":u.push(T[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(T[1]);break;case"PtgNum":u.push(String(T[1]));break;case"PtgStr":u.push('"'+T[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(T[1]);break;case"PtgAreaN":_=Gv(T[1][1],r?{s:r}:o,i),u.push(yd(_,i));break;case"PtgArea":_=Gv(T[1][1],o,i),u.push(yd(_,i));break;case"PtgArea3d":p=T[1][1],_=T[1][2],w=xy(n,p,i),u.push(w+"!"+yd(_,i));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":v=T[1][2];var N=(n.names||[])[v-1]||(n[0]||[])[v],Z=N?N.Name:"SH33TJSNAME"+String(v);Z&&Z.slice(0,6)=="_xlfn."&&!i.xlfn&&(Z=Z.slice(6)),u.push(Z);break;case"PtgNameX":var q=T[1][1];v=T[1][2];var he;if(i.biff<=5)q<0&&(q=-q),n[q]&&(he=n[q][v]);else{var Y="";if(((n[q]||[])[0]||[])[0]==14849||(((n[q]||[])[0]||[])[0]==1025?n[q][v]&&n[q][v].itab>0&&(Y=n.SheetNames[n[q][v].itab-1]+"!"):Y=n.SheetNames[v-1]+"!"),n[q]&&n[q][v])Y+=n[q][v].Name;else if(n[0]&&n[0][v])Y+=n[0][v].Name;else{var Q=(U2(n,q,i)||"").split(";;");Q[v-1]?Y=Q[v-1]:Y+="SH33TJSERRX"}u.push(Y);break}he||(he={Name:"SH33TJSERRY"}),u.push(he.Name);break;case"PtgParen":var pe="(",Ce=")";if(y>=0){switch(S="",e[0][y][1][0]){case 2:pe=fr(" ",e[0][y][1][1])+pe;break;case 3:pe=fr("\r",e[0][y][1][1])+pe;break;case 4:Ce=fr(" ",e[0][y][1][1])+Ce;break;case 5:Ce=fr("\r",e[0][y][1][1])+Ce;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][y][1][0])}y=-1}u.push(pe+u.pop()+Ce);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":g={c:T[1][1],r:T[1][0]};var _e={c:r.c,r:r.r};if(n.sharedf[st(g)]){var te=n.sharedf[st(g)];u.push(aa(te,o,_e,n,i))}else{var se=!1;for(h=0;h!=n.arrayf.length;++h)if(d=n.arrayf[h],!(g.c<d[0].s.c||g.c>d[0].e.c)&&!(g.r<d[0].s.r||g.r>d[0].e.r)){u.push(aa(d[1],o,_e,n,i)),se=!0;break}se||u.push(T[1])}break;case"PtgArray":u.push("{"+RO(T[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":y=k;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+T[1].idx+"[#"+T[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(T));default:throw new Error("Unrecognized Formula Token: "+String(T))}var ge=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&y>=0&&ge.indexOf(e[0][k][0])==-1){T=e[0][y];var J=!0;switch(T[1][0]){case 4:J=!1;case 0:S=fr(" ",T[1][1]);break;case 5:J=!1;case 1:S=fr("\r",T[1][1]);break;default:if(S="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+T[1][0])}u.push((J?S:"")+u.pop()+(J?"":S)),y=-1}}if(u.length>1&&i.WTF)throw new Error("bad formula stack");return u[0]}function MO(e,t,r){var n=e.l+t,i=r.biff==2?1:2,l,o=e.read_shift(i);if(o==65535)return[[],la(e,t-2)];var u=Uo(e,o,r);return t!==o+i&&(l=Io(e,t-o-i,u,r)),e.l=n,[u,l]}function LO(e,t,r){var n=e.l+t,i=r.biff==2?1:2,l,o=e.read_shift(i);if(o==65535)return[[],la(e,t-2)];var u=Uo(e,o,r);return t!==o+i&&(l=Io(e,t-o-i,u,r)),e.l=n,[u,l]}function BO(e,t,r,n){var i=e.l+t,l=Uo(e,n,r),o;return i!==e.l&&(o=Io(e,i-e.l,l,r)),[l,o]}function IO(e,t,r){var n=e.l+t,i,l=e.read_shift(2),o=Uo(e,l,r);return l==65535?[[],la(e,t-2)]:(t!==l+2&&(i=Io(e,n-l-2,o,r)),[o,i])}function UO(e){var t;if(ii(e,e.l+6)!==65535)return[ia(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function jO(e){if(e==null){var t=xe(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Rs(e);return Rs(0)}function Ed(e,t,r){var n=e.l+t,i=Bn(e);r.biff==2&&++e.l;var l=UO(e),o=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var u=LO(e,n-e.l,r);return{cell:i,val:l[0],formula:u,shared:o>>3&1,tt:l[1]}}function PO(e,t,r,n,i){var l=Fs(t,r,i),o=jO(e.v),u=xe(6),h=33;u.write_shift(2,h),u.write_shift(4,0);for(var d=xe(e.bf.length),g=0;g<e.bf.length;++g)d[g]=e.bf[g];var p=Ir([l,o,u,d]);return p}function qu(e,t,r){var n=e.read_shift(4),i=Uo(e,n,r),l=e.read_shift(4),o=l>0?Io(e,l,i,r):null;return[i,o]}var zO=qu,Xu=qu,HO=qu,VO=qu,$O={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},j2={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},GO={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function py(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function qO(e){var t="of:="+e.replace(Bm,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Td(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function XO(e){return e.replace(/\./,"!")}var io={},$l={},so=typeof Map<"u";function jm(e,t,r){var n=0,i=e.length;if(r){if(so?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var l=so?r.get(t):r[t];n<l.length;++n)if(e[l[n]].t===t)return e.Count++,l[n]}}else for(;n<i;++n)if(e[n].t===t)return e.Count++,n;return e[i]={t},e.Count++,e.Unique++,r&&(so?(r.has(t)||r.set(t,[]),r.get(t).push(i)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(i))),i}function Wu(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(na=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=ko(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=Du(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Cs(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function es(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],i=60,l=e.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){li(t.z,i),r.ssf[i]=t.z,r.revssf[t.z]=n=i;break}}for(i=0;i!=l;++i)if(e[i].numFmtId===n)return i;return e[l]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},l}function P2(e,t,r,n,i,l){try{n.cellNF&&(e.z=it[t])}catch(u){if(n.WTF)throw u}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=er(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(it[t]==null&&li($k[t]||"General",t),e.t==="e")e.w=e.w||di[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=yo(e.v);else if(e.t==="d"){var o=Dr(e.v);(o|0)===o?e.w=o.toString(10):e.w=yo(o)}else{if(e.v===void 0)return"";e.w=Ns(e.v,$l)}else e.t==="d"?e.w=fn(t,Dr(e.v),$l):e.w=fn(t,e.v,$l)}catch(u){if(n.WTF)throw u}if(n.cellStyles&&r!=null)try{e.s=l.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Ru(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Ru(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(u){if(n.WTF&&l.Fills)throw u}}}function WO(e,t,r){if(e&&e["!ref"]){var n=Ct(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function KO(e,t){var r=Ct(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=mt(r))}var YO=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,JO=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,QO=/<(?:\w:)?hyperlink [^>]*>/mg,ZO=/"(\w*:\w*)"/,e5=/<(?:\w:)?col\b[^>]*[\/]?>/g,t5=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,r5=/<(?:\w:)?pageMargins[^>]*\/>/g,z2=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,a5=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,n5=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function i5(e,t,r,n,i,l,o){if(!e)return e;n||(n={"!id":{}});var u=t.dense?[]:{},h={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",g="",p=e.match(JO);p?(d=e.slice(0,p.index),g=e.slice(p.index+p[0].length)):d=g=e;var v=d.match(z2);v?Pm(v[0],u,i,r):(v=d.match(a5))&&l5(v[0],v[1]||"",u,i,r);var _=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(_>0){var w=d.slice(_,_+50).match(ZO);w&&KO(u,w[1])}var y=d.match(n5);y&&y[1]&&_5(y[1],i);var S=[];if(t.cellStyles){var k=d.match(e5);k&&g5(S,k)}p&&S5(p[1],u,t,h,l,o);var R=g.match(t5);R&&(u["!autofilter"]=p5(R[0]));var T=[],B=g.match(YO);if(B)for(_=0;_!=B.length;++_)T[_]=Ct(B[_].slice(B[_].indexOf('"')+1));var X=g.match(QO);X&&h5(u,X,n);var M=g.match(r5);if(M&&(u["!margins"]=d5(ct(M[0]))),!u["!ref"]&&h.e.c>=h.s.c&&h.e.r>=h.s.r&&(u["!ref"]=mt(h)),t.sheetRows>0&&u["!ref"]){var N=Ct(u["!ref"]);t.sheetRows<=+N.e.r&&(N.e.r=t.sheetRows-1,N.e.r>h.e.r&&(N.e.r=h.e.r),N.e.r<N.s.r&&(N.s.r=N.e.r),N.e.c>h.e.c&&(N.e.c=h.e.c),N.e.c<N.s.c&&(N.s.c=N.e.c),u["!fullref"]=u["!ref"],u["!ref"]=mt(N))}return S.length>0&&(u["!cols"]=S),T.length>0&&(u["!merges"]=T),u}function s5(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+mt(e[r])+'"/>';return t+"</mergeCells>"}function Pm(e,t,r,n){var i=ct(e);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=At(Gt(i.codeName)))}function l5(e,t,r,n,i){Pm(e.slice(0,e.indexOf(">")),r,n,i)}function c5(e,t,r,n,i){var l=!1,o={},u=null;if(n.bookType!=="xlsx"&&t.vbaraw){var h=t.SheetNames[r];try{t.Workbook&&(h=t.Workbook.Sheets[r].CodeName||h)}catch{}l=!0,o.codeName=Mn(Pt(h))}if(e&&e["!outline"]){var d={summaryBelow:1,summaryRight:1};e["!outline"].above&&(d.summaryBelow=0),e["!outline"].left&&(d.summaryRight=0),u=(u||"")+Be("outlinePr",null,d)}!l&&!u||(i[i.length]=Be("sheetPr",u,o))}var o5=["objects","scenarios","selectLockedCells","selectUnlockedCells"],u5=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function f5(e){var t={sheet:1};return o5.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),u5.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=Fm(e.password).toString(16).toUpperCase()),Be("sheetProtection",null,t)}function h5(e,t,r){for(var n=Array.isArray(e),i=0;i!=t.length;++i){var l=ct(Gt(t[i]),!0);if(!l.ref)return;var o=((r||{})["!id"]||[])[l.id];o?(l.Target=o.Target,l.location&&(l.Target+="#"+At(l.location))):(l.Target="#"+At(l.location),o={Target:l.Target,TargetMode:"Internal"}),l.Rel=o,l.tooltip&&(l.Tooltip=l.tooltip,delete l.tooltip);for(var u=Ct(l.ref),h=u.s.r;h<=u.e.r;++h)for(var d=u.s.c;d<=u.e.c;++d){var g=st({c:d,r:h});n?(e[h]||(e[h]=[]),e[h][d]||(e[h][d]={t:"z",v:void 0}),e[h][d].l=l):(e[g]||(e[g]={t:"z",v:void 0}),e[g].l=l)}}}function d5(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function m5(e){return Cs(e),Be("pageMargins",null,e)}function g5(e,t){for(var r=!1,n=0;n!=t.length;++n){var i=ct(t[n],!0);i.hidden&&(i.hidden=Zt(i.hidden));var l=parseInt(i.min,10)-1,o=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,Mm(i.width)),Ki(i);l<=o;)e[l++]=tr(i)}}function x5(e,t){for(var r=["<cols>"],n,i=0;i!=t.length;++i)(n=t[i])&&(r[r.length]=Be("col",null,Wu(i,n)));return r[r.length]="</cols>",r.join("")}function p5(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function v5(e,t,r,n){var i=typeof e.ref=="string"?e.ref:mt(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var l=r.Workbook.Names,o=ka(i);o.s.r==o.e.r&&(o.e.r=ka(t["!ref"]).e.r,i=mt(o));for(var u=0;u<l.length;++u){var h=l[u];if(h.Name=="_xlnm._FilterDatabase"&&h.Sheet==n){h.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return u==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),Be("autoFilter",null,{ref:i})}var y5=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function _5(e,t){t.Views||(t.Views=[{}]),(e.match(y5)||[]).forEach(function(r,n){var i=ct(r);t.Views[n]||(t.Views[n]={}),+i.zoomScale&&(t.Views[n].zoom=+i.zoomScale),Zt(i.rightToLeft)&&(t.Views[n].RTL=!0)})}function w5(e,t,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Be("sheetViews",Be("sheetView",null,i),{})}function b5(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var i="",l=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":i=e.v?"1":"0";break;case"n":i=""+e.v;break;case"e":i=di[e.v];break;case"d":n&&n.cellDates?i=er(e.v,-1).toISOString():(e=tr(e),e.t="n",i=""+(e.v=Dr(er(e.v)))),typeof e.z>"u"&&(e.z=it[14]);break;default:i=e.v;break}var u=Wr("v",Pt(i)),h={r:t},d=es(n.cellXfs,e,n);switch(d!==0&&(h.s=d),e.t){case"n":break;case"d":h.t="d";break;case"b":h.t="b";break;case"e":h.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){u=Wr("v",""+jm(n.Strings,e.v,n.revStrings)),h.t="s";break}h.t="str";break}if(e.t!=l&&(e.t=l,e.v=o),typeof e.f=="string"&&e.f){var g=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;u=Be("f",Pt(e.f),g)+(e.v!=null?u:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(h.cm=1),Be("c",u,h)}var S5=(function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,l=_o("v"),o=_o("f");return function(h,d,g,p,v,_){for(var w=0,y="",S=[],k=[],R=0,T=0,B=0,X="",M,N,Z=0,q=0,he,Y,Q=0,pe=0,Ce=Array.isArray(_.CellXf),_e,te=[],se=[],ge=Array.isArray(d),J=[],Oe={},I=!1,A=!!g.sheetStubs,z=h.split(t),U=0,G=z.length;U!=G;++U){y=z[U].trim();var ne=y.length;if(ne!==0){var we=0;e:for(w=0;w<ne;++w)switch(y[w]){case">":if(y[w-1]!="/"){++w;break e}if(g&&g.cellStyles){if(N=ct(y.slice(we,w),!0),Z=N.r!=null?parseInt(N.r,10):Z+1,q=-1,g.sheetRows&&g.sheetRows<Z)continue;Oe={},I=!1,N.ht&&(I=!0,Oe.hpt=parseFloat(N.ht),Oe.hpx=Wl(Oe.hpt)),N.hidden=="1"&&(I=!0,Oe.hidden=!0),N.outlineLevel!=null&&(I=!0,Oe.level=+N.outlineLevel),I&&(J[Z-1]=Oe)}break;case"<":we=w;break}if(we>=w)break;if(N=ct(y.slice(we,w),!0),Z=N.r!=null?parseInt(N.r,10):Z+1,q=-1,!(g.sheetRows&&g.sheetRows<Z)){p.s.r>Z-1&&(p.s.r=Z-1),p.e.r<Z-1&&(p.e.r=Z-1),g&&g.cellStyles&&(Oe={},I=!1,N.ht&&(I=!0,Oe.hpt=parseFloat(N.ht),Oe.hpx=Wl(Oe.hpt)),N.hidden=="1"&&(I=!0,Oe.hidden=!0),N.outlineLevel!=null&&(I=!0,Oe.level=+N.outlineLevel),I&&(J[Z-1]=Oe)),S=y.slice(w).split(e);for(var Te=0;Te!=S.length&&S[Te].trim().charAt(0)=="<";++Te);for(S=S.slice(Te),w=0;w!=S.length;++w)if(y=S[w].trim(),y.length!==0){if(k=y.match(r),R=w,T=0,B=0,y="<c "+(y.slice(0,1)=="<"?">":"")+y,k!=null&&k.length===2){for(R=0,X=k[1],T=0;T!=X.length&&!((B=X.charCodeAt(T)-64)<1||B>26);++T)R=26*R+B;--R,q=R}else++q;for(T=0;T!=y.length&&y.charCodeAt(T)!==62;++T);if(++T,N=ct(y.slice(0,T),!0),N.r||(N.r=st({r:Z-1,c:q})),X=y.slice(T),M={t:""},(k=X.match(l))!=null&&k[1]!==""&&(M.v=At(k[1])),g.cellFormula){if((k=X.match(o))!=null&&k[1]!==""){if(M.f=At(Gt(k[1])).replace(/\r\n/g,`
`),g.xlfn||(M.f=dy(M.f)),k[0].indexOf('t="array"')>-1)M.F=(X.match(i)||[])[1],M.F.indexOf(":")>-1&&te.push([Ct(M.F),M.F]);else if(k[0].indexOf('t="shared"')>-1){Y=ct(k[0]);var Se=At(Gt(k[1]));g.xlfn||(Se=dy(Se)),se[parseInt(Y.si,10)]=[Y,Se,N.r]}}else(k=X.match(/<f[^>]*\/>/))&&(Y=ct(k[0]),se[Y.si]&&(M.f=yN(se[Y.si][1],se[Y.si][2],N.r)));var Ne=sr(N.r);for(T=0;T<te.length;++T)Ne.r>=te[T][0].s.r&&Ne.r<=te[T][0].e.r&&Ne.c>=te[T][0].s.c&&Ne.c<=te[T][0].e.c&&(M.F=te[T][1])}if(N.t==null&&M.v===void 0)if(M.f||M.F)M.v=0,M.t="n";else if(A)M.t="z";else continue;else M.t=N.t||"n";switch(p.s.c>q&&(p.s.c=q),p.e.c<q&&(p.e.c=q),M.t){case"n":if(M.v==""||M.v==null){if(!A)continue;M.t="z"}else M.v=parseFloat(M.v);break;case"s":if(typeof M.v>"u"){if(!A)continue;M.t="z"}else he=io[parseInt(M.v,10)],M.v=he.t,M.r=he.r,g.cellHTML&&(M.h=he.h);break;case"str":M.t="s",M.v=M.v!=null?Gt(M.v):"",g.cellHTML&&(M.h=vm(M.v));break;case"inlineStr":k=X.match(n),M.t="s",k!=null&&(he=Dm(k[1]))?(M.v=he.t,g.cellHTML&&(M.h=he.h)):M.v="";break;case"b":M.v=Zt(M.v);break;case"d":g.cellDates?M.v=er(M.v,1):(M.v=Dr(er(M.v,1)),M.t="n");break;case"e":(!g||g.cellText!==!1)&&(M.w=M.v),M.v=V_[M.v];break}if(Q=pe=0,_e=null,Ce&&N.s!==void 0&&(_e=_.CellXf[N.s],_e!=null&&(_e.numFmtId!=null&&(Q=_e.numFmtId),g.cellStyles&&_e.fillId!=null&&(pe=_e.fillId))),P2(M,Q,pe,g,v,_),g.cellDates&&Ce&&M.t=="n"&&Jl(it[Q])&&(M.t="d",M.v=$u(M.v)),N.cm&&g.xlmeta){var ot=(g.xlmeta.Cell||[])[+N.cm-1];ot&&ot.type=="XLDAPR"&&(M.D=!0)}if(ge){var V=sr(N.r);d[V.r]||(d[V.r]=[]),d[V.r][V.c]=M}else d[N.r]=M}}}}J.length>0&&(d["!rows"]=J)}})();function E5(e,t,r,n){var i=[],l=[],o=Ct(e["!ref"]),u="",h,d="",g=[],p=0,v=0,_=e["!rows"],w=Array.isArray(e),y={r:d},S,k=-1;for(v=o.s.c;v<=o.e.c;++v)g[v]=ir(v);for(p=o.s.r;p<=o.e.r;++p){for(l=[],d=yr(p),v=o.s.c;v<=o.e.c;++v){h=g[v]+d;var R=w?(e[p]||[])[v]:e[h];R!==void 0&&(u=b5(R,h,e,t))!=null&&l.push(u)}(l.length>0||_&&_[p])&&(y={r:d},_&&_[p]&&(S=_[p],S.hidden&&(y.hidden=1),k=-1,S.hpx?k=Ao(S.hpx):S.hpt&&(k=S.hpt),k>-1&&(y.ht=k,y.customHeight=1),S.level&&(y.outlineLevel=S.level)),i[i.length]=Be("row",l.join(""),y))}if(_)for(;p<_.length;++p)_&&_[p]&&(y={r:p+1},S=_[p],S.hidden&&(y.hidden=1),k=-1,S.hpx?k=Ao(S.hpx):S.hpt&&(k=S.hpt),k>-1&&(y.ht=k,y.customHeight=1),S.level&&(y.outlineLevel=S.level),i[i.length]=Be("row","",y));return i.join("")}function H2(e,t,r,n){var i=[_r,Be("worksheet",null,{xmlns:Bs[0],"xmlns:r":Rr.r})],l=r.SheetNames[e],o=0,u="",h=r.Sheets[l];h==null&&(h={});var d=h["!ref"]||"A1",g=Ct(d);if(g.e.c>16383||g.e.r>1048575){if(t.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");g.e.c=Math.min(g.e.c,16383),g.e.r=Math.min(g.e.c,1048575),d=mt(g)}n||(n={}),h["!comments"]=[];var p=[];c5(h,r,e,t,i),i[i.length]=Be("dimension",null,{ref:d}),i[i.length]=w5(h,t,e,r),t.sheetFormat&&(i[i.length]=Be("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),h["!cols"]!=null&&h["!cols"].length>0&&(i[i.length]=x5(h,h["!cols"])),i[o=i.length]="<sheetData/>",h["!links"]=[],h["!ref"]!=null&&(u=E5(h,t),u.length>0&&(i[i.length]=u)),i.length>o+1&&(i[i.length]="</sheetData>",i[o]=i[o].replace("/>",">")),h["!protect"]&&(i[i.length]=f5(h["!protect"])),h["!autofilter"]!=null&&(i[i.length]=v5(h["!autofilter"],h,r,e)),h["!merges"]!=null&&h["!merges"].length>0&&(i[i.length]=s5(h["!merges"]));var v=-1,_,w=-1;return h["!links"].length>0&&(i[i.length]="<hyperlinks>",h["!links"].forEach(function(y){y[1].Target&&(_={ref:y[0]},y[1].Target.charAt(0)!="#"&&(w=jt(n,-1,Pt(y[1].Target).replace(/#.*$/,""),yt.HLINK),_["r:id"]="rId"+w),(v=y[1].Target.indexOf("#"))>-1&&(_.location=Pt(y[1].Target.slice(v+1))),y[1].Tooltip&&(_.tooltip=Pt(y[1].Tooltip)),i[i.length]=Be("hyperlink",null,_))}),i[i.length]="</hyperlinks>"),delete h["!links"],h["!margins"]!=null&&(i[i.length]=m5(h["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(i[i.length]=Wr("ignoredErrors",Be("ignoredError",null,{numberStoredAsText:1,sqref:d}))),p.length>0&&(w=jt(n,-1,"../drawings/drawing"+(e+1)+".xml",yt.DRAW),i[i.length]=Be("drawing",null,{"r:id":"rId"+w}),h["!drawing"]=p),h["!comments"].length>0&&(w=jt(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",yt.VML),i[i.length]=Be("legacyDrawing",null,{"r:id":"rId"+w}),h["!legacy"]=w),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function T5(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var l=e.read_shift(1);return e.l=n,l&7&&(r.level=l&7),l&16&&(r.hidden=!0),l&32&&(r.hpt=i/20),r}function k5(e,t,r){var n=xe(145),i=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var l=320;i.hpx?l=Ao(i.hpx)*20:i.hpt&&(l=i.hpt*20),n.write_shift(2,l),n.write_shift(1,0);var o=0;i.level&&(o|=i.level),i.hidden&&(o|=16),(i.hpx||i.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var u=0,h=n.l;n.l+=4;for(var d={r:e,c:0},g=0;g<16;++g)if(!(t.s.c>g+1<<10||t.e.c<g<<10)){for(var p=-1,v=-1,_=g<<10;_<g+1<<10;++_){d.c=_;var w=Array.isArray(r)?(r[d.r]||[])[d.c]:r[st(d)];w&&(p<0&&(p=_),v=_)}p<0||(++u,n.write_shift(4,p),n.write_shift(4,v))}var y=n.l;return n.l=h,n.write_shift(4,u),n.l=y,n.length>n.l?n.slice(0,n.l):n}function A5(e,t,r,n){var i=k5(n,r,t);(i.length>17||(t["!rows"]||[])[n])&&Ae(e,0,i)}var C5=Ps,N5=ec;function O5(){}function R5(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=MA(e),r}function D5(e,t,r){r==null&&(r=xe(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return Cu({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),U_(e,r),r.slice(0,r.l)}function F5(e){var t=hn(e);return[t]}function M5(e,t,r){return r==null&&(r=xe(8)),Is(t,r)}function L5(e){var t=Us(e);return[t]}function B5(e,t,r){return r==null&&(r=xe(4)),js(t,r)}function I5(e){var t=hn(e),r=e.read_shift(1);return[t,r,"b"]}function U5(e,t,r){return r==null&&(r=xe(9)),Is(t,r),r.write_shift(1,e.v?1:0),r}function j5(e){var t=Us(e),r=e.read_shift(1);return[t,r,"b"]}function P5(e,t,r){return r==null&&(r=xe(5)),js(t,r),r.write_shift(1,e.v?1:0),r}function z5(e){var t=hn(e),r=e.read_shift(1);return[t,r,"e"]}function H5(e,t,r){return r==null&&(r=xe(9)),Is(t,r),r.write_shift(1,e.v),r}function V5(e){var t=Us(e),r=e.read_shift(1);return[t,r,"e"]}function $5(e,t,r){return r==null&&(r=xe(8)),js(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function G5(e){var t=hn(e),r=e.read_shift(4);return[t,r,"s"]}function q5(e,t,r){return r==null&&(r=xe(12)),Is(t,r),r.write_shift(4,t.v),r}function X5(e){var t=Us(e),r=e.read_shift(4);return[t,r,"s"]}function W5(e,t,r){return r==null&&(r=xe(8)),js(t,r),r.write_shift(4,t.v),r}function K5(e){var t=hn(e),r=ia(e);return[t,r,"n"]}function Y5(e,t,r){return r==null&&(r=xe(16)),Is(t,r),Rs(e.v,r),r}function V2(e){var t=Us(e),r=ia(e);return[t,r,"n"]}function J5(e,t,r){return r==null&&(r=xe(12)),js(t,r),Rs(e.v,r),r}function Q5(e){var t=hn(e),r=Am(e);return[t,r,"n"]}function Z5(e,t,r){return r==null&&(r=xe(12)),Is(t,r),j_(e.v,r),r}function eR(e){var t=Us(e),r=Am(e);return[t,r,"n"]}function tR(e,t,r){return r==null&&(r=xe(8)),js(t,r),j_(e.v,r),r}function rR(e){var t=hn(e),r=Em(e);return[t,r,"is"]}function aR(e){var t=hn(e),r=sa(e);return[t,r,"str"]}function nR(e,t,r){return r==null&&(r=xe(12+4*e.v.length)),Is(t,r),Ur(e.v,r),r.length>r.l?r.slice(0,r.l):r}function iR(e){var t=Us(e),r=sa(e);return[t,r,"str"]}function sR(e,t,r){return r==null&&(r=xe(8+4*e.v.length)),js(t,r),Ur(e.v,r),r.length>r.l?r.slice(0,r.l):r}function lR(e,t,r){var n=e.l+t,i=hn(e);i.r=r["!row"];var l=e.read_shift(1),o=[i,l,"b"];if(r.cellFormula){e.l+=2;var u=Xu(e,n-e.l,r);o[3]=aa(u,null,i,r.supbooks,r)}else e.l=n;return o}function cR(e,t,r){var n=e.l+t,i=hn(e);i.r=r["!row"];var l=e.read_shift(1),o=[i,l,"e"];if(r.cellFormula){e.l+=2;var u=Xu(e,n-e.l,r);o[3]=aa(u,null,i,r.supbooks,r)}else e.l=n;return o}function oR(e,t,r){var n=e.l+t,i=hn(e);i.r=r["!row"];var l=ia(e),o=[i,l,"n"];if(r.cellFormula){e.l+=2;var u=Xu(e,n-e.l,r);o[3]=aa(u,null,i,r.supbooks,r)}else e.l=n;return o}function uR(e,t,r){var n=e.l+t,i=hn(e);i.r=r["!row"];var l=sa(e),o=[i,l,"str"];if(r.cellFormula){e.l+=2;var u=Xu(e,n-e.l,r);o[3]=aa(u,null,i,r.supbooks,r)}else e.l=n;return o}var fR=Ps,hR=ec;function dR(e,t){return t==null&&(t=xe(4)),t.write_shift(4,e),t}function mR(e,t){var r=e.l+t,n=Ps(e),i=Tm(e),l=sa(e),o=sa(e),u=sa(e);e.l=r;var h={rfx:n,relId:i,loc:l,display:u};return o&&(h.Tooltip=o),h}function gR(e,t){var r=xe(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));ec({s:sr(e[0]),e:sr(e[0])},r),km("rId"+t,r);var n=e[1].Target.indexOf("#"),i=n==-1?"":e[1].Target.slice(n+1);return Ur(i||"",r),Ur(e[1].Tooltip||"",r),Ur("",r),r.slice(0,r.l)}function xR(){}function pR(e,t,r){var n=e.l+t,i=P_(e),l=e.read_shift(1),o=[i];if(o[2]=l,r.cellFormula){var u=zO(e,n-e.l,r);o[1]=u}else e.l=n;return o}function vR(e,t,r){var n=e.l+t,i=Ps(e),l=[i];if(r.cellFormula){var o=VO(e,n-e.l,r);l[1]=o,e.l=n}else e.l=n;return l}function yR(e,t,r){r==null&&(r=xe(18));var n=Wu(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return t.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),t.level&&(i|=t.level<<8),r.write_shift(2,i),r}var $2=["left","right","top","bottom","header","footer"];function _R(e){var t={};return $2.forEach(function(r){t[r]=ia(e)}),t}function wR(e,t){return t==null&&(t=xe(48)),Cs(e),$2.forEach(function(r){Rs(e[r],t)}),t}function bR(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function SR(e,t,r){r==null&&(r=xe(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function ER(e){var t=xe(24);return t.write_shift(4,4),t.write_shift(4,1),ec(e,t),t}function TR(e,t){return t==null&&(t=xe(66)),t.write_shift(2,e.password?Fm(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function kR(){}function AR(){}function CR(e,t,r,n,i,l,o){if(!e)return e;var u=t||{};n||(n={"!id":{}});var h=u.dense?[]:{},d,g={s:{r:2e6,c:2e6},e:{r:0,c:0}},p=!1,v=!1,_,w,y,S,k,R,T,B,X,M=[];u.biff=12,u["!row"]=0;var N=0,Z=!1,q=[],he={},Y=u.supbooks||i.supbooks||[[]];if(Y.sharedf=he,Y.arrayf=q,Y.SheetNames=i.SheetNames||i.Sheets.map(function(ge){return ge.name}),!u.supbooks&&(u.supbooks=Y,i.Names))for(var Q=0;Q<i.Names.length;++Q)Y[0][Q+1]=i.Names[Q];var pe=[],Ce=[],_e=!1;Co[16]={n:"BrtShortReal",f:V2};var te;if(hi(e,function(J,Oe,I){if(!v)switch(I){case 148:d=J;break;case 0:_=J,u.sheetRows&&u.sheetRows<=_.r&&(v=!0),B=yr(S=_.r),u["!row"]=_.r,(J.hidden||J.hpt||J.level!=null)&&(J.hpt&&(J.hpx=Wl(J.hpt)),Ce[J.r]=J);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(w={t:J[2]},J[2]){case"n":w.v=J[1];break;case"s":T=io[J[1]],w.v=T.t,w.r=T.r;break;case"b":w.v=!!J[1];break;case"e":w.v=J[1],u.cellText!==!1&&(w.w=di[w.v]);break;case"str":w.t="s",w.v=J[1];break;case"is":w.t="s",w.v=J[1].t;break}if((y=o.CellXf[J[0].iStyleRef])&&P2(w,y.numFmtId,null,u,l,o),k=J[0].c==-1?k+1:J[0].c,u.dense?(h[S]||(h[S]=[]),h[S][k]=w):h[ir(k)+B]=w,u.cellFormula){for(Z=!1,N=0;N<q.length;++N){var A=q[N];_.r>=A[0].s.r&&_.r<=A[0].e.r&&k>=A[0].s.c&&k<=A[0].e.c&&(w.F=mt(A[0]),Z=!0)}!Z&&J.length>3&&(w.f=J[3])}if(g.s.r>_.r&&(g.s.r=_.r),g.s.c>k&&(g.s.c=k),g.e.r<_.r&&(g.e.r=_.r),g.e.c<k&&(g.e.c=k),u.cellDates&&y&&w.t=="n"&&Jl(it[y.numFmtId])){var z=Es(w.v);z&&(w.t="d",w.v=new Date(z.y,z.m-1,z.d,z.H,z.M,z.S,z.u))}te&&(te.type=="XLDAPR"&&(w.D=!0),te=void 0);break;case 1:case 12:if(!u.sheetStubs||p)break;w={t:"z",v:void 0},k=J[0].c==-1?k+1:J[0].c,u.dense?(h[S]||(h[S]=[]),h[S][k]=w):h[ir(k)+B]=w,g.s.r>_.r&&(g.s.r=_.r),g.s.c>k&&(g.s.c=k),g.e.r<_.r&&(g.e.r=_.r),g.e.c<k&&(g.e.c=k),te&&(te.type=="XLDAPR"&&(w.D=!0),te=void 0);break;case 176:M.push(J);break;case 49:te=((u.xlmeta||{}).Cell||[])[J-1];break;case 494:var U=n["!id"][J.relId];for(U?(J.Target=U.Target,J.loc&&(J.Target+="#"+J.loc),J.Rel=U):J.relId==""&&(J.Target="#"+J.loc),S=J.rfx.s.r;S<=J.rfx.e.r;++S)for(k=J.rfx.s.c;k<=J.rfx.e.c;++k)u.dense?(h[S]||(h[S]=[]),h[S][k]||(h[S][k]={t:"z",v:void 0}),h[S][k].l=J):(R=st({c:k,r:S}),h[R]||(h[R]={t:"z",v:void 0}),h[R].l=J);break;case 426:if(!u.cellFormula)break;q.push(J),X=u.dense?h[S][k]:h[ir(k)+B],X.f=aa(J[1],g,{r:_.r,c:k},Y,u),X.F=mt(J[0]);break;case 427:if(!u.cellFormula)break;he[st(J[0].s)]=J[1],X=u.dense?h[S][k]:h[ir(k)+B],X.f=aa(J[1],g,{r:_.r,c:k},Y,u);break;case 60:if(!u.cellStyles)break;for(;J.e>=J.s;)pe[J.e--]={width:J.w/256,hidden:!!(J.flags&1),level:J.level},_e||(_e=!0,Mm(J.w/256)),Ki(pe[J.e+1]);break;case 161:h["!autofilter"]={ref:mt(J)};break;case 476:h["!margins"]=J;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),J.name&&(i.Sheets[r].CodeName=J.name),(J.above||J.left)&&(h["!outline"]={above:J.above,left:J.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),J.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:p=!0;break;case 36:p=!1;break;case 37:p=!0;break;case 38:p=!1;break;default:if(!Oe.T){if(!p||u.WTF)throw new Error("Unexpected record 0x"+I.toString(16))}}},u),delete u.supbooks,delete u["!row"],!h["!ref"]&&(g.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(h["!ref"]=mt(d||g)),u.sheetRows&&h["!ref"]){var se=Ct(h["!ref"]);u.sheetRows<=+se.e.r&&(se.e.r=u.sheetRows-1,se.e.r>g.e.r&&(se.e.r=g.e.r),se.e.r<se.s.r&&(se.s.r=se.e.r),se.e.c>g.e.c&&(se.e.c=g.e.c),se.e.c<se.s.c&&(se.s.c=se.e.c),h["!fullref"]=h["!ref"],h["!ref"]=mt(se))}return M.length>0&&(h["!merges"]=M),pe.length>0&&(h["!cols"]=pe),Ce.length>0&&(h["!rows"]=Ce),h}function NR(e,t,r,n,i,l,o){if(t.v===void 0)return!1;var u="";switch(t.t){case"b":u=t.v?"1":"0";break;case"d":t=tr(t),t.z=t.z||it[14],t.v=Dr(er(t.v)),t.t="n";break;case"n":case"e":u=""+t.v;break;default:u=t.v;break}var h={r,c:n};switch(h.s=es(i.cellXfs,t,i),t.l&&l["!links"].push([st(h),t.l]),t.c&&l["!comments"].push([st(h),t.c]),t.t){case"s":case"str":return i.bookSST?(u=jm(i.Strings,t.v,i.revStrings),h.t="s",h.v=u,o?Ae(e,18,W5(t,h)):Ae(e,7,q5(t,h))):(h.t="str",o?Ae(e,17,sR(t,h)):Ae(e,6,nR(t,h))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?Ae(e,13,tR(t,h)):Ae(e,2,Z5(t,h)):o?Ae(e,16,J5(t,h)):Ae(e,5,Y5(t,h)),!0;case"b":return h.t="b",o?Ae(e,15,P5(t,h)):Ae(e,4,U5(t,h)),!0;case"e":return h.t="e",o?Ae(e,14,$5(t,h)):Ae(e,3,H5(t,h)),!0}return o?Ae(e,12,B5(t,h)):Ae(e,1,M5(t,h)),!0}function OR(e,t,r,n){var i=Ct(t["!ref"]||"A1"),l,o="",u=[];Ae(e,145);var h=Array.isArray(t),d=i.e.r;t["!rows"]&&(d=Math.max(i.e.r,t["!rows"].length-1));for(var g=i.s.r;g<=d;++g){o=yr(g),A5(e,t,i,g);var p=!1;if(g<=i.e.r)for(var v=i.s.c;v<=i.e.c;++v){g===i.s.r&&(u[v]=ir(v)),l=u[v]+o;var _=h?(t[g]||[])[v]:t[l];if(!_){p=!1;continue}p=NR(e,_,g,v,n,t,p)}}Ae(e,146)}function RR(e,t){!t||!t["!merges"]||(Ae(e,177,dR(t["!merges"].length)),t["!merges"].forEach(function(r){Ae(e,176,hR(r))}),Ae(e,178))}function DR(e,t){!t||!t["!cols"]||(Ae(e,390),t["!cols"].forEach(function(r,n){r&&Ae(e,60,yR(n,r))}),Ae(e,391))}function FR(e,t){!t||!t["!ref"]||(Ae(e,648),Ae(e,649,ER(Ct(t["!ref"]))),Ae(e,650))}function MR(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var i=jt(r,-1,n[1].Target.replace(/#.*$/,""),yt.HLINK);Ae(e,494,gR(n,i))}}),delete t["!links"]}function LR(e,t,r,n){if(t["!comments"].length>0){var i=jt(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",yt.VML);Ae(e,551,km("rId"+i)),t["!legacy"]=i}}function BR(e,t,r,n){if(t["!autofilter"]){var i=t["!autofilter"],l=typeof i.ref=="string"?i.ref:mt(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,u=ka(l);u.s.r==u.e.r&&(u.e.r=ka(t["!ref"]).e.r,l=mt(u));for(var h=0;h<o.length;++h){var d=o[h];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==n){d.Ref="'"+r.SheetNames[n]+"'!"+l;break}}h==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+l}),Ae(e,161,ec(Ct(l))),Ae(e,162)}}function IR(e,t,r){Ae(e,133),Ae(e,137,SR(t,r)),Ae(e,138),Ae(e,134)}function UR(e,t){t["!protect"]&&Ae(e,535,TR(t["!protect"]))}function jR(e,t,r,n){var i=Ta(),l=r.SheetNames[e],o=r.Sheets[l]||{},u=l;try{r&&r.Workbook&&(u=r.Workbook.Sheets[e].CodeName||u)}catch{}var h=Ct(o["!ref"]||"A1");if(h.e.c>16383||h.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],Ae(i,129),(r.vbaraw||o["!outline"])&&Ae(i,147,D5(u,o["!outline"])),Ae(i,148,N5(h)),IR(i,o,r.Workbook),DR(i,o),OR(i,o,e,t),UR(i,o),BR(i,o,r,e),RR(i,o),MR(i,o,n),o["!margins"]&&Ae(i,476,wR(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&FR(i,o),LR(i,o,e,n),Ae(i,130),i.end()}function PR(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(l){var o=l.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=r?+o[2]:o[2])});var i=At((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(l){n=l.replace(/<.*?>/g,"")}),[t,i,n]}function zR(e,t,r,n,i,l){var o=l||{"!type":"chart"};if(!e)return l;var u=0,h=0,d="A",g={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(p){var v=PR(p);g.s.r=g.s.c=0,g.e.c=u,d=ir(u),v[0].forEach(function(_,w){o[d+yr(w)]={t:"n",v:_,z:v[1]},h=w}),g.e.r<h&&(g.e.r=h),++u}),u>0&&(o["!ref"]=mt(g)),o}function HR(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var l={"!type":"chart","!drawel":null,"!rel":""},o,u=e.match(z2);return u&&Pm(u[0],l,i,r),(o=e.match(/drawing r:id="(.*?)"/))&&(l["!rel"]=o[1]),n["!id"][l["!rel"]]&&(l["!drawel"]=n["!id"][l["!rel"]]),l}function VR(e,t){e.l+=10;var r=sa(e);return{name:r}}function $R(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var l={"!type":"chart","!drawel":null,"!rel":""},o=!1;return hi(e,function(h,d,g){switch(g){case 550:l["!rel"]=h;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),h.name&&(i.Sheets[r].CodeName=h.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+g.toString(16))}}}},t),n["!id"][l["!rel"]]&&(l["!drawel"]=n["!id"][l["!rel"]]),l}var zm=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],GR=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],qR=[],XR=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function vy(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],i=0;i!=t.length;++i){var l=t[i];if(n[l[0]]==null)n[l[0]]=l[1];else switch(l[2]){case"bool":typeof n[l[0]]=="string"&&(n[l[0]]=Zt(n[l[0]]));break;case"int":typeof n[l[0]]=="string"&&(n[l[0]]=parseInt(n[l[0]],10));break}}}function yy(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Zt(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function G2(e){yy(e.WBProps,zm),yy(e.CalcPr,XR),vy(e.WBView,GR),vy(e.Sheets,qR),$l.date1904=Zt(e.WBProps.date1904)}function WR(e){return!e.Workbook||!e.Workbook.WBProps?"false":Zt(e.Workbook.WBProps.date1904)?"true":"false"}var KR="][*?/\\".split("");function q2(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return KR.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function YR(e,t,r){e.forEach(function(n,i){q2(n);for(var l=0;l<i;++l)if(n==e[l])throw new Error("Duplicate Sheet Name: "+n);if(r){var o=t&&t[i]&&t[i].CodeName||n;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function JR(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];YR(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)WO(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var QR=/<\w+:workbook/;function ZR(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",l={},o=0;if(e.replace(ca,function(h,d){var g=ct(h);switch(Ln(g[0])){case"<?xml":break;case"<workbook":h.match(QR)&&(i="xmlns"+h.match(/<(\w+):/)[1]),r.xmlns=g[i];break;case"</workbook>":break;case"<fileVersion":delete g[0],r.AppVersion=g;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":zm.forEach(function(p){if(g[p[0]]!=null)switch(p[2]){case"bool":r.WBProps[p[0]]=Zt(g[p[0]]);break;case"int":r.WBProps[p[0]]=parseInt(g[p[0]],10);break;default:r.WBProps[p[0]]=g[p[0]]}}),g.codeName&&(r.WBProps.CodeName=Gt(g.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete g[0],r.WBView.push(g);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(g.state){case"hidden":g.Hidden=1;break;case"veryHidden":g.Hidden=2;break;default:g.Hidden=0}delete g.state,g.name=At(Gt(g.name)),delete g[0],r.Sheets.push(g);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":l={},l.Name=Gt(g.name),g.comment&&(l.Comment=g.comment),g.localSheetId&&(l.Sheet=+g.localSheetId),Zt(g.hidden||"0")&&(l.Hidden=!0),o=d+h.length;break;case"</definedName>":l.Ref=At(Gt(e.slice(o,d))),r.Names.push(l);break;case"<definedName/>":break;case"<calcPr":delete g[0],r.CalcPr=g;break;case"<calcPr/>":delete g[0],r.CalcPr=g;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+g[0]+" in workbook")}return h}),Bs.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return G2(r),r}function X2(e){var t=[_r];t[t.length]=Be("workbook",null,{xmlns:Bs[0],"xmlns:r":Rr.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(zm.forEach(function(u){e.Workbook.WBProps[u[0]]!=null&&e.Workbook.WBProps[u[0]]!=u[1]&&(n[u[0]]=e.Workbook.WBProps[u[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Be("workbookPr",null,n);var i=e.Workbook&&e.Workbook.Sheets||[],l=0;if(i&&i[0]&&i[0].Hidden){for(t[t.length]="<bookViews>",l=0;l!=e.SheetNames.length&&!(!i[l]||!i[l].Hidden);++l);l==e.SheetNames.length&&(l=0),t[t.length]='<workbookView firstSheet="'+l+'" activeTab="'+l+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",l=0;l!=e.SheetNames.length;++l){var o={name:Pt(e.SheetNames[l].slice(0,31))};if(o.sheetId=""+(l+1),o["r:id"]="rId"+(l+1),i[l])switch(i[l].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=Be("sheet",null,o)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(u){var h={name:u.Name};u.Comment&&(h.comment=u.Comment),u.Sheet!=null&&(h.localSheetId=""+u.Sheet),u.Hidden&&(h.hidden="1"),u.Ref&&(t[t.length]=Be("definedName",Pt(u.Ref),h))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function eD(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=$d(e),r.name=sa(e),r}function tD(e,t){return t||(t=xe(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),km(e.strRelID,t),Ur(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function rD(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var i=t>8?sa(e):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function aD(e,t){t||(t=xe(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),U_(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function nD(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function iD(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),l=LA(e),o=HO(e,0,r),u=Tm(e);e.l=n;var h={Name:l,Ptg:o};return i<268435455&&(h.Sheet=i),u&&(h.Comment=u),h}function sD(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;t||(t={}),t.biff=12;var l=[],o=[[]];return o.SheetNames=[],o.XTI=[],Co[16]={n:"BrtFRTArchID$",f:nD},hi(e,function(h,d,g){switch(g){case 156:o.SheetNames.push(h.name),r.Sheets.push(h);break;case 153:r.WBProps=h;break;case 39:h.Sheet!=null&&(t.SID=h.Sheet),h.Ref=aa(h.Ptg,null,null,o,t),delete t.SID,delete h.Ptg,l.push(h);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([g,h]):o[0]=[g,h],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(h),o.XTI=o.XTI.concat(h);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(g),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(g),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!d.T){if(!i||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+g.toString(16))}}},t),G2(r),r.Names=l,r.supbooks=o,r}function lD(e,t){Ae(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};Ae(e,156,tD(i))}Ae(e,144)}function cD(e,t){t||(t=xe(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Ur("SheetJS",t),Ur(wu.version,t),Ur(wu.version,t),Ur("7262",t),t.length>t.l?t.slice(0,t.l):t}function oD(e,t){t||(t=xe(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function uD(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,i=-1,l=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&l==-1&&(l=n);l>i||(Ae(e,135),Ae(e,158,oD(i)),Ae(e,136))}}function fD(e,t){var r=Ta();return Ae(r,131),Ae(r,128,cD()),Ae(r,153,aD(e.Workbook&&e.Workbook.WBProps||null)),uD(r,e),lD(r,e),Ae(r,132),r.end()}function hD(e,t,r){return t.slice(-4)===".bin"?sD(e,r):ZR(e,r)}function dD(e,t,r,n,i,l,o,u){return t.slice(-4)===".bin"?CR(e,n,r,i,l,o,u):i5(e,n,r,i,l,o,u)}function mD(e,t,r,n,i,l,o,u){return t.slice(-4)===".bin"?$R(e,n,r,i,l):HR(e,n,r,i,l)}function gD(e,t,r,n,i,l,o,u){return t.slice(-4)===".bin"?pN():vN()}function xD(e,t,r,n,i,l,o,u){return t.slice(-4)===".bin"?gN():xN()}function pD(e,t,r,n){return t.slice(-4)===".bin"?h8(e,r,n):e8(e,r,n)}function vD(e,t,r){return A2(e,r)}function yD(e,t,r){return t.slice(-4)===".bin"?y6(e,r):x6(e,r)}function _D(e,t,r){return t.slice(-4)===".bin"?uN(e,r):tN(e,r)}function wD(e,t,r){return t.slice(-4)===".bin"?Q8(e):Y8(e)}function bD(e,t,r,n){return r.slice(-4)===".bin"?Z8(e,t,r,n):void 0}function SD(e,t,r){return t.slice(-4)===".bin"?X8(e,t,r):K8(e,t,r)}function ED(e,t,r){return(t.slice(-4)===".bin"?fD:X2)(e)}function TD(e,t,r,n,i){return(t.slice(-4)===".bin"?jR:H2)(e,r,n,i)}function kD(e,t,r){return(t.slice(-4)===".bin"?b8:T2)(e,r)}function AD(e,t,r){return(t.slice(-4)===".bin"?b6:p2)(e,r)}function CD(e,t,r){return(t.slice(-4)===".bin"?fN:O2)(e)}function ND(e){return(e.slice(-4)===".bin"?W8:C2)()}var W2=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,K2=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function pn(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=e.match(W2),l,o,u,h;if(i)for(h=0;h!=i.length;++h)l=i[h].match(K2),(o=l[1].indexOf(":"))===-1?n[l[1]]=l[2].slice(1,l[2].length-1):(l[1].slice(0,6)==="xmlns:"?u="xmlns"+l[1].slice(6):u=l[1].slice(o+1),n[u]=l[2].slice(1,l[2].length-1));return n}function OD(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(W2),i,l,o,u;if(n)for(u=0;u!=n.length;++u)i=n[u].match(K2),(l=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(l+1),r[o]=i[2].slice(1,i[2].length-1));return r}var lo;function RD(e,t){var r=lo[e]||At(e);return r==="General"?Ns(t):fn(r,t)}function DD(e,t,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=Zt(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=er(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[At(t)]=i}function FD(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||di[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=yo(e.v):e.w=Ns(e.v):e.w=RD(t||"General",e.v)}catch(l){if(r.WTF)throw l}try{var n=lo[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&Jl(n)){var i=Es(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(l){if(r.WTF)throw l}}}function MD(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=q6[n.Pattern]||n.Pattern)}e[t.ID]=t}function LD(e,t,r,n,i,l,o,u,h,d){var g="General",p=n.StyleID,v={};d=d||{};var _=[],w=0;for(p===void 0&&u&&(p=u.StyleID),p===void 0&&o&&(p=o.StyleID);l[p]!==void 0&&(l[p].nf&&(g=l[p].nf),l[p].Interior&&_.push(l[p].Interior),!!l[p].Parent);)p=l[p].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Zt(e);break;case"String":n.t="s",n.r=Bv(At(e)),n.v=e.indexOf("<")>-1?At(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(er(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=At(e):n.v<60&&(n.v=n.v-1),(!g||g=="General")&&(g="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=V_[e],d.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=Bv(t||e));break}if(FD(n,g,d),d.cellFormula!==!1)if(n.Formula){var y=At(n.Formula);y.charCodeAt(0)==61&&(y=y.slice(1)),n.f=Vl(y,i),delete n.Formula,n.ArrayRange=="RC"?n.F=Vl("RC:RC",i):n.ArrayRange&&(n.F=Vl(n.ArrayRange,i),h.push([Ct(n.F),n.F]))}else for(w=0;w<h.length;++w)i.r>=h[w][0].s.r&&i.r<=h[w][0].e.r&&i.c>=h[w][0].s.c&&i.c<=h[w][0].e.c&&(n.F=h[w][1]);d.cellStyles&&(_.forEach(function(S){!v.patternType&&S.patternType&&(v.patternType=S.patternType)}),n.s=v),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function BD(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function kd(e,t){var r=t||{};Ql();var n=Yc(ym(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Gt(n));var i=n.slice(0,1024).toLowerCase(),l=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var o=tr(r);return o.type="string",Xl.to_workbook(n,o)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(zt){i.indexOf("<"+zt)>=0&&(l=!0)}),l)return wF(n,r);lo={"General Number":"General","General Date":it[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":it[15],"Short Date":it[14],"Long Time":it[19],"Medium Time":it[18],"Short Time":it[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:it[2],Standard:it[4],Percent:it[10],Scientific:it[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var u,h=[],d,g={},p=[],v=r.dense?[]:{},_="",w={},y={},S=pn('<Data ss:Type="String">'),k=0,R=0,T=0,B={s:{r:2e6,c:2e6},e:{r:0,c:0}},X={},M={},N="",Z=0,q=[],he={},Y={},Q=0,pe=[],Ce=[],_e={},te=[],se,ge=!1,J=[],Oe=[],I={},A=0,z=0,U={Sheets:[],WBProps:{date1904:!1}},G={};bo.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ne="";u=bo.exec(n);)switch(u[3]=(ne=u[3]).toLowerCase()){case"data":if(ne=="data"){if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break}if(h[h.length-1][1])break;u[1]==="/"?LD(n.slice(k,u.index),N,S,h[h.length-1][0]=="comment"?_e:w,{c:R,r:T},X,te[R],y,J,r):(N="",S=pn(u[0]),k=u.index+u[0].length);break;case"cell":if(u[1]==="/")if(Ce.length>0&&(w.c=Ce),(!r.sheetRows||r.sheetRows>T)&&w.v!==void 0&&(r.dense?(v[T]||(v[T]=[]),v[T][R]=w):v[ir(R)+yr(T)]=w),w.HRef&&(w.l={Target:At(w.HRef)},w.HRefScreenTip&&(w.l.Tooltip=w.HRefScreenTip),delete w.HRef,delete w.HRefScreenTip),(w.MergeAcross||w.MergeDown)&&(A=R+(parseInt(w.MergeAcross,10)|0),z=T+(parseInt(w.MergeDown,10)|0),q.push({s:{c:R,r:T},e:{c:A,r:z}})),!r.sheetStubs)w.MergeAcross?R=A+1:++R;else if(w.MergeAcross||w.MergeDown){for(var we=R;we<=A;++we)for(var Te=T;Te<=z;++Te)(we>R||Te>T)&&(r.dense?(v[Te]||(v[Te]=[]),v[Te][we]={t:"z"}):v[ir(we)+yr(Te)]={t:"z"});R=A+1}else++R;else w=OD(u[0]),w.Index&&(R=+w.Index-1),R<B.s.c&&(B.s.c=R),R>B.e.c&&(B.e.c=R),u[0].slice(-2)==="/>"&&++R,Ce=[];break;case"row":u[1]==="/"||u[0].slice(-2)==="/>"?(T<B.s.r&&(B.s.r=T),T>B.e.r&&(B.e.r=T),u[0].slice(-2)==="/>"&&(y=pn(u[0]),y.Index&&(T=+y.Index-1)),R=0,++T):(y=pn(u[0]),y.Index&&(T=+y.Index-1),I={},(y.AutoFitHeight=="0"||y.Height)&&(I.hpx=parseInt(y.Height,10),I.hpt=Ao(I.hpx),Oe[T]=I),y.Hidden=="1"&&(I.hidden=!0,Oe[T]=I));break;case"worksheet":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"));p.push(_),B.s.r<=B.e.r&&B.s.c<=B.e.c&&(v["!ref"]=mt(B),r.sheetRows&&r.sheetRows<=B.e.r&&(v["!fullref"]=v["!ref"],B.e.r=r.sheetRows-1,v["!ref"]=mt(B))),q.length&&(v["!merges"]=q),te.length>0&&(v["!cols"]=te),Oe.length>0&&(v["!rows"]=Oe),g[_]=v}else B={s:{r:2e6,c:2e6},e:{r:0,c:0}},T=R=0,h.push([u[3],!1]),d=pn(u[0]),_=At(d.Name),v=r.dense?[]:{},q=[],J=[],Oe=[],G={name:_,Hidden:0},U.Sheets.push(G);break;case"table":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else{if(u[0].slice(-2)=="/>")break;h.push([u[3],!1]),te=[],ge=!1}break;case"style":u[1]==="/"?MD(X,M,r):M=pn(u[0]);break;case"numberformat":M.nf=At(pn(u[0]).Format||"General"),lo[M.nf]&&(M.nf=lo[M.nf]);for(var Se=0;Se!=392&&it[Se]!=M.nf;++Se);if(Se==392){for(Se=57;Se!=392;++Se)if(it[Se]==null){li(M.nf,Se);break}}break;case"column":if(h[h.length-1][0]!=="table")break;if(se=pn(u[0]),se.Hidden&&(se.hidden=!0,delete se.Hidden),se.Width&&(se.wpx=parseInt(se.Width,10)),!ge&&se.wpx>10){ge=!0,na=S2;for(var Ne=0;Ne<te.length;++Ne)te[Ne]&&Ki(te[Ne])}ge&&Ki(se),te[se.Index-1||te.length]=se;for(var ot=0;ot<+se.Span;++ot)te[te.length]=tr(se);break;case"namedrange":if(u[1]==="/")break;U.Names||(U.Names=[]);var V=ct(u[0]),Nt={Name:V.Name,Ref:Vl(V.RefersTo.slice(1),{r:0,c:0})};U.Sheets.length>0&&(Nt.Sheet=U.Sheets.length-1),U.Names.push(Nt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(u[0].slice(-2)==="/>")break;u[1]==="/"?N+=n.slice(Z,u.index):Z=u.index+u[0].length;break;case"interior":if(!r.cellStyles)break;M.Interior=pn(u[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(u[0].slice(-2)==="/>")break;u[1]==="/"?s3(he,ne,n.slice(Q,u.index)):Q=u.index+u[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else h.push([u[3],!1]);break;case"comment":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"));BD(_e),Ce.push(_e)}else h.push([u[3],!1]),d=pn(u[0]),_e={a:d.Author};break;case"autofilter":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else if(u[0].charAt(u[0].length-2)!=="/"){var lt=pn(u[0]);v["!autofilter"]={ref:Vl(lt.Range).replace(/\$/g,"")},h.push([u[3],!0])}break;case"name":break;case"datavalidation":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break;case"null":break;default:if(h.length==0&&u[3]=="document"||h.length==0&&u[3]=="uof")return Ey(n,r);var Tt=!0;switch(h[h.length-1][0]){case"officedocumentsettings":switch(u[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Tt=!1}break;case"componentoptions":switch(u[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Tt=!1}break;case"excelworkbook":switch(u[3]){case"date1904":U.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Tt=!1}break;case"workbookoptions":switch(u[3]){case"owcversion":break;case"height":break;case"width":break;default:Tt=!1}break;case"worksheetoptions":switch(u[3]){case"visible":if(u[0].slice(-2)!=="/>")if(u[1]==="/")switch(n.slice(Q,u.index)){case"SheetHidden":G.Hidden=1;break;case"SheetVeryHidden":G.Hidden=2;break}else Q=u.index+u[0].length;break;case"header":v["!margins"]||Cs(v["!margins"]={},"xlml"),isNaN(+ct(u[0]).Margin)||(v["!margins"].header=+ct(u[0]).Margin);break;case"footer":v["!margins"]||Cs(v["!margins"]={},"xlml"),isNaN(+ct(u[0]).Margin)||(v["!margins"].footer=+ct(u[0]).Margin);break;case"pagemargins":var ft=ct(u[0]);v["!margins"]||Cs(v["!margins"]={},"xlml"),isNaN(+ft.Top)||(v["!margins"].top=+ft.Top),isNaN(+ft.Left)||(v["!margins"].left=+ft.Left),isNaN(+ft.Right)||(v["!margins"].right=+ft.Right),isNaN(+ft.Bottom)||(v["!margins"].bottom=+ft.Bottom);break;case"displayrighttoleft":U.Views||(U.Views=[]),U.Views[0]||(U.Views[0]={}),U.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":v["!outline"]||(v["!outline"]={}),v["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":v["!outline"]||(v["!outline"]={}),v["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Tt=!1}break;case"pivottable":case"pivotcache":switch(u[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Tt=!1}break;case"pagebreaks":switch(u[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Tt=!1}break;case"autofilter":switch(u[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Tt=!1}break;case"querytable":switch(u[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Tt=!1}break;case"datavalidation":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Tt=!1}break;case"sorting":case"conditionalformatting":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Tt=!1}break;case"mapinfo":case"schema":case"data":switch(u[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Tt=!1}break;case"smarttags":break;default:Tt=!1;break}if(Tt||u[3].match(/!\[CDATA/))break;if(!h[h.length-1][1])throw"Unrecognized tag: "+u[3]+"|"+h.join("|");if(h[h.length-1][0]==="customdocumentproperties"){if(u[0].slice(-2)==="/>")break;u[1]==="/"?DD(Y,ne,pe,n.slice(Q,u.index)):(pe=u,Q=u.index+u[0].length);break}if(r.WTF)throw"Unrecognized tag: "+u[3]+"|"+h.join("|")}var je={};return!r.bookSheets&&!r.bookProps&&(je.Sheets=g),je.SheetNames=p,je.Workbook=U,je.SSF=tr(it),je.Props=he,je.Custprops=Y,je}function Jd(e,t){switch(Vm(t=t||{}),t.type||"base64"){case"base64":return kd($a(e),t);case"binary":case"buffer":case"file":return kd(e,t);case"array":return kd(Qi(e),t)}}function ID(e,t){var r=[];return e.Props&&r.push(l3(e.Props,t)),e.Custprops&&r.push(c3(e.Props,e.Custprops)),r.join("")}function UD(){return""}function jD(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,i){var l=[];l.push(Be("NumberFormat",null,{"ss:Format":Pt(it[n.numFmtId])}));var o={"ss:ID":"s"+(21+i)};r.push(Be("Style",l.join(""),o))}),Be("Styles",r.join(""))}function Y2(e){return Be("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Im(e.Ref,{r:0,c:0})})}function PD(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var i=t[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(Y2(i)))}return Be("Names",r.join(""))}function zD(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,l=[],o=0;o<i.length;++o){var u=i[o];u.Sheet==r&&(u.Name.match(/^_xlfn\./)||l.push(Y2(u)))}return l.join("")}function HD(e,t,r,n){if(!e)return"";var i=[];if(e["!margins"]&&(i.push("<PageSetup>"),e["!margins"].header&&i.push(Be("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&i.push(Be("Footer",null,{"x:Margin":e["!margins"].footer})),i.push(Be("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(Be("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var l=0;l<r&&!(n.Workbook.Sheets[l]&&!n.Workbook.Sheets[l].Hidden);++l);l==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),e["!protect"]&&(i.push(Wr("ProtectContents","True")),e["!protect"].objects&&i.push(Wr("ProtectObjects","True")),e["!protect"].scenarios&&i.push(Wr("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?i.push(Wr("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&i.push(Wr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&i.push("<"+o[1]+"/>")})),i.length==0?"":Be("WorksheetOptions",i.join(""),{xmlns:Ua.x})}function VD(e){return e.map(function(t){var r=uA(t.t||""),n=Be("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Be("Comment",n,{"ss:Author":t.a})}).join("")}function $D(e,t,r,n,i,l,o){if(!e||e.v==null&&e.f==null)return"";var u={};if(e.f&&(u["ss:Formula"]="="+Pt(Im(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var h=sr(e.F.slice(t.length+1));u["ss:ArrayRange"]="RC:R"+(h.r==o.r?"":"["+(h.r-o.r)+"]")+"C"+(h.c==o.c?"":"["+(h.c-o.c)+"]")}if(e.l&&e.l.Target&&(u["ss:HRef"]=Pt(e.l.Target),e.l.Tooltip&&(u["x:HRefScreenTip"]=Pt(e.l.Tooltip))),r["!merges"])for(var d=r["!merges"],g=0;g!=d.length;++g)d[g].s.c!=o.c||d[g].s.r!=o.r||(d[g].e.c>d[g].s.c&&(u["ss:MergeAcross"]=d[g].e.c-d[g].s.c),d[g].e.r>d[g].s.r&&(u["ss:MergeDown"]=d[g].e.r-d[g].s.r));var p="",v="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":p="Number",v=String(e.v);break;case"b":p="Boolean",v=e.v?"1":"0";break;case"e":p="Error",v=di[e.v];break;case"d":p="DateTime",v=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||it[14]);break;case"s":p="String",v=oA(e.v||"");break}var _=es(n.cellXfs,e,n);u["ss:StyleID"]="s"+(21+_),u["ss:Index"]=o.c+1;var w=e.v!=null?v:"",y=e.t=="z"?"":'<Data ss:Type="'+p+'">'+w+"</Data>";return(e.c||[]).length>0&&(y+=VD(e.c)),Be("Cell",y,u)}function GD(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Wl(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function qD(e,t,r,n){if(!e["!ref"])return"";var i=Ct(e["!ref"]),l=e["!merges"]||[],o=0,u=[];e["!cols"]&&e["!cols"].forEach(function(S,k){Ki(S);var R=!!S.width,T=Wu(k,S),B={"ss:Index":k+1};R&&(B["ss:Width"]=To(T.width)),S.hidden&&(B["ss:Hidden"]="1"),u.push(Be("Column",null,B))});for(var h=Array.isArray(e),d=i.s.r;d<=i.e.r;++d){for(var g=[GD(d,(e["!rows"]||[])[d])],p=i.s.c;p<=i.e.c;++p){var v=!1;for(o=0;o!=l.length;++o)if(!(l[o].s.c>p)&&!(l[o].s.r>d)&&!(l[o].e.c<p)&&!(l[o].e.r<d)){(l[o].s.c!=p||l[o].s.r!=d)&&(v=!0);break}if(!v){var _={r:d,c:p},w=st(_),y=h?(e[d]||[])[p]:e[w];g.push($D(y,w,e,t,r,n,_))}}g.push("</Row>"),g.length>2&&u.push(g.join(""))}return u.join("")}function XD(e,t,r){var n=[],i=r.SheetNames[e],l=r.Sheets[i],o=l?zD(l,t,e,r):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=l?qD(l,t,e,r):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push(HD(l,t,e,r)),n.join("")}function WD(e,t){t||(t={}),e.SSF||(e.SSF=tr(it)),e.SSF&&(Ql(),zu(e.SSF),t.revssf=Vu(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],es(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(ID(e,t)),r.push(UD()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Be("Worksheet",XD(n,t,e),{"ss:Name":Pt(e.SheetNames[n])}));return r[2]=jD(e,t),r[3]=PD(e),_r+Be("Workbook",r.join(""),{xmlns:Ua.ss,"xmlns:o":Ua.o,"xmlns:x":Ua.x,"xmlns:ss":Ua.ss,"xmlns:dt":Ua.dt,"xmlns:html":Ua.html})}function KD(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=PA(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=zA(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var YD=[60,1084,2066,2165,2175];function JD(e,t,r,n,i){var l=n,o=[],u=r.slice(r.l,r.l+l);if(i&&i.enc&&i.enc.insitu&&u.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(u)}o.push(u),r.l+=l;for(var h=ii(r,r.l),d=Qd[h],g=0;d!=null&&YD.indexOf(h)>-1;)l=ii(r,r.l+2),g=r.l+4,h==2066?g+=4:(h==2165||h==2175)&&(g+=12),u=r.slice(g,r.l+4+l),o.push(u),r.l+=4+l,d=Qd[h=ii(r,r.l)];var p=Ir(o);Xr(p,0);var v=0;p.lens=[];for(var _=0;_<o.length;++_)p.lens.push(v),v+=o[_].length;if(p.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+p.length+" < "+n;return t.f(p,p.length,i)}function Rn(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=it[n])}catch(l){if(t.WTF)throw l}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||di[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=yo(e.v):e.w=Ns(e.v):e.w=fn(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(l){if(t.WTF)throw l}if(t.cellDates&&n&&e.t=="n"&&Jl(it[n]||String(n))){var i=Es(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function mu(e,t,r){return{v:e,ixfe:t,t:r}}function QD(e,t){var r={opts:{}},n={},i=t.dense?[]:{},l={},o={},u=null,h=[],d="",g={},p,v="",_,w,y,S,k={},R=[],T,B,X=[],M=[],N={Sheets:[],WBProps:{date1904:!1},Views:[{}]},Z={},q=function(ht){return ht<8?Ts[ht]:ht<64&&M[ht-8]||Ts[ht]},he=function(ht,Kt,Qr){var qt=Kt.XF.data;if(!(!qt||!qt.patternType||!Qr||!Qr.cellStyles)){Kt.s={},Kt.s.patternType=qt.patternType;var ar;(ar=Eo(q(qt.icvFore)))&&(Kt.s.fgColor={rgb:ar}),(ar=Eo(q(qt.icvBack)))&&(Kt.s.bgColor={rgb:ar})}},Y=function(ht,Kt,Qr){if(!(I>1)&&!(Qr.sheetRows&&ht.r>=Qr.sheetRows)){if(Qr.cellStyles&&Kt.XF&&Kt.XF.data&&he(ht,Kt,Qr),delete Kt.ixfe,delete Kt.XF,p=ht,v=st(ht),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),ht.r<o.s.r&&(o.s.r=ht.r),ht.c<o.s.c&&(o.s.c=ht.c),ht.r+1>o.e.r&&(o.e.r=ht.r+1),ht.c+1>o.e.c&&(o.e.c=ht.c+1),Qr.cellFormula&&Kt.f){for(var qt=0;qt<R.length;++qt)if(!(R[qt][0].s.c>ht.c||R[qt][0].s.r>ht.r)&&!(R[qt][0].e.c<ht.c||R[qt][0].e.r<ht.r)){Kt.F=mt(R[qt][0]),(R[qt][0].s.c!=ht.c||R[qt][0].s.r!=ht.r)&&delete Kt.f,Kt.f&&(Kt.f=""+aa(R[qt][1],o,ht,J,Q));break}}Qr.dense?(i[ht.r]||(i[ht.r]=[]),i[ht.r][ht.c]=Kt):i[v]=Kt}},Q={enc:!1,sbcch:0,snames:[],sharedf:k,arrayf:R,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(Q.password=t.password);var pe,Ce=[],_e=[],te=[],se=[],ge=!1,J=[];J.SheetNames=Q.snames,J.sharedf=Q.sharedf,J.arrayf=Q.arrayf,J.names=[],J.XTI=[];var Oe=0,I=0,A=0,z=[],U=[],G;Q.codepage=1200,wn(1200);for(var ne=!1;e.l<e.length-1;){var we=e.l,Te=e.read_shift(2);if(Te===0&&Oe===10)break;var Se=e.l===e.length?0:e.read_shift(2),Ne=Qd[Te];if(Ne&&Ne.f){if(t.bookSheets&&Oe===133&&Te!==133)break;if(Oe=Te,Ne.r===2||Ne.r==12){var ot=e.read_shift(2);if(Se-=2,!Q.enc&&ot!==Te&&((ot&255)<<8|ot>>8)!==Te)throw new Error("rt mismatch: "+ot+"!="+Te);Ne.r==12&&(e.l+=10,Se-=10)}var V={};if(Te===10?V=Ne.f(e,Se,Q):V=JD(Te,Ne,e,Se,Q),I==0&&[9,521,1033,2057].indexOf(Oe)===-1)continue;switch(Te){case 34:r.opts.Date1904=N.WBProps.date1904=V;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(Q.enc||(e.l=0),Q.enc=V,!t.password)throw new Error("File is password-protected");if(V.valid==null)throw new Error("Encryption scheme unsupported");if(!V.valid)throw new Error("Password is incorrect");break;case 92:Q.lastuser=V;break;case 66:var Nt=Number(V);switch(Nt){case 21010:Nt=1200;break;case 32768:Nt=1e4;break;case 32769:Nt=1252;break}wn(Q.codepage=Nt),ne=!0;break;case 317:Q.rrtabid=V;break;case 25:Q.winlocked=V;break;case 439:r.opts.RefreshAll=V;break;case 12:r.opts.CalcCount=V;break;case 16:r.opts.CalcDelta=V;break;case 17:r.opts.CalcIter=V;break;case 13:r.opts.CalcMode=V;break;case 14:r.opts.CalcPrecision=V;break;case 95:r.opts.CalcSaveRecalc=V;break;case 15:Q.CalcRefMode=V;break;case 2211:r.opts.FullCalc=V;break;case 129:V.fDialog&&(i["!type"]="dialog"),V.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),V.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:X.push(V);break;case 430:J.push([V]),J[J.length-1].XTI=[];break;case 35:case 547:J[J.length-1].push(V);break;case 24:case 536:G={Name:V.Name,Ref:aa(V.rgce,o,null,J,Q)},V.itab>0&&(G.Sheet=V.itab-1),J.names.push(G),J[0]||(J[0]=[],J[0].XTI=[]),J[J.length-1].push(V),V.Name=="_xlnm._FilterDatabase"&&V.itab>0&&V.rgce&&V.rgce[0]&&V.rgce[0][0]&&V.rgce[0][0][0]=="PtgArea3d"&&(U[V.itab-1]={ref:mt(V.rgce[0][0][1][2])});break;case 22:Q.ExternCount=V;break;case 23:J.length==0&&(J[0]=[],J[0].XTI=[]),J[J.length-1].XTI=J[J.length-1].XTI.concat(V),J.XTI=J.XTI.concat(V);break;case 2196:if(Q.biff<8)break;G!=null&&(G.Comment=V[1]);break;case 18:i["!protect"]=V;break;case 19:V!==0&&Q.WTF&&console.error("Password verifier: "+V);break;case 133:l[V.pos]=V,Q.snames.push(V.name);break;case 10:{if(--I)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,i["!ref"]=mt(o),t.sheetRows&&t.sheetRows<=o.e.r){var lt=o.e.r;o.e.r=t.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=mt(o),o.e.r=lt}o.e.r++,o.e.c++}Ce.length>0&&(i["!merges"]=Ce),_e.length>0&&(i["!objects"]=_e),te.length>0&&(i["!cols"]=te),se.length>0&&(i["!rows"]=se),N.Sheets.push(Z)}d===""?g=i:n[d]=i,i=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(Q.biff===8&&(Q.biff={9:2,521:3,1033:4}[Te]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[V.BIFFVer]||8),Q.biffguess=V.BIFFVer==0,V.BIFFVer==0&&V.dt==4096&&(Q.biff=5,ne=!0,wn(Q.codepage=28591)),Q.biff==8&&V.BIFFVer==0&&V.dt==16&&(Q.biff=2),I++)break;if(i=t.dense?[]:{},Q.biff<8&&!ne&&(ne=!0,wn(Q.codepage=t.codepage||1252)),Q.biff<5||V.BIFFVer==0&&V.dt==4096){d===""&&(d="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var Tt={pos:e.l-Se,name:d};l[Tt.pos]=Tt,Q.snames.push(d)}else d=(l[we]||{name:""}).name;V.dt==32&&(i["!type"]="chart"),V.dt==64&&(i["!type"]="macro"),Ce=[],_e=[],Q.arrayf=R=[],te=[],se=[],ge=!1,Z={Hidden:(l[we]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(t.dense?(i[V.r]||[])[V.c]:i[st({c:V.c,r:V.r})])&&++V.c,T={ixfe:V.ixfe,XF:X[V.ixfe]||{},v:V.val,t:"n"},A>0&&(T.z=z[T.ixfe>>8&63]),Rn(T,t,r.opts.Date1904),Y({c:V.c,r:V.r},T,t);break;case 5:case 517:T={ixfe:V.ixfe,XF:X[V.ixfe],v:V.val,t:V.t},A>0&&(T.z=z[T.ixfe>>8&63]),Rn(T,t,r.opts.Date1904),Y({c:V.c,r:V.r},T,t);break;case 638:T={ixfe:V.ixfe,XF:X[V.ixfe],v:V.rknum,t:"n"},A>0&&(T.z=z[T.ixfe>>8&63]),Rn(T,t,r.opts.Date1904),Y({c:V.c,r:V.r},T,t);break;case 189:for(var ft=V.c;ft<=V.C;++ft){var je=V.rkrec[ft-V.c][0];T={ixfe:je,XF:X[je],v:V.rkrec[ft-V.c][1],t:"n"},A>0&&(T.z=z[T.ixfe>>8&63]),Rn(T,t,r.opts.Date1904),Y({c:ft,r:V.r},T,t)}break;case 6:case 518:case 1030:{if(V.val=="String"){u=V;break}if(T=mu(V.val,V.cell.ixfe,V.tt),T.XF=X[T.ixfe],t.cellFormula){var zt=V.formula;if(zt&&zt[0]&&zt[0][0]&&zt[0][0][0]=="PtgExp"){var gr=zt[0][0][1][0],Kr=zt[0][0][1][1],Fr=st({r:gr,c:Kr});k[Fr]?T.f=""+aa(V.formula,o,V.cell,J,Q):T.F=((t.dense?(i[gr]||[])[Kr]:i[Fr])||{}).F}else T.f=""+aa(V.formula,o,V.cell,J,Q)}A>0&&(T.z=z[T.ixfe>>8&63]),Rn(T,t,r.opts.Date1904),Y(V.cell,T,t),u=V}break;case 7:case 519:if(u)u.val=V,T=mu(V,u.cell.ixfe,"s"),T.XF=X[T.ixfe],t.cellFormula&&(T.f=""+aa(u.formula,o,u.cell,J,Q)),A>0&&(T.z=z[T.ixfe>>8&63]),Rn(T,t,r.opts.Date1904),Y(u.cell,T,t),u=null;else throw new Error("String record expects Formula");break;case 33:case 545:{R.push(V);var Ga=st(V[0].s);if(_=t.dense?(i[V[0].s.r]||[])[V[0].s.c]:i[Ga],t.cellFormula&&_){if(!u||!Ga||!_)break;_.f=""+aa(V[1],o,V[0],J,Q),_.F=mt(V[0])}}break;case 1212:{if(!t.cellFormula)break;if(v){if(!u)break;k[st(u.cell)]=V[0],_=t.dense?(i[u.cell.r]||[])[u.cell.c]:i[st(u.cell)],(_||{}).f=""+aa(V[0],o,p,J,Q)}}break;case 253:T=mu(h[V.isst].t,V.ixfe,"s"),h[V.isst].h&&(T.h=h[V.isst].h),T.XF=X[T.ixfe],A>0&&(T.z=z[T.ixfe>>8&63]),Rn(T,t,r.opts.Date1904),Y({c:V.c,r:V.r},T,t);break;case 513:t.sheetStubs&&(T={ixfe:V.ixfe,XF:X[V.ixfe],t:"z"},A>0&&(T.z=z[T.ixfe>>8&63]),Rn(T,t,r.opts.Date1904),Y({c:V.c,r:V.r},T,t));break;case 190:if(t.sheetStubs)for(var da=V.c;da<=V.C;++da){var _t=V.ixfe[da-V.c];T={ixfe:_t,XF:X[_t],t:"z"},A>0&&(T.z=z[T.ixfe>>8&63]),Rn(T,t,r.opts.Date1904),Y({c:da,r:V.r},T,t)}break;case 214:case 516:case 4:T=mu(V.val,V.ixfe,"s"),T.XF=X[T.ixfe],A>0&&(T.z=z[T.ixfe>>8&63]),Rn(T,t,r.opts.Date1904),Y({c:V.c,r:V.r},T,t);break;case 0:case 512:I===1&&(o=V);break;case 252:h=V;break;case 1054:if(Q.biff==4){z[A++]=V[1];for(var Aa=0;Aa<A+163&&it[Aa]!=V[1];++Aa);Aa>=163&&li(V[1],A+163)}else li(V[1],V[0]);break;case 30:{z[A++]=V;for(var Yr=0;Yr<A+163&&it[Yr]!=V;++Yr);Yr>=163&&li(V,A+163)}break;case 229:Ce=Ce.concat(V);break;case 93:_e[V.cmo[0]]=Q.lastobj=V;break;case 438:Q.lastobj.TxO=V;break;case 127:Q.lastobj.ImData=V;break;case 440:for(S=V[0].s.r;S<=V[0].e.r;++S)for(y=V[0].s.c;y<=V[0].e.c;++y)_=t.dense?(i[S]||[])[y]:i[st({c:y,r:S})],_&&(_.l=V[1]);break;case 2048:for(S=V[0].s.r;S<=V[0].e.r;++S)for(y=V[0].s.c;y<=V[0].e.c;++y)_=t.dense?(i[S]||[])[y]:i[st({c:y,r:S})],_&&_.l&&(_.l.Tooltip=V[1]);break;case 28:{if(Q.biff<=5&&Q.biff>=2)break;_=t.dense?(i[V[0].r]||[])[V[0].c]:i[st(V[0])];var Tn=_e[V[2]];_||(t.dense?(i[V[0].r]||(i[V[0].r]=[]),_=i[V[0].r][V[0].c]={t:"z"}):_=i[st(V[0])]={t:"z"},o.e.r=Math.max(o.e.r,V[0].r),o.s.r=Math.min(o.s.r,V[0].r),o.e.c=Math.max(o.e.c,V[0].c),o.s.c=Math.min(o.s.c,V[0].c)),_.c||(_.c=[]),w={a:V[1],t:Tn.TxO.t},_.c.push(w)}break;case 2173:j8(X[V.ixfe],V.ext);break;case 125:{if(!Q.cellStyles)break;for(;V.e>=V.s;)te[V.e--]={width:V.w/256,level:V.level||0,hidden:!!(V.flags&1)},ge||(ge=!0,Mm(V.w/256)),Ki(te[V.e+1])}break;case 520:{var Mt={};V.level!=null&&(se[V.r]=Mt,Mt.level=V.level),V.hidden&&(se[V.r]=Mt,Mt.hidden=!0),V.hpt&&(se[V.r]=Mt,Mt.hpt=V.hpt,Mt.hpx=Wl(V.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||Cs(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Te]]=V;break;case 161:i["!margins"]||Cs(i["!margins"]={}),i["!margins"].header=V.header,i["!margins"].footer=V.footer;break;case 574:V.RTL&&(N.Views[0].RTL=!0);break;case 146:M=V;break;case 2198:pe=V;break;case 140:B=V;break;case 442:d?Z.CodeName=V||Z.name:N.WBProps.CodeName=V||"ThisWorkbook";break}}else Ne||console.error("Missing Info for XLS Record 0x"+Te.toString(16)),e.l+=Se}return r.SheetNames=dr(l).sort(function(Jr,ht){return Number(Jr)-Number(ht)}).map(function(Jr){return l[Jr].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&g["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=g)):r.Preamble=g,r.Sheets&&U.forEach(function(Jr,ht){r.Sheets[r.SheetNames[ht]]["!autofilter"]=Jr}),r.Strings=h,r.SSF=tr(it),Q.enc&&(r.Encryption=Q.enc),pe&&(r.Themes=pe),r.Metadata={},B!==void 0&&(r.Metadata.Country=B),J.names.length>0&&(N.Names=J.names),r.Workbook=N,r}var co={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function ZD(e,t,r){var n=tt.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=ey(n,Gd,co.DSI);for(var l in i)t[l]=i[l]}catch(d){if(r.WTF)throw d}var o=tt.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var u=ey(o,qd,co.SI);for(var h in u)t[h]==null&&(t[h]=u[h])}catch(d){if(r.WTF)throw d}t.HeadingPairs&&t.TitlesOfParts&&(K_(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function eF(e,t){var r=[],n=[],i=[],l=0,o,u=Ov(Gd,"n"),h=Ov(qd,"n");if(e.Props)for(o=dr(e.Props),l=0;l<o.length;++l)(Object.prototype.hasOwnProperty.call(u,o[l])?r:Object.prototype.hasOwnProperty.call(h,o[l])?n:i).push([o[l],e.Props[o[l]]]);if(e.Custprops)for(o=dr(e.Custprops),l=0;l<o.length;++l)Object.prototype.hasOwnProperty.call(e.Props||{},o[l])||(Object.prototype.hasOwnProperty.call(u,o[l])?r:Object.prototype.hasOwnProperty.call(h,o[l])?n:i).push([o[l],e.Custprops[o[l]]]);var d=[];for(l=0;l<i.length;++l)r2.indexOf(i[l][0])>-1||W_.indexOf(i[l][0])>-1||i[l][1]!=null&&d.push(i[l]);n.length&&tt.utils.cfb_add(t,"/SummaryInformation",ty(n,co.SI,h,qd)),(r.length||d.length)&&tt.utils.cfb_add(t,"/DocumentSummaryInformation",ty(r,co.DSI,u,Gd,d.length?d:null,co.UDI))}function J2(e,t){t||(t={}),Vm(t),um(),t.codepage&&om(t.codepage);var r,n;if(e.FullPaths){if(tt.find(e,"/encryption"))throw new Error("File is password-protected");r=tt.find(e,"!CompObj"),n=tt.find(e,"/Workbook")||tt.find(e,"/Book")}else{switch(t.type){case"base64":e=Ha($a(e));break;case"binary":e=Ha(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Xr(e,0),n={content:e}}var i,l;if(r&&KD(r),t.bookProps&&!t.bookSheets)i={};else{var o=pt?"buffer":"array";if(n&&n.content)i=QD(n.content,t);else if((l=tt.find(e,"PerfectOffice_MAIN"))&&l.content)i=As.to_workbook(l.content,(t.type=o,t));else if((l=tt.find(e,"NativeContent_MAIN"))&&l.content)i=As.to_workbook(l.content,(t.type=o,t));else throw(l=tt.find(e,"MN0"))&&l.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&tt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=dN(e))}var u={};return e.FullPaths&&ZD(e,u,t),i.Props=i.Custprops=u,t.bookFiles&&(i.cfb=e),i}function tF(e,t){var r=t||{},n=tt.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return tt.utils.cfb_add(n,i,Q2(e,r)),r.biff==8&&(e.Props||e.Custprops)&&eF(e,n),r.biff==8&&e.vbaraw&&mN(n,tt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var Co={0:{f:T5},1:{f:F5},2:{f:Q5},3:{f:z5},4:{f:I5},5:{f:K5},6:{f:aR},7:{f:G5},8:{f:uR},9:{f:oR},10:{f:lR},11:{f:cR},12:{f:L5},13:{f:eR},14:{f:V5},15:{f:j5},16:{f:V2},17:{f:iR},18:{f:X5},19:{f:Em},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:iD},40:{},42:{},43:{f:a8},44:{f:t8},45:{f:s8},46:{f:c8},47:{f:l8},48:{},49:{f:CA},50:{},51:{f:H8},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:d2},62:{f:rR},63:{f:J8},64:{f:kR},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:la,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:bR},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:R5},148:{f:C5,p:16},151:{f:xR},152:{},153:{f:rD},154:{},155:{},156:{f:eD},157:{},158:{},159:{T:1,f:v6},160:{T:-1},161:{T:1,f:Ps},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:fR},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:P8},336:{T:-1},337:{f:G8,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:$d},357:{},358:{},359:{},360:{T:1},361:{},362:{f:h2},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:pR},427:{f:vR},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:_R},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:O5},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:mR},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:$d},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:cN},633:{T:1},634:{T:-1},635:{T:1,f:sN},636:{T:-1},637:{f:DA},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:VR},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:AR},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Qd={6:{f:Ed},10:{f:Pi},12:{f:Ar},13:{f:Ar},14:{f:vr},15:{f:vr},16:{f:ia},17:{f:vr},18:{f:vr},19:{f:Ar},20:{f:ly},21:{f:ly},23:{f:h2},24:{f:oy},25:{f:vr},26:{},27:{},28:{f:AC},29:{},34:{f:vr},35:{f:cy},38:{f:ia},39:{f:ia},40:{f:ia},41:{f:ia},42:{f:vr},43:{f:vr},47:{f:j6},49:{f:eC},51:{f:Ar},60:{},61:{f:K3},64:{f:vr},65:{f:Z3},66:{f:Ar},77:{},80:{},81:{},82:{},85:{f:Ar},89:{},90:{},91:{},92:{f:U3},93:{f:OC},94:{},95:{f:vr},96:{},97:{},99:{f:vr},125:{f:d2},128:{f:gC},129:{f:P3},130:{f:Ar},131:{f:vr},132:{f:vr},133:{f:z3},134:{},140:{f:UC},141:{f:Ar},144:{},146:{f:zC},151:{},152:{},153:{},154:{},155:{},156:{f:Ar},157:{},158:{},160:{f:WC},161:{f:$C},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:fC},190:{f:hC},193:{f:Pi},197:{},198:{},199:{},200:{},201:{},202:{f:vr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Ar},220:{},221:{f:vr},222:{},224:{f:mC},225:{f:I3},226:{f:Pi},227:{},229:{f:CC},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:V3},253:{f:rC},255:{f:G3},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:a2},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:vr},353:{f:Pi},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:_C},431:{f:vr},432:{},433:{},434:{},437:{},438:{f:FC},439:{f:vr},440:{f:MC},441:{},442:{f:Lo},443:{},444:{f:Ar},445:{},446:{},448:{f:Pi},449:{f:W3,r:2},450:{f:Pi},512:{f:ny},513:{f:XC},515:{f:vC},516:{f:nC},517:{f:sy},519:{f:KC},520:{f:q3},523:{},545:{f:uy},549:{f:ay},566:{},574:{f:J3},638:{f:uC},659:{},1048:{},1054:{f:sC},1084:{},1212:{f:EC},2048:{f:BC},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:fu},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Pi},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:HC,r:12},2173:{f:U8,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:vr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:SC,r:12},2197:{},2198:{f:D8,r:12},2199:{},2200:{},2201:{},2202:{f:TC,r:12},2203:{f:Pi},2204:{},2205:{},2206:{},2207:{},2211:{f:X3},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Ar},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:GC},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:PC},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:ny},1:{},2:{f:e6},3:{f:QC},4:{f:JC},5:{f:sy},7:{f:r6},8:{},9:{f:fu},11:{},22:{f:Ar},30:{f:cC},31:{},32:{},33:{f:uy},36:{},37:{f:ay},50:{f:a6},62:{},52:{},67:{},68:{f:Ar},69:{},86:{},126:{},127:{f:YC},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:n6},223:{},234:{},354:{},421:{},518:{f:Ed},521:{f:fu},536:{f:oy},547:{f:cy},561:{},579:{},1030:{f:Ed},1033:{f:fu},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ie(e,t,r,n){var i=t;if(!isNaN(i)){var l=n||(r||[]).length||0,o=e.next(4);o.write_shift(2,i),o.write_shift(2,l),l>0&&wm(r)&&e.push(r)}}function rF(e,t,r,n){var i=(r||[]).length||0;if(i<=8224)return Ie(e,t,r,i);var l=t;if(!isNaN(l)){for(var o=r.parts||[],u=0,h=0,d=0;d+(o[u]||8224)<=8224;)d+=o[u]||8224,u++;var g=e.next(4);for(g.write_shift(2,l),g.write_shift(2,d),e.push(r.slice(h,h+d)),h+=d;h<i;){for(g=e.next(4),g.write_shift(2,60),d=0;d+(o[u]||8224)<=8224;)d+=o[u]||8224,u++;g.write_shift(2,d),e.push(r.slice(h,h+d)),h+=d}}}function jo(e,t,r){return e||(e=xe(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function aF(e,t,r,n){var i=xe(9);return jo(i,e,t),n2(r,n||"b",i),i}function nF(e,t,r){var n=xe(8+2*r.length);return jo(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function iF(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var i=t.t=="d"?Dr(er(t.v)):t.v;i==(i|0)&&i>=0&&i<65536?Ie(e,2,t6(r,n,i)):Ie(e,3,ZC(r,n,i));return;case"b":case"e":Ie(e,5,aF(r,n,t.v,t.t));return;case"s":case"str":Ie(e,4,nF(r,n,(t.v||"").slice(0,255)));return}Ie(e,1,jo(null,r,n))}function sF(e,t,r,n){var i=Array.isArray(t),l=Ct(t["!ref"]||"A1"),o,u="",h=[];if(l.e.c>255||l.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");l.e.c=Math.min(l.e.c,255),l.e.r=Math.min(l.e.c,16383),o=mt(l)}for(var d=l.s.r;d<=l.e.r;++d){u=yr(d);for(var g=l.s.c;g<=l.e.c;++g){d===l.s.r&&(h[g]=ir(g)),o=h[g]+u;var p=i?(t[d]||[])[g]:t[o];p&&iF(e,p,d,g)}}}function lF(e,t){for(var r=t||{},n=Ta(),i=0,l=0;l<e.SheetNames.length;++l)e.SheetNames[l]==r.sheet&&(i=l);if(i==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Ie(n,r.biff==4?1033:r.biff==3?521:9,Rm(e,16,r)),sF(n,e.Sheets[e.SheetNames[i]],i,r),Ie(n,10),n.end()}function cF(e,t,r){Ie(e,49,tC({sz:12,name:"Arial"},r))}function oF(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&Ie(e,1054,lC(i,t[i],r))})}function uF(e,t){var r=xe(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Ie(e,2151,r),r=xe(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),o2(Ct(t["!ref"]||"A1"),r),r.write_shift(4,4),Ie(e,2152,r)}function fF(e,t){for(var r=0;r<16;++r)Ie(e,224,iy({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){Ie(e,224,iy(n,0,t))})}function hF(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];Ie(e,440,LC(n)),n[1].Tooltip&&Ie(e,2048,IC(n))}delete t["!links"]}function dF(e,t){if(t){var r=0;t.forEach(function(n,i){++r<=256&&n&&Ie(e,125,VC(Wu(i,n),i))})}}function mF(e,t,r,n,i){var l=16+es(i.cellXfs,t,i);if(t.v==null&&!t.bf){Ie(e,513,Fs(r,n,l));return}if(t.bf)Ie(e,6,PO(t,r,n,i,l));else switch(t.t){case"d":case"n":var o=t.t=="d"?Dr(er(t.v)):t.v;Ie(e,515,yC(r,n,o,l));break;case"b":case"e":Ie(e,517,pC(r,n,t.v,l,i,t.t));break;case"s":case"str":if(i.bookSST){var u=jm(i.Strings,t.v,i.revStrings);Ie(e,253,aC(r,n,u,l))}else Ie(e,516,iC(r,n,(t.v||"").slice(0,255),l,i));break;default:Ie(e,513,Fs(r,n,l))}}function gF(e,t,r){var n=Ta(),i=r.SheetNames[e],l=r.Sheets[i]||{},o=(r||{}).Workbook||{},u=(o.Sheets||[])[e]||{},h=Array.isArray(l),d=t.biff==8,g,p="",v=[],_=Ct(l["!ref"]||"A1"),w=d?65536:16384;if(_.e.c>255||_.e.r>=w){if(t.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:IV16384");_.e.c=Math.min(_.e.c,255),_.e.r=Math.min(_.e.c,w-1)}Ie(n,2057,Rm(r,16,t)),Ie(n,13,on(1)),Ie(n,12,on(100)),Ie(n,15,fa(!0)),Ie(n,17,fa(!1)),Ie(n,16,Rs(.001)),Ie(n,95,fa(!0)),Ie(n,42,fa(!1)),Ie(n,43,fa(!1)),Ie(n,130,on(1)),Ie(n,128,xC()),Ie(n,131,fa(!1)),Ie(n,132,fa(!1)),d&&dF(n,l["!cols"]),Ie(n,512,oC(_,t)),d&&(l["!links"]=[]);for(var y=_.s.r;y<=_.e.r;++y){p=yr(y);for(var S=_.s.c;S<=_.e.c;++S){y===_.s.r&&(v[S]=ir(S)),g=v[S]+p;var k=h?(l[y]||[])[S]:l[g];k&&(mF(n,k,y,S,t),d&&k.l&&l["!links"].push([g,k.l]))}}var R=u.CodeName||u.name||i;return d&&Ie(n,574,Q3((o.Views||[])[0])),d&&(l["!merges"]||[]).length&&Ie(n,229,NC(l["!merges"])),d&&hF(n,l),Ie(n,442,i2(R)),d&&uF(n,l),Ie(n,10),n.end()}function xF(e,t,r){var n=Ta(),i=(e||{}).Workbook||{},l=i.Sheets||[],o=i.WBProps||{},u=r.biff==8,h=r.biff==5;if(Ie(n,2057,Rm(e,5,r)),r.bookType=="xla"&&Ie(n,135),Ie(n,225,u?on(1200):null),Ie(n,193,p3(2)),h&&Ie(n,191),h&&Ie(n,192),Ie(n,226),Ie(n,92,j3("SheetJS",r)),Ie(n,66,on(u?1200:1252)),u&&Ie(n,353,on(0)),u&&Ie(n,448),Ie(n,317,qC(e.SheetNames.length)),u&&e.vbaraw&&Ie(n,211),u&&e.vbaraw){var d=o.CodeName||"ThisWorkbook";Ie(n,442,i2(d))}Ie(n,156,on(17)),Ie(n,25,fa(!1)),Ie(n,18,fa(!1)),Ie(n,19,on(0)),u&&Ie(n,431,fa(!1)),u&&Ie(n,444,on(0)),Ie(n,61,Y3()),Ie(n,64,fa(!1)),Ie(n,141,on(0)),Ie(n,34,fa(WR(e)=="true")),Ie(n,14,fa(!0)),u&&Ie(n,439,fa(!1)),Ie(n,218,on(0)),cF(n,e,r),oF(n,e.SSF,r),fF(n,r),u&&Ie(n,352,fa(!1));var g=n.end(),p=Ta();u&&Ie(p,140,jC()),u&&r.Strings&&rF(p,252,$3(r.Strings)),Ie(p,10);var v=p.end(),_=Ta(),w=0,y=0;for(y=0;y<e.SheetNames.length;++y)w+=(u?12:11)+(u?2:1)*e.SheetNames[y].length;var S=g.length+w+v.length;for(y=0;y<e.SheetNames.length;++y){var k=l[y]||{};Ie(_,133,H3({pos:S,hs:k.Hidden||0,dt:0,name:e.SheetNames[y]},r)),S+=t[y].length}var R=_.end();if(w!=R.length)throw new Error("BS8 "+w+" != "+R.length);var T=[];return g.length&&T.push(g),R.length&&T.push(R),v.length&&T.push(v),Ir(T)}function pF(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=tr(it)),e&&e.SSF&&(Ql(),zu(e.SSF),r.revssf=Vu(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,$m(r),r.cellXfs=[],es(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var i=0;i<e.SheetNames.length;++i)n[n.length]=gF(i,r,e);return n.unshift(xF(e,n,r)),Ir(n)}function Q2(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var i=ka(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var l=t||{};switch(l.biff||2){case 8:case 5:return pF(e,t);case 4:case 3:case 2:return lF(e,t)}throw new Error("invalid type "+l.bookType+" for BIFF")}function _y(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var i=e.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var l=e.match(/<\/table/i),o=i.index,u=l&&l.index||e.length,h=tA(e.slice(o,u),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,g=0,p=0,v=0,_={s:{r:1e7,c:1e7},e:{r:0,c:0}},w=[];for(o=0;o<h.length;++o){var y=h[o].trim(),S=y.slice(0,3).toLowerCase();if(S=="<tr"){if(++d,r.sheetRows&&r.sheetRows<=d){--d;break}g=0;continue}if(!(S!="<td"&&S!="<th")){var k=y.split(/<\/t[dh]>/i);for(u=0;u<k.length;++u){var R=k[u].trim();if(R.match(/<t[dh]/i)){for(var T=R,B=0;T.charAt(0)=="<"&&(B=T.indexOf(">"))>-1;)T=T.slice(B+1);for(var X=0;X<w.length;++X){var M=w[X];M.s.c==g&&M.s.r<d&&d<=M.e.r&&(g=M.e.c+1,X=-1)}var N=ct(R.slice(0,R.indexOf(">")));v=N.colspan?+N.colspan:1,((p=+N.rowspan)>1||v>1)&&w.push({s:{r:d,c:g},e:{r:d+(p||1)-1,c:g+v-1}});var Z=N.t||N["data-t"]||"";if(!T.length){g+=v;continue}if(T=b_(T),_.s.r>d&&(_.s.r=d),_.e.r<d&&(_.e.r=d),_.s.c>g&&(_.s.c=g),_.e.c<g&&(_.e.c=g),!T.length){g+=v;continue}var q={t:"s",v:T};r.raw||!T.trim().length||Z=="s"||(T==="TRUE"?q={t:"b",v:!0}:T==="FALSE"?q={t:"b",v:!1}:isNaN(Sn(T))?isNaN(ql(T).getDate())||(q={t:"d",v:er(T)},r.cellDates||(q={t:"n",v:Dr(q.v)}),q.z=r.dateNF||it[14]):q={t:"n",v:Sn(T)}),r.dense?(n[d]||(n[d]=[]),n[d][g]=q):n[st({r:d,c:g})]=q,g+=v}}}}return n["!ref"]=mt(_),w.length&&(n["!merges"]=w),n}function vF(e,t,r,n){for(var i=e["!merges"]||[],l=[],o=t.s.c;o<=t.e.c;++o){for(var u=0,h=0,d=0;d<i.length;++d)if(!(i[d].s.r>r||i[d].s.c>o)&&!(i[d].e.r<r||i[d].e.c<o)){if(i[d].s.r<r||i[d].s.c<o){u=-1;break}u=i[d].e.r-i[d].s.r+1,h=i[d].e.c-i[d].s.c+1;break}if(!(u<0)){var g=st({r,c:o}),p=n.dense?(e[r]||[])[o]:e[g],v=p&&p.v!=null&&(p.h||vm(p.w||(oi(p),p.w)||""))||"",_={};u>1&&(_.rowspan=u),h>1&&(_.colspan=h),n.editable?v='<span contenteditable="true">'+v+"</span>":p&&(_["data-t"]=p&&p.t||"z",p.v!=null&&(_["data-v"]=p.v),p.z!=null&&(_["data-z"]=p.z),p.l&&(p.l.Target||"#").charAt(0)!="#"&&(v='<a href="'+p.l.Target+'">'+v+"</a>")),_.id=(n.id||"sjs")+"-"+g,l.push(Be("td",v,_))}}var w="<tr>";return w+l.join("")+"</tr>"}var yF='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',_F="</body></html>";function wF(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Zi(_y(r[0],t),t);var n=Xm();return r.forEach(function(i,l){Wm(n,_y(i,t),"Sheet"+(l+1))}),n}function bF(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function Z2(e,t){var r=t||{},n=r.header!=null?r.header:yF,i=r.footer!=null?r.footer:_F,l=[n],o=ka(e["!ref"]);r.dense=Array.isArray(e),l.push(bF(e,o,r));for(var u=o.s.r;u<=o.e.r;++u)l.push(vF(e,o,u,r));return l.push("</table>"+i),l.join("")}function ew(e,t,r){var n=r||{},i=0,l=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var o=typeof n.origin=="string"?sr(n.origin):n.origin;i=o.r,l=o.c}var u=t.getElementsByTagName("tr"),h=Math.min(n.sheetRows||1e7,u.length),d={s:{r:0,c:0},e:{r:i,c:l}};if(e["!ref"]){var g=ka(e["!ref"]);d.s.r=Math.min(d.s.r,g.s.r),d.s.c=Math.min(d.s.c,g.s.c),d.e.r=Math.max(d.e.r,g.e.r),d.e.c=Math.max(d.e.c,g.e.c),i==-1&&(d.e.r=i=g.e.r+1)}var p=[],v=0,_=e["!rows"]||(e["!rows"]=[]),w=0,y=0,S=0,k=0,R=0,T=0;for(e["!cols"]||(e["!cols"]=[]);w<u.length&&y<h;++w){var B=u[w];if(wy(B)){if(n.display)continue;_[y]={hidden:!0}}var X=B.children;for(S=k=0;S<X.length;++S){var M=X[S];if(!(n.display&&wy(M))){var N=M.hasAttribute("data-v")?M.getAttribute("data-v"):M.hasAttribute("v")?M.getAttribute("v"):b_(M.innerHTML),Z=M.getAttribute("data-z")||M.getAttribute("z");for(v=0;v<p.length;++v){var q=p[v];q.s.c==k+l&&q.s.r<y+i&&y+i<=q.e.r&&(k=q.e.c+1-l,v=-1)}T=+M.getAttribute("colspan")||1,((R=+M.getAttribute("rowspan")||1)>1||T>1)&&p.push({s:{r:y+i,c:k+l},e:{r:y+i+(R||1)-1,c:k+l+(T||1)-1}});var he={t:"s",v:N},Y=M.getAttribute("data-t")||M.getAttribute("t")||"";N!=null&&(N.length==0?he.t=Y||"z":n.raw||N.trim().length==0||Y=="s"||(N==="TRUE"?he={t:"b",v:!0}:N==="FALSE"?he={t:"b",v:!1}:isNaN(Sn(N))?isNaN(ql(N).getDate())||(he={t:"d",v:er(N)},n.cellDates||(he={t:"n",v:Dr(he.v)}),he.z=n.dateNF||it[14]):he={t:"n",v:Sn(N)})),he.z===void 0&&Z!=null&&(he.z=Z);var Q="",pe=M.getElementsByTagName("A");if(pe&&pe.length)for(var Ce=0;Ce<pe.length&&!(pe[Ce].hasAttribute("href")&&(Q=pe[Ce].getAttribute("href"),Q.charAt(0)!="#"));++Ce);Q&&Q.charAt(0)!="#"&&(he.l={Target:Q}),n.dense?(e[y+i]||(e[y+i]=[]),e[y+i][k+l]=he):e[st({c:k+l,r:y+i})]=he,d.e.c<k+l&&(d.e.c=k+l),k+=T}}++y}return p.length&&(e["!merges"]=(e["!merges"]||[]).concat(p)),d.e.r=Math.max(d.e.r,y-1+i),e["!ref"]=mt(d),y>=h&&(e["!fullref"]=mt((d.e.r=u.length-w+y-1+i,d))),e}function tw(e,t){var r=t||{},n=r.dense?[]:{};return ew(n,e,t)}function SF(e,t){return Zi(tw(e,t),t)}function wy(e){var t="",r=EF(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function EF(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function TF(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=At(t.replace(/<[^>]*>/g,""));return[r]}var by={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function rw(e,t){var r=t||{},n=ym(e),i=[],l,o,u={name:""},h="",d=0,g,p,v={},_=[],w=r.dense?[]:{},y,S,k={value:""},R="",T=0,B=[],X=-1,M=-1,N={s:{r:1e6,c:1e7},e:{r:0,c:0}},Z=0,q={},he=[],Y={},Q=0,pe=0,Ce=[],_e=1,te=1,se=[],ge={Names:[]},J={},Oe=["",""],I=[],A={},z="",U=0,G=!1,ne=!1,we=0;for(bo.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");y=bo.exec(n);)switch(y[3]=y[3].replace(/_.*$/,"")){case"table":case"":y[1]==="/"?(N.e.c>=N.s.c&&N.e.r>=N.s.r?w["!ref"]=mt(N):w["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=N.e.r&&(w["!fullref"]=w["!ref"],N.e.r=r.sheetRows-1,w["!ref"]=mt(N)),he.length&&(w["!merges"]=he),Ce.length&&(w["!rows"]=Ce),g.name=g.||g.name,typeof JSON<"u"&&JSON.stringify(g),_.push(g.name),v[g.name]=w,ne=!1):y[0].charAt(y[0].length-2)!=="/"&&(g=ct(y[0],!1),X=M=-1,N.s.r=N.s.c=1e7,N.e.r=N.e.c=0,w=r.dense?[]:{},he=[],Ce=[],ne=!0);break;case"table-row-group":y[1]==="/"?--Z:++Z;break;case"table-row":case"":if(y[1]==="/"){X+=_e,_e=1;break}if(p=ct(y[0],!1),p.?X=p.-1:X==-1&&(X=0),_e=+p["number-rows-repeated"]||1,_e<10)for(we=0;we<_e;++we)Z>0&&(Ce[X+we]={level:Z});M=-1;break;case"covered-table-cell":y[1]!=="/"&&++M,r.sheetStubs&&(r.dense?(w[X]||(w[X]=[]),w[X][M]={t:"z"}):w[st({r:X,c:M})]={t:"z"}),R="",B=[];break;case"table-cell":case"":if(y[0].charAt(y[0].length-2)==="/")++M,k=ct(y[0],!1),te=parseInt(k["number-columns-repeated"]||"1",10),S={t:"z",v:null},k.formula&&r.cellFormula!=!1&&(S.f=py(At(k.formula))),(k.||k["value-type"])=="string"&&(S.t="s",S.v=At(k["string-value"]||""),r.dense?(w[X]||(w[X]=[]),w[X][M]=S):w[st({r:X,c:M})]=S),M+=te-1;else if(y[1]!=="/"){++M,R="",T=0,B=[],te=1;var Te=_e?X+_e-1:X;if(M>N.e.c&&(N.e.c=M),M<N.s.c&&(N.s.c=M),X<N.s.r&&(N.s.r=X),Te>N.e.r&&(N.e.r=Te),k=ct(y[0],!1),I=[],A={},S={t:k.||k["value-type"],v:null},r.cellFormula)if(k.formula&&(k.formula=At(k.formula)),k["number-matrix-columns-spanned"]&&k["number-matrix-rows-spanned"]&&(Q=parseInt(k["number-matrix-rows-spanned"],10)||0,pe=parseInt(k["number-matrix-columns-spanned"],10)||0,Y={s:{r:X,c:M},e:{r:X+Q-1,c:M+pe-1}},S.F=mt(Y),se.push([Y,S.F])),k.formula)S.f=py(k.formula);else for(we=0;we<se.length;++we)X>=se[we][0].s.r&&X<=se[we][0].e.r&&M>=se[we][0].s.c&&M<=se[we][0].e.c&&(S.F=se[we][1]);switch((k["number-columns-spanned"]||k["number-rows-spanned"])&&(Q=parseInt(k["number-rows-spanned"],10)||0,pe=parseInt(k["number-columns-spanned"],10)||0,Y={s:{r:X,c:M},e:{r:X+Q-1,c:M+pe-1}},he.push(Y)),k["number-columns-repeated"]&&(te=parseInt(k["number-columns-repeated"],10)),S.t){case"boolean":S.t="b",S.v=Zt(k["boolean-value"]);break;case"float":S.t="n",S.v=parseFloat(k.value);break;case"percentage":S.t="n",S.v=parseFloat(k.value);break;case"currency":S.t="n",S.v=parseFloat(k.value);break;case"date":S.t="d",S.v=er(k["date-value"]),r.cellDates||(S.t="n",S.v=Dr(S.v)),S.z="m/d/yy";break;case"time":S.t="n",S.v=Qk(k["time-value"])/86400,r.cellDates&&(S.t="d",S.v=$u(S.v)),S.z="HH:MM:SS";break;case"number":S.t="n",S.v=parseFloat(k.);break;default:if(S.t==="string"||S.t==="text"||!S.t)S.t="s",k["string-value"]!=null&&(R=At(k["string-value"]),B=[]);else throw new Error("Unsupported value type "+S.t)}}else{if(G=!1,S.t==="s"&&(S.v=R||"",B.length&&(S.R=B),G=T==0),J.Target&&(S.l=J),I.length>0&&(S.c=I,I=[]),R&&r.cellText!==!1&&(S.w=R),G&&(S.t="z",delete S.v),(!G||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=X))for(var Se=0;Se<_e;++Se){if(te=parseInt(k["number-columns-repeated"]||"1",10),r.dense)for(w[X+Se]||(w[X+Se]=[]),w[X+Se][M]=Se==0?S:tr(S);--te>0;)w[X+Se][M+te]=tr(S);else for(w[st({r:X+Se,c:M})]=S;--te>0;)w[st({r:X+Se,c:M+te})]=tr(S);N.e.c<=M&&(N.e.c=M)}te=parseInt(k["number-columns-repeated"]||"1",10),M+=te-1,te=0,S={},R="",B=[]}J={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(y[1]==="/"){if((l=i.pop())[0]!==y[3])throw"Bad state: "+l}else y[0].charAt(y[0].length-2)!=="/"&&i.push([y[3],!0]);break;case"annotation":if(y[1]==="/"){if((l=i.pop())[0]!==y[3])throw"Bad state: "+l;A.t=R,B.length&&(A.R=B),A.a=z,I.push(A)}else y[0].charAt(y[0].length-2)!=="/"&&i.push([y[3],!1]);z="",U=0,R="",T=0,B=[];break;case"creator":y[1]==="/"?z=n.slice(U,y.index):U=y.index+y[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(y[1]==="/"){if((l=i.pop())[0]!==y[3])throw"Bad state: "+l}else y[0].charAt(y[0].length-2)!=="/"&&i.push([y[3],!1]);R="",T=0,B=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(y[1]==="/"){if(q[u.name]=h,(l=i.pop())[0]!==y[3])throw"Bad state: "+l}else y[0].charAt(y[0].length-2)!=="/"&&(h="",u=ct(y[0],!1),i.push([y[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":o=ct(y[0],!1),h+=by[y[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":o=ct(y[0],!1),h+=by[y[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(y[0].slice(-2)==="/>")break;if(y[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":h+=n.slice(d,y.index);break}else d=y.index+y[0].length;break;case"named-range":o=ct(y[0],!1),Oe=Td(o["cell-range-address"]);var Ne={Name:o.name,Ref:Oe[0]+"!"+Oe[1]};ne&&(Ne.Sheet=_.length),ge.Names.push(Ne);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(y[1]==="/"&&(!k||!k["string-value"])){var ot=TF(n.slice(T,y.index));R=(R.length>0?R+`
`:"")+ot[0]}else ct(y[0],!1),T=y.index+y[0].length;break;case"s":break;case"database-range":if(y[1]==="/")break;try{Oe=Td(ct(y[0])["target-range-address"]),v[Oe[0]]["!autofilter"]={ref:Oe[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(y[1]!=="/"){if(J=ct(y[0],!1),!J.href)break;J.Target=At(J.href),delete J.href,J.Target.charAt(0)=="#"&&J.Target.indexOf(".")>-1?(Oe=Td(J.Target.slice(1)),J.Target="#"+Oe[0]+"!"+Oe[1]):J.Target.match(/^\.\.[\\\/]/)&&(J.Target=J.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(y[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(y)}}var V={Sheets:v,SheetNames:_,Workbook:ge};return r.bookSheets&&delete V.Sheets,V}function Sy(e,t){t=t||{},cn(e,"META-INF/manifest.xml")&&QA(kr(e,"META-INF/manifest.xml"),t);var r=Va(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=rw(Gt(r),t);return cn(e,"meta.xml")&&(n.Props=q_(kr(e,"meta.xml"))),n}function Ey(e,t){return rw(e,t)}var kF=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+wo({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return _r+t}})(),Ty=(function(){var e=function(l){return Pt(l).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(l,o,u){var h=[];h.push('      <table:table table:name="'+Pt(o.SheetNames[u])+`" table:style-name="ta1">
`);var d=0,g=0,p=ka(l["!ref"]||"A1"),v=l["!merges"]||[],_=0,w=Array.isArray(l);if(l["!cols"])for(g=0;g<=p.e.c;++g)h.push("        <table:table-column"+(l["!cols"][g]?' table:style-name="co'+l["!cols"][g].ods+'"':"")+`></table:table-column>
`);var y="",S=l["!rows"]||[];for(d=0;d<p.s.r;++d)y=S[d]?' table:style-name="ro'+S[d].ods+'"':"",h.push("        <table:table-row"+y+`></table:table-row>
`);for(;d<=p.e.r;++d){for(y=S[d]?' table:style-name="ro'+S[d].ods+'"':"",h.push("        <table:table-row"+y+`>
`),g=0;g<p.s.c;++g)h.push(t);for(;g<=p.e.c;++g){var k=!1,R={},T="";for(_=0;_!=v.length;++_)if(!(v[_].s.c>g)&&!(v[_].s.r>d)&&!(v[_].e.c<g)&&!(v[_].e.r<d)){(v[_].s.c!=g||v[_].s.r!=d)&&(k=!0),R["table:number-columns-spanned"]=v[_].e.c-v[_].s.c+1,R["table:number-rows-spanned"]=v[_].e.r-v[_].s.r+1;break}if(k){h.push(r);continue}var B=st({r:d,c:g}),X=w?(l[d]||[])[g]:l[B];if(X&&X.f&&(R["table:formula"]=Pt(qO(X.f)),X.F&&X.F.slice(0,B.length)==B)){var M=ka(X.F);R["table:number-matrix-columns-spanned"]=M.e.c-M.s.c+1,R["table:number-matrix-rows-spanned"]=M.e.r-M.s.r+1}if(!X){h.push(t);continue}switch(X.t){case"b":T=X.v?"TRUE":"FALSE",R["office:value-type"]="boolean",R["office:boolean-value"]=X.v?"true":"false";break;case"n":T=X.w||String(X.v||0),R["office:value-type"]="float",R["office:value"]=X.v||0;break;case"s":case"str":T=X.v==null?"":X.v,R["office:value-type"]="string";break;case"d":T=X.w||er(X.v).toISOString(),R["office:value-type"]="date",R["office:date-value"]=er(X.v).toISOString(),R["table:style-name"]="ce1";break;default:h.push(t);continue}var N=e(T);if(X.l&&X.l.Target){var Z=X.l.Target;Z=Z.charAt(0)=="#"?"#"+XO(Z.slice(1)):Z,Z.charAt(0)!="#"&&!Z.match(/^\w+:/)&&(Z="../"+Z),N=Be("text:a",N,{"xlink:href":Z.replace(/&/g,"&amp;")})}h.push("          "+Be("table:table-cell",Be("text:p",N,{}),R)+`
`)}h.push(`        </table:table-row>
`)}return h.push(`      </table:table>
`),h.join("")},i=function(l,o){l.push(` <office:automatic-styles>
`),l.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),l.push(`   <number:month number:style="long"/>
`),l.push(`   <number:text>/</number:text>
`),l.push(`   <number:day number:style="long"/>
`),l.push(`   <number:text>/</number:text>
`),l.push(`   <number:year/>
`),l.push(`  </number:date-style>
`);var u=0;o.SheetNames.map(function(d){return o.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var g=0;g<d["!cols"].length;++g)if(d["!cols"][g]){var p=d["!cols"][g];if(p.width==null&&p.wpx==null&&p.wch==null)continue;Ki(p),p.ods=u;var v=d["!cols"][g].wpx+"px";l.push('  <style:style style:name="co'+u+`" style:family="table-column">
`),l.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+v+`"/>
`),l.push(`  </style:style>
`),++u}}});var h=0;o.SheetNames.map(function(d){return o.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var g=0;g<d["!rows"].length;++g)if(d["!rows"][g]){d["!rows"][g].ods=h;var p=d["!rows"][g].hpx+"px";l.push('  <style:style style:name="ro'+h+`" style:family="table-row">
`),l.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+p+`"/>
`),l.push(`  </style:style>
`),++h}}}),l.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),l.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),l.push(`  </style:style>
`),l.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),l.push(` </office:automatic-styles>
`)};return function(o,u){var h=[_r],d=wo({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),g=wo({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});u.bookType=="fods"?(h.push("<office:document"+d+g+`>
`),h.push(G_().replace(/office:document-meta/g,"office:meta"))):h.push("<office:document-content"+d+`>
`),i(h,o),h.push(`  <office:body>
`),h.push(`    <office:spreadsheet>
`);for(var p=0;p!=o.SheetNames.length;++p)h.push(n(o.Sheets[o.SheetNames[p]],o,p));return h.push(`    </office:spreadsheet>
`),h.push(`  </office:body>
`),u.bookType=="fods"?h.push("</office:document>"):h.push("</office:document-content>"),h.join("")}})();function aw(e,t){if(t.bookType=="fods")return Ty(e,t);var r=gm(),n="",i=[],l=[];return n="mimetype",xt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",xt(r,n,Ty(e,t)),i.push([n,"text/xml"]),l.push([n,"ContentFile"]),n="styles.xml",xt(r,n,kF(e,t)),i.push([n,"text/xml"]),l.push([n,"StylesFile"]),n="meta.xml",xt(r,n,_r+G_()),i.push([n,"text/xml"]),l.push([n,"MetadataFile"]),n="manifest.rdf",xt(r,n,t3(l)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",xt(r,n,ZA(i)),r}function Ms(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Zd(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Gt(Qi(e))}function AF(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Ha(Mn(e))}function CF(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function Ji(e){var t=e.reduce(function(i,l){return i+l.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(i){r.set(i,n),n+=i.length}),r}function ky(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function NF(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,i=t+13;i>=t;--i)n=n*256+e[i];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function OF(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var l=0;i>=1;++l,i/=256)e[t+l]=i&255;e[t+15]|=r>=0?0:128}function No(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Ut(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function hr(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Dt(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],i=No(e,r),l=i&7;i=Math.floor(i/8);var o=0,u;if(i==0)break;switch(l){case 0:{for(var h=r[0];e[r[0]++]>=128;);u=e.slice(h,r[0])}break;case 5:o=4,u=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,u=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=No(e,r),u=e.slice(r[0],r[0]+o),r[0]+=o;break;default:throw new Error("PB Type ".concat(l," for Field ").concat(i," at offset ").concat(n))}var d={data:u,type:l};t[i]==null?t[i]=[d]:t[i].push(d)}return t}function qr(e){var t=[];return e.forEach(function(r,n){r.forEach(function(i){i.data&&(t.push(Ut(n*8+i.type)),i.type==2&&t.push(Ut(i.data.length)),t.push(i.data))})}),Ji(t)}function Hm(e,t){return e?.map(function(r){return t(r.data)})||[]}function sn(e){for(var t,r=[],n=[0];n[0]<e.length;){var i=No(e,n),l=Dt(e.slice(n[0],n[0]+i));n[0]+=i;var o={id:hr(l[1][0].data),messages:[]};l[2].forEach(function(u){var h=Dt(u.data),d=hr(h[3][0].data);o.messages.push({meta:h,data:e.slice(n[0],n[0]+d)}),n[0]+=d}),(t=l[3])!=null&&t[0]&&(o.merge=hr(l[3][0].data)>>>0>0),r.push(o)}return r}function Dl(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:Ut(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Ut(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(o){i.push(o.data),o.meta[3]=[{type:0,data:Ut(o.data.length)}],n[2].push({data:qr(o.meta),type:2})});var l=qr(n);t.push(Ut(l.length)),t.push(l),i.forEach(function(o){return t.push(o)})}),Ji(t)}function RF(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=No(t,r),i=[];r[0]<t.length;){var l=t[r[0]]&3;if(l==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var u=o-59;o=t[r[0]],u>1&&(o|=t[r[0]+1]<<8),u>2&&(o|=t[r[0]+2]<<16),u>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=u}i.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var h=0,d=0;if(l==1?(d=(t[r[0]]>>2&7)+4,h=(t[r[0]++]&224)<<3,h|=t[r[0]++]):(d=(t[r[0]++]>>2)+1,l==2?(h=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(h=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),i=[Ji(i)],h==0)throw new Error("Invalid offset 0");if(h>i[0].length)throw new Error("Invalid offset beyond length");if(d>=h)for(i.push(i[0].slice(-h)),d-=h;d>=i[i.length-1].length;)i.push(i[i.length-1]),d-=i[i.length-1].length;i.push(i[0].slice(-h,-h+d))}}var g=Ji(i);if(g.length!=n)throw new Error("Unexpected length: ".concat(g.length," != ").concat(n));return g}function ln(e){for(var t=[],r=0;r<e.length;){var n=e[r++],i=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(RF(n,e.slice(r,r+i))),r+=i}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Ji(t)}function Fl(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),i=new Uint8Array(4);t.push(i);var l=Ut(n),o=l.length;t.push(l),n<=60?(o++,t.push(new Uint8Array([n-1<<2]))):n<=256?(o+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(o+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(o+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(o+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),o+=n,i[0]=0,i[1]=o&255,i[2]=o>>8&255,i[3]=o>>16&255,r+=n}return Ji(t)}function DF(e,t,r,n){var i=Ms(e),l=i.getUint32(4,!0),o=(n>1?12:8)+ky(l&(n>1?3470:398))*4,u=-1,h=-1,d=NaN,g=new Date(2001,0,1);l&512&&(u=i.getUint32(o,!0),o+=4),o+=ky(l&(n>1?12288:4096))*4,l&16&&(h=i.getUint32(o,!0),o+=4),l&32&&(d=i.getFloat64(o,!0),o+=8),l&64&&(g.setTime(g.getTime()+i.getFloat64(o,!0)*1e3),o+=8);var p;switch(e[2]){case 0:break;case 2:p={t:"n",v:d};break;case 3:p={t:"s",v:t[h]};break;case 5:p={t:"d",v:g};break;case 6:p={t:"b",v:d>0};break;case 7:p={t:"n",v:d/86400};break;case 8:p={t:"e",v:0};break;case 9:if(u>-1)p={t:"s",v:r[u]};else if(h>-1)p={t:"s",v:t[h]};else if(!isNaN(d))p={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return p}function FF(e,t,r){var n=Ms(e),i=n.getUint32(8,!0),l=12,o=-1,u=-1,h=NaN,d=NaN,g=new Date(2001,0,1);i&1&&(h=NF(e,l),l+=16),i&2&&(d=n.getFloat64(l,!0),l+=8),i&4&&(g.setTime(g.getTime()+n.getFloat64(l,!0)*1e3),l+=8),i&8&&(u=n.getUint32(l,!0),l+=4),i&16&&(o=n.getUint32(l,!0),l+=4);var p;switch(e[1]){case 0:break;case 2:p={t:"n",v:h};break;case 3:p={t:"s",v:t[u]};break;case 5:p={t:"d",v:g};break;case 6:p={t:"b",v:d>0};break;case 7:p={t:"n",v:d/86400};break;case 8:p={t:"e",v:0};break;case 9:if(o>-1)p={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)));break;case 10:p={t:"n",v:h};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)))}return p}function Ad(e,t){var r=new Uint8Array(32),n=Ms(r),i=12,l=0;switch(r[0]=5,e.t){case"n":r[1]=2,OF(r,i,e.v),l|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,e.v?1:0,!0),l|=2,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(i,t.indexOf(e.v),!0),l|=8,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,l,!0),r.slice(0,i)}function Cd(e,t){var r=new Uint8Array(32),n=Ms(r),i=12,l=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(i,e.v,!0),l|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,e.v?1:0,!0),l|=32,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(i,t.indexOf(e.v),!0),l|=16,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,l,!0),r.slice(0,i)}function MF(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return DF(e,t,r,e[0]);case 5:return FF(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function ra(e){var t=Dt(e);return No(t[1][0].data)}function Ay(e,t){var r=Dt(t.data),n=hr(r[1][0].data),i=r[3],l=[];return(i||[]).forEach(function(o){var u=Dt(o.data),h=hr(u[1][0].data)>>>0;switch(n){case 1:l[h]=Zd(u[3][0].data);break;case 8:{var d=e[ra(u[9][0].data)][0],g=Dt(d.data),p=e[ra(g[1][0].data)][0],v=hr(p.meta[1][0].data);if(v!=2001)throw new Error("2000 unexpected reference to ".concat(v));var _=Dt(p.data);l[h]=_[3].map(function(w){return Zd(w.data)}).join("")}break}}),l}function LF(e,t){var r,n,i,l,o,u,h,d,g,p,v,_,w,y,S=Dt(e),k=hr(S[1][0].data)>>>0,R=hr(S[2][0].data)>>>0,T=((n=(r=S[8])==null?void 0:r[0])==null?void 0:n.data)&&hr(S[8][0].data)>0||!1,B,X;if((l=(i=S[7])==null?void 0:i[0])!=null&&l.data&&t!=0)B=(u=(o=S[7])==null?void 0:o[0])==null?void 0:u.data,X=(d=(h=S[6])==null?void 0:h[0])==null?void 0:d.data;else if((p=(g=S[4])==null?void 0:g[0])!=null&&p.data&&t!=1)B=(_=(v=S[4])==null?void 0:v[0])==null?void 0:_.data,X=(y=(w=S[3])==null?void 0:w[0])==null?void 0:y.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var M=T?4:1,N=Ms(B),Z=[],q=0;q<B.length/2;++q){var he=N.getUint16(q*2,!0);he<65535&&Z.push([q,he])}if(Z.length!=R)throw"Expected ".concat(R," cells, found ").concat(Z.length);var Y=[];for(q=0;q<Z.length-1;++q)Y[Z[q][0]]=X.subarray(Z[q][1]*M,Z[q+1][1]*M);return Z.length>=1&&(Y[Z[Z.length-1][0]]=X.subarray(Z[Z.length-1][1]*M)),{R:k,cells:Y}}function BF(e,t){var r,n=Dt(t.data),i=(r=n?.[7])!=null&&r[0]?hr(n[7][0].data)>>>0>0?1:0:-1,l=Hm(n[5],function(o){return LF(o,i)});return{nrows:hr(n[4][0].data)>>>0,data:l.reduce(function(o,u){return o[u.R]||(o[u.R]=[]),u.cells.forEach(function(h,d){if(o[u.R][d])throw new Error("Duplicate cell r=".concat(u.R," c=").concat(d));o[u.R][d]=h}),o},[])}}function IF(e,t,r){var n,i=Dt(t.data),l={s:{r:0,c:0},e:{r:0,c:0}};if(l.e.r=(hr(i[6][0].data)>>>0)-1,l.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(l.e.c=(hr(i[7][0].data)>>>0)-1,l.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=mt(l);var o=Dt(i[4][0].data),u=Ay(e,e[ra(o[4][0].data)][0]),h=(n=o[17])!=null&&n[0]?Ay(e,e[ra(o[17][0].data)][0]):[],d=Dt(o[3][0].data),g=0;d[1].forEach(function(p){var v=Dt(p.data),_=e[ra(v[2][0].data)][0],w=hr(_.meta[1][0].data);if(w!=6002)throw new Error("6001 unexpected reference to ".concat(w));var y=BF(e,_);y.data.forEach(function(S,k){S.forEach(function(R,T){var B=st({r:g+k,c:T}),X=MF(R,u,h);X&&(r[B]=X)})}),g+=y.nrows})}function UF(e,t){var r=Dt(t.data),n={"!ref":"A1"},i=e[ra(r[2][0].data)],l=hr(i[0].meta[1][0].data);if(l!=6001)throw new Error("6000 unexpected reference to ".concat(l));return IF(e,i[0],n),n}function jF(e,t){var r,n=Dt(t.data),i={name:(r=n[1])!=null&&r[0]?Zd(n[1][0].data):"",sheets:[]},l=Hm(n[2],ra);return l.forEach(function(o){e[o].forEach(function(u){var h=hr(u.meta[1][0].data);h==6e3&&i.sheets.push(UF(e,u))})}),i}function PF(e,t){var r=Xm(),n=Dt(t.data),i=Hm(n[1],ra);if(i.forEach(function(l){e[l].forEach(function(o){var u=hr(o.meta[1][0].data);if(u==2){var h=jF(e,o);h.sheets.forEach(function(d,g){Wm(r,d,g==0?h.name:h.name+"_"+g,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Nd(e){var t,r,n,i,l={},o=[];if(e.FullPaths.forEach(function(h){if(h.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(h){if(h.name.match(/\.iwa$/)){var d;try{d=ln(h.content)}catch(p){return console.log("?? "+h.content.length+" "+(p.message||p))}var g;try{g=sn(d)}catch(p){return console.log("## "+(p.message||p))}g.forEach(function(p){l[p.id]=p.messages,o.push(p.id)})}}),!o.length)throw new Error("File has no messages");var u=((i=(n=(r=(t=l?.[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&hr(l[1][0].meta[1][0].data)==1&&l[1][0];if(u||o.forEach(function(h){l[h].forEach(function(d){var g=hr(d.meta[1][0].data)>>>0;if(g==1)if(!u)u=d;else throw new Error("Document has multiple roots")})}),!u)throw new Error("Cannot find Document root");return PF(l,u)}function zF(e,t,r){var n,i,l,o;if(!((n=e[6])!=null&&n[0])||!((i=e[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var u=((o=(l=e[8])==null?void 0:l[0])==null?void 0:o.data)&&hr(e[8][0].data)>0||!1;if(u)throw"Math only works with normal offsets";for(var h=0,d=Ms(e[7][0].data),g=0,p=[],v=Ms(e[4][0].data),_=0,w=[],y=0;y<t.length;++y){if(t[y]==null){d.setUint16(y*2,65535,!0),v.setUint16(y*2,65535);continue}d.setUint16(y*2,g,!0),v.setUint16(y*2,_,!0);var S,k;switch(typeof t[y]){case"string":S=Ad({t:"s",v:t[y]},r),k=Cd({t:"s",v:t[y]},r);break;case"number":S=Ad({t:"n",v:t[y]},r),k=Cd({t:"n",v:t[y]},r);break;case"boolean":S=Ad({t:"b",v:t[y]},r),k=Cd({t:"b",v:t[y]},r);break;default:throw new Error("Unsupported value "+t[y])}p.push(S),g+=S.length,w.push(k),_+=k.length,++h}for(e[2][0].data=Ut(h);y<e[7][0].data.length/2;++y)d.setUint16(y*2,65535,!0),v.setUint16(y*2,65535,!0);return e[6][0].data=Ji(p),e[3][0].data=Ji(w),h}function HF(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=ka(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(mt(n)));var l=Mu(r,{range:n,header:1}),o=["~Sh33tJ5~"];l.forEach(function(z){return z.forEach(function(U){typeof U=="string"&&o.push(U)})});var u={},h=[],d=tt.read(t.numbers,{type:"base64"});d.FileIndex.map(function(z,U){return[z,d.FullPaths[U]]}).forEach(function(z){var U=z[0],G=z[1];if(U.type==2&&U.name.match(/\.iwa/)){var ne=U.content,we=ln(ne),Te=sn(we);Te.forEach(function(Se){h.push(Se.id),u[Se.id]={deps:[],location:G,type:hr(Se.messages[0].meta[1][0].data)}})}}),h.sort(function(z,U){return z-U});var g=h.filter(function(z){return z>1}).map(function(z){return[z,Ut(z)]});d.FileIndex.map(function(z,U){return[z,d.FullPaths[U]]}).forEach(function(z){var U=z[0];if(z[1],!!U.name.match(/\.iwa/)){var G=sn(ln(U.content));G.forEach(function(ne){ne.messages.forEach(function(we){g.forEach(function(Te){ne.messages.some(function(Se){return hr(Se.meta[1][0].data)!=11006&&CF(Se.data,Te[1])})&&u[Te[0]].deps.push(ne.id)})})})}});for(var p=tt.find(d,u[1].location),v=sn(ln(p.content)),_,w=0;w<v.length;++w){var y=v[w];y.id==1&&(_=y)}var S=ra(Dt(_.messages[0].data)[1][0].data);for(p=tt.find(d,u[S].location),v=sn(ln(p.content)),w=0;w<v.length;++w)y=v[w],y.id==S&&(_=y);for(S=ra(Dt(_.messages[0].data)[2][0].data),p=tt.find(d,u[S].location),v=sn(ln(p.content)),w=0;w<v.length;++w)y=v[w],y.id==S&&(_=y);for(S=ra(Dt(_.messages[0].data)[2][0].data),p=tt.find(d,u[S].location),v=sn(ln(p.content)),w=0;w<v.length;++w)y=v[w],y.id==S&&(_=y);var k=Dt(_.messages[0].data);{k[6][0].data=Ut(n.e.r+1),k[7][0].data=Ut(n.e.c+1);var R=ra(k[46][0].data),T=tt.find(d,u[R].location),B=sn(ln(T.content));{for(var X=0;X<B.length&&B[X].id!=R;++X);if(B[X].id!=R)throw"Bad ColumnRowUIDMapArchive";var M=Dt(B[X].messages[0].data);M[1]=[],M[2]=[],M[3]=[];for(var N=0;N<=n.e.c;++N){var Z=[];Z[1]=Z[2]=[{type:0,data:Ut(N+420690)}],M[1].push({type:2,data:qr(Z)}),M[2].push({type:0,data:Ut(N)}),M[3].push({type:0,data:Ut(N)})}M[4]=[],M[5]=[],M[6]=[];for(var q=0;q<=n.e.r;++q)Z=[],Z[1]=Z[2]=[{type:0,data:Ut(q+726270)}],M[4].push({type:2,data:qr(Z)}),M[5].push({type:0,data:Ut(q)}),M[6].push({type:0,data:Ut(q)});B[X].messages[0].data=qr(M)}T.content=Fl(Dl(B)),T.size=T.content.length,delete k[46];var he=Dt(k[4][0].data);{he[7][0].data=Ut(n.e.r+1);var Y=Dt(he[1][0].data),Q=ra(Y[2][0].data);T=tt.find(d,u[Q].location),B=sn(ln(T.content));{if(B[0].id!=Q)throw"Bad HeaderStorageBucket";var pe=Dt(B[0].messages[0].data);for(q=0;q<l.length;++q){var Ce=Dt(pe[2][0].data);Ce[1][0].data=Ut(q),Ce[4][0].data=Ut(l[q].length),pe[2][q]={type:pe[2][0].type,data:qr(Ce)}}B[0].messages[0].data=qr(pe)}T.content=Fl(Dl(B)),T.size=T.content.length;var _e=ra(he[2][0].data);T=tt.find(d,u[_e].location),B=sn(ln(T.content));{if(B[0].id!=_e)throw"Bad HeaderStorageBucket";for(pe=Dt(B[0].messages[0].data),N=0;N<=n.e.c;++N)Ce=Dt(pe[2][0].data),Ce[1][0].data=Ut(N),Ce[4][0].data=Ut(n.e.r+1),pe[2][N]={type:pe[2][0].type,data:qr(Ce)};B[0].messages[0].data=qr(pe)}T.content=Fl(Dl(B)),T.size=T.content.length;var te=ra(he[4][0].data);(function(){for(var z=tt.find(d,u[te].location),U=sn(ln(z.content)),G,ne=0;ne<U.length;++ne){var we=U[ne];we.id==te&&(G=we)}var Te=Dt(G.messages[0].data);{Te[3]=[];var Se=[];o.forEach(function(V,Nt){Se[1]=[{type:0,data:Ut(Nt)}],Se[2]=[{type:0,data:Ut(1)}],Se[3]=[{type:2,data:AF(V)}],Te[3].push({type:2,data:qr(Se)})})}G.messages[0].data=qr(Te);var Ne=Dl(U),ot=Fl(Ne);z.content=ot,z.size=z.content.length})();var se=Dt(he[3][0].data);{var ge=se[1][0];delete se[2];var J=Dt(ge.data);{var Oe=ra(J[2][0].data);(function(){for(var z=tt.find(d,u[Oe].location),U=sn(ln(z.content)),G,ne=0;ne<U.length;++ne){var we=U[ne];we.id==Oe&&(G=we)}var Te=Dt(G.messages[0].data);{delete Te[6],delete se[7];var Se=new Uint8Array(Te[5][0].data);Te[5]=[];for(var Ne=0,ot=0;ot<=n.e.r;++ot){var V=Dt(Se);Ne+=zF(V,l[ot],o),V[1][0].data=Ut(ot),Te[5].push({data:qr(V),type:2})}Te[1]=[{type:0,data:Ut(n.e.c+1)}],Te[2]=[{type:0,data:Ut(n.e.r+1)}],Te[3]=[{type:0,data:Ut(Ne)}],Te[4]=[{type:0,data:Ut(n.e.r+1)}]}G.messages[0].data=qr(Te);var Nt=Dl(U),lt=Fl(Nt);z.content=lt,z.size=z.content.length})()}ge.data=qr(J)}he[3][0].data=qr(se)}k[4][0].data=qr(he)}_.messages[0].data=qr(k);var I=Dl(v),A=Fl(I);return p.content=A,p.size=p.content.length,d}function nw(e){return function(r){for(var n=0;n!=e.length;++n){var i=e[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function Vm(e){nw([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function $m(e){nw([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function VF(e){return yt.WS.indexOf(e)>-1?"sheet":e==yt.CS?"chart":e==yt.DS?"dialog":e==yt.MS?"macro":e&&e.length?e:"sheet"}function $F(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,VF(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function GF(e,t,r,n,i,l,o,u,h,d,g,p){try{l[n]=no(Va(e,r,!0),t);var v=kr(e,t),_;switch(u){case"sheet":_=dD(v,t,i,h,l[n],d,g,p);break;case"chart":if(_=mD(v,t,i,h,l[n],d,g,p),!_||!_["!drawel"])break;var w=Qc(_["!drawel"].Target,t),y=So(w),S=eN(Va(e,w,!0),no(Va(e,y,!0),w)),k=Qc(S,w),R=So(k);_=zR(Va(e,k,!0),k,h,no(Va(e,R,!0),k),d,_);break;case"macro":_=gD(v,t,i,h,l[n],d,g,p);break;case"dialog":_=xD(v,t,i,h,l[n],d,g,p);break;default:throw new Error("Unrecognized sheet type "+u)}o[n]=_;var T=[];l&&l[n]&&dr(l[n]).forEach(function(B){var X="";if(l[n][B].Type==yt.CMNT){X=Qc(l[n][B].Target,t);var M=_D(kr(e,X,!0),X,h);if(!M||!M.length)return;hy(_,M,!1)}l[n][B].Type==yt.TCMNT&&(X=Qc(l[n][B].Target,t),T=T.concat(rN(kr(e,X,!0),h)))}),T&&T.length&&hy(_,T,!0,h.people||[])}catch(B){if(h.WTF)throw B}}function an(e){return e.charAt(0)=="/"?e.slice(1):e}function qF(e,t){if(Ql(),t=t||{},Vm(t),cn(e,"META-INF/manifest.xml")||cn(e,"objectdata.xml"))return Sy(e,t);if(cn(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Nd<"u"){if(e.FileIndex)return Nd(e);var r=tt.utils.cfb_new();return Fv(e).forEach(function(Ce){xt(r,Ce,aA(e,Ce))}),Nd(r)}throw new Error("Unsupported NUMBERS file")}if(!cn(e,"[Content_Types].xml"))throw cn(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):cn(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Fv(e),i=YA(Va(e,"[Content_Types].xml")),l=!1,o,u;if(i.workbooks.length===0&&(u="xl/workbook.xml",kr(e,u,!0)&&i.workbooks.push(u)),i.workbooks.length===0){if(u="xl/workbook.bin",!kr(e,u,!0))throw new Error("Could not find workbook");i.workbooks.push(u),l=!0}i.workbooks[0].slice(-3)=="bin"&&(l=!0);var h={},d={};if(!t.bookSheets&&!t.bookProps){if(io=[],i.sst)try{io=yD(kr(e,an(i.sst)),i.sst,t)}catch(Ce){if(t.WTF)throw Ce}t.cellStyles&&i.themes.length&&(h=vD(Va(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],t)),i.style&&(d=pD(kr(e,an(i.style)),i.style,h,t))}i.links.map(function(Ce){try{var _e=no(Va(e,So(an(Ce))),Ce);return bD(kr(e,an(Ce)),_e,Ce,t)}catch{}});var g=hD(kr(e,an(i.workbooks[0])),i.workbooks[0],t),p={},v="";i.coreprops.length&&(v=kr(e,an(i.coreprops[0]),!0),v&&(p=q_(v)),i.extprops.length!==0&&(v=kr(e,an(i.extprops[0]),!0),v&&a3(v,p,t)));var _={};(!t.bookSheets||t.bookProps)&&i.custprops.length!==0&&(v=Va(e,an(i.custprops[0]),!0),v&&(_=i3(v,t)));var w={};if((t.bookSheets||t.bookProps)&&(g.Sheets?o=g.Sheets.map(function(_e){return _e.name}):p.Worksheets&&p.SheetNames.length>0&&(o=p.SheetNames),t.bookProps&&(w.Props=p,w.Custprops=_),t.bookSheets&&typeof o<"u"&&(w.SheetNames=o),t.bookSheets?w.SheetNames:t.bookProps))return w;o={};var y={};t.bookDeps&&i.calcchain&&(y=wD(kr(e,an(i.calcchain)),i.calcchain));var S=0,k={},R,T;{var B=g.Sheets;p.Worksheets=B.length,p.SheetNames=[];for(var X=0;X!=B.length;++X)p.SheetNames[X]=B[X].name}var M=l?"bin":"xml",N=i.workbooks[0].lastIndexOf("/"),Z=(i.workbooks[0].slice(0,N+1)+"_rels/"+i.workbooks[0].slice(N+1)+".rels").replace(/^\//,"");cn(e,Z)||(Z="xl/_rels/workbook."+M+".rels");var q=no(Va(e,Z,!0),Z.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(t.xlmeta=SD(kr(e,an(i.metadata[0])),i.metadata[0],t)),(i.people||[]).length>=1&&(t.people=nN(kr(e,an(i.people[0])),t)),q&&(q=$F(q,g.Sheets));var he=kr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(S=0;S!=p.Worksheets;++S){var Y="sheet";if(q&&q[S]?(R="xl/"+q[S][1].replace(/[\/]?xl\//,""),cn(e,R)||(R=q[S][1]),cn(e,R)||(R=Z.replace(/_rels\/.*$/,"")+q[S][1]),Y=q[S][2]):(R="xl/worksheets/sheet"+(S+1-he)+"."+M,R=R.replace(/sheet0\./,"sheet.")),T=R.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(S!=t.sheets)continue e;break;case"string":if(p.SheetNames[S].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var Q=!1,pe=0;pe!=t.sheets.length;++pe)typeof t.sheets[pe]=="number"&&t.sheets[pe]==S&&(Q=1),typeof t.sheets[pe]=="string"&&t.sheets[pe].toLowerCase()==p.SheetNames[S].toLowerCase()&&(Q=1);if(!Q)continue e}}GF(e,R,T,p.SheetNames[S],S,k,o,Y,t,g,h,d)}return w={Directory:i,Workbook:g,Props:p,Custprops:_,Deps:y,Sheets:o,SheetNames:p.SheetNames,Strings:io,Styles:d,Themes:h,SSF:tr(it)},t&&t.bookFiles&&(e.files?(w.keys=n,w.files=e.files):(w.keys=[],w.files={},e.FullPaths.forEach(function(Ce,_e){Ce=Ce.replace(/^Root Entry[\/]/,""),w.keys.push(Ce),w.files[Ce]=e.FileIndex[_e]}))),t&&t.bookVBA&&(i.vba.length>0?w.vbaraw=kr(e,an(i.vba[0]),!0):i.defaults&&i.defaults.bin===hN&&(w.vbaraw=kr(e,"xl/vbaProject.bin",!0))),w}function XF(e,t){var r=t||{},n="Workbook",i=tt.find(e,n);try{if(n="/!DataSpaces/Version",i=tt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(S6(i.content),n="/!DataSpaces/DataSpaceMap",i=tt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=T6(i.content);if(l.length!==1||l[0].comps.length!==1||l[0].comps[0].t!==0||l[0].name!=="StrongEncryptionDataSpace"||l[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=tt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=k6(i.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=tt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);C6(i.content)}catch{}if(n="/EncryptionInfo",i=tt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var u=N6(i.content);if(n="/EncryptedPackage",i=tt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(u[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(u[1],i.content,r.password||"",r);if(u[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(u[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function WF(e,t){return t.bookType=="ods"?aw(e,t):t.bookType=="numbers"?HF(e,t):t.bookType=="xlsb"?KF(e,t):YF(e,t)}function KF(e,t){jl=1024,e&&!e.SSF&&(e.SSF=tr(it)),e&&e.SSF&&(Ql(),zu(e.SSF),t.revssf=Vu(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,so?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=R2.indexOf(t.bookType)>-1,i=Nm();$m(t=t||{});var l=gm(),o="",u=0;if(t.cellXfs=[],es(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",xt(l,o,X_(e.Props,t)),i.coreprops.push(o),jt(t.rels,2,o,yt.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var h=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&h.push(e.SheetNames[d]);e.Props.SheetNames=h}for(e.Props.Worksheets=e.Props.SheetNames.length,xt(l,o,Y_(e.Props)),i.extprops.push(o),jt(t.rels,3,o,yt.EXT_PROPS),e.Custprops!==e.Props&&dr(e.Custprops||{}).length>0&&(o="docProps/custom.xml",xt(l,o,J_(e.Custprops)),i.custprops.push(o),jt(t.rels,4,o,yt.CUST_PROPS)),u=1;u<=e.SheetNames.length;++u){var g={"!id":{}},p=e.Sheets[e.SheetNames[u-1]],v=(p||{})["!type"]||"sheet";if(o="xl/worksheets/sheet"+u+"."+r,xt(l,o,TD(u-1,o,t,e,g)),i.sheets.push(o),jt(t.wbrels,-1,"worksheets/sheet"+u+"."+r,yt.WS[0]),p){var _=p["!comments"],w=!1,y="";_&&_.length>0&&(y="xl/comments"+u+"."+r,xt(l,y,CD(_,y)),i.comments.push(y),jt(g,-1,"../comments"+u+"."+r,yt.CMNT),w=!0),p["!legacy"]&&w&&xt(l,"xl/drawings/vmlDrawing"+u+".vml",N2(u,p["!comments"])),delete p["!comments"],delete p["!legacy"]}g["!id"].rId1&&xt(l,So(o),Hl(g))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,xt(l,o,AD(t.Strings,o,t)),i.strs.push(o),jt(t.wbrels,-1,"sharedStrings."+r,yt.SST)),o="xl/workbook."+r,xt(l,o,ED(e,o)),i.workbooks.push(o),jt(t.rels,1,o,yt.WB),o="xl/theme/theme1.xml",xt(l,o,Lm(e.Themes,t)),i.themes.push(o),jt(t.wbrels,-1,"theme/theme1.xml",yt.THEME),o="xl/styles."+r,xt(l,o,kD(e,o,t)),i.styles.push(o),jt(t.wbrels,-1,"styles."+r,yt.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",xt(l,o,e.vbaraw),i.vba.push(o),jt(t.wbrels,-1,"vbaProject.bin",yt.VBA)),o="xl/metadata."+r,xt(l,o,ND(o)),i.metadata.push(o),jt(t.wbrels,-1,"metadata."+r,yt.XLMETA),xt(l,"[Content_Types].xml",$_(i,t)),xt(l,"_rels/.rels",Hl(t.rels)),xt(l,"xl/_rels/workbook."+r+".rels",Hl(t.wbrels)),delete t.revssf,delete t.ssf,l}function YF(e,t){jl=1024,e&&!e.SSF&&(e.SSF=tr(it)),e&&e.SSF&&(Ql(),zu(e.SSF),t.revssf=Vu(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,so?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=R2.indexOf(t.bookType)>-1,i=Nm();$m(t=t||{});var l=gm(),o="",u=0;if(t.cellXfs=[],es(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",xt(l,o,X_(e.Props,t)),i.coreprops.push(o),jt(t.rels,2,o,yt.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var h=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&h.push(e.SheetNames[d]);e.Props.SheetNames=h}e.Props.Worksheets=e.Props.SheetNames.length,xt(l,o,Y_(e.Props)),i.extprops.push(o),jt(t.rels,3,o,yt.EXT_PROPS),e.Custprops!==e.Props&&dr(e.Custprops||{}).length>0&&(o="docProps/custom.xml",xt(l,o,J_(e.Custprops)),i.custprops.push(o),jt(t.rels,4,o,yt.CUST_PROPS));var g=["SheetJ5"];for(t.tcid=0,u=1;u<=e.SheetNames.length;++u){var p={"!id":{}},v=e.Sheets[e.SheetNames[u-1]],_=(v||{})["!type"]||"sheet";if(o="xl/worksheets/sheet"+u+"."+r,xt(l,o,H2(u-1,t,e,p)),i.sheets.push(o),jt(t.wbrels,-1,"worksheets/sheet"+u+"."+r,yt.WS[0]),v){var w=v["!comments"],y=!1,S="";if(w&&w.length>0){var k=!1;w.forEach(function(R){R[1].forEach(function(T){T.T==!0&&(k=!0)})}),k&&(S="xl/threadedComments/threadedComment"+u+"."+r,xt(l,S,aN(w,g,t)),i.threadedcomments.push(S),jt(p,-1,"../threadedComments/threadedComment"+u+"."+r,yt.TCMNT)),S="xl/comments"+u+"."+r,xt(l,S,O2(w)),i.comments.push(S),jt(p,-1,"../comments"+u+"."+r,yt.CMNT),y=!0}v["!legacy"]&&y&&xt(l,"xl/drawings/vmlDrawing"+u+".vml",N2(u,v["!comments"])),delete v["!comments"],delete v["!legacy"]}p["!id"].rId1&&xt(l,So(o),Hl(p))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,xt(l,o,p2(t.Strings,t)),i.strs.push(o),jt(t.wbrels,-1,"sharedStrings."+r,yt.SST)),o="xl/workbook."+r,xt(l,o,X2(e)),i.workbooks.push(o),jt(t.rels,1,o,yt.WB),o="xl/theme/theme1.xml",xt(l,o,Lm(e.Themes,t)),i.themes.push(o),jt(t.wbrels,-1,"theme/theme1.xml",yt.THEME),o="xl/styles."+r,xt(l,o,T2(e,t)),i.styles.push(o),jt(t.wbrels,-1,"styles."+r,yt.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",xt(l,o,e.vbaraw),i.vba.push(o),jt(t.wbrels,-1,"vbaProject.bin",yt.VBA)),o="xl/metadata."+r,xt(l,o,C2()),i.metadata.push(o),jt(t.wbrels,-1,"metadata."+r,yt.XLMETA),g.length>1&&(o="xl/persons/person.xml",xt(l,o,iN(g)),i.people.push(o),jt(t.wbrels,-1,"persons/person.xml",yt.PEOPLE)),xt(l,"[Content_Types].xml",$_(i,t)),xt(l,"_rels/.rels",Hl(t.rels)),xt(l,"xl/_rels/workbook."+r+".rels",Hl(t.wbrels)),delete t.revssf,delete t.ssf,l}function Gm(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=$a(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function JF(e,t){return tt.find(e,"EncryptedPackage")?XF(e,t):J2(e,t)}function QF(e,t){var r,n=e,i=t||{};return i.type||(i.type=pt&&Buffer.isBuffer(e)?"buffer":"base64"),r=y_(n,i),qF(r,i)}function iw(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Jd(e.slice(r),t);default:break e}return Xl.to_workbook(e,t)}function ZF(e,t){var r="",n=Gm(e,t);switch(t.type){case"base64":r=$a(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Os(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Gt(r)),t.type="binary",iw(r,t)}function e7(e,t){var r=e;return t.type=="base64"&&(r=$a(r)),r=po.utils.decode(1200,r.slice(2),"str"),t.type="binary",iw(r,t)}function t7(e){return e.match(/[^\x00-\x7F]/)?Mn(e):e}function Od(e,t,r,n){return n?(r.type="string",Xl.to_workbook(e,r)):Xl.to_workbook(t,r)}function Fu(e,t){um();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Fu(new Uint8Array(e),(r=tr(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,i=[0,0,0,0],l=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),$l={},r.dateNF&&($l.dateNF=r.dateNF),r.type||(r.type=pt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=pt?"buffer":"binary",n=Kk(e),typeof Uint8Array<"u"&&!pt&&(r.type="array")),r.type=="string"&&(l=!0,r.type="binary",r.codepage=65001,n=t7(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),u=new Uint8Array(o);if(u.foo="bar",!u.foo)return r=tr(r),r.type="array",Fu(fm(n),r)}switch((i=Gm(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return JF(tt.read(n,r),r);break;case 9:if(i[1]<=8)return J2(n,r);break;case 60:return Jd(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return s6(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return g2.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?QF(n,r):Od(e,n,r,l);case 239:return i[3]===60?Jd(n,r):Od(e,n,r,l);case 255:if(i[1]===254)return e7(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return As.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return As.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Yd.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return b2.to_workbook(n,r);break;case 10:case 13:case 32:return ZF(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return i6.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?Yd.to_workbook(n,r):Od(e,n,r,l)}function sw(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Do(t.file,tt.write(e,{type:pt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return tt.write(e,t)}function r7(e,t){var r=tr(t||{}),n=WF(e,r);return a7(n,r)}function a7(e,t){var r={},n=pt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var i=e.FullPaths?tt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(t.type=="binary"||t.type=="base64")return i;i=new Uint8Array(Pu(i))}return t.password&&typeof encrypt_agile<"u"?sw(encrypt_agile(i,t.password),t):t.type==="file"?Do(t.file,i):t.type=="string"?Gt(i):i}function n7(e,t){var r=t||{},n=tF(e,r);return sw(n,r)}function Fn(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return vo(Mn(n));case"binary":return Mn(n);case"string":return e;case"file":return Do(t.file,n,"utf8");case"buffer":return pt?fi(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Fn(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function i7(e,t){switch(t.type){case"base64":return vo(e);case"binary":return e;case"string":return e;case"file":return Do(t.file,e,"binary");case"buffer":return pt?fi(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function gu(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?vo(r):t.type=="string"?Gt(r):r;case"file":return Do(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function lw(e,t){um(),JR(e);var r=tr(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=lw(e,r);return r.type="array",Pu(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=e.SheetNames.indexOf(r.sheet),!e.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Fn(WD(e,r),r);case"slk":case"sylk":return Fn(m2.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"htm":case"html":return Fn(Z2(e.Sheets[e.SheetNames[i]],r),r);case"txt":return i7(cw(e.Sheets[e.SheetNames[i]],r),r);case"csv":return Fn(qm(e.Sheets[e.SheetNames[i]],r),r,"\uFEFF");case"dif":return Fn(g2.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"dbf":return gu(Yd.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"prn":return Fn(Xl.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"rtf":return Fn(b2.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"eth":return Fn(x2.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"fods":return Fn(aw(e,r),r);case"wk1":return gu(As.sheet_to_wk1(e.Sheets[e.SheetNames[i]],r),r);case"wk3":return gu(As.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),gu(Q2(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),n7(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return r7(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function s7(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function Cy(e,t,r){var n={};return n.type="file",n.file=t,s7(n),lw(e,n)}function l7(e,t,r,n,i,l,o,u){var h=yr(r),d=u.defval,g=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),p=!0,v=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(v,"__rowNum__",{value:r,enumerable:!1})}catch{v.__rowNum__=r}else v.__rowNum__=r;if(!o||e[r])for(var _=t.s.c;_<=t.e.c;++_){var w=o?e[r][_]:e[n[_]+h];if(w===void 0||w.t===void 0){if(d===void 0)continue;l[_]!=null&&(v[l[_]]=d);continue}var y=w.v;switch(w.t){case"z":if(y==null)break;continue;case"e":y=y==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+w.t)}if(l[_]!=null){if(y==null)if(w.t=="e"&&y===null)v[l[_]]=null;else if(d!==void 0)v[l[_]]=d;else if(g&&y===null)v[l[_]]=null;else continue;else v[l[_]]=g&&(w.t!=="n"||w.t==="n"&&u.rawNumbers!==!1)?y:oi(w,y,u);y!=null&&(p=!1)}}return{row:v,isempty:p}}function Mu(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,l=[],o=0,u="",h={s:{r:0,c:0},e:{r:0,c:0}},d=t||{},g=d.range!=null?d.range:e["!ref"];switch(d.header===1?n=1:d.header==="A"?n=2:Array.isArray(d.header)?n=3:d.header==null&&(n=0),typeof g){case"string":h=Ct(g);break;case"number":h=Ct(e["!ref"]),h.s.r=g;break;default:h=g}n>0&&(i=0);var p=yr(h.s.r),v=[],_=[],w=0,y=0,S=Array.isArray(e),k=h.s.r,R=0,T={};S&&!e[k]&&(e[k]=[]);var B=d.skipHidden&&e["!cols"]||[],X=d.skipHidden&&e["!rows"]||[];for(R=h.s.c;R<=h.e.c;++R)if(!(B[R]||{}).hidden)switch(v[R]=ir(R),r=S?e[k][R]:e[v[R]+p],n){case 1:l[R]=R-h.s.c;break;case 2:l[R]=v[R];break;case 3:l[R]=d.header[R-h.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),u=o=oi(r,null,d),y=T[o]||0,!y)T[o]=1;else{do u=o+"_"+y++;while(T[u]);T[o]=y,T[u]=1}l[R]=u}for(k=h.s.r+i;k<=h.e.r;++k)if(!(X[k]||{}).hidden){var M=l7(e,h,k,v,n,l,S,d);(M.isempty===!1||(n===1?d.blankrows!==!1:d.blankrows))&&(_[w++]=M.row)}return _.length=w,_}var Ny=/"/g;function c7(e,t,r,n,i,l,o,u){for(var h=!0,d=[],g="",p=yr(r),v=t.s.c;v<=t.e.c;++v)if(n[v]){var _=u.dense?(e[r]||[])[v]:e[n[v]+p];if(_==null)g="";else if(_.v!=null){h=!1,g=""+(u.rawNumbers&&_.t=="n"?_.v:oi(_,null,u));for(var w=0,y=0;w!==g.length;++w)if((y=g.charCodeAt(w))===i||y===l||y===34||u.forceQuotes){g='"'+g.replace(Ny,'""')+'"';break}g=="ID"&&(g='"ID"')}else _.f!=null&&!_.F?(h=!1,g="="+_.f,g.indexOf(",")>=0&&(g='"'+g.replace(Ny,'""')+'"')):g="";d.push(g)}return u.blankrows===!1&&h?null:d.join(o)}function qm(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var i=Ct(e["!ref"]),l=n.FS!==void 0?n.FS:",",o=l.charCodeAt(0),u=n.RS!==void 0?n.RS:`
`,h=u.charCodeAt(0),d=new RegExp((l=="|"?"\\|":l)+"+$"),g="",p=[];n.dense=Array.isArray(e);for(var v=n.skipHidden&&e["!cols"]||[],_=n.skipHidden&&e["!rows"]||[],w=i.s.c;w<=i.e.c;++w)(v[w]||{}).hidden||(p[w]=ir(w));for(var y=0,S=i.s.r;S<=i.e.r;++S)(_[S]||{}).hidden||(g=c7(e,i,S,p,o,h,l,n),g!=null&&(n.strip&&(g=g.replace(d,"")),(g||n.blankrows!==!1)&&r.push((y++?u:"")+g)));return delete n.dense,r.join("")}function cw(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=qm(e,t);return r}function o7(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var i=Ct(e["!ref"]),l="",o=[],u,h=[],d=Array.isArray(e);for(u=i.s.c;u<=i.e.c;++u)o[u]=ir(u);for(var g=i.s.r;g<=i.e.r;++g)for(l=yr(g),u=i.s.c;u<=i.e.c;++u)if(t=o[u]+l,r=d?(e[g]||[])[u]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}h[h.length]=t+"="+n}return h}function ow(e,t,r){var n=r||{},i=+!n.skipHeader,l=e||{},o=0,u=0;if(l&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var h=typeof n.origin=="string"?sr(n.origin):n.origin;o=h.r,u=h.c}var d,g={s:{c:0,r:0},e:{c:u,r:o+t.length-1+i}};if(l["!ref"]){var p=Ct(l["!ref"]);g.e.c=Math.max(g.e.c,p.e.c),g.e.r=Math.max(g.e.r,p.e.r),o==-1&&(o=p.e.r+1,g.e.r=o+t.length-1+i)}else o==-1&&(o=0,g.e.r=t.length-1+i);var v=n.header||[],_=0;t.forEach(function(y,S){dr(y).forEach(function(k){(_=v.indexOf(k))==-1&&(v[_=v.length]=k);var R=y[k],T="z",B="",X=st({c:u+_,r:o+S+i});d=Oo(l,X),R&&typeof R=="object"&&!(R instanceof Date)?l[X]=R:(typeof R=="number"?T="n":typeof R=="boolean"?T="b":typeof R=="string"?T="s":R instanceof Date?(T="d",n.cellDates||(T="n",R=Dr(R)),B=n.dateNF||it[14]):R===null&&n.nullError&&(T="e",R=0),d?(d.t=T,d.v=R,delete d.w,delete d.R,B&&(d.z=B)):l[X]=d={t:T,v:R},B&&(d.z=B))})}),g.e.c=Math.max(g.e.c,u+v.length-1);var w=yr(o);if(i)for(_=0;_<v.length;++_)l[ir(_+u)+w]={t:"s",v:v[_]};return l["!ref"]=mt(g),l}function u7(e,t){return ow(null,e,t)}function Oo(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=sr(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Oo(e,st(t)):Oo(e,st({r:t,c:r||0}))}function f7(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Xm(){return{SheetNames:[],Sheets:{}}}function Wm(e,t,r,n){var i=1;if(!r)for(;i<=65535&&e.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var l=r.match(/(^.*?)(\d+)$/);i=l&&+l[2]||0;var o=l&&l[1]||r;for(++i;i<=65535&&e.SheetNames.indexOf(r=o+i)!=-1;++i);}if(q2(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function h7(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=f7(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function d7(e,t){return e.z=t,e}function uw(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function m7(e,t,r){return uw(e,"#"+t,r)}function g7(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function x7(e,t,r,n){for(var i=typeof t!="string"?t:Ct(t),l=typeof t=="string"?t:mt(t),o=i.s.r;o<=i.e.r;++o)for(var u=i.s.c;u<=i.e.c;++u){var h=Oo(e,o,u);h.t="n",h.F=l,delete h.v,o==i.s.r&&u==i.s.c&&(h.f=r,n&&(h.D=!0))}return e}var zi={encode_col:ir,encode_row:yr,encode_cell:st,encode_range:mt,decode_col:Sm,decode_row:bm,split_cell:AA,decode_cell:sr,decode_range:ka,format_cell:oi,sheet_add_aoa:I_,sheet_add_json:ow,sheet_add_dom:ew,aoa_to_sheet:Zl,json_to_sheet:u7,table_to_sheet:tw,table_to_book:SF,sheet_to_csv:qm,sheet_to_txt:cw,sheet_to_json:Mu,sheet_to_html:Z2,sheet_to_formulae:o7,sheet_to_row_object_array:Mu,sheet_get_cell:Oo,book_new:Xm,book_append_sheet:Wm,book_set_sheet_visibility:h7,cell_set_number_format:d7,cell_set_hyperlink:uw,cell_set_internal_link:m7,cell_add_comment:g7,sheet_set_array_formula:x7,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function p7(){const[e,t]=Xe.useState("dashboard"),[r,n]=Xe.useState(!0),[i,l]=Xe.useState([]),[o,u]=Xe.useState(""),[h,d]=Xe.useState("772"),[g,p]=Xe.useState(!1),[v,_]=Xe.useState(50),[w,y]=Xe.useState({771:1,772:1}),[S,k]=Xe.useState(!1),[R,T]=Xe.useState(null),[B,X]=Xe.useState({loading:!0,message:"",type:""}),M=Xe.useRef(null),[N,Z]=Xe.useState({loading:!1,message:"",type:""}),q=Xe.useRef(null),[he,Y]=Xe.useState({loading:!1,message:"",type:""}),Q=Xe.useRef(null),[pe,Ce]=Xe.useState({loading:!1,message:"",type:""}),[_e,te]=Xe.useState([]),[se,ge]=Xe.useState(null),J=Xe.useRef(null),[Oe,I]=Xe.useState({loading:!1,message:"",type:""}),[A,z]=Xe.useState([]),[U,G]=Xe.useState(""),[ne,we]=Xe.useState(1),[Te,Se]=Xe.useState(50),Ne=Xe.useRef(null),[ot,V]=Xe.useState({loading:!1,message:"",type:""}),[Nt,lt]=Xe.useState([]),[Tt,ft]=Xe.useState(""),[je,zt]=Xe.useState(1),[gr,Kr]=Xe.useState(50),Fr=P=>{const W=P?.message?String(P.message):"";return W.toLowerCase().includes("schema cache")||W.toLowerCase().includes("could not find the table")?"Parece que en Supabase an no existe (o no se ha refrescado) la tabla `public.tertiary_packaging`. Ejecuta `supabase/schema.sql` en Supabase (SQL Editor) y luego recarga el schema con: NOTIFY pgrst, 'reload schema';":""},Ga=P=>{const W=P?.message?String(P.message):"";return W.toLowerCase().includes("schema cache")||W.toLowerCase().includes("could not find the table")?"Parece que en Supabase an no existe (o no se ha refrescado) la tabla `public.medication_categories`. Ejecuta `supabase/schema.sql` en Supabase (SQL Editor) y luego recarga el schema con: NOTIFY pgrst, 'reload schema';":""};Xe.useEffect(()=>{let P=!1;async function W(){X({loading:!0,message:$i?"Conectando a Supabase...":"Cargando datos locales...",type:"info"});try{const[re,ke,De]=await Promise.all([It.getMedications(),It.getMonthlyBatches(),It.getSelectedMonthlyBatchId?.()]);if(P)return;l(re??[]);const Fe=(ke??[]).map(Qe=>({...Qe,id:Qe?.id!=null?String(Qe.id):Qe.id}));te(Fe);try{const Qe=await It.getTertiaryPackaging?.()??[];P||z(Qe??[])}catch(Qe){const Je=Fr(Qe);P||(z([]),I({loading:!1,message:Je?`${String(Qe?.message||Qe||"Error al cargar Empaque Terciario.")}. ${Je}`:String(Qe?.message||Qe||"Error al cargar Empaque Terciario."),type:"error"}))}try{const Qe=await It.getMedicationCategories?.()??[];P||lt(Qe??[])}catch(Qe){const Je=Ga(Qe);P||(lt([]),V({loading:!1,message:Je?`${String(Qe?.message||Qe||"Error al cargar Categoras.")}. ${Je}`:String(Qe?.message||Qe||"Error al cargar Categoras."),type:"error"}))}const Le=De!=null?String(De):null,Ge=Fe?.[0]?.id??null,Ve=Le&&Fe.some(Qe=>Qe.id===Le)?Le:Ge;ge(Ve),await It.setSelectedMonthlyBatchId?.(Ve),X({loading:!1,message:"",type:""})}catch(re){if(P)return;X({loading:!1,message:re?.message?String(re.message):"No se pudieron cargar los datos.",type:"error"})}}return W(),()=>{P=!0}},[]);const da=P=>{const W=P==null?null:String(P);ge(W),It.setSelectedMonthlyBatchId?.(W)},_t=P=>{const W=String(P??"").trim();if(!W)return"";const re=W.replace(/\D/g,"");return re.length===9?`${re.slice(0,3)}-${re.slice(3,5)}-${re.slice(5,9)}`:W.replace(/\s+/g," ")},Aa=P=>{const W=String(P??"").trim();if(!W)return 0;const re=W.replace(/\s/g,""),ke=re.includes(","),De=re.includes(".");let Fe=re;ke&&De?Fe=re.replace(/,/g,""):ke&&!De&&(Fe=re.replace(/,/g,"."));const Le=Number.parseFloat(Fe);return Number.isFinite(Le)?Le:0},Yr=Xe.useMemo(()=>i.filter(P=>P.stock<=P.min_stock),[i]),Tn=Xe.useMemo(()=>({totalItems:i.length,lowStockCount:Yr.length,totalStockValue:i.reduce((P,W)=>P+W.stock,0),recentConsumptions:_e[0]?.items?.length||0}),[i,Yr,_e]),Mt=Xe.useMemo(()=>{const P=String(h||"772"),W=o.trim().toLowerCase(),re=({siges_code:Le,name:Ge})=>{const $e=String(Le||"").trim();if($e)return`code:${$e.toLowerCase()}`;const Ve=String(Ge||"").trim().toLowerCase();return Ve?`name:${Ve}`:""},ke=Le=>{Le.sort((Ge,$e)=>{const Ve=String(Ge.batch).localeCompare(String($e.batch));return Ve!==0?Ve:String(Ge.expiry_date).localeCompare(String($e.expiry_date))})},De=Le=>{const Ge=[],$e=new Map;for(const Ve of Le){const Qe=String(Ve.siges_code||"").trim(),Je=String(Ve.name||"").trim(),He=`${Qe}||${Je}`.toLowerCase(),Pe=$e.get(He),Ue={id:Ve.id,batch:String(Ve.batch||"").trim()||"S/N",expiry_date:Ve.expiry_date?String(Ve.expiry_date).trim():"",stock:Number(Ve.stock)||0};if(Pe)Pe.lots.push(Ue),Pe.stock+=Ue.stock;else{const We={id:`group:${He}`,inventory_type:"771",siges_code:Qe,name:Je,lots:[Ue],stock:Ue.stock};$e.set(He,We),Ge.push(We)}}for(const Ve of Ge)ke(Ve.lots);return Ge};if(P==="771"){const Le=i.filter($e=>String($e.inventory_type||"772")==="771"),Ge=De(Le);return W?Ge.filter($e=>{const Ve=$e.lots.map(Je=>`${Je.batch} ${Je.expiry_date} ${Je.stock}`).join(" ");return`${$e.siges_code} ${$e.name} ${Ve}`.toLowerCase().includes(W)}):Ge}if(P==="total"){const Le=(()=>{const Pe=(_e??[]).slice().sort((We,vt)=>{const Ke=new Date(We?.created_at||We?.updated_at||0).getTime();return new Date(vt?.created_at||vt?.updated_at||0).getTime()-Ke}).slice(0,4),Ue=new Map;for(const We of Pe)for(const vt of We?.items??[]){const Ke=_t(vt?.siges_code);if(!Ke)continue;const lr=Number(vt?.quantity)||0;Ue.set(Ke,(Ue.get(Ke)||0)+lr)}return Ue})(),Ge=new Map,$e=({siges_code:He,name:Pe})=>{const Ue=re({siges_code:He,name:Pe});if(!Ue)return null;const We=Ge.get(Ue);if(We)return We;const vt={id:`total:${Ue}`,inventory_type:"total",siges_code:String(He||"").trim(),name:String(Pe||"").trim(),lots:[],stock772:0,stock771:0,stock:0};return Ge.set(Ue,vt),vt};for(const He of i){const Pe=String(He.inventory_type||"772");if(Pe!=="771"&&Pe!=="772")continue;const Ue=$e({siges_code:He.siges_code,name:He.name});if(Ue)if(Ue.siges_code||(Ue.siges_code=String(He.siges_code||"").trim()),Ue.name||(Ue.name=String(He.name||"").trim()),Pe==="772")Ue.stock772+=Number(He.stock)||0;else{const We={id:He.id,batch:String(He.batch||"").trim()||"S/N",expiry_date:He.expiry_date?String(He.expiry_date).trim():"",stock:Number(He.stock)||0};Ue.lots.push(We),Ue.stock771+=We.stock}}const Ve=Array.from(Ge.values()).map(He=>(ke(He.lots),He.stock=He.stock772+He.stock771,He)),Qe=(_e??[]).some(He=>(He?.items??[]).length>0),Je=g&&Qe?Ve.filter(He=>{const Pe=String(He.siges_code||"").trim();return Pe?(Le.get(Pe)||0)>0:!1}):Ve;return W?Je.filter(He=>{const Pe=He.lots.map(We=>`${We.batch} ${We.expiry_date} ${We.stock}`).join(" ");return`${He.siges_code} ${He.name} ${He.stock772} ${He.stock771} ${He.stock} ${Pe}`.toLowerCase().includes(W)}):Je}const Fe=i.filter(Le=>String(Le.inventory_type||"772")===P);return W?Fe.filter(Le=>`${Le.siges_code} ${Le.name} ${Le.category} ${Le.batch} ${Le.expiry_date} ${Le.unit}`.toLowerCase().includes(W)):Fe},[g,o,i,h,_e]),Jr=w?.[String(h||"772")]??1,ht=Xe.useMemo(()=>{const P=v||50,W=Math.max(1,Math.ceil(Mt.length/P)),ke=(Math.min(Math.max(Jr,1),W)-1)*P;return Mt.slice(ke,ke+P)},[Mt,Jr,v]),Kt=Xe.useMemo(()=>{const P=String(h||"772");return P==="total"?Mt.length:P!=="771"?i.filter(W=>String(W.inventory_type||"772")===P).length:Mt.length},[Mt,h,i]),Qr=Xe.useMemo(()=>(_e??[]).some(P=>(P?.items??[]).length>0),[_e]),qt=async()=>{try{I({loading:!0,message:"Sincronizando...",type:"info"});const P=await It.getTertiaryPackaging?.()??[];z(P),I({loading:!1,message:`Sincronizado: ${P.length} registros.`,type:"success"}),window.setTimeout(()=>I({loading:!1,message:"",type:""}),4e3)}catch(P){const W=Fr(P);I({loading:!1,message:W?`${String(P?.message||"No se pudo sincronizar.")}. ${W}`:P?.message?String(P.message):"No se pudo sincronizar.",type:"error"})}},ar=async()=>{try{V({loading:!0,message:"Sincronizando...",type:"info"});const P=await It.getMedicationCategories?.()??[];lt(P),V({loading:!1,message:`Sincronizado: ${P.length} registros.`,type:"success"}),window.setTimeout(()=>V({loading:!1,message:"",type:""}),4e3)}catch(P){const W=Ga(P);V({loading:!1,message:W?`${String(P?.message||"No se pudo sincronizar.")}. ${W}`:P?.message?String(P.message):"No se pudo sincronizar.",type:"error"})}},Ca=()=>{const P=[["CODIGO","MEDICAMENTO","EMPAQUE TERCIARIO"],["110-16-0010","PARACETAMOL 500 MG., TABLETAS",200]],W=zi.aoa_to_sheet(P),re=zi.book_new();zi.book_append_sheet(re,W,"Empaque"),Cy(re,"empaque_terciario.xlsx")},jr=async()=>{if(window.confirm("Desea eliminar toda la carga de Empaque Terciario? Esta accin no se puede deshacer."))try{I({loading:!0,message:"Eliminando...",type:"info"}),await It.clearTertiaryPackaging?.(),z([]),I({loading:!1,message:"Carga eliminada.",type:"success"}),window.setTimeout(()=>I({loading:!1,message:"",type:""}),4e3)}catch(W){const re=Fr(W);I({loading:!1,message:re?`${String(W?.message||"No se pudo eliminar la carga.")}. ${re}`:W?.message?String(W.message):"No se pudo eliminar la carga.",type:"error"})}},tc=P=>{const W=P.target.files?.[0];if(!W)return;I({loading:!0,message:`Procesando: ${W.name}`,type:"info"});const re=new FileReader;re.onerror=()=>{I({loading:!1,message:"No se pudo leer el archivo.",type:"error"})},re.onload=async ke=>{try{const De=ke.target?.result,Fe=Fu(De,{type:"array"}),Le=Fe.SheetNames?.[0];if(!Le)throw new Error("El XLSX no tiene hojas.");const Ge=Fe.Sheets[Le],$e=zi.sheet_to_json(Ge,{header:1,raw:!1,blankrows:!1}),Ve=Array.isArray($e)?$e:[],Je=(We=>{const vt=xa=>String(xa??"").trim().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]/g,""),Ke=vt(We?.[0]),lr=vt(We?.[1]),Yt=vt(We?.[2]);return Ke.includes("siges")||Ke.includes("codigo")||lr.includes("medicamento")||Yt.includes("cantidad")})(Ve?.[0])?Ve.slice(1):Ve,He=new Map((i??[]).map(We=>[_t(We.siges_code),String(We.name||"").trim()]).filter(([We])=>!!We)),Pe=Je.map((We,vt)=>{const Ke=_t(We?.[0]),Yt=String(We?.[1]??"").trim()||He.get(Ke)||"",xa=Aa(We?.[2]);return Ke?{id:globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():String(Date.now())+vt,siges_code:Ke,medication_name:Yt,tertiary_quantity:xa}:null}).filter(Boolean),Ue=await It.upsertTertiaryPackaging?.(Pe)??Pe;z(Ue),I({loading:!1,message:`Empaque Terciario: ${Pe.length} registros importados/actualizados.`,type:"success"}),window.setTimeout(()=>I({loading:!1,message:"",type:""}),4e3)}catch(De){const Fe=Fr(De);I({loading:!1,message:Fe?`${String(De?.message||"Error al procesar/guardar el XLSX.")}. ${Fe}`:De?.message?String(De.message):"Error al procesar/guardar el XLSX.",type:"error"})}},re.readAsArrayBuffer(W),P.target.value=null},Hs=P=>{const W=String(P??"").trim();if(!W)return"";const re=W.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s+/g," ").trim();return re==="ordinario"?"Ordinario":re==="frio"?"Fro":re==="estupefaciente"?"Estupefaciente":re==="psicotropico"?"Psicotrpico":re==="alcohol"?"Alcohol":re==="suero"?"Suero":re==="compra local"||re==="compralocal"?"Compra Local":""},Vs=()=>{const P=[["CODIGO","MEDICAMENTO","CATEGORIA"],["110-16-0010","PARACETAMOL 500 MG., TABLETAS","Ordinario"]],W=zi.aoa_to_sheet(P),re=zi.book_new();zi.book_append_sheet(re,W,"Categorias"),Cy(re,"categorias.xlsx")},In=async()=>{if(window.confirm("Desea eliminar toda la carga de Categoras? Esta accin no se puede deshacer."))try{V({loading:!0,message:"Eliminando...",type:"info"}),await It.clearMedicationCategories?.(),lt([]),V({loading:!1,message:"Carga eliminada.",type:"success"}),window.setTimeout(()=>V({loading:!1,message:"",type:""}),4e3)}catch(W){const re=Ga(W);V({loading:!1,message:re?`${String(W?.message||"No se pudo eliminar la carga.")}. ${re}`:W?.message?String(W.message):"No se pudo eliminar la carga.",type:"error"})}},mi=P=>{const W=P.target.files?.[0];if(!W)return;V({loading:!0,message:`Procesando: ${W.name}`,type:"info"});const re=new FileReader;re.onerror=()=>{V({loading:!1,message:"No se pudo leer el archivo.",type:"error"})},re.onload=async ke=>{try{const De=ke.target?.result,Fe=Fu(De,{type:"array"}),Le=Fe.SheetNames?.[0];if(!Le)throw new Error("El XLSX no tiene hojas.");const Ge=Fe.Sheets[Le],$e=zi.sheet_to_json(Ge,{header:1,raw:!1,blankrows:!1}),Ve=Array.isArray($e)?$e:[],Je=(We=>{const vt=xa=>String(xa??"").trim().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]/g,""),Ke=vt(We?.[0]),lr=vt(We?.[1]),Yt=vt(We?.[2]);return Ke.includes("codigo")||Ke.includes("siges")||lr.includes("medicamento")||Yt.includes("categoria")})(Ve?.[0])?Ve.slice(1):Ve,He=[];let Pe=0;for(let We=0;We<Je.length;We+=1){const vt=Je[We],Ke=_t(vt?.[0]),lr=String(vt?.[1]??"").trim(),Yt=Hs(vt?.[2]);if(Ke){if(!Yt){Pe+=1;continue}He.push({id:globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():String(Date.now())+We,siges_code:Ke,medication_name:lr,category:Yt})}}const Ue=await It.upsertMedicationCategories?.(He)??He;lt(Ue),V({loading:!1,message:`Categoras: ${He.length} registros importados/actualizados.${Pe?` (${Pe} filas con categora invlida omitidas)`:""}`,type:"success"}),window.setTimeout(()=>V({loading:!1,message:"",type:""}),4e3)}catch(De){const Fe=Ga(De);V({loading:!1,message:Fe?`${String(De?.message||"Error al procesar/guardar el XLSX.")}. ${Fe}`:De?.message?String(De.message):"Error al procesar/guardar el XLSX.",type:"error"})}},re.readAsArrayBuffer(W),P.target.value=null},qa=Xe.useMemo(()=>{const P=Tt.trim().toLowerCase(),W=(Nt??[]).map(re=>({...re,siges_code:_t(re?.siges_code),medication_name:String(re?.medication_name||"").trim(),category:String(re?.category||"").trim()}));return P?W.filter(re=>`${re.siges_code} ${re.medication_name} ${re.category}`.toLowerCase().includes(P)):W},[Tt,Nt]),ma=Xe.useMemo(()=>{const P=gr||50,W=Math.max(1,Math.ceil(qa.length/P)),ke=(Math.min(Math.max(je,1),W)-1)*P;return qa.slice(ke,ke+P)},[je,gr,qa]),Xa=Xe.useMemo(()=>{const P=U.trim().toLowerCase(),W=(A??[]).map(re=>{const ke=_t(re?.siges_code),De=(i??[]).find(Fe=>_t(Fe.siges_code)===ke)?.name;return{...re,siges_code:ke,medication_name:String(re?.medication_name||De||"").trim(),tertiary_quantity:Number(re?.tertiary_quantity)||0}});return P?W.filter(re=>`${re.siges_code} ${re.medication_name}`.toLowerCase().includes(P)):W},[i,A,U]),Un=Xe.useMemo(()=>{const P=Te||50,W=Math.max(1,Math.ceil(Xa.length/P)),ke=(Math.min(Math.max(ne,1),W)-1)*P;return Xa.slice(ke,ke+P)},[Xa,ne,Te]),rc=()=>{T(null),k(!0)},gi=P=>{T(P),k(!0)},Na=async()=>{const P=await It.getMedications();l(P??[])},jn=async P=>{P.preventDefault();const W=new FormData(P.target),re={id:R?R.id:globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():Date.now(),inventory_type:R?.inventory_type??String(h||"772"),siges_code:R?.siges_code??"",sicop_classifier:R?.sicop_classifier??"",sicop_identifier:R?.sicop_identifier??"",name:String(W.get("name")||"").trim(),category:String(W.get("category")||"").trim(),batch:String(W.get("batch")||"").trim(),expiry_date:String(W.get("expiry_date")||"").trim(),stock:Number.parseFloat(String(W.get("stock")||"0"))||0,min_stock:Number.parseFloat(String(W.get("min_stock")||"0"))||0,unit:String(W.get("unit")||"").trim()};try{X({loading:!0,message:"Guardando...",type:"info"}),await It.upsertMedication(re),await Na(),T(null),k(!1),X({loading:!1,message:"",type:""})}catch(ke){X({loading:!1,message:ke?.message?String(ke.message):"No se pudo guardar el medicamento.",type:"error"})}},ac=async P=>{try{X({loading:!0,message:"Eliminando...",type:"info"}),await It.deleteMedication(P),await Na(),X({loading:!1,message:"",type:""})}catch(W){X({loading:!1,message:W?.message?String(W.message):"No se pudo eliminar el medicamento.",type:"error"})}},$s=async()=>{try{X({loading:!0,message:"Eliminando catlogo...",type:"info"}),await It.clearMedications(),await Na(),X({loading:!1,message:"",type:""})}catch(P){X({loading:!1,message:P?.message?String(P.message):"No se pudo limpiar el catlogo.",type:"error"})}},kn=({siges_code:P,name:W})=>{const re=String(P||"").trim();if(re)return`code:${re}`;const ke=String(W||"").trim().toLowerCase();return ke?`name:${ke}`:""},Wa=P=>{const W=String(P??"").trim();if(!W)return 0;const re=W.replace(/\s/g,""),ke=re.includes(","),De=re.includes(".");let Fe=re;ke&&De?Fe=re.replace(/,/g,""):ke&&!De&&(Fe=re.replace(/,/g,"."));const Le=Number.parseFloat(Fe);return Number.isFinite(Le)?Le:0},xi=P=>{const W=String(P??"").trim();if(!W)return null;const re=W.slice(0,10);if(/^\d{4}-\d{2}-\d{2}$/.test(re))return re;const ke=W.replace(/\D/g,"");if(ke.length===8){const Le=ke.slice(0,4),Ge=ke.slice(4,6),$e=ke.slice(6,8);return`${Le}-${Ge}-${$e}`}const De=W.match(/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/);if(De){const Le=De[1].padStart(2,"0"),Ge=De[2].padStart(2,"0");return`${De[3]}-${Ge}-${Le}`}const Fe=new Date(W);return Number.isNaN(Fe.getTime())?null:Fe.toISOString().slice(0,10)},ga=(P,W,re=[])=>{if(!P)return"";for(const ke of W){const De=P.getElementsByTagName(ke)?.[0],Fe=De?.textContent!=null?String(De.textContent).trim():"";if(Fe)return Fe}for(const ke of re){const De=P.getAttribute?.(ke);if(De!=null&&String(De).trim())return String(De).trim()}return""},C=P=>{const re=Array.from(P.getElementsByTagNameNS("*","FormattedAreaPair")).filter(Le=>Le.getAttribute("Level")==="4"&&Le.getAttribute("Type")==="Group");if(!re.length)return null;const ke=(Le,Ge)=>{const $e=Array.from(Le.getElementsByTagNameNS("*","FormattedReportObject"));for(const Ve of $e){const Qe=Ve.getAttribute?.("FieldName");if(!Qe||!Ge(Qe))continue;const Je=Ve.getElementsByTagNameNS("*","Value")?.[0],He=Ve.getElementsByTagNameNS("*","FormattedValue")?.[0],Ue=((Je?.textContent!=null?String(Je.textContent):"")||(He?.textContent!=null?String(He.textContent):"")).trim();if(Ue)return Ue}return""},De=Le=>Ge=>String(Ge).includes(Le),Fe=[];for(const Le of re){const Ge=ke(Le,De(".PRODUCTO}")),$e=ke(Le,De(".DSC_PRODUCTO}")),Ve=_t(Ge),Qe=String($e||"").trim();if(!Ve||!Qe)continue;const Je=Array.from(Le.getElementsByTagNameNS("*","FormattedAreaPair")).filter(He=>He.getAttribute("Level")==="5"&&He.getAttribute("Type")==="Details");for(const He of Je){const Pe=ke(He,De(".IDE_LOTE}"))||"S/N",Ue=ke(He,De(".CAN_LOTE}"))||"0",We=ke(He,De(".FEC_VENCIMIENTO}")),vt=Wa(Ue),Ke=xi(We);Fe.push({siges_code:Ve,name:Qe,batch:String(Pe).trim()||"S/N",expiry_date:Ke,stock:vt})}}return Fe},j=P=>{const re=new DOMParser().parseFromString(String(P||""),"application/xml");if(re.querySelector("parsererror"))throw new Error("XML invlido o mal formado.");const ke=C(re);if(Array.isArray(ke))return ke;const De=["CodigoSIGES","CodigoSiges","codigoSIGES","codigoSiges","Codigo","codigo","SIGES","Siges","siges_code"],Fe=["Medicamento","medicamento","Nombre","nombre","Descripcion","descripcion","Medication"],Le=["Lote","lote","Batch","batch","LoteMedicamento","loteMedicamento"],Ge=["Vencimiento","vencimiento","FechaVencimiento","fechaVencimiento","FechaCaducidad","fechaCaducidad","expiry_date","ExpiryDate"],$e=["Inventario","inventario","Stock","stock","Existencia","existencia","Cantidad","cantidad"],Ve=new Set;for(const Je of De){const He=re.getElementsByTagName(Je);for(const Pe of He){let Ue=Pe.parentElement,We=0;for(;Ue&&Ue!==re.documentElement&&We<6;){const vt=!!ga(Ue,Le,["lote","Lote","batch","Batch"]),Ke=!!ga(Ue,Ge,["vencimiento","Vencimiento","expiry","Expiry"]),lr=!!ga(Ue,$e,["inventario","Inventario","stock","Stock"]);if(vt||Ke||lr)break;Ue=Ue.parentElement,We+=1}Ue&&Ve.add(Ue)}}const Qe=[];for(const Je of Ve){const He=ga(Je,De,["CodigoSIGES","codigoSIGES","siges_code","Codigo","codigo"]),Pe=ga(Je,Fe,["Medicamento","medicamento","Nombre","nombre"]).trim(),Ue=ga(Je,Le,["Lote","lote","Batch","batch"]).trim(),We=ga(Je,Ge,["Vencimiento","vencimiento","ExpiryDate","expiry_date"]).trim(),vt=ga(Je,$e,["Inventario","inventario","Stock","stock"]).trim();!He||!Pe||Qe.push({siges_code:_t(He),name:Pe||"Sin nombre",batch:Ue||"S/N",expiry_date:xi(We),stock:Wa(vt)})}return Qe},D=({siges_code:P,name:W,batch:re,expiry_date:ke})=>{const De=String(P||"").trim(),Fe=String(W||"").trim().toLowerCase(),Le=String(re||"").trim().toLowerCase(),Ge=ke?String(ke).trim():"";return De?`code:${De}|lot:${Le}|exp:${Ge}`:`name:${Fe}|lot:${Le}|exp:${Ge}`},F=async({text:P})=>{const re=j(P),ke=[],De=new Set;for(const Pe of re){const Ue=D(Pe);!Ue||De.has(Ue)||(De.add(Ue),ke.push(Pe))}const Le=(await It.getMedications()??[]).filter(Pe=>String(Pe.inventory_type||"772")==="771"),Ge=new Map(Le.map(Pe=>[D(Pe),Pe.id]).filter(([Pe])=>!!Pe)),$e=Date.now(),Ve=ke.map((Pe,Ue)=>{const We=D(Pe);return{id:Ge.get(We)??(globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():$e+Ue),inventory_type:"771",siges_code:Pe.siges_code,sicop_classifier:"",sicop_identifier:"",name:Pe.name,category:"General",batch:Pe.batch||"S/N",expiry_date:Pe.expiry_date,stock:Pe.stock,min_stock:0,unit:"Unidad"}});await It.upsertMedications(Ve);const Qe=await It.getMedications()??[],Je=Qe.filter(Pe=>String(Pe.inventory_type||"772")==="771").length,He=Qe.reduce((Pe,Ue)=>{const We=String(Ue.inventory_type||"772");return Pe[We]=(Pe[We]||0)+1,Pe},{});return await Na(),{importedCount:Ve.length,visibleCountForType:Je,totalCountByType:He}},L=P=>{const W=Fe=>String(Fe??"").trim().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]/g,""),re=W(P?.[0]),ke=W(P?.[1]),De=W(P?.[2]);return re.includes("siges")||re.includes("codigosiges")||ke.includes("medicamento")||ke.includes("nombre")||De.includes("inventario")||De.includes("stock")},H=async({text:P,type:W})=>{const re=String(W||"772").trim()||"772",ke=Xp(P),De=L(ke?.[0])?ke.slice(1):ke,Fe=De.some(Ke=>{const lr=String(Ke?.[0]??"").trim(),Yt=String(Ke?.[1]??"").trim();return!!(lr&&Yt)}),Le=Fe?null:Wp(P),$e=(await It.getMedications()??[]).filter(Ke=>String(Ke.inventory_type||"772")===re),Ve=new Map($e.map(Ke=>[kn(Ke),Ke.id]).filter(([Ke])=>!!Ke)),Qe=Date.now(),Je=(De??[]).map((Ke,lr)=>{if(!Fe)return null;const Yt=String(Ke?.[0]??"").trim(),xa=String(Ke?.[1]??"").trim();if(!Yt||!xa)return null;const Mr=kn({siges_code:Yt,name:xa});return Mr?{id:Ve.get(Mr)??(globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():Qe+lr),inventory_type:re,siges_code:Yt,sicop_classifier:"",sicop_identifier:"",name:xa,category:"General",batch:"S/N",expiry_date:ld(""),stock:Wa(Ke?.[2]),min_stock:0,unit:"Unidad"}:null}).filter(Boolean),He=(Le??[]).map((Ke,lr)=>{if(Fe)return null;const Yt=String(Ke.CodigoSIGES||"").trim(),xa=String(Ke.Medicamento||Ke.Nombre||"").trim(),Mr=kn({siges_code:Yt,name:xa});return Mr?{id:Ve.get(Mr)??(globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():Qe+lr),inventory_type:re,siges_code:Yt,sicop_classifier:String(Ke.ClasificadorSICOP||"").trim(),sicop_identifier:String(Ke.IdentificadorSICOP||"").trim(),name:xa||"Sin nombre",category:String(Ke.Categoria||"General").trim()||"General",batch:String(Ke.Lote||"S/N").trim()||"S/N",expiry_date:ld(Ke.Vencimiento),stock:Wa(Ke.Stock),min_stock:Wa(Ke.StockMinimo||0),unit:String(Ke.Unidad||"Unidad").trim()||"Unidad"}:null}).filter(Boolean),Pe=Fe?Je:He;await It.upsertMedications(Pe);const Ue=await It.getMedications()??[],We=Ue.filter(Ke=>String(Ke.inventory_type||"772")===re).length,vt=Ue.reduce((Ke,lr)=>{const Yt=String(lr.inventory_type||"772");return Ke[Yt]=(Ke[Yt]||0)+1,Ke},{});return await Na(),{importedCount:Pe.length,visibleCountForType:We,totalCountByType:vt}},ce=P=>{const W=P.target.files?.[0];if(!W)return;Z({loading:!0,message:"Procesando archivo...",type:"info"});const re=new FileReader;re.onerror=()=>{Z({loading:!1,message:"No se pudo leer el archivo.",type:"error"})},re.onload=async ke=>{try{const De=String(ke.target?.result||""),Fe=Wp(De),Le=Date.now(),Ge=Fe.map(($e,Ve)=>({id:globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():Le+Ve,inventory_type:"772",siges_code:String($e.CodigoSIGES||"").trim(),sicop_classifier:String($e.ClasificadorSICOP||"").trim(),sicop_identifier:String($e.IdentificadorSICOP||"").trim(),name:$e.Medicamento||$e.Nombre||"Sin nombre",category:$e.Categoria||"General",batch:$e.Lote||"S/N",expiry_date:ld($e.Vencimiento),stock:Wa($e.Stock),min_stock:Wa($e.StockMinimo||10),unit:$e.Unidad||"Unidad"}));await It.upsertMedications(Ge),await Na(),Z({loading:!1,message:`Se han importado ${Ge.length} medicamentos con xito.`,type:"success"}),window.setTimeout(()=>Z({loading:!1,message:"",type:""}),4e3)}catch(De){const Fe=De?.message?String(De.message):"",Ge=Fe.includes("invalid input syntax for type integer")?"Tu base de datos en Supabase tiene `stock`/`min_stock` como INTEGER. Ejecuta `supabase/schema.sql` (ALTER COLUMN a NUMERIC) o usa valores enteros.":"";Z({loading:!1,message:Ge?`${Fe}. ${Ge}`:Fe||"Error al procesar/guardar el CSV.",type:"error"})}},re.readAsText(W),P.target.value=null},ve=P=>{const W=String(P||h||"772");if(W!=="total")return W==="771"?ME(W):FE(W)},oe=P=>{const W=P.target.files?.[0];if(!W)return;const re=String(h||"772");if(re==="total"){Y({loading:!1,message:"Inventario total no admite carga de archivos.",type:"error"}),P.target.value=null;return}const ke=String(W.name||"").toLowerCase(),De=ke.endsWith(".xml"),Fe=ke.endsWith(".csv");if(re==="771"&&!De){Y({loading:!1,message:"Para inventario 771, selecciona un archivo .xml.",type:"error"}),P.target.value=null;return}if(re!=="771"&&!Fe){Y({loading:!1,message:"Para inventario 772, selecciona un archivo .csv.",type:"error"}),P.target.value=null;return}Y({loading:!0,message:`Procesando inventario ${re}: ${W.name}`,type:"info"});const Le=new FileReader;Le.onerror=()=>{Y({loading:!1,message:"No se pudo leer el archivo.",type:"error"})},Le.onload=async Ge=>{try{const $e=String(Ge.target?.result||""),Ve=re==="771"?await F({text:$e}):await H({text:$e,type:re}),Qe=Ve?.importedCount??0,Je=Ve?.visibleCountForType??0,He=Qe>0&&Je===0&&au==="supabase"&&$i?"Import datos pero no se pueden listar. Revisa RLS/policies en Supabase para `medications` (SELECT/ALL para `anon`).":"";Y({loading:!1,message:`Inventario ${re}: ${Qe} medicamentos importados/actualizados.${He?` ${He}`:""}`,type:"success"}),window.setTimeout(()=>Y({loading:!1,message:"",type:""}),4e3)}catch($e){const Ve=$e?.message?String($e.message):"",Je=Ve.includes("invalid input syntax for type integer")?"Tu base de datos en Supabase tiene `stock`/`min_stock` como INTEGER. Ejecuta `supabase/schema.sql` (ALTER COLUMN a NUMERIC) y vuelve a intentar.":"";Y({loading:!1,message:Je?`${Ve}. ${Je}`:Ve||`Error al procesar/guardar el ${re==="771"?"XML":"CSV"}.`,type:"error"})}},Le.readAsText(W),P.target.value=null},ue=async P=>{const W=String(P||h||"772");if(!(W==="total"||!window.confirm(`Desea eliminar toda la carga del inventario ${W}? Esta accin no se puede deshacer.`)))try{Y({loading:!0,message:`Eliminando inventario ${W}...`,type:"info"}),await It.clearMedicationsByInventoryType?.(W),await Na(),Y({loading:!1,message:`Inventario ${W} eliminado.`,type:"success"}),window.setTimeout(()=>Y({loading:!1,message:"",type:""}),4e3)}catch(ke){Y({loading:!1,message:ke?.message?String(ke.message):"No se pudo eliminar el inventario.",type:"error"})}},fe=P=>String(P||"").replace(/\.[^/.]+$/,"").trim()||"Mes sin nombre",Re=P=>{const W=P.target.files?.[0];if(!W)return;const re=fe(W.name);Ce({loading:!0,message:`Procesando: ${W.name}`,type:"info"});const ke=new FileReader;ke.onerror=()=>{Ce({loading:!1,message:"No se pudo leer el archivo.",type:"error"})},ke.onload=async De=>{try{const Fe=String(De.target?.result||""),Le=Xp(Fe),Ge=Pe=>(Pe||[]).some(Ue=>/codigo|siges|medicamento|consumo|costo/i.test(String(Ue||""))),$e=Pe=>{const Ue=String(Pe??"").trim();if(!Ue)return 0;const We=Ue.includes(",")&&Ue.includes(".")?Ue.replace(/,/g,""):Ue.includes(",")&&!Ue.includes(".")?Ue.replace(/,/g,"."):Ue,vt=Number.parseFloat(We.replace(/\s+/g,""));return Number.isFinite(vt)?vt:0},Qe=(Ge(Le[0])?Le.slice(1):Le).map(Pe=>{const Ue=String(Pe?.[0]??"").trim(),We=String(Pe?.[1]??"").trim(),vt=$e(Pe?.[2]),Ke=$e(Pe?.[3]);return!Ue||!We?null:{id:globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():String(Date.now())+Math.random(),siges_code:Ue,medication_name:We,quantity:vt,cost:Ke}}).filter(Boolean),Je=await It.saveMonthlyBatch({id:globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():String(Date.now()),label:re,items:Qe}),He=await It.getMonthlyBatches();te(He??[]),da(Je?.id??null),Ce({loading:!1,message:`Mes "${re}": ${Qe.length} registros importados.`,type:"success"}),window.setTimeout(()=>Ce({loading:!1,message:"",type:""}),4e3)}catch(Fe){Ce({loading:!1,message:Fe?.message?String(Fe.message):"Error al procesar/guardar el CSV.",type:"error"})}},ke.readAsText(W),P.target.value=null},Me=async()=>{try{Ce({loading:!0,message:"Sincronizando consumos...",type:"info"});const W=(await It.getMonthlyBatches()??[]).map(Ge=>({...Ge,id:Ge?.id!=null?String(Ge.id):Ge.id}));te(W);const re=se!=null?String(se):null,De=re&&W.some(Ge=>Ge.id===re)?re:W?.[0]?.id??null;da(De);const Fe=au==="supabase"&&$i?`supabase${ru?` (${ru})`:""}`:`local${$i?" (Supabase disponible pero no seleccionado)":" (Supabase no configurado)"}`,Le=W.length===0&&au==="supabase"&&$i?"Si en Supabase ves meses cargados, revisa RLS/policies para `anon` (SELECT en `monthly_batches`).":W.length===0?"Si tus consumos estn en Supabase, configura `VITE_SUPABASE_URL` y `VITE_SUPABASE_ANON_KEY` y usa `VITE_DATA_PROVIDER=supabase`.":"";Ce({loading:!1,message:`Sincronizado (${Fe}): ${W.length} meses encontrados.${Le?` ${Le}`:""}`,type:"success"}),window.setTimeout(()=>Ce({loading:!1,message:"",type:""}),4e3)}catch(P){Ce({loading:!1,message:P?.message?String(P.message):"No se pudieron sincronizar los consumos.",type:"error"})}},ze=async()=>{try{Y({loading:!0,message:"Sincronizando inventarios...",type:"info"});const P=await It.getMedications()??[];l(P);const W=P.reduce((ke,De)=>{const Fe=String(De.inventory_type||"772");return ke[Fe]=(ke[Fe]||0)+1,ke},{771:0,772:0}),re=au==="supabase"&&$i?`supabase${ru?` (${ru})`:""}`:"local";Y({loading:!1,message:`Sincronizado (${re}): 771=${W[771]||0}, 772=${W[772]||0}.`,type:"success"}),window.setTimeout(()=>Y({loading:!1,message:"",type:""}),4e3)}catch(P){Y({loading:!1,message:P?.message?String(P.message):"No se pudieron sincronizar los inventarios.",type:"error"})}};return b.jsxs("div",{className:"flex h-screen bg-slate-50 font-sans text-slate-900 overflow-hidden",children:[b.jsx(uE,{activeTab:e,isSidebarOpen:r,onSelectTab:t,onToggleSidebar:()=>n(P=>!P)}),b.jsxs("main",{className:"flex-1 overflow-y-auto p-8",children:[b.jsx(oE,{activeTab:e,onNewMedication:rc}),B.message&&b.jsxs("div",{className:`mb-6 p-3 rounded-lg text-xs flex items-center justify-between gap-3 ${B.type==="error"?"bg-red-50 text-red-700 border border-red-100":"bg-blue-50 text-blue-700 border border-blue-100"}`,children:[b.jsx("span",{children:B.message}),b.jsx("button",{type:"button",onClick:()=>X({loading:!1,message:"",type:""}),className:"text-[11px] font-bold hover:underline",children:"Cerrar"})]}),e==="catalog"&&b.jsx(hE,{medications:i,excelStatus:N,fileInputRef:M,onChooseFile:()=>M.current?.click(),onDownloadTemplate:RE,onFileChange:ce,onEditMedication:gi,onDeleteMedication:ac,onClearCatalog:$s}),e==="dashboard"&&b.jsx(pE,{stats:Tn,consumptions:_e[0]?.items||[],lowStockItems:Yr,onViewAllConsumptions:()=>t("consumption-monthly"),onEditMedication:gi}),e==="inventory"&&b.jsx(vE,{inventoryType:h,onInventoryTypeChange:P=>{d(P),u(""),y(W=>({...W,[String(P||"772")]:1})),Y({loading:!1,message:"",type:""})},inventoryStatus:he,fileInputRef:q,onChooseFile:()=>q.current?.click(),onFileChange:oe,onDownloadTemplate:ve,onRefresh:ze,canClear:String(h||"772")!=="total"&&Kt>0,onClearInventory:ue,hideNoMovement:g,canToggleHideNoMovement:Qr,onToggleHideNoMovement:()=>{p(P=>!P),y(P=>({...P,total:1}))},search:o,onSearchChange:P=>{u(P),y(W=>({...W,[String(h||"772")]:1}))},items:ht,totalItems:Mt.length,page:Jr,pageSize:v,onPageChange:P=>{const W=Math.max(1,Math.ceil(Mt.length/(v||1))),re=Math.min(Math.max(Number(P)||1,1),W);y(ke=>({...ke,[String(h||"772")]:re}))},onPageSizeChange:P=>{_(P),y(W=>({...W,[String(h||"772")]:1}))}}),e==="consumption-monthly"&&b.jsx(_E,{months:_e,selectedMonthId:se,onSelectMonth:da,monthlyStatus:pe,fileInputRef:Q,onChooseFile:()=>Q.current?.click(),onFileChange:Re,onDownloadTemplate:DE,onRefresh:Me}),e==="consumption-summary"&&b.jsx(xE,{months:_e,onRefresh:Me,status:pe}),e==="order-request"&&b.jsx(SE,{medications:i,months:_e,tertiaryPackaging:A,inventoryStatus:he,monthlyStatus:pe,onRefreshInventories:ze,onRefreshConsumptions:Me}),e==="tertiary-packaging"&&b.jsx(EE,{status:Oe,fileInputRef:J,onChooseFile:()=>J.current?.click(),onFileChange:tc,onDownloadTemplate:Ca,onRefresh:qt,canClear:(A??[]).length>0,onClear:jr,search:U,onSearchChange:P=>{G(P),we(1)},items:Un,totalItems:Xa.length,page:ne,pageSize:Te,onPageChange:P=>{const W=Math.max(1,Math.ceil(Xa.length/(Te||1))),re=Math.min(Math.max(Number(P)||1,1),W);we(re)},onPageSizeChange:P=>{Se(P),we(1)}}),e==="categories"&&b.jsx(kE,{status:ot,fileInputRef:Ne,onChooseFile:()=>Ne.current?.click(),onFileChange:mi,onDownloadTemplate:Vs,onRefresh:ar,canClear:(Nt??[]).length>0,onClear:In,search:Tt,onSearchChange:P=>{ft(P),zt(1)},items:ma,totalItems:qa.length,page:je,pageSize:gr,onPageChange:P=>{const W=Math.max(1,Math.ceil(qa.length/(gr||1))),re=Math.min(Math.max(Number(P)||1,1),W);zt(re)},onPageSizeChange:P=>{Kr(P),zt(1)}}),e==="alerts"&&b.jsx(fE,{lowStockItems:Yr,onEditMedication:gi})]}),S&&b.jsx(cE,{editingMed:R,onClose:()=>k(!1),onSubmit:jn})]})}function v7(){return b.jsx(p7,{})}TS.createRoot(document.getElementById("root")).render(b.jsx(Xe.StrictMode,{children:b.jsx(v7,{})}));
