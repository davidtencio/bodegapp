(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const o of l.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerPolicy&&(l.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?l.credentials="include":i.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(i){if(i.ep)return;i.ep=!0;const l=r(i);fetch(i.href,l)}})();var qh={exports:{}},Lc={};var Cg;function xb(){if(Cg)return Lc;Cg=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function r(n,i,l){var o=null;if(l!==void 0&&(o=""+l),i.key!==void 0&&(o=""+i.key),"key"in i){l={};for(var u in i)u!=="key"&&(l[u]=i[u])}else l=i;return i=l.ref,{$$typeof:e,type:n,key:o,ref:i!==void 0?i:null,props:l}}return Lc.Fragment=t,Lc.jsx=r,Lc.jsxs=r,Lc}var Ng;function pb(){return Ng||(Ng=1,qh.exports=xb()),qh.exports}var E=pb(),Xh={exports:{}},rt={};var Og;function gb(){if(Og)return rt;Og=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),o=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),g=Symbol.for("react.activity"),v=Symbol.iterator;function _(j){return j===null||typeof j!="object"?null:(j=v&&j[v]||j["@@iterator"],typeof j=="function"?j:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,b={};function A(j,N,z){this.props=j,this.context=N,this.refs=b,this.updater=z||w}A.prototype.isReactComponent={},A.prototype.setState=function(j,N){if(typeof j!="object"&&typeof j!="function"&&j!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,j,N,"setState")},A.prototype.forceUpdate=function(j){this.updater.enqueueForceUpdate(this,j,"forceUpdate")};function M(){}M.prototype=A.prototype;function T(j,N,z){this.props=j,this.context=N,this.refs=b,this.updater=z||w}var U=T.prototype=new M;U.constructor=T,y(U,A.prototype),U.isPureReactComponent=!0;var q=Array.isArray;function I(){}var R={H:null,A:null,T:null,S:null},Q=Object.prototype.hasOwnProperty;function G(j,N,z){var P=z.ref;return{$$typeof:e,type:j,key:N,ref:P!==void 0?P:null,props:z}}function ae(j,N){return G(j.type,N,j.props)}function ne(j){return typeof j=="object"&&j!==null&&j.$$typeof===e}function J(j){var N={"=":"=0",":":"=2"};return"$"+j.replace(/[=:]/g,function(z){return N[z]})}var ge=/\/+/g;function ke(j,N){return typeof j=="object"&&j!==null&&j.key!=null?J(""+j.key):N.toString(36)}function be(j){switch(j.status){case"fulfilled":return j.value;case"rejected":throw j.reason;default:switch(typeof j.status=="string"?j.then(I,I):(j.status="pending",j.then(function(N){j.status==="pending"&&(j.status="fulfilled",j.value=N)},function(N){j.status==="pending"&&(j.status="rejected",j.reason=N)})),j.status){case"fulfilled":return j.value;case"rejected":throw j.reason}}throw j}function Y(j,N,z,P,V){var ce=typeof j;(ce==="undefined"||ce==="boolean")&&(j=null);var we=!1;if(j===null)we=!0;else switch(ce){case"bigint":case"string":case"number":we=!0;break;case"object":switch(j.$$typeof){case e:case t:we=!0;break;case x:return we=j._init,Y(we(j._payload),N,z,P,V)}}if(we)return V=V(j),we=P===""?"."+ke(j,0):P,q(V)?(z="",we!=null&&(z=we.replace(ge,"$&/")+"/"),Y(V,N,z,"",function(Oe){return Oe})):V!=null&&(ne(V)&&(V=ae(V,z+(V.key==null||j&&j.key===V.key?"":(""+V.key).replace(ge,"$&/")+"/")+we)),N.push(V)),1;we=0;var Ce=P===""?".":P+":";if(q(j))for(var Ee=0;Ee<j.length;Ee++)P=j[Ee],ce=Ce+ke(P,Ee),we+=Y(P,N,z,ce,V);else if(Ee=_(j),typeof Ee=="function")for(j=Ee.call(j),Ee=0;!(P=j.next()).done;)P=P.value,ce=Ce+ke(P,Ee++),we+=Y(P,N,z,ce,V);else if(ce==="object"){if(typeof j.then=="function")return Y(be(j),N,z,P,V);throw N=String(j),Error("Objects are not valid as a React child (found: "+(N==="[object Object]"?"object with keys {"+Object.keys(j).join(", ")+"}":N)+"). If you meant to render a collection of children, use an array instead.")}return we}function le(j,N,z){if(j==null)return j;var P=[],V=0;return Y(j,P,"","",function(ce){return N.call(z,ce,V++)}),P}function _e(j){if(j._status===-1){var N=j._result;N=N(),N.then(function(z){(j._status===0||j._status===-1)&&(j._status=1,j._result=z)},function(z){(j._status===0||j._status===-1)&&(j._status=2,j._result=z)}),j._status===-1&&(j._status=0,j._result=N)}if(j._status===1)return j._result.default;throw j._result}var Z=typeof reportError=="function"?reportError:function(j){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var N=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof j=="object"&&j!==null&&typeof j.message=="string"?String(j.message):String(j),error:j});if(!window.dispatchEvent(N))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",j);return}console.error(j)},De={map:le,forEach:function(j,N,z){le(j,function(){N.apply(this,arguments)},z)},count:function(j){var N=0;return le(j,function(){N++}),N},toArray:function(j){return le(j,function(N){return N})||[]},only:function(j){if(!ne(j))throw Error("React.Children.only expected to receive a single React element child.");return j}};return rt.Activity=g,rt.Children=De,rt.Component=A,rt.Fragment=r,rt.Profiler=i,rt.PureComponent=T,rt.StrictMode=n,rt.Suspense=h,rt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=R,rt.__COMPILER_RUNTIME={__proto__:null,c:function(j){return R.H.useMemoCache(j)}},rt.cache=function(j){return function(){return j.apply(null,arguments)}},rt.cacheSignal=function(){return null},rt.cloneElement=function(j,N,z){if(j==null)throw Error("The argument must be a React element, but you passed "+j+".");var P=y({},j.props),V=j.key;if(N!=null)for(ce in N.key!==void 0&&(V=""+N.key),N)!Q.call(N,ce)||ce==="key"||ce==="__self"||ce==="__source"||ce==="ref"&&N.ref===void 0||(P[ce]=N[ce]);var ce=arguments.length-2;if(ce===1)P.children=z;else if(1<ce){for(var we=Array(ce),Ce=0;Ce<ce;Ce++)we[Ce]=arguments[Ce+2];P.children=we}return G(j.type,V,P)},rt.createContext=function(j){return j={$$typeof:o,_currentValue:j,_currentValue2:j,_threadCount:0,Provider:null,Consumer:null},j.Provider=j,j.Consumer={$$typeof:l,_context:j},j},rt.createElement=function(j,N,z){var P,V={},ce=null;if(N!=null)for(P in N.key!==void 0&&(ce=""+N.key),N)Q.call(N,P)&&P!=="key"&&P!=="__self"&&P!=="__source"&&(V[P]=N[P]);var we=arguments.length-2;if(we===1)V.children=z;else if(1<we){for(var Ce=Array(we),Ee=0;Ee<we;Ee++)Ce[Ee]=arguments[Ee+2];V.children=Ce}if(j&&j.defaultProps)for(P in we=j.defaultProps,we)V[P]===void 0&&(V[P]=we[P]);return G(j,ce,V)},rt.createRef=function(){return{current:null}},rt.forwardRef=function(j){return{$$typeof:u,render:j}},rt.isValidElement=ne,rt.lazy=function(j){return{$$typeof:x,_payload:{_status:-1,_result:j},_init:_e}},rt.memo=function(j,N){return{$$typeof:d,type:j,compare:N===void 0?null:N}},rt.startTransition=function(j){var N=R.T,z={};R.T=z;try{var P=j(),V=R.S;V!==null&&V(z,P),typeof P=="object"&&P!==null&&typeof P.then=="function"&&P.then(I,Z)}catch(ce){Z(ce)}finally{N!==null&&z.types!==null&&(N.types=z.types),R.T=N}},rt.unstable_useCacheRefresh=function(){return R.H.useCacheRefresh()},rt.use=function(j){return R.H.use(j)},rt.useActionState=function(j,N,z){return R.H.useActionState(j,N,z)},rt.useCallback=function(j,N){return R.H.useCallback(j,N)},rt.useContext=function(j){return R.H.useContext(j)},rt.useDebugValue=function(){},rt.useDeferredValue=function(j,N){return R.H.useDeferredValue(j,N)},rt.useEffect=function(j,N){return R.H.useEffect(j,N)},rt.useEffectEvent=function(j){return R.H.useEffectEvent(j)},rt.useId=function(){return R.H.useId()},rt.useImperativeHandle=function(j,N,z){return R.H.useImperativeHandle(j,N,z)},rt.useInsertionEffect=function(j,N){return R.H.useInsertionEffect(j,N)},rt.useLayoutEffect=function(j,N){return R.H.useLayoutEffect(j,N)},rt.useMemo=function(j,N){return R.H.useMemo(j,N)},rt.useOptimistic=function(j,N){return R.H.useOptimistic(j,N)},rt.useReducer=function(j,N,z){return R.H.useReducer(j,N,z)},rt.useRef=function(j){return R.H.useRef(j)},rt.useState=function(j){return R.H.useState(j)},rt.useSyncExternalStore=function(j,N,z){return R.H.useSyncExternalStore(j,N,z)},rt.useTransition=function(){return R.H.useTransition()},rt.version="19.2.3",rt}var Rg;function Xd(){return Rg||(Rg=1,Xh.exports=gb()),Xh.exports}var $e=Xd(),Wh={exports:{}},Ic={},Kh={exports:{}},Yh={};var Dg;function vb(){return Dg||(Dg=1,(function(e){function t(Y,le){var _e=Y.length;Y.push(le);e:for(;0<_e;){var Z=_e-1>>>1,De=Y[Z];if(0<i(De,le))Y[Z]=le,Y[_e]=De,_e=Z;else break e}}function r(Y){return Y.length===0?null:Y[0]}function n(Y){if(Y.length===0)return null;var le=Y[0],_e=Y.pop();if(_e!==le){Y[0]=_e;e:for(var Z=0,De=Y.length,j=De>>>1;Z<j;){var N=2*(Z+1)-1,z=Y[N],P=N+1,V=Y[P];if(0>i(z,_e))P<De&&0>i(V,z)?(Y[Z]=V,Y[P]=_e,Z=P):(Y[Z]=z,Y[N]=_e,Z=N);else if(P<De&&0>i(V,_e))Y[Z]=V,Y[P]=_e,Z=P;else break e}}return le}function i(Y,le){var _e=Y.sortIndex-le.sortIndex;return _e!==0?_e:Y.id-le.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var o=Date,u=o.now();e.unstable_now=function(){return o.now()-u}}var h=[],d=[],x=1,g=null,v=3,_=!1,w=!1,y=!1,b=!1,A=typeof setTimeout=="function"?setTimeout:null,M=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;function U(Y){for(var le=r(d);le!==null;){if(le.callback===null)n(d);else if(le.startTime<=Y)n(d),le.sortIndex=le.expirationTime,t(h,le);else break;le=r(d)}}function q(Y){if(y=!1,U(Y),!w)if(r(h)!==null)w=!0,I||(I=!0,J());else{var le=r(d);le!==null&&be(q,le.startTime-Y)}}var I=!1,R=-1,Q=5,G=-1;function ae(){return b?!0:!(e.unstable_now()-G<Q)}function ne(){if(b=!1,I){var Y=e.unstable_now();G=Y;var le=!0;try{e:{w=!1,y&&(y=!1,M(R),R=-1),_=!0;var _e=v;try{t:{for(U(Y),g=r(h);g!==null&&!(g.expirationTime>Y&&ae());){var Z=g.callback;if(typeof Z=="function"){g.callback=null,v=g.priorityLevel;var De=Z(g.expirationTime<=Y);if(Y=e.unstable_now(),typeof De=="function"){g.callback=De,U(Y),le=!0;break t}g===r(h)&&n(h),U(Y)}else n(h);g=r(h)}if(g!==null)le=!0;else{var j=r(d);j!==null&&be(q,j.startTime-Y),le=!1}}break e}finally{g=null,v=_e,_=!1}le=void 0}}finally{le?J():I=!1}}}var J;if(typeof T=="function")J=function(){T(ne)};else if(typeof MessageChannel<"u"){var ge=new MessageChannel,ke=ge.port2;ge.port1.onmessage=ne,J=function(){ke.postMessage(null)}}else J=function(){A(ne,0)};function be(Y,le){R=A(function(){Y(e.unstable_now())},le)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Y){Y.callback=null},e.unstable_forceFrameRate=function(Y){0>Y||125<Y?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Q=0<Y?Math.floor(1e3/Y):5},e.unstable_getCurrentPriorityLevel=function(){return v},e.unstable_next=function(Y){switch(v){case 1:case 2:case 3:var le=3;break;default:le=v}var _e=v;v=le;try{return Y()}finally{v=_e}},e.unstable_requestPaint=function(){b=!0},e.unstable_runWithPriority=function(Y,le){switch(Y){case 1:case 2:case 3:case 4:case 5:break;default:Y=3}var _e=v;v=Y;try{return le()}finally{v=_e}},e.unstable_scheduleCallback=function(Y,le,_e){var Z=e.unstable_now();switch(typeof _e=="object"&&_e!==null?(_e=_e.delay,_e=typeof _e=="number"&&0<_e?Z+_e:Z):_e=Z,Y){case 1:var De=-1;break;case 2:De=250;break;case 5:De=1073741823;break;case 4:De=1e4;break;default:De=5e3}return De=_e+De,Y={id:x++,callback:le,priorityLevel:Y,startTime:_e,expirationTime:De,sortIndex:-1},_e>Z?(Y.sortIndex=_e,t(d,Y),r(h)===null&&Y===r(d)&&(y?(M(R),R=-1):y=!0,be(q,_e-Z))):(Y.sortIndex=De,t(h,Y),w||_||(w=!0,I||(I=!0,J()))),Y},e.unstable_shouldYield=ae,e.unstable_wrapCallback=function(Y){var le=v;return function(){var _e=v;v=le;try{return Y.apply(this,arguments)}finally{v=_e}}}})(Yh)),Yh}var Fg;function yb(){return Fg||(Fg=1,Kh.exports=vb()),Kh.exports}var Jh={exports:{}},Hr={};var Mg;function _b(){if(Mg)return Hr;Mg=1;var e=Xd();function t(h){var d="https://react.dev/errors/"+h;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var x=2;x<arguments.length;x++)d+="&args[]="+encodeURIComponent(arguments[x])}return"Minified React error #"+h+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var n={d:{f:r,r:function(){throw Error(t(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},i=Symbol.for("react.portal");function l(h,d,x){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:g==null?null:""+g,children:h,containerInfo:d,implementation:x}}var o=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(h,d){if(h==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return Hr.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,Hr.createPortal=function(h,d){var x=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(t(299));return l(h,d,null,x)},Hr.flushSync=function(h){var d=o.T,x=n.p;try{if(o.T=null,n.p=2,h)return h()}finally{o.T=d,n.p=x,n.d.f()}},Hr.preconnect=function(h,d){typeof h=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,n.d.C(h,d))},Hr.prefetchDNS=function(h){typeof h=="string"&&n.d.D(h)},Hr.preinit=function(h,d){if(typeof h=="string"&&d&&typeof d.as=="string"){var x=d.as,g=u(x,d.crossOrigin),v=typeof d.integrity=="string"?d.integrity:void 0,_=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;x==="style"?n.d.S(h,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:g,integrity:v,fetchPriority:_}):x==="script"&&n.d.X(h,{crossOrigin:g,integrity:v,fetchPriority:_,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},Hr.preinitModule=function(h,d){if(typeof h=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var x=u(d.as,d.crossOrigin);n.d.M(h,{crossOrigin:x,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&n.d.M(h)},Hr.preload=function(h,d){if(typeof h=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var x=d.as,g=u(x,d.crossOrigin);n.d.L(h,x,{crossOrigin:g,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},Hr.preloadModule=function(h,d){if(typeof h=="string")if(d){var x=u(d.as,d.crossOrigin);n.d.m(h,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:x,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else n.d.m(h)},Hr.requestFormReset=function(h){n.d.r(h)},Hr.unstable_batchedUpdates=function(h,d){return h(d)},Hr.useFormState=function(h,d,x){return o.H.useFormState(h,d,x)},Hr.useFormStatus=function(){return o.H.useHostTransitionStatus()},Hr.version="19.2.3",Hr}var Bg;function wb(){if(Bg)return Jh.exports;Bg=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),Jh.exports=_b(),Jh.exports}var Lg;function Sb(){if(Lg)return Ic;Lg=1;var e=yb(),t=Xd(),r=wb();function n(a){var s="https://react.dev/errors/"+a;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)s+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+a+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function l(a){var s=a,c=a;if(a.alternate)for(;s.return;)s=s.return;else{a=s;do s=a,(s.flags&4098)!==0&&(c=s.return),a=s.return;while(a)}return s.tag===3?c:null}function o(a){if(a.tag===13){var s=a.memoizedState;if(s===null&&(a=a.alternate,a!==null&&(s=a.memoizedState)),s!==null)return s.dehydrated}return null}function u(a){if(a.tag===31){var s=a.memoizedState;if(s===null&&(a=a.alternate,a!==null&&(s=a.memoizedState)),s!==null)return s.dehydrated}return null}function h(a){if(l(a)!==a)throw Error(n(188))}function d(a){var s=a.alternate;if(!s){if(s=l(a),s===null)throw Error(n(188));return s!==a?null:a}for(var c=a,f=s;;){var m=c.return;if(m===null)break;var p=m.alternate;if(p===null){if(f=m.return,f!==null){c=f;continue}break}if(m.child===p.child){for(p=m.child;p;){if(p===c)return h(m),a;if(p===f)return h(m),s;p=p.sibling}throw Error(n(188))}if(c.return!==f.return)c=m,f=p;else{for(var S=!1,D=m.child;D;){if(D===c){S=!0,c=m,f=p;break}if(D===f){S=!0,f=m,c=p;break}D=D.sibling}if(!S){for(D=p.child;D;){if(D===c){S=!0,c=p,f=m;break}if(D===f){S=!0,f=p,c=m;break}D=D.sibling}if(!S)throw Error(n(189))}}if(c.alternate!==f)throw Error(n(190))}if(c.tag!==3)throw Error(n(188));return c.stateNode.current===c?a:s}function x(a){var s=a.tag;if(s===5||s===26||s===27||s===6)return a;for(a=a.child;a!==null;){if(s=x(a),s!==null)return s;a=a.sibling}return null}var g=Object.assign,v=Symbol.for("react.element"),_=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),y=Symbol.for("react.fragment"),b=Symbol.for("react.strict_mode"),A=Symbol.for("react.profiler"),M=Symbol.for("react.consumer"),T=Symbol.for("react.context"),U=Symbol.for("react.forward_ref"),q=Symbol.for("react.suspense"),I=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),Q=Symbol.for("react.lazy"),G=Symbol.for("react.activity"),ae=Symbol.for("react.memo_cache_sentinel"),ne=Symbol.iterator;function J(a){return a===null||typeof a!="object"?null:(a=ne&&a[ne]||a["@@iterator"],typeof a=="function"?a:null)}var ge=Symbol.for("react.client.reference");function ke(a){if(a==null)return null;if(typeof a=="function")return a.$$typeof===ge?null:a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case y:return"Fragment";case A:return"Profiler";case b:return"StrictMode";case q:return"Suspense";case I:return"SuspenseList";case G:return"Activity"}if(typeof a=="object")switch(a.$$typeof){case w:return"Portal";case T:return a.displayName||"Context";case M:return(a._context.displayName||"Context")+".Consumer";case U:var s=a.render;return a=a.displayName,a||(a=s.displayName||s.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case R:return s=a.displayName||null,s!==null?s:ke(a.type)||"Memo";case Q:s=a._payload,a=a._init;try{return ke(a(s))}catch{}}return null}var be=Array.isArray,Y=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,le=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,_e={pending:!1,data:null,method:null,action:null},Z=[],De=-1;function j(a){return{current:a}}function N(a){0>De||(a.current=Z[De],Z[De]=null,De--)}function z(a,s){De++,Z[De]=a.current,a.current=s}var P=j(null),V=j(null),ce=j(null),we=j(null);function Ce(a,s){switch(z(ce,s),z(V,a),z(P,null),s.nodeType){case 9:case 11:a=(a=s.documentElement)&&(a=a.namespaceURI)?Jp(a):0;break;default:if(a=s.tagName,s=s.namespaceURI)s=Jp(s),a=Qp(s,a);else switch(a){case"svg":a=1;break;case"math":a=2;break;default:a=0}}N(P),z(P,a)}function Ee(){N(P),N(V),N(ce)}function Oe(a){a.memoizedState!==null&&z(we,a);var s=P.current,c=Qp(s,a.type);s!==c&&(z(V,a),z(P,c))}function Qe(a){V.current===a&&(N(P),N(V)),we.current===a&&(N(we),Dc._currentValue=_e)}var H,St;function tt(a){if(H===void 0)try{throw Error()}catch(c){var s=c.stack.trim().match(/\n( *(at )?)/);H=s&&s[1]||"",St=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+H+a+St}var xt=!1;function We(a,s){if(!a||xt)return"";xt=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var f={DetermineComponentFrameRoot:function(){try{if(s){var Te=function(){throw Error()};if(Object.defineProperty(Te.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Te,[])}catch(de){var fe=de}Reflect.construct(a,[],Te)}else{try{Te.call()}catch(de){fe=de}a.call(Te.prototype)}}else{try{throw Error()}catch(de){fe=de}(Te=a())&&typeof Te.catch=="function"&&Te.catch(function(){})}}catch(de){if(de&&fe&&typeof de.stack=="string")return[de.stack,fe.stack]}return[null,null]}};f.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(f.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(f.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var p=f.DetermineComponentFrameRoot(),S=p[0],D=p[1];if(S&&D){var X=S.split(`
`),ue=D.split(`
`);for(m=f=0;f<X.length&&!X[f].includes("DetermineComponentFrameRoot");)f++;for(;m<ue.length&&!ue[m].includes("DetermineComponentFrameRoot");)m++;if(f===X.length||m===ue.length)for(f=X.length-1,m=ue.length-1;1<=f&&0<=m&&X[f]!==ue[m];)m--;for(;1<=f&&0<=m;f--,m--)if(X[f]!==ue[m]){if(f!==1||m!==1)do if(f--,m--,0>m||X[f]!==ue[m]){var ye=`
`+X[f].replace(" at new "," at ");return a.displayName&&ye.includes("<anonymous>")&&(ye=ye.replace("<anonymous>",a.displayName)),ye}while(1<=f&&0<=m);break}}}finally{xt=!1,Error.prepareStackTrace=c}return(c=a?a.displayName||a.name:"")?tt(c):""}function Ue(a,s){switch(a.tag){case 26:case 27:case 5:return tt(a.type);case 16:return tt("Lazy");case 13:return a.child!==s&&s!==null?tt("Suspense Fallback"):tt("Suspense");case 19:return tt("SuspenseList");case 0:case 15:return We(a.type,!1);case 11:return We(a.type.render,!1);case 1:return We(a.type,!0);case 31:return tt("Activity");default:return""}}function Ut(a){try{var s="",c=null;do s+=Ue(a,c),c=a,a=a.return;while(a);return s}catch(f){return`
Error generating stack: `+f.message+`
`+f.stack}}var Tr=Object.prototype.hasOwnProperty,Pr=e.unstable_scheduleCallback,Jr=e.unstable_cancelCallback,Tn=e.unstable_shouldYield,Ra=e.unstable_requestPaint,bt=e.unstable_now,Or=e.unstable_getCurrentPriorityLevel,ma=e.unstable_ImmediatePriority,hn=e.unstable_UserBlockingPriority,Xt=e.unstable_NormalPriority,hr=e.unstable_LowPriority,at=e.unstable_IdlePriority,Pt=e.log,zr=e.unstable_setDisableYieldValue,Et=null,Tt=null;function ra(a){if(typeof Pt=="function"&&zr(a),Tt&&typeof Tt.setStrictMode=="function")try{Tt.setStrictMode(Et,a)}catch{}}var Wt=Math.clz32?Math.clz32:ai,ql=Math.log,Ms=Math.LN2;function ai(a){return a>>>=0,a===0?32:31-(ql(a)/Ms|0)|0}var kn=256,ni=262144,ii=4194304;function aa(a){var s=a&42;if(s!==0)return s;switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return a&261888;case 262144:case 524288:case 1048576:case 2097152:return a&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return a&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return a}}function si(a,s,c){var f=a.pendingLanes;if(f===0)return 0;var m=0,p=a.suspendedLanes,S=a.pingedLanes;a=a.warmLanes;var D=f&134217727;return D!==0?(f=D&~p,f!==0?m=aa(f):(S&=D,S!==0?m=aa(S):c||(c=D&~a,c!==0&&(m=aa(c))))):(D=f&~p,D!==0?m=aa(D):S!==0?m=aa(S):c||(c=f&~a,c!==0&&(m=aa(c)))),m===0?0:s!==0&&s!==m&&(s&p)===0&&(p=m&-m,c=s&-s,p>=c||p===32&&(c&4194048)!==0)?s:m}function An(a,s){return(a.pendingLanes&~(a.suspendedLanes&~a.pingedLanes)&s)===0}function Xl(a,s){switch(a){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Bs(){var a=ii;return ii<<=1,(ii&62914560)===0&&(ii=4194304),a}function Gi(a){for(var s=[],c=0;31>c;c++)s.push(a);return s}function Qa(a,s){a.pendingLanes|=s,s!==268435456&&(a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0)}function Ls(a,s,c,f,m,p){var S=a.pendingLanes;a.pendingLanes=c,a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0,a.expiredLanes&=c,a.entangledLanes&=c,a.errorRecoveryDisabledLanes&=c,a.shellSuspendCounter=0;var D=a.entanglements,X=a.expirationTimes,ue=a.hiddenUpdates;for(c=S&~c;0<c;){var ye=31-Wt(c),Te=1<<ye;D[ye]=0,X[ye]=-1;var fe=ue[ye];if(fe!==null)for(ue[ye]=null,ye=0;ye<fe.length;ye++){var de=fe[ye];de!==null&&(de.lane&=-536870913)}c&=~Te}f!==0&&he(a,f,0),p!==0&&m===0&&a.tag!==0&&(a.suspendedLanes|=p&~(S&~s))}function he(a,s,c){a.pendingLanes|=s,a.suspendedLanes&=~s;var f=31-Wt(s);a.entangledLanes|=s,a.entanglements[f]=a.entanglements[f]|1073741824|c&261930}function xe(a,s){var c=a.entangledLanes|=s;for(a=a.entanglements;c;){var f=31-Wt(c),m=1<<f;m&s|a[f]&s&&(a[f]|=s),c&=~m}}function Re(a,s){var c=s&-s;return c=(c&42)!==0?1:Le(c),(c&(a.suspendedLanes|s))!==0?0:c}function Le(a){switch(a){case 2:a=1;break;case 8:a=4;break;case 32:a=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:a=128;break;case 268435456:a=134217728;break;default:a=0}return a}function je(a){return a&=-a,2<a?8<a?(a&134217727)!==0?32:268435456:8:2}function k(){var a=le.p;return a!==0?a:(a=window.event,a===void 0?32:wg(a.type))}function F(a,s){var c=le.p;try{return le.p=a,s()}finally{le.p=c}}var C=Math.random().toString(36).slice(2),O="__reactFiber$"+C,B="__reactProps$"+C,L="__reactContainer$"+C,re="__reactEvents$"+C,ie="__reactListeners$"+C,W="__reactHandles$"+C,K="__reactResources$"+C,te="__reactMarker$"+C;function ve(a){delete a[O],delete a[B],delete a[re],delete a[ie],delete a[W]}function me(a){var s=a[O];if(s)return s;for(var c=a.parentNode;c;){if(s=c[L]||c[O]){if(c=s.alternate,s.child!==null||c!==null&&c.child!==null)for(a=ig(a);a!==null;){if(c=a[O])return c;a=ig(a)}return s}a=c,c=a.parentNode}return null}function Fe(a){if(a=a[O]||a[L]){var s=a.tag;if(s===5||s===6||s===13||s===31||s===26||s===27||s===3)return a}return null}function Ae(a){var s=a.tag;if(s===5||s===26||s===27||s===6)return a.stateNode;throw Error(n(33))}function Me(a){var s=a[K];return s||(s=a[K]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function Pe(a){a[te]=!0}var Rt=new Set,Dt={};function Kt(a,s){Da(a,s),Da(a+"Capture",s)}function Da(a,s){for(Dt[a]=s,a=0;a<s.length;a++)Rt.add(s[a])}var qi=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),li={},dn={};function Wl(a){return Tr.call(dn,a)?!0:Tr.call(li,a)?!1:qi.test(a)?dn[a]=!0:(li[a]=!0,!1)}function na(a,s,c){if(Wl(s))if(c===null)a.removeAttribute(s);else{switch(typeof c){case"undefined":case"function":case"symbol":a.removeAttribute(s);return;case"boolean":var f=s.toLowerCase().slice(0,5);if(f!=="data-"&&f!=="aria-"){a.removeAttribute(s);return}}a.setAttribute(s,""+c)}}function Ro(a,s,c){if(c===null)a.removeAttribute(s);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(s);return}a.setAttribute(s,""+c)}}function Cn(a,s,c,f){if(f===null)a.removeAttribute(c);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(c);return}a.setAttributeNS(s,c,""+f)}}function Fa(a){switch(typeof a){case"bigint":case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function V1(a){var s=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function cw(a,s,c){var f=Object.getOwnPropertyDescriptor(a.constructor.prototype,s);if(!a.hasOwnProperty(s)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var m=f.get,p=f.set;return Object.defineProperty(a,s,{configurable:!0,get:function(){return m.call(this)},set:function(S){c=""+S,p.call(this,S)}}),Object.defineProperty(a,s,{enumerable:f.enumerable}),{getValue:function(){return c},setValue:function(S){c=""+S},stopTracking:function(){a._valueTracker=null,delete a[s]}}}}function Uu(a){if(!a._valueTracker){var s=V1(a)?"checked":"value";a._valueTracker=cw(a,s,""+a[s])}}function $1(a){if(!a)return!1;var s=a._valueTracker;if(!s)return!0;var c=s.getValue(),f="";return a&&(f=V1(a)?a.checked?"true":"false":a.value),a=f,a!==c?(s.setValue(a),!0):!1}function Do(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}var ow=/[\n"\\]/g;function Ma(a){return a.replace(ow,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function ju(a,s,c,f,m,p,S,D){a.name="",S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?a.type=S:a.removeAttribute("type"),s!=null?S==="number"?(s===0&&a.value===""||a.value!=s)&&(a.value=""+Fa(s)):a.value!==""+Fa(s)&&(a.value=""+Fa(s)):S!=="submit"&&S!=="reset"||a.removeAttribute("value"),s!=null?Pu(a,S,Fa(s)):c!=null?Pu(a,S,Fa(c)):f!=null&&a.removeAttribute("value"),m==null&&p!=null&&(a.defaultChecked=!!p),m!=null&&(a.checked=m&&typeof m!="function"&&typeof m!="symbol"),D!=null&&typeof D!="function"&&typeof D!="symbol"&&typeof D!="boolean"?a.name=""+Fa(D):a.removeAttribute("name")}function G1(a,s,c,f,m,p,S,D){if(p!=null&&typeof p!="function"&&typeof p!="symbol"&&typeof p!="boolean"&&(a.type=p),s!=null||c!=null){if(!(p!=="submit"&&p!=="reset"||s!=null)){Uu(a);return}c=c!=null?""+Fa(c):"",s=s!=null?""+Fa(s):c,D||s===a.value||(a.value=s),a.defaultValue=s}f=f??m,f=typeof f!="function"&&typeof f!="symbol"&&!!f,a.checked=D?a.checked:!!f,a.defaultChecked=!!f,S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"&&(a.name=S),Uu(a)}function Pu(a,s,c){s==="number"&&Do(a.ownerDocument)===a||a.defaultValue===""+c||(a.defaultValue=""+c)}function Is(a,s,c,f){if(a=a.options,s){s={};for(var m=0;m<c.length;m++)s["$"+c[m]]=!0;for(c=0;c<a.length;c++)m=s.hasOwnProperty("$"+a[c].value),a[c].selected!==m&&(a[c].selected=m),m&&f&&(a[c].defaultSelected=!0)}else{for(c=""+Fa(c),s=null,m=0;m<a.length;m++){if(a[m].value===c){a[m].selected=!0,f&&(a[m].defaultSelected=!0);return}s!==null||a[m].disabled||(s=a[m])}s!==null&&(s.selected=!0)}}function q1(a,s,c){if(s!=null&&(s=""+Fa(s),s!==a.value&&(a.value=s),c==null)){a.defaultValue!==s&&(a.defaultValue=s);return}a.defaultValue=c!=null?""+Fa(c):""}function X1(a,s,c,f){if(s==null){if(f!=null){if(c!=null)throw Error(n(92));if(be(f)){if(1<f.length)throw Error(n(93));f=f[0]}c=f}c==null&&(c=""),s=c}c=Fa(s),a.defaultValue=c,f=a.textContent,f===c&&f!==""&&f!==null&&(a.value=f),Uu(a)}function Us(a,s){if(s){var c=a.firstChild;if(c&&c===a.lastChild&&c.nodeType===3){c.nodeValue=s;return}}a.textContent=s}var uw=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function W1(a,s,c){var f=s.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?f?a.setProperty(s,""):s==="float"?a.cssFloat="":a[s]="":f?a.setProperty(s,c):typeof c!="number"||c===0||uw.has(s)?s==="float"?a.cssFloat=c:a[s]=(""+c).trim():a[s]=c+"px"}function K1(a,s,c){if(s!=null&&typeof s!="object")throw Error(n(62));if(a=a.style,c!=null){for(var f in c)!c.hasOwnProperty(f)||s!=null&&s.hasOwnProperty(f)||(f.indexOf("--")===0?a.setProperty(f,""):f==="float"?a.cssFloat="":a[f]="");for(var m in s)f=s[m],s.hasOwnProperty(m)&&c[m]!==f&&W1(a,m,f)}else for(var p in s)s.hasOwnProperty(p)&&W1(a,p,s[p])}function zu(a){if(a.indexOf("-")===-1)return!1;switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var fw=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),hw=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Fo(a){return hw.test(""+a)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":a}function Nn(){}var Hu=null;function Vu(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var js=null,Ps=null;function Y1(a){var s=Fe(a);if(s&&(a=s.stateNode)){var c=a[B]||null;e:switch(a=s.stateNode,s.type){case"input":if(ju(a,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),s=c.name,c.type==="radio"&&s!=null){for(c=a;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+Ma(""+s)+'"][type="radio"]'),s=0;s<c.length;s++){var f=c[s];if(f!==a&&f.form===a.form){var m=f[B]||null;if(!m)throw Error(n(90));ju(f,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(s=0;s<c.length;s++)f=c[s],f.form===a.form&&$1(f)}break e;case"textarea":q1(a,c.value,c.defaultValue);break e;case"select":s=c.value,s!=null&&Is(a,!!c.multiple,s,!1)}}}var $u=!1;function J1(a,s,c){if($u)return a(s,c);$u=!0;try{var f=a(s);return f}finally{if($u=!1,(js!==null||Ps!==null)&&(_0(),js&&(s=js,a=Ps,Ps=js=null,Y1(s),a)))for(s=0;s<a.length;s++)Y1(a[s])}}function Kl(a,s){var c=a.stateNode;if(c===null)return null;var f=c[B]||null;if(f===null)return null;c=f[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(a=a.type,f=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!f;break e;default:a=!1}if(a)return null;if(c&&typeof c!="function")throw Error(n(231,s,typeof c));return c}var On=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Gu=!1;if(On)try{var Yl={};Object.defineProperty(Yl,"passive",{get:function(){Gu=!0}}),window.addEventListener("test",Yl,Yl),window.removeEventListener("test",Yl,Yl)}catch{Gu=!1}var ci=null,qu=null,Mo=null;function Q1(){if(Mo)return Mo;var a,s=qu,c=s.length,f,m="value"in ci?ci.value:ci.textContent,p=m.length;for(a=0;a<c&&s[a]===m[a];a++);var S=c-a;for(f=1;f<=S&&s[c-f]===m[p-f];f++);return Mo=m.slice(a,1<f?1-f:void 0)}function Bo(a){var s=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&s===13&&(a=13)):a=s,a===10&&(a=13),32<=a||a===13?a:0}function Lo(){return!0}function Z1(){return!1}function ia(a){function s(c,f,m,p,S){this._reactName=c,this._targetInst=m,this.type=f,this.nativeEvent=p,this.target=S,this.currentTarget=null;for(var D in a)a.hasOwnProperty(D)&&(c=a[D],this[D]=c?c(p):p[D]);return this.isDefaultPrevented=(p.defaultPrevented!=null?p.defaultPrevented:p.returnValue===!1)?Lo:Z1,this.isPropagationStopped=Z1,this}return g(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=Lo)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=Lo)},persist:function(){},isPersistent:Lo}),s}var Xi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Io=ia(Xi),Jl=g({},Xi,{view:0,detail:0}),dw=ia(Jl),Xu,Wu,Ql,Uo=g({},Jl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Yu,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==Ql&&(Ql&&a.type==="mousemove"?(Xu=a.screenX-Ql.screenX,Wu=a.screenY-Ql.screenY):Wu=Xu=0,Ql=a),Xu)},movementY:function(a){return"movementY"in a?a.movementY:Wu}}),em=ia(Uo),mw=g({},Uo,{dataTransfer:0}),xw=ia(mw),pw=g({},Jl,{relatedTarget:0}),Ku=ia(pw),gw=g({},Xi,{animationName:0,elapsedTime:0,pseudoElement:0}),vw=ia(gw),yw=g({},Xi,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),_w=ia(yw),ww=g({},Xi,{data:0}),tm=ia(ww),Sw={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},bw={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ew={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Tw(a){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(a):(a=Ew[a])?!!s[a]:!1}function Yu(){return Tw}var kw=g({},Jl,{key:function(a){if(a.key){var s=Sw[a.key]||a.key;if(s!=="Unidentified")return s}return a.type==="keypress"?(a=Bo(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?bw[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Yu,charCode:function(a){return a.type==="keypress"?Bo(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?Bo(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),Aw=ia(kw),Cw=g({},Uo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),rm=ia(Cw),Nw=g({},Jl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Yu}),Ow=ia(Nw),Rw=g({},Xi,{propertyName:0,elapsedTime:0,pseudoElement:0}),Dw=ia(Rw),Fw=g({},Uo,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),Mw=ia(Fw),Bw=g({},Xi,{newState:0,oldState:0}),Lw=ia(Bw),Iw=[9,13,27,32],Ju=On&&"CompositionEvent"in window,Zl=null;On&&"documentMode"in document&&(Zl=document.documentMode);var Uw=On&&"TextEvent"in window&&!Zl,am=On&&(!Ju||Zl&&8<Zl&&11>=Zl),nm=" ",im=!1;function sm(a,s){switch(a){case"keyup":return Iw.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function lm(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var zs=!1;function jw(a,s){switch(a){case"compositionend":return lm(s);case"keypress":return s.which!==32?null:(im=!0,nm);case"textInput":return a=s.data,a===nm&&im?null:a;default:return null}}function Pw(a,s){if(zs)return a==="compositionend"||!Ju&&sm(a,s)?(a=Q1(),Mo=qu=ci=null,zs=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return am&&s.locale!=="ko"?null:s.data;default:return null}}var zw={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function cm(a){var s=a&&a.nodeName&&a.nodeName.toLowerCase();return s==="input"?!!zw[a.type]:s==="textarea"}function om(a,s,c,f){js?Ps?Ps.push(f):Ps=[f]:js=f,s=A0(s,"onChange"),0<s.length&&(c=new Io("onChange","change",null,c,f),a.push({event:c,listeners:s}))}var ec=null,tc=null;function Hw(a){Gp(a,0)}function jo(a){var s=Ae(a);if($1(s))return a}function um(a,s){if(a==="change")return s}var fm=!1;if(On){var Qu;if(On){var Zu="oninput"in document;if(!Zu){var hm=document.createElement("div");hm.setAttribute("oninput","return;"),Zu=typeof hm.oninput=="function"}Qu=Zu}else Qu=!1;fm=Qu&&(!document.documentMode||9<document.documentMode)}function dm(){ec&&(ec.detachEvent("onpropertychange",mm),tc=ec=null)}function mm(a){if(a.propertyName==="value"&&jo(tc)){var s=[];om(s,tc,a,Vu(a)),J1(Hw,s)}}function Vw(a,s,c){a==="focusin"?(dm(),ec=s,tc=c,ec.attachEvent("onpropertychange",mm)):a==="focusout"&&dm()}function $w(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return jo(tc)}function Gw(a,s){if(a==="click")return jo(s)}function qw(a,s){if(a==="input"||a==="change")return jo(s)}function Xw(a,s){return a===s&&(a!==0||1/a===1/s)||a!==a&&s!==s}var xa=typeof Object.is=="function"?Object.is:Xw;function rc(a,s){if(xa(a,s))return!0;if(typeof a!="object"||a===null||typeof s!="object"||s===null)return!1;var c=Object.keys(a),f=Object.keys(s);if(c.length!==f.length)return!1;for(f=0;f<c.length;f++){var m=c[f];if(!Tr.call(s,m)||!xa(a[m],s[m]))return!1}return!0}function xm(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function pm(a,s){var c=xm(a);a=0;for(var f;c;){if(c.nodeType===3){if(f=a+c.textContent.length,a<=s&&f>=s)return{node:c,offset:s-a};a=f}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=xm(c)}}function gm(a,s){return a&&s?a===s?!0:a&&a.nodeType===3?!1:s&&s.nodeType===3?gm(a,s.parentNode):"contains"in a?a.contains(s):a.compareDocumentPosition?!!(a.compareDocumentPosition(s)&16):!1:!1}function vm(a){a=a!=null&&a.ownerDocument!=null&&a.ownerDocument.defaultView!=null?a.ownerDocument.defaultView:window;for(var s=Do(a.document);s instanceof a.HTMLIFrameElement;){try{var c=typeof s.contentWindow.location.href=="string"}catch{c=!1}if(c)a=s.contentWindow;else break;s=Do(a.document)}return s}function ef(a){var s=a&&a.nodeName&&a.nodeName.toLowerCase();return s&&(s==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||s==="textarea"||a.contentEditable==="true")}var Ww=On&&"documentMode"in document&&11>=document.documentMode,Hs=null,tf=null,ac=null,rf=!1;function ym(a,s,c){var f=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;rf||Hs==null||Hs!==Do(f)||(f=Hs,"selectionStart"in f&&ef(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),ac&&rc(ac,f)||(ac=f,f=A0(tf,"onSelect"),0<f.length&&(s=new Io("onSelect","select",null,s,c),a.push({event:s,listeners:f}),s.target=Hs)))}function Wi(a,s){var c={};return c[a.toLowerCase()]=s.toLowerCase(),c["Webkit"+a]="webkit"+s,c["Moz"+a]="moz"+s,c}var Vs={animationend:Wi("Animation","AnimationEnd"),animationiteration:Wi("Animation","AnimationIteration"),animationstart:Wi("Animation","AnimationStart"),transitionrun:Wi("Transition","TransitionRun"),transitionstart:Wi("Transition","TransitionStart"),transitioncancel:Wi("Transition","TransitionCancel"),transitionend:Wi("Transition","TransitionEnd")},af={},_m={};On&&(_m=document.createElement("div").style,"AnimationEvent"in window||(delete Vs.animationend.animation,delete Vs.animationiteration.animation,delete Vs.animationstart.animation),"TransitionEvent"in window||delete Vs.transitionend.transition);function Ki(a){if(af[a])return af[a];if(!Vs[a])return a;var s=Vs[a],c;for(c in s)if(s.hasOwnProperty(c)&&c in _m)return af[a]=s[c];return a}var wm=Ki("animationend"),Sm=Ki("animationiteration"),bm=Ki("animationstart"),Kw=Ki("transitionrun"),Yw=Ki("transitionstart"),Jw=Ki("transitioncancel"),Em=Ki("transitionend"),Tm=new Map,nf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");nf.push("scrollEnd");function Za(a,s){Tm.set(a,s),Kt(s,[a])}var Po=typeof reportError=="function"?reportError:function(a){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof a=="object"&&a!==null&&typeof a.message=="string"?String(a.message):String(a),error:a});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",a);return}console.error(a)},Ba=[],$s=0,sf=0;function zo(){for(var a=$s,s=sf=$s=0;s<a;){var c=Ba[s];Ba[s++]=null;var f=Ba[s];Ba[s++]=null;var m=Ba[s];Ba[s++]=null;var p=Ba[s];if(Ba[s++]=null,f!==null&&m!==null){var S=f.pending;S===null?m.next=m:(m.next=S.next,S.next=m),f.pending=m}p!==0&&km(c,m,p)}}function Ho(a,s,c,f){Ba[$s++]=a,Ba[$s++]=s,Ba[$s++]=c,Ba[$s++]=f,sf|=f,a.lanes|=f,a=a.alternate,a!==null&&(a.lanes|=f)}function lf(a,s,c,f){return Ho(a,s,c,f),Vo(a)}function Yi(a,s){return Ho(a,null,null,s),Vo(a)}function km(a,s,c){a.lanes|=c;var f=a.alternate;f!==null&&(f.lanes|=c);for(var m=!1,p=a.return;p!==null;)p.childLanes|=c,f=p.alternate,f!==null&&(f.childLanes|=c),p.tag===22&&(a=p.stateNode,a===null||a._visibility&1||(m=!0)),a=p,p=p.return;return a.tag===3?(p=a.stateNode,m&&s!==null&&(m=31-Wt(c),a=p.hiddenUpdates,f=a[m],f===null?a[m]=[s]:f.push(s),s.lane=c|536870912),p):null}function Vo(a){if(50<Tc)throw Tc=0,ph=null,Error(n(185));for(var s=a.return;s!==null;)a=s,s=a.return;return a.tag===3?a.stateNode:null}var Gs={};function Qw(a,s,c,f){this.tag=a,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function pa(a,s,c,f){return new Qw(a,s,c,f)}function cf(a){return a=a.prototype,!(!a||!a.isReactComponent)}function Rn(a,s){var c=a.alternate;return c===null?(c=pa(a.tag,s,a.key,a.mode),c.elementType=a.elementType,c.type=a.type,c.stateNode=a.stateNode,c.alternate=a,a.alternate=c):(c.pendingProps=s,c.type=a.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=a.flags&65011712,c.childLanes=a.childLanes,c.lanes=a.lanes,c.child=a.child,c.memoizedProps=a.memoizedProps,c.memoizedState=a.memoizedState,c.updateQueue=a.updateQueue,s=a.dependencies,c.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},c.sibling=a.sibling,c.index=a.index,c.ref=a.ref,c.refCleanup=a.refCleanup,c}function Am(a,s){a.flags&=65011714;var c=a.alternate;return c===null?(a.childLanes=0,a.lanes=s,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=c.childLanes,a.lanes=c.lanes,a.child=c.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=c.memoizedProps,a.memoizedState=c.memoizedState,a.updateQueue=c.updateQueue,a.type=c.type,s=c.dependencies,a.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),a}function $o(a,s,c,f,m,p){var S=0;if(f=a,typeof a=="function")cf(a)&&(S=1);else if(typeof a=="string")S=ab(a,c,P.current)?26:a==="html"||a==="head"||a==="body"?27:5;else e:switch(a){case G:return a=pa(31,c,s,m),a.elementType=G,a.lanes=p,a;case y:return Ji(c.children,m,p,s);case b:S=8,m|=24;break;case A:return a=pa(12,c,s,m|2),a.elementType=A,a.lanes=p,a;case q:return a=pa(13,c,s,m),a.elementType=q,a.lanes=p,a;case I:return a=pa(19,c,s,m),a.elementType=I,a.lanes=p,a;default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case T:S=10;break e;case M:S=9;break e;case U:S=11;break e;case R:S=14;break e;case Q:S=16,f=null;break e}S=29,c=Error(n(130,a===null?"null":typeof a,"")),f=null}return s=pa(S,c,s,m),s.elementType=a,s.type=f,s.lanes=p,s}function Ji(a,s,c,f){return a=pa(7,a,f,s),a.lanes=c,a}function of(a,s,c){return a=pa(6,a,null,s),a.lanes=c,a}function Cm(a){var s=pa(18,null,null,0);return s.stateNode=a,s}function uf(a,s,c){return s=pa(4,a.children!==null?a.children:[],a.key,s),s.lanes=c,s.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},s}var Nm=new WeakMap;function La(a,s){if(typeof a=="object"&&a!==null){var c=Nm.get(a);return c!==void 0?c:(s={value:a,source:s,stack:Ut(s)},Nm.set(a,s),s)}return{value:a,source:s,stack:Ut(s)}}var qs=[],Xs=0,Go=null,nc=0,Ia=[],Ua=0,oi=null,mn=1,xn="";function Dn(a,s){qs[Xs++]=nc,qs[Xs++]=Go,Go=a,nc=s}function Om(a,s,c){Ia[Ua++]=mn,Ia[Ua++]=xn,Ia[Ua++]=oi,oi=a;var f=mn;a=xn;var m=32-Wt(f)-1;f&=~(1<<m),c+=1;var p=32-Wt(s)+m;if(30<p){var S=m-m%5;p=(f&(1<<S)-1).toString(32),f>>=S,m-=S,mn=1<<32-Wt(s)+m|c<<m|f,xn=p+a}else mn=1<<p|c<<m|f,xn=a}function ff(a){a.return!==null&&(Dn(a,1),Om(a,1,0))}function hf(a){for(;a===Go;)Go=qs[--Xs],qs[Xs]=null,nc=qs[--Xs],qs[Xs]=null;for(;a===oi;)oi=Ia[--Ua],Ia[Ua]=null,xn=Ia[--Ua],Ia[Ua]=null,mn=Ia[--Ua],Ia[Ua]=null}function Rm(a,s){Ia[Ua++]=mn,Ia[Ua++]=xn,Ia[Ua++]=oi,mn=s.id,xn=s.overflow,oi=a}var Rr=null,zt=null,mt=!1,ui=null,ja=!1,df=Error(n(519));function fi(a){var s=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw ic(La(s,a)),df}function Dm(a){var s=a.stateNode,c=a.type,f=a.memoizedProps;switch(s[O]=a,s[B]=f,c){case"dialog":ft("cancel",s),ft("close",s);break;case"iframe":case"object":case"embed":ft("load",s);break;case"video":case"audio":for(c=0;c<Ac.length;c++)ft(Ac[c],s);break;case"source":ft("error",s);break;case"img":case"image":case"link":ft("error",s),ft("load",s);break;case"details":ft("toggle",s);break;case"input":ft("invalid",s),G1(s,f.value,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name,!0);break;case"select":ft("invalid",s);break;case"textarea":ft("invalid",s),X1(s,f.value,f.defaultValue,f.children)}c=f.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||s.textContent===""+c||f.suppressHydrationWarning===!0||Kp(s.textContent,c)?(f.popover!=null&&(ft("beforetoggle",s),ft("toggle",s)),f.onScroll!=null&&ft("scroll",s),f.onScrollEnd!=null&&ft("scrollend",s),f.onClick!=null&&(s.onclick=Nn),s=!0):s=!1,s||fi(a,!0)}function Fm(a){for(Rr=a.return;Rr;)switch(Rr.tag){case 5:case 31:case 13:ja=!1;return;case 27:case 3:ja=!0;return;default:Rr=Rr.return}}function Ws(a){if(a!==Rr)return!1;if(!mt)return Fm(a),mt=!0,!1;var s=a.tag,c;if((c=s!==3&&s!==27)&&((c=s===5)&&(c=a.type,c=!(c!=="form"&&c!=="button")||Rh(a.type,a.memoizedProps)),c=!c),c&&zt&&fi(a),Fm(a),s===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(n(317));zt=ng(a)}else if(s===31){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(n(317));zt=ng(a)}else s===27?(s=zt,Ti(a.type)?(a=Lh,Lh=null,zt=a):zt=s):zt=Rr?za(a.stateNode.nextSibling):null;return!0}function Qi(){zt=Rr=null,mt=!1}function mf(){var a=ui;return a!==null&&(oa===null?oa=a:oa.push.apply(oa,a),ui=null),a}function ic(a){ui===null?ui=[a]:ui.push(a)}var xf=j(null),Zi=null,Fn=null;function hi(a,s,c){z(xf,s._currentValue),s._currentValue=c}function Mn(a){a._currentValue=xf.current,N(xf)}function pf(a,s,c){for(;a!==null;){var f=a.alternate;if((a.childLanes&s)!==s?(a.childLanes|=s,f!==null&&(f.childLanes|=s)):f!==null&&(f.childLanes&s)!==s&&(f.childLanes|=s),a===c)break;a=a.return}}function gf(a,s,c,f){var m=a.child;for(m!==null&&(m.return=a);m!==null;){var p=m.dependencies;if(p!==null){var S=m.child;p=p.firstContext;e:for(;p!==null;){var D=p;p=m;for(var X=0;X<s.length;X++)if(D.context===s[X]){p.lanes|=c,D=p.alternate,D!==null&&(D.lanes|=c),pf(p.return,c,a),f||(S=null);break e}p=D.next}}else if(m.tag===18){if(S=m.return,S===null)throw Error(n(341));S.lanes|=c,p=S.alternate,p!==null&&(p.lanes|=c),pf(S,c,a),S=null}else S=m.child;if(S!==null)S.return=m;else for(S=m;S!==null;){if(S===a){S=null;break}if(m=S.sibling,m!==null){m.return=S.return,S=m;break}S=S.return}m=S}}function Ks(a,s,c,f){a=null;for(var m=s,p=!1;m!==null;){if(!p){if((m.flags&524288)!==0)p=!0;else if((m.flags&262144)!==0)break}if(m.tag===10){var S=m.alternate;if(S===null)throw Error(n(387));if(S=S.memoizedProps,S!==null){var D=m.type;xa(m.pendingProps.value,S.value)||(a!==null?a.push(D):a=[D])}}else if(m===we.current){if(S=m.alternate,S===null)throw Error(n(387));S.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(a!==null?a.push(Dc):a=[Dc])}m=m.return}a!==null&&gf(s,a,c,f),s.flags|=262144}function qo(a){for(a=a.firstContext;a!==null;){if(!xa(a.context._currentValue,a.memoizedValue))return!0;a=a.next}return!1}function es(a){Zi=a,Fn=null,a=a.dependencies,a!==null&&(a.firstContext=null)}function Dr(a){return Mm(Zi,a)}function Xo(a,s){return Zi===null&&es(a),Mm(a,s)}function Mm(a,s){var c=s._currentValue;if(s={context:s,memoizedValue:c,next:null},Fn===null){if(a===null)throw Error(n(308));Fn=s,a.dependencies={lanes:0,firstContext:s},a.flags|=524288}else Fn=Fn.next=s;return c}var Zw=typeof AbortController<"u"?AbortController:function(){var a=[],s=this.signal={aborted:!1,addEventListener:function(c,f){a.push(f)}};this.abort=function(){s.aborted=!0,a.forEach(function(c){return c()})}},eS=e.unstable_scheduleCallback,tS=e.unstable_NormalPriority,dr={$$typeof:T,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function vf(){return{controller:new Zw,data:new Map,refCount:0}}function sc(a){a.refCount--,a.refCount===0&&eS(tS,function(){a.controller.abort()})}var lc=null,yf=0,Ys=0,Js=null;function rS(a,s){if(lc===null){var c=lc=[];yf=0,Ys=Sh(),Js={status:"pending",value:void 0,then:function(f){c.push(f)}}}return yf++,s.then(Bm,Bm),s}function Bm(){if(--yf===0&&lc!==null){Js!==null&&(Js.status="fulfilled");var a=lc;lc=null,Ys=0,Js=null;for(var s=0;s<a.length;s++)(0,a[s])()}}function aS(a,s){var c=[],f={status:"pending",value:null,reason:null,then:function(m){c.push(m)}};return a.then(function(){f.status="fulfilled",f.value=s;for(var m=0;m<c.length;m++)(0,c[m])(s)},function(m){for(f.status="rejected",f.reason=m,m=0;m<c.length;m++)(0,c[m])(void 0)}),f}var Lm=Y.S;Y.S=function(a,s){yp=bt(),typeof s=="object"&&s!==null&&typeof s.then=="function"&&rS(a,s),Lm!==null&&Lm(a,s)};var ts=j(null);function _f(){var a=ts.current;return a!==null?a:It.pooledCache}function Wo(a,s){s===null?z(ts,ts.current):z(ts,s.pool)}function Im(){var a=_f();return a===null?null:{parent:dr._currentValue,pool:a}}var Qs=Error(n(460)),wf=Error(n(474)),Ko=Error(n(542)),Yo={then:function(){}};function Um(a){return a=a.status,a==="fulfilled"||a==="rejected"}function jm(a,s,c){switch(c=a[c],c===void 0?a.push(s):c!==s&&(s.then(Nn,Nn),s=c),s.status){case"fulfilled":return s.value;case"rejected":throw a=s.reason,zm(a),a;default:if(typeof s.status=="string")s.then(Nn,Nn);else{if(a=It,a!==null&&100<a.shellSuspendCounter)throw Error(n(482));a=s,a.status="pending",a.then(function(f){if(s.status==="pending"){var m=s;m.status="fulfilled",m.value=f}},function(f){if(s.status==="pending"){var m=s;m.status="rejected",m.reason=f}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw a=s.reason,zm(a),a}throw as=s,Qs}}function rs(a){try{var s=a._init;return s(a._payload)}catch(c){throw c!==null&&typeof c=="object"&&typeof c.then=="function"?(as=c,Qs):c}}var as=null;function Pm(){if(as===null)throw Error(n(459));var a=as;return as=null,a}function zm(a){if(a===Qs||a===Ko)throw Error(n(483))}var Zs=null,cc=0;function Jo(a){var s=cc;return cc+=1,Zs===null&&(Zs=[]),jm(Zs,a,s)}function oc(a,s){s=s.props.ref,a.ref=s!==void 0?s:null}function Qo(a,s){throw s.$$typeof===v?Error(n(525)):(a=Object.prototype.toString.call(s),Error(n(31,a==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":a)))}function Hm(a){function s(se,ee){if(a){var oe=se.deletions;oe===null?(se.deletions=[ee],se.flags|=16):oe.push(ee)}}function c(se,ee){if(!a)return null;for(;ee!==null;)s(se,ee),ee=ee.sibling;return null}function f(se){for(var ee=new Map;se!==null;)se.key!==null?ee.set(se.key,se):ee.set(se.index,se),se=se.sibling;return ee}function m(se,ee){return se=Rn(se,ee),se.index=0,se.sibling=null,se}function p(se,ee,oe){return se.index=oe,a?(oe=se.alternate,oe!==null?(oe=oe.index,oe<ee?(se.flags|=67108866,ee):oe):(se.flags|=67108866,ee)):(se.flags|=1048576,ee)}function S(se){return a&&se.alternate===null&&(se.flags|=67108866),se}function D(se,ee,oe,Se){return ee===null||ee.tag!==6?(ee=of(oe,se.mode,Se),ee.return=se,ee):(ee=m(ee,oe),ee.return=se,ee)}function X(se,ee,oe,Se){var Ge=oe.type;return Ge===y?ye(se,ee,oe.props.children,Se,oe.key):ee!==null&&(ee.elementType===Ge||typeof Ge=="object"&&Ge!==null&&Ge.$$typeof===Q&&rs(Ge)===ee.type)?(ee=m(ee,oe.props),oc(ee,oe),ee.return=se,ee):(ee=$o(oe.type,oe.key,oe.props,null,se.mode,Se),oc(ee,oe),ee.return=se,ee)}function ue(se,ee,oe,Se){return ee===null||ee.tag!==4||ee.stateNode.containerInfo!==oe.containerInfo||ee.stateNode.implementation!==oe.implementation?(ee=uf(oe,se.mode,Se),ee.return=se,ee):(ee=m(ee,oe.children||[]),ee.return=se,ee)}function ye(se,ee,oe,Se,Ge){return ee===null||ee.tag!==7?(ee=Ji(oe,se.mode,Se,Ge),ee.return=se,ee):(ee=m(ee,oe),ee.return=se,ee)}function Te(se,ee,oe){if(typeof ee=="string"&&ee!==""||typeof ee=="number"||typeof ee=="bigint")return ee=of(""+ee,se.mode,oe),ee.return=se,ee;if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case _:return oe=$o(ee.type,ee.key,ee.props,null,se.mode,oe),oc(oe,ee),oe.return=se,oe;case w:return ee=uf(ee,se.mode,oe),ee.return=se,ee;case Q:return ee=rs(ee),Te(se,ee,oe)}if(be(ee)||J(ee))return ee=Ji(ee,se.mode,oe,null),ee.return=se,ee;if(typeof ee.then=="function")return Te(se,Jo(ee),oe);if(ee.$$typeof===T)return Te(se,Xo(se,ee),oe);Qo(se,ee)}return null}function fe(se,ee,oe,Se){var Ge=ee!==null?ee.key:null;if(typeof oe=="string"&&oe!==""||typeof oe=="number"||typeof oe=="bigint")return Ge!==null?null:D(se,ee,""+oe,Se);if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case _:return oe.key===Ge?X(se,ee,oe,Se):null;case w:return oe.key===Ge?ue(se,ee,oe,Se):null;case Q:return oe=rs(oe),fe(se,ee,oe,Se)}if(be(oe)||J(oe))return Ge!==null?null:ye(se,ee,oe,Se,null);if(typeof oe.then=="function")return fe(se,ee,Jo(oe),Se);if(oe.$$typeof===T)return fe(se,ee,Xo(se,oe),Se);Qo(se,oe)}return null}function de(se,ee,oe,Se,Ge){if(typeof Se=="string"&&Se!==""||typeof Se=="number"||typeof Se=="bigint")return se=se.get(oe)||null,D(ee,se,""+Se,Ge);if(typeof Se=="object"&&Se!==null){switch(Se.$$typeof){case _:return se=se.get(Se.key===null?oe:Se.key)||null,X(ee,se,Se,Ge);case w:return se=se.get(Se.key===null?oe:Se.key)||null,ue(ee,se,Se,Ge);case Q:return Se=rs(Se),de(se,ee,oe,Se,Ge)}if(be(Se)||J(Se))return se=se.get(oe)||null,ye(ee,se,Se,Ge,null);if(typeof Se.then=="function")return de(se,ee,oe,Jo(Se),Ge);if(Se.$$typeof===T)return de(se,ee,oe,Xo(ee,Se),Ge);Qo(ee,Se)}return null}function ze(se,ee,oe,Se){for(var Ge=null,vt=null,He=ee,st=ee=0,dt=null;He!==null&&st<oe.length;st++){He.index>st?(dt=He,He=null):dt=He.sibling;var yt=fe(se,He,oe[st],Se);if(yt===null){He===null&&(He=dt);break}a&&He&&yt.alternate===null&&s(se,He),ee=p(yt,ee,st),vt===null?Ge=yt:vt.sibling=yt,vt=yt,He=dt}if(st===oe.length)return c(se,He),mt&&Dn(se,st),Ge;if(He===null){for(;st<oe.length;st++)He=Te(se,oe[st],Se),He!==null&&(ee=p(He,ee,st),vt===null?Ge=He:vt.sibling=He,vt=He);return mt&&Dn(se,st),Ge}for(He=f(He);st<oe.length;st++)dt=de(He,se,st,oe[st],Se),dt!==null&&(a&&dt.alternate!==null&&He.delete(dt.key===null?st:dt.key),ee=p(dt,ee,st),vt===null?Ge=dt:vt.sibling=dt,vt=dt);return a&&He.forEach(function(Oi){return s(se,Oi)}),mt&&Dn(se,st),Ge}function Xe(se,ee,oe,Se){if(oe==null)throw Error(n(151));for(var Ge=null,vt=null,He=ee,st=ee=0,dt=null,yt=oe.next();He!==null&&!yt.done;st++,yt=oe.next()){He.index>st?(dt=He,He=null):dt=He.sibling;var Oi=fe(se,He,yt.value,Se);if(Oi===null){He===null&&(He=dt);break}a&&He&&Oi.alternate===null&&s(se,He),ee=p(Oi,ee,st),vt===null?Ge=Oi:vt.sibling=Oi,vt=Oi,He=dt}if(yt.done)return c(se,He),mt&&Dn(se,st),Ge;if(He===null){for(;!yt.done;st++,yt=oe.next())yt=Te(se,yt.value,Se),yt!==null&&(ee=p(yt,ee,st),vt===null?Ge=yt:vt.sibling=yt,vt=yt);return mt&&Dn(se,st),Ge}for(He=f(He);!yt.done;st++,yt=oe.next())yt=de(He,se,st,yt.value,Se),yt!==null&&(a&&yt.alternate!==null&&He.delete(yt.key===null?st:yt.key),ee=p(yt,ee,st),vt===null?Ge=yt:vt.sibling=yt,vt=yt);return a&&He.forEach(function(mb){return s(se,mb)}),mt&&Dn(se,st),Ge}function Bt(se,ee,oe,Se){if(typeof oe=="object"&&oe!==null&&oe.type===y&&oe.key===null&&(oe=oe.props.children),typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case _:e:{for(var Ge=oe.key;ee!==null;){if(ee.key===Ge){if(Ge=oe.type,Ge===y){if(ee.tag===7){c(se,ee.sibling),Se=m(ee,oe.props.children),Se.return=se,se=Se;break e}}else if(ee.elementType===Ge||typeof Ge=="object"&&Ge!==null&&Ge.$$typeof===Q&&rs(Ge)===ee.type){c(se,ee.sibling),Se=m(ee,oe.props),oc(Se,oe),Se.return=se,se=Se;break e}c(se,ee);break}else s(se,ee);ee=ee.sibling}oe.type===y?(Se=Ji(oe.props.children,se.mode,Se,oe.key),Se.return=se,se=Se):(Se=$o(oe.type,oe.key,oe.props,null,se.mode,Se),oc(Se,oe),Se.return=se,se=Se)}return S(se);case w:e:{for(Ge=oe.key;ee!==null;){if(ee.key===Ge)if(ee.tag===4&&ee.stateNode.containerInfo===oe.containerInfo&&ee.stateNode.implementation===oe.implementation){c(se,ee.sibling),Se=m(ee,oe.children||[]),Se.return=se,se=Se;break e}else{c(se,ee);break}else s(se,ee);ee=ee.sibling}Se=uf(oe,se.mode,Se),Se.return=se,se=Se}return S(se);case Q:return oe=rs(oe),Bt(se,ee,oe,Se)}if(be(oe))return ze(se,ee,oe,Se);if(J(oe)){if(Ge=J(oe),typeof Ge!="function")throw Error(n(150));return oe=Ge.call(oe),Xe(se,ee,oe,Se)}if(typeof oe.then=="function")return Bt(se,ee,Jo(oe),Se);if(oe.$$typeof===T)return Bt(se,ee,Xo(se,oe),Se);Qo(se,oe)}return typeof oe=="string"&&oe!==""||typeof oe=="number"||typeof oe=="bigint"?(oe=""+oe,ee!==null&&ee.tag===6?(c(se,ee.sibling),Se=m(ee,oe),Se.return=se,se=Se):(c(se,ee),Se=of(oe,se.mode,Se),Se.return=se,se=Se),S(se)):c(se,ee)}return function(se,ee,oe,Se){try{cc=0;var Ge=Bt(se,ee,oe,Se);return Zs=null,Ge}catch(He){if(He===Qs||He===Ko)throw He;var vt=pa(29,He,null,se.mode);return vt.lanes=Se,vt.return=se,vt}}}var ns=Hm(!0),Vm=Hm(!1),di=!1;function Sf(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function bf(a,s){a=a.updateQueue,s.updateQueue===a&&(s.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,callbacks:null})}function mi(a){return{lane:a,tag:0,payload:null,callback:null,next:null}}function xi(a,s,c){var f=a.updateQueue;if(f===null)return null;if(f=f.shared,(wt&2)!==0){var m=f.pending;return m===null?s.next=s:(s.next=m.next,m.next=s),f.pending=s,s=Vo(a),km(a,null,c),s}return Ho(a,f,s,c),Vo(a)}function uc(a,s,c){if(s=s.updateQueue,s!==null&&(s=s.shared,(c&4194048)!==0)){var f=s.lanes;f&=a.pendingLanes,c|=f,s.lanes=c,xe(a,c)}}function Ef(a,s){var c=a.updateQueue,f=a.alternate;if(f!==null&&(f=f.updateQueue,c===f)){var m=null,p=null;if(c=c.firstBaseUpdate,c!==null){do{var S={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};p===null?m=p=S:p=p.next=S,c=c.next}while(c!==null);p===null?m=p=s:p=p.next=s}else m=p=s;c={baseState:f.baseState,firstBaseUpdate:m,lastBaseUpdate:p,shared:f.shared,callbacks:f.callbacks},a.updateQueue=c;return}a=c.lastBaseUpdate,a===null?c.firstBaseUpdate=s:a.next=s,c.lastBaseUpdate=s}var Tf=!1;function fc(){if(Tf){var a=Js;if(a!==null)throw a}}function hc(a,s,c,f){Tf=!1;var m=a.updateQueue;di=!1;var p=m.firstBaseUpdate,S=m.lastBaseUpdate,D=m.shared.pending;if(D!==null){m.shared.pending=null;var X=D,ue=X.next;X.next=null,S===null?p=ue:S.next=ue,S=X;var ye=a.alternate;ye!==null&&(ye=ye.updateQueue,D=ye.lastBaseUpdate,D!==S&&(D===null?ye.firstBaseUpdate=ue:D.next=ue,ye.lastBaseUpdate=X))}if(p!==null){var Te=m.baseState;S=0,ye=ue=X=null,D=p;do{var fe=D.lane&-536870913,de=fe!==D.lane;if(de?(ht&fe)===fe:(f&fe)===fe){fe!==0&&fe===Ys&&(Tf=!0),ye!==null&&(ye=ye.next={lane:0,tag:D.tag,payload:D.payload,callback:null,next:null});e:{var ze=a,Xe=D;fe=s;var Bt=c;switch(Xe.tag){case 1:if(ze=Xe.payload,typeof ze=="function"){Te=ze.call(Bt,Te,fe);break e}Te=ze;break e;case 3:ze.flags=ze.flags&-65537|128;case 0:if(ze=Xe.payload,fe=typeof ze=="function"?ze.call(Bt,Te,fe):ze,fe==null)break e;Te=g({},Te,fe);break e;case 2:di=!0}}fe=D.callback,fe!==null&&(a.flags|=64,de&&(a.flags|=8192),de=m.callbacks,de===null?m.callbacks=[fe]:de.push(fe))}else de={lane:fe,tag:D.tag,payload:D.payload,callback:D.callback,next:null},ye===null?(ue=ye=de,X=Te):ye=ye.next=de,S|=fe;if(D=D.next,D===null){if(D=m.shared.pending,D===null)break;de=D,D=de.next,de.next=null,m.lastBaseUpdate=de,m.shared.pending=null}}while(!0);ye===null&&(X=Te),m.baseState=X,m.firstBaseUpdate=ue,m.lastBaseUpdate=ye,p===null&&(m.shared.lanes=0),_i|=S,a.lanes=S,a.memoizedState=Te}}function $m(a,s){if(typeof a!="function")throw Error(n(191,a));a.call(s)}function Gm(a,s){var c=a.callbacks;if(c!==null)for(a.callbacks=null,a=0;a<c.length;a++)$m(c[a],s)}var el=j(null),Zo=j(0);function qm(a,s){a=Vn,z(Zo,a),z(el,s),Vn=a|s.baseLanes}function kf(){z(Zo,Vn),z(el,el.current)}function Af(){Vn=Zo.current,N(el),N(Zo)}var ga=j(null),Pa=null;function pi(a){var s=a.alternate;z(sr,sr.current&1),z(ga,a),Pa===null&&(s===null||el.current!==null||s.memoizedState!==null)&&(Pa=a)}function Cf(a){z(sr,sr.current),z(ga,a),Pa===null&&(Pa=a)}function Xm(a){a.tag===22?(z(sr,sr.current),z(ga,a),Pa===null&&(Pa=a)):gi()}function gi(){z(sr,sr.current),z(ga,ga.current)}function va(a){N(ga),Pa===a&&(Pa=null),N(sr)}var sr=j(0);function e0(a){for(var s=a;s!==null;){if(s.tag===13){var c=s.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||Mh(c)||Bh(c)))return s}else if(s.tag===19&&(s.memoizedProps.revealOrder==="forwards"||s.memoizedProps.revealOrder==="backwards"||s.memoizedProps.revealOrder==="unstable_legacy-backwards"||s.memoizedProps.revealOrder==="together")){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break;for(;s.sibling===null;){if(s.return===null||s.return===a)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var Bn=0,nt=null,Ft=null,mr=null,t0=!1,tl=!1,is=!1,r0=0,dc=0,rl=null,nS=0;function er(){throw Error(n(321))}function Nf(a,s){if(s===null)return!1;for(var c=0;c<s.length&&c<a.length;c++)if(!xa(a[c],s[c]))return!1;return!0}function Of(a,s,c,f,m,p){return Bn=p,nt=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,Y.H=a===null||a.memoizedState===null?Ox:Gf,is=!1,p=c(f,m),is=!1,tl&&(p=Km(s,c,f,m)),Wm(a),p}function Wm(a){Y.H=pc;var s=Ft!==null&&Ft.next!==null;if(Bn=0,mr=Ft=nt=null,t0=!1,dc=0,rl=null,s)throw Error(n(300));a===null||xr||(a=a.dependencies,a!==null&&qo(a)&&(xr=!0))}function Km(a,s,c,f){nt=a;var m=0;do{if(tl&&(rl=null),dc=0,tl=!1,25<=m)throw Error(n(301));if(m+=1,mr=Ft=null,a.updateQueue!=null){var p=a.updateQueue;p.lastEffect=null,p.events=null,p.stores=null,p.memoCache!=null&&(p.memoCache.index=0)}Y.H=Rx,p=s(c,f)}while(tl);return p}function iS(){var a=Y.H,s=a.useState()[0];return s=typeof s.then=="function"?mc(s):s,a=a.useState()[0],(Ft!==null?Ft.memoizedState:null)!==a&&(nt.flags|=1024),s}function Rf(){var a=r0!==0;return r0=0,a}function Df(a,s,c){s.updateQueue=a.updateQueue,s.flags&=-2053,a.lanes&=~c}function Ff(a){if(t0){for(a=a.memoizedState;a!==null;){var s=a.queue;s!==null&&(s.pending=null),a=a.next}t0=!1}Bn=0,mr=Ft=nt=null,tl=!1,dc=r0=0,rl=null}function Qr(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return mr===null?nt.memoizedState=mr=a:mr=mr.next=a,mr}function lr(){if(Ft===null){var a=nt.alternate;a=a!==null?a.memoizedState:null}else a=Ft.next;var s=mr===null?nt.memoizedState:mr.next;if(s!==null)mr=s,Ft=a;else{if(a===null)throw nt.alternate===null?Error(n(467)):Error(n(310));Ft=a,a={memoizedState:Ft.memoizedState,baseState:Ft.baseState,baseQueue:Ft.baseQueue,queue:Ft.queue,next:null},mr===null?nt.memoizedState=mr=a:mr=mr.next=a}return mr}function a0(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function mc(a){var s=dc;return dc+=1,rl===null&&(rl=[]),a=jm(rl,a,s),s=nt,(mr===null?s.memoizedState:mr.next)===null&&(s=s.alternate,Y.H=s===null||s.memoizedState===null?Ox:Gf),a}function n0(a){if(a!==null&&typeof a=="object"){if(typeof a.then=="function")return mc(a);if(a.$$typeof===T)return Dr(a)}throw Error(n(438,String(a)))}function Mf(a){var s=null,c=nt.updateQueue;if(c!==null&&(s=c.memoCache),s==null){var f=nt.alternate;f!==null&&(f=f.updateQueue,f!==null&&(f=f.memoCache,f!=null&&(s={data:f.data.map(function(m){return m.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),c===null&&(c=a0(),nt.updateQueue=c),c.memoCache=s,c=s.data[s.index],c===void 0)for(c=s.data[s.index]=Array(a),f=0;f<a;f++)c[f]=ae;return s.index++,c}function Ln(a,s){return typeof s=="function"?s(a):s}function i0(a){var s=lr();return Bf(s,Ft,a)}function Bf(a,s,c){var f=a.queue;if(f===null)throw Error(n(311));f.lastRenderedReducer=c;var m=a.baseQueue,p=f.pending;if(p!==null){if(m!==null){var S=m.next;m.next=p.next,p.next=S}s.baseQueue=m=p,f.pending=null}if(p=a.baseState,m===null)a.memoizedState=p;else{s=m.next;var D=S=null,X=null,ue=s,ye=!1;do{var Te=ue.lane&-536870913;if(Te!==ue.lane?(ht&Te)===Te:(Bn&Te)===Te){var fe=ue.revertLane;if(fe===0)X!==null&&(X=X.next={lane:0,revertLane:0,gesture:null,action:ue.action,hasEagerState:ue.hasEagerState,eagerState:ue.eagerState,next:null}),Te===Ys&&(ye=!0);else if((Bn&fe)===fe){ue=ue.next,fe===Ys&&(ye=!0);continue}else Te={lane:0,revertLane:ue.revertLane,gesture:null,action:ue.action,hasEagerState:ue.hasEagerState,eagerState:ue.eagerState,next:null},X===null?(D=X=Te,S=p):X=X.next=Te,nt.lanes|=fe,_i|=fe;Te=ue.action,is&&c(p,Te),p=ue.hasEagerState?ue.eagerState:c(p,Te)}else fe={lane:Te,revertLane:ue.revertLane,gesture:ue.gesture,action:ue.action,hasEagerState:ue.hasEagerState,eagerState:ue.eagerState,next:null},X===null?(D=X=fe,S=p):X=X.next=fe,nt.lanes|=Te,_i|=Te;ue=ue.next}while(ue!==null&&ue!==s);if(X===null?S=p:X.next=D,!xa(p,a.memoizedState)&&(xr=!0,ye&&(c=Js,c!==null)))throw c;a.memoizedState=p,a.baseState=S,a.baseQueue=X,f.lastRenderedState=p}return m===null&&(f.lanes=0),[a.memoizedState,f.dispatch]}function Lf(a){var s=lr(),c=s.queue;if(c===null)throw Error(n(311));c.lastRenderedReducer=a;var f=c.dispatch,m=c.pending,p=s.memoizedState;if(m!==null){c.pending=null;var S=m=m.next;do p=a(p,S.action),S=S.next;while(S!==m);xa(p,s.memoizedState)||(xr=!0),s.memoizedState=p,s.baseQueue===null&&(s.baseState=p),c.lastRenderedState=p}return[p,f]}function Ym(a,s,c){var f=nt,m=lr(),p=mt;if(p){if(c===void 0)throw Error(n(407));c=c()}else c=s();var S=!xa((Ft||m).memoizedState,c);if(S&&(m.memoizedState=c,xr=!0),m=m.queue,jf(Zm.bind(null,f,m,a),[a]),m.getSnapshot!==s||S||mr!==null&&mr.memoizedState.tag&1){if(f.flags|=2048,al(9,{destroy:void 0},Qm.bind(null,f,m,c,s),null),It===null)throw Error(n(349));p||(Bn&127)!==0||Jm(f,s,c)}return c}function Jm(a,s,c){a.flags|=16384,a={getSnapshot:s,value:c},s=nt.updateQueue,s===null?(s=a0(),nt.updateQueue=s,s.stores=[a]):(c=s.stores,c===null?s.stores=[a]:c.push(a))}function Qm(a,s,c,f){s.value=c,s.getSnapshot=f,ex(s)&&tx(a)}function Zm(a,s,c){return c(function(){ex(s)&&tx(a)})}function ex(a){var s=a.getSnapshot;a=a.value;try{var c=s();return!xa(a,c)}catch{return!0}}function tx(a){var s=Yi(a,2);s!==null&&ua(s,a,2)}function If(a){var s=Qr();if(typeof a=="function"){var c=a;if(a=c(),is){ra(!0);try{c()}finally{ra(!1)}}}return s.memoizedState=s.baseState=a,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ln,lastRenderedState:a},s}function rx(a,s,c,f){return a.baseState=c,Bf(a,Ft,typeof f=="function"?f:Ln)}function sS(a,s,c,f,m){if(c0(a))throw Error(n(485));if(a=s.action,a!==null){var p={payload:m,action:a,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(S){p.listeners.push(S)}};Y.T!==null?c(!0):p.isTransition=!1,f(p),c=s.pending,c===null?(p.next=s.pending=p,ax(s,p)):(p.next=c.next,s.pending=c.next=p)}}function ax(a,s){var c=s.action,f=s.payload,m=a.state;if(s.isTransition){var p=Y.T,S={};Y.T=S;try{var D=c(m,f),X=Y.S;X!==null&&X(S,D),nx(a,s,D)}catch(ue){Uf(a,s,ue)}finally{p!==null&&S.types!==null&&(p.types=S.types),Y.T=p}}else try{p=c(m,f),nx(a,s,p)}catch(ue){Uf(a,s,ue)}}function nx(a,s,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(f){ix(a,s,f)},function(f){return Uf(a,s,f)}):ix(a,s,c)}function ix(a,s,c){s.status="fulfilled",s.value=c,sx(s),a.state=c,s=a.pending,s!==null&&(c=s.next,c===s?a.pending=null:(c=c.next,s.next=c,ax(a,c)))}function Uf(a,s,c){var f=a.pending;if(a.pending=null,f!==null){f=f.next;do s.status="rejected",s.reason=c,sx(s),s=s.next;while(s!==f)}a.action=null}function sx(a){a=a.listeners;for(var s=0;s<a.length;s++)(0,a[s])()}function lx(a,s){return s}function cx(a,s){if(mt){var c=It.formState;if(c!==null){e:{var f=nt;if(mt){if(zt){t:{for(var m=zt,p=ja;m.nodeType!==8;){if(!p){m=null;break t}if(m=za(m.nextSibling),m===null){m=null;break t}}p=m.data,m=p==="F!"||p==="F"?m:null}if(m){zt=za(m.nextSibling),f=m.data==="F!";break e}}fi(f)}f=!1}f&&(s=c[0])}}return c=Qr(),c.memoizedState=c.baseState=s,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:lx,lastRenderedState:s},c.queue=f,c=Ax.bind(null,nt,f),f.dispatch=c,f=If(!1),p=$f.bind(null,nt,!1,f.queue),f=Qr(),m={state:s,dispatch:null,action:a,pending:null},f.queue=m,c=sS.bind(null,nt,m,p,c),m.dispatch=c,f.memoizedState=a,[s,c,!1]}function ox(a){var s=lr();return ux(s,Ft,a)}function ux(a,s,c){if(s=Bf(a,s,lx)[0],a=i0(Ln)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var f=mc(s)}catch(S){throw S===Qs?Ko:S}else f=s;s=lr();var m=s.queue,p=m.dispatch;return c!==s.memoizedState&&(nt.flags|=2048,al(9,{destroy:void 0},lS.bind(null,m,c),null)),[f,p,a]}function lS(a,s){a.action=s}function fx(a){var s=lr(),c=Ft;if(c!==null)return ux(s,c,a);lr(),s=s.memoizedState,c=lr();var f=c.queue.dispatch;return c.memoizedState=a,[s,f,!1]}function al(a,s,c,f){return a={tag:a,create:c,deps:f,inst:s,next:null},s=nt.updateQueue,s===null&&(s=a0(),nt.updateQueue=s),c=s.lastEffect,c===null?s.lastEffect=a.next=a:(f=c.next,c.next=a,a.next=f,s.lastEffect=a),a}function hx(){return lr().memoizedState}function s0(a,s,c,f){var m=Qr();nt.flags|=a,m.memoizedState=al(1|s,{destroy:void 0},c,f===void 0?null:f)}function l0(a,s,c,f){var m=lr();f=f===void 0?null:f;var p=m.memoizedState.inst;Ft!==null&&f!==null&&Nf(f,Ft.memoizedState.deps)?m.memoizedState=al(s,p,c,f):(nt.flags|=a,m.memoizedState=al(1|s,p,c,f))}function dx(a,s){s0(8390656,8,a,s)}function jf(a,s){l0(2048,8,a,s)}function cS(a){nt.flags|=4;var s=nt.updateQueue;if(s===null)s=a0(),nt.updateQueue=s,s.events=[a];else{var c=s.events;c===null?s.events=[a]:c.push(a)}}function mx(a){var s=lr().memoizedState;return cS({ref:s,nextImpl:a}),function(){if((wt&2)!==0)throw Error(n(440));return s.impl.apply(void 0,arguments)}}function xx(a,s){return l0(4,2,a,s)}function px(a,s){return l0(4,4,a,s)}function gx(a,s){if(typeof s=="function"){a=a();var c=s(a);return function(){typeof c=="function"?c():s(null)}}if(s!=null)return a=a(),s.current=a,function(){s.current=null}}function vx(a,s,c){c=c!=null?c.concat([a]):null,l0(4,4,gx.bind(null,s,a),c)}function Pf(){}function yx(a,s){var c=lr();s=s===void 0?null:s;var f=c.memoizedState;return s!==null&&Nf(s,f[1])?f[0]:(c.memoizedState=[a,s],a)}function _x(a,s){var c=lr();s=s===void 0?null:s;var f=c.memoizedState;if(s!==null&&Nf(s,f[1]))return f[0];if(f=a(),is){ra(!0);try{a()}finally{ra(!1)}}return c.memoizedState=[f,s],f}function zf(a,s,c){return c===void 0||(Bn&1073741824)!==0&&(ht&261930)===0?a.memoizedState=s:(a.memoizedState=c,a=wp(),nt.lanes|=a,_i|=a,c)}function wx(a,s,c,f){return xa(c,s)?c:el.current!==null?(a=zf(a,c,f),xa(a,s)||(xr=!0),a):(Bn&42)===0||(Bn&1073741824)!==0&&(ht&261930)===0?(xr=!0,a.memoizedState=c):(a=wp(),nt.lanes|=a,_i|=a,s)}function Sx(a,s,c,f,m){var p=le.p;le.p=p!==0&&8>p?p:8;var S=Y.T,D={};Y.T=D,$f(a,!1,s,c);try{var X=m(),ue=Y.S;if(ue!==null&&ue(D,X),X!==null&&typeof X=="object"&&typeof X.then=="function"){var ye=aS(X,f);xc(a,s,ye,wa(a))}else xc(a,s,f,wa(a))}catch(Te){xc(a,s,{then:function(){},status:"rejected",reason:Te},wa())}finally{le.p=p,S!==null&&D.types!==null&&(S.types=D.types),Y.T=S}}function oS(){}function Hf(a,s,c,f){if(a.tag!==5)throw Error(n(476));var m=bx(a).queue;Sx(a,m,s,_e,c===null?oS:function(){return Ex(a),c(f)})}function bx(a){var s=a.memoizedState;if(s!==null)return s;s={memoizedState:_e,baseState:_e,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ln,lastRenderedState:_e},next:null};var c={};return s.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ln,lastRenderedState:c},next:null},a.memoizedState=s,a=a.alternate,a!==null&&(a.memoizedState=s),s}function Ex(a){var s=bx(a);s.next===null&&(s=a.alternate.memoizedState),xc(a,s.next.queue,{},wa())}function Vf(){return Dr(Dc)}function Tx(){return lr().memoizedState}function kx(){return lr().memoizedState}function uS(a){for(var s=a.return;s!==null;){switch(s.tag){case 24:case 3:var c=wa();a=mi(c);var f=xi(s,a,c);f!==null&&(ua(f,s,c),uc(f,s,c)),s={cache:vf()},a.payload=s;return}s=s.return}}function fS(a,s,c){var f=wa();c={lane:f,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},c0(a)?Cx(s,c):(c=lf(a,s,c,f),c!==null&&(ua(c,a,f),Nx(c,s,f)))}function Ax(a,s,c){var f=wa();xc(a,s,c,f)}function xc(a,s,c,f){var m={lane:f,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null};if(c0(a))Cx(s,m);else{var p=a.alternate;if(a.lanes===0&&(p===null||p.lanes===0)&&(p=s.lastRenderedReducer,p!==null))try{var S=s.lastRenderedState,D=p(S,c);if(m.hasEagerState=!0,m.eagerState=D,xa(D,S))return Ho(a,s,m,0),It===null&&zo(),!1}catch{}if(c=lf(a,s,m,f),c!==null)return ua(c,a,f),Nx(c,s,f),!0}return!1}function $f(a,s,c,f){if(f={lane:2,revertLane:Sh(),gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},c0(a)){if(s)throw Error(n(479))}else s=lf(a,c,f,2),s!==null&&ua(s,a,2)}function c0(a){var s=a.alternate;return a===nt||s!==null&&s===nt}function Cx(a,s){tl=t0=!0;var c=a.pending;c===null?s.next=s:(s.next=c.next,c.next=s),a.pending=s}function Nx(a,s,c){if((c&4194048)!==0){var f=s.lanes;f&=a.pendingLanes,c|=f,s.lanes=c,xe(a,c)}}var pc={readContext:Dr,use:n0,useCallback:er,useContext:er,useEffect:er,useImperativeHandle:er,useLayoutEffect:er,useInsertionEffect:er,useMemo:er,useReducer:er,useRef:er,useState:er,useDebugValue:er,useDeferredValue:er,useTransition:er,useSyncExternalStore:er,useId:er,useHostTransitionStatus:er,useFormState:er,useActionState:er,useOptimistic:er,useMemoCache:er,useCacheRefresh:er};pc.useEffectEvent=er;var Ox={readContext:Dr,use:n0,useCallback:function(a,s){return Qr().memoizedState=[a,s===void 0?null:s],a},useContext:Dr,useEffect:dx,useImperativeHandle:function(a,s,c){c=c!=null?c.concat([a]):null,s0(4194308,4,gx.bind(null,s,a),c)},useLayoutEffect:function(a,s){return s0(4194308,4,a,s)},useInsertionEffect:function(a,s){s0(4,2,a,s)},useMemo:function(a,s){var c=Qr();s=s===void 0?null:s;var f=a();if(is){ra(!0);try{a()}finally{ra(!1)}}return c.memoizedState=[f,s],f},useReducer:function(a,s,c){var f=Qr();if(c!==void 0){var m=c(s);if(is){ra(!0);try{c(s)}finally{ra(!1)}}}else m=s;return f.memoizedState=f.baseState=m,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:m},f.queue=a,a=a.dispatch=fS.bind(null,nt,a),[f.memoizedState,a]},useRef:function(a){var s=Qr();return a={current:a},s.memoizedState=a},useState:function(a){a=If(a);var s=a.queue,c=Ax.bind(null,nt,s);return s.dispatch=c,[a.memoizedState,c]},useDebugValue:Pf,useDeferredValue:function(a,s){var c=Qr();return zf(c,a,s)},useTransition:function(){var a=If(!1);return a=Sx.bind(null,nt,a.queue,!0,!1),Qr().memoizedState=a,[!1,a]},useSyncExternalStore:function(a,s,c){var f=nt,m=Qr();if(mt){if(c===void 0)throw Error(n(407));c=c()}else{if(c=s(),It===null)throw Error(n(349));(ht&127)!==0||Jm(f,s,c)}m.memoizedState=c;var p={value:c,getSnapshot:s};return m.queue=p,dx(Zm.bind(null,f,p,a),[a]),f.flags|=2048,al(9,{destroy:void 0},Qm.bind(null,f,p,c,s),null),c},useId:function(){var a=Qr(),s=It.identifierPrefix;if(mt){var c=xn,f=mn;c=(f&~(1<<32-Wt(f)-1)).toString(32)+c,s="_"+s+"R_"+c,c=r0++,0<c&&(s+="H"+c.toString(32)),s+="_"}else c=nS++,s="_"+s+"r_"+c.toString(32)+"_";return a.memoizedState=s},useHostTransitionStatus:Vf,useFormState:cx,useActionState:cx,useOptimistic:function(a){var s=Qr();s.memoizedState=s.baseState=a;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=c,s=$f.bind(null,nt,!0,c),c.dispatch=s,[a,s]},useMemoCache:Mf,useCacheRefresh:function(){return Qr().memoizedState=uS.bind(null,nt)},useEffectEvent:function(a){var s=Qr(),c={impl:a};return s.memoizedState=c,function(){if((wt&2)!==0)throw Error(n(440));return c.impl.apply(void 0,arguments)}}},Gf={readContext:Dr,use:n0,useCallback:yx,useContext:Dr,useEffect:jf,useImperativeHandle:vx,useInsertionEffect:xx,useLayoutEffect:px,useMemo:_x,useReducer:i0,useRef:hx,useState:function(){return i0(Ln)},useDebugValue:Pf,useDeferredValue:function(a,s){var c=lr();return wx(c,Ft.memoizedState,a,s)},useTransition:function(){var a=i0(Ln)[0],s=lr().memoizedState;return[typeof a=="boolean"?a:mc(a),s]},useSyncExternalStore:Ym,useId:Tx,useHostTransitionStatus:Vf,useFormState:ox,useActionState:ox,useOptimistic:function(a,s){var c=lr();return rx(c,Ft,a,s)},useMemoCache:Mf,useCacheRefresh:kx};Gf.useEffectEvent=mx;var Rx={readContext:Dr,use:n0,useCallback:yx,useContext:Dr,useEffect:jf,useImperativeHandle:vx,useInsertionEffect:xx,useLayoutEffect:px,useMemo:_x,useReducer:Lf,useRef:hx,useState:function(){return Lf(Ln)},useDebugValue:Pf,useDeferredValue:function(a,s){var c=lr();return Ft===null?zf(c,a,s):wx(c,Ft.memoizedState,a,s)},useTransition:function(){var a=Lf(Ln)[0],s=lr().memoizedState;return[typeof a=="boolean"?a:mc(a),s]},useSyncExternalStore:Ym,useId:Tx,useHostTransitionStatus:Vf,useFormState:fx,useActionState:fx,useOptimistic:function(a,s){var c=lr();return Ft!==null?rx(c,Ft,a,s):(c.baseState=a,[a,c.queue.dispatch])},useMemoCache:Mf,useCacheRefresh:kx};Rx.useEffectEvent=mx;function qf(a,s,c,f){s=a.memoizedState,c=c(f,s),c=c==null?s:g({},s,c),a.memoizedState=c,a.lanes===0&&(a.updateQueue.baseState=c)}var Xf={enqueueSetState:function(a,s,c){a=a._reactInternals;var f=wa(),m=mi(f);m.payload=s,c!=null&&(m.callback=c),s=xi(a,m,f),s!==null&&(ua(s,a,f),uc(s,a,f))},enqueueReplaceState:function(a,s,c){a=a._reactInternals;var f=wa(),m=mi(f);m.tag=1,m.payload=s,c!=null&&(m.callback=c),s=xi(a,m,f),s!==null&&(ua(s,a,f),uc(s,a,f))},enqueueForceUpdate:function(a,s){a=a._reactInternals;var c=wa(),f=mi(c);f.tag=2,s!=null&&(f.callback=s),s=xi(a,f,c),s!==null&&(ua(s,a,c),uc(s,a,c))}};function Dx(a,s,c,f,m,p,S){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(f,p,S):s.prototype&&s.prototype.isPureReactComponent?!rc(c,f)||!rc(m,p):!0}function Fx(a,s,c,f){a=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(c,f),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(c,f),s.state!==a&&Xf.enqueueReplaceState(s,s.state,null)}function ss(a,s){var c=s;if("ref"in s){c={};for(var f in s)f!=="ref"&&(c[f]=s[f])}if(a=a.defaultProps){c===s&&(c=g({},c));for(var m in a)c[m]===void 0&&(c[m]=a[m])}return c}function Mx(a){Po(a)}function Bx(a){console.error(a)}function Lx(a){Po(a)}function o0(a,s){try{var c=a.onUncaughtError;c(s.value,{componentStack:s.stack})}catch(f){setTimeout(function(){throw f})}}function Ix(a,s,c){try{var f=a.onCaughtError;f(c.value,{componentStack:c.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function Wf(a,s,c){return c=mi(c),c.tag=3,c.payload={element:null},c.callback=function(){o0(a,s)},c}function Ux(a){return a=mi(a),a.tag=3,a}function jx(a,s,c,f){var m=c.type.getDerivedStateFromError;if(typeof m=="function"){var p=f.value;a.payload=function(){return m(p)},a.callback=function(){Ix(s,c,f)}}var S=c.stateNode;S!==null&&typeof S.componentDidCatch=="function"&&(a.callback=function(){Ix(s,c,f),typeof m!="function"&&(wi===null?wi=new Set([this]):wi.add(this));var D=f.stack;this.componentDidCatch(f.value,{componentStack:D!==null?D:""})})}function hS(a,s,c,f,m){if(c.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){if(s=c.alternate,s!==null&&Ks(s,c,m,!0),c=ga.current,c!==null){switch(c.tag){case 31:case 13:return Pa===null?w0():c.alternate===null&&tr===0&&(tr=3),c.flags&=-257,c.flags|=65536,c.lanes=m,f===Yo?c.flags|=16384:(s=c.updateQueue,s===null?c.updateQueue=new Set([f]):s.add(f),yh(a,f,m)),!1;case 22:return c.flags|=65536,f===Yo?c.flags|=16384:(s=c.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([f])},c.updateQueue=s):(c=s.retryQueue,c===null?s.retryQueue=new Set([f]):c.add(f)),yh(a,f,m)),!1}throw Error(n(435,c.tag))}return yh(a,f,m),w0(),!1}if(mt)return s=ga.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=m,f!==df&&(a=Error(n(422),{cause:f}),ic(La(a,c)))):(f!==df&&(s=Error(n(423),{cause:f}),ic(La(s,c))),a=a.current.alternate,a.flags|=65536,m&=-m,a.lanes|=m,f=La(f,c),m=Wf(a.stateNode,f,m),Ef(a,m),tr!==4&&(tr=2)),!1;var p=Error(n(520),{cause:f});if(p=La(p,c),Ec===null?Ec=[p]:Ec.push(p),tr!==4&&(tr=2),s===null)return!0;f=La(f,c),c=s;do{switch(c.tag){case 3:return c.flags|=65536,a=m&-m,c.lanes|=a,a=Wf(c.stateNode,f,a),Ef(c,a),!1;case 1:if(s=c.type,p=c.stateNode,(c.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||p!==null&&typeof p.componentDidCatch=="function"&&(wi===null||!wi.has(p))))return c.flags|=65536,m&=-m,c.lanes|=m,m=Ux(m),jx(m,a,c,f),Ef(c,m),!1}c=c.return}while(c!==null);return!1}var Kf=Error(n(461)),xr=!1;function Fr(a,s,c,f){s.child=a===null?Vm(s,null,c,f):ns(s,a.child,c,f)}function Px(a,s,c,f,m){c=c.render;var p=s.ref;if("ref"in f){var S={};for(var D in f)D!=="ref"&&(S[D]=f[D])}else S=f;return es(s),f=Of(a,s,c,S,p,m),D=Rf(),a!==null&&!xr?(Df(a,s,m),In(a,s,m)):(mt&&D&&ff(s),s.flags|=1,Fr(a,s,f,m),s.child)}function zx(a,s,c,f,m){if(a===null){var p=c.type;return typeof p=="function"&&!cf(p)&&p.defaultProps===void 0&&c.compare===null?(s.tag=15,s.type=p,Hx(a,s,p,f,m)):(a=$o(c.type,null,f,s,s.mode,m),a.ref=s.ref,a.return=s,s.child=a)}if(p=a.child,!ah(a,m)){var S=p.memoizedProps;if(c=c.compare,c=c!==null?c:rc,c(S,f)&&a.ref===s.ref)return In(a,s,m)}return s.flags|=1,a=Rn(p,f),a.ref=s.ref,a.return=s,s.child=a}function Hx(a,s,c,f,m){if(a!==null){var p=a.memoizedProps;if(rc(p,f)&&a.ref===s.ref)if(xr=!1,s.pendingProps=f=p,ah(a,m))(a.flags&131072)!==0&&(xr=!0);else return s.lanes=a.lanes,In(a,s,m)}return Yf(a,s,c,f,m)}function Vx(a,s,c,f){var m=f.children,p=a!==null?a.memoizedState:null;if(a===null&&s.stateNode===null&&(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),f.mode==="hidden"){if((s.flags&128)!==0){if(p=p!==null?p.baseLanes|c:c,a!==null){for(f=s.child=a.child,m=0;f!==null;)m=m|f.lanes|f.childLanes,f=f.sibling;f=m&~p}else f=0,s.child=null;return $x(a,s,p,c,f)}if((c&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},a!==null&&Wo(s,p!==null?p.cachePool:null),p!==null?qm(s,p):kf(),Xm(s);else return f=s.lanes=536870912,$x(a,s,p!==null?p.baseLanes|c:c,c,f)}else p!==null?(Wo(s,p.cachePool),qm(s,p),gi(),s.memoizedState=null):(a!==null&&Wo(s,null),kf(),gi());return Fr(a,s,m,c),s.child}function gc(a,s){return a!==null&&a.tag===22||s.stateNode!==null||(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),s.sibling}function $x(a,s,c,f,m){var p=_f();return p=p===null?null:{parent:dr._currentValue,pool:p},s.memoizedState={baseLanes:c,cachePool:p},a!==null&&Wo(s,null),kf(),Xm(s),a!==null&&Ks(a,s,f,!0),s.childLanes=m,null}function u0(a,s){return s=h0({mode:s.mode,children:s.children},a.mode),s.ref=a.ref,a.child=s,s.return=a,s}function Gx(a,s,c){return ns(s,a.child,null,c),a=u0(s,s.pendingProps),a.flags|=2,va(s),s.memoizedState=null,a}function dS(a,s,c){var f=s.pendingProps,m=(s.flags&128)!==0;if(s.flags&=-129,a===null){if(mt){if(f.mode==="hidden")return a=u0(s,f),s.lanes=536870912,gc(null,a);if(Cf(s),(a=zt)?(a=ag(a,ja),a=a!==null&&a.data==="&"?a:null,a!==null&&(s.memoizedState={dehydrated:a,treeContext:oi!==null?{id:mn,overflow:xn}:null,retryLane:536870912,hydrationErrors:null},c=Cm(a),c.return=s,s.child=c,Rr=s,zt=null)):a=null,a===null)throw fi(s);return s.lanes=536870912,null}return u0(s,f)}var p=a.memoizedState;if(p!==null){var S=p.dehydrated;if(Cf(s),m)if(s.flags&256)s.flags&=-257,s=Gx(a,s,c);else if(s.memoizedState!==null)s.child=a.child,s.flags|=128,s=null;else throw Error(n(558));else if(xr||Ks(a,s,c,!1),m=(c&a.childLanes)!==0,xr||m){if(f=It,f!==null&&(S=Re(f,c),S!==0&&S!==p.retryLane))throw p.retryLane=S,Yi(a,S),ua(f,a,S),Kf;w0(),s=Gx(a,s,c)}else a=p.treeContext,zt=za(S.nextSibling),Rr=s,mt=!0,ui=null,ja=!1,a!==null&&Rm(s,a),s=u0(s,f),s.flags|=4096;return s}return a=Rn(a.child,{mode:f.mode,children:f.children}),a.ref=s.ref,s.child=a,a.return=s,a}function f0(a,s){var c=s.ref;if(c===null)a!==null&&a.ref!==null&&(s.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(n(284));(a===null||a.ref!==c)&&(s.flags|=4194816)}}function Yf(a,s,c,f,m){return es(s),c=Of(a,s,c,f,void 0,m),f=Rf(),a!==null&&!xr?(Df(a,s,m),In(a,s,m)):(mt&&f&&ff(s),s.flags|=1,Fr(a,s,c,m),s.child)}function qx(a,s,c,f,m,p){return es(s),s.updateQueue=null,c=Km(s,f,c,m),Wm(a),f=Rf(),a!==null&&!xr?(Df(a,s,p),In(a,s,p)):(mt&&f&&ff(s),s.flags|=1,Fr(a,s,c,p),s.child)}function Xx(a,s,c,f,m){if(es(s),s.stateNode===null){var p=Gs,S=c.contextType;typeof S=="object"&&S!==null&&(p=Dr(S)),p=new c(f,p),s.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,p.updater=Xf,s.stateNode=p,p._reactInternals=s,p=s.stateNode,p.props=f,p.state=s.memoizedState,p.refs={},Sf(s),S=c.contextType,p.context=typeof S=="object"&&S!==null?Dr(S):Gs,p.state=s.memoizedState,S=c.getDerivedStateFromProps,typeof S=="function"&&(qf(s,c,S,f),p.state=s.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof p.getSnapshotBeforeUpdate=="function"||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(S=p.state,typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount(),S!==p.state&&Xf.enqueueReplaceState(p,p.state,null),hc(s,f,p,m),fc(),p.state=s.memoizedState),typeof p.componentDidMount=="function"&&(s.flags|=4194308),f=!0}else if(a===null){p=s.stateNode;var D=s.memoizedProps,X=ss(c,D);p.props=X;var ue=p.context,ye=c.contextType;S=Gs,typeof ye=="object"&&ye!==null&&(S=Dr(ye));var Te=c.getDerivedStateFromProps;ye=typeof Te=="function"||typeof p.getSnapshotBeforeUpdate=="function",D=s.pendingProps!==D,ye||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(D||ue!==S)&&Fx(s,p,f,S),di=!1;var fe=s.memoizedState;p.state=fe,hc(s,f,p,m),fc(),ue=s.memoizedState,D||fe!==ue||di?(typeof Te=="function"&&(qf(s,c,Te,f),ue=s.memoizedState),(X=di||Dx(s,c,X,f,fe,ue,S))?(ye||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount()),typeof p.componentDidMount=="function"&&(s.flags|=4194308)):(typeof p.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=f,s.memoizedState=ue),p.props=f,p.state=ue,p.context=S,f=X):(typeof p.componentDidMount=="function"&&(s.flags|=4194308),f=!1)}else{p=s.stateNode,bf(a,s),S=s.memoizedProps,ye=ss(c,S),p.props=ye,Te=s.pendingProps,fe=p.context,ue=c.contextType,X=Gs,typeof ue=="object"&&ue!==null&&(X=Dr(ue)),D=c.getDerivedStateFromProps,(ue=typeof D=="function"||typeof p.getSnapshotBeforeUpdate=="function")||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(S!==Te||fe!==X)&&Fx(s,p,f,X),di=!1,fe=s.memoizedState,p.state=fe,hc(s,f,p,m),fc();var de=s.memoizedState;S!==Te||fe!==de||di||a!==null&&a.dependencies!==null&&qo(a.dependencies)?(typeof D=="function"&&(qf(s,c,D,f),de=s.memoizedState),(ye=di||Dx(s,c,ye,f,fe,de,X)||a!==null&&a.dependencies!==null&&qo(a.dependencies))?(ue||typeof p.UNSAFE_componentWillUpdate!="function"&&typeof p.componentWillUpdate!="function"||(typeof p.componentWillUpdate=="function"&&p.componentWillUpdate(f,de,X),typeof p.UNSAFE_componentWillUpdate=="function"&&p.UNSAFE_componentWillUpdate(f,de,X)),typeof p.componentDidUpdate=="function"&&(s.flags|=4),typeof p.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof p.componentDidUpdate!="function"||S===a.memoizedProps&&fe===a.memoizedState||(s.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||S===a.memoizedProps&&fe===a.memoizedState||(s.flags|=1024),s.memoizedProps=f,s.memoizedState=de),p.props=f,p.state=de,p.context=X,f=ye):(typeof p.componentDidUpdate!="function"||S===a.memoizedProps&&fe===a.memoizedState||(s.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||S===a.memoizedProps&&fe===a.memoizedState||(s.flags|=1024),f=!1)}return p=f,f0(a,s),f=(s.flags&128)!==0,p||f?(p=s.stateNode,c=f&&typeof c.getDerivedStateFromError!="function"?null:p.render(),s.flags|=1,a!==null&&f?(s.child=ns(s,a.child,null,m),s.child=ns(s,null,c,m)):Fr(a,s,c,m),s.memoizedState=p.state,a=s.child):a=In(a,s,m),a}function Wx(a,s,c,f){return Qi(),s.flags|=256,Fr(a,s,c,f),s.child}var Jf={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Qf(a){return{baseLanes:a,cachePool:Im()}}function Zf(a,s,c){return a=a!==null?a.childLanes&~c:0,s&&(a|=_a),a}function Kx(a,s,c){var f=s.pendingProps,m=!1,p=(s.flags&128)!==0,S;if((S=p)||(S=a!==null&&a.memoizedState===null?!1:(sr.current&2)!==0),S&&(m=!0,s.flags&=-129),S=(s.flags&32)!==0,s.flags&=-33,a===null){if(mt){if(m?pi(s):gi(),(a=zt)?(a=ag(a,ja),a=a!==null&&a.data!=="&"?a:null,a!==null&&(s.memoizedState={dehydrated:a,treeContext:oi!==null?{id:mn,overflow:xn}:null,retryLane:536870912,hydrationErrors:null},c=Cm(a),c.return=s,s.child=c,Rr=s,zt=null)):a=null,a===null)throw fi(s);return Bh(a)?s.lanes=32:s.lanes=536870912,null}var D=f.children;return f=f.fallback,m?(gi(),m=s.mode,D=h0({mode:"hidden",children:D},m),f=Ji(f,m,c,null),D.return=s,f.return=s,D.sibling=f,s.child=D,f=s.child,f.memoizedState=Qf(c),f.childLanes=Zf(a,S,c),s.memoizedState=Jf,gc(null,f)):(pi(s),eh(s,D))}var X=a.memoizedState;if(X!==null&&(D=X.dehydrated,D!==null)){if(p)s.flags&256?(pi(s),s.flags&=-257,s=th(a,s,c)):s.memoizedState!==null?(gi(),s.child=a.child,s.flags|=128,s=null):(gi(),D=f.fallback,m=s.mode,f=h0({mode:"visible",children:f.children},m),D=Ji(D,m,c,null),D.flags|=2,f.return=s,D.return=s,f.sibling=D,s.child=f,ns(s,a.child,null,c),f=s.child,f.memoizedState=Qf(c),f.childLanes=Zf(a,S,c),s.memoizedState=Jf,s=gc(null,f));else if(pi(s),Bh(D)){if(S=D.nextSibling&&D.nextSibling.dataset,S)var ue=S.dgst;S=ue,f=Error(n(419)),f.stack="",f.digest=S,ic({value:f,source:null,stack:null}),s=th(a,s,c)}else if(xr||Ks(a,s,c,!1),S=(c&a.childLanes)!==0,xr||S){if(S=It,S!==null&&(f=Re(S,c),f!==0&&f!==X.retryLane))throw X.retryLane=f,Yi(a,f),ua(S,a,f),Kf;Mh(D)||w0(),s=th(a,s,c)}else Mh(D)?(s.flags|=192,s.child=a.child,s=null):(a=X.treeContext,zt=za(D.nextSibling),Rr=s,mt=!0,ui=null,ja=!1,a!==null&&Rm(s,a),s=eh(s,f.children),s.flags|=4096);return s}return m?(gi(),D=f.fallback,m=s.mode,X=a.child,ue=X.sibling,f=Rn(X,{mode:"hidden",children:f.children}),f.subtreeFlags=X.subtreeFlags&65011712,ue!==null?D=Rn(ue,D):(D=Ji(D,m,c,null),D.flags|=2),D.return=s,f.return=s,f.sibling=D,s.child=f,gc(null,f),f=s.child,D=a.child.memoizedState,D===null?D=Qf(c):(m=D.cachePool,m!==null?(X=dr._currentValue,m=m.parent!==X?{parent:X,pool:X}:m):m=Im(),D={baseLanes:D.baseLanes|c,cachePool:m}),f.memoizedState=D,f.childLanes=Zf(a,S,c),s.memoizedState=Jf,gc(a.child,f)):(pi(s),c=a.child,a=c.sibling,c=Rn(c,{mode:"visible",children:f.children}),c.return=s,c.sibling=null,a!==null&&(S=s.deletions,S===null?(s.deletions=[a],s.flags|=16):S.push(a)),s.child=c,s.memoizedState=null,c)}function eh(a,s){return s=h0({mode:"visible",children:s},a.mode),s.return=a,a.child=s}function h0(a,s){return a=pa(22,a,null,s),a.lanes=0,a}function th(a,s,c){return ns(s,a.child,null,c),a=eh(s,s.pendingProps.children),a.flags|=2,s.memoizedState=null,a}function Yx(a,s,c){a.lanes|=s;var f=a.alternate;f!==null&&(f.lanes|=s),pf(a.return,s,c)}function rh(a,s,c,f,m,p){var S=a.memoizedState;S===null?a.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:f,tail:c,tailMode:m,treeForkCount:p}:(S.isBackwards=s,S.rendering=null,S.renderingStartTime=0,S.last=f,S.tail=c,S.tailMode=m,S.treeForkCount=p)}function Jx(a,s,c){var f=s.pendingProps,m=f.revealOrder,p=f.tail;f=f.children;var S=sr.current,D=(S&2)!==0;if(D?(S=S&1|2,s.flags|=128):S&=1,z(sr,S),Fr(a,s,f,c),f=mt?nc:0,!D&&a!==null&&(a.flags&128)!==0)e:for(a=s.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&Yx(a,c,s);else if(a.tag===19)Yx(a,c,s);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break e;for(;a.sibling===null;){if(a.return===null||a.return===s)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}switch(m){case"forwards":for(c=s.child,m=null;c!==null;)a=c.alternate,a!==null&&e0(a)===null&&(m=c),c=c.sibling;c=m,c===null?(m=s.child,s.child=null):(m=c.sibling,c.sibling=null),rh(s,!1,m,c,p,f);break;case"backwards":case"unstable_legacy-backwards":for(c=null,m=s.child,s.child=null;m!==null;){if(a=m.alternate,a!==null&&e0(a)===null){s.child=m;break}a=m.sibling,m.sibling=c,c=m,m=a}rh(s,!0,c,null,p,f);break;case"together":rh(s,!1,null,null,void 0,f);break;default:s.memoizedState=null}return s.child}function In(a,s,c){if(a!==null&&(s.dependencies=a.dependencies),_i|=s.lanes,(c&s.childLanes)===0)if(a!==null){if(Ks(a,s,c,!1),(c&s.childLanes)===0)return null}else return null;if(a!==null&&s.child!==a.child)throw Error(n(153));if(s.child!==null){for(a=s.child,c=Rn(a,a.pendingProps),s.child=c,c.return=s;a.sibling!==null;)a=a.sibling,c=c.sibling=Rn(a,a.pendingProps),c.return=s;c.sibling=null}return s.child}function ah(a,s){return(a.lanes&s)!==0?!0:(a=a.dependencies,!!(a!==null&&qo(a)))}function mS(a,s,c){switch(s.tag){case 3:Ce(s,s.stateNode.containerInfo),hi(s,dr,a.memoizedState.cache),Qi();break;case 27:case 5:Oe(s);break;case 4:Ce(s,s.stateNode.containerInfo);break;case 10:hi(s,s.type,s.memoizedProps.value);break;case 31:if(s.memoizedState!==null)return s.flags|=128,Cf(s),null;break;case 13:var f=s.memoizedState;if(f!==null)return f.dehydrated!==null?(pi(s),s.flags|=128,null):(c&s.child.childLanes)!==0?Kx(a,s,c):(pi(s),a=In(a,s,c),a!==null?a.sibling:null);pi(s);break;case 19:var m=(a.flags&128)!==0;if(f=(c&s.childLanes)!==0,f||(Ks(a,s,c,!1),f=(c&s.childLanes)!==0),m){if(f)return Jx(a,s,c);s.flags|=128}if(m=s.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),z(sr,sr.current),f)break;return null;case 22:return s.lanes=0,Vx(a,s,c,s.pendingProps);case 24:hi(s,dr,a.memoizedState.cache)}return In(a,s,c)}function Qx(a,s,c){if(a!==null)if(a.memoizedProps!==s.pendingProps)xr=!0;else{if(!ah(a,c)&&(s.flags&128)===0)return xr=!1,mS(a,s,c);xr=(a.flags&131072)!==0}else xr=!1,mt&&(s.flags&1048576)!==0&&Om(s,nc,s.index);switch(s.lanes=0,s.tag){case 16:e:{var f=s.pendingProps;if(a=rs(s.elementType),s.type=a,typeof a=="function")cf(a)?(f=ss(a,f),s.tag=1,s=Xx(null,s,a,f,c)):(s.tag=0,s=Yf(null,s,a,f,c));else{if(a!=null){var m=a.$$typeof;if(m===U){s.tag=11,s=Px(null,s,a,f,c);break e}else if(m===R){s.tag=14,s=zx(null,s,a,f,c);break e}}throw s=ke(a)||a,Error(n(306,s,""))}}return s;case 0:return Yf(a,s,s.type,s.pendingProps,c);case 1:return f=s.type,m=ss(f,s.pendingProps),Xx(a,s,f,m,c);case 3:e:{if(Ce(s,s.stateNode.containerInfo),a===null)throw Error(n(387));f=s.pendingProps;var p=s.memoizedState;m=p.element,bf(a,s),hc(s,f,null,c);var S=s.memoizedState;if(f=S.cache,hi(s,dr,f),f!==p.cache&&gf(s,[dr],c,!0),fc(),f=S.element,p.isDehydrated)if(p={element:f,isDehydrated:!1,cache:S.cache},s.updateQueue.baseState=p,s.memoizedState=p,s.flags&256){s=Wx(a,s,f,c);break e}else if(f!==m){m=La(Error(n(424)),s),ic(m),s=Wx(a,s,f,c);break e}else for(a=s.stateNode.containerInfo,a.nodeType===9?a=a.body:a=a.nodeName==="HTML"?a.ownerDocument.body:a,zt=za(a.firstChild),Rr=s,mt=!0,ui=null,ja=!0,c=Vm(s,null,f,c),s.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling;else{if(Qi(),f===m){s=In(a,s,c);break e}Fr(a,s,f,c)}s=s.child}return s;case 26:return f0(a,s),a===null?(c=og(s.type,null,s.pendingProps,null))?s.memoizedState=c:mt||(c=s.type,a=s.pendingProps,f=C0(ce.current).createElement(c),f[O]=s,f[B]=a,Mr(f,c,a),Pe(f),s.stateNode=f):s.memoizedState=og(s.type,a.memoizedProps,s.pendingProps,a.memoizedState),null;case 27:return Oe(s),a===null&&mt&&(f=s.stateNode=sg(s.type,s.pendingProps,ce.current),Rr=s,ja=!0,m=zt,Ti(s.type)?(Lh=m,zt=za(f.firstChild)):zt=m),Fr(a,s,s.pendingProps.children,c),f0(a,s),a===null&&(s.flags|=4194304),s.child;case 5:return a===null&&mt&&((m=f=zt)&&(f=$S(f,s.type,s.pendingProps,ja),f!==null?(s.stateNode=f,Rr=s,zt=za(f.firstChild),ja=!1,m=!0):m=!1),m||fi(s)),Oe(s),m=s.type,p=s.pendingProps,S=a!==null?a.memoizedProps:null,f=p.children,Rh(m,p)?f=null:S!==null&&Rh(m,S)&&(s.flags|=32),s.memoizedState!==null&&(m=Of(a,s,iS,null,null,c),Dc._currentValue=m),f0(a,s),Fr(a,s,f,c),s.child;case 6:return a===null&&mt&&((a=c=zt)&&(c=GS(c,s.pendingProps,ja),c!==null?(s.stateNode=c,Rr=s,zt=null,a=!0):a=!1),a||fi(s)),null;case 13:return Kx(a,s,c);case 4:return Ce(s,s.stateNode.containerInfo),f=s.pendingProps,a===null?s.child=ns(s,null,f,c):Fr(a,s,f,c),s.child;case 11:return Px(a,s,s.type,s.pendingProps,c);case 7:return Fr(a,s,s.pendingProps,c),s.child;case 8:return Fr(a,s,s.pendingProps.children,c),s.child;case 12:return Fr(a,s,s.pendingProps.children,c),s.child;case 10:return f=s.pendingProps,hi(s,s.type,f.value),Fr(a,s,f.children,c),s.child;case 9:return m=s.type._context,f=s.pendingProps.children,es(s),m=Dr(m),f=f(m),s.flags|=1,Fr(a,s,f,c),s.child;case 14:return zx(a,s,s.type,s.pendingProps,c);case 15:return Hx(a,s,s.type,s.pendingProps,c);case 19:return Jx(a,s,c);case 31:return dS(a,s,c);case 22:return Vx(a,s,c,s.pendingProps);case 24:return es(s),f=Dr(dr),a===null?(m=_f(),m===null&&(m=It,p=vf(),m.pooledCache=p,p.refCount++,p!==null&&(m.pooledCacheLanes|=c),m=p),s.memoizedState={parent:f,cache:m},Sf(s),hi(s,dr,m)):((a.lanes&c)!==0&&(bf(a,s),hc(s,null,null,c),fc()),m=a.memoizedState,p=s.memoizedState,m.parent!==f?(m={parent:f,cache:f},s.memoizedState=m,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=m),hi(s,dr,f)):(f=p.cache,hi(s,dr,f),f!==m.cache&&gf(s,[dr],c,!0))),Fr(a,s,s.pendingProps.children,c),s.child;case 29:throw s.pendingProps}throw Error(n(156,s.tag))}function Un(a){a.flags|=4}function nh(a,s,c,f,m){if((s=(a.mode&32)!==0)&&(s=!1),s){if(a.flags|=16777216,(m&335544128)===m)if(a.stateNode.complete)a.flags|=8192;else if(Tp())a.flags|=8192;else throw as=Yo,wf}else a.flags&=-16777217}function Zx(a,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)a.flags&=-16777217;else if(a.flags|=16777216,!mg(s))if(Tp())a.flags|=8192;else throw as=Yo,wf}function d0(a,s){s!==null&&(a.flags|=4),a.flags&16384&&(s=a.tag!==22?Bs():536870912,a.lanes|=s,ll|=s)}function vc(a,s){if(!mt)switch(a.tailMode){case"hidden":s=a.tail;for(var c=null;s!==null;)s.alternate!==null&&(c=s),s=s.sibling;c===null?a.tail=null:c.sibling=null;break;case"collapsed":c=a.tail;for(var f=null;c!==null;)c.alternate!==null&&(f=c),c=c.sibling;f===null?s||a.tail===null?a.tail=null:a.tail.sibling=null:f.sibling=null}}function Ht(a){var s=a.alternate!==null&&a.alternate.child===a.child,c=0,f=0;if(s)for(var m=a.child;m!==null;)c|=m.lanes|m.childLanes,f|=m.subtreeFlags&65011712,f|=m.flags&65011712,m.return=a,m=m.sibling;else for(m=a.child;m!==null;)c|=m.lanes|m.childLanes,f|=m.subtreeFlags,f|=m.flags,m.return=a,m=m.sibling;return a.subtreeFlags|=f,a.childLanes=c,s}function xS(a,s,c){var f=s.pendingProps;switch(hf(s),s.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ht(s),null;case 1:return Ht(s),null;case 3:return c=s.stateNode,f=null,a!==null&&(f=a.memoizedState.cache),s.memoizedState.cache!==f&&(s.flags|=2048),Mn(dr),Ee(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(a===null||a.child===null)&&(Ws(s)?Un(s):a===null||a.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,mf())),Ht(s),null;case 26:var m=s.type,p=s.memoizedState;return a===null?(Un(s),p!==null?(Ht(s),Zx(s,p)):(Ht(s),nh(s,m,null,f,c))):p?p!==a.memoizedState?(Un(s),Ht(s),Zx(s,p)):(Ht(s),s.flags&=-16777217):(a=a.memoizedProps,a!==f&&Un(s),Ht(s),nh(s,m,a,f,c)),null;case 27:if(Qe(s),c=ce.current,m=s.type,a!==null&&s.stateNode!=null)a.memoizedProps!==f&&Un(s);else{if(!f){if(s.stateNode===null)throw Error(n(166));return Ht(s),null}a=P.current,Ws(s)?Dm(s):(a=sg(m,f,c),s.stateNode=a,Un(s))}return Ht(s),null;case 5:if(Qe(s),m=s.type,a!==null&&s.stateNode!=null)a.memoizedProps!==f&&Un(s);else{if(!f){if(s.stateNode===null)throw Error(n(166));return Ht(s),null}if(p=P.current,Ws(s))Dm(s);else{var S=C0(ce.current);switch(p){case 1:p=S.createElementNS("http://www.w3.org/2000/svg",m);break;case 2:p=S.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;default:switch(m){case"svg":p=S.createElementNS("http://www.w3.org/2000/svg",m);break;case"math":p=S.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;case"script":p=S.createElement("div"),p.innerHTML="<script><\/script>",p=p.removeChild(p.firstChild);break;case"select":p=typeof f.is=="string"?S.createElement("select",{is:f.is}):S.createElement("select"),f.multiple?p.multiple=!0:f.size&&(p.size=f.size);break;default:p=typeof f.is=="string"?S.createElement(m,{is:f.is}):S.createElement(m)}}p[O]=s,p[B]=f;e:for(S=s.child;S!==null;){if(S.tag===5||S.tag===6)p.appendChild(S.stateNode);else if(S.tag!==4&&S.tag!==27&&S.child!==null){S.child.return=S,S=S.child;continue}if(S===s)break e;for(;S.sibling===null;){if(S.return===null||S.return===s)break e;S=S.return}S.sibling.return=S.return,S=S.sibling}s.stateNode=p;e:switch(Mr(p,m,f),m){case"button":case"input":case"select":case"textarea":f=!!f.autoFocus;break e;case"img":f=!0;break e;default:f=!1}f&&Un(s)}}return Ht(s),nh(s,s.type,a===null?null:a.memoizedProps,s.pendingProps,c),null;case 6:if(a&&s.stateNode!=null)a.memoizedProps!==f&&Un(s);else{if(typeof f!="string"&&s.stateNode===null)throw Error(n(166));if(a=ce.current,Ws(s)){if(a=s.stateNode,c=s.memoizedProps,f=null,m=Rr,m!==null)switch(m.tag){case 27:case 5:f=m.memoizedProps}a[O]=s,a=!!(a.nodeValue===c||f!==null&&f.suppressHydrationWarning===!0||Kp(a.nodeValue,c)),a||fi(s,!0)}else a=C0(a).createTextNode(f),a[O]=s,s.stateNode=a}return Ht(s),null;case 31:if(c=s.memoizedState,a===null||a.memoizedState!==null){if(f=Ws(s),c!==null){if(a===null){if(!f)throw Error(n(318));if(a=s.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(n(557));a[O]=s}else Qi(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;Ht(s),a=!1}else c=mf(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=c),a=!0;if(!a)return s.flags&256?(va(s),s):(va(s),null);if((s.flags&128)!==0)throw Error(n(558))}return Ht(s),null;case 13:if(f=s.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(m=Ws(s),f!==null&&f.dehydrated!==null){if(a===null){if(!m)throw Error(n(318));if(m=s.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(n(317));m[O]=s}else Qi(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;Ht(s),m=!1}else m=mf(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=m),m=!0;if(!m)return s.flags&256?(va(s),s):(va(s),null)}return va(s),(s.flags&128)!==0?(s.lanes=c,s):(c=f!==null,a=a!==null&&a.memoizedState!==null,c&&(f=s.child,m=null,f.alternate!==null&&f.alternate.memoizedState!==null&&f.alternate.memoizedState.cachePool!==null&&(m=f.alternate.memoizedState.cachePool.pool),p=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(p=f.memoizedState.cachePool.pool),p!==m&&(f.flags|=2048)),c!==a&&c&&(s.child.flags|=8192),d0(s,s.updateQueue),Ht(s),null);case 4:return Ee(),a===null&&kh(s.stateNode.containerInfo),Ht(s),null;case 10:return Mn(s.type),Ht(s),null;case 19:if(N(sr),f=s.memoizedState,f===null)return Ht(s),null;if(m=(s.flags&128)!==0,p=f.rendering,p===null)if(m)vc(f,!1);else{if(tr!==0||a!==null&&(a.flags&128)!==0)for(a=s.child;a!==null;){if(p=e0(a),p!==null){for(s.flags|=128,vc(f,!1),a=p.updateQueue,s.updateQueue=a,d0(s,a),s.subtreeFlags=0,a=c,c=s.child;c!==null;)Am(c,a),c=c.sibling;return z(sr,sr.current&1|2),mt&&Dn(s,f.treeForkCount),s.child}a=a.sibling}f.tail!==null&&bt()>v0&&(s.flags|=128,m=!0,vc(f,!1),s.lanes=4194304)}else{if(!m)if(a=e0(p),a!==null){if(s.flags|=128,m=!0,a=a.updateQueue,s.updateQueue=a,d0(s,a),vc(f,!0),f.tail===null&&f.tailMode==="hidden"&&!p.alternate&&!mt)return Ht(s),null}else 2*bt()-f.renderingStartTime>v0&&c!==536870912&&(s.flags|=128,m=!0,vc(f,!1),s.lanes=4194304);f.isBackwards?(p.sibling=s.child,s.child=p):(a=f.last,a!==null?a.sibling=p:s.child=p,f.last=p)}return f.tail!==null?(a=f.tail,f.rendering=a,f.tail=a.sibling,f.renderingStartTime=bt(),a.sibling=null,c=sr.current,z(sr,m?c&1|2:c&1),mt&&Dn(s,f.treeForkCount),a):(Ht(s),null);case 22:case 23:return va(s),Af(),f=s.memoizedState!==null,a!==null?a.memoizedState!==null!==f&&(s.flags|=8192):f&&(s.flags|=8192),f?(c&536870912)!==0&&(s.flags&128)===0&&(Ht(s),s.subtreeFlags&6&&(s.flags|=8192)):Ht(s),c=s.updateQueue,c!==null&&d0(s,c.retryQueue),c=null,a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(c=a.memoizedState.cachePool.pool),f=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(f=s.memoizedState.cachePool.pool),f!==c&&(s.flags|=2048),a!==null&&N(ts),null;case 24:return c=null,a!==null&&(c=a.memoizedState.cache),s.memoizedState.cache!==c&&(s.flags|=2048),Mn(dr),Ht(s),null;case 25:return null;case 30:return null}throw Error(n(156,s.tag))}function pS(a,s){switch(hf(s),s.tag){case 1:return a=s.flags,a&65536?(s.flags=a&-65537|128,s):null;case 3:return Mn(dr),Ee(),a=s.flags,(a&65536)!==0&&(a&128)===0?(s.flags=a&-65537|128,s):null;case 26:case 27:case 5:return Qe(s),null;case 31:if(s.memoizedState!==null){if(va(s),s.alternate===null)throw Error(n(340));Qi()}return a=s.flags,a&65536?(s.flags=a&-65537|128,s):null;case 13:if(va(s),a=s.memoizedState,a!==null&&a.dehydrated!==null){if(s.alternate===null)throw Error(n(340));Qi()}return a=s.flags,a&65536?(s.flags=a&-65537|128,s):null;case 19:return N(sr),null;case 4:return Ee(),null;case 10:return Mn(s.type),null;case 22:case 23:return va(s),Af(),a!==null&&N(ts),a=s.flags,a&65536?(s.flags=a&-65537|128,s):null;case 24:return Mn(dr),null;case 25:return null;default:return null}}function ep(a,s){switch(hf(s),s.tag){case 3:Mn(dr),Ee();break;case 26:case 27:case 5:Qe(s);break;case 4:Ee();break;case 31:s.memoizedState!==null&&va(s);break;case 13:va(s);break;case 19:N(sr);break;case 10:Mn(s.type);break;case 22:case 23:va(s),Af(),a!==null&&N(ts);break;case 24:Mn(dr)}}function yc(a,s){try{var c=s.updateQueue,f=c!==null?c.lastEffect:null;if(f!==null){var m=f.next;c=m;do{if((c.tag&a)===a){f=void 0;var p=c.create,S=c.inst;f=p(),S.destroy=f}c=c.next}while(c!==m)}}catch(D){At(s,s.return,D)}}function vi(a,s,c){try{var f=s.updateQueue,m=f!==null?f.lastEffect:null;if(m!==null){var p=m.next;f=p;do{if((f.tag&a)===a){var S=f.inst,D=S.destroy;if(D!==void 0){S.destroy=void 0,m=s;var X=c,ue=D;try{ue()}catch(ye){At(m,X,ye)}}}f=f.next}while(f!==p)}}catch(ye){At(s,s.return,ye)}}function tp(a){var s=a.updateQueue;if(s!==null){var c=a.stateNode;try{Gm(s,c)}catch(f){At(a,a.return,f)}}}function rp(a,s,c){c.props=ss(a.type,a.memoizedProps),c.state=a.memoizedState;try{c.componentWillUnmount()}catch(f){At(a,s,f)}}function _c(a,s){try{var c=a.ref;if(c!==null){switch(a.tag){case 26:case 27:case 5:var f=a.stateNode;break;case 30:f=a.stateNode;break;default:f=a.stateNode}typeof c=="function"?a.refCleanup=c(f):c.current=f}}catch(m){At(a,s,m)}}function pn(a,s){var c=a.ref,f=a.refCleanup;if(c!==null)if(typeof f=="function")try{f()}catch(m){At(a,s,m)}finally{a.refCleanup=null,a=a.alternate,a!=null&&(a.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(m){At(a,s,m)}else c.current=null}function ap(a){var s=a.type,c=a.memoizedProps,f=a.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":c.autoFocus&&f.focus();break e;case"img":c.src?f.src=c.src:c.srcSet&&(f.srcset=c.srcSet)}}catch(m){At(a,a.return,m)}}function ih(a,s,c){try{var f=a.stateNode;US(f,a.type,c,s),f[B]=s}catch(m){At(a,a.return,m)}}function np(a){return a.tag===5||a.tag===3||a.tag===26||a.tag===27&&Ti(a.type)||a.tag===4}function sh(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||np(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.tag===27&&Ti(a.type)||a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function lh(a,s,c){var f=a.tag;if(f===5||f===6)a=a.stateNode,s?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(a,s):(s=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,s.appendChild(a),c=c._reactRootContainer,c!=null||s.onclick!==null||(s.onclick=Nn));else if(f!==4&&(f===27&&Ti(a.type)&&(c=a.stateNode,s=null),a=a.child,a!==null))for(lh(a,s,c),a=a.sibling;a!==null;)lh(a,s,c),a=a.sibling}function m0(a,s,c){var f=a.tag;if(f===5||f===6)a=a.stateNode,s?c.insertBefore(a,s):c.appendChild(a);else if(f!==4&&(f===27&&Ti(a.type)&&(c=a.stateNode),a=a.child,a!==null))for(m0(a,s,c),a=a.sibling;a!==null;)m0(a,s,c),a=a.sibling}function ip(a){var s=a.stateNode,c=a.memoizedProps;try{for(var f=a.type,m=s.attributes;m.length;)s.removeAttributeNode(m[0]);Mr(s,f,c),s[O]=a,s[B]=c}catch(p){At(a,a.return,p)}}var jn=!1,pr=!1,ch=!1,sp=typeof WeakSet=="function"?WeakSet:Set,kr=null;function gS(a,s){if(a=a.containerInfo,Nh=B0,a=vm(a),ef(a)){if("selectionStart"in a)var c={start:a.selectionStart,end:a.selectionEnd};else e:{c=(c=a.ownerDocument)&&c.defaultView||window;var f=c.getSelection&&c.getSelection();if(f&&f.rangeCount!==0){c=f.anchorNode;var m=f.anchorOffset,p=f.focusNode;f=f.focusOffset;try{c.nodeType,p.nodeType}catch{c=null;break e}var S=0,D=-1,X=-1,ue=0,ye=0,Te=a,fe=null;t:for(;;){for(var de;Te!==c||m!==0&&Te.nodeType!==3||(D=S+m),Te!==p||f!==0&&Te.nodeType!==3||(X=S+f),Te.nodeType===3&&(S+=Te.nodeValue.length),(de=Te.firstChild)!==null;)fe=Te,Te=de;for(;;){if(Te===a)break t;if(fe===c&&++ue===m&&(D=S),fe===p&&++ye===f&&(X=S),(de=Te.nextSibling)!==null)break;Te=fe,fe=Te.parentNode}Te=de}c=D===-1||X===-1?null:{start:D,end:X}}else c=null}c=c||{start:0,end:0}}else c=null;for(Oh={focusedElem:a,selectionRange:c},B0=!1,kr=s;kr!==null;)if(s=kr,a=s.child,(s.subtreeFlags&1028)!==0&&a!==null)a.return=s,kr=a;else for(;kr!==null;){switch(s=kr,p=s.alternate,a=s.flags,s.tag){case 0:if((a&4)!==0&&(a=s.updateQueue,a=a!==null?a.events:null,a!==null))for(c=0;c<a.length;c++)m=a[c],m.ref.impl=m.nextImpl;break;case 11:case 15:break;case 1:if((a&1024)!==0&&p!==null){a=void 0,c=s,m=p.memoizedProps,p=p.memoizedState,f=c.stateNode;try{var ze=ss(c.type,m);a=f.getSnapshotBeforeUpdate(ze,p),f.__reactInternalSnapshotBeforeUpdate=a}catch(Xe){At(c,c.return,Xe)}}break;case 3:if((a&1024)!==0){if(a=s.stateNode.containerInfo,c=a.nodeType,c===9)Fh(a);else if(c===1)switch(a.nodeName){case"HEAD":case"HTML":case"BODY":Fh(a);break;default:a.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((a&1024)!==0)throw Error(n(163))}if(a=s.sibling,a!==null){a.return=s.return,kr=a;break}kr=s.return}}function lp(a,s,c){var f=c.flags;switch(c.tag){case 0:case 11:case 15:zn(a,c),f&4&&yc(5,c);break;case 1:if(zn(a,c),f&4)if(a=c.stateNode,s===null)try{a.componentDidMount()}catch(S){At(c,c.return,S)}else{var m=ss(c.type,s.memoizedProps);s=s.memoizedState;try{a.componentDidUpdate(m,s,a.__reactInternalSnapshotBeforeUpdate)}catch(S){At(c,c.return,S)}}f&64&&tp(c),f&512&&_c(c,c.return);break;case 3:if(zn(a,c),f&64&&(a=c.updateQueue,a!==null)){if(s=null,c.child!==null)switch(c.child.tag){case 27:case 5:s=c.child.stateNode;break;case 1:s=c.child.stateNode}try{Gm(a,s)}catch(S){At(c,c.return,S)}}break;case 27:s===null&&f&4&&ip(c);case 26:case 5:zn(a,c),s===null&&f&4&&ap(c),f&512&&_c(c,c.return);break;case 12:zn(a,c);break;case 31:zn(a,c),f&4&&up(a,c);break;case 13:zn(a,c),f&4&&fp(a,c),f&64&&(a=c.memoizedState,a!==null&&(a=a.dehydrated,a!==null&&(c=kS.bind(null,c),qS(a,c))));break;case 22:if(f=c.memoizedState!==null||jn,!f){s=s!==null&&s.memoizedState!==null||pr,m=jn;var p=pr;jn=f,(pr=s)&&!p?Hn(a,c,(c.subtreeFlags&8772)!==0):zn(a,c),jn=m,pr=p}break;case 30:break;default:zn(a,c)}}function cp(a){var s=a.alternate;s!==null&&(a.alternate=null,cp(s)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(s=a.stateNode,s!==null&&ve(s)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}var Yt=null,sa=!1;function Pn(a,s,c){for(c=c.child;c!==null;)op(a,s,c),c=c.sibling}function op(a,s,c){if(Tt&&typeof Tt.onCommitFiberUnmount=="function")try{Tt.onCommitFiberUnmount(Et,c)}catch{}switch(c.tag){case 26:pr||pn(c,s),Pn(a,s,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:pr||pn(c,s);var f=Yt,m=sa;Ti(c.type)&&(Yt=c.stateNode,sa=!1),Pn(a,s,c),Nc(c.stateNode),Yt=f,sa=m;break;case 5:pr||pn(c,s);case 6:if(f=Yt,m=sa,Yt=null,Pn(a,s,c),Yt=f,sa=m,Yt!==null)if(sa)try{(Yt.nodeType===9?Yt.body:Yt.nodeName==="HTML"?Yt.ownerDocument.body:Yt).removeChild(c.stateNode)}catch(p){At(c,s,p)}else try{Yt.removeChild(c.stateNode)}catch(p){At(c,s,p)}break;case 18:Yt!==null&&(sa?(a=Yt,tg(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,c.stateNode),xl(a)):tg(Yt,c.stateNode));break;case 4:f=Yt,m=sa,Yt=c.stateNode.containerInfo,sa=!0,Pn(a,s,c),Yt=f,sa=m;break;case 0:case 11:case 14:case 15:vi(2,c,s),pr||vi(4,c,s),Pn(a,s,c);break;case 1:pr||(pn(c,s),f=c.stateNode,typeof f.componentWillUnmount=="function"&&rp(c,s,f)),Pn(a,s,c);break;case 21:Pn(a,s,c);break;case 22:pr=(f=pr)||c.memoizedState!==null,Pn(a,s,c),pr=f;break;default:Pn(a,s,c)}}function up(a,s){if(s.memoizedState===null&&(a=s.alternate,a!==null&&(a=a.memoizedState,a!==null))){a=a.dehydrated;try{xl(a)}catch(c){At(s,s.return,c)}}}function fp(a,s){if(s.memoizedState===null&&(a=s.alternate,a!==null&&(a=a.memoizedState,a!==null&&(a=a.dehydrated,a!==null))))try{xl(a)}catch(c){At(s,s.return,c)}}function vS(a){switch(a.tag){case 31:case 13:case 19:var s=a.stateNode;return s===null&&(s=a.stateNode=new sp),s;case 22:return a=a.stateNode,s=a._retryCache,s===null&&(s=a._retryCache=new sp),s;default:throw Error(n(435,a.tag))}}function x0(a,s){var c=vS(a);s.forEach(function(f){if(!c.has(f)){c.add(f);var m=AS.bind(null,a,f);f.then(m,m)}})}function la(a,s){var c=s.deletions;if(c!==null)for(var f=0;f<c.length;f++){var m=c[f],p=a,S=s,D=S;e:for(;D!==null;){switch(D.tag){case 27:if(Ti(D.type)){Yt=D.stateNode,sa=!1;break e}break;case 5:Yt=D.stateNode,sa=!1;break e;case 3:case 4:Yt=D.stateNode.containerInfo,sa=!0;break e}D=D.return}if(Yt===null)throw Error(n(160));op(p,S,m),Yt=null,sa=!1,p=m.alternate,p!==null&&(p.return=null),m.return=null}if(s.subtreeFlags&13886)for(s=s.child;s!==null;)hp(s,a),s=s.sibling}var en=null;function hp(a,s){var c=a.alternate,f=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:la(s,a),ca(a),f&4&&(vi(3,a,a.return),yc(3,a),vi(5,a,a.return));break;case 1:la(s,a),ca(a),f&512&&(pr||c===null||pn(c,c.return)),f&64&&jn&&(a=a.updateQueue,a!==null&&(f=a.callbacks,f!==null&&(c=a.shared.hiddenCallbacks,a.shared.hiddenCallbacks=c===null?f:c.concat(f))));break;case 26:var m=en;if(la(s,a),ca(a),f&512&&(pr||c===null||pn(c,c.return)),f&4){var p=c!==null?c.memoizedState:null;if(f=a.memoizedState,c===null)if(f===null)if(a.stateNode===null){e:{f=a.type,c=a.memoizedProps,m=m.ownerDocument||m;t:switch(f){case"title":p=m.getElementsByTagName("title")[0],(!p||p[te]||p[O]||p.namespaceURI==="http://www.w3.org/2000/svg"||p.hasAttribute("itemprop"))&&(p=m.createElement(f),m.head.insertBefore(p,m.querySelector("head > title"))),Mr(p,f,c),p[O]=a,Pe(p),f=p;break e;case"link":var S=hg("link","href",m).get(f+(c.href||""));if(S){for(var D=0;D<S.length;D++)if(p=S[D],p.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&p.getAttribute("rel")===(c.rel==null?null:c.rel)&&p.getAttribute("title")===(c.title==null?null:c.title)&&p.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){S.splice(D,1);break t}}p=m.createElement(f),Mr(p,f,c),m.head.appendChild(p);break;case"meta":if(S=hg("meta","content",m).get(f+(c.content||""))){for(D=0;D<S.length;D++)if(p=S[D],p.getAttribute("content")===(c.content==null?null:""+c.content)&&p.getAttribute("name")===(c.name==null?null:c.name)&&p.getAttribute("property")===(c.property==null?null:c.property)&&p.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&p.getAttribute("charset")===(c.charSet==null?null:c.charSet)){S.splice(D,1);break t}}p=m.createElement(f),Mr(p,f,c),m.head.appendChild(p);break;default:throw Error(n(468,f))}p[O]=a,Pe(p),f=p}a.stateNode=f}else dg(m,a.type,a.stateNode);else a.stateNode=fg(m,f,a.memoizedProps);else p!==f?(p===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):p.count--,f===null?dg(m,a.type,a.stateNode):fg(m,f,a.memoizedProps)):f===null&&a.stateNode!==null&&ih(a,a.memoizedProps,c.memoizedProps)}break;case 27:la(s,a),ca(a),f&512&&(pr||c===null||pn(c,c.return)),c!==null&&f&4&&ih(a,a.memoizedProps,c.memoizedProps);break;case 5:if(la(s,a),ca(a),f&512&&(pr||c===null||pn(c,c.return)),a.flags&32){m=a.stateNode;try{Us(m,"")}catch(ze){At(a,a.return,ze)}}f&4&&a.stateNode!=null&&(m=a.memoizedProps,ih(a,m,c!==null?c.memoizedProps:m)),f&1024&&(ch=!0);break;case 6:if(la(s,a),ca(a),f&4){if(a.stateNode===null)throw Error(n(162));f=a.memoizedProps,c=a.stateNode;try{c.nodeValue=f}catch(ze){At(a,a.return,ze)}}break;case 3:if(R0=null,m=en,en=N0(s.containerInfo),la(s,a),en=m,ca(a),f&4&&c!==null&&c.memoizedState.isDehydrated)try{xl(s.containerInfo)}catch(ze){At(a,a.return,ze)}ch&&(ch=!1,dp(a));break;case 4:f=en,en=N0(a.stateNode.containerInfo),la(s,a),ca(a),en=f;break;case 12:la(s,a),ca(a);break;case 31:la(s,a),ca(a),f&4&&(f=a.updateQueue,f!==null&&(a.updateQueue=null,x0(a,f)));break;case 13:la(s,a),ca(a),a.child.flags&8192&&a.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(g0=bt()),f&4&&(f=a.updateQueue,f!==null&&(a.updateQueue=null,x0(a,f)));break;case 22:m=a.memoizedState!==null;var X=c!==null&&c.memoizedState!==null,ue=jn,ye=pr;if(jn=ue||m,pr=ye||X,la(s,a),pr=ye,jn=ue,ca(a),f&8192)e:for(s=a.stateNode,s._visibility=m?s._visibility&-2:s._visibility|1,m&&(c===null||X||jn||pr||ls(a)),c=null,s=a;;){if(s.tag===5||s.tag===26){if(c===null){X=c=s;try{if(p=X.stateNode,m)S=p.style,typeof S.setProperty=="function"?S.setProperty("display","none","important"):S.display="none";else{D=X.stateNode;var Te=X.memoizedProps.style,fe=Te!=null&&Te.hasOwnProperty("display")?Te.display:null;D.style.display=fe==null||typeof fe=="boolean"?"":(""+fe).trim()}}catch(ze){At(X,X.return,ze)}}}else if(s.tag===6){if(c===null){X=s;try{X.stateNode.nodeValue=m?"":X.memoizedProps}catch(ze){At(X,X.return,ze)}}}else if(s.tag===18){if(c===null){X=s;try{var de=X.stateNode;m?rg(de,!0):rg(X.stateNode,!1)}catch(ze){At(X,X.return,ze)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===a)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break e;for(;s.sibling===null;){if(s.return===null||s.return===a)break e;c===s&&(c=null),s=s.return}c===s&&(c=null),s.sibling.return=s.return,s=s.sibling}f&4&&(f=a.updateQueue,f!==null&&(c=f.retryQueue,c!==null&&(f.retryQueue=null,x0(a,c))));break;case 19:la(s,a),ca(a),f&4&&(f=a.updateQueue,f!==null&&(a.updateQueue=null,x0(a,f)));break;case 30:break;case 21:break;default:la(s,a),ca(a)}}function ca(a){var s=a.flags;if(s&2){try{for(var c,f=a.return;f!==null;){if(np(f)){c=f;break}f=f.return}if(c==null)throw Error(n(160));switch(c.tag){case 27:var m=c.stateNode,p=sh(a);m0(a,p,m);break;case 5:var S=c.stateNode;c.flags&32&&(Us(S,""),c.flags&=-33);var D=sh(a);m0(a,D,S);break;case 3:case 4:var X=c.stateNode.containerInfo,ue=sh(a);lh(a,ue,X);break;default:throw Error(n(161))}}catch(ye){At(a,a.return,ye)}a.flags&=-3}s&4096&&(a.flags&=-4097)}function dp(a){if(a.subtreeFlags&1024)for(a=a.child;a!==null;){var s=a;dp(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),a=a.sibling}}function zn(a,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)lp(a,s.alternate,s),s=s.sibling}function ls(a){for(a=a.child;a!==null;){var s=a;switch(s.tag){case 0:case 11:case 14:case 15:vi(4,s,s.return),ls(s);break;case 1:pn(s,s.return);var c=s.stateNode;typeof c.componentWillUnmount=="function"&&rp(s,s.return,c),ls(s);break;case 27:Nc(s.stateNode);case 26:case 5:pn(s,s.return),ls(s);break;case 22:s.memoizedState===null&&ls(s);break;case 30:ls(s);break;default:ls(s)}a=a.sibling}}function Hn(a,s,c){for(c=c&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var f=s.alternate,m=a,p=s,S=p.flags;switch(p.tag){case 0:case 11:case 15:Hn(m,p,c),yc(4,p);break;case 1:if(Hn(m,p,c),f=p,m=f.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch(ue){At(f,f.return,ue)}if(f=p,m=f.updateQueue,m!==null){var D=f.stateNode;try{var X=m.shared.hiddenCallbacks;if(X!==null)for(m.shared.hiddenCallbacks=null,m=0;m<X.length;m++)$m(X[m],D)}catch(ue){At(f,f.return,ue)}}c&&S&64&&tp(p),_c(p,p.return);break;case 27:ip(p);case 26:case 5:Hn(m,p,c),c&&f===null&&S&4&&ap(p),_c(p,p.return);break;case 12:Hn(m,p,c);break;case 31:Hn(m,p,c),c&&S&4&&up(m,p);break;case 13:Hn(m,p,c),c&&S&4&&fp(m,p);break;case 22:p.memoizedState===null&&Hn(m,p,c),_c(p,p.return);break;case 30:break;default:Hn(m,p,c)}s=s.sibling}}function oh(a,s){var c=null;a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(c=a.memoizedState.cachePool.pool),a=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(a=s.memoizedState.cachePool.pool),a!==c&&(a!=null&&a.refCount++,c!=null&&sc(c))}function uh(a,s){a=null,s.alternate!==null&&(a=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==a&&(s.refCount++,a!=null&&sc(a))}function tn(a,s,c,f){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)mp(a,s,c,f),s=s.sibling}function mp(a,s,c,f){var m=s.flags;switch(s.tag){case 0:case 11:case 15:tn(a,s,c,f),m&2048&&yc(9,s);break;case 1:tn(a,s,c,f);break;case 3:tn(a,s,c,f),m&2048&&(a=null,s.alternate!==null&&(a=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==a&&(s.refCount++,a!=null&&sc(a)));break;case 12:if(m&2048){tn(a,s,c,f),a=s.stateNode;try{var p=s.memoizedProps,S=p.id,D=p.onPostCommit;typeof D=="function"&&D(S,s.alternate===null?"mount":"update",a.passiveEffectDuration,-0)}catch(X){At(s,s.return,X)}}else tn(a,s,c,f);break;case 31:tn(a,s,c,f);break;case 13:tn(a,s,c,f);break;case 23:break;case 22:p=s.stateNode,S=s.alternate,s.memoizedState!==null?p._visibility&2?tn(a,s,c,f):wc(a,s):p._visibility&2?tn(a,s,c,f):(p._visibility|=2,nl(a,s,c,f,(s.subtreeFlags&10256)!==0||!1)),m&2048&&oh(S,s);break;case 24:tn(a,s,c,f),m&2048&&uh(s.alternate,s);break;default:tn(a,s,c,f)}}function nl(a,s,c,f,m){for(m=m&&((s.subtreeFlags&10256)!==0||!1),s=s.child;s!==null;){var p=a,S=s,D=c,X=f,ue=S.flags;switch(S.tag){case 0:case 11:case 15:nl(p,S,D,X,m),yc(8,S);break;case 23:break;case 22:var ye=S.stateNode;S.memoizedState!==null?ye._visibility&2?nl(p,S,D,X,m):wc(p,S):(ye._visibility|=2,nl(p,S,D,X,m)),m&&ue&2048&&oh(S.alternate,S);break;case 24:nl(p,S,D,X,m),m&&ue&2048&&uh(S.alternate,S);break;default:nl(p,S,D,X,m)}s=s.sibling}}function wc(a,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var c=a,f=s,m=f.flags;switch(f.tag){case 22:wc(c,f),m&2048&&oh(f.alternate,f);break;case 24:wc(c,f),m&2048&&uh(f.alternate,f);break;default:wc(c,f)}s=s.sibling}}var Sc=8192;function il(a,s,c){if(a.subtreeFlags&Sc)for(a=a.child;a!==null;)xp(a,s,c),a=a.sibling}function xp(a,s,c){switch(a.tag){case 26:il(a,s,c),a.flags&Sc&&a.memoizedState!==null&&nb(c,en,a.memoizedState,a.memoizedProps);break;case 5:il(a,s,c);break;case 3:case 4:var f=en;en=N0(a.stateNode.containerInfo),il(a,s,c),en=f;break;case 22:a.memoizedState===null&&(f=a.alternate,f!==null&&f.memoizedState!==null?(f=Sc,Sc=16777216,il(a,s,c),Sc=f):il(a,s,c));break;default:il(a,s,c)}}function pp(a){var s=a.alternate;if(s!==null&&(a=s.child,a!==null)){s.child=null;do s=a.sibling,a.sibling=null,a=s;while(a!==null)}}function bc(a){var s=a.deletions;if((a.flags&16)!==0){if(s!==null)for(var c=0;c<s.length;c++){var f=s[c];kr=f,vp(f,a)}pp(a)}if(a.subtreeFlags&10256)for(a=a.child;a!==null;)gp(a),a=a.sibling}function gp(a){switch(a.tag){case 0:case 11:case 15:bc(a),a.flags&2048&&vi(9,a,a.return);break;case 3:bc(a);break;case 12:bc(a);break;case 22:var s=a.stateNode;a.memoizedState!==null&&s._visibility&2&&(a.return===null||a.return.tag!==13)?(s._visibility&=-3,p0(a)):bc(a);break;default:bc(a)}}function p0(a){var s=a.deletions;if((a.flags&16)!==0){if(s!==null)for(var c=0;c<s.length;c++){var f=s[c];kr=f,vp(f,a)}pp(a)}for(a=a.child;a!==null;){switch(s=a,s.tag){case 0:case 11:case 15:vi(8,s,s.return),p0(s);break;case 22:c=s.stateNode,c._visibility&2&&(c._visibility&=-3,p0(s));break;default:p0(s)}a=a.sibling}}function vp(a,s){for(;kr!==null;){var c=kr;switch(c.tag){case 0:case 11:case 15:vi(8,c,s);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var f=c.memoizedState.cachePool.pool;f!=null&&f.refCount++}break;case 24:sc(c.memoizedState.cache)}if(f=c.child,f!==null)f.return=c,kr=f;else e:for(c=a;kr!==null;){f=kr;var m=f.sibling,p=f.return;if(cp(f),f===c){kr=null;break e}if(m!==null){m.return=p,kr=m;break e}kr=p}}}var yS={getCacheForType:function(a){var s=Dr(dr),c=s.data.get(a);return c===void 0&&(c=a(),s.data.set(a,c)),c},cacheSignal:function(){return Dr(dr).controller.signal}},_S=typeof WeakMap=="function"?WeakMap:Map,wt=0,It=null,ut=null,ht=0,kt=0,ya=null,yi=!1,sl=!1,fh=!1,Vn=0,tr=0,_i=0,cs=0,hh=0,_a=0,ll=0,Ec=null,oa=null,dh=!1,g0=0,yp=0,v0=1/0,y0=null,wi=null,wr=0,Si=null,cl=null,$n=0,mh=0,xh=null,_p=null,Tc=0,ph=null;function wa(){return(wt&2)!==0&&ht!==0?ht&-ht:Y.T!==null?Sh():k()}function wp(){if(_a===0)if((ht&536870912)===0||mt){var a=ni;ni<<=1,(ni&3932160)===0&&(ni=262144),_a=a}else _a=536870912;return a=ga.current,a!==null&&(a.flags|=32),_a}function ua(a,s,c){(a===It&&(kt===2||kt===9)||a.cancelPendingCommit!==null)&&(ol(a,0),bi(a,ht,_a,!1)),Qa(a,c),((wt&2)===0||a!==It)&&(a===It&&((wt&2)===0&&(cs|=c),tr===4&&bi(a,ht,_a,!1)),gn(a))}function Sp(a,s,c){if((wt&6)!==0)throw Error(n(327));var f=!c&&(s&127)===0&&(s&a.expiredLanes)===0||An(a,s),m=f?bS(a,s):vh(a,s,!0),p=f;do{if(m===0){sl&&!f&&bi(a,s,0,!1);break}else{if(c=a.current.alternate,p&&!wS(c)){m=vh(a,s,!1),p=!1;continue}if(m===2){if(p=s,a.errorRecoveryDisabledLanes&p)var S=0;else S=a.pendingLanes&-536870913,S=S!==0?S:S&536870912?536870912:0;if(S!==0){s=S;e:{var D=a;m=Ec;var X=D.current.memoizedState.isDehydrated;if(X&&(ol(D,S).flags|=256),S=vh(D,S,!1),S!==2){if(fh&&!X){D.errorRecoveryDisabledLanes|=p,cs|=p,m=4;break e}p=oa,oa=m,p!==null&&(oa===null?oa=p:oa.push.apply(oa,p))}m=S}if(p=!1,m!==2)continue}}if(m===1){ol(a,0),bi(a,s,0,!0);break}e:{switch(f=a,p=m,p){case 0:case 1:throw Error(n(345));case 4:if((s&4194048)!==s)break;case 6:bi(f,s,_a,!yi);break e;case 2:oa=null;break;case 3:case 5:break;default:throw Error(n(329))}if((s&62914560)===s&&(m=g0+300-bt(),10<m)){if(bi(f,s,_a,!yi),si(f,0,!0)!==0)break e;$n=s,f.timeoutHandle=Zp(bp.bind(null,f,c,oa,y0,dh,s,_a,cs,ll,yi,p,"Throttled",-0,0),m);break e}bp(f,c,oa,y0,dh,s,_a,cs,ll,yi,p,null,-0,0)}}break}while(!0);gn(a)}function bp(a,s,c,f,m,p,S,D,X,ue,ye,Te,fe,de){if(a.timeoutHandle=-1,Te=s.subtreeFlags,Te&8192||(Te&16785408)===16785408){Te={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Nn},xp(s,p,Te);var ze=(p&62914560)===p?g0-bt():(p&4194048)===p?yp-bt():0;if(ze=ib(Te,ze),ze!==null){$n=p,a.cancelPendingCommit=ze(Rp.bind(null,a,s,p,c,f,m,S,D,X,ye,Te,null,fe,de)),bi(a,p,S,!ue);return}}Rp(a,s,p,c,f,m,S,D,X)}function wS(a){for(var s=a;;){var c=s.tag;if((c===0||c===11||c===15)&&s.flags&16384&&(c=s.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var f=0;f<c.length;f++){var m=c[f],p=m.getSnapshot;m=m.value;try{if(!xa(p(),m))return!1}catch{return!1}}if(c=s.child,s.subtreeFlags&16384&&c!==null)c.return=s,s=c;else{if(s===a)break;for(;s.sibling===null;){if(s.return===null||s.return===a)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function bi(a,s,c,f){s&=~hh,s&=~cs,a.suspendedLanes|=s,a.pingedLanes&=~s,f&&(a.warmLanes|=s),f=a.expirationTimes;for(var m=s;0<m;){var p=31-Wt(m),S=1<<p;f[p]=-1,m&=~S}c!==0&&he(a,c,s)}function _0(){return(wt&6)===0?(kc(0),!1):!0}function gh(){if(ut!==null){if(kt===0)var a=ut.return;else a=ut,Fn=Zi=null,Ff(a),Zs=null,cc=0,a=ut;for(;a!==null;)ep(a.alternate,a),a=a.return;ut=null}}function ol(a,s){var c=a.timeoutHandle;c!==-1&&(a.timeoutHandle=-1,zS(c)),c=a.cancelPendingCommit,c!==null&&(a.cancelPendingCommit=null,c()),$n=0,gh(),It=a,ut=c=Rn(a.current,null),ht=s,kt=0,ya=null,yi=!1,sl=An(a,s),fh=!1,ll=_a=hh=cs=_i=tr=0,oa=Ec=null,dh=!1,(s&8)!==0&&(s|=s&32);var f=a.entangledLanes;if(f!==0)for(a=a.entanglements,f&=s;0<f;){var m=31-Wt(f),p=1<<m;s|=a[m],f&=~p}return Vn=s,zo(),c}function Ep(a,s){nt=null,Y.H=pc,s===Qs||s===Ko?(s=Pm(),kt=3):s===wf?(s=Pm(),kt=4):kt=s===Kf?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,ya=s,ut===null&&(tr=1,o0(a,La(s,a.current)))}function Tp(){var a=ga.current;return a===null?!0:(ht&4194048)===ht?Pa===null:(ht&62914560)===ht||(ht&536870912)!==0?a===Pa:!1}function kp(){var a=Y.H;return Y.H=pc,a===null?pc:a}function Ap(){var a=Y.A;return Y.A=yS,a}function w0(){tr=4,yi||(ht&4194048)!==ht&&ga.current!==null||(sl=!0),(_i&134217727)===0&&(cs&134217727)===0||It===null||bi(It,ht,_a,!1)}function vh(a,s,c){var f=wt;wt|=2;var m=kp(),p=Ap();(It!==a||ht!==s)&&(y0=null,ol(a,s)),s=!1;var S=tr;e:do try{if(kt!==0&&ut!==null){var D=ut,X=ya;switch(kt){case 8:gh(),S=6;break e;case 3:case 2:case 9:case 6:ga.current===null&&(s=!0);var ue=kt;if(kt=0,ya=null,ul(a,D,X,ue),c&&sl){S=0;break e}break;default:ue=kt,kt=0,ya=null,ul(a,D,X,ue)}}SS(),S=tr;break}catch(ye){Ep(a,ye)}while(!0);return s&&a.shellSuspendCounter++,Fn=Zi=null,wt=f,Y.H=m,Y.A=p,ut===null&&(It=null,ht=0,zo()),S}function SS(){for(;ut!==null;)Cp(ut)}function bS(a,s){var c=wt;wt|=2;var f=kp(),m=Ap();It!==a||ht!==s?(y0=null,v0=bt()+500,ol(a,s)):sl=An(a,s);e:do try{if(kt!==0&&ut!==null){s=ut;var p=ya;t:switch(kt){case 1:kt=0,ya=null,ul(a,s,p,1);break;case 2:case 9:if(Um(p)){kt=0,ya=null,Np(s);break}s=function(){kt!==2&&kt!==9||It!==a||(kt=7),gn(a)},p.then(s,s);break e;case 3:kt=7;break e;case 4:kt=5;break e;case 7:Um(p)?(kt=0,ya=null,Np(s)):(kt=0,ya=null,ul(a,s,p,7));break;case 5:var S=null;switch(ut.tag){case 26:S=ut.memoizedState;case 5:case 27:var D=ut;if(S?mg(S):D.stateNode.complete){kt=0,ya=null;var X=D.sibling;if(X!==null)ut=X;else{var ue=D.return;ue!==null?(ut=ue,S0(ue)):ut=null}break t}}kt=0,ya=null,ul(a,s,p,5);break;case 6:kt=0,ya=null,ul(a,s,p,6);break;case 8:gh(),tr=6;break e;default:throw Error(n(462))}}ES();break}catch(ye){Ep(a,ye)}while(!0);return Fn=Zi=null,Y.H=f,Y.A=m,wt=c,ut!==null?0:(It=null,ht=0,zo(),tr)}function ES(){for(;ut!==null&&!Tn();)Cp(ut)}function Cp(a){var s=Qx(a.alternate,a,Vn);a.memoizedProps=a.pendingProps,s===null?S0(a):ut=s}function Np(a){var s=a,c=s.alternate;switch(s.tag){case 15:case 0:s=qx(c,s,s.pendingProps,s.type,void 0,ht);break;case 11:s=qx(c,s,s.pendingProps,s.type.render,s.ref,ht);break;case 5:Ff(s);default:ep(c,s),s=ut=Am(s,Vn),s=Qx(c,s,Vn)}a.memoizedProps=a.pendingProps,s===null?S0(a):ut=s}function ul(a,s,c,f){Fn=Zi=null,Ff(s),Zs=null,cc=0;var m=s.return;try{if(hS(a,m,s,c,ht)){tr=1,o0(a,La(c,a.current)),ut=null;return}}catch(p){if(m!==null)throw ut=m,p;tr=1,o0(a,La(c,a.current)),ut=null;return}s.flags&32768?(mt||f===1?a=!0:sl||(ht&536870912)!==0?a=!1:(yi=a=!0,(f===2||f===9||f===3||f===6)&&(f=ga.current,f!==null&&f.tag===13&&(f.flags|=16384))),Op(s,a)):S0(s)}function S0(a){var s=a;do{if((s.flags&32768)!==0){Op(s,yi);return}a=s.return;var c=xS(s.alternate,s,Vn);if(c!==null){ut=c;return}if(s=s.sibling,s!==null){ut=s;return}ut=s=a}while(s!==null);tr===0&&(tr=5)}function Op(a,s){do{var c=pS(a.alternate,a);if(c!==null){c.flags&=32767,ut=c;return}if(c=a.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!s&&(a=a.sibling,a!==null)){ut=a;return}ut=a=c}while(a!==null);tr=6,ut=null}function Rp(a,s,c,f,m,p,S,D,X){a.cancelPendingCommit=null;do b0();while(wr!==0);if((wt&6)!==0)throw Error(n(327));if(s!==null){if(s===a.current)throw Error(n(177));if(p=s.lanes|s.childLanes,p|=sf,Ls(a,c,p,S,D,X),a===It&&(ut=It=null,ht=0),cl=s,Si=a,$n=c,mh=p,xh=m,_p=f,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(a.callbackNode=null,a.callbackPriority=0,CS(Xt,function(){return Lp(),null})):(a.callbackNode=null,a.callbackPriority=0),f=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||f){f=Y.T,Y.T=null,m=le.p,le.p=2,S=wt,wt|=4;try{gS(a,s,c)}finally{wt=S,le.p=m,Y.T=f}}wr=1,Dp(),Fp(),Mp()}}function Dp(){if(wr===1){wr=0;var a=Si,s=cl,c=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||c){c=Y.T,Y.T=null;var f=le.p;le.p=2;var m=wt;wt|=4;try{hp(s,a);var p=Oh,S=vm(a.containerInfo),D=p.focusedElem,X=p.selectionRange;if(S!==D&&D&&D.ownerDocument&&gm(D.ownerDocument.documentElement,D)){if(X!==null&&ef(D)){var ue=X.start,ye=X.end;if(ye===void 0&&(ye=ue),"selectionStart"in D)D.selectionStart=ue,D.selectionEnd=Math.min(ye,D.value.length);else{var Te=D.ownerDocument||document,fe=Te&&Te.defaultView||window;if(fe.getSelection){var de=fe.getSelection(),ze=D.textContent.length,Xe=Math.min(X.start,ze),Bt=X.end===void 0?Xe:Math.min(X.end,ze);!de.extend&&Xe>Bt&&(S=Bt,Bt=Xe,Xe=S);var se=pm(D,Xe),ee=pm(D,Bt);if(se&&ee&&(de.rangeCount!==1||de.anchorNode!==se.node||de.anchorOffset!==se.offset||de.focusNode!==ee.node||de.focusOffset!==ee.offset)){var oe=Te.createRange();oe.setStart(se.node,se.offset),de.removeAllRanges(),Xe>Bt?(de.addRange(oe),de.extend(ee.node,ee.offset)):(oe.setEnd(ee.node,ee.offset),de.addRange(oe))}}}}for(Te=[],de=D;de=de.parentNode;)de.nodeType===1&&Te.push({element:de,left:de.scrollLeft,top:de.scrollTop});for(typeof D.focus=="function"&&D.focus(),D=0;D<Te.length;D++){var Se=Te[D];Se.element.scrollLeft=Se.left,Se.element.scrollTop=Se.top}}B0=!!Nh,Oh=Nh=null}finally{wt=m,le.p=f,Y.T=c}}a.current=s,wr=2}}function Fp(){if(wr===2){wr=0;var a=Si,s=cl,c=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||c){c=Y.T,Y.T=null;var f=le.p;le.p=2;var m=wt;wt|=4;try{lp(a,s.alternate,s)}finally{wt=m,le.p=f,Y.T=c}}wr=3}}function Mp(){if(wr===4||wr===3){wr=0,Ra();var a=Si,s=cl,c=$n,f=_p;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?wr=5:(wr=0,cl=Si=null,Bp(a,a.pendingLanes));var m=a.pendingLanes;if(m===0&&(wi=null),je(c),s=s.stateNode,Tt&&typeof Tt.onCommitFiberRoot=="function")try{Tt.onCommitFiberRoot(Et,s,void 0,(s.current.flags&128)===128)}catch{}if(f!==null){s=Y.T,m=le.p,le.p=2,Y.T=null;try{for(var p=a.onRecoverableError,S=0;S<f.length;S++){var D=f[S];p(D.value,{componentStack:D.stack})}}finally{Y.T=s,le.p=m}}($n&3)!==0&&b0(),gn(a),m=a.pendingLanes,(c&261930)!==0&&(m&42)!==0?a===ph?Tc++:(Tc=0,ph=a):Tc=0,kc(0)}}function Bp(a,s){(a.pooledCacheLanes&=s)===0&&(s=a.pooledCache,s!=null&&(a.pooledCache=null,sc(s)))}function b0(){return Dp(),Fp(),Mp(),Lp()}function Lp(){if(wr!==5)return!1;var a=Si,s=mh;mh=0;var c=je($n),f=Y.T,m=le.p;try{le.p=32>c?32:c,Y.T=null,c=xh,xh=null;var p=Si,S=$n;if(wr=0,cl=Si=null,$n=0,(wt&6)!==0)throw Error(n(331));var D=wt;if(wt|=4,gp(p.current),mp(p,p.current,S,c),wt=D,kc(0,!1),Tt&&typeof Tt.onPostCommitFiberRoot=="function")try{Tt.onPostCommitFiberRoot(Et,p)}catch{}return!0}finally{le.p=m,Y.T=f,Bp(a,s)}}function Ip(a,s,c){s=La(c,s),s=Wf(a.stateNode,s,2),a=xi(a,s,2),a!==null&&(Qa(a,2),gn(a))}function At(a,s,c){if(a.tag===3)Ip(a,a,c);else for(;s!==null;){if(s.tag===3){Ip(s,a,c);break}else if(s.tag===1){var f=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(wi===null||!wi.has(f))){a=La(c,a),c=Ux(2),f=xi(s,c,2),f!==null&&(jx(c,f,s,a),Qa(f,2),gn(f));break}}s=s.return}}function yh(a,s,c){var f=a.pingCache;if(f===null){f=a.pingCache=new _S;var m=new Set;f.set(s,m)}else m=f.get(s),m===void 0&&(m=new Set,f.set(s,m));m.has(c)||(fh=!0,m.add(c),a=TS.bind(null,a,s,c),s.then(a,a))}function TS(a,s,c){var f=a.pingCache;f!==null&&f.delete(s),a.pingedLanes|=a.suspendedLanes&c,a.warmLanes&=~c,It===a&&(ht&c)===c&&(tr===4||tr===3&&(ht&62914560)===ht&&300>bt()-g0?(wt&2)===0&&ol(a,0):hh|=c,ll===ht&&(ll=0)),gn(a)}function Up(a,s){s===0&&(s=Bs()),a=Yi(a,s),a!==null&&(Qa(a,s),gn(a))}function kS(a){var s=a.memoizedState,c=0;s!==null&&(c=s.retryLane),Up(a,c)}function AS(a,s){var c=0;switch(a.tag){case 31:case 13:var f=a.stateNode,m=a.memoizedState;m!==null&&(c=m.retryLane);break;case 19:f=a.stateNode;break;case 22:f=a.stateNode._retryCache;break;default:throw Error(n(314))}f!==null&&f.delete(s),Up(a,c)}function CS(a,s){return Pr(a,s)}var E0=null,fl=null,_h=!1,T0=!1,wh=!1,Ei=0;function gn(a){a!==fl&&a.next===null&&(fl===null?E0=fl=a:fl=fl.next=a),T0=!0,_h||(_h=!0,OS())}function kc(a,s){if(!wh&&T0){wh=!0;do for(var c=!1,f=E0;f!==null;){if(a!==0){var m=f.pendingLanes;if(m===0)var p=0;else{var S=f.suspendedLanes,D=f.pingedLanes;p=(1<<31-Wt(42|a)+1)-1,p&=m&~(S&~D),p=p&201326741?p&201326741|1:p?p|2:0}p!==0&&(c=!0,Hp(f,p))}else p=ht,p=si(f,f===It?p:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),(p&3)===0||An(f,p)||(c=!0,Hp(f,p));f=f.next}while(c);wh=!1}}function NS(){jp()}function jp(){T0=_h=!1;var a=0;Ei!==0&&PS()&&(a=Ei);for(var s=bt(),c=null,f=E0;f!==null;){var m=f.next,p=Pp(f,s);p===0?(f.next=null,c===null?E0=m:c.next=m,m===null&&(fl=c)):(c=f,(a!==0||(p&3)!==0)&&(T0=!0)),f=m}wr!==0&&wr!==5||kc(a),Ei!==0&&(Ei=0)}function Pp(a,s){for(var c=a.suspendedLanes,f=a.pingedLanes,m=a.expirationTimes,p=a.pendingLanes&-62914561;0<p;){var S=31-Wt(p),D=1<<S,X=m[S];X===-1?((D&c)===0||(D&f)!==0)&&(m[S]=Xl(D,s)):X<=s&&(a.expiredLanes|=D),p&=~D}if(s=It,c=ht,c=si(a,a===s?c:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),f=a.callbackNode,c===0||a===s&&(kt===2||kt===9)||a.cancelPendingCommit!==null)return f!==null&&f!==null&&Jr(f),a.callbackNode=null,a.callbackPriority=0;if((c&3)===0||An(a,c)){if(s=c&-c,s===a.callbackPriority)return s;switch(f!==null&&Jr(f),je(c)){case 2:case 8:c=hn;break;case 32:c=Xt;break;case 268435456:c=at;break;default:c=Xt}return f=zp.bind(null,a),c=Pr(c,f),a.callbackPriority=s,a.callbackNode=c,s}return f!==null&&f!==null&&Jr(f),a.callbackPriority=2,a.callbackNode=null,2}function zp(a,s){if(wr!==0&&wr!==5)return a.callbackNode=null,a.callbackPriority=0,null;var c=a.callbackNode;if(b0()&&a.callbackNode!==c)return null;var f=ht;return f=si(a,a===It?f:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),f===0?null:(Sp(a,f,s),Pp(a,bt()),a.callbackNode!=null&&a.callbackNode===c?zp.bind(null,a):null)}function Hp(a,s){if(b0())return null;Sp(a,s,!0)}function OS(){HS(function(){(wt&6)!==0?Pr(ma,NS):jp()})}function Sh(){if(Ei===0){var a=Ys;a===0&&(a=kn,kn<<=1,(kn&261888)===0&&(kn=256)),Ei=a}return Ei}function Vp(a){return a==null||typeof a=="symbol"||typeof a=="boolean"?null:typeof a=="function"?a:Fo(""+a)}function $p(a,s){var c=s.ownerDocument.createElement("input");return c.name=s.name,c.value=s.value,a.id&&c.setAttribute("form",a.id),s.parentNode.insertBefore(c,s),a=new FormData(a),c.parentNode.removeChild(c),a}function RS(a,s,c,f,m){if(s==="submit"&&c&&c.stateNode===m){var p=Vp((m[B]||null).action),S=f.submitter;S&&(s=(s=S[B]||null)?Vp(s.formAction):S.getAttribute("formAction"),s!==null&&(p=s,S=null));var D=new Io("action","action",null,f,m);a.push({event:D,listeners:[{instance:null,listener:function(){if(f.defaultPrevented){if(Ei!==0){var X=S?$p(m,S):new FormData(m);Hf(c,{pending:!0,data:X,method:m.method,action:p},null,X)}}else typeof p=="function"&&(D.preventDefault(),X=S?$p(m,S):new FormData(m),Hf(c,{pending:!0,data:X,method:m.method,action:p},p,X))},currentTarget:m}]})}}for(var bh=0;bh<nf.length;bh++){var Eh=nf[bh],DS=Eh.toLowerCase(),FS=Eh[0].toUpperCase()+Eh.slice(1);Za(DS,"on"+FS)}Za(wm,"onAnimationEnd"),Za(Sm,"onAnimationIteration"),Za(bm,"onAnimationStart"),Za("dblclick","onDoubleClick"),Za("focusin","onFocus"),Za("focusout","onBlur"),Za(Kw,"onTransitionRun"),Za(Yw,"onTransitionStart"),Za(Jw,"onTransitionCancel"),Za(Em,"onTransitionEnd"),Da("onMouseEnter",["mouseout","mouseover"]),Da("onMouseLeave",["mouseout","mouseover"]),Da("onPointerEnter",["pointerout","pointerover"]),Da("onPointerLeave",["pointerout","pointerover"]),Kt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Kt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Kt("onBeforeInput",["compositionend","keypress","textInput","paste"]),Kt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Kt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Kt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ac="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),MS=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ac));function Gp(a,s){s=(s&4)!==0;for(var c=0;c<a.length;c++){var f=a[c],m=f.event;f=f.listeners;e:{var p=void 0;if(s)for(var S=f.length-1;0<=S;S--){var D=f[S],X=D.instance,ue=D.currentTarget;if(D=D.listener,X!==p&&m.isPropagationStopped())break e;p=D,m.currentTarget=ue;try{p(m)}catch(ye){Po(ye)}m.currentTarget=null,p=X}else for(S=0;S<f.length;S++){if(D=f[S],X=D.instance,ue=D.currentTarget,D=D.listener,X!==p&&m.isPropagationStopped())break e;p=D,m.currentTarget=ue;try{p(m)}catch(ye){Po(ye)}m.currentTarget=null,p=X}}}}function ft(a,s){var c=s[re];c===void 0&&(c=s[re]=new Set);var f=a+"__bubble";c.has(f)||(qp(s,a,2,!1),c.add(f))}function Th(a,s,c){var f=0;s&&(f|=4),qp(c,a,f,s)}var k0="_reactListening"+Math.random().toString(36).slice(2);function kh(a){if(!a[k0]){a[k0]=!0,Rt.forEach(function(c){c!=="selectionchange"&&(MS.has(c)||Th(c,!1,a),Th(c,!0,a))});var s=a.nodeType===9?a:a.ownerDocument;s===null||s[k0]||(s[k0]=!0,Th("selectionchange",!1,s))}}function qp(a,s,c,f){switch(wg(s)){case 2:var m=cb;break;case 8:m=ob;break;default:m=zh}c=m.bind(null,s,c,a),m=void 0,!Gu||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(m=!0),f?m!==void 0?a.addEventListener(s,c,{capture:!0,passive:m}):a.addEventListener(s,c,!0):m!==void 0?a.addEventListener(s,c,{passive:m}):a.addEventListener(s,c,!1)}function Ah(a,s,c,f,m){var p=f;if((s&1)===0&&(s&2)===0&&f!==null)e:for(;;){if(f===null)return;var S=f.tag;if(S===3||S===4){var D=f.stateNode.containerInfo;if(D===m)break;if(S===4)for(S=f.return;S!==null;){var X=S.tag;if((X===3||X===4)&&S.stateNode.containerInfo===m)return;S=S.return}for(;D!==null;){if(S=me(D),S===null)return;if(X=S.tag,X===5||X===6||X===26||X===27){f=p=S;continue e}D=D.parentNode}}f=f.return}J1(function(){var ue=p,ye=Vu(c),Te=[];e:{var fe=Tm.get(a);if(fe!==void 0){var de=Io,ze=a;switch(a){case"keypress":if(Bo(c)===0)break e;case"keydown":case"keyup":de=Aw;break;case"focusin":ze="focus",de=Ku;break;case"focusout":ze="blur",de=Ku;break;case"beforeblur":case"afterblur":de=Ku;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":de=em;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":de=xw;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":de=Ow;break;case wm:case Sm:case bm:de=vw;break;case Em:de=Dw;break;case"scroll":case"scrollend":de=dw;break;case"wheel":de=Mw;break;case"copy":case"cut":case"paste":de=_w;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":de=rm;break;case"toggle":case"beforetoggle":de=Lw}var Xe=(s&4)!==0,Bt=!Xe&&(a==="scroll"||a==="scrollend"),se=Xe?fe!==null?fe+"Capture":null:fe;Xe=[];for(var ee=ue,oe;ee!==null;){var Se=ee;if(oe=Se.stateNode,Se=Se.tag,Se!==5&&Se!==26&&Se!==27||oe===null||se===null||(Se=Kl(ee,se),Se!=null&&Xe.push(Cc(ee,Se,oe))),Bt)break;ee=ee.return}0<Xe.length&&(fe=new de(fe,ze,null,c,ye),Te.push({event:fe,listeners:Xe}))}}if((s&7)===0){e:{if(fe=a==="mouseover"||a==="pointerover",de=a==="mouseout"||a==="pointerout",fe&&c!==Hu&&(ze=c.relatedTarget||c.fromElement)&&(me(ze)||ze[L]))break e;if((de||fe)&&(fe=ye.window===ye?ye:(fe=ye.ownerDocument)?fe.defaultView||fe.parentWindow:window,de?(ze=c.relatedTarget||c.toElement,de=ue,ze=ze?me(ze):null,ze!==null&&(Bt=l(ze),Xe=ze.tag,ze!==Bt||Xe!==5&&Xe!==27&&Xe!==6)&&(ze=null)):(de=null,ze=ue),de!==ze)){if(Xe=em,Se="onMouseLeave",se="onMouseEnter",ee="mouse",(a==="pointerout"||a==="pointerover")&&(Xe=rm,Se="onPointerLeave",se="onPointerEnter",ee="pointer"),Bt=de==null?fe:Ae(de),oe=ze==null?fe:Ae(ze),fe=new Xe(Se,ee+"leave",de,c,ye),fe.target=Bt,fe.relatedTarget=oe,Se=null,me(ye)===ue&&(Xe=new Xe(se,ee+"enter",ze,c,ye),Xe.target=oe,Xe.relatedTarget=Bt,Se=Xe),Bt=Se,de&&ze)t:{for(Xe=BS,se=de,ee=ze,oe=0,Se=se;Se;Se=Xe(Se))oe++;Se=0;for(var Ge=ee;Ge;Ge=Xe(Ge))Se++;for(;0<oe-Se;)se=Xe(se),oe--;for(;0<Se-oe;)ee=Xe(ee),Se--;for(;oe--;){if(se===ee||ee!==null&&se===ee.alternate){Xe=se;break t}se=Xe(se),ee=Xe(ee)}Xe=null}else Xe=null;de!==null&&Xp(Te,fe,de,Xe,!1),ze!==null&&Bt!==null&&Xp(Te,Bt,ze,Xe,!0)}}e:{if(fe=ue?Ae(ue):window,de=fe.nodeName&&fe.nodeName.toLowerCase(),de==="select"||de==="input"&&fe.type==="file")var vt=um;else if(cm(fe))if(fm)vt=qw;else{vt=$w;var He=Vw}else de=fe.nodeName,!de||de.toLowerCase()!=="input"||fe.type!=="checkbox"&&fe.type!=="radio"?ue&&zu(ue.elementType)&&(vt=um):vt=Gw;if(vt&&(vt=vt(a,ue))){om(Te,vt,c,ye);break e}He&&He(a,fe,ue),a==="focusout"&&ue&&fe.type==="number"&&ue.memoizedProps.value!=null&&Pu(fe,"number",fe.value)}switch(He=ue?Ae(ue):window,a){case"focusin":(cm(He)||He.contentEditable==="true")&&(Hs=He,tf=ue,ac=null);break;case"focusout":ac=tf=Hs=null;break;case"mousedown":rf=!0;break;case"contextmenu":case"mouseup":case"dragend":rf=!1,ym(Te,c,ye);break;case"selectionchange":if(Ww)break;case"keydown":case"keyup":ym(Te,c,ye)}var st;if(Ju)e:{switch(a){case"compositionstart":var dt="onCompositionStart";break e;case"compositionend":dt="onCompositionEnd";break e;case"compositionupdate":dt="onCompositionUpdate";break e}dt=void 0}else zs?sm(a,c)&&(dt="onCompositionEnd"):a==="keydown"&&c.keyCode===229&&(dt="onCompositionStart");dt&&(am&&c.locale!=="ko"&&(zs||dt!=="onCompositionStart"?dt==="onCompositionEnd"&&zs&&(st=Q1()):(ci=ye,qu="value"in ci?ci.value:ci.textContent,zs=!0)),He=A0(ue,dt),0<He.length&&(dt=new tm(dt,a,null,c,ye),Te.push({event:dt,listeners:He}),st?dt.data=st:(st=lm(c),st!==null&&(dt.data=st)))),(st=Uw?jw(a,c):Pw(a,c))&&(dt=A0(ue,"onBeforeInput"),0<dt.length&&(He=new tm("onBeforeInput","beforeinput",null,c,ye),Te.push({event:He,listeners:dt}),He.data=st)),RS(Te,a,ue,c,ye)}Gp(Te,s)})}function Cc(a,s,c){return{instance:a,listener:s,currentTarget:c}}function A0(a,s){for(var c=s+"Capture",f=[];a!==null;){var m=a,p=m.stateNode;if(m=m.tag,m!==5&&m!==26&&m!==27||p===null||(m=Kl(a,c),m!=null&&f.unshift(Cc(a,m,p)),m=Kl(a,s),m!=null&&f.push(Cc(a,m,p))),a.tag===3)return f;a=a.return}return[]}function BS(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5&&a.tag!==27);return a||null}function Xp(a,s,c,f,m){for(var p=s._reactName,S=[];c!==null&&c!==f;){var D=c,X=D.alternate,ue=D.stateNode;if(D=D.tag,X!==null&&X===f)break;D!==5&&D!==26&&D!==27||ue===null||(X=ue,m?(ue=Kl(c,p),ue!=null&&S.unshift(Cc(c,ue,X))):m||(ue=Kl(c,p),ue!=null&&S.push(Cc(c,ue,X)))),c=c.return}S.length!==0&&a.push({event:s,listeners:S})}var LS=/\r\n?/g,IS=/\u0000|\uFFFD/g;function Wp(a){return(typeof a=="string"?a:""+a).replace(LS,`
`).replace(IS,"")}function Kp(a,s){return s=Wp(s),Wp(a)===s}function Mt(a,s,c,f,m,p){switch(c){case"children":typeof f=="string"?s==="body"||s==="textarea"&&f===""||Us(a,f):(typeof f=="number"||typeof f=="bigint")&&s!=="body"&&Us(a,""+f);break;case"className":Ro(a,"class",f);break;case"tabIndex":Ro(a,"tabindex",f);break;case"dir":case"role":case"viewBox":case"width":case"height":Ro(a,c,f);break;case"style":K1(a,f,p);break;case"data":if(s!=="object"){Ro(a,"data",f);break}case"src":case"href":if(f===""&&(s!=="a"||c!=="href")){a.removeAttribute(c);break}if(f==null||typeof f=="function"||typeof f=="symbol"||typeof f=="boolean"){a.removeAttribute(c);break}f=Fo(""+f),a.setAttribute(c,f);break;case"action":case"formAction":if(typeof f=="function"){a.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof p=="function"&&(c==="formAction"?(s!=="input"&&Mt(a,s,"name",m.name,m,null),Mt(a,s,"formEncType",m.formEncType,m,null),Mt(a,s,"formMethod",m.formMethod,m,null),Mt(a,s,"formTarget",m.formTarget,m,null)):(Mt(a,s,"encType",m.encType,m,null),Mt(a,s,"method",m.method,m,null),Mt(a,s,"target",m.target,m,null)));if(f==null||typeof f=="symbol"||typeof f=="boolean"){a.removeAttribute(c);break}f=Fo(""+f),a.setAttribute(c,f);break;case"onClick":f!=null&&(a.onclick=Nn);break;case"onScroll":f!=null&&ft("scroll",a);break;case"onScrollEnd":f!=null&&ft("scrollend",a);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(n(61));if(c=f.__html,c!=null){if(m.children!=null)throw Error(n(60));a.innerHTML=c}}break;case"multiple":a.multiple=f&&typeof f!="function"&&typeof f!="symbol";break;case"muted":a.muted=f&&typeof f!="function"&&typeof f!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(f==null||typeof f=="function"||typeof f=="boolean"||typeof f=="symbol"){a.removeAttribute("xlink:href");break}c=Fo(""+f),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":f!=null&&typeof f!="function"&&typeof f!="symbol"?a.setAttribute(c,""+f):a.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":f&&typeof f!="function"&&typeof f!="symbol"?a.setAttribute(c,""):a.removeAttribute(c);break;case"capture":case"download":f===!0?a.setAttribute(c,""):f!==!1&&f!=null&&typeof f!="function"&&typeof f!="symbol"?a.setAttribute(c,f):a.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":f!=null&&typeof f!="function"&&typeof f!="symbol"&&!isNaN(f)&&1<=f?a.setAttribute(c,f):a.removeAttribute(c);break;case"rowSpan":case"start":f==null||typeof f=="function"||typeof f=="symbol"||isNaN(f)?a.removeAttribute(c):a.setAttribute(c,f);break;case"popover":ft("beforetoggle",a),ft("toggle",a),na(a,"popover",f);break;case"xlinkActuate":Cn(a,"http://www.w3.org/1999/xlink","xlink:actuate",f);break;case"xlinkArcrole":Cn(a,"http://www.w3.org/1999/xlink","xlink:arcrole",f);break;case"xlinkRole":Cn(a,"http://www.w3.org/1999/xlink","xlink:role",f);break;case"xlinkShow":Cn(a,"http://www.w3.org/1999/xlink","xlink:show",f);break;case"xlinkTitle":Cn(a,"http://www.w3.org/1999/xlink","xlink:title",f);break;case"xlinkType":Cn(a,"http://www.w3.org/1999/xlink","xlink:type",f);break;case"xmlBase":Cn(a,"http://www.w3.org/XML/1998/namespace","xml:base",f);break;case"xmlLang":Cn(a,"http://www.w3.org/XML/1998/namespace","xml:lang",f);break;case"xmlSpace":Cn(a,"http://www.w3.org/XML/1998/namespace","xml:space",f);break;case"is":na(a,"is",f);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=fw.get(c)||c,na(a,c,f))}}function Ch(a,s,c,f,m,p){switch(c){case"style":K1(a,f,p);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(n(61));if(c=f.__html,c!=null){if(m.children!=null)throw Error(n(60));a.innerHTML=c}}break;case"children":typeof f=="string"?Us(a,f):(typeof f=="number"||typeof f=="bigint")&&Us(a,""+f);break;case"onScroll":f!=null&&ft("scroll",a);break;case"onScrollEnd":f!=null&&ft("scrollend",a);break;case"onClick":f!=null&&(a.onclick=Nn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Dt.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(m=c.endsWith("Capture"),s=c.slice(2,m?c.length-7:void 0),p=a[B]||null,p=p!=null?p[c]:null,typeof p=="function"&&a.removeEventListener(s,p,m),typeof f=="function")){typeof p!="function"&&p!==null&&(c in a?a[c]=null:a.hasAttribute(c)&&a.removeAttribute(c)),a.addEventListener(s,f,m);break e}c in a?a[c]=f:f===!0?a.setAttribute(c,""):na(a,c,f)}}}function Mr(a,s,c){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ft("error",a),ft("load",a);var f=!1,m=!1,p;for(p in c)if(c.hasOwnProperty(p)){var S=c[p];if(S!=null)switch(p){case"src":f=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,s));default:Mt(a,s,p,S,c,null)}}m&&Mt(a,s,"srcSet",c.srcSet,c,null),f&&Mt(a,s,"src",c.src,c,null);return;case"input":ft("invalid",a);var D=p=S=m=null,X=null,ue=null;for(f in c)if(c.hasOwnProperty(f)){var ye=c[f];if(ye!=null)switch(f){case"name":m=ye;break;case"type":S=ye;break;case"checked":X=ye;break;case"defaultChecked":ue=ye;break;case"value":p=ye;break;case"defaultValue":D=ye;break;case"children":case"dangerouslySetInnerHTML":if(ye!=null)throw Error(n(137,s));break;default:Mt(a,s,f,ye,c,null)}}G1(a,p,D,X,ue,S,m,!1);return;case"select":ft("invalid",a),f=S=p=null;for(m in c)if(c.hasOwnProperty(m)&&(D=c[m],D!=null))switch(m){case"value":p=D;break;case"defaultValue":S=D;break;case"multiple":f=D;default:Mt(a,s,m,D,c,null)}s=p,c=S,a.multiple=!!f,s!=null?Is(a,!!f,s,!1):c!=null&&Is(a,!!f,c,!0);return;case"textarea":ft("invalid",a),p=m=f=null;for(S in c)if(c.hasOwnProperty(S)&&(D=c[S],D!=null))switch(S){case"value":f=D;break;case"defaultValue":m=D;break;case"children":p=D;break;case"dangerouslySetInnerHTML":if(D!=null)throw Error(n(91));break;default:Mt(a,s,S,D,c,null)}X1(a,f,m,p);return;case"option":for(X in c)c.hasOwnProperty(X)&&(f=c[X],f!=null)&&(X==="selected"?a.selected=f&&typeof f!="function"&&typeof f!="symbol":Mt(a,s,X,f,c,null));return;case"dialog":ft("beforetoggle",a),ft("toggle",a),ft("cancel",a),ft("close",a);break;case"iframe":case"object":ft("load",a);break;case"video":case"audio":for(f=0;f<Ac.length;f++)ft(Ac[f],a);break;case"image":ft("error",a),ft("load",a);break;case"details":ft("toggle",a);break;case"embed":case"source":case"link":ft("error",a),ft("load",a);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ue in c)if(c.hasOwnProperty(ue)&&(f=c[ue],f!=null))switch(ue){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,s));default:Mt(a,s,ue,f,c,null)}return;default:if(zu(s)){for(ye in c)c.hasOwnProperty(ye)&&(f=c[ye],f!==void 0&&Ch(a,s,ye,f,c,void 0));return}}for(D in c)c.hasOwnProperty(D)&&(f=c[D],f!=null&&Mt(a,s,D,f,c,null))}function US(a,s,c,f){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,p=null,S=null,D=null,X=null,ue=null,ye=null;for(de in c){var Te=c[de];if(c.hasOwnProperty(de)&&Te!=null)switch(de){case"checked":break;case"value":break;case"defaultValue":X=Te;default:f.hasOwnProperty(de)||Mt(a,s,de,null,f,Te)}}for(var fe in f){var de=f[fe];if(Te=c[fe],f.hasOwnProperty(fe)&&(de!=null||Te!=null))switch(fe){case"type":p=de;break;case"name":m=de;break;case"checked":ue=de;break;case"defaultChecked":ye=de;break;case"value":S=de;break;case"defaultValue":D=de;break;case"children":case"dangerouslySetInnerHTML":if(de!=null)throw Error(n(137,s));break;default:de!==Te&&Mt(a,s,fe,de,f,Te)}}ju(a,S,D,X,ue,ye,p,m);return;case"select":de=S=D=fe=null;for(p in c)if(X=c[p],c.hasOwnProperty(p)&&X!=null)switch(p){case"value":break;case"multiple":de=X;default:f.hasOwnProperty(p)||Mt(a,s,p,null,f,X)}for(m in f)if(p=f[m],X=c[m],f.hasOwnProperty(m)&&(p!=null||X!=null))switch(m){case"value":fe=p;break;case"defaultValue":D=p;break;case"multiple":S=p;default:p!==X&&Mt(a,s,m,p,f,X)}s=D,c=S,f=de,fe!=null?Is(a,!!c,fe,!1):!!f!=!!c&&(s!=null?Is(a,!!c,s,!0):Is(a,!!c,c?[]:"",!1));return;case"textarea":de=fe=null;for(D in c)if(m=c[D],c.hasOwnProperty(D)&&m!=null&&!f.hasOwnProperty(D))switch(D){case"value":break;case"children":break;default:Mt(a,s,D,null,f,m)}for(S in f)if(m=f[S],p=c[S],f.hasOwnProperty(S)&&(m!=null||p!=null))switch(S){case"value":fe=m;break;case"defaultValue":de=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(n(91));break;default:m!==p&&Mt(a,s,S,m,f,p)}q1(a,fe,de);return;case"option":for(var ze in c)fe=c[ze],c.hasOwnProperty(ze)&&fe!=null&&!f.hasOwnProperty(ze)&&(ze==="selected"?a.selected=!1:Mt(a,s,ze,null,f,fe));for(X in f)fe=f[X],de=c[X],f.hasOwnProperty(X)&&fe!==de&&(fe!=null||de!=null)&&(X==="selected"?a.selected=fe&&typeof fe!="function"&&typeof fe!="symbol":Mt(a,s,X,fe,f,de));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Xe in c)fe=c[Xe],c.hasOwnProperty(Xe)&&fe!=null&&!f.hasOwnProperty(Xe)&&Mt(a,s,Xe,null,f,fe);for(ue in f)if(fe=f[ue],de=c[ue],f.hasOwnProperty(ue)&&fe!==de&&(fe!=null||de!=null))switch(ue){case"children":case"dangerouslySetInnerHTML":if(fe!=null)throw Error(n(137,s));break;default:Mt(a,s,ue,fe,f,de)}return;default:if(zu(s)){for(var Bt in c)fe=c[Bt],c.hasOwnProperty(Bt)&&fe!==void 0&&!f.hasOwnProperty(Bt)&&Ch(a,s,Bt,void 0,f,fe);for(ye in f)fe=f[ye],de=c[ye],!f.hasOwnProperty(ye)||fe===de||fe===void 0&&de===void 0||Ch(a,s,ye,fe,f,de);return}}for(var se in c)fe=c[se],c.hasOwnProperty(se)&&fe!=null&&!f.hasOwnProperty(se)&&Mt(a,s,se,null,f,fe);for(Te in f)fe=f[Te],de=c[Te],!f.hasOwnProperty(Te)||fe===de||fe==null&&de==null||Mt(a,s,Te,fe,f,de)}function Yp(a){switch(a){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function jS(){if(typeof performance.getEntriesByType=="function"){for(var a=0,s=0,c=performance.getEntriesByType("resource"),f=0;f<c.length;f++){var m=c[f],p=m.transferSize,S=m.initiatorType,D=m.duration;if(p&&D&&Yp(S)){for(S=0,D=m.responseEnd,f+=1;f<c.length;f++){var X=c[f],ue=X.startTime;if(ue>D)break;var ye=X.transferSize,Te=X.initiatorType;ye&&Yp(Te)&&(X=X.responseEnd,S+=ye*(X<D?1:(D-ue)/(X-ue)))}if(--f,s+=8*(p+S)/(m.duration/1e3),a++,10<a)break}}if(0<a)return s/a/1e6}return navigator.connection&&(a=navigator.connection.downlink,typeof a=="number")?a:5}var Nh=null,Oh=null;function C0(a){return a.nodeType===9?a:a.ownerDocument}function Jp(a){switch(a){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Qp(a,s){if(a===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return a===1&&s==="foreignObject"?0:a}function Rh(a,s){return a==="textarea"||a==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var Dh=null;function PS(){var a=window.event;return a&&a.type==="popstate"?a===Dh?!1:(Dh=a,!0):(Dh=null,!1)}var Zp=typeof setTimeout=="function"?setTimeout:void 0,zS=typeof clearTimeout=="function"?clearTimeout:void 0,eg=typeof Promise=="function"?Promise:void 0,HS=typeof queueMicrotask=="function"?queueMicrotask:typeof eg<"u"?function(a){return eg.resolve(null).then(a).catch(VS)}:Zp;function VS(a){setTimeout(function(){throw a})}function Ti(a){return a==="head"}function tg(a,s){var c=s,f=0;do{var m=c.nextSibling;if(a.removeChild(c),m&&m.nodeType===8)if(c=m.data,c==="/$"||c==="/&"){if(f===0){a.removeChild(m),xl(s);return}f--}else if(c==="$"||c==="$?"||c==="$~"||c==="$!"||c==="&")f++;else if(c==="html")Nc(a.ownerDocument.documentElement);else if(c==="head"){c=a.ownerDocument.head,Nc(c);for(var p=c.firstChild;p;){var S=p.nextSibling,D=p.nodeName;p[te]||D==="SCRIPT"||D==="STYLE"||D==="LINK"&&p.rel.toLowerCase()==="stylesheet"||c.removeChild(p),p=S}}else c==="body"&&Nc(a.ownerDocument.body);c=m}while(c);xl(s)}function rg(a,s){var c=a;a=0;do{var f=c.nextSibling;if(c.nodeType===1?s?(c._stashedDisplay=c.style.display,c.style.display="none"):(c.style.display=c._stashedDisplay||"",c.getAttribute("style")===""&&c.removeAttribute("style")):c.nodeType===3&&(s?(c._stashedText=c.nodeValue,c.nodeValue=""):c.nodeValue=c._stashedText||""),f&&f.nodeType===8)if(c=f.data,c==="/$"){if(a===0)break;a--}else c!=="$"&&c!=="$?"&&c!=="$~"&&c!=="$!"||a++;c=f}while(c)}function Fh(a){var s=a.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var c=s;switch(s=s.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":Fh(c),ve(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}a.removeChild(c)}}function $S(a,s,c,f){for(;a.nodeType===1;){var m=c;if(a.nodeName.toLowerCase()!==s.toLowerCase()){if(!f&&(a.nodeName!=="INPUT"||a.type!=="hidden"))break}else if(f){if(!a[te])switch(s){case"meta":if(!a.hasAttribute("itemprop"))break;return a;case"link":if(p=a.getAttribute("rel"),p==="stylesheet"&&a.hasAttribute("data-precedence"))break;if(p!==m.rel||a.getAttribute("href")!==(m.href==null||m.href===""?null:m.href)||a.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||a.getAttribute("title")!==(m.title==null?null:m.title))break;return a;case"style":if(a.hasAttribute("data-precedence"))break;return a;case"script":if(p=a.getAttribute("src"),(p!==(m.src==null?null:m.src)||a.getAttribute("type")!==(m.type==null?null:m.type)||a.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&p&&a.hasAttribute("async")&&!a.hasAttribute("itemprop"))break;return a;default:return a}}else if(s==="input"&&a.type==="hidden"){var p=m.name==null?null:""+m.name;if(m.type==="hidden"&&a.getAttribute("name")===p)return a}else return a;if(a=za(a.nextSibling),a===null)break}return null}function GS(a,s,c){if(s==="")return null;for(;a.nodeType!==3;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!c||(a=za(a.nextSibling),a===null))return null;return a}function ag(a,s){for(;a.nodeType!==8;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!s||(a=za(a.nextSibling),a===null))return null;return a}function Mh(a){return a.data==="$?"||a.data==="$~"}function Bh(a){return a.data==="$!"||a.data==="$?"&&a.ownerDocument.readyState!=="loading"}function qS(a,s){var c=a.ownerDocument;if(a.data==="$~")a._reactRetry=s;else if(a.data!=="$?"||c.readyState!=="loading")s();else{var f=function(){s(),c.removeEventListener("DOMContentLoaded",f)};c.addEventListener("DOMContentLoaded",f),a._reactRetry=f}}function za(a){for(;a!=null;a=a.nextSibling){var s=a.nodeType;if(s===1||s===3)break;if(s===8){if(s=a.data,s==="$"||s==="$!"||s==="$?"||s==="$~"||s==="&"||s==="F!"||s==="F")break;if(s==="/$"||s==="/&")return null}}return a}var Lh=null;function ng(a){a=a.nextSibling;for(var s=0;a;){if(a.nodeType===8){var c=a.data;if(c==="/$"||c==="/&"){if(s===0)return za(a.nextSibling);s--}else c!=="$"&&c!=="$!"&&c!=="$?"&&c!=="$~"&&c!=="&"||s++}a=a.nextSibling}return null}function ig(a){a=a.previousSibling;for(var s=0;a;){if(a.nodeType===8){var c=a.data;if(c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"){if(s===0)return a;s--}else c!=="/$"&&c!=="/&"||s++}a=a.previousSibling}return null}function sg(a,s,c){switch(s=C0(c),a){case"html":if(a=s.documentElement,!a)throw Error(n(452));return a;case"head":if(a=s.head,!a)throw Error(n(453));return a;case"body":if(a=s.body,!a)throw Error(n(454));return a;default:throw Error(n(451))}}function Nc(a){for(var s=a.attributes;s.length;)a.removeAttributeNode(s[0]);ve(a)}var Ha=new Map,lg=new Set;function N0(a){return typeof a.getRootNode=="function"?a.getRootNode():a.nodeType===9?a:a.ownerDocument}var Gn=le.d;le.d={f:XS,r:WS,D:KS,C:YS,L:JS,m:QS,X:eb,S:ZS,M:tb};function XS(){var a=Gn.f(),s=_0();return a||s}function WS(a){var s=Fe(a);s!==null&&s.tag===5&&s.type==="form"?Ex(s):Gn.r(a)}var hl=typeof document>"u"?null:document;function cg(a,s,c){var f=hl;if(f&&typeof s=="string"&&s){var m=Ma(s);m='link[rel="'+a+'"][href="'+m+'"]',typeof c=="string"&&(m+='[crossorigin="'+c+'"]'),lg.has(m)||(lg.add(m),a={rel:a,crossOrigin:c,href:s},f.querySelector(m)===null&&(s=f.createElement("link"),Mr(s,"link",a),Pe(s),f.head.appendChild(s)))}}function KS(a){Gn.D(a),cg("dns-prefetch",a,null)}function YS(a,s){Gn.C(a,s),cg("preconnect",a,s)}function JS(a,s,c){Gn.L(a,s,c);var f=hl;if(f&&a&&s){var m='link[rel="preload"][as="'+Ma(s)+'"]';s==="image"&&c&&c.imageSrcSet?(m+='[imagesrcset="'+Ma(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(m+='[imagesizes="'+Ma(c.imageSizes)+'"]')):m+='[href="'+Ma(a)+'"]';var p=m;switch(s){case"style":p=dl(a);break;case"script":p=ml(a)}Ha.has(p)||(a=g({rel:"preload",href:s==="image"&&c&&c.imageSrcSet?void 0:a,as:s},c),Ha.set(p,a),f.querySelector(m)!==null||s==="style"&&f.querySelector(Oc(p))||s==="script"&&f.querySelector(Rc(p))||(s=f.createElement("link"),Mr(s,"link",a),Pe(s),f.head.appendChild(s)))}}function QS(a,s){Gn.m(a,s);var c=hl;if(c&&a){var f=s&&typeof s.as=="string"?s.as:"script",m='link[rel="modulepreload"][as="'+Ma(f)+'"][href="'+Ma(a)+'"]',p=m;switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":p=ml(a)}if(!Ha.has(p)&&(a=g({rel:"modulepreload",href:a},s),Ha.set(p,a),c.querySelector(m)===null)){switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(Rc(p)))return}f=c.createElement("link"),Mr(f,"link",a),Pe(f),c.head.appendChild(f)}}}function ZS(a,s,c){Gn.S(a,s,c);var f=hl;if(f&&a){var m=Me(f).hoistableStyles,p=dl(a);s=s||"default";var S=m.get(p);if(!S){var D={loading:0,preload:null};if(S=f.querySelector(Oc(p)))D.loading=5;else{a=g({rel:"stylesheet",href:a,"data-precedence":s},c),(c=Ha.get(p))&&Ih(a,c);var X=S=f.createElement("link");Pe(X),Mr(X,"link",a),X._p=new Promise(function(ue,ye){X.onload=ue,X.onerror=ye}),X.addEventListener("load",function(){D.loading|=1}),X.addEventListener("error",function(){D.loading|=2}),D.loading|=4,O0(S,s,f)}S={type:"stylesheet",instance:S,count:1,state:D},m.set(p,S)}}}function eb(a,s){Gn.X(a,s);var c=hl;if(c&&a){var f=Me(c).hoistableScripts,m=ml(a),p=f.get(m);p||(p=c.querySelector(Rc(m)),p||(a=g({src:a,async:!0},s),(s=Ha.get(m))&&Uh(a,s),p=c.createElement("script"),Pe(p),Mr(p,"link",a),c.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},f.set(m,p))}}function tb(a,s){Gn.M(a,s);var c=hl;if(c&&a){var f=Me(c).hoistableScripts,m=ml(a),p=f.get(m);p||(p=c.querySelector(Rc(m)),p||(a=g({src:a,async:!0,type:"module"},s),(s=Ha.get(m))&&Uh(a,s),p=c.createElement("script"),Pe(p),Mr(p,"link",a),c.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},f.set(m,p))}}function og(a,s,c,f){var m=(m=ce.current)?N0(m):null;if(!m)throw Error(n(446));switch(a){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(s=dl(c.href),c=Me(m).hoistableStyles,f=c.get(s),f||(f={type:"style",instance:null,count:0,state:null},c.set(s,f)),f):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){a=dl(c.href);var p=Me(m).hoistableStyles,S=p.get(a);if(S||(m=m.ownerDocument||m,S={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},p.set(a,S),(p=m.querySelector(Oc(a)))&&!p._p&&(S.instance=p,S.state.loading=5),Ha.has(a)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},Ha.set(a,c),p||rb(m,a,c,S.state))),s&&f===null)throw Error(n(528,""));return S}if(s&&f!==null)throw Error(n(529,""));return null;case"script":return s=c.async,c=c.src,typeof c=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=ml(c),c=Me(m).hoistableScripts,f=c.get(s),f||(f={type:"script",instance:null,count:0,state:null},c.set(s,f)),f):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,a))}}function dl(a){return'href="'+Ma(a)+'"'}function Oc(a){return'link[rel="stylesheet"]['+a+"]"}function ug(a){return g({},a,{"data-precedence":a.precedence,precedence:null})}function rb(a,s,c,f){a.querySelector('link[rel="preload"][as="style"]['+s+"]")?f.loading=1:(s=a.createElement("link"),f.preload=s,s.addEventListener("load",function(){return f.loading|=1}),s.addEventListener("error",function(){return f.loading|=2}),Mr(s,"link",c),Pe(s),a.head.appendChild(s))}function ml(a){return'[src="'+Ma(a)+'"]'}function Rc(a){return"script[async]"+a}function fg(a,s,c){if(s.count++,s.instance===null)switch(s.type){case"style":var f=a.querySelector('style[data-href~="'+Ma(c.href)+'"]');if(f)return s.instance=f,Pe(f),f;var m=g({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return f=(a.ownerDocument||a).createElement("style"),Pe(f),Mr(f,"style",m),O0(f,c.precedence,a),s.instance=f;case"stylesheet":m=dl(c.href);var p=a.querySelector(Oc(m));if(p)return s.state.loading|=4,s.instance=p,Pe(p),p;f=ug(c),(m=Ha.get(m))&&Ih(f,m),p=(a.ownerDocument||a).createElement("link"),Pe(p);var S=p;return S._p=new Promise(function(D,X){S.onload=D,S.onerror=X}),Mr(p,"link",f),s.state.loading|=4,O0(p,c.precedence,a),s.instance=p;case"script":return p=ml(c.src),(m=a.querySelector(Rc(p)))?(s.instance=m,Pe(m),m):(f=c,(m=Ha.get(p))&&(f=g({},c),Uh(f,m)),a=a.ownerDocument||a,m=a.createElement("script"),Pe(m),Mr(m,"link",f),a.head.appendChild(m),s.instance=m);case"void":return null;default:throw Error(n(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(f=s.instance,s.state.loading|=4,O0(f,c.precedence,a));return s.instance}function O0(a,s,c){for(var f=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=f.length?f[f.length-1]:null,p=m,S=0;S<f.length;S++){var D=f[S];if(D.dataset.precedence===s)p=D;else if(p!==m)break}p?p.parentNode.insertBefore(a,p.nextSibling):(s=c.nodeType===9?c.head:c,s.insertBefore(a,s.firstChild))}function Ih(a,s){a.crossOrigin==null&&(a.crossOrigin=s.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=s.referrerPolicy),a.title==null&&(a.title=s.title)}function Uh(a,s){a.crossOrigin==null&&(a.crossOrigin=s.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=s.referrerPolicy),a.integrity==null&&(a.integrity=s.integrity)}var R0=null;function hg(a,s,c){if(R0===null){var f=new Map,m=R0=new Map;m.set(c,f)}else m=R0,f=m.get(c),f||(f=new Map,m.set(c,f));if(f.has(a))return f;for(f.set(a,null),c=c.getElementsByTagName(a),m=0;m<c.length;m++){var p=c[m];if(!(p[te]||p[O]||a==="link"&&p.getAttribute("rel")==="stylesheet")&&p.namespaceURI!=="http://www.w3.org/2000/svg"){var S=p.getAttribute(s)||"";S=a+S;var D=f.get(S);D?D.push(p):f.set(S,[p])}}return f}function dg(a,s,c){a=a.ownerDocument||a,a.head.insertBefore(c,s==="title"?a.querySelector("head > title"):null)}function ab(a,s,c){if(c===1||s.itemProp!=null)return!1;switch(a){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;return s.rel==="stylesheet"?(a=s.disabled,typeof s.precedence=="string"&&a==null):!0;case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function mg(a){return!(a.type==="stylesheet"&&(a.state.loading&3)===0)}function nb(a,s,c,f){if(c.type==="stylesheet"&&(typeof f.media!="string"||matchMedia(f.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var m=dl(f.href),p=s.querySelector(Oc(m));if(p){s=p._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(a.count++,a=D0.bind(a),s.then(a,a)),c.state.loading|=4,c.instance=p,Pe(p);return}p=s.ownerDocument||s,f=ug(f),(m=Ha.get(m))&&Ih(f,m),p=p.createElement("link"),Pe(p);var S=p;S._p=new Promise(function(D,X){S.onload=D,S.onerror=X}),Mr(p,"link",f),c.instance=p}a.stylesheets===null&&(a.stylesheets=new Map),a.stylesheets.set(c,s),(s=c.state.preload)&&(c.state.loading&3)===0&&(a.count++,c=D0.bind(a),s.addEventListener("load",c),s.addEventListener("error",c))}}var jh=0;function ib(a,s){return a.stylesheets&&a.count===0&&M0(a,a.stylesheets),0<a.count||0<a.imgCount?function(c){var f=setTimeout(function(){if(a.stylesheets&&M0(a,a.stylesheets),a.unsuspend){var p=a.unsuspend;a.unsuspend=null,p()}},6e4+s);0<a.imgBytes&&jh===0&&(jh=62500*jS());var m=setTimeout(function(){if(a.waitingForImages=!1,a.count===0&&(a.stylesheets&&M0(a,a.stylesheets),a.unsuspend)){var p=a.unsuspend;a.unsuspend=null,p()}},(a.imgBytes>jh?50:800)+s);return a.unsuspend=c,function(){a.unsuspend=null,clearTimeout(f),clearTimeout(m)}}:null}function D0(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)M0(this,this.stylesheets);else if(this.unsuspend){var a=this.unsuspend;this.unsuspend=null,a()}}}var F0=null;function M0(a,s){a.stylesheets=null,a.unsuspend!==null&&(a.count++,F0=new Map,s.forEach(sb,a),F0=null,D0.call(a))}function sb(a,s){if(!(s.state.loading&4)){var c=F0.get(a);if(c)var f=c.get(null);else{c=new Map,F0.set(a,c);for(var m=a.querySelectorAll("link[data-precedence],style[data-precedence]"),p=0;p<m.length;p++){var S=m[p];(S.nodeName==="LINK"||S.getAttribute("media")!=="not all")&&(c.set(S.dataset.precedence,S),f=S)}f&&c.set(null,f)}m=s.instance,S=m.getAttribute("data-precedence"),p=c.get(S)||f,p===f&&c.set(null,m),c.set(S,m),this.count++,f=D0.bind(this),m.addEventListener("load",f),m.addEventListener("error",f),p?p.parentNode.insertBefore(m,p.nextSibling):(a=a.nodeType===9?a.head:a,a.insertBefore(m,a.firstChild)),s.state.loading|=4}}var Dc={$$typeof:T,Provider:null,Consumer:null,_currentValue:_e,_currentValue2:_e,_threadCount:0};function lb(a,s,c,f,m,p,S,D,X){this.tag=1,this.containerInfo=a,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Gi(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Gi(0),this.hiddenUpdates=Gi(null),this.identifierPrefix=f,this.onUncaughtError=m,this.onCaughtError=p,this.onRecoverableError=S,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=X,this.incompleteTransitions=new Map}function xg(a,s,c,f,m,p,S,D,X,ue,ye,Te){return a=new lb(a,s,c,S,X,ue,ye,Te,D),s=1,p===!0&&(s|=24),p=pa(3,null,null,s),a.current=p,p.stateNode=a,s=vf(),s.refCount++,a.pooledCache=s,s.refCount++,p.memoizedState={element:f,isDehydrated:c,cache:s},Sf(p),a}function pg(a){return a?(a=Gs,a):Gs}function gg(a,s,c,f,m,p){m=pg(m),f.context===null?f.context=m:f.pendingContext=m,f=mi(s),f.payload={element:c},p=p===void 0?null:p,p!==null&&(f.callback=p),c=xi(a,f,s),c!==null&&(ua(c,a,s),uc(c,a,s))}function vg(a,s){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var c=a.retryLane;a.retryLane=c!==0&&c<s?c:s}}function Ph(a,s){vg(a,s),(a=a.alternate)&&vg(a,s)}function yg(a){if(a.tag===13||a.tag===31){var s=Yi(a,67108864);s!==null&&ua(s,a,67108864),Ph(a,67108864)}}function _g(a){if(a.tag===13||a.tag===31){var s=wa();s=Le(s);var c=Yi(a,s);c!==null&&ua(c,a,s),Ph(a,s)}}var B0=!0;function cb(a,s,c,f){var m=Y.T;Y.T=null;var p=le.p;try{le.p=2,zh(a,s,c,f)}finally{le.p=p,Y.T=m}}function ob(a,s,c,f){var m=Y.T;Y.T=null;var p=le.p;try{le.p=8,zh(a,s,c,f)}finally{le.p=p,Y.T=m}}function zh(a,s,c,f){if(B0){var m=Hh(f);if(m===null)Ah(a,s,f,L0,c),Sg(a,f);else if(fb(m,a,s,c,f))f.stopPropagation();else if(Sg(a,f),s&4&&-1<ub.indexOf(a)){for(;m!==null;){var p=Fe(m);if(p!==null)switch(p.tag){case 3:if(p=p.stateNode,p.current.memoizedState.isDehydrated){var S=aa(p.pendingLanes);if(S!==0){var D=p;for(D.pendingLanes|=2,D.entangledLanes|=2;S;){var X=1<<31-Wt(S);D.entanglements[1]|=X,S&=~X}gn(p),(wt&6)===0&&(v0=bt()+500,kc(0))}}break;case 31:case 13:D=Yi(p,2),D!==null&&ua(D,p,2),_0(),Ph(p,2)}if(p=Hh(f),p===null&&Ah(a,s,f,L0,c),p===m)break;m=p}m!==null&&f.stopPropagation()}else Ah(a,s,f,null,c)}}function Hh(a){return a=Vu(a),Vh(a)}var L0=null;function Vh(a){if(L0=null,a=me(a),a!==null){var s=l(a);if(s===null)a=null;else{var c=s.tag;if(c===13){if(a=o(s),a!==null)return a;a=null}else if(c===31){if(a=u(s),a!==null)return a;a=null}else if(c===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;a=null}else s!==a&&(a=null)}}return L0=a,null}function wg(a){switch(a){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Or()){case ma:return 2;case hn:return 8;case Xt:case hr:return 32;case at:return 268435456;default:return 32}default:return 32}}var $h=!1,ki=null,Ai=null,Ci=null,Fc=new Map,Mc=new Map,Ni=[],ub="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Sg(a,s){switch(a){case"focusin":case"focusout":ki=null;break;case"dragenter":case"dragleave":Ai=null;break;case"mouseover":case"mouseout":Ci=null;break;case"pointerover":case"pointerout":Fc.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":Mc.delete(s.pointerId)}}function Bc(a,s,c,f,m,p){return a===null||a.nativeEvent!==p?(a={blockedOn:s,domEventName:c,eventSystemFlags:f,nativeEvent:p,targetContainers:[m]},s!==null&&(s=Fe(s),s!==null&&yg(s)),a):(a.eventSystemFlags|=f,s=a.targetContainers,m!==null&&s.indexOf(m)===-1&&s.push(m),a)}function fb(a,s,c,f,m){switch(s){case"focusin":return ki=Bc(ki,a,s,c,f,m),!0;case"dragenter":return Ai=Bc(Ai,a,s,c,f,m),!0;case"mouseover":return Ci=Bc(Ci,a,s,c,f,m),!0;case"pointerover":var p=m.pointerId;return Fc.set(p,Bc(Fc.get(p)||null,a,s,c,f,m)),!0;case"gotpointercapture":return p=m.pointerId,Mc.set(p,Bc(Mc.get(p)||null,a,s,c,f,m)),!0}return!1}function bg(a){var s=me(a.target);if(s!==null){var c=l(s);if(c!==null){if(s=c.tag,s===13){if(s=o(c),s!==null){a.blockedOn=s,F(a.priority,function(){_g(c)});return}}else if(s===31){if(s=u(c),s!==null){a.blockedOn=s,F(a.priority,function(){_g(c)});return}}else if(s===3&&c.stateNode.current.memoizedState.isDehydrated){a.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}a.blockedOn=null}function I0(a){if(a.blockedOn!==null)return!1;for(var s=a.targetContainers;0<s.length;){var c=Hh(a.nativeEvent);if(c===null){c=a.nativeEvent;var f=new c.constructor(c.type,c);Hu=f,c.target.dispatchEvent(f),Hu=null}else return s=Fe(c),s!==null&&yg(s),a.blockedOn=c,!1;s.shift()}return!0}function Eg(a,s,c){I0(a)&&c.delete(s)}function hb(){$h=!1,ki!==null&&I0(ki)&&(ki=null),Ai!==null&&I0(Ai)&&(Ai=null),Ci!==null&&I0(Ci)&&(Ci=null),Fc.forEach(Eg),Mc.forEach(Eg)}function U0(a,s){a.blockedOn===s&&(a.blockedOn=null,$h||($h=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,hb)))}var j0=null;function Tg(a){j0!==a&&(j0=a,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){j0===a&&(j0=null);for(var s=0;s<a.length;s+=3){var c=a[s],f=a[s+1],m=a[s+2];if(typeof f!="function"){if(Vh(f||c)===null)continue;break}var p=Fe(c);p!==null&&(a.splice(s,3),s-=3,Hf(p,{pending:!0,data:m,method:c.method,action:f},f,m))}}))}function xl(a){function s(X){return U0(X,a)}ki!==null&&U0(ki,a),Ai!==null&&U0(Ai,a),Ci!==null&&U0(Ci,a),Fc.forEach(s),Mc.forEach(s);for(var c=0;c<Ni.length;c++){var f=Ni[c];f.blockedOn===a&&(f.blockedOn=null)}for(;0<Ni.length&&(c=Ni[0],c.blockedOn===null);)bg(c),c.blockedOn===null&&Ni.shift();if(c=(a.ownerDocument||a).$$reactFormReplay,c!=null)for(f=0;f<c.length;f+=3){var m=c[f],p=c[f+1],S=m[B]||null;if(typeof p=="function")S||Tg(c);else if(S){var D=null;if(p&&p.hasAttribute("formAction")){if(m=p,S=p[B]||null)D=S.formAction;else if(Vh(m)!==null)continue}else D=S.action;typeof D=="function"?c[f+1]=D:(c.splice(f,3),f-=3),Tg(c)}}}function kg(){function a(p){p.canIntercept&&p.info==="react-transition"&&p.intercept({handler:function(){return new Promise(function(S){return m=S})},focusReset:"manual",scroll:"manual"})}function s(){m!==null&&(m(),m=null),f||setTimeout(c,20)}function c(){if(!f&&!navigation.transition){var p=navigation.currentEntry;p&&p.url!=null&&navigation.navigate(p.url,{state:p.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var f=!1,m=null;return navigation.addEventListener("navigate",a),navigation.addEventListener("navigatesuccess",s),navigation.addEventListener("navigateerror",s),setTimeout(c,100),function(){f=!0,navigation.removeEventListener("navigate",a),navigation.removeEventListener("navigatesuccess",s),navigation.removeEventListener("navigateerror",s),m!==null&&(m(),m=null)}}}function Gh(a){this._internalRoot=a}P0.prototype.render=Gh.prototype.render=function(a){var s=this._internalRoot;if(s===null)throw Error(n(409));var c=s.current,f=wa();gg(c,f,a,s,null,null)},P0.prototype.unmount=Gh.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var s=a.containerInfo;gg(a.current,2,null,a,null,null),_0(),s[L]=null}};function P0(a){this._internalRoot=a}P0.prototype.unstable_scheduleHydration=function(a){if(a){var s=k();a={blockedOn:null,target:a,priority:s};for(var c=0;c<Ni.length&&s!==0&&s<Ni[c].priority;c++);Ni.splice(c,0,a),c===0&&bg(a)}};var Ag=t.version;if(Ag!=="19.2.3")throw Error(n(527,Ag,"19.2.3"));le.findDOMNode=function(a){var s=a._reactInternals;if(s===void 0)throw typeof a.render=="function"?Error(n(188)):(a=Object.keys(a).join(","),Error(n(268,a)));return a=d(s),a=a!==null?x(a):null,a=a===null?null:a.stateNode,a};var db={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:Y,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var z0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!z0.isDisabled&&z0.supportsFiber)try{Et=z0.inject(db),Tt=z0}catch{}}return Ic.createRoot=function(a,s){if(!i(a))throw Error(n(299));var c=!1,f="",m=Mx,p=Bx,S=Lx;return s!=null&&(s.unstable_strictMode===!0&&(c=!0),s.identifierPrefix!==void 0&&(f=s.identifierPrefix),s.onUncaughtError!==void 0&&(m=s.onUncaughtError),s.onCaughtError!==void 0&&(p=s.onCaughtError),s.onRecoverableError!==void 0&&(S=s.onRecoverableError)),s=xg(a,1,!1,null,null,c,f,null,m,p,S,kg),a[L]=s.current,kh(a),new Gh(s)},Ic.hydrateRoot=function(a,s,c){if(!i(a))throw Error(n(299));var f=!1,m="",p=Mx,S=Bx,D=Lx,X=null;return c!=null&&(c.unstable_strictMode===!0&&(f=!0),c.identifierPrefix!==void 0&&(m=c.identifierPrefix),c.onUncaughtError!==void 0&&(p=c.onUncaughtError),c.onCaughtError!==void 0&&(S=c.onCaughtError),c.onRecoverableError!==void 0&&(D=c.onRecoverableError),c.formState!==void 0&&(X=c.formState)),s=xg(a,1,!0,s,c??null,f,m,X,p,S,D,kg),s.context=pg(null),c=s.current,f=wa(),f=Le(f),m=mi(f),m.callback=null,xi(c,m,f),c=f,s.current.lanes=c,Qa(s,c),gn(s),a[L]=s.current,kh(a),new P0(s)},Ic.version="19.2.3",Ic}var Ig;function bb(){if(Ig)return Wh.exports;Ig=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),Wh.exports=Sb(),Wh.exports}var Eb=bb();const Tb=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),kb=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,n)=>n?n.toUpperCase():r.toLowerCase()),Ug=e=>{const t=kb(e);return t.charAt(0).toUpperCase()+t.slice(1)},ky=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim(),Ab=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};var Cb={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Nb=$e.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:i="",children:l,iconNode:o,...u},h)=>$e.createElement("svg",{ref:h,...Cb,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:ky("lucide",i),...!l&&!Ab(u)&&{"aria-hidden":"true"},...u},[...o.map(([d,x])=>$e.createElement(d,x)),...Array.isArray(l)?l:[l]]));const ur=(e,t)=>{const r=$e.forwardRef(({className:n,...i},l)=>$e.createElement(Nb,{ref:l,iconNode:t,className:ky(`lucide-${Tb(Ug(e))}`,`lucide-${e}`,n),...i}));return r.displayName=Ug(e),r};const Ob=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],Ay=ur("chart-column",Ob);const Rb=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Db=ur("chevron-right",Rb);const Fb=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Wd=ur("circle-check",Fb);const Mb=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],Kd=ur("clipboard-list",Mb);const Bb=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Yd=ur("download",Bb);const Lb=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],Ib=ur("eye-off",Lb);const Ub=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],jb=ur("eye",Ub);const Pb=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],zb=ur("file-down",Pb);const Hb=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],Cy=ur("file-spreadsheet",Hb);const Vb=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],$b=ur("layout-dashboard",Vb);const Gb=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],qb=ur("menu",Gb);const Xb=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],lu=ur("package",Xb);const Wb=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Kb=ur("pen",Wb);const Yb=[["path",{d:"m10.5 20.5 10-10a4.95 4.95 0 1 0-7-7l-10 10a4.95 4.95 0 1 0 7 7Z",key:"wa1lgi"}],["path",{d:"m8.5 8.5 7 7",key:"rvfmvr"}]],Ny=ur("pill",Yb);const Jb=[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]],_o=ur("refresh-ccw",Jb);const Qb=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Oy=ur("search",Qb);const Zb=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],cu=ur("trash-2",Zb);const eE=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],tE=ur("trending-down",eE);const rE=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],zl=ur("triangle-alert",rE);const aE=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],wo=ur("upload",aE);const nE=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Ry=ur("x",nE);function iE({editingMed:e,onClose:t,onSubmit:r}){return E.jsx("div",{className:"fixed inset-0 bg-slate-900/60 backdrop-blur-sm flex items-center justify-center z-50 p-4 font-sans",children:E.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-lg overflow-hidden",children:[E.jsxs("div",{className:"p-6 border-b border-slate-100 flex justify-between items-center bg-slate-50",children:[E.jsx("h3",{className:"text-lg font-bold text-slate-800",children:e?"Editar Medicamento":"Nuevo Medicamento"}),E.jsx("button",{type:"button",onClick:t,className:"text-slate-400 hover:text-slate-600 transition-colors",children:E.jsx(Ry,{size:24})})]}),E.jsxs("form",{onSubmit:r,className:"p-6 grid grid-cols-2 gap-4",children:[E.jsxs("div",{className:"col-span-2",children:[E.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase mb-1",children:"Nombre Comercial"}),E.jsx("input",{required:!0,name:"name",defaultValue:e?.name,className:"w-full border p-2.5 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm transition-all",placeholder:"Ej. Amoxicilina 500mg"})]}),E.jsxs("div",{children:[E.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase mb-1",children:"Categora"}),E.jsxs("select",{name:"category",defaultValue:e?.category,className:"w-full border p-2.5 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm bg-white",children:[E.jsx("option",{children:"Analgsico"}),E.jsx("option",{children:"Antibitico"}),E.jsx("option",{children:"Antiinflamatorio"}),E.jsx("option",{children:"Insumo Mdico"}),E.jsx("option",{children:"Protector Gstrico"})]})]}),E.jsxs("div",{children:[E.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase mb-1",children:"Unidad"}),E.jsx("input",{name:"unit",defaultValue:e?.unit||"Tabletas",className:"w-full border p-2.5 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm",placeholder:"Cajas, Tabletas..."})]}),E.jsxs("div",{children:[E.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase mb-1",children:"Lote"}),E.jsx("input",{name:"batch",defaultValue:e?.batch,className:"w-full border p-2.5 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm font-mono",placeholder:"LOT-000"})]}),E.jsxs("div",{children:[E.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase mb-1",children:"Vencimiento"}),E.jsx("input",{type:"date",name:"expiry_date",defaultValue:e?.expiry_date,className:"w-full border p-2.5 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm font-mono"})]}),E.jsxs("div",{children:[E.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase mb-1",children:"Stock Inicial"}),E.jsx("input",{type:"number",name:"stock",defaultValue:e?.stock||0,className:"w-full border p-2.5 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm font-mono"})]}),E.jsxs("div",{children:[E.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase mb-1",children:"Stock Mnimo"}),E.jsx("input",{type:"number",name:"min_stock",defaultValue:e?.min_stock||10,className:"w-full border p-2.5 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm font-mono"})]}),E.jsxs("div",{className:"col-span-2 pt-4 flex space-x-3",children:[E.jsx("button",{type:"button",onClick:t,className:"flex-1 border border-slate-200 py-3 rounded-xl hover:bg-slate-50 font-semibold transition-colors text-sm",children:"Cancelar"}),E.jsx("button",{type:"submit",className:"flex-1 bg-blue-600 text-white py-3 rounded-xl hover:bg-blue-700 font-semibold shadow-lg shadow-blue-200 transition-all text-sm",children:e?"Guardar Cambios":"Registrar"})]})]})]})})}function sE({activeTab:e}){const t=e==="dashboard"?"Resumen General":e==="inventory"?"Gestin de Inventario":e==="catalog"?"Catlogo de Productos":e==="consumption-monthly"?"Consumo Mensual":e==="consumption-summary"?"Resumen de Consumo":e==="order-request"?"Solicitud Pedido":e==="tertiary-packaging"?"Empaque Terciario":"Alertas de Stock";return E.jsx("header",{className:"flex justify-between items-center mb-8",children:E.jsxs("div",{children:[E.jsx("h2",{className:"text-2xl font-bold text-slate-800 capitalize",children:t}),E.jsx("p",{className:"text-slate-500",children:"Sistema central de suministros mdicos."})]})})}function Ri({id:e,icon:t,label:r,activeTab:n,isSidebarOpen:i,onSelect:l}){return E.jsxs("button",{onClick:()=>l(e),className:`w-full flex items-center space-x-3 p-3 rounded-lg transition-colors ${n===e?"bg-blue-600 text-white shadow-md":"text-slate-600 hover:bg-blue-50"}`,children:[E.jsx(t,{size:20}),i&&E.jsx("span",{className:"font-medium",children:r})]})}function lE({activeTab:e,isSidebarOpen:t,onSelectTab:r,onToggleSidebar:n}){return E.jsxs("aside",{className:`bg-white border-r border-slate-200 transition-all duration-300 flex flex-col ${t?"w-64":"w-20"}`,children:[E.jsxs("div",{className:"p-6 flex items-center space-x-3 border-b border-slate-100",children:[E.jsx("div",{className:"bg-blue-600 p-2 rounded-lg text-white",children:E.jsx(lu,{size:24})}),t&&E.jsxs("h1",{className:"text-xl font-bold tracking-tight text-blue-900 leading-none",children:["BODEGA",E.jsx("br",{}),E.jsx("span",{className:"text-sm font-normal text-slate-500 tracking-normal",children:"PharmaStock v1.1"})]})]}),E.jsxs("nav",{className:"flex-1 p-4 space-y-2 mt-4",children:[E.jsx(Ri,{id:"dashboard",icon:$b,label:"Panel de Control",activeTab:e,isSidebarOpen:t,onSelect:r}),E.jsx(Ri,{id:"inventory",icon:Ny,label:"Inventario",activeTab:e,isSidebarOpen:t,onSelect:r}),E.jsx(Ri,{id:"catalog",icon:Cy,label:"Catlogo",activeTab:e,isSidebarOpen:t,onSelect:r}),E.jsx(Ri,{id:"consumption-monthly",icon:wo,label:"Consumo mensual",activeTab:e,isSidebarOpen:t,onSelect:r}),E.jsx(Ri,{id:"consumption-summary",icon:Ay,label:"Resumen consumo",activeTab:e,isSidebarOpen:t,onSelect:r}),E.jsx(Ri,{id:"order-request",icon:Kd,label:"Solicitud Pedido",activeTab:e,isSidebarOpen:t,onSelect:r}),E.jsx(Ri,{id:"tertiary-packaging",icon:lu,label:"Empaque Terciario",activeTab:e,isSidebarOpen:t,onSelect:r}),E.jsx(Ri,{id:"alerts",icon:zl,label:"Alertas de Stock",activeTab:e,isSidebarOpen:t,onSelect:r})]}),E.jsx("div",{className:"p-4 border-t border-slate-100",children:E.jsx("button",{onClick:n,className:"p-2 hover:bg-slate-100 rounded-lg text-slate-400 w-full flex justify-center",children:t?E.jsx(Ry,{size:20}):E.jsx(qb,{size:20})})})]})}function cE({lowStockItems:e,onEditMedication:t}){return E.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.map(r=>E.jsxs("div",{className:"bg-white p-6 rounded-xl border-l-4 border-red-500 shadow-sm flex flex-col justify-between",children:[E.jsxs("div",{children:[E.jsxs("div",{className:"flex justify-between items-start mb-4",children:[E.jsx("h3",{className:"text-lg font-bold text-slate-800",children:r.name}),E.jsx("div",{className:"bg-red-100 p-2 rounded-full text-red-600",children:E.jsx(zl,{size:20})})]}),E.jsxs("div",{className:"space-y-2 mb-6 text-sm text-slate-600",children:[E.jsxs("p",{className:"flex justify-between",children:[E.jsx("span",{children:"Categora:"})," ",E.jsx("span",{className:"font-semibold",children:r.category})]}),E.jsxs("p",{className:"flex justify-between",children:[E.jsx("span",{children:"Stock Mnimo:"})," ",E.jsx("span",{className:"font-semibold",children:r.min_stock})]}),E.jsxs("p",{className:"flex justify-between",children:[E.jsx("span",{children:"Stock Actual:"})," ",E.jsx("span",{className:"font-bold text-red-600 text-base",children:r.stock})]})]})]}),E.jsx("button",{type:"button",onClick:()=>t(r),className:"w-full bg-blue-600 hover:bg-blue-700 text-white py-2 rounded-lg font-medium transition-colors",children:"Generar Orden de Compra"})]},r.id)),e.length===0&&E.jsxs("div",{className:"col-span-full py-20 text-center bg-white border border-dashed border-slate-300 rounded-2xl",children:[E.jsx("div",{className:"bg-green-100 text-green-600 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4",children:E.jsx(lu,{size:32})}),E.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"Todo en Orden!"}),E.jsx("p",{className:"text-slate-500 max-w-sm mx-auto",children:"No hay medicamentos que requieran atencin inmediata por falta de inventario."})]})]})}function oE({medications:e,excelStatus:t,fileInputRef:r,onChooseFile:n,onDownloadTemplate:i,onFileChange:l,onEditMedication:o,onDeleteMedication:u,onClearCatalog:h}){const d=g=>{const v=String(g??"").trim();return v.length<=50?{display:v,full:v}:{display:`${v.slice(0,50)}`,full:v}},x=$e.useMemo(()=>{const g=_=>{const w=String(_||"").replace(/\D/g,"");return w.length<4?Number.POSITIVE_INFINITY:Number.parseInt(w.slice(-4),10)},v=_=>String(_||"").trim().startsWith("1-10");return[...e||[]].sort((_,w)=>{const y=_?.siges_code||"",b=w?.siges_code||"",A=v(y),M=v(b);if(A!==M)return A?-1:1;const T=g(y),U=g(b);return T!==U?T-U:String(y).localeCompare(String(b),"es",{numeric:!0,sensitivity:"base"})})},[e]);return E.jsx("div",{className:"space-y-6",children:E.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[E.jsxs("div",{className:"lg:col-span-1 bg-white p-6 rounded-2xl border border-slate-200 shadow-sm",children:[E.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[E.jsx("div",{className:"bg-green-100 text-green-600 p-2 rounded-lg",children:E.jsx(wo,{size:20})}),E.jsx("h3",{className:"font-bold text-slate-800",children:"Importar CSV"})]}),E.jsxs("p",{className:"text-sm text-slate-500 mb-6 leading-relaxed",children:["Cargue su catlogo masivamente. El archivo debe contener las columnas: ",E.jsx("br",{}),E.jsx("code",{className:"bg-slate-100 px-1 rounded text-blue-600 font-mono text-xs",children:"CodigoSIGES, ClasificadorSICOP, IdentificadorSICOP, Medicamento, Categoria, Lote, Vencimiento, Stock, StockMinimo, Unidad"})]}),E.jsx("input",{type:"file",ref:r,onChange:l,accept:".csv",className:"hidden"}),E.jsxs("button",{type:"button",onClick:n,className:"w-full flex flex-col items-center justify-center border-2 border-dashed border-slate-300 rounded-xl py-10 hover:border-blue-400 hover:bg-blue-50 transition-all group",children:[E.jsx(Cy,{size:40,className:"text-slate-300 group-hover:text-blue-500 mb-2 transition-colors"}),E.jsx("span",{className:"text-sm font-semibold text-slate-600 group-hover:text-blue-700",children:"Seleccionar archivo CSV"}),E.jsx("span",{className:"text-xs text-slate-400 mt-1",children:"Soporta .csv"})]}),t.message&&E.jsxs("div",{className:`mt-4 p-3 rounded-lg text-xs flex items-center space-x-2 ${t.type==="success"?"bg-green-50 text-green-700 border border-green-100":t.type==="error"?"bg-red-50 text-red-700 border border-red-100":"bg-blue-50 text-blue-700 border border-blue-100"}`,children:[t.type==="success"?E.jsx(Wd,{size:16}):E.jsx(zl,{size:16}),E.jsx("span",{children:t.message})]})]}),E.jsxs("div",{className:"lg:col-span-2 bg-white rounded-2xl border border-slate-200 shadow-sm overflow-hidden",children:[E.jsxs("div",{className:"p-4 border-b border-slate-100 bg-slate-50 flex justify-between items-center",children:[E.jsx("h3",{className:"font-bold text-slate-800",children:"Vista Previa del Catlogo"}),E.jsxs("div",{className:"flex items-center gap-3",children:[E.jsxs("button",{type:"button",onClick:()=>{!e?.length||!window.confirm("Desea eliminar todo el catlogo? Esta accin no se puede deshacer.")||h?.()},disabled:!e?.length,className:"text-xs text-red-600 font-bold flex items-center space-x-1 hover:underline disabled:opacity-40 disabled:hover:no-underline",children:[E.jsx(cu,{size:14}),E.jsx("span",{children:"Eliminar Catlogo"})]}),E.jsxs("button",{type:"button",onClick:i,className:"text-xs text-blue-600 font-bold flex items-center space-x-1 hover:underline",children:[E.jsx(Yd,{size:14}),E.jsx("span",{children:"Descargar Plantilla"})]})]})]}),E.jsx("div",{className:"max-h-[400px] overflow-y-auto",children:E.jsxs("table",{className:"w-full text-left",children:[E.jsx("thead",{className:"sticky top-0 bg-white shadow-sm text-slate-500 text-[10px] uppercase font-bold",children:E.jsxs("tr",{children:[E.jsx("th",{className:"px-6 py-3",children:"Cdigo SIGES"}),E.jsx("th",{className:"px-6 py-3",children:"Clasificador SICOP"}),E.jsx("th",{className:"px-6 py-3",children:"Identificador SICOP"}),E.jsx("th",{className:"px-6 py-3",children:"Medicamento"}),E.jsx("th",{className:"px-6 py-3 text-center",children:"Acciones"})]})}),E.jsx("tbody",{className:"divide-y divide-slate-100",children:x.map(g=>E.jsxs("tr",{className:"hover:bg-slate-50 transition-colors group",children:[E.jsx("td",{className:"px-6 py-3 text-sm text-slate-700 font-mono",children:g.siges_code||""}),E.jsx("td",{className:"px-6 py-3 text-sm text-slate-700 font-mono",children:g.sicop_classifier||""}),E.jsx("td",{className:"px-6 py-3 text-sm text-slate-700 font-mono",children:g.sicop_identifier||""}),E.jsx("td",{className:"px-6 py-3 text-sm font-medium text-slate-700",title:d(g.name).full,children:d(g.name).display}),E.jsx("td",{className:"px-6 py-3",children:E.jsxs("div",{className:"flex justify-center space-x-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[E.jsx("button",{type:"button",onClick:()=>o?.(g),className:"p-1.5 text-slate-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg","aria-label":"Editar",title:"Editar",children:E.jsx(Kb,{size:14})}),E.jsx("button",{type:"button",onClick:()=>u?.(g.id),className:"p-1.5 text-slate-400 hover:text-red-600 hover:bg-red-50 rounded-lg","aria-label":"Eliminar",title:"Eliminar",children:E.jsx(cu,{size:14})})]})})]},g.id))})]})})]})]})})}function bd(e){const t=typeof e=="number"?e:Number(String(e??"").replace(/,/g,""));return Number.isFinite(t)?t:0}function pl(e){const t=bd(e);return new Intl.NumberFormat("es-CR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(t)}function Dy(e){return e.length?e.reduce((t,r)=>t+r,0)/e.length:0}function uE(e){if(e.length<=1)return 0;const t=Dy(e),r=e.reduce((n,i)=>n+(i-t)**2,0)/e.length;return Math.sqrt(r)}function fE({siges_code:e,medication_name:t}){const r=String(e??"").trim();if(r)return`code:${r}`;const n=String(t??"").trim().toLowerCase();return n?`name:${n}`:""}function jg(e){const t=String(e||"").replace(/\D/g,"");return t.length<4?Number.POSITIVE_INFINITY:Number.parseInt(t.slice(-4),10)}function Pg(e){return String(e||"").trim().startsWith("110")}function hE({status:e}){if(!e?.message)return null;const t=e.type==="success"?"bg-emerald-50 border-emerald-200 text-emerald-800":e.type==="error"?"bg-rose-50 border-rose-200 text-rose-800":"bg-blue-50 border-blue-200 text-blue-800";return E.jsx("div",{className:`border rounded-lg px-4 py-3 text-sm ${t}`,children:E.jsx("span",{children:e.message})})}function dE({months:e,onRefresh:t,status:r}){const n=(e??[]).slice(0,3),i=n.map(I=>String(I?.label??"").trim()).filter(Boolean),[l,o]=$e.useState(""),[u,h]=$e.useState(!0),[d,x]=$e.useState(50),[g,v]=$e.useState(1),_=$e.useMemo(()=>{const I=new Map;return n.forEach((R,Q)=>{const G=R?.items??[];for(const ae of G){const ne=String(ae?.siges_code??"").trim(),J=String(ae?.medication_name??"").trim(),ge=fE({siges_code:ne,medication_name:J});if(!ge)continue;const ke=I.get(ge)??{siges_code:ne,medication_name:J,perMonth:[0,0,0]};ke.siges_code=ke.siges_code||ne,ke.medication_name=ke.medication_name||J,ke.perMonth[Q]+=bd(ae?.quantity),I.set(ge,ke)}}),Array.from(I.values()).map(R=>{const Q=R.perMonth.slice(0,3),G=Dy(Q),ae=uE(Q);return{...R,avg:G,sd:ae,total:G+ae}})},[n]),w=$e.useMemo(()=>{const I=l.trim().toLowerCase(),R=u?_.filter(G=>bd(G.total)>0):_;return(I?R.filter(G=>`${G.siges_code} ${G.medication_name}`.toLowerCase().includes(I)):R).sort((G,ae)=>{const ne=G?.siges_code||"",J=ae?.siges_code||"",ge=Pg(ne),ke=Pg(J);if(ge!==ke)return ge?-1:1;const be=jg(ne),Y=jg(J);return be!==Y?be-Y:String(ne).localeCompare(String(J),"es",{numeric:!0,sensitivity:"base"})})},[u,_,l]),y=w.length,b=Math.max(1,Number(d)||50),A=Math.max(1,Math.ceil(y/b)),M=Math.min(Math.max(g,1),A),T=$e.useMemo(()=>{const I=(M-1)*b;return w.slice(I,I+b)},[w,M,b]),U=y===0?0:(M-1)*b+1,q=Math.min(M*b,y);return E.jsxs("div",{className:"space-y-6",children:[E.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-5",children:[E.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[E.jsxs("div",{className:"space-y-1",children:[E.jsx("h3",{className:"font-semibold text-slate-800",children:"Resumen de consumo"}),E.jsx("p",{className:"text-xs text-slate-500",children:"Muestra por medicamento: cdigo, consumos de los ltimos 3 meses, promedio, desviacin estndar y total (promedio + desviacin)."})]}),E.jsx("div",{className:"flex flex-wrap items-center gap-2",children:E.jsxs("button",{type:"button",onClick:t,className:"px-3 py-2 rounded-lg border border-slate-200 text-slate-700 hover:bg-slate-50 text-sm flex items-center gap-2",children:[E.jsx(_o,{size:16}),"Sincronizar"]})})]}),E.jsx("div",{className:"mt-4",children:E.jsx(hE,{status:r})})]}),E.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm overflow-hidden",children:[E.jsxs("div",{className:"p-4 border-b border-slate-100 bg-slate-50 flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[E.jsxs("div",{className:"flex items-center gap-2",children:[E.jsx("div",{className:"bg-blue-50 text-blue-600 p-2 rounded-lg",children:E.jsx(Ay,{size:18})}),E.jsx("h3",{className:"font-bold text-slate-800",children:"Consumo por medicamento (ltimos 3 meses)"})]}),E.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[E.jsx("button",{type:"button",onClick:()=>{h(I=>!I),v(1)},className:"px-3 py-2 rounded-lg border border-slate-200 text-slate-700 hover:bg-slate-50 text-sm",title:"Oculta medicamentos con consumo 0 en los ltimos 3 meses",children:u?"Mostrar sin consumo":"Ocultar sin consumo"}),E.jsx("input",{value:l,onChange:I=>{o(I.target.value),v(1)},placeholder:"Buscar por cdigo o medicamento...",className:"w-72 border border-slate-200 rounded-lg px-3 py-2 text-sm bg-white"})]})]}),n.length===0?E.jsx("div",{className:"p-8 text-center text-slate-500 text-sm",children:"No hay consumos cargados."}):E.jsxs(E.Fragment,{children:[E.jsx("div",{className:"overflow-x-auto",children:E.jsxs("table",{className:"w-full min-w-[1100px] text-left",children:[E.jsx("thead",{className:"sticky top-0 z-10 bg-slate-50 text-slate-500 text-[10px] uppercase font-bold shadow-sm",children:E.jsxs("tr",{children:[E.jsx("th",{className:"px-4 py-4 whitespace-nowrap w-36 text-center",children:"Cdigo SIGES"}),E.jsx("th",{className:"px-4 py-4 whitespace-nowrap text-center",children:"Medicamento"}),E.jsx("th",{className:"px-3 py-4 text-center whitespace-nowrap w-32",children:i[2]??"Mes 3"}),E.jsx("th",{className:"px-3 py-4 text-center whitespace-nowrap w-32",children:i[1]??"Mes 2"}),E.jsx("th",{className:"px-3 py-4 text-center whitespace-nowrap w-32",children:i[0]??"Mes 1"}),E.jsx("th",{className:"px-3 py-4 text-center whitespace-nowrap w-28",children:"Promedio"}),E.jsx("th",{className:"px-3 py-4 text-center whitespace-nowrap w-28",children:"Desv. Est."}),E.jsx("th",{className:"px-3 py-4 text-center whitespace-nowrap w-36",children:"Total (Prom.+Desv.)"})]})}),E.jsxs("tbody",{className:"divide-y divide-slate-100",children:[T.map((I,R)=>E.jsxs("tr",{className:"hover:bg-slate-50",children:[E.jsx("td",{className:"px-4 py-4 text-xs text-slate-600 font-mono whitespace-nowrap text-center",children:I.siges_code||""}),E.jsx("td",{className:"px-4 py-4 text-sm font-medium text-slate-700 whitespace-normal break-words",children:I.medication_name}),E.jsx("td",{className:"px-3 py-4 text-center font-mono text-sm tabular-nums",children:pl(I.perMonth[2]??0)}),E.jsx("td",{className:"px-3 py-4 text-center font-mono text-sm tabular-nums",children:pl(I.perMonth[1]??0)}),E.jsx("td",{className:"px-3 py-4 text-center font-mono text-sm tabular-nums",children:pl(I.perMonth[0]??0)}),E.jsx("td",{className:"px-3 py-4 text-center font-mono text-sm tabular-nums",children:pl(I.avg)}),E.jsx("td",{className:"px-3 py-4 text-center font-mono text-sm tabular-nums",children:pl(I.sd)}),E.jsx("td",{className:"px-3 py-4 text-center font-mono text-sm font-bold text-blue-700 tabular-nums",children:pl(I.total)})]},`${I.siges_code||I.medication_name}-${R}`)),T.length===0&&E.jsx("tr",{children:E.jsx("td",{colSpan:8,className:"px-6 py-10 text-center text-sm text-slate-400",children:"No hay resultados."})})]})]})}),E.jsxs("div",{className:"p-4 border-t border-slate-100 bg-slate-50 flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[E.jsx("div",{className:"text-xs text-slate-500",children:y===0?"0 resultados":`Mostrando ${U}-${q} de ${y}`}),E.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[E.jsx("label",{className:"text-xs text-slate-500",children:"Filas"}),E.jsx("select",{value:b,onChange:I=>{x(Number(I.target.value)||50),v(1)},className:"border border-slate-200 rounded-lg px-2 py-1 text-xs bg-white",children:[25,50,100,200].map(I=>E.jsx("option",{value:I,children:I},I))}),E.jsx("button",{type:"button",onClick:()=>v(I=>Math.max(1,I-1)),disabled:M<=1,className:"px-3 py-1.5 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 disabled:opacity-40 disabled:hover:bg-white",children:"Anterior"}),E.jsxs("span",{className:"text-xs text-slate-600",children:["Pgina ",M," de ",A]}),E.jsx("button",{type:"button",onClick:()=>v(I=>Math.min(A,I+1)),disabled:M>=A,className:"px-3 py-1.5 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 disabled:opacity-40 disabled:hover:bg-white",children:"Siguiente"})]})]})]})]})]})}function H0({title:e,value:t,icon:r,color:n}){const i={blue:"bg-blue-50 text-blue-600 border-blue-100",red:"bg-red-50 text-red-600 border-red-100",green:"bg-green-50 text-green-600 border-green-100",purple:"bg-purple-50 text-purple-600 border-purple-100"},l=typeof t=="number"?new Intl.NumberFormat("en-US",{minimumFractionDigits:0,maximumFractionDigits:e==="Total Unidades"?2:0}).format(t):t;return E.jsxs("div",{className:"p-6 rounded-2xl border bg-white shadow-sm flex items-center space-x-4",children:[E.jsx("div",{className:`p-4 rounded-xl ${i[n]||i.blue}`,children:E.jsx(r,{size:24})}),E.jsxs("div",{children:[E.jsx("p",{className:"text-sm font-medium text-slate-500",children:e}),E.jsx("p",{className:"text-2xl font-bold text-slate-800",children:l})]})]})}function mE({stats:e,consumptions:t,lowStockItems:r,onViewAllConsumptions:n,onEditMedication:i}){return E.jsxs("div",{className:"space-y-8",children:[E.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[E.jsx(H0,{title:"Total Medicamentos",value:e.totalItems,icon:Ny,color:"blue"}),E.jsx(H0,{title:"Stock Crtico",value:e.lowStockCount,icon:zl,color:"red"}),E.jsx(H0,{title:"Total Unidades",value:e.totalStockValue,icon:lu,color:"green"}),E.jsx(H0,{title:"Consumos Recientes",value:e.recentConsumptions,icon:Kd,color:"purple"})]}),E.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[E.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[E.jsxs("div",{className:"flex justify-between items-center mb-4",children:[E.jsx("h3",{className:"font-bold text-slate-800",children:"ltimos Consumos"}),E.jsxs("button",{type:"button",onClick:n,className:"text-blue-600 text-sm flex items-center hover:underline",children:["Ver todo ",E.jsx(Db,{size:14})]})]}),E.jsx("div",{className:"space-y-4",children:t.slice(0,5).map(l=>E.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-lg",children:[E.jsxs("div",{className:"flex items-center space-x-3",children:[E.jsx("div",{className:"bg-white p-2 rounded-md shadow-sm border border-slate-100 text-slate-400",children:E.jsx(tE,{size:16})}),E.jsxs("div",{children:[E.jsx("p",{className:"font-semibold text-sm",children:l.medication_name}),E.jsx("p",{className:"text-xs text-slate-500",children:l.siges_code||l.date||""})]})]}),E.jsxs("div",{className:"text-right",children:[E.jsx("p",{className:"text-sm font-bold text-slate-800",children:l.quantity}),E.jsx("p",{className:"text-xs text-slate-500 font-mono",children:l.cost??l.user??""})]})]},l.id))})]}),E.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[E.jsxs("div",{className:"flex justify-between items-center mb-4",children:[E.jsx("h3",{className:"font-bold text-slate-800",children:"Medicamentos Agotndose"}),E.jsxs("span",{className:"bg-red-100 text-red-700 text-xs px-2 py-1 rounded-full font-bold",children:[r.length," Alertas"]})]}),E.jsx("div",{className:"space-y-4",children:r.length>0?r.map(l=>E.jsxs("div",{className:"flex items-center justify-between p-3 border-l-4 border-red-500 bg-red-50 rounded-r-lg",children:[E.jsxs("div",{children:[E.jsx("p",{className:"font-semibold text-sm text-slate-800",children:l.name}),E.jsxs("p",{className:"text-xs text-slate-500",children:["Mnimo: ",l.min_stock," | Actual: ",l.stock]})]}),E.jsx("button",{type:"button",onClick:()=>i(l),className:"text-xs bg-white border border-red-200 text-red-600 px-3 py-1 rounded hover:bg-red-100 transition-colors",children:"Reponer"})]},l.id)):E.jsx("div",{className:"text-center py-8",children:E.jsx("p",{className:"text-slate-400 text-sm italic",children:"No hay alertas activas de inventario."})})})]})]})]})}function xE({inventoryType:e,onInventoryTypeChange:t,inventoryStatus:r,fileInputRef:n,onChooseFile:i,onFileChange:l,onDownloadTemplate:o,onRefresh:u,canClear:h,onClearInventory:d,hideNoMovement:x,canToggleHideNoMovement:g,onToggleHideNoMovement:v,search:_,onSearchChange:w,items:y,totalItems:b,page:A,pageSize:M,onPageChange:T,onPageSizeChange:U}){const q=String(e||"772"),I=q==="771",R=q==="total",Q=R?"w-[260px] max-w-[260px]":"max-w-[620px]",G=_e=>{const Z=Number(_e);return Number.isFinite(Z)?Z.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):String(_e??"0")},ae=_e=>{const Z=String(_e??"").trim();if(!Z)return"S/N";const De=Z.match(/^(\d{4})-(\d{2})-(\d{2})/);if(De)return`${De[3]}/${De[2]}/${De[1]}`;const j=new Date(Z);if(!Number.isNaN(j.getTime())){const N=String(j.getDate()).padStart(2,"0"),z=String(j.getMonth()+1).padStart(2,"0"),P=String(j.getFullYear());return`${N}/${z}/${P}`}return Z},ne=_e=>{if(!_e)return"";const Z=String(_e.batch||"").trim()||"S/N",De=ae(_e.expiry_date),j=G(_e.stock);return`${Z} (${De}): ${j}`},J=Number(b)||0,ge=Number(M)||50,ke=Math.max(1,Math.ceil(J/ge)),be=Math.min(Math.max(Number(A)||1,1),ke),Y=J===0?0:(be-1)*ge+1,le=Math.min(be*ge,J);return E.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden",children:[E.jsxs("div",{className:"p-4 border-b border-slate-100 bg-slate-50 flex flex-col gap-3",children:[E.jsxs("div",{className:"flex flex-wrap gap-3 items-center justify-between",children:[E.jsx("div",{className:"flex items-center gap-2",children:[{key:"772",label:"Inventario 772"},{key:"771",label:"Inventario 771"},{key:"total",label:"Inventario total"}].map(_e=>E.jsx("button",{type:"button",onClick:()=>t?.(_e.key),className:`px-3 py-1.5 rounded-lg text-xs font-bold border transition-colors ${q===_e.key?"bg-blue-600 text-white border-blue-600":"bg-white text-slate-600 border-slate-200 hover:bg-blue-50 hover:text-blue-700"}`,children:_e.label},_e.key))}),E.jsxs("div",{className:"flex items-center gap-2",children:[E.jsxs("button",{type:"button",onClick:u,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 flex items-center gap-2",title:"Sincronizar inventarios",children:[E.jsx(_o,{size:14}),"Sincronizar"]}),R&&E.jsxs("button",{type:"button",onClick:()=>v?.(),disabled:!g,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 flex items-center gap-2 disabled:opacity-40 disabled:hover:bg-white",title:g?"Oculta medicamentos sin consumo en los ltimos 4 meses.":"No hay consumos cargados para filtrar.",children:[x?E.jsx(jb,{size:14}):E.jsx(Ib,{size:14}),x?"Mostrar sin movimiento":"Ocultar sin movimiento (4 meses)"]}),!R&&E.jsxs(E.Fragment,{children:[E.jsx("input",{type:"file",ref:n,onChange:l,accept:I?".xml":".csv",className:"hidden"}),E.jsxs("button",{type:"button",onClick:i,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-blue-50 hover:text-blue-700 flex items-center gap-2",children:[E.jsx(wo,{size:14}),I?"Cargar XML":"Cargar CSV"]}),E.jsxs("button",{type:"button",onClick:()=>o?.(e),className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 flex items-center gap-2",children:[E.jsx(Yd,{size:14}),"Plantilla"]}),E.jsxs("button",{type:"button",onClick:()=>d?.(e),disabled:!h,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-red-200 text-red-600 hover:bg-red-50 flex items-center gap-2 disabled:opacity-40 disabled:hover:bg-white",title:"Eliminar toda la carga de este inventario",children:[E.jsx(cu,{size:14}),"Eliminar carga"]})]})]})]}),r?.message&&E.jsxs("div",{className:`p-3 rounded-lg text-xs flex items-center gap-2 ${r.type==="success"?"bg-green-50 text-green-700 border border-green-100":r.type==="error"?"bg-red-50 text-red-700 border border-red-100":"bg-blue-50 text-blue-700 border border-blue-100"}`,children:[r.type==="success"?E.jsx(Wd,{size:16}):E.jsx(zl,{size:16}),E.jsx("span",{children:r.message})]}),E.jsxs("div",{className:"relative w-72",children:[E.jsx(Oy,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:18}),E.jsx("input",{type:"text",value:_,onChange:_e=>w(_e.target.value),placeholder:"Buscar medicamento...",className:"w-full pl-10 pr-4 py-2 border border-slate-200 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 outline-none"})]})]}),E.jsx("div",{className:"overflow-x-auto",children:E.jsxs("table",{className:"min-w-max w-full text-left",children:[E.jsx("thead",{className:"bg-slate-50 text-slate-500 text-[10px] uppercase font-bold",children:E.jsxs("tr",{children:[E.jsx("th",{className:"px-6 py-4 text-center whitespace-nowrap",children:"Cdigo SIGES"}),E.jsx("th",{className:`px-6 py-4 whitespace-nowrap ${Q}`,children:"Medicamento"}),R&&E.jsx("th",{className:"px-6 py-4 text-center whitespace-nowrap",children:"Inv. 772"}),(I||R)&&E.jsx("th",{className:"px-6 py-4 whitespace-nowrap",children:"Lotes 771 (venc. / cant.)"}),R&&E.jsx("th",{className:"px-6 py-4 text-center whitespace-nowrap",children:"Inv. 771"}),E.jsx("th",{className:"px-6 py-4 text-center whitespace-nowrap",children:R?"Inventario total":"Inventario"})]})}),E.jsxs("tbody",{className:"divide-y divide-slate-100",children:[y.map(_e=>E.jsxs("tr",{className:"hover:bg-slate-50 transition-colors group text-sm",children:[E.jsx("td",{className:"px-6 py-4 text-slate-700 font-mono text-center whitespace-nowrap",children:_e.siges_code||""}),E.jsx("td",{className:`px-6 py-4 ${Q} text-slate-700`,children:E.jsx("span",{className:"block truncate",children:_e.name})}),R&&E.jsx("td",{className:"px-6 py-4 text-center whitespace-nowrap text-slate-700 font-mono",children:G(_e.stock772)}),(I||R)&&E.jsx("td",{className:`px-6 py-4 text-slate-600 font-mono ${R?"text-center":""}`,children:E.jsx("div",{className:`flex flex-col gap-1 ${R?"items-center":""}`,children:Array.isArray(_e.lots)&&_e.lots.length>0?_e.lots.map(Z=>E.jsx("div",{className:"whitespace-nowrap",children:ne(Z)},Z.id||`${Z.batch}-${Z.expiry_date}`)):E.jsx("div",{className:"whitespace-nowrap",children:R?"":ne(_e)})})}),R&&E.jsx("td",{className:"px-6 py-4 text-center whitespace-nowrap text-slate-700 font-mono",children:G(_e.stock771)}),E.jsx("td",{className:"px-6 py-4 text-center whitespace-nowrap text-slate-800",children:E.jsx("span",{className:"font-bold",children:G(_e.stock)})})]},_e.id)),y.length===0&&E.jsx("tr",{children:E.jsxs("td",{colSpan:R?6:I?4:3,className:"px-6 py-10 text-center text-sm text-slate-400",children:['No hay resultados para "',_,'".']})})]})]})}),E.jsxs("div",{className:"p-4 border-t border-slate-100 bg-slate-50 flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[E.jsx("div",{className:"text-xs text-slate-500",children:J===0?"0 resultados":`Mostrando ${Y}-${le} de ${J}`}),E.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[E.jsx("label",{className:"text-xs text-slate-500",children:"Filas"}),E.jsx("select",{value:ge,onChange:_e=>U?.(Number(_e.target.value)||50),className:"border border-slate-200 rounded-lg px-2 py-1 text-xs bg-white",children:[25,50,100,200].map(_e=>E.jsx("option",{value:_e,children:_e},_e))}),E.jsx("button",{type:"button",onClick:()=>T?.(be-1),disabled:be<=1,className:"px-3 py-1.5 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 disabled:opacity-40 disabled:hover:bg-white",children:"Anterior"}),E.jsxs("span",{className:"text-xs text-slate-600",children:["Pgina ",be," de ",ke]}),E.jsx("button",{type:"button",onClick:()=>T?.(be+1),disabled:be>=ke,className:"px-3 py-1.5 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 disabled:opacity-40 disabled:hover:bg-white",children:"Siguiente"})]})]})]})}function pE({status:e}){if(!e?.message)return null;const t=e.type==="success"?"bg-emerald-50 border-emerald-200 text-emerald-800":e.type==="error"?"bg-rose-50 border-rose-200 text-rose-800":"bg-blue-50 border-blue-200 text-blue-800";return E.jsx("div",{className:`border rounded-lg px-4 py-3 text-sm ${t}`,children:E.jsx("span",{children:e.message})})}function gE({months:e,selectedMonthId:t,onSelectMonth:r,monthlyStatus:n,fileInputRef:i,onChooseFile:l,onFileChange:o,onDownloadTemplate:u,onRefresh:h}){const d=e.find(v=>v.id===t)||null,x=v=>{const _=typeof v=="number"?v:Number(v);return Number.isFinite(_)?new Intl.NumberFormat("es-CR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(_):""},g=v=>{const _=typeof v=="number"?v:Number(v);return Number.isFinite(_)?new Intl.NumberFormat("es-CR",{style:"currency",currency:"CRC",minimumFractionDigits:2,maximumFractionDigits:2}).format(_):""};return E.jsxs("div",{className:"space-y-4",children:[E.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-5",children:[E.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[E.jsxs("div",{className:"space-y-1",children:[E.jsx("h3",{className:"font-semibold text-slate-800",children:"Importar consumo mensual"}),E.jsxs("p",{className:"text-xs text-slate-500",children:["Recomendado: nombre del archivo ",E.jsx("span",{className:"font-mono",children:"Enero 2025.csv"})," (se usa como nombre del mes)."]})]}),E.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[E.jsx("input",{type:"file",ref:i,onChange:o,accept:".csv",className:"hidden"}),E.jsxs("button",{type:"button",onClick:u,className:"px-3 py-2 rounded-lg border border-slate-200 text-slate-700 hover:bg-slate-50 text-sm flex items-center gap-2",children:[E.jsx(zb,{size:16}),"Descargar plantilla"]}),E.jsxs("button",{type:"button",onClick:h,className:"px-3 py-2 rounded-lg border border-slate-200 text-slate-700 hover:bg-slate-50 text-sm flex items-center gap-2",children:[E.jsx(_o,{size:16}),"Sincronizar"]}),E.jsxs("button",{type:"button",onClick:l,className:"px-3 py-2 rounded-lg bg-blue-600 hover:bg-blue-700 text-white text-sm flex items-center gap-2",children:[E.jsx(wo,{size:16}),"Importar CSV"]})]})]}),E.jsx("div",{className:"mt-4",children:E.jsx(pE,{status:n})}),E.jsxs("div",{className:"mt-4 flex flex-col gap-2 md:flex-row md:items-center",children:[E.jsx("label",{className:"text-xs font-semibold text-slate-600",children:"Mes cargado"}),E.jsxs("select",{className:"border border-slate-200 rounded-lg px-3 py-2 text-sm bg-white",value:t??"",onChange:v=>r(v.target.value||null),children:[E.jsx("option",{value:"",children:"Seleccione un mes..."}),e.map(v=>E.jsx("option",{value:v.id,children:v.label},v.id))]})]})]}),E.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden",children:[E.jsxs("div",{className:"px-6 py-4 border-b border-slate-100 flex items-center justify-between",children:[E.jsx("h4",{className:"font-semibold text-slate-800",children:d?`Detalle: ${d.label}`:"Detalle del mes"}),d&&E.jsxs("span",{className:"text-xs text-slate-500",children:[d.items.length," registros"]})]}),d?d.items.length===0?E.jsx("div",{className:"p-8 text-center text-slate-500 text-sm",children:"No hay consumos en este mes."}):E.jsxs("table",{className:"w-full text-left",children:[E.jsx("thead",{className:"bg-slate-50 text-slate-500 text-[10px] uppercase font-bold",children:E.jsxs("tr",{children:[E.jsx("th",{className:"px-6 py-4 whitespace-nowrap w-32 text-center",children:"Cdigo SIGES"}),E.jsx("th",{className:"px-6 py-4",children:"Medicamento"}),E.jsx("th",{className:"px-6 py-4 text-center whitespace-nowrap",children:"Consumo"}),E.jsx("th",{className:"px-6 py-4 text-center whitespace-nowrap",children:"Costo"})]})}),E.jsx("tbody",{className:"divide-y divide-slate-100",children:d.items.map(v=>E.jsxs("tr",{className:"hover:bg-slate-50",children:[E.jsx("td",{className:"px-6 py-4 text-xs text-slate-500 font-mono whitespace-nowrap w-32 text-center",children:v.siges_code||""}),E.jsx("td",{className:"px-6 py-4 text-sm font-medium",children:v.medication_name}),E.jsx("td",{className:"px-6 py-4 text-center text-slate-800 font-semibold text-sm tabular-nums",children:x(v.quantity)}),E.jsx("td",{className:"px-6 py-4 text-center text-slate-700 text-sm font-mono tabular-nums",children:g(v.cost)})]},v.id))})]}):E.jsx("div",{className:"p-8 text-center text-slate-500 text-sm",children:"Importa un CSV y selecciona un mes para ver el detalle."})]})]})}function fs(e){const t=typeof e=="number"?e:Number(String(e??"").trim().replace(/\s/g,"").replace(/,/g,""));return Number.isFinite(t)?t:0}function vn(e){const t=fs(e);return new Intl.NumberFormat("es-CR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(t)}function Fy(e){return e.length?e.reduce((t,r)=>t+r,0)/e.length:0}function vE(e){if(e.length<=1)return 0;const t=Fy(e),r=e.reduce((n,i)=>n+(i-t)**2,0)/e.length;return Math.sqrt(r)}function yE({siges_code:e,medication_name:t}){const r=String(e??"").trim();if(r)return`code:${r}`;const n=String(t??"").trim().toLowerCase();return n?`name:${n}`:""}function zg(e){const t=String(e||"").replace(/\D/g,"");return t.length<4?Number.POSITIVE_INFINITY:Number.parseInt(t.slice(-4),10)}function Hg(e){return String(e||"").trim().startsWith("110")}function Vg({status:e}){if(!e?.message)return null;const t=e.type==="success"?"bg-emerald-50 border-emerald-200 text-emerald-800":e.type==="error"?"bg-rose-50 border-rose-200 text-rose-800":"bg-blue-50 border-blue-200 text-blue-800";return E.jsx("div",{className:`border rounded-lg px-4 py-3 text-sm ${t}`,children:E.jsx("span",{children:e.message})})}function _E({medications:e,months:t,inventoryStatus:r,monthlyStatus:n,onRefreshInventories:i,onRefreshConsumptions:l}){const[o,u]=$e.useState(3),[h,d]=$e.useState(""),[x,g]=$e.useState(!0),[v,_]=$e.useState(50),[w,y]=$e.useState(1),b=$e.useMemo(()=>{const ae=(t??[]).slice(0,3),ne=ae.map(Y=>String(Y?.label??"").trim()).filter(Boolean),J=new Map;for(const Y of e??[]){const le=String(Y?.siges_code??"").trim();if(!le)continue;const _e=String(Y?.inventory_type||"772"),Z=J.get(le)??{inv771:0,inv772:0};_e==="771"&&(Z.inv771+=fs(Y?.stock)),_e==="772"&&(Z.inv772+=fs(Y?.stock)),J.set(le,Z)}const ge=new Map;ae.forEach((Y,le)=>{const _e=Y?.items??[];for(const Z of _e){const De=String(Z?.siges_code??"").trim(),j=String(Z?.medication_name??"").trim(),N=yE({siges_code:De,medication_name:j});if(!N)continue;const z=ge.get(N)??{siges_code:De,medication_name:j,perMonth:[0,0,0]};z.siges_code=z.siges_code||De,z.medication_name=z.medication_name||j,z.perMonth[le]+=fs(Z?.quantity),ge.set(N,z)}});const ke=Math.max(0,Number(o)||0),be=Array.from(ge.values()).map(Y=>{const le=Y.perMonth.slice(0,3),_e=Fy(le),Z=vE(le),De=_e+Z,j=String(Y.siges_code??"").trim(),N=J.get(j)??{inv771:0,inv772:0},z=fs(N.inv771)+fs(N.inv772),P=De*ke-z,V=Math.max(0,P);return{siges_code:j,medication_name:Y.medication_name,perMonth:le,avg:_e,sd:Z,consumoTotal:De,inv771:N.inv771,inv772:N.inv772,invTotal:z,pedido:V}});return{monthLabels:ne,rows:be}},[e,t,o]),A=b.monthLabels??[],M=$e.useMemo(()=>{const ae=h.trim().toLowerCase(),ne=b.rows??[],J=x?ne.filter(ke=>fs(ke.pedido)>0):ne;return(ae?J.filter(ke=>`${ke.siges_code} ${ke.medication_name}`.toLowerCase().includes(ae)):J).sort((ke,be)=>{const Y=ke?.siges_code||"",le=be?.siges_code||"",_e=Hg(Y),Z=Hg(le);if(_e!==Z)return _e?-1:1;const De=zg(Y),j=zg(le);return De!==j?De-j:String(Y).localeCompare(String(le),"es",{numeric:!0,sensitivity:"base"})})},[b.rows,x,h]),T=M.length,U=Math.max(1,Number(v)||50),q=Math.max(1,Math.ceil(T/U)),I=Math.min(Math.max(w,1),q),R=T===0?0:(I-1)*U+1,Q=Math.min(I*U,T),G=$e.useMemo(()=>{const ae=(I-1)*U;return M.slice(ae,ae+U)},[M,I,U]);return E.jsxs("div",{className:"space-y-6",children:[E.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-5",children:[E.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[E.jsxs("div",{className:"space-y-1",children:[E.jsx("h3",{className:"font-semibold text-slate-800",children:"Solicitud Pedido"}),E.jsx("p",{className:"text-xs text-slate-500",children:"Pedido = (Consumo Total  Meses)  (Inventario 772 + Inventario 771). Consumo Total = Promedio + Desv. Est."})]}),E.jsx("div",{className:"flex flex-wrap items-center gap-2",children:E.jsxs("button",{type:"button",onClick:()=>{l?.(),i?.()},className:"px-3 py-2 rounded-lg border border-slate-200 text-slate-700 hover:bg-slate-50 text-sm flex items-center gap-2",children:[E.jsx(_o,{size:16}),"Sincronizar"]})})]}),E.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-3 gap-3",children:[E.jsxs("div",{className:"md:col-span-1",children:[E.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase mb-1",children:"Meses a pedir"}),E.jsx("input",{type:"number",min:0,step:1,value:o,onChange:ae=>{u(Number(ae.target.value)||0),y(1)},className:"w-full border border-slate-200 rounded-lg px-3 py-2 text-sm bg-white"})]}),E.jsxs("div",{className:"md:col-span-2 flex flex-col gap-2",children:[E.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase mb-1",children:"Filtros"}),E.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[E.jsx("button",{type:"button",onClick:()=>{g(ae=>!ae),y(1)},className:"px-3 py-2 rounded-lg border border-slate-200 text-slate-700 hover:bg-slate-50 text-sm",children:x?"Mostrar pedido 0":"Ocultar pedido 0"}),E.jsx("input",{value:h,onChange:ae=>{d(ae.target.value),y(1)},placeholder:"Buscar por cdigo o medicamento...",className:"flex-1 min-w-72 border border-slate-200 rounded-lg px-3 py-2 text-sm bg-white"})]})]})]}),E.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-3",children:[E.jsx(Vg,{status:r}),E.jsx(Vg,{status:n})]})]}),E.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm overflow-hidden",children:[E.jsxs("div",{className:"p-4 border-b border-slate-100 bg-slate-50 flex items-center justify-between",children:[E.jsxs("div",{className:"flex items-center gap-3",children:[E.jsx("div",{className:"bg-blue-50 text-blue-600 p-2 rounded-lg",children:E.jsx(Kd,{size:18})}),E.jsxs("div",{children:[E.jsx("h3",{className:"font-bold text-slate-800",children:"Clculo por medicamento"}),E.jsxs("p",{className:"text-xs text-slate-500",children:["Meses usados: ",A.length?A.slice().reverse().join(", "):"Sin datos"]})]})]}),E.jsxs("span",{className:"text-xs text-slate-500",children:[T," filas"]})]}),E.jsx("div",{className:"overflow-x-auto",children:E.jsxs("table",{className:"w-full min-w-[1400px] text-left",children:[E.jsx("thead",{className:"sticky top-0 z-10 bg-slate-50 text-slate-500 text-[10px] uppercase font-bold shadow-sm",children:E.jsxs("tr",{children:[E.jsx("th",{className:"px-4 py-4 whitespace-nowrap w-36 text-center",children:"Cdigo"}),E.jsx("th",{className:"px-4 py-4 whitespace-nowrap text-center",children:"Medicamento"}),E.jsx("th",{className:"px-3 py-4 text-center whitespace-nowrap w-32",children:A[2]??"Mes 3"}),E.jsx("th",{className:"px-3 py-4 text-center whitespace-nowrap w-32",children:A[1]??"Mes 2"}),E.jsx("th",{className:"px-3 py-4 text-center whitespace-nowrap w-32",children:A[0]??"Mes 1"}),E.jsx("th",{className:"px-3 py-4 text-center whitespace-nowrap w-28",children:"Promedio"}),E.jsx("th",{className:"px-3 py-4 text-center whitespace-nowrap w-28",children:"Desv. Est."}),E.jsx("th",{className:"px-3 py-4 text-center whitespace-nowrap w-32",children:"Consumo Total"}),E.jsx("th",{className:"px-3 py-4 text-center whitespace-nowrap w-28",children:"Inv. 772"}),E.jsx("th",{className:"px-3 py-4 text-center whitespace-nowrap w-28",children:"Inv. 771"}),E.jsx("th",{className:"px-3 py-4 text-center whitespace-nowrap w-28",children:"Inv. Total"}),E.jsx("th",{className:"px-3 py-4 text-center whitespace-nowrap w-28",children:"Meses"}),E.jsx("th",{className:"px-3 py-4 text-center whitespace-nowrap w-28",children:"Pedido"})]})}),E.jsxs("tbody",{className:"divide-y divide-slate-100",children:[G.map((ae,ne)=>E.jsxs("tr",{className:"hover:bg-slate-50",children:[E.jsx("td",{className:"px-4 py-4 text-xs text-slate-600 font-mono whitespace-nowrap text-center",children:ae.siges_code||""}),E.jsx("td",{className:"px-4 py-4 text-sm font-medium text-slate-700 whitespace-normal break-words",children:ae.medication_name}),E.jsx("td",{className:"px-3 py-4 text-center font-mono text-sm tabular-nums",children:vn(ae.perMonth[2]??0)}),E.jsx("td",{className:"px-3 py-4 text-center font-mono text-sm tabular-nums",children:vn(ae.perMonth[1]??0)}),E.jsx("td",{className:"px-3 py-4 text-center font-mono text-sm tabular-nums",children:vn(ae.perMonth[0]??0)}),E.jsx("td",{className:"px-3 py-4 text-center font-mono text-sm tabular-nums",children:vn(ae.avg)}),E.jsx("td",{className:"px-3 py-4 text-center font-mono text-sm tabular-nums",children:vn(ae.sd)}),E.jsx("td",{className:"px-3 py-4 text-center font-mono text-sm tabular-nums",children:vn(ae.consumoTotal)}),E.jsx("td",{className:"px-3 py-4 text-center font-mono text-sm tabular-nums",children:vn(ae.inv772)}),E.jsx("td",{className:"px-3 py-4 text-center font-mono text-sm tabular-nums",children:vn(ae.inv771)}),E.jsx("td",{className:"px-3 py-4 text-center font-mono text-sm tabular-nums",children:vn(ae.invTotal)}),E.jsx("td",{className:"px-3 py-4 text-center font-mono text-sm tabular-nums",children:o}),E.jsx("td",{className:"px-3 py-4 text-center font-mono text-sm font-bold text-blue-700 tabular-nums",children:vn(ae.pedido)})]},`${ae.siges_code||ae.medication_name}-${ne}`)),G.length===0&&E.jsx("tr",{children:E.jsx("td",{colSpan:13,className:"px-6 py-10 text-center text-sm text-slate-400",children:"No hay resultados."})})]})]})}),E.jsxs("div",{className:"p-4 border-t border-slate-100 bg-slate-50 flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[E.jsx("div",{className:"text-xs text-slate-500",children:T===0?"0 resultados":`Mostrando ${R}-${Q} de ${T}`}),E.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[E.jsx("label",{className:"text-xs text-slate-500",children:"Filas"}),E.jsx("select",{value:U,onChange:ae=>{_(Number(ae.target.value)||50),y(1)},className:"border border-slate-200 rounded-lg px-2 py-1 text-xs bg-white",children:[25,50,100,200].map(ae=>E.jsx("option",{value:ae,children:ae},ae))}),E.jsx("button",{type:"button",onClick:()=>y(ae=>Math.max(1,ae-1)),disabled:I<=1,className:"px-3 py-1.5 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 disabled:opacity-40 disabled:hover:bg-white",children:"Anterior"}),E.jsxs("span",{className:"text-xs text-slate-600",children:["Pgina ",I," de ",q]}),E.jsx("button",{type:"button",onClick:()=>y(ae=>Math.min(q,ae+1)),disabled:I>=q,className:"px-3 py-1.5 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 disabled:opacity-40 disabled:hover:bg-white",children:"Siguiente"})]})]})]})]})}function wE({status:e,fileInputRef:t,onChooseFile:r,onFileChange:n,onDownloadTemplate:i,onRefresh:l,canClear:o,onClear:u,search:h,onSearchChange:d,items:x,totalItems:g,page:v,pageSize:_,onPageChange:w,onPageSizeChange:y}){const b=R=>{const Q=Number(R);return Number.isFinite(Q)?Q.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):String(R??"0")},A=Number(g)||0,M=Number(_)||50,T=Math.max(1,Math.ceil(A/M)),U=Math.min(Math.max(Number(v)||1,1),T),q=A===0?0:(U-1)*M+1,I=Math.min(U*M,A);return E.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden",children:[E.jsxs("div",{className:"p-4 border-b border-slate-100 bg-slate-50 flex flex-col gap-3",children:[E.jsxs("div",{className:"flex flex-wrap gap-3 items-center justify-between",children:[E.jsxs("div",{className:"relative w-80",children:[E.jsx(Oy,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:18}),E.jsx("input",{type:"text",value:h,onChange:R=>d?.(R.target.value),placeholder:"Buscar por cdigo o medicamento...",className:"w-full pl-10 pr-4 py-2 border border-slate-200 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 outline-none"})]}),E.jsxs("div",{className:"flex items-center gap-2",children:[E.jsx("input",{type:"file",ref:t,onChange:n,accept:".xlsx",className:"hidden"}),E.jsxs("button",{type:"button",onClick:l,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 flex items-center gap-2",title:"Sincronizar empaque terciario",children:[E.jsx(_o,{size:14}),"Sincronizar"]}),E.jsxs("button",{type:"button",onClick:r,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-blue-50 hover:text-blue-700 flex items-center gap-2",children:[E.jsx(wo,{size:14}),"Cargar XLSX"]}),E.jsxs("button",{type:"button",onClick:i,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 flex items-center gap-2",children:[E.jsx(Yd,{size:14}),"Plantilla"]}),E.jsxs("button",{type:"button",onClick:u,disabled:!o,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-red-200 text-red-600 hover:bg-red-50 flex items-center gap-2 disabled:opacity-40 disabled:hover:bg-white",title:"Eliminar toda la carga",children:[E.jsx(cu,{size:14}),"Eliminar carga"]})]})]}),e?.message&&E.jsxs("div",{className:`p-3 rounded-lg text-xs flex items-center gap-2 ${e.type==="success"?"bg-green-50 text-green-700 border border-green-100":e.type==="error"?"bg-red-50 text-red-700 border border-red-100":"bg-blue-50 text-blue-700 border border-blue-100"}`,children:[e.type==="success"?E.jsx(Wd,{size:16}):E.jsx(zl,{size:16}),E.jsx("span",{children:e.message})]})]}),E.jsx("div",{className:"overflow-x-auto",children:E.jsxs("table",{className:"min-w-max w-full text-left",children:[E.jsx("thead",{className:"bg-slate-50 text-slate-500 text-[10px] uppercase font-bold",children:E.jsxs("tr",{children:[E.jsx("th",{className:"px-6 py-4 text-center whitespace-nowrap",children:"Cdigo SIGES"}),E.jsx("th",{className:"px-6 py-4 whitespace-nowrap",children:"Medicamento"}),E.jsx("th",{className:"px-6 py-4 text-center whitespace-nowrap",children:"Empaque terciario"})]})}),E.jsxs("tbody",{className:"divide-y divide-slate-100",children:[x.map(R=>E.jsxs("tr",{className:"hover:bg-slate-50 transition-colors group text-sm",children:[E.jsx("td",{className:"px-6 py-4 text-slate-700 font-mono text-center whitespace-nowrap",children:R.siges_code}),E.jsx("td",{className:"px-6 py-4 text-slate-700 max-w-[520px]",children:E.jsx("span",{className:"block truncate",children:R.medication_name})}),E.jsx("td",{className:"px-6 py-4 text-center whitespace-nowrap text-slate-800 font-mono",children:b(R.tertiary_quantity)})]},R.id)),x.length===0&&E.jsx("tr",{children:E.jsxs("td",{colSpan:3,className:"px-6 py-10 text-center text-sm text-slate-400",children:['No hay resultados para "',h,'".']})})]})]})}),E.jsxs("div",{className:"p-4 border-t border-slate-100 bg-slate-50 flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[E.jsx("div",{className:"text-xs text-slate-500",children:A===0?"0 resultados":`Mostrando ${q}-${I} de ${A}`}),E.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[E.jsx("label",{className:"text-xs text-slate-500",children:"Filas"}),E.jsx("select",{value:M,onChange:R=>y?.(Number(R.target.value)||50),className:"border border-slate-200 rounded-lg px-2 py-1 text-xs bg-white",children:[25,50,100,200].map(R=>E.jsx("option",{value:R,children:R},R))}),E.jsx("button",{type:"button",onClick:()=>w?.(U-1),disabled:U<=1,className:"px-3 py-1.5 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 disabled:opacity-40 disabled:hover:bg-white",children:"Anterior"}),E.jsxs("span",{className:"text-xs text-slate-600",children:["Pgina ",U," de ",T]}),E.jsx("button",{type:"button",onClick:()=>w?.(U+1),disabled:U>=T,className:"px-3 py-1.5 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 disabled:opacity-40 disabled:hover:bg-white",children:"Siguiente"})]})]})]})}function SE(e){return e.replace(/^\uFEFF/,"")}function bE(e){const t=(e.match(/,/g)||[]).length;return(e.match(/;/g)||[]).length>t?";":","}function My(e){const t=SE(e).replace(/\r\n/g,`
`).replace(/\r/g,`
`),r=[];let n=[],i="",l=!1,o=0;const u=t.split(`
`)[0]||"",h=bE(u);for(;o<t.length;){const x=t[o];if(l){if(x==='"'){if(t[o+1]==='"'){i+='"',o+=2;continue}l=!1,o+=1;continue}i+=x,o+=1;continue}if(x==='"'){l=!0,o+=1;continue}if(x===h){n.push(i),i="",o+=1;continue}if(x===`
`){n.push(i),i="",n.every(v=>String(v||"").trim()==="")||r.push(n),n=[],o+=1;continue}i+=x,o+=1}return n.push(i),n.every(x=>String(x||"").trim()==="")||r.push(n),{rows:r,delimiter:h}}function $g(e){const{rows:t}=My(e);return t}function EE(e){return String(e||"").trim().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]/g,"")}function TE(e){const t={nombre:"Nombre",name:"Nombre",categoria:"Categoria",category:"Categoria",codigosiges:"CodigoSIGES",codsiges:"CodigoSIGES",siges:"CodigoSIGES",codigosicop:"IdentificadorSICOP",identificadorsicop:"IdentificadorSICOP",identificac:"IdentificadorSICOP",identificador:"IdentificadorSICOP",idsicop:"IdentificadorSICOP",clasificadorsicop:"ClasificadorSICOP",clasificador:"ClasificadorSICOP",sicopclasificador:"ClasificadorSICOP",sicopidentificador:"IdentificadorSICOP",medicamento:"Medicamento",descripcionsicop:"Medicamento",descripcion:"Medicamento",lote:"Lote",batch:"Lote",vencimiento:"Vencimiento",expirydate:"Vencimiento",stock:"Stock",stockminimo:"StockMinimo",minstock:"StockMinimo",unidad:"Unidad",unit:"Unidad",producto:"Medicamento",item:"Medicamento",cantidad:"Cantidad",consumo:"Cantidad",salida:"Cantidad",responsable:"Responsable",usuario:"Responsable",user:"Responsable",motivo:"Motivo",destino:"Motivo",observacion:"Motivo",fecha:"Fecha",fechahora:"Fecha",date:"Fecha"};return e.map(r=>t[EE(r)]||String(r||"").trim())}function Qh(e){if(e instanceof Date&&!Number.isNaN(e.getTime()))return e.toISOString().slice(0,10);const t=String(e??"").trim();if(!t)return new Date().toISOString().slice(0,10);const r=t.slice(0,10);if(/^\d{4}-\d{2}-\d{2}$/.test(r))return r;const n=new Date(t);return Number.isNaN(n.getTime())?new Date().toISOString().slice(0,10):n.toISOString().slice(0,10)}function Il(e,t){const r=String(e??"");return r.includes('"')||r.includes(`
`)||r.includes("\r")||r.includes(t)?`"${r.replace(/"/g,'""')}"`:r}function kE(){const t=["CodigoSIGES","ClasificadorSICOP","IdentificadorSICOP","Medicamento","Categoria","Lote","Vencimiento","Stock","StockMinimo","Unidad"],r=["SIG-0001","SICOP-CL-01","SICOP-ID-0001","Paracetamol","Analgsico","LOT-2025-01","2027-12-31",100,20,"Tabletas"],i=`\uFEFF${[t.map(h=>Il(h,";")).join(";"),r.map(h=>Il(h,";")).join(";")].join(`
`)}
`,l=new Blob([i],{type:"text/csv;charset=utf-8"}),o=URL.createObjectURL(l),u=document.createElement("a");u.href=o,u.download="plantilla_catalogo.csv",document.body.appendChild(u),u.click(),u.remove(),URL.revokeObjectURL(o)}function AE(){const t=["CodigoSIGES","Medicamento","Consumo","Costo"],r=["110-16-0010","Paracetamol",1555.85,148621015e-2],i=`\uFEFF${[t.map(h=>Il(h,";")).join(";"),r.map(h=>Il(h,";")).join(";")].join(`
`)}
`,l=new Blob([i],{type:"text/csv;charset=utf-8"}),o=URL.createObjectURL(l),u=document.createElement("a");u.href=o,u.download="plantilla_consumo_mensual.csv",document.body.appendChild(u),u.click(),u.remove(),URL.revokeObjectURL(o)}function Gg(e){const{rows:t}=My(e);if(t.length===0)return[];const r=t[0],n=TE(r);return t.slice(1).map(l=>{const o={};for(let u=0;u<n.length;u+=1){const h=n[u];h&&(o[h]=l[u]??"")}return o})}function CE(e){const t=String(e||"772").trim()||"772",r=";",n=["CodigoSIGES","ClasificadorSICOP","IdentificadorSICOP","Medicamento","Categoria","Lote","Vencimiento","Stock","StockMinimo","Unidad"],i=["SIG-0001","SICOP-CL-01","SICOP-ID-0001","Paracetamol","General","LOT-2025-01","2027-12-31",100,20,"Tabletas"],o=`\uFEFF${[n.map(x=>Il(x,r)).join(r),i.map(x=>Il(x,r)).join(r)].join(`
`)}
`,u=new Blob([o],{type:"text/csv;charset=utf-8"}),h=URL.createObjectURL(u),d=document.createElement("a");d.href=h,d.download=`plantilla_inventario_${t}.csv`,document.body.appendChild(d),d.click(),d.remove(),URL.revokeObjectURL(h)}function NE(e){const t=String(e||"771").trim()||"771",r=`<?xml version="1.0" encoding="UTF-8"?>
<Inventario tipo="${t}">
  <Item>
    <CodigoSIGES>110-16-0010</CodigoSIGES>
    <Medicamento>Paracetamol</Medicamento>
    <Lote>LOT-2025-01</Lote>
    <Vencimiento>2027-12-31</Vencimiento>
    <Inventario>100</Inventario>
  </Item>
</Inventario>
`,n=new Blob([r],{type:"application/xml;charset=utf-8"}),i=URL.createObjectURL(n),l=document.createElement("a");l.href=i,l.download=`plantilla_inventario_${t}.xml`,document.body.appendChild(l),l.click(),l.remove(),URL.revokeObjectURL(i)}function ku(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function OE(e,t,r,n){function i(l){return l instanceof r?l:new r(function(o){o(l)})}return new(r||(r=Promise))(function(l,o){function u(x){try{d(n.next(x))}catch(g){o(g)}}function h(x){try{d(n.throw(x))}catch(g){o(g)}}function d(x){x.done?l(x.value):i(x.value).then(u,h)}d((n=n.apply(e,t||[])).next())})}const RE=e=>e?(...t)=>e(...t):(...t)=>fetch(...t);class Jd extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class DE extends Jd{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class qg extends Jd{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class Xg extends Jd{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Ed;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(Ed||(Ed={}));class FE{constructor(t,{headers:r={},customFetch:n,region:i=Ed.Any}={}){this.url=t,this.headers=r,this.region=i,this.fetch=RE(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return OE(this,arguments,void 0,function*(r,n={}){var i;let l,o;try{const{headers:u,method:h,body:d,signal:x,timeout:g}=n;let v={},{region:_}=n;_||(_=this.region);const w=new URL(`${this.url}/${r}`);_&&_!=="any"&&(v["x-region"]=_,w.searchParams.set("forceFunctionRegion",_));let y;d&&(u&&!Object.prototype.hasOwnProperty.call(u,"Content-Type")||!u)?typeof Blob<"u"&&d instanceof Blob||d instanceof ArrayBuffer?(v["Content-Type"]="application/octet-stream",y=d):typeof d=="string"?(v["Content-Type"]="text/plain",y=d):typeof FormData<"u"&&d instanceof FormData?y=d:(v["Content-Type"]="application/json",y=JSON.stringify(d)):y=d;let b=x;g&&(o=new AbortController,l=setTimeout(()=>o.abort(),g),x?(b=o.signal,x.addEventListener("abort",()=>o.abort())):b=o.signal);const A=yield this.fetch(w.toString(),{method:h||"POST",headers:Object.assign(Object.assign(Object.assign({},v),this.headers),u),body:y,signal:b}).catch(q=>{throw new DE(q)}),M=A.headers.get("x-relay-error");if(M&&M==="true")throw new qg(A);if(!A.ok)throw new Xg(A);let T=((i=A.headers.get("Content-Type"))!==null&&i!==void 0?i:"text/plain").split(";")[0].trim(),U;return T==="application/json"?U=yield A.json():T==="application/octet-stream"||T==="application/pdf"?U=yield A.blob():T==="text/event-stream"?U=A:T==="multipart/form-data"?U=yield A.formData():U=yield A.text(),{data:U,error:null,response:A}}catch(u){return{data:null,error:u,response:u instanceof Xg||u instanceof qg?u.context:void 0}}finally{l&&clearTimeout(l)}})}}var ME=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}},BE=class{constructor(e){var t,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(t=e.shouldThrowOnError)!==null&&t!==void 0?t:!1,this.signal=e.signal,this.isMaybeSingle=(r=e.isMaybeSingle)!==null&&r!==void 0?r:!1,e.fetch?this.fetch=e.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){var r=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let i=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async l=>{let o=null,u=null,h=null,d=l.status,x=l.statusText;if(l.ok){var g,v;if(r.method!=="HEAD"){var _;const A=await l.text();A===""||(r.headers.get("Accept")==="text/csv"||r.headers.get("Accept")&&(!((_=r.headers.get("Accept"))===null||_===void 0)&&_.includes("application/vnd.pgrst.plan+text"))?u=A:u=JSON.parse(A))}const y=(g=r.headers.get("Prefer"))===null||g===void 0?void 0:g.match(/count=(exact|planned|estimated)/),b=(v=l.headers.get("content-range"))===null||v===void 0?void 0:v.split("/");y&&b&&b.length>1&&(h=parseInt(b[1])),r.isMaybeSingle&&r.method==="GET"&&Array.isArray(u)&&(u.length>1?(o={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,h=null,d=406,x="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{var w;const y=await l.text();try{o=JSON.parse(y),Array.isArray(o)&&l.status===404&&(u=[],o=null,d=200,x="OK")}catch{l.status===404&&y===""?(d=204,x="No Content"):o={message:y}}if(o&&r.isMaybeSingle&&(!(o==null||(w=o.details)===null||w===void 0)&&w.includes("0 rows"))&&(o=null,d=200,x="OK"),o&&r.shouldThrowOnError)throw new ME(o)}return{error:o,data:u,count:h,status:d,statusText:x}});return this.shouldThrowOnError||(i=i.catch(l=>{var o;let u="";const h=l?.cause;if(h){var d,x,g,v;const w=(d=h?.message)!==null&&d!==void 0?d:"",y=(x=h?.code)!==null&&x!==void 0?x:"";u=`${(g=l?.name)!==null&&g!==void 0?g:"FetchError"}: ${l?.message}`,u+=`

Caused by: ${(v=h?.name)!==null&&v!==void 0?v:"Error"}: ${w}`,y&&(u+=` (${y})`),h?.stack&&(u+=`
${h.stack}`)}else{var _;u=(_=l?.stack)!==null&&_!==void 0?_:""}return{error:{message:`${(o=l?.name)!==null&&o!==void 0?o:"FetchError"}: ${l?.message}`,details:u,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),i.then(e,t)}returns(){return this}overrideTypes(){return this}},LE=class extends BE{select(e){let t=!1;const r=(e??"*").split("").map(n=>/\s/.test(n)&&!t?"":(n==='"'&&(t=!t),n)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:n,referencedTable:i=n}={}){const l=i?`${i}.order`:"order",o=this.url.searchParams.get(l);return this.url.searchParams.set(l,`${o?`${o},`:""}${e}.${t?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const n=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(n,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:n=r}={}){const i=typeof n>"u"?"offset":`${n}.offset`,l=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(l,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:n=!1,wal:i=!1,format:l="text"}={}){var o;const u=[e?"analyze":null,t?"verbose":null,r?"settings":null,n?"buffers":null,i?"wal":null].filter(Boolean).join("|"),h=(o=this.headers.get("Accept"))!==null&&o!==void 0?o:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${l}; for="${h}"; options=${u};`),l==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};const Wg=new RegExp("[,()]");var kl=class extends LE{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}regexMatch(e,t){return this.url.searchParams.append(e,`match.${t}`),this}regexIMatch(e,t){return this.url.searchParams.append(e,`imatch.${t}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}isDistinct(e,t){return this.url.searchParams.append(e,`isdistinct.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map(n=>typeof n=="string"&&Wg.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}notIn(e,t){const r=Array.from(new Set(t)).map(n=>typeof n=="string"&&Wg.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`not.in.(${r})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:n}={}){let i="";n==="plain"?i="pl":n==="phrase"?i="ph":n==="websearch"&&(i="w");const l=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${i}fts${l}.${t}`),this}match(e){return Object.entries(e).forEach(([t,r])=>{this.url.searchParams.append(t,`eq.${r}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const n=r?`${r}.or`:"or";return this.url.searchParams.append(n,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}},IE=class{constructor(e,{headers:t={},schema:r,fetch:n}){this.url=e,this.headers=new Headers(t),this.schema=r,this.fetch=n}select(e,t){const{head:r=!1,count:n}=t??{},i=r?"HEAD":"GET";let l=!1;const o=(e??"*").split("").map(u=>/\s/.test(u)&&!l?"":(u==='"'&&(l=!l),u)).join("");return this.url.searchParams.set("select",o),n&&this.headers.append("Prefer",`count=${n}`),new kl({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(e,{count:t,defaultToNull:r=!0}={}){var n;const i="POST";if(t&&this.headers.append("Prefer",`count=${t}`),r||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const l=e.reduce((o,u)=>o.concat(Object.keys(u)),[]);if(l.length>0){const o=[...new Set(l)].map(u=>`"${u}"`);this.url.searchParams.set("columns",o.join(","))}}return new kl({method:i,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:n,defaultToNull:i=!0}={}){var l;const o="POST";if(this.headers.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),t!==void 0&&this.url.searchParams.set("on_conflict",t),n&&this.headers.append("Prefer",`count=${n}`),i||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const u=e.reduce((h,d)=>h.concat(Object.keys(d)),[]);if(u.length>0){const h=[...new Set(u)].map(d=>`"${d}"`);this.url.searchParams.set("columns",h.join(","))}}return new kl({method:o,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}update(e,{count:t}={}){var r;const n="PATCH";return t&&this.headers.append("Prefer",`count=${t}`),new kl({method:n,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:e}={}){var t;const r="DELETE";return e&&this.headers.append("Prefer",`count=${e}`),new kl({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}},UE=class By{constructor(t,{headers:r={},schema:n,fetch:i}={}){this.url=t,this.headers=new Headers(r),this.schemaName=n,this.fetch=i}from(t){if(!t||typeof t!="string"||t.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new IE(new URL(`${this.url}/${t}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new By(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:i=!1,count:l}={}){var o;let u;const h=new URL(`${this.url}/rpc/${t}`);let d;n||i?(u=n?"HEAD":"GET",Object.entries(r).filter(([g,v])=>v!==void 0).map(([g,v])=>[g,Array.isArray(v)?`{${v.join(",")}}`:`${v}`]).forEach(([g,v])=>{h.searchParams.append(g,v)})):(u="POST",d=r);const x=new Headers(this.headers);return l&&x.set("Prefer",`count=${l}`),new kl({method:u,url:h,headers:x,schema:this.schemaName,body:d,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}};class jE{constructor(){}static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const n=r.node,i=parseInt(n.replace(/^v/,"").split(".")[0]);return i>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${i} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${i} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const PE="2.89.0",zE=`realtime-js/${PE}`,Ly="1.0.0",HE="2.0.0",Kg=Ly,Td=1e4,VE=1e3,$E=100;var Fi;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(Fi||(Fi={}));var Sr;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Sr||(Sr={}));var ln;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(ln||(ln={}));var kd;(function(e){e.websocket="websocket"})(kd||(kd={}));var ds;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(ds||(ds={}));class GE{constructor(t){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=t??[]}encode(t,r){if(t.event===this.BROADCAST_EVENT&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(t));let n=[t.join_ref,t.ref,t.topic,t.event,t.payload];return r(JSON.stringify(n))}_binaryEncodeUserBroadcastPush(t){var r;return this._isArrayBuffer((r=t.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var r,n;const i=(n=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:new ArrayBuffer(0);return this._encodeUserBroadcastPush(t,this.BINARY_ENCODING,i)}_encodeJsonUserBroadcastPush(t){var r,n;const i=(n=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:{},o=new TextEncoder().encode(JSON.stringify(i)).buffer;return this._encodeUserBroadcastPush(t,this.JSON_ENCODING,o)}_encodeUserBroadcastPush(t,r,n){var i,l;const o=t.topic,u=(i=t.ref)!==null&&i!==void 0?i:"",h=(l=t.join_ref)!==null&&l!==void 0?l:"",d=t.payload.event,x=this.allowedMetadataKeys?this._pick(t.payload,this.allowedMetadataKeys):{},g=Object.keys(x).length===0?"":JSON.stringify(x);if(h.length>255)throw new Error(`joinRef length ${h.length} exceeds maximum of 255`);if(u.length>255)throw new Error(`ref length ${u.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`topic length ${o.length} exceeds maximum of 255`);if(d.length>255)throw new Error(`userEvent length ${d.length} exceeds maximum of 255`);if(g.length>255)throw new Error(`metadata length ${g.length} exceeds maximum of 255`);const v=this.USER_BROADCAST_PUSH_META_LENGTH+h.length+u.length+o.length+d.length+g.length,_=new ArrayBuffer(this.HEADER_LENGTH+v);let w=new DataView(_),y=0;w.setUint8(y++,this.KINDS.userBroadcastPush),w.setUint8(y++,h.length),w.setUint8(y++,u.length),w.setUint8(y++,o.length),w.setUint8(y++,d.length),w.setUint8(y++,g.length),w.setUint8(y++,r),Array.from(h,A=>w.setUint8(y++,A.charCodeAt(0))),Array.from(u,A=>w.setUint8(y++,A.charCodeAt(0))),Array.from(o,A=>w.setUint8(y++,A.charCodeAt(0))),Array.from(d,A=>w.setUint8(y++,A.charCodeAt(0))),Array.from(g,A=>w.setUint8(y++,A.charCodeAt(0)));var b=new Uint8Array(_.byteLength+n.byteLength);return b.set(new Uint8Array(_),0),b.set(new Uint8Array(n),_.byteLength),b.buffer}decode(t,r){if(this._isArrayBuffer(t)){let n=this._binaryDecode(t);return r(n)}if(typeof t=="string"){const n=JSON.parse(t),[i,l,o,u,h]=n;return r({join_ref:i,ref:l,topic:o,event:u,payload:h})}return r({})}_binaryDecode(t){const r=new DataView(t),n=r.getUint8(0),i=new TextDecoder;if(n===this.KINDS.userBroadcast)return this._decodeUserBroadcast(t,r,i)}_decodeUserBroadcast(t,r,n){const i=r.getUint8(1),l=r.getUint8(2),o=r.getUint8(3),u=r.getUint8(4);let h=this.HEADER_LENGTH+4;const d=n.decode(t.slice(h,h+i));h=h+i;const x=n.decode(t.slice(h,h+l));h=h+l;const g=n.decode(t.slice(h,h+o));h=h+o;const v=t.slice(h,t.byteLength),_=u===this.JSON_ENCODING?JSON.parse(n.decode(v)):v,w={type:this.BROADCAST_EVENT,event:x,payload:_};return o>0&&(w.meta=JSON.parse(g)),{join_ref:null,ref:null,topic:d,event:this.BROADCAST_EVENT,payload:w}}_isArrayBuffer(t){var r;return t instanceof ArrayBuffer||((r=t?.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(t,r){return!t||typeof t!="object"?{}:Object.fromEntries(Object.entries(t).filter(([n])=>r.includes(n)))}}class Iy{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var jt;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(jt||(jt={}));const Yg=(e,t,r={})=>{var n;const i=(n=r.skipTypes)!==null&&n!==void 0?n:[];return t?Object.keys(t).reduce((l,o)=>(l[o]=qE(o,e,t,i),l),{}):{}},qE=(e,t,r,n)=>{const i=t.find(u=>u.name===e),l=i?.type,o=r[e];return l&&!n.includes(l)?Uy(l,o):Ad(o)},Uy=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return YE(t,r)}switch(e){case jt.bool:return XE(t);case jt.float4:case jt.float8:case jt.int2:case jt.int4:case jt.int8:case jt.numeric:case jt.oid:return WE(t);case jt.json:case jt.jsonb:return KE(t);case jt.timestamp:return JE(t);case jt.abstime:case jt.date:case jt.daterange:case jt.int4range:case jt.int8range:case jt.money:case jt.reltime:case jt.text:case jt.time:case jt.timestamptz:case jt.timetz:case jt.tsrange:case jt.tstzrange:return Ad(t);default:return Ad(t)}},Ad=e=>e,XE=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},WE=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},KE=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e},YE=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let l;const o=e.slice(1,r);try{l=JSON.parse("["+o+"]")}catch{l=o?o.split(","):[]}return l.map(u=>Uy(t,u))}return e},JE=e=>typeof e=="string"?e.replace(" ","T"):e,jy=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class Zh{constructor(t,r,n={},i=Td){this.channel=t,this.event=r,this.payload=n,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var Jg;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(Jg||(Jg={}));class Vc{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=r?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},i=>{const{onJoin:l,onLeave:o,onSync:u}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Vc.syncState(this.state,i,l,o),this.pendingDiffs.forEach(h=>{this.state=Vc.syncDiff(this.state,h,l,o)}),this.pendingDiffs=[],u()}),this.channel._on(n.diff,{},i=>{const{onJoin:l,onLeave:o,onSync:u}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=Vc.syncDiff(this.state,i,l,o),u())}),this.onJoin((i,l,o)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:l,newPresences:o})}),this.onLeave((i,l,o)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:l,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,i){const l=this.cloneDeep(t),o=this.transformState(r),u={},h={};return this.map(l,(d,x)=>{o[d]||(h[d]=x)}),this.map(o,(d,x)=>{const g=l[d];if(g){const v=x.map(b=>b.presence_ref),_=g.map(b=>b.presence_ref),w=x.filter(b=>_.indexOf(b.presence_ref)<0),y=g.filter(b=>v.indexOf(b.presence_ref)<0);w.length>0&&(u[d]=w),y.length>0&&(h[d]=y)}else u[d]=x}),this.syncDiff(l,{joins:u,leaves:h},n,i)}static syncDiff(t,r,n,i){const{joins:l,leaves:o}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),i||(i=()=>{}),this.map(l,(u,h)=>{var d;const x=(d=t[u])!==null&&d!==void 0?d:[];if(t[u]=this.cloneDeep(h),x.length>0){const g=t[u].map(_=>_.presence_ref),v=x.filter(_=>g.indexOf(_.presence_ref)<0);t[u].unshift(...v)}n(u,x,h)}),this.map(o,(u,h)=>{let d=t[u];if(!d)return;const x=h.map(g=>g.presence_ref);d=d.filter(g=>x.indexOf(g.presence_ref)<0),t[u]=d,i(u,d,h),d.length===0&&delete t[u]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const i=t[n];return"metas"in i?r[n]=i.metas.map(l=>(l.presence_ref=l.phx_ref,delete l.phx_ref,delete l.phx_ref_prev,l)):r[n]=i,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Qg;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(Qg||(Qg={}));var $c;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})($c||($c={}));var Xn;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Xn||(Xn={}));class Ol{constructor(t,r={config:{}},n){var i,l;if(this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=Sr.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Zh(this,ln.join,this.params,this.timeout),this.rejoinTimer=new Iy(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Sr.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Sr.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=Sr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Sr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=Sr.errored,this.rejoinTimer.scheduleTimeout())}),this._on(ln.reply,{},(o,u)=>{this._trigger(this._replyEventName(u),o)}),this.presence=new Vc(this),this.broadcastEndpointURL=jy(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((l=(i=this.params.config)===null||i===void 0?void 0:i.broadcast)===null||l===void 0)&&l.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var n,i,l;if(this.socket.isConnected()||this.socket.connect(),this.state==Sr.closed){const{config:{broadcast:o,presence:u,private:h}}=this.params,d=(i=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(_=>_.filter))!==null&&i!==void 0?i:[],x=!!this.bindings[$c.PRESENCE]&&this.bindings[$c.PRESENCE].length>0||((l=this.params.config.presence)===null||l===void 0?void 0:l.enabled)===!0,g={},v={broadcast:o,presence:Object.assign(Object.assign({},u),{enabled:x}),postgres_changes:d,private:h};this.socket.accessTokenValue&&(g.access_token=this.socket.accessTokenValue),this._onError(_=>t?.(Xn.CHANNEL_ERROR,_)),this._onClose(()=>t?.(Xn.CLOSED)),this.updateJoinPayload(Object.assign({config:v},g)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:_})=>{var w;if(this.socket._isManualToken()||this.socket.setAuth(),_===void 0){t?.(Xn.SUBSCRIBED);return}else{const y=this.bindings.postgres_changes,b=(w=y?.length)!==null&&w!==void 0?w:0,A=[];for(let M=0;M<b;M++){const T=y[M],{filter:{event:U,schema:q,table:I,filter:R}}=T,Q=_&&_[M];if(Q&&Q.event===U&&Ol.isFilterValueEqual(Q.schema,q)&&Ol.isFilterValueEqual(Q.table,I)&&Ol.isFilterValueEqual(Q.filter,R))A.push(Object.assign(Object.assign({},T),{id:Q.id}));else{this.unsubscribe(),this.state=Sr.errored,t?.(Xn.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=A,t&&t(Xn.SUBSCRIBED);return}}).receive("error",_=>{this.state=Sr.errored,t?.(Xn.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(_).join(", ")||"error")))}).receive("timeout",()=>{t?.(Xn.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===Sr.joined&&t===$c.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(t,r,n)}async httpSend(t,r,n={}){var i;if(r==null)return Promise.reject("Payload is required for httpSend()");const l={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(l.Authorization=`Bearer ${this.socket.accessTokenValue}`);const o={method:"POST",headers:l,body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:r,private:this.private}]})},u=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(i=n.timeout)!==null&&i!==void 0?i:this.timeout);if(u.status===202)return{success:!0};let h=u.statusText;try{const d=await u.json();h=d.error||d.message||h}catch{}return Promise.reject(new Error(h))}async send(t,r={}){var n,i;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:l,payload:o}=t,u={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(u.Authorization=`Bearer ${this.socket.accessTokenValue}`);const h={method:"POST",headers:u,body:JSON.stringify({messages:[{topic:this.subTopic,event:l,payload:o,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,h,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((i=d.body)===null||i===void 0?void 0:i.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(l=>{var o,u,h;const d=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((h=(u=(o=this.params)===null||o===void 0?void 0:o.config)===null||u===void 0?void 0:u.broadcast)===null||h===void 0)&&h.ack)&&l("ok"),d.receive("ok",()=>l("ok")),d.receive("error",()=>l("error")),d.receive("timeout",()=>l("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Sr.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(ln.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(i=>{n=new Zh(this,ln.leave,{},t),n.receive("ok",()=>{r(),i("ok")}).receive("timeout",()=>{r(),i("timed out")}).receive("error",()=>{i("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n?.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Sr.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const i=new AbortController,l=setTimeout(()=>i.abort(),n),o=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:i.signal}));return clearTimeout(l),o}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new Zh(this,t,r,n);return this._canPush()?i.send():this._addToPushBuffer(i),i}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>$E){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var i,l;const o=t.toLocaleLowerCase(),{close:u,error:h,leave:d,join:x}=ln;if(n&&[u,h,d,x].indexOf(o)>=0&&n!==this._joinRef())return;let v=this._onMessage(o,r,n);if(r&&!v)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(_=>{var w,y,b;return((w=_.filter)===null||w===void 0?void 0:w.event)==="*"||((b=(y=_.filter)===null||y===void 0?void 0:y.event)===null||b===void 0?void 0:b.toLocaleLowerCase())===o}).map(_=>_.callback(v,n)):(l=this.bindings[o])===null||l===void 0||l.filter(_=>{var w,y,b,A,M,T;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in _){const U=_.id,q=(w=_.filter)===null||w===void 0?void 0:w.event;return U&&((y=r.ids)===null||y===void 0?void 0:y.includes(U))&&(q==="*"||q?.toLocaleLowerCase()===((b=r.data)===null||b===void 0?void 0:b.type.toLocaleLowerCase()))}else{const U=(M=(A=_?.filter)===null||A===void 0?void 0:A.event)===null||M===void 0?void 0:M.toLocaleLowerCase();return U==="*"||U===((T=r?.event)===null||T===void 0?void 0:T.toLocaleLowerCase())}else return _.type.toLocaleLowerCase()===o}).map(_=>{if(typeof v=="object"&&"ids"in v){const w=v.data,{schema:y,table:b,commit_timestamp:A,type:M,errors:T}=w;v=Object.assign(Object.assign({},{schema:y,table:b,commit_timestamp:A,eventType:M,new:{},old:{},errors:T}),this._getPayloadRecords(w))}_.callback(v,n)})}_isClosed(){return this.state===Sr.closed}_isJoined(){return this.state===Sr.joined}_isJoining(){return this.state===Sr.joining}_isLeaving(){return this.state===Sr.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const i=t.toLocaleLowerCase(),l={type:i,filter:r,callback:n};return this.bindings[i]?this.bindings[i].push(l):this.bindings[i]=[l],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(i=>{var l;return!(((l=i.type)===null||l===void 0?void 0:l.toLocaleLowerCase())===n&&Ol.isEqual(i.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}static isFilterValueEqual(t,r){return(t??void 0)===(r??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(ln.close,{},t)}_onError(t){this._on(ln.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Sr.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=Yg(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=Yg(t.columns,t.old_record)),r}}const ed=()=>{},V0={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},QE=[1e3,2e3,5e3,1e4],ZE=1e4,eT=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class tT{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Td,this.transport=null,this.heartbeatIntervalMs=V0.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=ed,this.ref=0,this.reconnectTimer=null,this.vsn=Kg,this.logger=ed,this.conn=null,this.sendBuffer=[],this.serializer=new GE,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=i=>i?(...l)=>i(...l):(...l)=>fetch(...l),!(!((n=r?.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${kd.websocket}`,this.httpEndpoint=jy(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=jE.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Fi.connecting:return ds.Connecting;case Fi.open:return ds.Open;case Fi.closing:return ds.Closing;default:return ds.Closed}}isConnected(){return this.connectionState()===ds.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,i=this.getChannels().find(l=>l.topic===n);if(i)return i;{const l=new Ol(`realtime:${t}`,r,this);return this.channels.push(l),l}}push(t){const{topic:r,event:n,payload:i,ref:l}=t,o=()=>{this.encode(t,u=>{var h;(h=this.conn)===null||h===void 0||h.send(u)})};this.log("push",`${r} ${n} (${l})`,i),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(VE,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},V0.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(d){this.log("error","error in heartbeat callback",d)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:i,payload:l,ref:o}=r,u=o?`(${o})`:"",h=l.status||"";this.log("receive",`${h} ${n} ${i} ${u}`.trim(),l),this.channels.filter(d=>d._isMember(n)).forEach(d=>d._trigger(i,l,o)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t),this.conn.readyState===Fi.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===Fi.open||this.conn.readyState===Fi.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this._terminateWorker()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(ln.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",i=new URLSearchParams(r);return`${t}${n}${i}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([eT],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r,n=!1;if(t)r=t,n=!0;else if(this.accessToken)try{r=await this.accessToken()}catch(i){this.log("error","Error fetching access token from callback",i),r=this.accessTokenValue}else r=this.accessTokenValue;n?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(i=>{const l={access_token:r,version:zE};r&&i.updateJoinPayload(l),i.joinedOnce&&i._isJoined()&&i._push(ln.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this._isManualToken()||this.setAuth().catch(r=>{this.log("error",`Error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(i){this.log("error",`error in ${t} callback`,i)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new Iy(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},V0.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,i,l,o,u,h,d,x,g,v,_;switch(this.transport=(r=t?.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t?.timeout)!==null&&n!==void 0?n:Td,this.heartbeatIntervalMs=(i=t?.heartbeatIntervalMs)!==null&&i!==void 0?i:V0.HEARTBEAT_INTERVAL,this.worker=(l=t?.worker)!==null&&l!==void 0?l:!1,this.accessToken=(o=t?.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(u=t?.heartbeatCallback)!==null&&u!==void 0?u:ed,this.vsn=(h=t?.vsn)!==null&&h!==void 0?h:Kg,t?.params&&(this.params=t.params),t?.logger&&(this.logger=t.logger),(t?.logLevel||t?.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(d=t?.reconnectAfterMs)!==null&&d!==void 0?d:(w=>QE[w-1]||ZE),this.vsn){case Ly:this.encode=(x=t?.encode)!==null&&x!==void 0?x:((w,y)=>y(JSON.stringify(w))),this.decode=(g=t?.decode)!==null&&g!==void 0?g:((w,y)=>y(JSON.parse(w)));break;case HE:this.encode=(v=t?.encode)!==null&&v!==void 0?v:this.serializer.encode.bind(this.serializer),this.decode=(_=t?.decode)!==null&&_!==void 0?_:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t?.workerUrl}}}var Zc=class extends Error{constructor(e,t){super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown=t.icebergType==="CommitStateUnknownException"||[500,502,504].includes(t.status)&&t.icebergType?.includes("CommitState")===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function rT(e,t,r){const n=new URL(t,e);if(r)for(const[i,l]of Object.entries(r))l!==void 0&&n.searchParams.set(i,l);return n.toString()}async function aT(e){return!e||e.type==="none"?{}:e.type==="bearer"?{Authorization:`Bearer ${e.token}`}:e.type==="header"?{[e.name]:e.value}:e.type==="custom"?await e.getHeaders():{}}function nT(e){const t=e.fetchImpl??globalThis.fetch;return{async request({method:r,path:n,query:i,body:l,headers:o}){const u=rT(e.baseUrl,n,i),h=await aT(e.auth),d=await t(u,{method:r,headers:{...l?{"Content-Type":"application/json"}:{},...h,...o},body:l?JSON.stringify(l):void 0}),x=await d.text(),g=(d.headers.get("content-type")||"").includes("application/json"),v=g&&x?JSON.parse(x):x;if(!d.ok){const _=g?v:void 0,w=_?.error;throw new Zc(w?.message??`Request failed with status ${d.status}`,{status:d.status,icebergType:w?.type,icebergCode:w?.code,details:_})}return{status:d.status,headers:d.headers,data:v}}}}function $0(e){return e.join("")}var iT=class{constructor(e,t=""){this.client=e,this.prefix=t}async listNamespaces(e){const t=e?{parent:$0(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(n=>({namespace:n}))}async createNamespace(e,t){const r={namespace:e.namespace,properties:t?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${$0(e.namespace)}`})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${$0(e.namespace)}`})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${$0(e.namespace)}`}),!0}catch(t){if(t instanceof Zc&&t.status===404)return!1;throw t}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(r){if(r instanceof Zc&&r.status===409)return;throw r}}};function gl(e){return e.join("")}var sT=class{constructor(e,t="",r){this.client=e,this.prefix=t,this.accessDelegation=r}async listTables(e){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${gl(e.namespace)}/tables`})).data.identifiers}async createTable(e,t){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${gl(e.namespace)}/tables`,body:t,headers:r})).data.metadata}async updateTable(e,t){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${gl(e.namespace)}/tables/${e.name}`,body:t});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(e,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${gl(e.namespace)}/tables/${e.name}`,query:{purgeRequested:String(t?.purge??!1)}})}async loadTable(e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${gl(e.namespace)}/tables/${e.name}`,headers:t})).data.metadata}async tableExists(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${gl(e.namespace)}/tables/${e.name}`,headers:t}),!0}catch(r){if(r instanceof Zc&&r.status===404)return!1;throw r}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(r){if(r instanceof Zc&&r.status===409)return await this.loadTable({namespace:e.namespace,name:t.name});throw r}}},lT=class{constructor(e){let t="v1";e.catalogName&&(t+=`/${e.catalogName}`);const r=e.baseUrl.endsWith("/")?e.baseUrl:`${e.baseUrl}/`;this.client=nT({baseUrl:r,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=e.accessDelegation?.join(","),this.namespaceOps=new iT(this.client,t),this.tableOps=new sT(this.client,t,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}},Au=class extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}};function Jt(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}var cT=class extends Au{constructor(e,t,r){super(e),this.name="StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Cd=class extends Au{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}};const Qd=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),oT=()=>Response,Nd=e=>{if(Array.isArray(e))return e.map(r=>Nd(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const i=r.replace(/([-_][a-z])/gi,l=>l.toUpperCase().replace(/[-_]/g,""));t[i]=Nd(n)}),t},uT=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},fT=e=>!e||typeof e!="string"||e.length===0||e.length>100||e.trim()!==e||e.includes("/")||e.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(e);function eo(e){"@babel/helpers - typeof";return eo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},eo(e)}function hT(e,t){if(eo(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(eo(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function dT(e){var t=hT(e,"string");return eo(t)=="symbol"?t:t+""}function mT(e,t,r){return(t=dT(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Zg(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Ye(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Zg(Object(r),!0).forEach(function(n){mT(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Zg(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}const td=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},xT=async(e,t,r)=>{e instanceof await oT()&&!r?.noResolveJson?e.json().then(n=>{const i=e.status||500,l=n?.statusCode||i+"";t(new cT(td(n),i,l))}).catch(n=>{t(new Cd(td(n),n))}):t(new Cd(td(e),e))},pT=(e,t,r,n)=>{const i={method:e,headers:t?.headers||{}};return e==="GET"||!n?i:(uT(n)?(i.headers=Ye({"Content-Type":"application/json"},t?.headers),i.body=JSON.stringify(n)):i.body=n,t?.duplex&&(i.duplex=t.duplex),Ye(Ye({},i),r))};async function So(e,t,r,n,i,l){return new Promise((o,u)=>{e(r,pT(t,n,i,l)).then(h=>{if(!h.ok)throw h;return n?.noResolveJson?h:h.json()}).then(h=>o(h)).catch(h=>xT(h,u,n))})}async function to(e,t,r,n){return So(e,"GET",t,r,n)}async function sn(e,t,r,n,i){return So(e,"POST",t,n,i,r)}async function Od(e,t,r,n,i){return So(e,"PUT",t,n,i,r)}async function gT(e,t,r,n){return So(e,"HEAD",t,Ye(Ye({},r),{},{noResolveJson:!0}),n)}async function Zd(e,t,r,n,i){return So(e,"DELETE",t,n,i,r)}var vT=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}async execute(){var e=this;try{return{data:(await e.downloadFn()).body,error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Jt(t))return{data:null,error:t};throw t}}};let Py;Py=Symbol.toStringTag;var yT=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[Py]="BlobDownloadBuilder",this.promise=null}asStream(){return new vT(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var e=this;try{return{data:await(await e.downloadFn()).blob(),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Jt(t))return{data:null,error:t};throw t}}};const _T={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},ev={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var wT=class{constructor(e,t={},r,n){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=r,this.fetch=Qd(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(e,t,r,n){var i=this;try{let l;const o=Ye(Ye({},ev),n);let u=Ye(Ye({},i.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const h=o.metadata;typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",o.cacheControl),h&&l.append("metadata",i.encodeMetadata(h)),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.has("cacheControl")||l.append("cacheControl",o.cacheControl),h&&!l.has("metadata")&&l.append("metadata",i.encodeMetadata(h))):(l=r,u["cache-control"]=`max-age=${o.cacheControl}`,u["content-type"]=o.contentType,h&&(u["x-metadata"]=i.toBase64(i.encodeMetadata(h))),(typeof ReadableStream<"u"&&l instanceof ReadableStream||l&&typeof l=="object"&&"pipe"in l&&typeof l.pipe=="function")&&!o.duplex&&(o.duplex="half")),n?.headers&&(u=Ye(Ye({},u),n.headers));const d=i._removeEmptyFolders(t),x=i._getFinalPath(d),g=await(e=="PUT"?Od:sn)(i.fetch,`${i.url}/object/${x}`,l,Ye({headers:u},o?.duplex?{duplex:o.duplex}:{}));return{data:{path:d,id:g.Id,fullPath:g.Key},error:null}}catch(l){if(i.shouldThrowOnError)throw l;if(Jt(l))return{data:null,error:l};throw l}}async upload(e,t,r){return this.uploadOrUpdate("POST",e,t,r)}async uploadToSignedUrl(e,t,r,n){var i=this;const l=i._removeEmptyFolders(e),o=i._getFinalPath(l),u=new URL(i.url+`/object/upload/sign/${o}`);u.searchParams.set("token",t);try{let h;const d=Ye({upsert:ev.upsert},n),x=Ye(Ye({},i.headers),{"x-upsert":String(d.upsert)});return typeof Blob<"u"&&r instanceof Blob?(h=new FormData,h.append("cacheControl",d.cacheControl),h.append("",r)):typeof FormData<"u"&&r instanceof FormData?(h=r,h.append("cacheControl",d.cacheControl)):(h=r,x["cache-control"]=`max-age=${d.cacheControl}`,x["content-type"]=d.contentType),{data:{path:l,fullPath:(await Od(i.fetch,u.toString(),h,{headers:x})).Key},error:null}}catch(h){if(i.shouldThrowOnError)throw h;if(Jt(h))return{data:null,error:h};throw h}}async createSignedUploadUrl(e,t){var r=this;try{let n=r._getFinalPath(e);const i=Ye({},r.headers);t?.upsert&&(i["x-upsert"]="true");const l=await sn(r.fetch,`${r.url}/object/upload/sign/${n}`,{},{headers:i}),o=new URL(r.url+l.url),u=o.searchParams.get("token");if(!u)throw new Au("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:u},error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(Jt(n))return{data:null,error:n};throw n}}async update(e,t,r){return this.uploadOrUpdate("PUT",e,t,r)}async move(e,t,r){var n=this;try{return{data:await sn(n.fetch,`${n.url}/object/move`,{bucketId:n.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r?.destinationBucket},{headers:n.headers}),error:null}}catch(i){if(n.shouldThrowOnError)throw i;if(Jt(i))return{data:null,error:i};throw i}}async copy(e,t,r){var n=this;try{return{data:{path:(await sn(n.fetch,`${n.url}/object/copy`,{bucketId:n.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r?.destinationBucket},{headers:n.headers})).Key},error:null}}catch(i){if(n.shouldThrowOnError)throw i;if(Jt(i))return{data:null,error:i};throw i}}async createSignedUrl(e,t,r){var n=this;try{let i=n._getFinalPath(e),l=await sn(n.fetch,`${n.url}/object/sign/${i}`,Ye({expiresIn:t},r?.transform?{transform:r.transform}:{}),{headers:n.headers});const o=r?.download?`&download=${r.download===!0?"":r.download}`:"";return l={signedUrl:encodeURI(`${n.url}${l.signedURL}${o}`)},{data:l,error:null}}catch(i){if(n.shouldThrowOnError)throw i;if(Jt(i))return{data:null,error:i};throw i}}async createSignedUrls(e,t,r){var n=this;try{const i=await sn(n.fetch,`${n.url}/object/sign/${n.bucketId}`,{expiresIn:t,paths:e},{headers:n.headers}),l=r?.download?`&download=${r.download===!0?"":r.download}`:"";return{data:i.map(o=>Ye(Ye({},o),{},{signedUrl:o.signedURL?encodeURI(`${n.url}${o.signedURL}${l}`):null})),error:null}}catch(i){if(n.shouldThrowOnError)throw i;if(Jt(i))return{data:null,error:i};throw i}}download(e,t){const r=typeof t?.transform<"u"?"render/image/authenticated":"object",n=this.transformOptsToQueryString(t?.transform||{}),i=n?`?${n}`:"",l=this._getFinalPath(e),o=()=>to(this.fetch,`${this.url}/${r}/${l}${i}`,{headers:this.headers,noResolveJson:!0});return new yT(o,this.shouldThrowOnError)}async info(e){var t=this;const r=t._getFinalPath(e);try{return{data:Nd(await to(t.fetch,`${t.url}/object/info/${r}`,{headers:t.headers})),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(Jt(n))return{data:null,error:n};throw n}}async exists(e){var t=this;const r=t._getFinalPath(e);try{return await gT(t.fetch,`${t.url}/object/${r}`,{headers:t.headers}),{data:!0,error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(Jt(n)&&n instanceof Cd){const i=n.originalError;if([400,404].includes(i?.status))return{data:!1,error:n}}throw n}}getPublicUrl(e,t){const r=this._getFinalPath(e),n=[],i=t?.download?`download=${t.download===!0?"":t.download}`:"";i!==""&&n.push(i);const l=typeof t?.transform<"u"?"render/image":"object",o=this.transformOptsToQueryString(t?.transform||{});o!==""&&n.push(o);let u=n.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${r}${u}`)}}}async remove(e){var t=this;try{return{data:await Zd(t.fetch,`${t.url}/object/${t.bucketId}`,{prefixes:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Jt(r))return{data:null,error:r};throw r}}async list(e,t,r){var n=this;try{const i=Ye(Ye(Ye({},_T),t),{},{prefix:e||""});return{data:await sn(n.fetch,`${n.url}/object/list/${n.bucketId}`,i,{headers:n.headers},r),error:null}}catch(i){if(n.shouldThrowOnError)throw i;if(Jt(i))return{data:null,error:i};throw i}}async listV2(e,t){var r=this;try{const n=Ye({},e);return{data:await sn(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,n,{headers:r.headers},t),error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(Jt(n))return{data:null,error:n};throw n}}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}};const zy="2.89.0",Hy={"X-Client-Info":`storage-js/${zy}`};var ST=class{constructor(e,t={},r,n){this.shouldThrowOnError=!1;const i=new URL(e);n?.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase.")),this.url=i.href.replace(/\/$/,""),this.headers=Ye(Ye({},Hy),t),this.fetch=Qd(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(e){var t=this;try{const r=t.listBucketOptionsToQueryString(e);return{data:await to(t.fetch,`${t.url}/bucket${r}`,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Jt(r))return{data:null,error:r};throw r}}async getBucket(e){var t=this;try{return{data:await to(t.fetch,`${t.url}/bucket/${e}`,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Jt(r))return{data:null,error:r};throw r}}async createBucket(e,t={public:!1}){var r=this;try{return{data:await sn(r.fetch,`${r.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}),error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(Jt(n))return{data:null,error:n};throw n}}async updateBucket(e,t){var r=this;try{return{data:await Od(r.fetch,`${r.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}),error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(Jt(n))return{data:null,error:n};throw n}}async emptyBucket(e){var t=this;try{return{data:await sn(t.fetch,`${t.url}/bucket/${e}/empty`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Jt(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await Zd(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Jt(r))return{data:null,error:r};throw r}}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}},bT=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Ye(Ye({},Hy),t),this.fetch=Qd(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var t=this;try{return{data:await sn(t.fetch,`${t.url}/bucket`,{name:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Jt(r))return{data:null,error:r};throw r}}async listBuckets(e){var t=this;try{const r=new URLSearchParams;e?.limit!==void 0&&r.set("limit",e.limit.toString()),e?.offset!==void 0&&r.set("offset",e.offset.toString()),e?.sortColumn&&r.set("sortColumn",e.sortColumn),e?.sortOrder&&r.set("sortOrder",e.sortOrder),e?.search&&r.set("search",e.search);const n=r.toString(),i=n?`${t.url}/bucket?${n}`:`${t.url}/bucket`;return{data:await to(t.fetch,i,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Jt(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await Zd(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Jt(r))return{data:null,error:r};throw r}}from(e){var t=this;if(!fT(e))throw new Au("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new lT({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:async()=>t.headers},fetch:this.fetch}),n=this.shouldThrowOnError;return new Proxy(r,{get(i,l){const o=i[l];return typeof o!="function"?o:async(...u)=>{try{return{data:await o.apply(i,u),error:null}}catch(h){if(n)throw h;return{data:null,error:h}}}}})}};const e1={"X-Client-Info":`storage-js/${zy}`,"Content-Type":"application/json"};var Vy=class extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function ka(e){return typeof e=="object"&&e!==null&&"__isStorageVectorsError"in e}var rd=class extends Vy{constructor(e,t,r){super(e),this.name="StorageVectorsApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},ET=class extends Vy{constructor(e,t){super(e),this.name="StorageVectorsUnknownError",this.originalError=t}};const t1=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),TT=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},tv=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),kT=async(e,t,r)=>{if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!r?.noResolveJson){const n=e.status||500,i=e;if(typeof i.json=="function")i.json().then(l=>{const o=l?.statusCode||l?.code||n+"";t(new rd(tv(l),n,o))}).catch(()=>{const l=n+"";t(new rd(i.statusText||`HTTP ${n} error`,n,l))});else{const l=n+"";t(new rd(i.statusText||`HTTP ${n} error`,n,l))}}else t(new ET(tv(e),e))},AT=(e,t,r,n)=>{const i={method:e,headers:t?.headers||{}};return n?(TT(n)?(i.headers=Ye({"Content-Type":"application/json"},t?.headers),i.body=JSON.stringify(n)):i.body=n,Ye(Ye({},i),r)):i};async function CT(e,t,r,n,i,l){return new Promise((o,u)=>{e(r,AT(t,n,i,l)).then(h=>{if(!h.ok)throw h;if(n?.noResolveJson)return h;const d=h.headers.get("content-type");return!d||!d.includes("application/json")?{}:h.json()}).then(h=>o(h)).catch(h=>kT(h,u,n))})}async function Aa(e,t,r,n,i){return CT(e,"POST",t,n,i,r)}var NT=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Ye(Ye({},e1),t),this.fetch=t1(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(e){var t=this;try{return{data:await Aa(t.fetch,`${t.url}/CreateIndex`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(ka(r))return{data:null,error:r};throw r}}async getIndex(e,t){var r=this;try{return{data:await Aa(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers}),error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(ka(n))return{data:null,error:n};throw n}}async listIndexes(e){var t=this;try{return{data:await Aa(t.fetch,`${t.url}/ListIndexes`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(ka(r))return{data:null,error:r};throw r}}async deleteIndex(e,t){var r=this;try{return{data:await Aa(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers})||{},error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(ka(n))return{data:null,error:n};throw n}}},OT=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Ye(Ye({},e1),t),this.fetch=t1(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(e){var t=this;try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await Aa(t.fetch,`${t.url}/PutVectors`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(ka(r))return{data:null,error:r};throw r}}async getVectors(e){var t=this;try{return{data:await Aa(t.fetch,`${t.url}/GetVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(ka(r))return{data:null,error:r};throw r}}async listVectors(e){var t=this;try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:await Aa(t.fetch,`${t.url}/ListVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(ka(r))return{data:null,error:r};throw r}}async queryVectors(e){var t=this;try{return{data:await Aa(t.fetch,`${t.url}/QueryVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(ka(r))return{data:null,error:r};throw r}}async deleteVectors(e){var t=this;try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await Aa(t.fetch,`${t.url}/DeleteVectors`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(ka(r))return{data:null,error:r};throw r}}},RT=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Ye(Ye({},e1),t),this.fetch=t1(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var t=this;try{return{data:await Aa(t.fetch,`${t.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(ka(r))return{data:null,error:r};throw r}}async getBucket(e){var t=this;try{return{data:await Aa(t.fetch,`${t.url}/GetVectorBucket`,{vectorBucketName:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(ka(r))return{data:null,error:r};throw r}}async listBuckets(e={}){var t=this;try{return{data:await Aa(t.fetch,`${t.url}/ListVectorBuckets`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(ka(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await Aa(t.fetch,`${t.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(ka(r))return{data:null,error:r};throw r}}},DT=class extends RT{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new FT(this.url,this.headers,e,this.fetch)}async createBucket(e){var t=()=>super.createBucket,r=this;return t().call(r,e)}async getBucket(e){var t=()=>super.getBucket,r=this;return t().call(r,e)}async listBuckets(e={}){var t=()=>super.listBuckets,r=this;return t().call(r,e)}async deleteBucket(e){var t=()=>super.deleteBucket,r=this;return t().call(r,e)}},FT=class extends NT{constructor(e,t,r,n){super(e,t,n),this.vectorBucketName=r}async createIndex(e){var t=()=>super.createIndex,r=this;return t().call(r,Ye(Ye({},e),{},{vectorBucketName:r.vectorBucketName}))}async listIndexes(e={}){var t=()=>super.listIndexes,r=this;return t().call(r,Ye(Ye({},e),{},{vectorBucketName:r.vectorBucketName}))}async getIndex(e){var t=()=>super.getIndex,r=this;return t().call(r,r.vectorBucketName,e)}async deleteIndex(e){var t=()=>super.deleteIndex,r=this;return t().call(r,r.vectorBucketName,e)}index(e){return new MT(this.url,this.headers,this.vectorBucketName,e,this.fetch)}},MT=class extends OT{constructor(e,t,r,n,i){super(e,t,i),this.vectorBucketName=r,this.indexName=n}async putVectors(e){var t=()=>super.putVectors,r=this;return t().call(r,Ye(Ye({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async getVectors(e){var t=()=>super.getVectors,r=this;return t().call(r,Ye(Ye({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async listVectors(e={}){var t=()=>super.listVectors,r=this;return t().call(r,Ye(Ye({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async queryVectors(e){var t=()=>super.queryVectors,r=this;return t().call(r,Ye(Ye({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async deleteVectors(e){var t=()=>super.deleteVectors,r=this;return t().call(r,Ye(Ye({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}},BT=class extends ST{constructor(e,t={},r,n){super(e,t,r,n)}from(e){return new wT(this.url,this.headers,e,this.fetch)}get vectors(){return new DT(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new bT(this.url+"/iceberg",this.headers,this.fetch)}};const $y="2.89.0",Al=30*1e3,Rd=3,ad=Rd*Al,LT="http://localhost:9999",IT="supabase.auth.token",UT={"X-Client-Info":`gotrue-js/${$y}`},Dd="X-Supabase-Api-Version",Gy={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},jT=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,PT=600*1e3;class ro extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Ve(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class zT extends ro{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function HT(e){return Ve(e)&&e.name==="AuthApiError"}class ms extends ro{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class Zn extends ro{constructor(t,r,n,i){super(t,n,i),this.name=r,this.status=n}}class ba extends Zn{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function VT(e){return Ve(e)&&e.name==="AuthSessionMissingError"}class vl extends Zn{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class G0 extends Zn{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class q0 extends Zn{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function $T(e){return Ve(e)&&e.name==="AuthImplicitGrantRedirectError"}class rv extends Zn{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class GT extends Zn{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class Fd extends Zn{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function nd(e){return Ve(e)&&e.name==="AuthRetryableFetchError"}class av extends Zn{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class Md extends Zn{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const ou="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),nv=` 	
\r=`.split(""),qT=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<nv.length;t+=1)e[nv[t].charCodeAt(0)]=-2;for(let t=0;t<ou.length;t+=1)e[ou[t].charCodeAt(0)]=t;return e})();function iv(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(ou[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(ou[n]),t.queuedBits-=6}}function qy(e,t,r){const n=qT[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function sv(e){const t=[],r=o=>{t.push(String.fromCodePoint(o))},n={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},l=o=>{KT(o,n,r)};for(let o=0;o<e.length;o+=1)qy(e.charCodeAt(o),i,l);return t.join("")}function XT(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function WT(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const i=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|i)+65536,r+=1}XT(n,t)}}function KT(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if((e>>7-n&1)===0){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function Dl(e){const t=[],r={queue:0,queuedBits:0},n=i=>{t.push(i)};for(let i=0;i<e.length;i+=1)qy(e.charCodeAt(i),r,n);return new Uint8Array(t)}function YT(e){const t=[];return WT(e,r=>t.push(r)),new Uint8Array(t)}function ps(e){const t=[],r={queue:0,queuedBits:0},n=i=>{t.push(i)};return e.forEach(i=>iv(i,r,n)),iv(null,r,n),t.join("")}function JT(e){return Math.round(Date.now()/1e3)+e}function QT(){return Symbol("auth-callback")}const Lr=()=>typeof window<"u"&&typeof document<"u",os={tested:!1,writable:!1},Xy=()=>{if(!Lr())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(os.tested)return os.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),os.tested=!0,os.writable=!0}catch{os.tested=!0,os.writable=!1}return os.writable};function ZT(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((i,l)=>{t[l]=i})}catch{}return r.searchParams.forEach((n,i)=>{t[i]=n}),t}const Wy=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),e4=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Cl=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},us=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Br=async(e,t)=>{await e.removeItem(t)};class Cu{constructor(){this.promise=new Cu.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}Cu.promiseConstructor=Promise;function id(e){const t=e.split(".");if(t.length!==3)throw new Md("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!jT.test(t[n]))throw new Md("JWT not in base64url format");return{header:JSON.parse(sv(t[0])),payload:JSON.parse(sv(t[1])),signature:Dl(t[2]),raw:{header:t[0],payload:t[1]}}}async function t4(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function r4(e,t){return new Promise((n,i)=>{(async()=>{for(let l=0;l<1/0;l++)try{const o=await e(l);if(!t(l,null,o)){n(o);return}}catch(o){if(!t(l,o)){i(o);return}}})()})}function a4(e){return("0"+e.toString(16)).substr(-2)}function n4(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let i="";for(let l=0;l<56;l++)i+=r.charAt(Math.floor(Math.random()*n));return i}return crypto.getRandomValues(t),Array.from(t,a4).join("")}async function i4(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),i=new Uint8Array(n);return Array.from(i).map(l=>String.fromCharCode(l)).join("")}async function s4(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await i4(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function yl(e,t,r=!1){const n=n4();let i=n;r&&(i+="/PASSWORD_RECOVERY"),await Cl(e,`${t}-code-verifier`,i);const l=await s4(n);return[l,n===l?"plain":"s256"]}const l4=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function c4(e){const t=e.headers.get(Dd);if(!t||!t.match(l4))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function o4(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function u4(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const f4=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function _l(e){if(!f4.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function sd(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function h4(e,t){return new Proxy(e,{get:(r,n,i)=>{if(n==="__isInsecureUserWarningProxy")return!0;if(typeof n=="symbol"){const l=n.toString();if(l==="Symbol(Symbol.toPrimitive)"||l==="Symbol(Symbol.toStringTag)"||l==="Symbol(util.inspect.custom)"||l==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,n,i)}return!t.value&&typeof n=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(r,n,i)}})}function lv(e){return JSON.parse(JSON.stringify(e))}const hs=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),d4=[502,503,504];async function cv(e){var t;if(!e4(e))throw new Fd(hs(e),0);if(d4.includes(e.status))throw new Fd(hs(e),e.status);let r;try{r=await e.json()}catch(l){throw new ms(hs(l),l)}let n;const i=c4(e);if(i&&i.getTime()>=Gy["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new av(hs(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new ba}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((l,o)=>l&&typeof o=="string",!0))throw new av(hs(r),e.status,r.weak_password.reasons);throw new zT(hs(r),e.status||500,n)}const m4=(e,t,r,n)=>{const i={method:e,headers:t?.headers||{}};return e==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t?.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),r))};async function Ke(e,t,r,n){var i;const l=Object.assign({},n?.headers);l[Dd]||(l[Dd]=Gy["2024-01-01"].name),n?.jwt&&(l.Authorization=`Bearer ${n.jwt}`);const o=(i=n?.query)!==null&&i!==void 0?i:{};n?.redirectTo&&(o.redirect_to=n.redirectTo);const u=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",h=await x4(e,t,r+u,{headers:l,noResolveJson:n?.noResolveJson},{},n?.body);return n?.xform?n?.xform(h):{data:Object.assign({},h),error:null}}async function x4(e,t,r,n,i,l){const o=m4(t,n,i,l);let u;try{u=await e(r,Object.assign({},o))}catch(h){throw console.error(h),new Fd(hs(h),0)}if(u.ok||await cv(u),n?.noResolveJson)return u;try{return await u.json()}catch(h){await cv(h)}}function nn(e){var t;let r=null;v4(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=JT(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function ov(e){const t=nn(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function Bi(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function p4(e){return{data:e,error:null}}function g4(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:l}=e,o=ku(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),u={action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:l},h=Object.assign({},o);return{data:{properties:u,user:h},error:null}}function uv(e){return e}function v4(e){return e.access_token&&e.refresh_token&&e.expires_in}const ld=["global","local","others"];class y4{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=Wy(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=ld[0]){if(ld.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${ld.join(", ")}`);try{return await Ke(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Ve(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await Ke(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Bi})}catch(n){if(Ve(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=ku(t,["options"]),i=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(i.new_email=n?.newEmail,delete i.newEmail),await Ke(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:g4,redirectTo:r?.redirectTo})}catch(r){if(Ve(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Ke(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Bi})}catch(r){if(Ve(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,i,l,o,u,h;try{const d={nextPage:null,lastPage:0,total:0},x=await Ke(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t?.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(l=(i=t?.perPage)===null||i===void 0?void 0:i.toString())!==null&&l!==void 0?l:""},xform:uv});if(x.error)throw x.error;const g=await x.json(),v=(o=x.headers.get("x-total-count"))!==null&&o!==void 0?o:0,_=(h=(u=x.headers.get("link"))===null||u===void 0?void 0:u.split(","))!==null&&h!==void 0?h:[];return _.length>0&&(_.forEach(w=>{const y=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),b=JSON.parse(w.split(";")[1].split("=")[1]);d[`${b}Page`]=y}),d.total=parseInt(v)),{data:Object.assign(Object.assign({},g),d),error:null}}catch(d){if(Ve(d))return{data:{users:[]},error:d};throw d}}async getUserById(t){_l(t);try{return await Ke(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Bi})}catch(r){if(Ve(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){_l(t);try{return await Ke(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:Bi})}catch(n){if(Ve(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){_l(t);try{return await Ke(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:Bi})}catch(n){if(Ve(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){_l(t.userId);try{const{data:r,error:n}=await Ke(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:r,error:n}}catch(r){if(Ve(r))return{data:null,error:r};throw r}}async _deleteFactor(t){_l(t.userId),_l(t.id);try{return{data:await Ke(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Ve(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,n,i,l,o,u,h;try{const d={nextPage:null,lastPage:0,total:0},x=await Ke(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t?.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(l=(i=t?.perPage)===null||i===void 0?void 0:i.toString())!==null&&l!==void 0?l:""},xform:uv});if(x.error)throw x.error;const g=await x.json(),v=(o=x.headers.get("x-total-count"))!==null&&o!==void 0?o:0,_=(h=(u=x.headers.get("link"))===null||u===void 0?void 0:u.split(","))!==null&&h!==void 0?h:[];return _.length>0&&(_.forEach(w=>{const y=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),b=JSON.parse(w.split(";")[1].split("=")[1]);d[`${b}Page`]=y}),d.total=parseInt(v)),{data:Object.assign(Object.assign({},g),d),error:null}}catch(d){if(Ve(d))return{data:{clients:[]},error:d};throw d}}async _createOAuthClient(t){try{return await Ke(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Ve(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await Ke(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Ve(r))return{data:null,error:r};throw r}}async _updateOAuthClient(t,r){try{return await Ke(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:r,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Ve(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(t){try{return await Ke(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Ve(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await Ke(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Ve(r))return{data:null,error:r};throw r}}}function fv(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const wl={debug:!!(globalThis&&Xy()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Ky extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class _4 extends Ky{}async function w4(e,t,r){wl.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),wl.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async i=>{if(i){wl.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,i.name);try{return await r()}finally{wl.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,i.name)}}else{if(t===0)throw wl.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new _4(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(wl.debug)try{const l=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(l,null,"  "))}catch(l){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",l)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function S4(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function Yy(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function b4(e){return parseInt(e,16)}function E4(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,n=>n.toString(16).padStart(2,"0")).join("")}function T4(e){var t;const{chainId:r,domain:n,expirationTime:i,issuedAt:l=new Date,nonce:o,notBefore:u,requestId:h,resources:d,scheme:x,uri:g,version:v}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!g)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(v!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${v}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const _=Yy(e.address),w=x?`${x}://${n}`:n,y=e.statement?`${e.statement}
`:"",b=`${w} wants you to sign in with your Ethereum account:
${_}

${y}`;let A=`URI: ${g}
Version: ${v}
Chain ID: ${r}${o?`
Nonce: ${o}`:""}
Issued At: ${l.toISOString()}`;if(i&&(A+=`
Expiration Time: ${i.toISOString()}`),u&&(A+=`
Not Before: ${u.toISOString()}`),h&&(A+=`
Request ID: ${h}`),d){let M=`
Resources:`;for(const T of d){if(!T||typeof T!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${T}`);M+=`
- ${T}`}A+=M}return`${b}
${A}`}class _r extends Error{constructor({message:t,code:r,cause:n,name:i}){var l;super(t,{cause:n}),this.__isWebAuthnError=!0,this.name=(l=i??(n instanceof Error?n.name:void 0))!==null&&l!==void 0?l:"Unknown Error",this.code=r}}class uu extends _r{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function k4({error:e,options:t}){var r,n,i;const{publicKey:l}=t;if(!l)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new _r({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=l.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new _r({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((n=l.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new _r({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((i=l.authenticatorSelection)===null||i===void 0?void 0:i.userVerification)==="required")return new _r({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new _r({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new _r({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return l.pubKeyCredParams.filter(u=>u.type==="public-key").length===0?new _r({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new _r({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const o=window.location.hostname;if(Jy(o)){if(l.rp.id!==o)return new _r({message:`The RP ID "${l.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new _r({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(l.user.id.byteLength<1||l.user.id.byteLength>64)return new _r({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new _r({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new _r({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function A4({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new _r({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new _r({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const n=window.location.hostname;if(Jy(n)){if(r.rpId!==n)return new _r({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new _r({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new _r({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new _r({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class C4{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const N4=new C4;function O4(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:n}=e,i=ku(e,["challenge","user","excludeCredentials"]),l=Dl(t).buffer,o=Object.assign(Object.assign({},r),{id:Dl(r.id).buffer}),u=Object.assign(Object.assign({},i),{challenge:l,user:o});if(n&&n.length>0){u.excludeCredentials=new Array(n.length);for(let h=0;h<n.length;h++){const d=n[h];u.excludeCredentials[h]=Object.assign(Object.assign({},d),{id:Dl(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return u}function R4(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,n=ku(e,["challenge","allowCredentials"]),i=Dl(t).buffer,l=Object.assign(Object.assign({},n),{challenge:i});if(r&&r.length>0){l.allowCredentials=new Array(r.length);for(let o=0;o<r.length;o++){const u=r[o];l.allowCredentials[o]=Object.assign(Object.assign({},u),{id:Dl(u.id).buffer,type:u.type||"public-key",transports:u.transports})}}return l}function D4(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:ps(new Uint8Array(e.response.attestationObject)),clientDataJSON:ps(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function F4(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,n=e.getClientExtensionResults(),i=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:ps(new Uint8Array(i.authenticatorData)),clientDataJSON:ps(new Uint8Array(i.clientDataJSON)),signature:ps(new Uint8Array(i.signature)),userHandle:i.userHandle?ps(new Uint8Array(i.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function Jy(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function hv(){var e,t;return!!(Lr()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator?.credentials)===null||t===void 0?void 0:t.get)=="function")}async function M4(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new uu("Browser returned unexpected credential type",t)}:{data:null,error:new uu("Empty credential response",t)}}catch(t){return{data:null,error:k4({error:t,options:e})}}}async function B4(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new uu("Browser returned unexpected credential type",t)}:{data:null,error:new uu("Empty credential response",t)}}catch(t){return{data:null,error:A4({error:t,options:e})}}}const L4={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},I4={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function fu(...e){const t=i=>i!==null&&typeof i=="object"&&!Array.isArray(i),r=i=>i instanceof ArrayBuffer||ArrayBuffer.isView(i),n={};for(const i of e)if(i)for(const l in i){const o=i[l];if(o!==void 0)if(Array.isArray(o))n[l]=o;else if(r(o))n[l]=o;else if(t(o)){const u=n[l];t(u)?n[l]=fu(u,o):n[l]=fu(o)}else n[l]=o}return n}function U4(e,t){return fu(L4,e,t||{})}function j4(e,t){return fu(I4,e,t||{})}class P4{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:n,signal:i},l){try{const{data:o,error:u}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!o)return{data:null,error:u};const h=i??N4.createNewAbortSignal();if(o.webauthn.type==="create"){const{user:d}=o.webauthn.credential_options.publicKey;d.name||(d.name=`${d.id}:${n}`),d.displayName||(d.displayName=d.name)}switch(o.webauthn.type){case"create":{const d=U4(o.webauthn.credential_options.publicKey,l?.create),{data:x,error:g}=await M4({publicKey:d,signal:h});return x?{data:{factorId:t,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:x}},error:null}:{data:null,error:g}}case"request":{const d=j4(o.webauthn.credential_options.publicKey,l?.request),{data:x,error:g}=await B4(Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:d,signal:h}));return x?{data:{factorId:t,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:x}},error:null}:{data:null,error:g}}}}catch(o){return Ve(o)?{data:null,error:o}:{data:null,error:new ms("Unexpected error in challenge",o)}}}async _verify({challengeId:t,factorId:r,webauthn:n}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:n})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:i}={}},l){if(!r)return{data:null,error:new ro("rpId is required for WebAuthn authentication")};try{if(!hv())return{data:null,error:new ms("Browser does not support WebAuthn",null)};const{data:o,error:u}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:n},signal:i},{request:l});if(!o)return{data:null,error:u};const{webauthn:h}=o;return this._verify({factorId:t,challengeId:o.challengeId,webauthn:{type:h.type,rpId:r,rpOrigins:n,credential_response:h.credential_response}})}catch(o){return Ve(o)?{data:null,error:o}:{data:null,error:new ms("Unexpected error in authenticate",o)}}}async _register({friendlyName:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:i}={}},l){if(!r)return{data:null,error:new ro("rpId is required for WebAuthn registration")};try{if(!hv())return{data:null,error:new ms("Browser does not support WebAuthn",null)};const{data:o,error:u}=await this._enroll({friendlyName:t});if(!o)return await this.client.mfa.listFactors().then(x=>{var g;return(g=x.data)===null||g===void 0?void 0:g.all.find(v=>v.factor_type==="webauthn"&&v.friendly_name===t&&v.status!=="unverified")}).then(x=>x?this.client.mfa.unenroll({factorId:x?.id}):void 0),{data:null,error:u};const{data:h,error:d}=await this._challenge({factorId:o.id,friendlyName:o.friendly_name,webauthn:{rpId:r,rpOrigins:n},signal:i},{create:l});return h?this._verify({factorId:o.id,challengeId:h.challengeId,webauthn:{rpId:r,rpOrigins:n,type:h.webauthn.type,credential_response:h.webauthn.credential_response}}):{data:null,error:d}}catch(o){return Ve(o)?{data:null,error:o}:{data:null,error:new ms("Unexpected error in register",o)}}}}S4();const z4={url:LT,storageKey:IT,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:UT,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function dv(e,t,r){return await r()}const Sl={};class ao{get jwks(){var t,r;return(r=(t=Sl[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){Sl[this.storageKey]=Object.assign(Object.assign({},Sl[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=Sl[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){Sl[this.storageKey]=Object.assign(Object.assign({},Sl[this.storageKey]),{cachedAt:t})}constructor(t){var r,n,i;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const l=Object.assign(Object.assign({},z4),t);if(this.storageKey=l.storageKey,this.instanceID=(r=ao.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,ao.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!l.debug,typeof l.debug=="function"&&(this.logger=l.debug),this.instanceID>0&&Lr()){const o=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(o),this.logDebugMessages&&console.trace(o)}if(this.persistSession=l.persistSession,this.autoRefreshToken=l.autoRefreshToken,this.admin=new y4({url:l.url,headers:l.headers,fetch:l.fetch}),this.url=l.url,this.headers=l.headers,this.fetch=Wy(l.fetch),this.lock=l.lock||dv,this.detectSessionInUrl=l.detectSessionInUrl,this.flowType=l.flowType,this.hasCustomAuthorizationHeader=l.hasCustomAuthorizationHeader,this.throwOnError=l.throwOnError,l.lock?this.lock=l.lock:this.persistSession&&Lr()&&(!((n=globalThis?.navigator)===null||n===void 0)&&n.locks)?this.lock=w4:this.lock=dv,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new P4(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(l.storage?this.storage=l.storage:Xy()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=fv(this.memoryStorage)),l.userStorage&&(this.userStorage=l.userStorage)):(this.memoryStorage={},this.storage=fv(this.memoryStorage)),Lr()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(i=this.broadcastChannel)===null||i===void 0||i.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${$y}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let r={},n="none";if(Lr()&&(r=ZT(window.location.href),this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce")),Lr()&&this.detectSessionInUrl&&n!=="none"){const{data:i,error:l}=await this._getSessionFromURL(r,n);if(l){if(this._debug("#_initialize()","error detecting session from URL",l),$T(l)){const h=(t=l.details)===null||t===void 0?void 0:t.code;if(h==="identity_already_exists"||h==="identity_not_found"||h==="single_identity_not_deletable")return{error:l}}return await this._removeSession(),{error:l}}const{session:o,redirectType:u}=i;return this._debug("#_initialize()","detected session in URL",o,"redirect type",u),await this._saveSession(o),setTimeout(async()=>{u==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Ve(r)?this._returnResult({error:r}):this._returnResult({error:new ms("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,i;try{const l=await Ke(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t?.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(i=t?.options)===null||i===void 0?void 0:i.captchaToken}},xform:nn}),{data:o,error:u}=l;if(u||!o)return this._returnResult({data:{user:null,session:null},error:u});const h=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",h)),this._returnResult({data:{user:d,session:h},error:null})}catch(l){if(Ve(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async signUp(t){var r,n,i;try{let l;if("email"in t){const{email:x,password:g,options:v}=t;let _=null,w=null;this.flowType==="pkce"&&([_,w]=await yl(this.storage,this.storageKey)),l=await Ke(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:v?.emailRedirectTo,body:{email:x,password:g,data:(r=v?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:v?.captchaToken},code_challenge:_,code_challenge_method:w},xform:nn})}else if("phone"in t){const{phone:x,password:g,options:v}=t;l=await Ke(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:x,password:g,data:(n=v?.data)!==null&&n!==void 0?n:{},channel:(i=v?.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:v?.captchaToken}},xform:nn})}else throw new G0("You must provide either an email or phone number and a password");const{data:o,error:u}=l;if(u||!o)return await Br(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:u});const h=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",h)),this._returnResult({data:{user:d,session:h},error:null})}catch(l){if(await Br(this.storage,`${this.storageKey}-code-verifier`),Ve(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async signInWithPassword(t){try{let r;if("email"in t){const{email:l,password:o,options:u}=t;r=await Ke(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:l,password:o,gotrue_meta_security:{captcha_token:u?.captchaToken}},xform:ov})}else if("phone"in t){const{phone:l,password:o,options:u}=t;r=await Ke(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:l,password:o,gotrue_meta_security:{captcha_token:u?.captchaToken}},xform:ov})}else throw new G0("You must provide either an email or phone number and a password");const{data:n,error:i}=r;if(i)return this._returnResult({data:{user:null,session:null},error:i});if(!n||!n.session||!n.user){const l=new vl;return this._returnResult({data:{user:null,session:null},error:l})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:i})}catch(r){if(Ve(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(t){var r,n,i,l;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(i=t.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(l=t.options)===null||l===void 0?void 0:l.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,n,i,l,o,u,h,d,x,g,v;let _,w;if("message"in t)_=t.message,w=t.signature;else{const{chain:y,wallet:b,statement:A,options:M}=t;let T;if(Lr())if(typeof b=="object")T=b;else{const G=window;if("ethereum"in G&&typeof G.ethereum=="object"&&"request"in G.ethereum&&typeof G.ethereum.request=="function")T=G.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof b!="object"||!M?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");T=b}const U=new URL((r=M?.url)!==null&&r!==void 0?r:window.location.href),q=await T.request({method:"eth_requestAccounts"}).then(G=>G).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!q||q.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const I=Yy(q[0]);let R=(n=M?.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!R){const G=await T.request({method:"eth_chainId"});R=b4(G)}const Q={domain:U.host,address:I,statement:A,uri:U.href,version:"1",chainId:R,nonce:(i=M?.signInWithEthereum)===null||i===void 0?void 0:i.nonce,issuedAt:(o=(l=M?.signInWithEthereum)===null||l===void 0?void 0:l.issuedAt)!==null&&o!==void 0?o:new Date,expirationTime:(u=M?.signInWithEthereum)===null||u===void 0?void 0:u.expirationTime,notBefore:(h=M?.signInWithEthereum)===null||h===void 0?void 0:h.notBefore,requestId:(d=M?.signInWithEthereum)===null||d===void 0?void 0:d.requestId,resources:(x=M?.signInWithEthereum)===null||x===void 0?void 0:x.resources};_=T4(Q),w=await T.request({method:"personal_sign",params:[E4(_),I]})}try{const{data:y,error:b}=await Ke(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:_,signature:w},!((g=t.options)===null||g===void 0)&&g.captchaToken?{gotrue_meta_security:{captcha_token:(v=t.options)===null||v===void 0?void 0:v.captchaToken}}:null),xform:nn});if(b)throw b;if(!y||!y.session||!y.user){const A=new vl;return this._returnResult({data:{user:null,session:null},error:A})}return y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("SIGNED_IN",y.session)),this._returnResult({data:Object.assign({},y),error:b})}catch(y){if(Ve(y))return this._returnResult({data:{user:null,session:null},error:y});throw y}}async signInWithSolana(t){var r,n,i,l,o,u,h,d,x,g,v,_;let w,y;if("message"in t)w=t.message,y=t.signature;else{const{chain:b,wallet:A,statement:M,options:T}=t;let U;if(Lr())if(typeof A=="object")U=A;else{const I=window;if("solana"in I&&typeof I.solana=="object"&&("signIn"in I.solana&&typeof I.solana.signIn=="function"||"signMessage"in I.solana&&typeof I.solana.signMessage=="function"))U=I.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof A!="object"||!T?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");U=A}const q=new URL((r=T?.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in U&&U.signIn){const I=await U.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},T?.signInWithSolana),{version:"1",domain:q.host,uri:q.href}),M?{statement:M}:null));let R;if(Array.isArray(I)&&I[0]&&typeof I[0]=="object")R=I[0];else if(I&&typeof I=="object"&&"signedMessage"in I&&"signature"in I)R=I;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in R&&"signature"in R&&(typeof R.signedMessage=="string"||R.signedMessage instanceof Uint8Array)&&R.signature instanceof Uint8Array)w=typeof R.signedMessage=="string"?R.signedMessage:new TextDecoder().decode(R.signedMessage),y=R.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in U)||typeof U.signMessage!="function"||!("publicKey"in U)||typeof U!="object"||!U.publicKey||!("toBase58"in U.publicKey)||typeof U.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");w=[`${q.host} wants you to sign in with your Solana account:`,U.publicKey.toBase58(),...M?["",M,""]:[""],"Version: 1",`URI: ${q.href}`,`Issued At: ${(i=(n=T?.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((l=T?.signInWithSolana)===null||l===void 0)&&l.notBefore?[`Not Before: ${T.signInWithSolana.notBefore}`]:[],...!((o=T?.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${T.signInWithSolana.expirationTime}`]:[],...!((u=T?.signInWithSolana)===null||u===void 0)&&u.chainId?[`Chain ID: ${T.signInWithSolana.chainId}`]:[],...!((h=T?.signInWithSolana)===null||h===void 0)&&h.nonce?[`Nonce: ${T.signInWithSolana.nonce}`]:[],...!((d=T?.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${T.signInWithSolana.requestId}`]:[],...!((g=(x=T?.signInWithSolana)===null||x===void 0?void 0:x.resources)===null||g===void 0)&&g.length?["Resources",...T.signInWithSolana.resources.map(R=>`- ${R}`)]:[]].join(`
`);const I=await U.signMessage(new TextEncoder().encode(w),"utf8");if(!I||!(I instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");y=I}}try{const{data:b,error:A}=await Ke(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:w,signature:ps(y)},!((v=t.options)===null||v===void 0)&&v.captchaToken?{gotrue_meta_security:{captcha_token:(_=t.options)===null||_===void 0?void 0:_.captchaToken}}:null),xform:nn});if(A)throw A;if(!b||!b.session||!b.user){const M=new vl;return this._returnResult({data:{user:null,session:null},error:M})}return b.session&&(await this._saveSession(b.session),await this._notifyAllSubscribers("SIGNED_IN",b.session)),this._returnResult({data:Object.assign({},b),error:A})}catch(b){if(Ve(b))return this._returnResult({data:{user:null,session:null},error:b});throw b}}async _exchangeCodeForSession(t){const r=await us(this.storage,`${this.storageKey}-code-verifier`),[n,i]=(r??"").split("/");try{if(!n&&this.flowType==="pkce")throw new GT;const{data:l,error:o}=await Ke(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:nn});if(await Br(this.storage,`${this.storageKey}-code-verifier`),o)throw o;if(!l||!l.session||!l.user){const u=new vl;return this._returnResult({data:{user:null,session:null,redirectType:null},error:u})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:Object.assign(Object.assign({},l),{redirectType:i??null}),error:o})}catch(l){if(await Br(this.storage,`${this.storageKey}-code-verifier`),Ve(l))return this._returnResult({data:{user:null,session:null,redirectType:null},error:l});throw l}}async signInWithIdToken(t){try{const{options:r,provider:n,token:i,access_token:l,nonce:o}=t,u=await Ke(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:i,access_token:l,nonce:o,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:nn}),{data:h,error:d}=u;if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!h||!h.session||!h.user){const x=new vl;return this._returnResult({data:{user:null,session:null},error:x})}return h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",h.session)),this._returnResult({data:h,error:d})}catch(r){if(Ve(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(t){var r,n,i,l,o;try{if("email"in t){const{email:u,options:h}=t;let d=null,x=null;this.flowType==="pkce"&&([d,x]=await yl(this.storage,this.storageKey));const{error:g}=await Ke(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:u,data:(r=h?.data)!==null&&r!==void 0?r:{},create_user:(n=h?.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:h?.captchaToken},code_challenge:d,code_challenge_method:x},redirectTo:h?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:g})}if("phone"in t){const{phone:u,options:h}=t,{data:d,error:x}=await Ke(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:u,data:(i=h?.data)!==null&&i!==void 0?i:{},create_user:(l=h?.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:h?.captchaToken},channel:(o=h?.channel)!==null&&o!==void 0?o:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:d?.message_id},error:x})}throw new G0("You must provide either an email or phone number.")}catch(u){if(await Br(this.storage,`${this.storageKey}-code-verifier`),Ve(u))return this._returnResult({data:{user:null,session:null},error:u});throw u}}async verifyOtp(t){var r,n;try{let i,l;"options"in t&&(i=(r=t.options)===null||r===void 0?void 0:r.redirectTo,l=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:o,error:u}=await Ke(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:l}}),redirectTo:i,xform:nn});if(u)throw u;if(!o)throw new Error("An error occurred on token verification.");const h=o.session,d=o.user;return h?.access_token&&(await this._saveSession(h),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",h)),this._returnResult({data:{user:d,session:h},error:null})}catch(i){if(Ve(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithSSO(t){var r,n,i,l,o;try{let u=null,h=null;this.flowType==="pkce"&&([u,h]=await yl(this.storage,this.storageKey));const d=await Ke(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((i=t?.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:u,code_challenge_method:h}),headers:this.headers,xform:p4});return!((l=d.data)===null||l===void 0)&&l.url&&Lr()&&!(!((o=t.options)===null||o===void 0)&&o.skipBrowserRedirect)&&window.location.assign(d.data.url),this._returnResult(d)}catch(u){if(await Br(this.storage,`${this.storageKey}-code-verifier`),Ve(u))return this._returnResult({data:null,error:u});throw u}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new ba;const{error:i}=await Ke(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:i})})}catch(t){if(Ve(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:i,options:l}=t,{error:o}=await Ke(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:i,gotrue_meta_security:{captcha_token:l?.captchaToken}},redirectTo:l?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}else if("phone"in t){const{phone:n,type:i,options:l}=t,{data:o,error:u}=await Ke(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:i,gotrue_meta_security:{captcha_token:l?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:o?.message_id},error:u})}throw new G0("You must provide either an email or phone number and a type")}catch(r){if(Ve(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await us(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<ad:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const o=await us(this.userStorage,this.storageKey+"-user");o?.user?t.user=o.user:t.user=sd()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const o={value:this.suppressGetSessionWarning};t.user=h4(t.user,o),o.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:i,error:l}=await this._callRefreshToken(t.refresh_token);return l?this._returnResult({data:{session:null},error:l}):this._returnResult({data:{session:i},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){if(t)return await this._getUser(t);await this.initializePromise;const r=await this._acquireLock(-1,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(t){try{return t?await Ke(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Bi}):await this._useSession(async r=>{var n,i,l;const{data:o,error:u}=r;if(u)throw u;return!(!((n=o.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new ba}:await Ke(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(l=(i=o.session)===null||i===void 0?void 0:i.access_token)!==null&&l!==void 0?l:void 0,xform:Bi})})}catch(r){if(Ve(r))return VT(r)&&(await this._removeSession(),await Br(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:i,error:l}=n;if(l)throw l;if(!i.session)throw new ba;const o=i.session;let u=null,h=null;this.flowType==="pkce"&&t.email!=null&&([u,h]=await yl(this.storage,this.storageKey));const{data:d,error:x}=await Ke(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:u,code_challenge_method:h}),jwt:o.access_token,xform:Bi});if(x)throw x;return o.user=d.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),this._returnResult({data:{user:o.user},error:null})})}catch(n){if(await Br(this.storage,`${this.storageKey}-code-verifier`),Ve(n))return this._returnResult({data:{user:null},error:n});throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new ba;const r=Date.now()/1e3;let n=r,i=!0,l=null;const{payload:o}=id(t.access_token);if(o.exp&&(n=o.exp,i=n<=r),i){const{data:u,error:h}=await this._callRefreshToken(t.refresh_token);if(h)return this._returnResult({data:{user:null,session:null},error:h});if(!u)return{data:{user:null,session:null},error:null};l=u}else{const{data:u,error:h}=await this._getUser(t.access_token);if(h)throw h;l={access_token:t.access_token,refresh_token:t.refresh_token,user:u.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)}return this._returnResult({data:{user:l.user,session:l},error:null})}catch(r){if(Ve(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:o,error:u}=r;if(u)throw u;t=(n=o.session)!==null&&n!==void 0?n:void 0}if(!t?.refresh_token)throw new ba;const{data:i,error:l}=await this._callRefreshToken(t.refresh_token);return l?this._returnResult({data:{user:null,session:null},error:l}):i?this._returnResult({data:{user:i.user,session:i},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(Ve(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(t,r){try{if(!Lr())throw new q0("No browser detected.");if(t.error||t.error_description||t.error_code)throw new q0(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new rv("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new q0("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new rv("No code detected.");const{data:M,error:T}=await this._exchangeCodeForSession(t.code);if(T)throw T;const U=new URL(window.location.href);return U.searchParams.delete("code"),window.history.replaceState(window.history.state,"",U.toString()),{data:{session:M.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:i,access_token:l,refresh_token:o,expires_in:u,expires_at:h,token_type:d}=t;if(!l||!u||!o||!d)throw new q0("No session defined in URL");const x=Math.round(Date.now()/1e3),g=parseInt(u);let v=x+g;h&&(v=parseInt(h));const _=v-x;_*1e3<=Al&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${_}s, should have been closer to ${g}s`);const w=v-g;x-w>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",w,v,x):x-w<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",w,v,x);const{data:y,error:b}=await this._getUser(l);if(b)throw b;const A={provider_token:n,provider_refresh_token:i,access_token:l,expires_in:g,expires_at:v,refresh_token:o,token_type:d,user:y.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:A,redirectType:t.type},error:null})}catch(n){if(Ve(n))return this._returnResult({data:{session:null,redirectType:null},error:n});throw n}}_isImplicitGrantCallback(t){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),t):!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await us(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:i,error:l}=r;if(l)return this._returnResult({error:l});const o=(n=i.session)===null||n===void 0?void 0:n.access_token;if(o){const{error:u}=await this.admin.signOut(o,t);if(u&&!(HT(u)&&(u.status===404||u.status===401||u.status===403)))return this._returnResult({error:u})}return t!=="others"&&(await this._removeSession(),await Br(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const r=QT(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,i;try{const{data:{session:l},error:o}=r;if(o)throw o;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",l)),this._debug("INITIAL_SESSION","callback id",t,"session",l)}catch(l){await((i=this.stateChangeEmitters.get(t))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",l),console.error(l)}})}async resetPasswordForEmail(t,r={}){let n=null,i=null;this.flowType==="pkce"&&([n,i]=await yl(this.storage,this.storageKey,!0));try{return await Ke(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:i,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(l){if(await Br(this.storage,`${this.storageKey}-code-verifier`),Ve(l))return this._returnResult({data:null,error:l});throw l}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return this._returnResult({data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(r){if(Ve(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:n,error:i}=await this._useSession(async l=>{var o,u,h,d,x;const{data:g,error:v}=l;if(v)throw v;const _=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(o=t.options)===null||o===void 0?void 0:o.redirectTo,scopes:(u=t.options)===null||u===void 0?void 0:u.scopes,queryParams:(h=t.options)===null||h===void 0?void 0:h.queryParams,skipBrowserRedirect:!0});return await Ke(this.fetch,"GET",_,{headers:this.headers,jwt:(x=(d=g.session)===null||d===void 0?void 0:d.access_token)!==null&&x!==void 0?x:void 0})});if(i)throw i;return Lr()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n?.url),this._returnResult({data:{provider:t.provider,url:n?.url},error:null})}catch(n){if(Ve(n))return this._returnResult({data:{provider:t.provider,url:null},error:n});throw n}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var n;try{const{error:i,data:{session:l}}=r;if(i)throw i;const{options:o,provider:u,token:h,access_token:d,nonce:x}=t,g=await Ke(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=l?.access_token)!==null&&n!==void 0?n:void 0,body:{provider:u,id_token:h,access_token:d,nonce:x,link_identity:!0,gotrue_meta_security:{captcha_token:o?.captchaToken}},xform:nn}),{data:v,error:_}=g;return _?this._returnResult({data:{user:null,session:null},error:_}):!v||!v.session||!v.user?this._returnResult({data:{user:null,session:null},error:new vl}):(v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers("USER_UPDATED",v.session)),this._returnResult({data:v,error:_}))}catch(i){if(await Br(this.storage,`${this.storageKey}-code-verifier`),Ve(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,i;const{data:l,error:o}=r;if(o)throw o;return await Ke(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(i=(n=l.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0})})}catch(r){if(Ve(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await r4(async i=>(i>0&&await t4(200*Math.pow(2,i-1)),this._debug(r,"refreshing attempt",i),await Ke(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:nn})),(i,l)=>{const o=200*Math.pow(2,i);return l&&nd(l)&&Date.now()+o-n<Al})}catch(n){if(this._debug(r,"error",n),Ve(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),Lr()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const i=await us(this.storage,this.storageKey);if(i&&this.userStorage){let o=await us(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:i.user},await Cl(this.userStorage,this.storageKey+"-user",o)),i.user=(t=o?.user)!==null&&t!==void 0?t:sd()}else if(i&&!i.user&&!i.user){const o=await us(this.storage,this.storageKey+"-user");o&&o?.user?(i.user=o.user,await Br(this.storage,this.storageKey+"-user"),await Cl(this.storage,this.storageKey,i)):i.user=sd()}if(this._debug(n,"session from storage",i),!this._isValidSession(i)){this._debug(n,"session is not valid"),i!==null&&await this._removeSession();return}const l=((r=i.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<ad;if(this._debug(n,`session has${l?"":" not"} expired with margin of ${ad}s`),l){if(this.autoRefreshToken&&i.refresh_token){const{error:o}=await this._callRefreshToken(i.refresh_token);o&&(console.error(o),nd(o)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(i.user&&i.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:u}=await this._getUser(i.access_token);!u&&o?.user?(i.user=o.user,await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(n,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(n,"error",i),console.error(i);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new ba;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new Cu;const{data:l,error:o}=await this._refreshAccessToken(t);if(o)throw o;if(!l.session)throw new ba;await this._saveSession(l.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",l.session);const u={data:l.session,error:null};return this.refreshingDeferred.resolve(u),u}catch(l){if(this._debug(i,"error",l),Ve(l)){const o={data:null,error:l};return nd(l)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(o),o}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(l),l}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(t,r,n=!0){const i=`#_notifyAllSubscribers(${t})`;this._debug(i,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const l=[],o=Array.from(this.stateChangeEmitters.values()).map(async u=>{try{await u.callback(t,r)}catch(h){l.push(h)}});if(await Promise.all(o),l.length>0){for(let u=0;u<l.length;u+=1)console.error(l[u]);throw l[0]}}finally{this._debug(i,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await Br(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await Cl(this.userStorage,this.storageKey+"-user",{user:r.user});const i=Object.assign({},r);delete i.user;const l=lv(i);await Cl(this.storage,this.storageKey,l)}else{const i=lv(r);await Cl(this.storage,this.storageKey,i)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await Br(this.storage,this.storageKey),await Br(this.storage,this.storageKey+"-code-verifier"),await Br(this.storage,this.storageKey+"-user"),this.userStorage&&await Br(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Lr()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Al);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((n.expires_at*1e3-t)/Al);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${Al}ms, refresh threshold is ${Rd} ticks`),i<=Rd&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof Ky)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Lr()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const i=[`provider=${encodeURIComponent(r)}`];if(n?.redirectTo&&i.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n?.scopes&&i.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[l,o]=await yl(this.storage,this.storageKey),u=new URLSearchParams({code_challenge:`${encodeURIComponent(l)}`,code_challenge_method:`${encodeURIComponent(o)}`});i.push(u.toString())}if(n?.queryParams){const l=new URLSearchParams(n.queryParams);i.push(l.toString())}return n?.skipBrowserRedirect&&i.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${i.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:i,error:l}=r;return l?this._returnResult({data:null,error:l}):await Ke(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=i?.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Ve(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,i;const{data:l,error:o}=r;if(o)return this._returnResult({data:null,error:o});const u=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:h,error:d}=await Ke(this.fetch,"POST",`${this.url}/factors`,{body:u,headers:this.headers,jwt:(n=l?.session)===null||n===void 0?void 0:n.access_token});return d?this._returnResult({data:null,error:d}):(t.factorType==="totp"&&h.type==="totp"&&(!((i=h?.totp)===null||i===void 0)&&i.qr_code)&&(h.totp.qr_code=`data:image/svg+xml;utf-8,${h.totp.qr_code}`),this._returnResult({data:h,error:null}))})}catch(r){if(Ve(r))return this._returnResult({data:null,error:r});throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:l}=r;if(l)return this._returnResult({data:null,error:l});const o=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?D4(t.webauthn.credential_response):F4(t.webauthn.credential_response)})}:{code:t.code}),{data:u,error:h}=await Ke(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:o,headers:this.headers,jwt:(n=i?.session)===null||n===void 0?void 0:n.access_token});return h?this._returnResult({data:null,error:h}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+u.expires_in},u)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",u),this._returnResult({data:u,error:h}))})}catch(r){if(Ve(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:l}=r;if(l)return this._returnResult({data:null,error:l});const o=await Ke(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(n=i?.session)===null||n===void 0?void 0:n.access_token});if(o.error)return o;const{data:u}=o;if(u.type!=="webauthn")return{data:u,error:null};switch(u.webauthn.type){case"create":return{data:Object.assign(Object.assign({},u),{webauthn:Object.assign(Object.assign({},u.webauthn),{credential_options:Object.assign(Object.assign({},u.webauthn.credential_options),{publicKey:O4(u.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},u),{webauthn:Object.assign(Object.assign({},u.webauthn),{credential_options:Object.assign(Object.assign({},u.webauthn.credential_options),{publicKey:R4(u.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(Ve(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?this._returnResult({data:null,error:n}):await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:n}=await this.getUser();if(n)return{data:null,error:n};const i={all:[],phone:[],totp:[],webauthn:[]};for(const l of(t=r?.factors)!==null&&t!==void 0?t:[])i.all.push(l),l.status==="verified"&&i[l.factor_type].push(l);return{data:i,error:null}}async _getAuthenticatorAssuranceLevel(){var t,r;const{data:{session:n},error:i}=await this.getSession();if(i)return this._returnResult({data:null,error:i});if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:l}=id(n.access_token);let o=null;l.aal&&(o=l.aal);let u=o;((r=(t=n.user.factors)===null||t===void 0?void 0:t.filter(x=>x.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(u="aal2");const d=l.amr||[];return{data:{currentLevel:o,nextLevel:u,currentAuthenticationMethods:d},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async r=>{const{data:{session:n},error:i}=r;return i?this._returnResult({data:null,error:i}):n?await Ke(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:n.access_token,xform:l=>({data:l,error:null})}):this._returnResult({data:null,error:new ba})})}catch(r){if(Ve(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:i},error:l}=n;if(l)return this._returnResult({data:null,error:l});if(!i)return this._returnResult({data:null,error:new ba});const o=await Ke(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"approve"},xform:u=>({data:u,error:null})});return o.data&&o.data.redirect_url&&Lr()&&!r?.skipBrowserRedirect&&window.location.assign(o.data.redirect_url),o})}catch(n){if(Ve(n))return this._returnResult({data:null,error:n});throw n}}async _denyAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:i},error:l}=n;if(l)return this._returnResult({data:null,error:l});if(!i)return this._returnResult({data:null,error:new ba});const o=await Ke(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"deny"},xform:u=>({data:u,error:null})});return o.data&&o.data.redirect_url&&Lr()&&!r?.skipBrowserRedirect&&window.location.assign(o.data.redirect_url),o})}catch(n){if(Ve(n))return this._returnResult({data:null,error:n});throw n}}async _listOAuthGrants(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;return n?this._returnResult({data:null,error:n}):r?await Ke(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new ba})})}catch(t){if(Ve(t))return this._returnResult({data:null,error:t});throw t}}async _revokeOAuthGrant(t){try{return await this._useSession(async r=>{const{data:{session:n},error:i}=r;return i?this._returnResult({data:null,error:i}):n?(await Ke(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,query:{client_id:t.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new ba})})}catch(r){if(Ve(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(u=>u.kid===t);if(n)return n;const i=Date.now();if(n=this.jwks.keys.find(u=>u.kid===t),n&&this.jwks_cached_at+PT>i)return n;const{data:l,error:o}=await Ke(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!l.keys||l.keys.length===0||(this.jwks=l,this.jwks_cached_at=i,n=l.keys.find(u=>u.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:_,error:w}=await this.getSession();if(w||!_.session)return this._returnResult({data:null,error:w});n=_.session.access_token}const{header:i,payload:l,signature:o,raw:{header:u,payload:h}}=id(n);r?.allowExpired||o4(l.exp);const d=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(i.kid,r?.keys?{keys:r.keys}:r?.jwks);if(!d){const{error:_}=await this.getUser(n);if(_)throw _;return{data:{claims:l,header:i,signature:o},error:null}}const x=u4(i.alg),g=await crypto.subtle.importKey("jwk",d,x,!0,["verify"]);if(!await crypto.subtle.verify(x,g,o,YT(`${u}.${h}`)))throw new Md("Invalid JWT signature");return{data:{claims:l,header:i,signature:o},error:null}}catch(n){if(Ve(n))return this._returnResult({data:null,error:n});throw n}}}ao.nextInstanceID={};const H4=ao,V4="2.89.0";let jc="";typeof Deno<"u"?jc="deno":typeof document<"u"?jc="web":typeof navigator<"u"&&navigator.product==="ReactNative"?jc="react-native":jc="node";const $4={"X-Client-Info":`supabase-js-${jc}/${V4}`},G4={headers:$4},q4={schema:"public"},X4={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},W4={};function no(e){"@babel/helpers - typeof";return no=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},no(e)}function K4(e,t){if(no(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(no(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Y4(e){var t=K4(e,"string");return no(t)=="symbol"?t:t+""}function J4(e,t,r){return(t=Y4(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mv(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function rr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?mv(Object(r),!0).forEach(function(n){J4(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mv(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}const Q4=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),Z4=()=>Headers,ek=(e,t,r)=>{const n=Q4(r),i=Z4();return async(l,o)=>{var u;const h=(u=await t())!==null&&u!==void 0?u:e;let d=new i(o?.headers);return d.has("apikey")||d.set("apikey",e),d.has("Authorization")||d.set("Authorization",`Bearer ${h}`),n(l,rr(rr({},o),{},{headers:d}))}};function tk(e){return e.endsWith("/")?e:e+"/"}function rk(e,t){var r,n;const{db:i,auth:l,realtime:o,global:u}=e,{db:h,auth:d,realtime:x,global:g}=t,v={db:rr(rr({},h),i),auth:rr(rr({},d),l),realtime:rr(rr({},x),o),storage:{},global:rr(rr(rr({},g),u),{},{headers:rr(rr({},(r=g?.headers)!==null&&r!==void 0?r:{}),(n=u?.headers)!==null&&n!==void 0?n:{})}),accessToken:async()=>""};return e.accessToken?v.accessToken=e.accessToken:delete v.accessToken,v}function ak(e){const t=e?.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(tk(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var nk=class extends H4{constructor(e){super(e)}},ik=class{constructor(e,t,r){var n,i;this.supabaseUrl=e,this.supabaseKey=t;const l=ak(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const o=`sb-${l.hostname.split(".")[0]}-auth-token`,u={db:q4,realtime:W4,auth:rr(rr({},X4),{},{storageKey:o}),global:G4},h=rk(r??{},u);if(this.storageKey=(n=h.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(i=h.global.headers)!==null&&i!==void 0?i:{},h.accessToken)this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(x,g)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(g)} is not possible`)}});else{var d;this.auth=this._initSupabaseAuthClient((d=h.auth)!==null&&d!==void 0?d:{},this.headers,h.global.fetch)}this.fetch=ek(t,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(rr({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.accessToken&&this.accessToken().then(x=>this.realtime.setAuth(x)).catch(x=>console.warn("Failed to set initial Realtime auth token:",x)),this.rest=new UE(new URL("rest/v1",l).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),this.storage=new BT(this.storageUrl.href,this.headers,this.fetch,r?.storage),h.accessToken||this._listenForAuthEvents()}get functions(){return new FE(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e=this,t,r;if(e.accessToken)return await e.accessToken();const{data:n}=await e.auth.getSession();return(t=(r=n.session)===null||r===void 0?void 0:r.access_token)!==null&&t!==void 0?t:e.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,userStorage:i,storageKey:l,flowType:o,lock:u,debug:h,throwOnError:d},x,g){const v={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new nk({url:this.authUrl.href,headers:rr(rr({},v),x),storageKey:l,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,userStorage:i,flowType:o,lock:u,debug:h,throwOnError:d,fetch:g,hasCustomAuthorizationHeader:Object.keys(this.headers).some(_=>_.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new tT(this.realtimeUrl.href,rr(rr({},e),{},{params:rr(rr({},{apikey:this.supabaseKey}),e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",t?.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const sk=(e,t,r)=>new ik(e,t,r);function lk(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}lk()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const hu="",ck="",Mi=!!hu,X0=(()=>{try{return hu&&new URL(hu).hostname.split(".")[0]||null}catch{return null}})(),W0="supabase",xv=Mi?sk(hu,ck,{auth:{persistSession:!0,autoRefreshToken:!0}}):null,Sa={medications:"bodegapp:medications",monthlyBatches:"bodegapp:monthlyBatches",selectedMonthlyBatchId:"bodegapp:selectedMonthlyBatchId",tertiaryPackaging:"bodegapp:tertiaryPackaging"},ok=[{id:1,inventory_type:"772",name:"Paracetamol",siges_code:"SIG-0001",sicop_classifier:"SICOP-CL-01",sicop_identifier:"SICOP-ID-0001",category:"Analgsico",batch:"LOT-2023-01",expiry_date:"2025-12-30",stock:500,min_stock:100,unit:"Tabletas"},{id:2,inventory_type:"772",name:"Amoxicilina",siges_code:"SIG-0002",sicop_classifier:"SICOP-CL-02",sicop_identifier:"SICOP-ID-0002",category:"Antibiotico",batch:"LOT-2023-05",expiry_date:"2024-06-15",stock:45,min_stock:50,unit:"Cpsulas"},{id:3,inventory_type:"772",name:"Ibuprofeno",siges_code:"SIG-0003",sicop_classifier:"SICOP-CL-03",sicop_identifier:"SICOP-ID-0003",category:"Antiinflamatorio",batch:"LOT-2023-09",expiry_date:"2026-01-20",stock:120,min_stock:40,unit:"Jarabe"},{id:4,inventory_type:"772",name:"Omeprazol",siges_code:"SIG-0004",sicop_classifier:"SICOP-CL-04",sicop_identifier:"SICOP-ID-0004",category:"Protector Gstrico",batch:"LOT-2023-12",expiry_date:"2025-03-10",stock:15,min_stock:30,unit:"Cpsulas"}];function Qy(e){try{return JSON.parse(e)}catch{return null}}function cd(e){const t=window.localStorage.getItem(e);if(!t)return null;const r=Qy(t);return Array.isArray(r)?r:null}function qn(e,t){window.localStorage.setItem(e,JSON.stringify(t))}const uk={async getMedications(){return cd(Sa.medications)??ok},async clearMedicationsByInventoryType(e){const t=String(e||"772"),n=(await this.getMedications()??[]).filter(i=>String(i.inventory_type||"772")!==t);return qn(Sa.medications,n),n},async upsertMedication(e){const t=await this.getMedications()??[],r=e?.id,n=r==null?[...t,e]:t.some(i=>i.id===r)?t.map(i=>i.id===r?e:i):[...t,e];return qn(Sa.medications,n),e},async upsertMedications(e){const t=await this.getMedications()??[],r=new Map(t.map(i=>[i.id,i]));for(const i of e)r.set(i.id,i);const n=Array.from(r.values());return qn(Sa.medications,n),n},async deleteMedication(e){const r=(await this.getMedications()??[]).filter(n=>n.id!==e);qn(Sa.medications,r)},async clearMedications(){qn(Sa.medications,[])},async getMonthlyBatches(){return(cd(Sa.monthlyBatches)??[]).map(t=>({...t,id:t?.id!=null?String(t.id):t.id}))},async saveMonthlyBatch(e){const t=await this.getMonthlyBatches()??[],r={...e,id:e?.id!=null?String(e.id):e.id},n=[r,...t.filter(i=>String(i.id)!==String(r.id))];return qn(Sa.monthlyBatches,n),r},async getSelectedMonthlyBatchId(){const e=window.localStorage.getItem(Sa.selectedMonthlyBatchId),t=e?Qy(e)??e:null;return t==null?null:String(t)},async setSelectedMonthlyBatchId(e){qn(Sa.selectedMonthlyBatchId,e)},async getTertiaryPackaging(){return cd(Sa.tertiaryPackaging)??[]},async upsertTertiaryPackaging(e){const t=await this.getTertiaryPackaging()??[],r=new Map(t.map(i=>[String(i.siges_code||"").trim(),i]));for(const i of e??[]){const l=String(i?.siges_code||"").trim();l&&r.set(l,{...i,siges_code:l})}const n=Array.from(r.values());return qn(Sa.tertiaryPackaging,n),n},async clearTertiaryPackaging(){qn(Sa.tertiaryPackaging,[])}};function rn(){if(!xv)throw new Error("Supabase no est configurado (faltan VITE_SUPABASE_URL / VITE_SUPABASE_ANON_KEY).");return xv}function pv(e){return e?.id?e:globalThis.crypto?.randomUUID?{...e,id:globalThis.crypto.randomUUID()}:{...e,id:String(Date.now())}}const fk={async getMedications(){const e=rn(),t=1e3;let r=0;const n=[];for(;;){const{data:i,error:l}=await e.from("medications").select("*").order("created_at",{ascending:!0}).range(r,r+t-1);if(l)throw l;const o=i??[];if(n.push(...o),o.length<t)break;r+=t}return n},async clearMedicationsByInventoryType(e){const t=rn(),r=String(e||"772"),{error:n}=await t.from("medications").delete().eq("inventory_type",r);if(n)throw n},async upsertMedication(e){const t=rn(),r=pv(e),{data:n,error:i}=await t.from("medications").upsert(r,{onConflict:"id"}).select("*").single();if(i)throw i;return n},async upsertMedications(e){const t=rn(),r=(e??[]).map(pv),{data:n,error:i}=await t.from("medications").upsert(r,{onConflict:"id"}).select("*");if(i)throw i;return n??[]},async deleteMedication(e){const t=rn(),{error:r}=await t.from("medications").delete().eq("id",e);if(r)throw r},async clearMedications(){const e=rn(),{error:t}=await e.from("medications").delete().neq("id","00000000-0000-0000-0000-000000000000");if(t)throw t},async getMonthlyBatches(){const e=rn(),{data:t,error:r}=await e.from("monthly_batches").select("id,label,items:monthly_batch_items(id,siges_code,medication_name,quantity,cost)").order("created_at",{ascending:!1});if(r)throw r;return(t??[]).map(n=>({...n,items:n.items??[]}))},async saveMonthlyBatch({id:e,label:t,items:r}){const n=rn(),{data:i,error:l}=await n.from("monthly_batches").upsert({id:e,label:t},{onConflict:"label"}).select("id,label").single();if(l)throw l;const{error:o}=await n.from("monthly_batch_items").delete().eq("batch_id",i.id);if(o)throw o;const u=(r??[]).map(h=>({id:globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():String(Date.now())+Math.random(),batch_id:i.id,siges_code:h.siges_code,medication_name:h.medication_name,quantity:h.quantity,cost:h.cost}));if(u.length>0){const{error:h}=await n.from("monthly_batch_items").insert(u);if(h)throw h}return{...i,items:r}},async getSelectedMonthlyBatchId(){return null},async setSelectedMonthlyBatchId(){},async getTertiaryPackaging(){const e=rn(),{data:t,error:r}=await e.from("tertiary_packaging").select("*").order("siges_code",{ascending:!0});if(r)throw r;return t??[]},async upsertTertiaryPackaging(e){const t=rn(),n=(e??[]).map(o=>({id:o?.id||(globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():String(Date.now())+Math.random()),siges_code:String(o?.siges_code||"").trim(),medication_name:String(o?.medication_name||"").trim(),tertiary_quantity:Number(o?.tertiary_quantity)||0})).filter(o=>!!o.siges_code);if(n.length===0)return[];const{data:i,error:l}=await t.from("tertiary_packaging").upsert(n,{onConflict:"siges_code"}).select("*");if(l)throw l;return i??[]},async clearTertiaryPackaging(){const e=rn(),{error:t}=await e.from("tertiary_packaging").delete().neq("id","00000000-0000-0000-0000-000000000000");if(t)throw t}},Vt=Mi?fk:uk;var du={};du.version="0.18.5";var Zy=1252,hk=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],r1={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},a1=function(e){hk.indexOf(e)!=-1&&(Zy=r1[0]=e)};function dk(){a1(1252)}var cn=function(e){a1(e)};function n1(){cn(1200),dk()}function gv(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function mk(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function e_(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Pc=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?mk(e.slice(2)):t==254&&r==255?e_(e.slice(2)):t==65279?e.slice(1):e},K0=function(t){return String.fromCharCode(t)},vv=function(t){return String.fromCharCode(t)},io,Li="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function so(e){for(var t="",r=0,n=0,i=0,l=0,o=0,u=0,h=0,d=0;d<e.length;)r=e.charCodeAt(d++),l=r>>2,n=e.charCodeAt(d++),o=(r&3)<<4|n>>4,i=e.charCodeAt(d++),u=(n&15)<<2|i>>6,h=i&63,isNaN(n)?u=h=64:isNaN(i)&&(h=64),t+=Li.charAt(l)+Li.charAt(o)+Li.charAt(u)+Li.charAt(h);return t}function Oa(e){var t="",r=0,n=0,i=0,l=0,o=0,u=0,h=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<e.length;)l=Li.indexOf(e.charAt(d++)),o=Li.indexOf(e.charAt(d++)),r=l<<2|o>>4,t+=String.fromCharCode(r),u=Li.indexOf(e.charAt(d++)),n=(o&15)<<4|u>>2,u!==64&&(t+=String.fromCharCode(n)),h=Li.indexOf(e.charAt(d++)),i=(u&3)<<6|h,h!==64&&(t+=String.fromCharCode(i));return t}var ct=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),ei=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function Ui(e){return ct?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function yv(e){return ct?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Ca=function(t){return ct?ei(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Nu(e){if(typeof ArrayBuffer>"u")return Ca(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Hi(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function xk(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function i1(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return i1(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Cr=ct?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:ei(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),i=0;for(t=0,r=0;t<e.length;r+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(l){return Array.isArray(l)?l:[].slice.call(l)}))};function pk(e){for(var t=[],r=0,n=e.length+250,i=Ui(e.length+255),l=0;l<e.length;++l){var o=e.charCodeAt(l);if(o<128)i[r++]=o;else if(o<2048)i[r++]=192|o>>6&31,i[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var u=e.charCodeAt(++l)&1023;i[r++]=240|o>>8&7,i[r++]=128|o>>2&63,i[r++]=128|u>>6&15|(o&3)<<4,i[r++]=128|u&63}else i[r++]=224|o>>12&15,i[r++]=128|o>>6&63,i[r++]=128|o&63;r>n&&(t.push(i.slice(0,r)),r=0,i=Ui(65535),n=65530)}return t.push(i.slice(0,r)),Cr(t)}var ta=/\u0000/g,zc=/[\u0001-\u0006]/g;function Fl(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function on(e,t){var r=""+e;return r.length>=t?r:ar("0",t-r.length)+r}function s1(e,t){var r=""+e;return r.length>=t?r:ar(" ",t-r.length)+r}function mu(e,t){var r=""+e;return r.length>=t?r:r+ar(" ",t-r.length)}function gk(e,t){var r=""+Math.round(e);return r.length>=t?r:ar("0",t-r.length)+r}function vk(e,t){var r=""+e;return r.length>=t?r:ar("0",t-r.length)+r}var _v=Math.pow(2,32);function bl(e,t){if(e>_v||e<-_v)return gk(e,t);var r=Math.round(e);return vk(r,t)}function xu(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var wv=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],od=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function yk(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Je={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Sv={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},_k={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function pu(e,t,r){for(var n=e<0?-1:1,i=e*n,l=0,o=1,u=0,h=1,d=0,x=0,g=Math.floor(i);d<t&&(g=Math.floor(i),u=g*o+l,x=g*d+h,!(i-g<5e-8));)i=1/(i-g),l=o,o=u,h=d,d=x;if(x>t&&(d>t?(x=h,u=l):(x=d,u=o)),!r)return[0,n*u,x];var v=Math.floor(n*u/x);return[v,n*u-v*x,x]}function gs(e,t,r){if(e>2958465||e<0)return null;var n=e|0,i=Math.floor(86400*(e-n)),l=0,o=[],u={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),t&&t.date1904&&(n+=1462),u.u>.9999&&(u.u=0,++i==86400&&(u.T=i=0,++n,++u.D)),n===60)o=r?[1317,10,29]:[1900,2,29],l=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],l=6;else{n>60&&--n;var h=new Date(1900,0,1);h.setDate(h.getDate()+n-1),o=[h.getFullYear(),h.getMonth()+1,h.getDate()],l=h.getDay(),n<60&&(l=(l+6)%7),r&&(l=kk(h,o))}return u.y=o[0],u.m=o[1],u.d=o[2],u.S=i%60,i=Math.floor(i/60),u.M=i%60,i=Math.floor(i/60),u.H=i,u.q=l,u}var t_=new Date(1899,11,31,0,0,0),wk=t_.getTime(),Sk=new Date(1900,2,1,0,0,0);function r_(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=Sk&&(r+=1440*60*1e3),(r-(wk+(e.getTimezoneOffset()-t_.getTimezoneOffset())*6e4))/(1440*60*1e3)}function l1(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function bk(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Ek(e){var t=e<0?12:11,r=l1(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function Tk(e){var t=l1(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function lo(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=Ek(e):t===10?r=e.toFixed(10).substr(0,12):r=Tk(e),l1(bk(r.toUpperCase()))}function Ss(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):lo(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Ya(14,r_(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function kk(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function Ak(e,t,r,n){var i="",l=0,o=0,u=r.y,h,d=0;switch(e){case 98:u=r.y+543;case 121:switch(t.length){case 1:case 2:h=u%100,d=2;break;default:h=u%1e4,d=4;break}break;case 109:switch(t.length){case 1:case 2:h=r.m,d=t.length;break;case 3:return od[r.m-1][1];case 5:return od[r.m-1][0];default:return od[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:h=r.d,d=t.length;break;case 3:return wv[r.q][0];default:return wv[r.q][1]}break;case 104:switch(t.length){case 1:case 2:h=1+(r.H+11)%12,d=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:h=r.H,d=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:h=r.M,d=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?on(r.S,t.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,l=Math.round(o*(r.S+r.u)),l>=60*o&&(l=0),t==="s"?l===0?"0":""+l/o:(i=on(l,2+n),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":h=r.D*24+r.H;break;case"[m]":case"[mm]":h=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":h=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}d=t.length===3?1:2;break;case 101:h=u,d=1;break}var x=d>0?on(h,d):"";return x}function Ii(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var a_=/%/g;function Ck(e,t,r){var n=t.replace(a_,""),i=t.length-n.length;return Kn(e,n,r*Math.pow(10,2*i))+ar("%",i)}function Nk(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Kn(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function n_(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+n_(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var l=Math.floor(Math.log(t)*Math.LOG10E)%i;if(l<0&&(l+=i),r=(t/Math.pow(10,l)).toPrecision(n+1+(i+l)%i),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+l):r+="E+"+(o-l);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,h,d,x){return h+d+x.substr(0,(i+l)%i)+"."+x.substr(l)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var i_=/# (\?+)( ?)\/( ?)(\d+)/;function Ok(e,t,r){var n=parseInt(e[4],10),i=Math.round(t*n),l=Math.floor(i/n),o=i-l*n,u=n;return r+(l===0?"":""+l)+" "+(o===0?ar(" ",e[1].length+1+e[4].length):s1(o,e[1].length)+e[2]+"/"+e[3]+on(u,e[4].length))}function Rk(e,t,r){return r+(t===0?"":""+t)+ar(" ",e[1].length+2+e[4].length)}var s_=/^#*0*\.([0#]+)/,l_=/\).*[0#]/,c_=/\(###\) ###\\?-####/;function Zr(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function bv(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Ev(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function Dk(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function Fk(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function $a(e,t,r){if(e.charCodeAt(0)===40&&!t.match(l_)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?$a("n",n,r):"("+$a("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Nk(e,t,r);if(t.indexOf("%")!==-1)return Ck(e,t,r);if(t.indexOf("E")!==-1)return n_(t,r);if(t.charCodeAt(0)===36)return"$"+$a(e,t.substr(t.charAt(1)==" "?2:1),r);var i,l,o,u,h=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+bl(h,t.length);if(t.match(/^[#?]+$/))return i=bl(r,0),i==="0"&&(i=""),i.length>t.length?i:Zr(t.substr(0,t.length-i.length))+i;if(l=t.match(i_))return Ok(l,h,d);if(t.match(/^#+0+$/))return d+bl(h,t.length-t.indexOf("0"));if(l=t.match(s_))return i=bv(r,l[1].length).replace(/^([^\.]+)$/,"$1."+Zr(l[1])).replace(/\.$/,"."+Zr(l[1])).replace(/\.(\d*)$/,function(w,y){return"."+y+ar("0",Zr(l[1]).length-y.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),l=t.match(/^(0*)\.(#*)$/))return d+bv(h,l[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=t.match(/^#{1,3},##0(\.?)$/))return d+Ii(bl(h,0));if(l=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+$a(e,t,-r):Ii(""+(Math.floor(r)+Dk(r,l[1].length)))+"."+on(Ev(r,l[1].length),l[1].length);if(l=t.match(/^#,#*,#0/))return $a(e,t.replace(/^#,#*,/,""),r);if(l=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Fl($a(e,t.replace(/[\\-]/g,""),r)),o=0,Fl(Fl(t.replace(/\\/g,"")).replace(/[0#]/g,function(w){return o<i.length?i.charAt(o++):w==="0"?"0":""}));if(t.match(c_))return i=$a(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var x="";if(l=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(l[4].length,7),u=pu(h,Math.pow(10,o)-1,!1),i=""+d,x=Kn("n",l[1],u[1]),x.charAt(x.length-1)==" "&&(x=x.substr(0,x.length-1)+"0"),i+=x+l[2]+"/"+l[3],x=mu(u[2],o),x.length<l[4].length&&(x=Zr(l[4].substr(l[4].length-x.length))+x),i+=x,i;if(l=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(l[1].length,l[4].length),7),u=pu(h,Math.pow(10,o)-1,!0),d+(u[0]||(u[1]?"":"0"))+" "+(u[1]?s1(u[1],o)+l[2]+"/"+l[3]+mu(u[2],o):ar(" ",2*o+1+l[2].length+l[3].length));if(l=t.match(/^[#0?]+$/))return i=bl(r,0),t.length<=i.length?i:Zr(t.substr(0,t.length-i.length))+i;if(l=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var g=t.indexOf(".")-o,v=t.length-i.length-g;return Zr(t.substr(0,g)+i+t.substr(t.length-v))}if(l=t.match(/^00,000\.([#0]*0)$/))return o=Ev(r,l[1].length),r<0?"-"+$a(e,t,-r):Ii(Fk(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?on(0,3-w.length):"")+w})+"."+on(o,l[1].length);switch(t){case"###,##0.00":return $a(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var _=Ii(bl(h,0));return _!=="0"?d+_:"";case"###,###.00":return $a(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return $a(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function Mk(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Kn(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function Bk(e,t,r){var n=t.replace(a_,""),i=t.length-n.length;return Kn(e,n,r*Math.pow(10,2*i))+ar("%",i)}function o_(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+o_(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var l=Math.floor(Math.log(t)*Math.LOG10E)%i;if(l<0&&(l+=i),r=(t/Math.pow(10,l)).toPrecision(n+1+(i+l)%i),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+l):r+="E+"+(o-l),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,h,d,x){return h+d+x.substr(0,(i+l)%i)+"."+x.substr(l)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function _n(e,t,r){if(e.charCodeAt(0)===40&&!t.match(l_)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?_n("n",n,r):"("+_n("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Mk(e,t,r);if(t.indexOf("%")!==-1)return Bk(e,t,r);if(t.indexOf("E")!==-1)return o_(t,r);if(t.charCodeAt(0)===36)return"$"+_n(e,t.substr(t.charAt(1)==" "?2:1),r);var i,l,o,u,h=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+on(h,t.length);if(t.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>t.length?i:Zr(t.substr(0,t.length-i.length))+i;if(l=t.match(i_))return Rk(l,h,d);if(t.match(/^#+0+$/))return d+on(h,t.length-t.indexOf("0"));if(l=t.match(s_))return i=(""+r).replace(/^([^\.]+)$/,"$1."+Zr(l[1])).replace(/\.$/,"."+Zr(l[1])),i=i.replace(/\.(\d*)$/,function(w,y){return"."+y+ar("0",Zr(l[1]).length-y.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),l=t.match(/^(0*)\.(#*)$/))return d+(""+h).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=t.match(/^#{1,3},##0(\.?)$/))return d+Ii(""+h);if(l=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+_n(e,t,-r):Ii(""+r)+"."+ar("0",l[1].length);if(l=t.match(/^#,#*,#0/))return _n(e,t.replace(/^#,#*,/,""),r);if(l=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Fl(_n(e,t.replace(/[\\-]/g,""),r)),o=0,Fl(Fl(t.replace(/\\/g,"")).replace(/[0#]/g,function(w){return o<i.length?i.charAt(o++):w==="0"?"0":""}));if(t.match(c_))return i=_n(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var x="";if(l=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(l[4].length,7),u=pu(h,Math.pow(10,o)-1,!1),i=""+d,x=Kn("n",l[1],u[1]),x.charAt(x.length-1)==" "&&(x=x.substr(0,x.length-1)+"0"),i+=x+l[2]+"/"+l[3],x=mu(u[2],o),x.length<l[4].length&&(x=Zr(l[4].substr(l[4].length-x.length))+x),i+=x,i;if(l=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(l[1].length,l[4].length),7),u=pu(h,Math.pow(10,o)-1,!0),d+(u[0]||(u[1]?"":"0"))+" "+(u[1]?s1(u[1],o)+l[2]+"/"+l[3]+mu(u[2],o):ar(" ",2*o+1+l[2].length+l[3].length));if(l=t.match(/^[#0?]+$/))return i=""+r,t.length<=i.length?i:Zr(t.substr(0,t.length-i.length))+i;if(l=t.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var g=t.indexOf(".")-o,v=t.length-i.length-g;return Zr(t.substr(0,g)+i+t.substr(t.length-v))}if(l=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+_n(e,t,-r):Ii(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?on(0,3-w.length):"")+w})+"."+on(0,l[1].length);switch(t){case"###,###":case"##,###":case"#,###":var _=Ii(""+h);return _!=="0"?d+_:"";default:if(t.match(/\.[0#?]*$/))return _n(e,t.slice(0,t.lastIndexOf(".")),r)+Zr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Kn(e,t,r){return(r|0)===r?_n(e,t,r):$a(e,t,r)}function Lk(e){for(var t=[],r=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(i,n-i),i=n+1}if(t[t.length]=e.substr(i),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var u_=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Hl(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":xu(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(u_))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function Ik(e,t,r,n){for(var i=[],l="",o=0,u="",h="t",d,x,g,v="H";o<e.length;)switch(u=e.charAt(o)){case"G":if(!xu(e,o))throw new Error("unrecognized character "+u+" in "+e);i[i.length]={t:"G",v:"General"},o+=7;break;case'"':for(l="";(g=e.charCodeAt(++o))!==34&&o<e.length;)l+=String.fromCharCode(g);i[i.length]={t:"t",v:l},++o;break;case"\\":var _=e.charAt(++o),w=_==="("||_===")"?_:"t";i[i.length]={t:w,v:_},++o;break;case"_":i[i.length]={t:"t",v:" "},o+=2;break;case"@":i[i.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(d==null&&(d=gs(t,r,e.charAt(o+1)==="2"),d==null))return"";i[i.length]={t:"X",v:e.substr(o,2)},h=u,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||d==null&&(d=gs(t,r),d==null))return"";for(l=u;++o<e.length&&e.charAt(o).toLowerCase()===u;)l+=u;u==="m"&&h.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=v),i[i.length]={t:u,v:l},h=u;break;case"A":case"a":case"":var y={t:u,v:u};if(d==null&&(d=gs(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(d!=null&&(y.v=d.H>=12?"P":"A"),y.t="T",v="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(d!=null&&(y.v=d.H>=12?"PM":"AM"),y.t="T",o+=5,v="h"):e.substr(o,5).toUpperCase()==="/"?(d!=null&&(y.v=d.H>=12?"":""),y.t="T",o+=5,v="h"):(y.t="t",++o),d==null&&y.t==="T")return"";i[i.length]=y,h=u;break;case"[":for(l=u;e.charAt(o++)!=="]"&&o<e.length;)l+=e.charAt(o);if(l.slice(-1)!=="]")throw'unterminated "[" block: |'+l+"|";if(l.match(u_)){if(d==null&&(d=gs(t,r),d==null))return"";i[i.length]={t:"Z",v:l.toLowerCase()},h=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",Hl(e)||(i[i.length]={t:"t",v:l}));break;case".":if(d!=null){for(l=u;++o<e.length&&(u=e.charAt(o))==="0";)l+=u;i[i.length]={t:"s",v:l};break}case"0":case"#":for(l=u;++o<e.length&&"0#?.,E+-%".indexOf(u=e.charAt(o))>-1;)l+=u;i[i.length]={t:"n",v:l};break;case"?":for(l=u;e.charAt(++o)===u;)l+=u;i[i.length]={t:u,v:l},h=u;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":i[i.length]={t:n===1?"t":u,v:u},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=u;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)l+=e.charAt(o);i[i.length]={t:"D",v:l};break;case" ":i[i.length]={t:u,v:u},++o;break;case"$":i[i.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+e);i[i.length]={t:"t",v:u},++o;break}var b=0,A=0,M;for(o=i.length-1,h="t";o>=0;--o)switch(i[o].t){case"h":case"H":i[o].t=v,h="h",b<1&&(b=1);break;case"s":(M=i[o].v.match(/\.0+$/))&&(A=Math.max(A,M[0].length-1)),b<3&&(b=3);case"d":case"y":case"M":case"e":h=i[o].t;break;case"m":h==="s"&&(i[o].t="M",b<2&&(b=2));break;case"X":break;case"Z":b<1&&i[o].v.match(/[Hh]/)&&(b=1),b<2&&i[o].v.match(/[Mm]/)&&(b=2),b<3&&i[o].v.match(/[Ss]/)&&(b=3)}switch(b){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var T="",U;for(o=0;o<i.length;++o)switch(i[o].t){case"t":case"T":case" ":case"D":break;case"X":i[o].v="",i[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[o].v=Ak(i[o].t.charCodeAt(0),i[o].v,d,A),i[o].t="t";break;case"n":case"?":for(U=o+1;i[U]!=null&&((u=i[U].t)==="?"||u==="D"||(u===" "||u==="t")&&i[U+1]!=null&&(i[U+1].t==="?"||i[U+1].t==="t"&&i[U+1].v==="/")||i[o].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(i[U].v==="/"||i[U].v===" "&&i[U+1]!=null&&i[U+1].t=="?"));)i[o].v+=i[U].v,i[U]={v:"",t:";"},++U;T+=i[o].v,o=U-1;break;case"G":i[o].t="t",i[o].v=Ss(t,r);break}var q="",I,R;if(T.length>0){T.charCodeAt(0)==40?(I=t<0&&T.charCodeAt(0)===45?-t:t,R=Kn("n",T,I)):(I=t<0&&n>1?-t:t,R=Kn("n",T,I),I<0&&i[0]&&i[0].t=="t"&&(R=R.substr(1),i[0].v="-"+i[0].v)),U=R.length-1;var Q=i.length;for(o=0;o<i.length;++o)if(i[o]!=null&&i[o].t!="t"&&i[o].v.indexOf(".")>-1){Q=o;break}var G=i.length;if(Q===i.length&&R.indexOf("E")===-1){for(o=i.length-1;o>=0;--o)i[o]==null||"n?".indexOf(i[o].t)===-1||(U>=i[o].v.length-1?(U-=i[o].v.length,i[o].v=R.substr(U+1,i[o].v.length)):U<0?i[o].v="":(i[o].v=R.substr(0,U+1),U=-1),i[o].t="t",G=o);U>=0&&G<i.length&&(i[G].v=R.substr(0,U+1)+i[G].v)}else if(Q!==i.length&&R.indexOf("E")===-1){for(U=R.indexOf(".")-1,o=Q;o>=0;--o)if(!(i[o]==null||"n?".indexOf(i[o].t)===-1)){for(x=i[o].v.indexOf(".")>-1&&o===Q?i[o].v.indexOf(".")-1:i[o].v.length-1,q=i[o].v.substr(x+1);x>=0;--x)U>=0&&(i[o].v.charAt(x)==="0"||i[o].v.charAt(x)==="#")&&(q=R.charAt(U--)+q);i[o].v=q,i[o].t="t",G=o}for(U>=0&&G<i.length&&(i[G].v=R.substr(0,U+1)+i[G].v),U=R.indexOf(".")+1,o=Q;o<i.length;++o)if(!(i[o]==null||"n?(".indexOf(i[o].t)===-1&&o!==Q)){for(x=i[o].v.indexOf(".")>-1&&o===Q?i[o].v.indexOf(".")+1:0,q=i[o].v.substr(0,x);x<i[o].v.length;++x)U<R.length&&(q+=R.charAt(U++));i[o].v=q,i[o].t="t",G=o}}}for(o=0;o<i.length;++o)i[o]!=null&&"n?".indexOf(i[o].t)>-1&&(I=n>1&&t<0&&o>0&&i[o-1].v==="-"?-t:t,i[o].v=Kn(i[o].t,i[o].v,I),i[o].t="t");var ae="";for(o=0;o!==i.length;++o)i[o]!=null&&(ae+=i[o].v);return ae}var Tv=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function kv(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function Uk(e,t){var r=Lk(e),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var l=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,l];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(Tv),u=r[1].match(Tv);return kv(t,o)?[n,r[0]]:kv(t,u)?[n,r[1]]:[n,r[o!=null&&u!=null?2:1]]}return[n,l]}function Ya(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Je)[e],n==null&&(n=r.table&&r.table[Sv[e]]||Je[Sv[e]]),n==null&&(n=_k[e]||"General");break}if(xu(n,0))return Ss(t,r);t instanceof Date&&(t=r_(t,r.date1904));var i=Uk(n,t);if(xu(i[1]))return Ss(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return Ik(i[1],t,r,i[0])}function Yn(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Je[r]==null){t<0&&(t=r);continue}if(Je[r]==e){t=r;break}}t<0&&(t=391)}return Je[t]=e,t}function Ou(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Yn(e[t],t)}function Vl(){Je=yk()}var jk={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},f_=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Pk(e){var t=typeof e=="number"?Je[e]:e;return t=t.replace(f_,"(\\d+)"),new RegExp("^"+t+"$")}function zk(e,t,r){var n=-1,i=-1,l=-1,o=-1,u=-1,h=-1;(t.match(f_)||[]).forEach(function(g,v){var _=parseInt(r[v+1],10);switch(g.toLowerCase().charAt(0)){case"y":n=_;break;case"d":l=_;break;case"h":o=_;break;case"s":h=_;break;case"m":o>=0?u=_:i=_;break}}),h>=0&&u==-1&&i>=0&&(u=i,i=-1);var d=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(l>=1?l:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var x=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(h>=0?h:0)).slice(-2);return o==-1&&u==-1&&h==-1?d:n==-1&&i==-1&&l==-1?x:d+"T"+x}var Hk=(function(){var e={};e.version="1.2.0";function t(){for(var R=0,Q=new Array(256),G=0;G!=256;++G)R=G,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,Q[G]=R;return typeof Int32Array<"u"?new Int32Array(Q):Q}var r=t();function n(R){var Q=0,G=0,ae=0,ne=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(ae=0;ae!=256;++ae)ne[ae]=R[ae];for(ae=0;ae!=256;++ae)for(G=R[ae],Q=256+ae;Q<4096;Q+=256)G=ne[Q]=G>>>8^R[G&255];var J=[];for(ae=1;ae!=16;++ae)J[ae-1]=typeof Int32Array<"u"?ne.subarray(ae*256,ae*256+256):ne.slice(ae*256,ae*256+256);return J}var i=n(r),l=i[0],o=i[1],u=i[2],h=i[3],d=i[4],x=i[5],g=i[6],v=i[7],_=i[8],w=i[9],y=i[10],b=i[11],A=i[12],M=i[13],T=i[14];function U(R,Q){for(var G=Q^-1,ae=0,ne=R.length;ae<ne;)G=G>>>8^r[(G^R.charCodeAt(ae++))&255];return~G}function q(R,Q){for(var G=Q^-1,ae=R.length-15,ne=0;ne<ae;)G=T[R[ne++]^G&255]^M[R[ne++]^G>>8&255]^A[R[ne++]^G>>16&255]^b[R[ne++]^G>>>24]^y[R[ne++]]^w[R[ne++]]^_[R[ne++]]^v[R[ne++]]^g[R[ne++]]^x[R[ne++]]^d[R[ne++]]^h[R[ne++]]^u[R[ne++]]^o[R[ne++]]^l[R[ne++]]^r[R[ne++]];for(ae+=15;ne<ae;)G=G>>>8^r[(G^R[ne++])&255];return~G}function I(R,Q){for(var G=Q^-1,ae=0,ne=R.length,J=0,ge=0;ae<ne;)J=R.charCodeAt(ae++),J<128?G=G>>>8^r[(G^J)&255]:J<2048?(G=G>>>8^r[(G^(192|J>>6&31))&255],G=G>>>8^r[(G^(128|J&63))&255]):J>=55296&&J<57344?(J=(J&1023)+64,ge=R.charCodeAt(ae++)&1023,G=G>>>8^r[(G^(240|J>>8&7))&255],G=G>>>8^r[(G^(128|J>>2&63))&255],G=G>>>8^r[(G^(128|ge>>6&15|(J&3)<<4))&255],G=G>>>8^r[(G^(128|ge&63))&255]):(G=G>>>8^r[(G^(224|J>>12&15))&255],G=G>>>8^r[(G^(128|J>>6&63))&255],G=G>>>8^r[(G^(128|J&63))&255]);return~G}return e.table=r,e.bstr=U,e.buf=q,e.str=I,e})(),qe=(function(){var t={};t.version="1.2.1";function r(k,F){for(var C=k.split("/"),O=F.split("/"),B=0,L=0,re=Math.min(C.length,O.length);B<re;++B){if(L=C[B].length-O[B].length)return L;if(C[B]!=O[B])return C[B]<O[B]?-1:1}return C.length-O.length}function n(k){if(k.charAt(k.length-1)=="/")return k.slice(0,-1).indexOf("/")===-1?k:n(k.slice(0,-1));var F=k.lastIndexOf("/");return F===-1?k:k.slice(0,F+1)}function i(k){if(k.charAt(k.length-1)=="/")return i(k.slice(0,-1));var F=k.lastIndexOf("/");return F===-1?k:k.slice(F+1)}function l(k,F){typeof F=="string"&&(F=new Date(F));var C=F.getHours();C=C<<6|F.getMinutes(),C=C<<5|F.getSeconds()>>>1,k.write_shift(2,C);var O=F.getFullYear()-1980;O=O<<4|F.getMonth()+1,O=O<<5|F.getDate(),k.write_shift(2,O)}function o(k){var F=k.read_shift(2)&65535,C=k.read_shift(2)&65535,O=new Date,B=C&31;C>>>=5;var L=C&15;C>>>=4,O.setMilliseconds(0),O.setFullYear(C+1980),O.setMonth(L-1),O.setDate(B);var re=F&31;F>>>=5;var ie=F&63;return F>>>=6,O.setHours(F),O.setMinutes(ie),O.setSeconds(re<<1),O}function u(k){Ur(k,0);for(var F={},C=0;k.l<=k.length-4;){var O=k.read_shift(2),B=k.read_shift(2),L=k.l+B,re={};O===21589&&(C=k.read_shift(1),C&1&&(re.mtime=k.read_shift(4)),B>5&&(C&2&&(re.atime=k.read_shift(4)),C&4&&(re.ctime=k.read_shift(4))),re.mtime&&(re.mt=new Date(re.mtime*1e3))),k.l=L,F[O]=re}return F}var h;function d(){return h||(h={})}function x(k,F){if(k[0]==80&&k[1]==75)return kn(k,F);if((k[0]|32)==109&&(k[1]|32)==105)return Qa(k,F);if(k.length<512)throw new Error("CFB file size "+k.length+" < 512");var C=3,O=512,B=0,L=0,re=0,ie=0,W=0,K=[],te=k.slice(0,512);Ur(te,0);var ve=g(te);switch(C=ve[0],C){case 3:O=512;break;case 4:O=4096;break;case 0:if(ve[1]==0)return kn(k,F);default:throw new Error("Major Version: Expected 3 or 4 saw "+C)}O!==512&&(te=k.slice(0,O),Ur(te,28));var me=k.slice(0,O);v(te,C);var Fe=te.read_shift(4,"i");if(C===3&&Fe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Fe);te.l+=4,re=te.read_shift(4,"i"),te.l+=4,te.chk("00100000","Mini Stream Cutoff Size: "),ie=te.read_shift(4,"i"),B=te.read_shift(4,"i"),W=te.read_shift(4,"i"),L=te.read_shift(4,"i");for(var Ae=-1,Me=0;Me<109&&(Ae=te.read_shift(4,"i"),!(Ae<0));++Me)K[Me]=Ae;var Pe=_(k,O);b(W,L,Pe,O,K);var Rt=M(Pe,re,K,O);Rt[re].name="!Directory",B>0&&ie!==ge&&(Rt[ie].name="!MiniFAT"),Rt[K[0]].name="!FAT",Rt.fat_addrs=K,Rt.ssz=O;var Dt={},Kt=[],Da=[],qi=[];T(re,Rt,Pe,Kt,B,Dt,Da,ie),w(Da,qi,Kt),Kt.shift();var li={FileIndex:Da,FullPaths:qi};return F&&F.raw&&(li.raw={header:me,sectors:Pe}),li}function g(k){if(k[k.l]==80&&k[k.l+1]==75)return[0,0];k.chk(ke,"Header Signature: "),k.l+=16;var F=k.read_shift(2,"u");return[k.read_shift(2,"u"),F]}function v(k,F){var C=9;switch(k.l+=2,C=k.read_shift(2)){case 9:if(F!=3)throw new Error("Sector Shift: Expected 9 saw "+C);break;case 12:if(F!=4)throw new Error("Sector Shift: Expected 12 saw "+C);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+C)}k.chk("0600","Mini Sector Shift: "),k.chk("000000000000","Reserved: ")}function _(k,F){for(var C=Math.ceil(k.length/F)-1,O=[],B=1;B<C;++B)O[B-1]=k.slice(B*F,(B+1)*F);return O[C-1]=k.slice(C*F),O}function w(k,F,C){for(var O=0,B=0,L=0,re=0,ie=0,W=C.length,K=[],te=[];O<W;++O)K[O]=te[O]=O,F[O]=C[O];for(;ie<te.length;++ie)O=te[ie],B=k[O].L,L=k[O].R,re=k[O].C,K[O]===O&&(B!==-1&&K[B]!==B&&(K[O]=K[B]),L!==-1&&K[L]!==L&&(K[O]=K[L])),re!==-1&&(K[re]=O),B!==-1&&O!=K[O]&&(K[B]=K[O],te.lastIndexOf(B)<ie&&te.push(B)),L!==-1&&O!=K[O]&&(K[L]=K[O],te.lastIndexOf(L)<ie&&te.push(L));for(O=1;O<W;++O)K[O]===O&&(L!==-1&&K[L]!==L?K[O]=K[L]:B!==-1&&K[B]!==B&&(K[O]=K[B]));for(O=1;O<W;++O)if(k[O].type!==0){if(ie=O,ie!=K[ie])do ie=K[ie],F[O]=F[ie]+"/"+F[O];while(ie!==0&&K[ie]!==-1&&ie!=K[ie]);K[O]=-1}for(F[0]+="/",O=1;O<W;++O)k[O].type!==2&&(F[O]+="/")}function y(k,F,C){for(var O=k.start,B=k.size,L=[],re=O;C&&B>0&&re>=0;)L.push(F.slice(re*J,re*J+J)),B-=J,re=xs(C,re*4);return L.length===0?pe(0):Cr(L).slice(0,k.size)}function b(k,F,C,O,B){var L=ge;if(k===ge){if(F!==0)throw new Error("DIFAT chain shorter than expected")}else if(k!==-1){var re=C[k],ie=(O>>>2)-1;if(!re)return;for(var W=0;W<ie&&(L=xs(re,W*4))!==ge;++W)B.push(L);b(xs(re,O-4),F-1,C,O,B)}}function A(k,F,C,O,B){var L=[],re=[];B||(B=[]);var ie=O-1,W=0,K=0;for(W=F;W>=0;){B[W]=!0,L[L.length]=W,re.push(k[W]);var te=C[Math.floor(W*4/O)];if(K=W*4&ie,O<4+K)throw new Error("FAT boundary crossed: "+W+" 4 "+O);if(!k[te])break;W=xs(k[te],K)}return{nodes:L,data:Uv([re])}}function M(k,F,C,O){var B=k.length,L=[],re=[],ie=[],W=[],K=O-1,te=0,ve=0,me=0,Fe=0;for(te=0;te<B;++te)if(ie=[],me=te+F,me>=B&&(me-=B),!re[me]){W=[];var Ae=[];for(ve=me;ve>=0;){Ae[ve]=!0,re[ve]=!0,ie[ie.length]=ve,W.push(k[ve]);var Me=C[Math.floor(ve*4/O)];if(Fe=ve*4&K,O<4+Fe)throw new Error("FAT boundary crossed: "+ve+" 4 "+O);if(!k[Me]||(ve=xs(k[Me],Fe),Ae[ve]))break}L[me]={nodes:ie,data:Uv([W])}}return L}function T(k,F,C,O,B,L,re,ie){for(var W=0,K=O.length?2:0,te=F[k].data,ve=0,me=0,Fe;ve<te.length;ve+=128){var Ae=te.slice(ve,ve+128);Ur(Ae,64),me=Ae.read_shift(2),Fe=m1(Ae,0,me-K),O.push(Fe);var Me={name:Fe,type:Ae.read_shift(1),color:Ae.read_shift(1),L:Ae.read_shift(4,"i"),R:Ae.read_shift(4,"i"),C:Ae.read_shift(4,"i"),clsid:Ae.read_shift(16),state:Ae.read_shift(4,"i"),start:0,size:0},Pe=Ae.read_shift(2)+Ae.read_shift(2)+Ae.read_shift(2)+Ae.read_shift(2);Pe!==0&&(Me.ct=U(Ae,Ae.l-8));var Rt=Ae.read_shift(2)+Ae.read_shift(2)+Ae.read_shift(2)+Ae.read_shift(2);Rt!==0&&(Me.mt=U(Ae,Ae.l-8)),Me.start=Ae.read_shift(4,"i"),Me.size=Ae.read_shift(4,"i"),Me.size<0&&Me.start<0&&(Me.size=Me.type=0,Me.start=ge,Me.name=""),Me.type===5?(W=Me.start,B>0&&W!==ge&&(F[W].name="!StreamData")):Me.size>=4096?(Me.storage="fat",F[Me.start]===void 0&&(F[Me.start]=A(C,Me.start,F.fat_addrs,F.ssz)),F[Me.start].name=Me.name,Me.content=F[Me.start].data.slice(0,Me.size)):(Me.storage="minifat",Me.size<0?Me.size=0:W!==ge&&Me.start!==ge&&F[W]&&(Me.content=y(Me,F[W].data,(F[ie]||{}).data))),Me.content&&Ur(Me.content,0),L[Fe]=Me,re.push(Me)}}function U(k,F){return new Date((Ta(k,F+4)/1e7*Math.pow(2,32)+Ta(k,F)/1e7-11644473600)*1e3)}function q(k,F){return d(),x(h.readFileSync(k),F)}function I(k,F){var C=F&&F.type;switch(C||ct&&Buffer.isBuffer(k)&&(C="buffer"),C||"base64"){case"file":return q(k,F);case"base64":return x(Ca(Oa(k)),F);case"binary":return x(Ca(k),F)}return x(k,F)}function R(k,F){var C=F||{},O=C.root||"Root Entry";if(k.FullPaths||(k.FullPaths=[]),k.FileIndex||(k.FileIndex=[]),k.FullPaths.length!==k.FileIndex.length)throw new Error("inconsistent CFB structure");k.FullPaths.length===0&&(k.FullPaths[0]=O+"/",k.FileIndex[0]={name:O,type:5}),C.CLSID&&(k.FileIndex[0].clsid=C.CLSID),Q(k)}function Q(k){var F="Sh33tJ5";if(!qe.find(k,"/"+F)){var C=pe(4);C[0]=55,C[1]=C[3]=50,C[2]=54,k.FileIndex.push({name:F,type:2,content:C,size:4,L:69,R:69,C:69}),k.FullPaths.push(k.FullPaths[0]+F),G(k)}}function G(k,F){R(k);for(var C=!1,O=!1,B=k.FullPaths.length-1;B>=0;--B){var L=k.FileIndex[B];switch(L.type){case 0:O?C=!0:(k.FileIndex.pop(),k.FullPaths.pop());break;case 1:case 2:case 5:O=!0,isNaN(L.R*L.L*L.C)&&(C=!0),L.R>-1&&L.L>-1&&L.R==L.L&&(C=!0);break;default:C=!0;break}}if(!(!C&&!F)){var re=new Date(1987,1,19),ie=0,W=Object.create?Object.create(null):{},K=[];for(B=0;B<k.FullPaths.length;++B)W[k.FullPaths[B]]=!0,k.FileIndex[B].type!==0&&K.push([k.FullPaths[B],k.FileIndex[B]]);for(B=0;B<K.length;++B){var te=n(K[B][0]);O=W[te],O||(K.push([te,{name:i(te).replace("/",""),type:1,clsid:Y,ct:re,mt:re,content:null}]),W[te]=!0)}for(K.sort(function(Fe,Ae){return r(Fe[0],Ae[0])}),k.FullPaths=[],k.FileIndex=[],B=0;B<K.length;++B)k.FullPaths[B]=K[B][0],k.FileIndex[B]=K[B][1];for(B=0;B<K.length;++B){var ve=k.FileIndex[B],me=k.FullPaths[B];if(ve.name=i(me).replace("/",""),ve.L=ve.R=ve.C=-(ve.color=1),ve.size=ve.content?ve.content.length:0,ve.start=0,ve.clsid=ve.clsid||Y,B===0)ve.C=K.length>1?1:-1,ve.size=0,ve.type=5;else if(me.slice(-1)=="/"){for(ie=B+1;ie<K.length&&n(k.FullPaths[ie])!=me;++ie);for(ve.C=ie>=K.length?-1:ie,ie=B+1;ie<K.length&&n(k.FullPaths[ie])!=n(me);++ie);ve.R=ie>=K.length?-1:ie,ve.type=1}else n(k.FullPaths[B+1]||"")==n(me)&&(ve.R=B+1),ve.type=2}}}function ae(k,F){var C=F||{};if(C.fileType=="mad")return Ls(k,C);if(G(k),C.fileType==="zip")return ii(k,C);var O=(function(Fe){for(var Ae=0,Me=0,Pe=0;Pe<Fe.FileIndex.length;++Pe){var Rt=Fe.FileIndex[Pe];if(Rt.content){var Dt=Rt.content.length;Dt>0&&(Dt<4096?Ae+=Dt+63>>6:Me+=Dt+511>>9)}}for(var Kt=Fe.FullPaths.length+3>>2,Da=Ae+7>>3,qi=Ae+127>>7,li=Da+Me+Kt+qi,dn=li+127>>7,Wl=dn<=109?0:Math.ceil((dn-109)/127);li+dn+Wl+127>>7>dn;)Wl=++dn<=109?0:Math.ceil((dn-109)/127);var na=[1,Wl,dn,qi,Kt,Me,Ae,0];return Fe.FileIndex[0].size=Ae<<6,na[7]=(Fe.FileIndex[0].start=na[0]+na[1]+na[2]+na[3]+na[4]+na[5])+(na[6]+7>>3),na})(k),B=pe(O[7]<<9),L=0,re=0;{for(L=0;L<8;++L)B.write_shift(1,be[L]);for(L=0;L<8;++L)B.write_shift(2,0);for(B.write_shift(2,62),B.write_shift(2,3),B.write_shift(2,65534),B.write_shift(2,9),B.write_shift(2,6),L=0;L<3;++L)B.write_shift(2,0);for(B.write_shift(4,0),B.write_shift(4,O[2]),B.write_shift(4,O[0]+O[1]+O[2]+O[3]-1),B.write_shift(4,0),B.write_shift(4,4096),B.write_shift(4,O[3]?O[0]+O[1]+O[2]-1:ge),B.write_shift(4,O[3]),B.write_shift(-4,O[1]?O[0]-1:ge),B.write_shift(4,O[1]),L=0;L<109;++L)B.write_shift(-4,L<O[2]?O[1]+L:-1)}if(O[1])for(re=0;re<O[1];++re){for(;L<236+re*127;++L)B.write_shift(-4,L<O[2]?O[1]+L:-1);B.write_shift(-4,re===O[1]-1?ge:re+1)}var ie=function(Fe){for(re+=Fe;L<re-1;++L)B.write_shift(-4,L+1);Fe&&(++L,B.write_shift(-4,ge))};for(re=L=0,re+=O[1];L<re;++L)B.write_shift(-4,le.DIFSECT);for(re+=O[2];L<re;++L)B.write_shift(-4,le.FATSECT);ie(O[3]),ie(O[4]);for(var W=0,K=0,te=k.FileIndex[0];W<k.FileIndex.length;++W)te=k.FileIndex[W],te.content&&(K=te.content.length,!(K<4096)&&(te.start=re,ie(K+511>>9)));for(ie(O[6]+7>>3);B.l&511;)B.write_shift(-4,le.ENDOFCHAIN);for(re=L=0,W=0;W<k.FileIndex.length;++W)te=k.FileIndex[W],te.content&&(K=te.content.length,!(!K||K>=4096)&&(te.start=re,ie(K+63>>6)));for(;B.l&511;)B.write_shift(-4,le.ENDOFCHAIN);for(L=0;L<O[4]<<2;++L){var ve=k.FullPaths[L];if(!ve||ve.length===0){for(W=0;W<17;++W)B.write_shift(4,0);for(W=0;W<3;++W)B.write_shift(4,-1);for(W=0;W<12;++W)B.write_shift(4,0);continue}te=k.FileIndex[L],L===0&&(te.start=te.size?te.start-1:ge);var me=L===0&&C.root||te.name;if(K=2*(me.length+1),B.write_shift(64,me,"utf16le"),B.write_shift(2,K),B.write_shift(1,te.type),B.write_shift(1,te.color),B.write_shift(-4,te.L),B.write_shift(-4,te.R),B.write_shift(-4,te.C),te.clsid)B.write_shift(16,te.clsid,"hex");else for(W=0;W<4;++W)B.write_shift(4,0);B.write_shift(4,te.state||0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,te.start),B.write_shift(4,te.size),B.write_shift(4,0)}for(L=1;L<k.FileIndex.length;++L)if(te=k.FileIndex[L],te.size>=4096)if(B.l=te.start+1<<9,ct&&Buffer.isBuffer(te.content))te.content.copy(B,B.l,0,te.size),B.l+=te.size+511&-512;else{for(W=0;W<te.size;++W)B.write_shift(1,te.content[W]);for(;W&511;++W)B.write_shift(1,0)}for(L=1;L<k.FileIndex.length;++L)if(te=k.FileIndex[L],te.size>0&&te.size<4096)if(ct&&Buffer.isBuffer(te.content))te.content.copy(B,B.l,0,te.size),B.l+=te.size+63&-64;else{for(W=0;W<te.size;++W)B.write_shift(1,te.content[W]);for(;W&63;++W)B.write_shift(1,0)}if(ct)B.l=B.length;else for(;B.l<B.length;)B.write_shift(1,0);return B}function ne(k,F){var C=k.FullPaths.map(function(W){return W.toUpperCase()}),O=C.map(function(W){var K=W.split("/");return K[K.length-(W.slice(-1)=="/"?2:1)]}),B=!1;F.charCodeAt(0)===47?(B=!0,F=C[0].slice(0,-1)+F):B=F.indexOf("/")!==-1;var L=F.toUpperCase(),re=B===!0?C.indexOf(L):O.indexOf(L);if(re!==-1)return k.FileIndex[re];var ie=!L.match(zc);for(L=L.replace(ta,""),ie&&(L=L.replace(zc,"!")),re=0;re<C.length;++re)if((ie?C[re].replace(zc,"!"):C[re]).replace(ta,"")==L||(ie?O[re].replace(zc,"!"):O[re]).replace(ta,"")==L)return k.FileIndex[re];return null}var J=64,ge=-2,ke="d0cf11e0a1b11ae1",be=[208,207,17,224,161,177,26,225],Y="00000000000000000000000000000000",le={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ge,FREESECT:-1,HEADER_SIGNATURE:ke,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Y,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function _e(k,F,C){d();var O=ae(k,C);h.writeFileSync(F,O)}function Z(k){for(var F=new Array(k.length),C=0;C<k.length;++C)F[C]=String.fromCharCode(k[C]);return F.join("")}function De(k,F){var C=ae(k,F);switch(F&&F.type||"buffer"){case"file":return d(),h.writeFileSync(F.filename,C),C;case"binary":return typeof C=="string"?C:Z(C);case"base64":return so(typeof C=="string"?C:Z(C));case"buffer":if(ct)return Buffer.isBuffer(C)?C:ei(C);case"array":return typeof C=="string"?Ca(C):C}return C}var j;function N(k){try{var F=k.InflateRaw,C=new F;if(C._processChunk(new Uint8Array([3,0]),C._finishFlushFlag),C.bytesRead)j=k;else throw new Error("zlib does not expose bytesRead")}catch(O){console.error("cannot use native zlib: "+(O.message||O))}}function z(k,F){if(!j)return Ms(k,F);var C=j.InflateRaw,O=new C,B=O._processChunk(k.slice(k.l),O._finishFlushFlag);return k.l+=O.bytesRead,B}function P(k){return j?j.deflateRawSync(k):at(k)}var V=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ce=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],we=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ce(k){var F=(k<<1|k<<11)&139536|(k<<5|k<<15)&558144;return(F>>16|F>>8|F)&255}for(var Ee=typeof Uint8Array<"u",Oe=Ee?new Uint8Array(256):[],Qe=0;Qe<256;++Qe)Oe[Qe]=Ce(Qe);function H(k,F){var C=Oe[k&255];return F<=8?C>>>8-F:(C=C<<8|Oe[k>>8&255],F<=16?C>>>16-F:(C=C<<8|Oe[k>>16&255],C>>>24-F))}function St(k,F){var C=F&7,O=F>>>3;return(k[O]|(C<=6?0:k[O+1]<<8))>>>C&3}function tt(k,F){var C=F&7,O=F>>>3;return(k[O]|(C<=5?0:k[O+1]<<8))>>>C&7}function xt(k,F){var C=F&7,O=F>>>3;return(k[O]|(C<=4?0:k[O+1]<<8))>>>C&15}function We(k,F){var C=F&7,O=F>>>3;return(k[O]|(C<=3?0:k[O+1]<<8))>>>C&31}function Ue(k,F){var C=F&7,O=F>>>3;return(k[O]|(C<=1?0:k[O+1]<<8))>>>C&127}function Ut(k,F,C){var O=F&7,B=F>>>3,L=(1<<C)-1,re=k[B]>>>O;return C<8-O||(re|=k[B+1]<<8-O,C<16-O)||(re|=k[B+2]<<16-O,C<24-O)||(re|=k[B+3]<<24-O),re&L}function Tr(k,F,C){var O=F&7,B=F>>>3;return O<=5?k[B]|=(C&7)<<O:(k[B]|=C<<O&255,k[B+1]=(C&7)>>8-O),F+3}function Pr(k,F,C){var O=F&7,B=F>>>3;return C=(C&1)<<O,k[B]|=C,F+1}function Jr(k,F,C){var O=F&7,B=F>>>3;return C<<=O,k[B]|=C&255,C>>>=8,k[B+1]=C,F+8}function Tn(k,F,C){var O=F&7,B=F>>>3;return C<<=O,k[B]|=C&255,C>>>=8,k[B+1]=C&255,k[B+2]=C>>>8,F+16}function Ra(k,F){var C=k.length,O=2*C>F?2*C:F+5,B=0;if(C>=F)return k;if(ct){var L=yv(O);if(k.copy)k.copy(L);else for(;B<k.length;++B)L[B]=k[B];return L}else if(Ee){var re=new Uint8Array(O);if(re.set)re.set(k);else for(;B<C;++B)re[B]=k[B];return re}return k.length=O,k}function bt(k){for(var F=new Array(k),C=0;C<k;++C)F[C]=0;return F}function Or(k,F,C){var O=1,B=0,L=0,re=0,ie=0,W=k.length,K=Ee?new Uint16Array(32):bt(32);for(L=0;L<32;++L)K[L]=0;for(L=W;L<C;++L)k[L]=0;W=k.length;var te=Ee?new Uint16Array(W):bt(W);for(L=0;L<W;++L)K[B=k[L]]++,O<B&&(O=B),te[L]=0;for(K[0]=0,L=1;L<=O;++L)K[L+16]=ie=ie+K[L-1]<<1;for(L=0;L<W;++L)ie=k[L],ie!=0&&(te[L]=K[ie+16]++);var ve=0;for(L=0;L<W;++L)if(ve=k[L],ve!=0)for(ie=H(te[L],O)>>O-ve,re=(1<<O+4-ve)-1;re>=0;--re)F[ie|re<<ve]=ve&15|L<<4;return O}var ma=Ee?new Uint16Array(512):bt(512),hn=Ee?new Uint16Array(32):bt(32);if(!Ee){for(var Xt=0;Xt<512;++Xt)ma[Xt]=0;for(Xt=0;Xt<32;++Xt)hn[Xt]=0}(function(){for(var k=[],F=0;F<32;F++)k.push(5);Or(k,hn,32);var C=[];for(F=0;F<=143;F++)C.push(8);for(;F<=255;F++)C.push(9);for(;F<=279;F++)C.push(7);for(;F<=287;F++)C.push(8);Or(C,ma,288)})();var hr=(function(){for(var F=Ee?new Uint8Array(32768):[],C=0,O=0;C<we.length-1;++C)for(;O<we[C+1];++O)F[O]=C;for(;O<32768;++O)F[O]=29;var B=Ee?new Uint8Array(259):[];for(C=0,O=0;C<ce.length-1;++C)for(;O<ce[C+1];++O)B[O]=C;function L(ie,W){for(var K=0;K<ie.length;){var te=Math.min(65535,ie.length-K),ve=K+te==ie.length;for(W.write_shift(1,+ve),W.write_shift(2,te),W.write_shift(2,~te&65535);te-- >0;)W[W.l++]=ie[K++]}return W.l}function re(ie,W){for(var K=0,te=0,ve=Ee?new Uint16Array(32768):[];te<ie.length;){var me=Math.min(65535,ie.length-te);if(me<10){for(K=Tr(W,K,+(te+me==ie.length)),K&7&&(K+=8-(K&7)),W.l=K/8|0,W.write_shift(2,me),W.write_shift(2,~me&65535);me-- >0;)W[W.l++]=ie[te++];K=W.l*8;continue}K=Tr(W,K,+(te+me==ie.length)+2);for(var Fe=0;me-- >0;){var Ae=ie[te];Fe=(Fe<<5^Ae)&32767;var Me=-1,Pe=0;if((Me=ve[Fe])&&(Me|=te&-32768,Me>te&&(Me-=32768),Me<te))for(;ie[Me+Pe]==ie[te+Pe]&&Pe<250;)++Pe;if(Pe>2){Ae=B[Pe],Ae<=22?K=Jr(W,K,Oe[Ae+1]>>1)-1:(Jr(W,K,3),K+=5,Jr(W,K,Oe[Ae-23]>>5),K+=3);var Rt=Ae<8?0:Ae-4>>2;Rt>0&&(Tn(W,K,Pe-ce[Ae]),K+=Rt),Ae=F[te-Me],K=Jr(W,K,Oe[Ae]>>3),K-=3;var Dt=Ae<4?0:Ae-2>>1;Dt>0&&(Tn(W,K,te-Me-we[Ae]),K+=Dt);for(var Kt=0;Kt<Pe;++Kt)ve[Fe]=te&32767,Fe=(Fe<<5^ie[te])&32767,++te;me-=Pe-1}else Ae<=143?Ae=Ae+48:K=Pr(W,K,1),K=Jr(W,K,Oe[Ae]),ve[Fe]=te&32767,++te}K=Jr(W,K,0)-1}return W.l=(K+7)/8|0,W.l}return function(W,K){return W.length<8?L(W,K):re(W,K)}})();function at(k){var F=pe(50+Math.floor(k.length*1.1)),C=hr(k,F);return F.slice(0,C)}var Pt=Ee?new Uint16Array(32768):bt(32768),zr=Ee?new Uint16Array(32768):bt(32768),Et=Ee?new Uint16Array(128):bt(128),Tt=1,ra=1;function Wt(k,F){var C=We(k,F)+257;F+=5;var O=We(k,F)+1;F+=5;var B=xt(k,F)+4;F+=4;for(var L=0,re=Ee?new Uint8Array(19):bt(19),ie=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],W=1,K=Ee?new Uint8Array(8):bt(8),te=Ee?new Uint8Array(8):bt(8),ve=re.length,me=0;me<B;++me)re[V[me]]=L=tt(k,F),W<L&&(W=L),K[L]++,F+=3;var Fe=0;for(K[0]=0,me=1;me<=W;++me)te[me]=Fe=Fe+K[me-1]<<1;for(me=0;me<ve;++me)(Fe=re[me])!=0&&(ie[me]=te[Fe]++);var Ae=0;for(me=0;me<ve;++me)if(Ae=re[me],Ae!=0){Fe=Oe[ie[me]]>>8-Ae;for(var Me=(1<<7-Ae)-1;Me>=0;--Me)Et[Fe|Me<<Ae]=Ae&7|me<<3}var Pe=[];for(W=1;Pe.length<C+O;)switch(Fe=Et[Ue(k,F)],F+=Fe&7,Fe>>>=3){case 16:for(L=3+St(k,F),F+=2,Fe=Pe[Pe.length-1];L-- >0;)Pe.push(Fe);break;case 17:for(L=3+tt(k,F),F+=3;L-- >0;)Pe.push(0);break;case 18:for(L=11+Ue(k,F),F+=7;L-- >0;)Pe.push(0);break;default:Pe.push(Fe),W<Fe&&(W=Fe);break}var Rt=Pe.slice(0,C),Dt=Pe.slice(C);for(me=C;me<286;++me)Rt[me]=0;for(me=O;me<30;++me)Dt[me]=0;return Tt=Or(Rt,Pt,286),ra=Or(Dt,zr,30),F}function ql(k,F){if(k[0]==3&&!(k[1]&3))return[Ui(F),2];for(var C=0,O=0,B=yv(F||1<<18),L=0,re=B.length>>>0,ie=0,W=0;(O&1)==0;){if(O=tt(k,C),C+=3,O>>>1)O>>1==1?(ie=9,W=5):(C=Wt(k,C),ie=Tt,W=ra);else{C&7&&(C+=8-(C&7));var K=k[C>>>3]|k[(C>>>3)+1]<<8;if(C+=32,K>0)for(!F&&re<L+K&&(B=Ra(B,L+K),re=B.length);K-- >0;)B[L++]=k[C>>>3],C+=8;continue}for(;;){!F&&re<L+32767&&(B=Ra(B,L+32767),re=B.length);var te=Ut(k,C,ie),ve=O>>>1==1?ma[te]:Pt[te];if(C+=ve&15,ve>>>=4,(ve>>>8&255)===0)B[L++]=ve;else{if(ve==256)break;ve-=257;var me=ve<8?0:ve-4>>2;me>5&&(me=0);var Fe=L+ce[ve];me>0&&(Fe+=Ut(k,C,me),C+=me),te=Ut(k,C,W),ve=O>>>1==1?hn[te]:zr[te],C+=ve&15,ve>>>=4;var Ae=ve<4?0:ve-2>>1,Me=we[ve];for(Ae>0&&(Me+=Ut(k,C,Ae),C+=Ae),!F&&re<Fe&&(B=Ra(B,Fe+100),re=B.length);L<Fe;)B[L]=B[L-Me],++L}}}return F?[B,C+7>>>3]:[B.slice(0,L),C+7>>>3]}function Ms(k,F){var C=k.slice(k.l||0),O=ql(C,F);return k.l+=O[1],O[0]}function ai(k,F){if(k)typeof console<"u"&&console.error(F);else throw new Error(F)}function kn(k,F){var C=k;Ur(C,0);var O=[],B=[],L={FileIndex:O,FullPaths:B};R(L,{root:F.root});for(var re=C.length-4;(C[re]!=80||C[re+1]!=75||C[re+2]!=5||C[re+3]!=6)&&re>=0;)--re;C.l=re+4,C.l+=4;var ie=C.read_shift(2);C.l+=6;var W=C.read_shift(4);for(C.l=W,re=0;re<ie;++re){C.l+=20;var K=C.read_shift(4),te=C.read_shift(4),ve=C.read_shift(2),me=C.read_shift(2),Fe=C.read_shift(2);C.l+=8;var Ae=C.read_shift(4),Me=u(C.slice(C.l+ve,C.l+ve+me));C.l+=ve+me+Fe;var Pe=C.l;C.l=Ae+4,ni(C,K,te,L,Me),C.l=Pe}return L}function ni(k,F,C,O,B){k.l+=2;var L=k.read_shift(2),re=k.read_shift(2),ie=o(k);if(L&8257)throw new Error("Unsupported ZIP encryption");for(var W=k.read_shift(4),K=k.read_shift(4),te=k.read_shift(4),ve=k.read_shift(2),me=k.read_shift(2),Fe="",Ae=0;Ae<ve;++Ae)Fe+=String.fromCharCode(k[k.l++]);if(me){var Me=u(k.slice(k.l,k.l+me));(Me[21589]||{}).mt&&(ie=Me[21589].mt),((B||{})[21589]||{}).mt&&(ie=B[21589].mt)}k.l+=me;var Pe=k.slice(k.l,k.l+K);switch(re){case 8:Pe=z(k,te);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+re)}var Rt=!1;L&8&&(W=k.read_shift(4),W==134695760&&(W=k.read_shift(4),Rt=!0),K=k.read_shift(4),te=k.read_shift(4)),K!=F&&ai(Rt,"Bad compressed size: "+F+" != "+K),te!=C&&ai(Rt,"Bad uncompressed size: "+C+" != "+te),xe(O,Fe,Pe,{unsafe:!0,mt:ie})}function ii(k,F){var C=F||{},O=[],B=[],L=pe(1),re=C.compression?8:0,ie=0,W=0,K=0,te=0,ve=0,me=k.FullPaths[0],Fe=me,Ae=k.FileIndex[0],Me=[],Pe=0;for(W=1;W<k.FullPaths.length;++W)if(Fe=k.FullPaths[W].slice(me.length),Ae=k.FileIndex[W],!(!Ae.size||!Ae.content||Fe=="Sh33tJ5")){var Rt=te,Dt=pe(Fe.length);for(K=0;K<Fe.length;++K)Dt.write_shift(1,Fe.charCodeAt(K)&127);Dt=Dt.slice(0,Dt.l),Me[ve]=Hk.buf(Ae.content,0);var Kt=Ae.content;re==8&&(Kt=P(Kt)),L=pe(30),L.write_shift(4,67324752),L.write_shift(2,20),L.write_shift(2,ie),L.write_shift(2,re),Ae.mt?l(L,Ae.mt):L.write_shift(4,0),L.write_shift(-4,Me[ve]),L.write_shift(4,Kt.length),L.write_shift(4,Ae.content.length),L.write_shift(2,Dt.length),L.write_shift(2,0),te+=L.length,O.push(L),te+=Dt.length,O.push(Dt),te+=Kt.length,O.push(Kt),L=pe(46),L.write_shift(4,33639248),L.write_shift(2,0),L.write_shift(2,20),L.write_shift(2,ie),L.write_shift(2,re),L.write_shift(4,0),L.write_shift(-4,Me[ve]),L.write_shift(4,Kt.length),L.write_shift(4,Ae.content.length),L.write_shift(2,Dt.length),L.write_shift(2,0),L.write_shift(2,0),L.write_shift(2,0),L.write_shift(2,0),L.write_shift(4,0),L.write_shift(4,Rt),Pe+=L.l,B.push(L),Pe+=Dt.length,B.push(Dt),++ve}return L=pe(22),L.write_shift(4,101010256),L.write_shift(2,0),L.write_shift(2,0),L.write_shift(2,ve),L.write_shift(2,ve),L.write_shift(4,Pe),L.write_shift(4,te),L.write_shift(2,0),Cr([Cr(O),Cr(B),L])}var aa={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function si(k,F){if(k.ctype)return k.ctype;var C=k.name||"",O=C.match(/\.([^\.]+)$/);return O&&aa[O[1]]||F&&(O=(C=F).match(/[\.\\]([^\.\\])+$/),O&&aa[O[1]])?aa[O[1]]:"application/octet-stream"}function An(k){for(var F=so(k),C=[],O=0;O<F.length;O+=76)C.push(F.slice(O,O+76));return C.join(`\r
`)+`\r
`}function Xl(k){var F=k.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(K){var te=K.charCodeAt(0).toString(16).toUpperCase();return"="+(te.length==1?"0"+te:te)});F=F.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),F.charAt(0)==`
`&&(F="=0D"+F.slice(1)),F=F.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var C=[],O=F.split(`\r
`),B=0;B<O.length;++B){var L=O[B];if(L.length==0){C.push("");continue}for(var re=0;re<L.length;){var ie=76,W=L.slice(re,re+ie);W.charAt(ie-1)=="="?ie--:W.charAt(ie-2)=="="?ie-=2:W.charAt(ie-3)=="="&&(ie-=3),W=L.slice(re,re+ie),re+=ie,re<L.length&&(W+="="),C.push(W)}}return C.join(`\r
`)}function Bs(k){for(var F=[],C=0;C<k.length;++C){for(var O=k[C];C<=k.length&&O.charAt(O.length-1)=="=";)O=O.slice(0,O.length-1)+k[++C];F.push(O)}for(var B=0;B<F.length;++B)F[B]=F[B].replace(/[=][0-9A-Fa-f]{2}/g,function(L){return String.fromCharCode(parseInt(L.slice(1),16))});return Ca(F.join(`\r
`))}function Gi(k,F,C){for(var O="",B="",L="",re,ie=0;ie<10;++ie){var W=F[ie];if(!W||W.match(/^\s*$/))break;var K=W.match(/^(.*?):\s*([^\s].*)$/);if(K)switch(K[1].toLowerCase()){case"content-location":O=K[2].trim();break;case"content-type":L=K[2].trim();break;case"content-transfer-encoding":B=K[2].trim();break}}switch(++ie,B.toLowerCase()){case"base64":re=Ca(Oa(F.slice(ie).join("")));break;case"quoted-printable":re=Bs(F.slice(ie));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+B)}var te=xe(k,O.slice(C.length),re,{unsafe:!0});L&&(te.ctype=L)}function Qa(k,F){if(Z(k.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var C=F&&F.root||"",O=(ct&&Buffer.isBuffer(k)?k.toString("binary"):Z(k)).split(`\r
`),B=0,L="";for(B=0;B<O.length;++B)if(L=O[B],!!/^Content-Location:/i.test(L)&&(L=L.slice(L.indexOf("file")),C||(C=L.slice(0,L.lastIndexOf("/")+1)),L.slice(0,C.length)!=C))for(;C.length>0&&(C=C.slice(0,C.length-1),C=C.slice(0,C.lastIndexOf("/")+1),L.slice(0,C.length)!=C););var re=(O[1]||"").match(/boundary="(.*?)"/);if(!re)throw new Error("MAD cannot find boundary");var ie="--"+(re[1]||""),W=[],K=[],te={FileIndex:W,FullPaths:K};R(te);var ve,me=0;for(B=0;B<O.length;++B){var Fe=O[B];Fe!==ie&&Fe!==ie+"--"||(me++&&Gi(te,O.slice(ve,B),C),ve=B)}return te}function Ls(k,F){var C=F||{},O=C.boundary||"SheetJS";O="------="+O;for(var B=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+O.slice(2)+'"',"","",""],L=k.FullPaths[0],re=L,ie=k.FileIndex[0],W=1;W<k.FullPaths.length;++W)if(re=k.FullPaths[W].slice(L.length),ie=k.FileIndex[W],!(!ie.size||!ie.content||re=="Sh33tJ5")){re=re.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Pe){return"_x"+Pe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Pe){return"_u"+Pe.charCodeAt(0).toString(16)+"_"});for(var K=ie.content,te=ct&&Buffer.isBuffer(K)?K.toString("binary"):Z(K),ve=0,me=Math.min(1024,te.length),Fe=0,Ae=0;Ae<=me;++Ae)(Fe=te.charCodeAt(Ae))>=32&&Fe<128&&++ve;var Me=ve>=me*4/5;B.push(O),B.push("Content-Location: "+(C.root||"file:///C:/SheetJS/")+re),B.push("Content-Transfer-Encoding: "+(Me?"quoted-printable":"base64")),B.push("Content-Type: "+si(ie,re)),B.push(""),B.push(Me?Xl(te):An(te))}return B.push(O+`--\r
`),B.join(`\r
`)}function he(k){var F={};return R(F,k),F}function xe(k,F,C,O){var B=O&&O.unsafe;B||R(k);var L=!B&&qe.find(k,F);if(!L){var re=k.FullPaths[0];F.slice(0,re.length)==re?re=F:(re.slice(-1)!="/"&&(re+="/"),re=(re+F).replace("//","/")),L={name:i(F),type:2},k.FileIndex.push(L),k.FullPaths.push(re),B||qe.utils.cfb_gc(k)}return L.content=C,L.size=C?C.length:0,O&&(O.CLSID&&(L.clsid=O.CLSID),O.mt&&(L.mt=O.mt),O.ct&&(L.ct=O.ct)),L}function Re(k,F){R(k);var C=qe.find(k,F);if(C){for(var O=0;O<k.FileIndex.length;++O)if(k.FileIndex[O]==C)return k.FileIndex.splice(O,1),k.FullPaths.splice(O,1),!0}return!1}function Le(k,F,C){R(k);var O=qe.find(k,F);if(O){for(var B=0;B<k.FileIndex.length;++B)if(k.FileIndex[B]==O)return k.FileIndex[B].name=i(C),k.FullPaths[B]=C,!0}return!1}function je(k){G(k,!0)}return t.find=ne,t.read=I,t.parse=x,t.write=De,t.writeFile=_e,t.utils={cfb_new:he,cfb_add:xe,cfb_del:Re,cfb_mov:Le,cfb_gc:je,ReadShift:Gc,CheckField:F_,prep_blob:Ur,bconcat:Cr,use_zlib:N,_deflateRaw:at,_inflateRaw:Ms,consts:le},t})();function Vk(e){return typeof e=="string"?Nu(e):Array.isArray(e)?xk(e):e}function bo(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Nu(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Sn(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var i=new Blob([Vk(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,e);if(typeof saveAs<"u")return saveAs(i,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var l=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(l)},6e4),chrome.downloads.download({url:l,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=l,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(l)},6e4),l}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var u=File(e);return u.open("w"),u.encoding="binary",Array.isArray(t)&&(t=Hi(t)),u.write(t),u.close(),t}catch(h){if(!h.message||!h.message.match(/onstruct/))throw h}throw new Error("cannot save file "+e)}function $k(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function ir(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function Av(e,t){for(var r=[],n=ir(e),i=0;i!==n.length;++i)r[e[n[i]][t]]==null&&(r[e[n[i]][t]]=n[i]);return r}function Ru(e){for(var t=[],r=ir(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function Du(e){for(var t=[],r=ir(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function Gk(e){for(var t=[],r=ir(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var gu=new Date(1899,11,30,0,0,0);function Er(e,t){var r=e.getTime(),n=gu.getTime()+(e.getTimezoneOffset()-gu.getTimezoneOffset())*6e4;return(r-n)/(1440*60*1e3)}var h_=new Date,qk=gu.getTime()+(h_.getTimezoneOffset()-gu.getTimezoneOffset())*6e4,Cv=h_.getTimezoneOffset();function Fu(e){var t=new Date;return t.setTime(e*24*60*60*1e3+qk),t.getTimezoneOffset()!==Cv&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Cv)*6e4),t}function Xk(e){var t=0,r=0,n=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var l=1;l!=i.length;++l)if(i[l]){switch(r=1,l>3&&(n=!0),i[l].slice(i[l].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[l].slice(i[l].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(i[l],10)}return t}var Nv=new Date("2017-02-19T19:06:09.000Z"),d_=isNaN(Nv.getFullYear())?new Date("2/19/17"):Nv,Wk=d_.getFullYear()==2017;function Gt(e,t){var r=new Date(e);if(Wk)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(d_.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],l=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(l=new Date(l.getTime()-l.getTimezoneOffset()*60*1e3)),l}function bs(e,t){if(ct&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Sn(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Sn(e_(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Sn(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Sn(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(l){return r[l]||l})}catch{}for(var n=[],i=0;i!=e.length;++i)n.push(String.fromCharCode(e[i]));return n.join("")}function qt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=qt(e[r]));return t}function ar(e,t){for(var r="";r.length<t;)r+=e;return r}function un(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,l){return r=-r,l}),!isNaN(t=Number(n)))?t/r:t}var Kk=["january","february","march","april","may","june","july","august","september","october","november","december"];function Ul(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),i=t.getMonth(),l=t.getDate();if(isNaN(l))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&Kk.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||l>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var Yk=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(e||typeof n=="string")return r.split(n);for(var l=r.split(n),o=[l[0]],u=1;u<l.length;++u)o.push(i),o.push(l[u]);return o}})();function m_(e){return e?e.content&&e.type?bs(e.content,!0):e.data?Pc(e.data):e.asNodeBuffer&&ct?Pc(e.asNodeBuffer().toString("binary")):e.asBinary?Pc(e.asBinary()):e._data&&e._data.getContent?Pc(bs(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function x_(e){if(!e)return null;if(e.data)return gv(e.data);if(e.asNodeBuffer&&ct)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?gv(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function Jk(e){return e&&e.name.slice(-4)===".bin"?x_(e):m_(e)}function Xa(e,t){for(var r=e.FullPaths||ir(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),l=0;l<r.length;++l){var o=r[l].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||i==o)return e.files?e.files[r[l]]:e.FileIndex[l]}return null}function c1(e,t){var r=Xa(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function vr(e,t,r){if(!r)return Jk(c1(e,t));if(!t)return null;try{return vr(e,t)}catch{return null}}function Na(e,t,r){if(!r)return m_(c1(e,t));if(!t)return null;try{return Na(e,t)}catch{return null}}function Qk(e,t,r){return x_(c1(e,t))}function Ov(e){for(var t=e.FullPaths||ir(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function lt(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return ct?n=ei(r):n=pk(r),qe.utils.cfb_add(e,t,n)}qe.utils.cfb_add(e,t,r)}else e.file(t,r)}function o1(){return qe.utils.cfb_new()}function p_(e,t){switch(t.type){case"base64":return qe.read(e,{type:"base64"});case"binary":return qe.read(e,{type:"binary"});case"buffer":case"array":return qe.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Hc(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var fr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Zk=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Rv=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,eA=/<[^>]*>/g,Yr=fr.match(Rv)?Rv:eA,tA=/<\w*:/,rA=/<(\/?)\w+:/;function et(e,t,r){for(var n={},i=0,l=0;i!==e.length&&!((l=e.charCodeAt(i))===32||l===10||l===13);++i);if(t||(n[0]=e.slice(0,i)),i===e.length)return n;var o=e.match(Zk),u=0,h="",d=0,x="",g="",v=1;if(o)for(d=0;d!=o.length;++d){for(g=o[d],l=0;l!=g.length&&g.charCodeAt(l)!==61;++l);for(x=g.slice(0,l).trim();g.charCodeAt(l+1)==32;)++l;for(v=(i=g.charCodeAt(l+1))==34||i==39?1:0,h=g.slice(l+1+v,g.length-v),u=0;u!=x.length&&x.charCodeAt(u)!==58;++u);if(u===x.length)x.indexOf("_")>0&&(x=x.slice(0,x.indexOf("_"))),n[x]=h,n[x.toLowerCase()]=h;else{var _=(u===5&&x.slice(0,5)==="xmlns"?"xmlns":"")+x.slice(u+1);if(n[_]&&x.slice(u-3,u)=="ext")continue;n[_]=h,n[_.toLowerCase()]=h}}return n}function bn(e){return e.replace(rA,"<$1")}var g_={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},u1=Ru(g_),pt=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",l=i.indexOf("<![CDATA[");if(l==-1)return i.replace(e,function(u,h){return g_[u]||String.fromCharCode(parseInt(h,u.indexOf("x")>-1?16:10))||u}).replace(t,function(u,h){return String.fromCharCode(parseInt(h,16))});var o=i.indexOf("]]>");return r(i.slice(0,l))+i.slice(l+9,o)+r(i.slice(o+3))}})(),f1=/[&<>'"]/g,aA=/[\u0000-\u0008\u000b-\u001f]/g;function Ot(e){var t=e+"";return t.replace(f1,function(r){return u1[r]}).replace(aA,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Dv(e){return Ot(e).replace(/ /g,"_x0020_")}var v_=/[\u0000-\u001f]/g;function h1(e){var t=e+"";return t.replace(f1,function(r){return u1[r]}).replace(/\n/g,"<br/>").replace(v_,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function nA(e){var t=e+"";return t.replace(f1,function(r){return u1[r]}).replace(v_,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var Fv=(function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}})();function iA(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function $t(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function ud(e){for(var t="",r=0,n=0,i=0,l=0,o=0,u=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(i=e.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=i&63,t+=String.fromCharCode(o);continue}if(l=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(i&63)<<6|l&63);continue}o=e.charCodeAt(r++),u=((n&7)<<18|(i&63)<<12|(l&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(u>>>10&1023)),t+=String.fromCharCode(56320+(u&1023))}return t}function Mv(e){var t=Ui(2*e.length),r,n,i=1,l=0,o=0,u;for(n=0;n<e.length;n+=i)i=1,(u=e.charCodeAt(n))<128?r=u:u<224?(r=(u&31)*64+(e.charCodeAt(n+1)&63),i=2):u<240?(r=(u&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),i=3):(i=4,r=(u&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[l++]=o&255,t[l++]=o>>>8,o=0),t[l++]=r%256,t[l++]=r>>>8;return t.slice(0,l).toString("ucs2")}function Bv(e){return ei(e,"binary").toString("utf8")}var Y0="foo bar baz",Lt=ct&&(Bv(Y0)==ud(Y0)&&Bv||Mv(Y0)==ud(Y0)&&Mv)||ud,Sn=ct?function(e){return ei(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,i=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},co=(function(){var e={};return function(r,n){var i=r+"|"+(n||"");return e[i]?e[i]:e[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}})(),y_=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)n=n.replace(e[i][0],e[i][1]);return n}})(),sA=(function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),lA=/<\/?(?:vt:)?variant>/g,cA=/<(?:vt:)([^>]*)>([\s\S]*)</;function Lv(e,t){var r=et(e),n=e.match(sA(r.baseType))||[],i=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(l){var o=l.replace(lA,"").match(cA);o&&i.push({v:Lt(o[2]),t:o[1]})}),i}var __=/(^\s|\s$|\n)/;function jr(e,t){return"<"+e+(t.match(__)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function oo(e){return ir(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Be(e,t,r){return"<"+e+(r!=null?oo(r):"")+(t!=null?(t.match(__)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Bd(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function oA(e,t){switch(typeof e){case"string":var r=Be("vt:lpwstr",Ot(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Be((e|0)==e?"vt:i4":"vt:r8",Ot(String(e)));case"boolean":return Be("vt:bool",e?"true":"false")}if(e instanceof Date)return Be("vt:filetime",Bd(e));throw new Error("Unable to serialize "+e)}function d1(e){if(ct&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Lt(Hi(i1(e)));throw new Error("Bad input format: expected Buffer or string")}var uo=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,br={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Cs=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Ea={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function uA(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,l=5;l>=0;--l)i=i*256+e[t+l];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function fA(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,i=0,l=0,o=n?-t:t;isFinite(o)?o==0?i=l=0:(i=Math.floor(Math.log(o)/Math.LN2),l=o*Math.pow(2,52-i),i<=-1023&&(!isFinite(l)||l<Math.pow(2,52))?i=-1022:(l-=Math.pow(2,52),i+=1023)):(i=2047,l=isNaN(t)?26985:0);for(var u=0;u<=5;++u,l/=256)e[r+u]=l&255;e[r+6]=(i&15)<<4|l&15,e[r+7]=i>>4|n}var Iv=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,l=e[0][n].length;i<l;i+=r)t.push.apply(t,e[0][n].slice(i,i+r));return t},Uv=ct?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:ei(t)})):Iv(e)}:Iv,jv=function(e,t,r){for(var n=[],i=t;i<r;i+=2)n.push(String.fromCharCode(Wn(e,i)));return n.join("").replace(ta,"")},m1=ct?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(ta,""):jv(e,t,r)}:jv,Pv=function(e,t,r){for(var n=[],i=t;i<t+r;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},w_=ct?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Pv(e,t,r)}:Pv,zv=function(e,t,r){for(var n=[],i=t;i<r;i++)n.push(String.fromCharCode(Nl(e,i)));return n.join("")},Eo=ct?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):zv(t,r,n)}:zv,S_=function(e,t){var r=Ta(e,t);return r>0?Eo(e,t+4,t+4+r-1):""},b_=S_,E_=function(e,t){var r=Ta(e,t);return r>0?Eo(e,t+4,t+4+r-1):""},T_=E_,k_=function(e,t){var r=2*Ta(e,t);return r>0?Eo(e,t+4,t+4+r-1):""},A_=k_,C_=function(t,r){var n=Ta(t,r);return n>0?m1(t,r+4,r+4+n):""},N_=C_,O_=function(e,t){var r=Ta(e,t);return r>0?Eo(e,t+4,t+4+r):""},R_=O_,D_=function(e,t){return uA(e,t)},vu=D_,x1=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};ct&&(b_=function(t,r){if(!Buffer.isBuffer(t))return S_(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},T_=function(t,r){if(!Buffer.isBuffer(t))return E_(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},A_=function(t,r){if(!Buffer.isBuffer(t))return k_(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},N_=function(t,r){if(!Buffer.isBuffer(t))return C_(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},R_=function(t,r){if(!Buffer.isBuffer(t))return O_(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},vu=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):D_(t,r)},x1=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Nl=function(e,t){return e[t]},Wn=function(e,t){return e[t+1]*256+e[t]},hA=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Ta=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},xs=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},dA=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Gc(e,t){var r="",n,i,l=[],o,u,h,d;switch(t){case"dbcs":if(d=this.l,ct&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(h=0;h<e;++h)r+=String.fromCharCode(Wn(this,d)),d+=2;e*=2;break;case"utf8":r=Eo(this,this.l,this.l+e);break;case"utf16le":e*=2,r=m1(this,this.l,this.l+e);break;case"wstr":return Gc.call(this,e,"dbcs");case"lpstr-ansi":r=b_(this,this.l),e=4+Ta(this,this.l);break;case"lpstr-cp":r=T_(this,this.l),e=4+Ta(this,this.l);break;case"lpwstr":r=A_(this,this.l),e=4+2*Ta(this,this.l);break;case"lpp4":e=4+Ta(this,this.l),r=N_(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Ta(this,this.l),r=R_(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=Nl(this,this.l+e++))!==0;)l.push(K0(o));r=l.join("");break;case"_wstr":for(e=0,r="";(o=Wn(this,this.l+e))!==0;)l.push(K0(o)),e+=2;e+=2,r=l.join("");break;case"dbcs-cont":for(r="",d=this.l,h=0;h<e;++h){if(this.lens&&this.lens.indexOf(d)!==-1)return o=Nl(this,d),this.l=d+1,u=Gc.call(this,e-h,o?"dbcs-cont":"sbcs-cont"),l.join("")+u;l.push(K0(Wn(this,d))),d+=2}r=l.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",d=this.l,h=0;h!=e;++h){if(this.lens&&this.lens.indexOf(d)!==-1)return o=Nl(this,d),this.l=d+1,u=Gc.call(this,e-h,o?"dbcs-cont":"sbcs-cont"),l.join("")+u;l.push(K0(Nl(this,d))),d+=1}r=l.join("");break;default:switch(e){case 1:return n=Nl(this,this.l),this.l++,n;case 2:return n=(t==="i"?hA:Wn)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(n=(e>0?xs:dA)(this,this.l),this.l+=4,n):(i=Ta(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=vu(this,this.l):i=vu([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:r=w_(this,this.l,e);break}}return this.l+=e,r}var mA=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},xA=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},pA=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function gA(e,t,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=t.length;++i)pA(this,t.charCodeAt(i),this.l+2*i);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;n=t.length}else if(r==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var l=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var o=t.charCodeAt(i);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<l;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,mA(this,t,this.l);break;case 8:if(n=8,r==="f"){fA(this,t,this.l);break}case 16:break;case-4:n=4,xA(this,t,this.l);break}return this.l+=n,this}function F_(e,t){var r=w_(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Ur(e,t){e.l=t,e.read_shift=Gc,e.chk=F_,e.write_shift=gA}function Kr(e,t){e.l+=t}function pe(e){var t=Ui(e);return Ur(t,0),t}function ti(e,t,r){if(e){var n,i,l;Ur(e,e.l||0);for(var o=e.length,u=0,h=0;e.l<o;){u=e.read_shift(1),u&128&&(u=(u&127)+((e.read_shift(1)&127)<<7));var d=go[u]||go[65535];for(n=e.read_shift(1),l=n&127,i=1;i<4&&n&128;++i)l+=((n=e.read_shift(1))&127)<<7*i;h=e.l+l;var x=d.f&&d.f(e,l,r);if(e.l=h,t(x,d,u))return}}}function ha(){var e=[],t=ct?256:2048,r=function(d){var x=pe(d);return Ur(x,0),x},n=r(t),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},l=function(d){return n&&d<n.length-n.l?n:(i(),n=r(Math.max(d+1,t)))},o=function(){return i(),Cr(e)},u=function(d){i(),n=d,n.l==null&&(n.l=n.length),l(t)};return{next:l,push:u,end:o,_bufs:e}}function Ne(e,t,r,n){var i=+t,l;if(!isNaN(i)){n||(n=go[i].p||(r||[]).length||0),l=1+(i>=128?1:0)+1,n>=128&&++l,n>=16384&&++l,n>=2097152&&++l;var o=e.next(l);i<=127?o.write_shift(1,i):(o.write_shift(1,(i&127)+128),o.write_shift(1,i>>7));for(var u=0;u!=4;++u)if(n>=128)o.write_shift(1,(n&127)+128),n>>=7;else{o.write_shift(1,n);break}n>0&&x1(r)&&e.push(r)}}function qc(e,t,r){var n=qt(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Hv(e,t,r){var n=qt(e);return n.s=qc(n.s,t.s,r),n.e=qc(n.e,t.s,r),n}function Xc(e,t){if(e.cRel&&e.c<0)for(e=qt(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=qt(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Ze(e);return!e.cRel&&e.cRel!=null&&(r=_A(r)),!e.rRel&&e.rRel!=null&&(r=vA(r)),r}function fd(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Qt(e.s.c)+":"+(e.e.cRel?"":"$")+Qt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+or(e.s.r)+":"+(e.e.rRel?"":"$")+or(e.e.r):Xc(e.s,t.biff)+":"+Xc(e.e,t.biff)}function p1(e){return parseInt(yA(e),10)-1}function or(e){return""+(e+1)}function vA(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function yA(e){return e.replace(/\$(\d+)$/,"$1")}function g1(e){for(var t=wA(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Qt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function _A(e){return e.replace(/^([A-Z])/,"$$$1")}function wA(e){return e.replace(/^\$([A-Z])/,"$1")}function SA(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Zt(e){for(var t=0,r=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function Ze(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function da(e){var t=e.indexOf(":");return t==-1?{s:Zt(e),e:Zt(e)}:{s:Zt(e.slice(0,t)),e:Zt(e.slice(t+1))}}function it(e,t){return typeof t>"u"||typeof t=="number"?it(e.s,e.e):(typeof e!="string"&&(e=Ze(e)),typeof t!="string"&&(t=Ze(t)),e==t?e:e+":"+t)}function gt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,l=e.length;for(r=0;n<l&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.s.c=--r,r=0;n<l&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(t.s.r=--r,n===l||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=l&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.e.c=--r,r=0;n!=l&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return t.e.r=--r,t}function Vv(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Ya(e.z,r?Er(t):t)}catch{}try{return e.w=Ya((e.XF||{}).numFmtId||(r?14:0),r?Er(t):t)}catch{return""+t}}function Qn(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?ri[e.v]||e.v:t==null?Vv(e,e.v):Vv(e,t))}function Vi(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function M_(e,t,r){var n=r||{},i=e?Array.isArray(e):n.dense,l=e||(i?[]:{}),o=0,u=0;if(l&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var h=typeof n.origin=="string"?Zt(n.origin):n.origin;o=h.r,u=h.c}l["!ref"]||(l["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(l["!ref"]){var x=gt(l["!ref"]);d.s.c=x.s.c,d.s.r=x.s.r,d.e.c=Math.max(d.e.c,x.e.c),d.e.r=Math.max(d.e.r,x.e.r),o==-1&&(d.e.r=o=x.e.r+1)}for(var g=0;g!=t.length;++g)if(t[g]){if(!Array.isArray(t[g]))throw new Error("aoa_to_sheet expects an array of arrays");for(var v=0;v!=t[g].length;++v)if(!(typeof t[g][v]>"u")){var _={v:t[g][v]},w=o+g,y=u+v;if(d.s.r>w&&(d.s.r=w),d.s.c>y&&(d.s.c=y),d.e.r<w&&(d.e.r=w),d.e.c<y&&(d.e.c=y),t[g][v]&&typeof t[g][v]=="object"&&!Array.isArray(t[g][v])&&!(t[g][v]instanceof Date))_=t[g][v];else if(Array.isArray(_.v)&&(_.f=t[g][v][1],_.v=_.v[0]),_.v===null)if(_.f)_.t="n";else if(n.nullError)_.t="e",_.v=0;else if(n.sheetStubs)_.t="z";else continue;else typeof _.v=="number"?_.t="n":typeof _.v=="boolean"?_.t="b":_.v instanceof Date?(_.z=n.dateNF||Je[14],n.cellDates?(_.t="d",_.w=Ya(_.z,Er(_.v))):(_.t="n",_.v=Er(_.v),_.w=Ya(_.z,_.v))):_.t="s";if(i)l[w]||(l[w]=[]),l[w][y]&&l[w][y].z&&(_.z=l[w][y].z),l[w][y]=_;else{var b=Ze({c:y,r:w});l[b]&&l[b].z&&(_.z=l[b].z),l[b]=_}}}return d.s.c<1e7&&(l["!ref"]=it(d)),l}function $l(e,t){return M_(null,e,t)}function bA(e){return e.read_shift(4,"i")}function fn(e,t){return t||(t=pe(4)),t.write_shift(4,e),t}function Wr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Nr(e,t){var r=!1;return t==null&&(r=!0,t=pe(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function EA(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function TA(e,t){return t||(t=pe(4)),t.write_shift(2,0),t.write_shift(2,0),t}function v1(e,t){var r=e.l,n=e.read_shift(1),i=Wr(e),l=[],o={t:i,h:i};if((n&1)!==0){for(var u=e.read_shift(4),h=0;h!=u;++h)l.push(EA(e));o.r=l}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}function kA(e,t){var r=!1;return t==null&&(r=!0,t=pe(15+4*e.t.length)),t.write_shift(1,0),Nr(e.t,t),r?t.slice(0,t.l):t}var AA=v1;function CA(e,t){var r=!1;return t==null&&(r=!0,t=pe(23+4*e.t.length)),t.write_shift(1,1),Nr(e.t,t),t.write_shift(4,1),TA({},t),r?t.slice(0,t.l):t}function Ja(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Ns(e,t){return t==null&&(t=pe(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Os(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Rs(e,t){return t==null&&(t=pe(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var NA=Wr,B_=Nr;function y1(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function yu(e,t){var r=!1;return t==null&&(r=!0,t=pe(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var OA=Wr,Ld=y1,_1=yu;function w1(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var i=n===0?vu([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):xs(t,0)>>2;return r?i/100:i}function L_(e,t){t==null&&(t=pe(4));var r=0,n=0,i=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?i:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function I_(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function RA(e,t){return t||(t=pe(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Ds=I_,Gl=RA;function Xr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Es(e,t){return(t||pe(8)).write_shift(8,e,"f")}function DA(e){var t={},r=e.read_shift(1),n=r>>>1,i=e.read_shift(1),l=e.read_shift(2,"i"),o=e.read_shift(1),u=e.read_shift(1),h=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=i;var d=vs[i];d&&(t.rgb=ho(d));break;case 2:t.rgb=ho([o,u,h]);break;case 3:t.theme=i;break}return l!=0&&(t.tint=l>0?l/32767:l/32768),t}function _u(e,t){if(t||(t=pe(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function FA(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function MA(e,t){t||(t=pe(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function U_(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function BA(e){return U_(e,1)}function LA(e){return U_(e,2)}var S1=2,fa=3,J0=11,$v=12,wu=19,Q0=64,IA=65,UA=71,jA=4108,PA=4126,Ar=80,j_=81,zA=[Ar,j_],Id={1:{n:"CodePage",t:S1},2:{n:"Category",t:Ar},3:{n:"PresentationFormat",t:Ar},4:{n:"ByteCount",t:fa},5:{n:"LineCount",t:fa},6:{n:"ParagraphCount",t:fa},7:{n:"SlideCount",t:fa},8:{n:"NoteCount",t:fa},9:{n:"HiddenCount",t:fa},10:{n:"MultimediaClipCount",t:fa},11:{n:"ScaleCrop",t:J0},12:{n:"HeadingPairs",t:jA},13:{n:"TitlesOfParts",t:PA},14:{n:"Manager",t:Ar},15:{n:"Company",t:Ar},16:{n:"LinksUpToDate",t:J0},17:{n:"CharacterCount",t:fa},19:{n:"SharedDoc",t:J0},22:{n:"HyperlinksChanged",t:J0},23:{n:"AppVersion",t:fa,p:"version"},24:{n:"DigSig",t:IA},26:{n:"ContentType",t:Ar},27:{n:"ContentStatus",t:Ar},28:{n:"Language",t:Ar},29:{n:"Version",t:Ar},255:{},2147483648:{n:"Locale",t:wu},2147483651:{n:"Behavior",t:wu},1919054434:{}},Ud={1:{n:"CodePage",t:S1},2:{n:"Title",t:Ar},3:{n:"Subject",t:Ar},4:{n:"Author",t:Ar},5:{n:"Keywords",t:Ar},6:{n:"Comments",t:Ar},7:{n:"Template",t:Ar},8:{n:"LastAuthor",t:Ar},9:{n:"RevNumber",t:Ar},10:{n:"EditTime",t:Q0},11:{n:"LastPrinted",t:Q0},12:{n:"CreatedDate",t:Q0},13:{n:"ModifiedDate",t:Q0},14:{n:"PageCount",t:fa},15:{n:"WordCount",t:fa},16:{n:"CharCount",t:fa},17:{n:"Thumbnail",t:UA},18:{n:"Application",t:Ar},19:{n:"DocSecurity",t:fa},255:{},2147483648:{n:"Locale",t:wu},2147483651:{n:"Behavior",t:wu},1919054434:{}},Gv={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},HA=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function VA(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var $A=VA([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),vs=qt($A),ri={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},P_={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},jd={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Z0={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function b1(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function GA(e){var t=b1();if(!e||!e.match)return t;var r={};if((e.match(Yr)||[]).forEach(function(n){var i=et(n);switch(i[0].replace(tA,"<")){case"<?xml":break;case"<Types":t.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":t[jd[i.ContentType]]!==void 0&&t[jd[i.ContentType]].push(i.PartName);break}}),t.xmlns!==br.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function z_(e,t){var r=Gk(jd),n=[],i;n[n.length]=fr,n[n.length]=Be("Types",null,{xmlns:br.CT,"xmlns:xsd":br.xsd,"xmlns:xsi":br.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(h){return Be("Default",null,{Extension:h[0],ContentType:h[1]})}));var l=function(h){e[h]&&e[h].length>0&&(i=e[h][0],n[n.length]=Be("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:Z0[h][t.bookType]||Z0[h].xlsx}))},o=function(h){(e[h]||[]).forEach(function(d){n[n.length]=Be("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:Z0[h][t.bookType]||Z0[h].xlsx})})},u=function(h){(e[h]||[]).forEach(function(d){n[n.length]=Be("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:r[h][0]})})};return l("workbooks"),o("sheets"),o("charts"),u("themes"),["strs","styles"].forEach(l),["coreprops","extprops","custprops"].forEach(u),u("vba"),u("comments"),u("threadedcomments"),u("drawings"),o("metadata"),u("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var ot={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function fo(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Wc(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Yr)||[]).forEach(function(i){var l=et(i);if(l[0]==="<Relationship"){var o={};o.Type=l.Type,o.Target=l.Target,o.Id=l.Id,l.TargetMode&&(o.TargetMode=l.TargetMode);var u=l.TargetMode==="External"?l.Target:Hc(l.Target,t);r[u]=o,n[l.Id]=o}}),r["!id"]=n,r}function Ml(e){var t=[fr,Be("Relationships",null,{xmlns:br.RELS})];return ir(e["!id"]).forEach(function(r){t[t.length]=Be("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Nt(e,t,r,n,i,l){if(i||(i={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,i.Id="rId"+t,i.Type=n,i.Target=r,[ot.HLINK,ot.XPATH,ot.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,t}var qA="application/vnd.oasis.opendocument.spreadsheet";function XA(e,t){for(var r=d1(e),n,i;n=uo.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=et(n[0],!1),i.path=="/"&&i.type!==qA)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function WA(e){var t=[fr];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function qv(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function KA(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function YA(e){var t=[fr];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(qv(e[r][0],e[r][1])),t.push(KA("",e[r][0]));return t.push(qv("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function H_(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+du.version+"</meta:generator></office:meta></office:document-meta>"}var Ka=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],JA=(function(){for(var e=new Array(Ka.length),t=0;t<Ka.length;++t){var r=Ka[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e})();function V_(e){var t={};e=Lt(e);for(var r=0;r<Ka.length;++r){var n=Ka[r],i=e.match(JA[r]);i!=null&&i.length>0&&(t[n[1]]=pt(i[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=Gt(t[n[1]]))}return t}function hd(e,t,r,n,i){i[e]!=null||t==null||t===""||(i[e]=t,t=Ot(t),n[n.length]=r?Be(e,t,r):jr(e,t))}function $_(e,t){var r=t||{},n=[fr,Be("cp:coreProperties",null,{"xmlns:cp":br.CORE_PROPS,"xmlns:dc":br.dc,"xmlns:dcterms":br.dcterms,"xmlns:dcmitype":br.dcmitype,"xmlns:xsi":br.xsi})],i={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&hd("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Bd(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),e.ModifiedDate!=null&&hd("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Bd(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var l=0;l!=Ka.length;++l){var o=Ka[l],u=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:e?e[o[1]]:null;u===!0?u="1":u===!1?u="0":typeof u=="number"&&(u=String(u)),u!=null&&hd(o[0],u,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var ys=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],G_=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function q_(e,t,r,n){var i=[];if(typeof e=="string")i=Lv(e,n);else for(var l=0;l<e.length;++l)i=i.concat(e[l].map(function(x){return{v:x}}));var o=typeof t=="string"?Lv(t,n).map(function(x){return x.v}):t,u=0,h=0;if(o.length>0)for(var d=0;d!==i.length;d+=2){switch(h=+i[d+1].v,i[d].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=h,r.SheetNames=o.slice(u,u+h);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=h,r.DefinedNames=o.slice(u,u+h);break;case"Charts":case"Diagramme":r.Chartsheets=h,r.ChartNames=o.slice(u,u+h);break}u+=h}}function QA(e,t,r){var n={};return t||(t={}),e=Lt(e),ys.forEach(function(i){var l=(e.match(co(i[0]))||[])[1];switch(i[2]){case"string":l&&(t[i[1]]=pt(l));break;case"bool":t[i[1]]=l==="true";break;case"raw":var o=e.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));o&&o.length>0&&(n[i[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&q_(n.HeadingPairs,n.TitlesOfParts,t,r),t}function X_(e){var t=[],r=Be;return e||(e={}),e.Application="SheetJS",t[t.length]=fr,t[t.length]=Be("Properties",null,{xmlns:br.EXT_PROPS,"xmlns:vt":br.vt}),ys.forEach(function(n){if(e[n[1]]!==void 0){var i;switch(n[2]){case"string":i=Ot(String(e[n[1]]));break;case"bool":i=e[n[1]]?"true":"false";break}i!==void 0&&(t[t.length]=r(n[0],i))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Ot(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var ZA=/<[^>]+>[^<]*/g;function e3(e,t){var r={},n="",i=e.match(ZA);if(i)for(var l=0;l!=i.length;++l){var o=i[l],u=et(o);switch(u[0]){case"<?xml":break;case"<Properties":break;case"<property":n=pt(u.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var h=o.split(">"),d=h[0].slice(4),x=h[1];switch(d){case"lpstr":case"bstr":case"lpwstr":r[n]=pt(x);break;case"bool":r[n]=$t(x);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(x,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(x);break;case"filetime":case"date":r[n]=Gt(x);break;case"cy":case"error":r[n]=pt(x);break;default:if(d.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,d,h)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return r}function W_(e){var t=[fr,Be("Properties",null,{xmlns:br.CUST_PROPS,"xmlns:vt":br.vt})];if(!e)return t.join("");var r=1;return ir(e).forEach(function(i){++r,t[t.length]=Be("property",oA(e[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Ot(i)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Pd={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},dd;function t3(e,t,r){dd||(dd=Ru(Pd)),t=dd[t]||t,e[t]=r}function r3(e,t){var r=[];return ir(Pd).map(function(n){for(var i=0;i<Ka.length;++i)if(Ka[i][1]==n)return Ka[i];for(i=0;i<ys.length;++i)if(ys[i][1]==n)return ys[i];throw n}).forEach(function(n){if(e[n[1]]!=null){var i=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];n[2]==="date"&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"Z")),typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(jr(Pd[n[1]]||n[1],i))}}),Be("DocumentProperties",r.join(""),{xmlns:Ea.o})}function a3(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return e&&ir(e).forEach(function(l){if(Object.prototype.hasOwnProperty.call(e,l)){for(var o=0;o<Ka.length;++o)if(l==Ka[o][1])return;for(o=0;o<ys.length;++o)if(l==ys[o][1])return;for(o=0;o<r.length;++o)if(l==r[o])return;var u=e[l],h="string";typeof u=="number"?(h="float",u=String(u)):u===!0||u===!1?(h="boolean",u=u?"1":"0"):u=String(u),i.push(Be(Dv(l),u,{"dt:dt":h}))}}),t&&ir(t).forEach(function(l){if(Object.prototype.hasOwnProperty.call(t,l)&&!(e&&Object.prototype.hasOwnProperty.call(e,l))){var o=t[l],u="string";typeof o=="number"?(u="float",o=String(o)):o===!0||o===!1?(u="boolean",o=o?"1":"0"):o instanceof Date?(u="dateTime.tz",o=o.toISOString()):o=String(o),i.push(Be(Dv(l),o,{"dt:dt":u}))}}),"<"+n+' xmlns="'+Ea.o+'">'+i.join("")+"</"+n+">"}function E1(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function n3(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var l=n/Math.pow(2,32)|0;l>0&&(n=n%Math.pow(2,32),i+=l);var o=pe(8);return o.write_shift(4,n),o.write_shift(4,i),o}function K_(e,t,r){var n=e.l,i=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return i}function Y_(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function J_(e,t,r){return t===31?Y_(e):K_(e,t,r)}function zd(e,t,r){return J_(e,t,r===!1?0:4)}function i3(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return J_(e,t,0)}function s3(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var i=e.l;r[n]=e.read_shift(0,"lpwstr").replace(ta,""),e.l-i&2&&(e.l+=2)}return r}function l3(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(ta,"");return r}function c3(e){var t=e.l,r=Su(e,j_);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=Su(e,fa);return[r,n]}function o3(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(c3(e));return r}function Xv(e,t){for(var r=e.read_shift(4),n={},i=0;i!=r;++i){var l=e.read_shift(4),o=e.read_shift(4);n[l]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(ta,"").replace(zc,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function Q_(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function u3(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Su(e,t,r){var n=e.read_shift(2),i,l=r||{};if(e.l+=2,t!==$v&&n!==t&&zA.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===$v?n:t){case 2:return i=e.read_shift(2,"i"),l.raw||(e.l+=2),i;case 3:return i=e.read_shift(4,"i"),i;case 11:return e.read_shift(4)!==0;case 19:return i=e.read_shift(4),i;case 30:return K_(e,n,4).replace(ta,"");case 31:return Y_(e);case 64:return E1(e);case 65:return Q_(e);case 71:return u3(e);case 80:return zd(e,n,!l.raw).replace(ta,"");case 81:return i3(e,n).replace(ta,"");case 4108:return o3(e);case 4126:case 4127:return n==4127?s3(e):l3(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function Wv(e,t){var r=pe(4),n=pe(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=pe(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=n3(t);break;case 31:case 80:for(n=pe(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Cr([r,n])}function Kv(e,t){var r=e.l,n=e.read_shift(4),i=e.read_shift(4),l=[],o=0,u=0,h=-1,d={};for(o=0;o!=i;++o){var x=e.read_shift(4),g=e.read_shift(4);l[o]=[x,g+r]}l.sort(function(M,T){return M[1]-T[1]});var v={};for(o=0;o!=i;++o){if(e.l!==l[o][1]){var _=!0;if(o>0&&t)switch(t[l[o-1][0]].t){case 2:e.l+2===l[o][1]&&(e.l+=2,_=!1);break;case 80:e.l<=l[o][1]&&(e.l=l[o][1],_=!1);break;case 4108:e.l<=l[o][1]&&(e.l=l[o][1],_=!1);break}if((!t||o==0)&&e.l<=l[o][1]&&(_=!1,e.l=l[o][1]),_)throw new Error("Read Error: Expected address "+l[o][1]+" at "+e.l+" :"+o)}if(t){var w=t[l[o][0]];if(v[w.n]=Su(e,w.t,{raw:!0}),w.p==="version"&&(v[w.n]=String(v[w.n]>>16)+"."+("0000"+String(v[w.n]&65535)).slice(-4)),w.n=="CodePage")switch(v[w.n]){case 0:v[w.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:cn(u=v[w.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+v[w.n])}}else if(l[o][0]===1){if(u=v.CodePage=Su(e,S1),cn(u),h!==-1){var y=e.l;e.l=l[h][1],d=Xv(e,u),e.l=y}}else if(l[o][0]===0){if(u===0){h=o,e.l=l[o+1][1];continue}d=Xv(e,u)}else{var b=d[l[o][0]],A;switch(e[e.l]){case 65:e.l+=4,A=Q_(e);break;case 30:e.l+=4,A=zd(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,A=zd(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,A=e.read_shift(4,"i");break;case 19:e.l+=4,A=e.read_shift(4);break;case 5:e.l+=4,A=e.read_shift(8,"f");break;case 11:e.l+=4,A=cr(e,4);break;case 64:e.l+=4,A=Gt(E1(e));break;default:throw new Error("unparsed value: "+e[e.l])}v[b]=A}}return e.l=r+n,v}var Z_=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function f3(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Yv(e,t,r){var n=pe(8),i=[],l=[],o=8,u=0,h=pe(8),d=pe(8);if(h.write_shift(4,2),h.write_shift(4,1200),d.write_shift(4,1),l.push(h),i.push(d),o+=8+h.length,!t){d=pe(8),d.write_shift(4,0),i.unshift(d);var x=[pe(4)];for(x[0].write_shift(4,e.length),u=0;u<e.length;++u){var g=e[u][0];for(h=pe(8+2*(g.length+1)+(g.length%2?0:2)),h.write_shift(4,u+2),h.write_shift(4,g.length+1),h.write_shift(0,g,"dbcs");h.l!=h.length;)h.write_shift(1,0);x.push(h)}h=Cr(x),l.unshift(h),o+=8+h.length}for(u=0;u<e.length;++u)if(!(t&&!t[e[u][0]])&&!(Z_.indexOf(e[u][0])>-1||G_.indexOf(e[u][0])>-1)&&e[u][1]!=null){var v=e[u][1],_=0;if(t){_=+t[e[u][0]];var w=r[_];if(w.p=="version"&&typeof v=="string"){var y=v.split(".");v=(+y[0]<<16)+(+y[1]||0)}h=Wv(w.t,v)}else{var b=f3(v);b==-1&&(b=31,v=String(v)),h=Wv(b,v)}l.push(h),d=pe(8),d.write_shift(4,t?_:2+u),i.push(d),o+=8+h.length}var A=8*(l.length+1);for(u=0;u<l.length;++u)i[u].write_shift(4,A),A+=l[u].length;return n.write_shift(4,o),n.write_shift(4,l.length),Cr([n].concat(i).concat(l))}function Jv(e,t,r){var n=e.content;if(!n)return{};Ur(n,0);var i,l,o,u,h=0;n.chk("feff","Byte Order: "),n.read_shift(2);var d=n.read_shift(4),x=n.read_shift(16);if(x!==qe.utils.consts.HEADER_CLSID&&x!==r)throw new Error("Bad PropertySet CLSID "+x);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(l=n.read_shift(16),u=n.read_shift(4),i===1&&u!==n.l)throw new Error("Length mismatch: "+u+" !== "+n.l);i===2&&(o=n.read_shift(16),h=n.read_shift(4));var g=Kv(n,t),v={SystemIdentifier:d};for(var _ in g)v[_]=g[_];if(v.FMTID=l,i===1)return v;if(h-n.l==2&&(n.l+=2),n.l!==h)throw new Error("Length mismatch 2: "+n.l+" !== "+h);var w;try{w=Kv(n,null)}catch{}for(_ in w)v[_]=w[_];return v.FMTID=[l,o],v}function Qv(e,t,r,n,i,l){var o=pe(i?68:48),u=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,qe.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,i?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,i?68:48);var h=Yv(e,r,n);if(u.push(h),i){var d=Yv(i,null,null);o.write_shift(16,l,"hex"),o.write_shift(4,68+h.length),u.push(d)}return Cr(u)}function Di(e,t){return e.read_shift(t),null}function h3(e,t){t||(t=pe(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function d3(e,t,r){for(var n=[],i=e.l+t;e.l<i;)n.push(r(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return n}function cr(e,t){return e.read_shift(t)===1}function ea(e,t){return t||(t=pe(2)),t.write_shift(2,+!!e),t}function yr(e){return e.read_shift(2,"u")}function Wa(e,t){return t||(t=pe(2)),t.write_shift(2,e),t}function e2(e,t){return d3(e,t,yr)}function m3(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function t2(e,t,r){return r||(r=pe(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function To(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var l=e.read_shift(1);l&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var o=n?e.read_shift(n,i):"";return o}function x3(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,i=r&8,l=1+(r&1),o=0,u,h={};i&&(o=e.read_shift(2)),n&&(u=e.read_shift(4));var d=l==2?"dbcs-cont":"sbcs-cont",x=t===0?"":e.read_shift(t,d);return i&&(e.l+=4*o),n&&(e.l+=u),h.t=x,i||(h.raw="<t>"+h.t+"</t>",h.r=h.t),h}function p3(e){var t=e.t||"",r=pe(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=pe(2*t.length);n.write_shift(2*t.length,t,"utf16le");var i=[r,n];return Cr(i)}function Ts(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function ko(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):Ts(e,n,r)}function Fs(e,t,r){if(r.biff>5)return ko(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function r2(e,t,r){return r||(r=pe(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function g3(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function v3(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var i=e.read_shift((n?t-24:t)>>1,"utf16le").replace(ta,"");return n&&(e.l+=24),i}function y3(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=e.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var l=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(l>>1,"utf16le").replace(ta,"");return r+o}function _3(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return v3(e);case"0303000000000000c000000000000046":return y3(e);default:throw new Error("Unsupported Moniker "+r)}}function eu(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(ta,""):"";return r}function Zv(e,t){t||(t=pe(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function w3(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=e.read_shift(2);e.l+=2;var l,o,u,h,d="",x,g;i&16&&(l=eu(e,r-e.l)),i&128&&(o=eu(e,r-e.l)),(i&257)===257&&(u=eu(e,r-e.l)),(i&257)===1&&(h=_3(e,r-e.l)),i&8&&(d=eu(e,r-e.l)),i&32&&(x=e.read_shift(16)),i&64&&(g=E1(e)),e.l=r;var v=o||u||h||"";v&&d&&(v+="#"+d),v||(v="#"+d),i&2&&v.charAt(0)=="/"&&v.charAt(1)!="/"&&(v="file://"+v);var _={Target:v};return x&&(_.guid=x),g&&(_.time=g),l&&(_.Tooltip=l),_}function S3(e){var t=pe(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),l=i>-1?31:23;switch(n.charAt(0)){case"#":l=28;break;case".":l&=-3;break}t.write_shift(4,2),t.write_shift(4,l);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)t.write_shift(4,o[r]);if(l==28)n=n.slice(1),Zv(n,t);else if(l&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));var u=i>-1?n.slice(0,i):n;for(t.write_shift(4,2*(u.length+1)),r=0;r<u.length;++r)t.write_shift(2,u.charCodeAt(r));t.write_shift(2,0),l&8&&Zv(i>-1?n.slice(i+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));for(var h=0;n.slice(h*3,h*3+3)=="../"||n.slice(h*3,h*3+3)=="..\\";)++h;for(t.write_shift(2,h),t.write_shift(4,n.length-3*h+1),r=0;r<n.length-3*h;++r)t.write_shift(1,n.charCodeAt(r+3*h)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function a2(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),i=e.read_shift(1);return[t,r,n,i]}function n2(e,t){var r=a2(e);return r[3]=0,r}function En(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function ks(e,t,r,n){return n||(n=pe(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function b3(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function E3(e,t,r){return t===0?"":Fs(e,t,r)}function T3(e,t,r){var n=r.biff>8?4:2,i=e.read_shift(n),l=e.read_shift(n,"i"),o=e.read_shift(n,"i");return[i,l,o]}function i2(e){var t=e.read_shift(2),r=w1(e);return[t,r]}function k3(e,t,r){e.l+=4,t-=4;var n=e.l+t,i=To(e,t,r),l=e.read_shift(2);if(n-=e.l,l!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+l);return e.l+=l,i}function Mu(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);return{s:{c:n,r:t},e:{c:i,r}}}function s2(e,t){return t||(t=pe(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function l2(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),i=e.read_shift(1);return{s:{c:n,r:t},e:{c:i,r}}}var A3=l2;function c2(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function C3(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function N3(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Vr(e){e.l+=2,e.l+=e.read_shift(2)}var O3={0:Vr,4:Vr,5:Vr,6:Vr,7:N3,8:Vr,9:Vr,10:Vr,11:Vr,12:Vr,13:C3,14:Vr,15:Vr,16:Vr,17:Vr,18:Vr,19:Vr,20:Vr,21:c2};function R3(e,t){for(var r=e.l+t,n=[];e.l<r;){var i=e.read_shift(2);e.l-=2;try{n.push(O3[i](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function tu(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function T1(e,t,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var l=pe(i);return l.write_shift(2,n),l.write_shift(2,t),i>4&&l.write_shift(2,29282),i>6&&l.write_shift(2,1997),i>8&&(l.write_shift(2,49161),l.write_shift(2,1),l.write_shift(2,1798),l.write_shift(2,0)),l}function D3(e,t){return t===0||e.read_shift(2),1200}function F3(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,i=Fs(e,0,r);return e.read_shift(t+n-e.l),i}function M3(e,t){var r=!t||t.biff==8,n=pe(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function B3(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function L3(e,t,r){var n=e.read_shift(4),i=e.read_shift(1)&3,l=e.read_shift(1);switch(l){case 0:l="Worksheet";break;case 1:l="Macrosheet";break;case 2:l="Chartsheet";break;case 6:l="VBAModule";break}var o=To(e,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:i,dt:l,name:o}}function I3(e,t){var r=!t||t.biff>=8?2:1,n=pe(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function U3(e,t){for(var r=e.l+t,n=e.read_shift(4),i=e.read_shift(4),l=[],o=0;o!=i&&e.l<r;++o)l.push(x3(e));return l.Count=n,l.Unique=i,l}function j3(e,t){var r=pe(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],i=0;i<e.length;++i)n[i]=p3(e[i]);var l=Cr([r].concat(n));return l.parts=[r.length].concat(n.map(function(o){return o.length})),l}function P3(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function z3(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function H3(e){var t=b3(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function V3(e){return e.read_shift(2),e.read_shift(4)}function ey(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var i=e.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var l={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[l,i]}function $3(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),l=e.read_shift(2),o=e.read_shift(2),u=e.read_shift(2),h=e.read_shift(2),d=e.read_shift(2);return{Pos:[t,r],Dim:[n,i],Flags:l,CurTab:o,FirstTab:u,Selected:h,TabRatio:d}}function G3(){var e=pe(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function q3(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function X3(e){var t=pe(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function W3(){}function K3(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=To(e,0,r),n}function Y3(e,t){var r=e.name||"Arial",n=t&&t.biff==5,i=n?15+r.length:16+2*r.length,l=pe(i);return l.write_shift(2,e.sz*20),l.write_shift(4,0),l.write_shift(2,400),l.write_shift(4,0),l.write_shift(2,0),l.write_shift(1,r.length),n||l.write_shift(1,1),l.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),l}function J3(e){var t=En(e);return t.isst=e.read_shift(4),t}function Q3(e,t,r,n){var i=pe(10);return ks(e,t,n,i),i.write_shift(4,r),i}function Z3(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,i=En(e);r.biff==2&&e.l++;var l=ko(e,n-e.l,r);return i.val=l,i}function eC(e,t,r,n,i){var l=!i||i.biff==8,o=pe(8+ +l+(1+l)*r.length);return ks(e,t,n,o),o.write_shift(2,r.length),l&&o.write_shift(1,1),o.write_shift((1+l)*r.length,r,l?"utf16le":"sbcs"),o}function tC(e,t,r){var n=e.read_shift(2),i=Fs(e,0,r);return[n,i]}function rC(e,t,r,n){var i=r&&r.biff==5;n||(n=pe(i?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(i?1:2,t.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le");var l=n.length>n.l?n.slice(0,n.l):n;return l.l==null&&(l.l=l.length),l}var aC=Fs;function ty(e,t,r){var n=e.l+t,i=r.biff==8||!r.biff?4:2,l=e.read_shift(i),o=e.read_shift(i),u=e.read_shift(2),h=e.read_shift(2);return e.l=n,{s:{r:l,c:u},e:{r:o,c:h}}}function nC(e,t){var r=t.biff==8||!t.biff?4:2,n=pe(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function iC(e){var t=e.read_shift(2),r=e.read_shift(2),n=i2(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function sC(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),l=[];e.l<r;)l.push(i2(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(l.length!=o-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:o,rkrec:l}}function lC(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),l=[];e.l<r;)l.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(l.length!=o-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:o,ixfe:l}}function cC(e,t,r,n){var i={},l=e.read_shift(4),o=e.read_shift(4),u=e.read_shift(4),h=e.read_shift(2);return i.patternType=HA[u>>26],n.cellStyles&&(i.alc=l&7,i.fWrap=l>>3&1,i.alcV=l>>4&7,i.fJustLast=l>>7&1,i.trot=l>>8&255,i.cIndent=l>>16&15,i.fShrinkToFit=l>>20&1,i.iReadOrder=l>>22&2,i.fAtrNum=l>>26&1,i.fAtrFnt=l>>27&1,i.fAtrAlc=l>>28&1,i.fAtrBdr=l>>29&1,i.fAtrPat=l>>30&1,i.fAtrProt=l>>31&1,i.dgLeft=o&15,i.dgRight=o>>4&15,i.dgTop=o>>8&15,i.dgBottom=o>>12&15,i.icvLeft=o>>16&127,i.icvRight=o>>23&127,i.grbitDiag=o>>30&3,i.icvTop=u&127,i.icvBottom=u>>7&127,i.icvDiag=u>>14&127,i.dgDiag=u>>21&15,i.icvFore=h&127,i.icvBack=h>>7&127,i.fsxButton=h>>14&1),i}function oC(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=cC(e,t,n.fStyle,r),n}function ry(e,t,r,n){var i=r&&r.biff==5;n||(n=pe(i?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var l=0;return e.numFmtId>0&&i&&(l|=1024),n.write_shift(4,l),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function uC(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function fC(e){var t=pe(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function ay(e,t,r){var n=En(e);(r.biff==2||t==9)&&++e.l;var i=m3(e);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function hC(e,t,r,n,i,l){var o=pe(8);return ks(e,t,n,o),t2(r,l,o),o}function dC(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=En(e),i=Xr(e);return n.val=i,n}function mC(e,t,r,n){var i=pe(14);return ks(e,t,n,i),Es(r,i),i}var ny=E3;function xC(e,t,r){var n=e.l+t,i=e.read_shift(2),l=e.read_shift(2);if(r.sbcch=l,l==1025||l==14849)return[l,i];if(l<1||l>255)throw new Error("Unexpected SupBook type: "+l);for(var o=Ts(e,l),u=[];n>e.l;)u.push(ko(e));return[l,i,o,u]}function iy(e,t,r){var n=e.read_shift(2),i,l={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=k3(e,t-2,r)),l.body=i||e.read_shift(t-2),typeof i=="string"&&(l.Name=i),l}var pC=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function sy(e,t,r){var n=e.l+t,i=e.read_shift(2),l=e.read_shift(1),o=e.read_shift(1),u=e.read_shift(r&&r.biff==2?1:2),h=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),h=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var d=Ts(e,o,r);i&32&&(d=pC[d.charCodeAt(0)]);var x=n-e.l;r&&r.biff==2&&--x;var g=n==e.l||u===0||!(x>0)?[]:RO(e,x,r,u);return{chKey:l,Name:d,itab:h,rgce:g}}function o2(e,t,r){if(r.biff<8)return gC(e,t,r);for(var n=[],i=e.l+t,l=e.read_shift(r.biff>8?4:2);l--!==0;)n.push(T3(e,r.biff>8?12:6,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function gC(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=To(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function vC(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),i=e.read_shift(2),l=Ts(e,n,r),o=Ts(e,i,r);return[l,o]}function yC(e,t,r){var n=l2(e);e.l++;var i=e.read_shift(1);return t-=8,[DO(e,t,r),i,n]}function ly(e,t,r){var n=A3(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,NO(e,t,r)]}function _C(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function wC(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),i=e.read_shift(2),l=e.read_shift(2),o=e.read_shift(2),u=Fs(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:i},u,o,l]}}function SC(e,t,r){return wC(e,t,r)}function bC(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(Mu(e));return r}function EC(e){var t=pe(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)s2(e[r],t);return t}function TC(e,t,r){if(r&&r.biff<8)return AC(e,t,r);var n=c2(e),i=R3(e,t-22,n[1]);return{cmo:n,ft:i}}var kC={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=r,{fmt:n}}};function AC(e,t,r){e.l+=4;var n=e.read_shift(2),i=e.read_shift(2),l=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((kC[n]||Kr)(e,t,r)),{cmo:[i,n,l],ft:o}}function CC(e,t,r){var n=e.l,i="";try{e.l+=4;var l=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(l)==-1?e.l+=6:o=g3(e,6,r);var u=e.read_shift(2);e.read_shift(2),yr(e,2);var h=e.read_shift(2);e.l+=h;for(var d=1;d<e.lens.length-1;++d){if(e.l-n!=e.lens[d])throw new Error("TxO: bad continue record");var x=e[e.l],g=Ts(e,e.lens[d+1]-e.lens[d]-1);if(i+=g,i.length>=(x?u:2*u))break}if(i.length!==u&&i.length!==u*2)throw new Error("cchText: "+u+" != "+i.length);return e.l=n+t,{t:i}}catch{return e.l=n+t,{t:i}}}function NC(e,t){var r=Mu(e);e.l+=16;var n=w3(e,t-24);return[r,n]}function OC(e){var t=pe(24),r=Zt(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)t.write_shift(1,parseInt(n[i],16));return Cr([t,S3(e[1])])}function RC(e,t){e.read_shift(2);var r=Mu(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(ta,""),[r,n]}function DC(e){var t=e[1].Tooltip,r=pe(10+2*(t.length+1));r.write_shift(2,2048);var n=Zt(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<t.length;++i)r.write_shift(2,t.charCodeAt(i));return r.write_shift(2,0),r}function FC(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=Gv[r]||r,r=e.read_shift(2),t[1]=Gv[r]||r,t}function MC(e){return e||(e=pe(4)),e.write_shift(2,1),e.write_shift(2,1),e}function BC(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(n2(e));return r}function LC(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(n2(e));return r}function IC(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function u2(e,t,r){if(!r.cellStyles)return Kr(e,t);var n=r&&r.biff>=12?4:2,i=e.read_shift(n),l=e.read_shift(n),o=e.read_shift(n),u=e.read_shift(n),h=e.read_shift(2);n==2&&(e.l+=2);var d={s:i,e:l,w:o,ixfe:u,flags:h};return(r.biff>=5||!r.biff)&&(d.level=h>>8&7),d}function UC(e,t){var r=pe(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function jC(e,t){var r={};return t<32||(e.l+=16,r.header=Xr(e),r.footer=Xr(e),e.l+=2),r}function PC(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var i=e.read_shift(1);return e.l+=3,i&16&&(n.area=!0),n}function zC(e){for(var t=pe(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var HC=En,VC=e2,$C=ko;function GC(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,i}function qC(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=En(e);++e.l;var i=Fs(e,t-7,r);return n.t="str",n.val=i,n}function XC(e){var t=En(e);++e.l;var r=Xr(e);return t.t="n",t.val=r,t}function WC(e,t,r){var n=pe(15);return Oo(n,e,t),n.write_shift(8,r,"f"),n}function KC(e){var t=En(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function YC(e,t,r){var n=pe(9);return Oo(n,e,t),n.write_shift(2,r),n}function JC(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function QC(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function ZC(e,t,r){var n=e.l+t,i=En(e),l=e.read_shift(2),o=Ts(e,l,r);return e.l=n,i.t="str",i.val=o,i}var e6=[2,3,48,49,131,139,140,245],Hd=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Ru({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(u,h){var d=[],x=Ui(1);switch(h.type){case"base64":x=Ca(Oa(u));break;case"binary":x=Ca(u);break;case"buffer":case"array":x=u;break}Ur(x,0);var g=x.read_shift(1),v=!!(g&136),_=!1,w=!1;switch(g){case 2:break;case 3:break;case 48:_=!0,v=!0;break;case 49:_=!0,v=!0;break;case 131:break;case 139:break;case 140:w=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+g.toString(16))}var y=0,b=521;g==2&&(y=x.read_shift(2)),x.l+=3,g!=2&&(y=x.read_shift(4)),y>1048576&&(y=1e6),g!=2&&(b=x.read_shift(2));var A=x.read_shift(2),M=h.codepage||1252;g!=2&&(x.l+=16,x.read_shift(1),x[x.l]!==0&&(M=e[x[x.l]]),x.l+=1,x.l+=2),w&&(x.l+=36);for(var T=[],U={},q=Math.min(x.length,g==2?521:b-10-(_?264:0)),I=w?32:11;x.l<q&&x[x.l]!=13;)switch(U={},U.name=io.utils.decode(M,x.slice(x.l,x.l+I)).replace(/[\u0000\r\n].*$/g,""),x.l+=I,U.type=String.fromCharCode(x.read_shift(1)),g!=2&&!w&&(U.offset=x.read_shift(4)),U.len=x.read_shift(1),g==2&&(U.offset=x.read_shift(2)),U.dec=x.read_shift(1),U.name.length&&T.push(U),g!=2&&(x.l+=w?13:14),U.type){case"B":(!_||U.len!=8)&&h.WTF&&console.log("Skipping "+U.name+":"+U.type);break;case"G":case"P":h.WTF&&console.log("Skipping "+U.name+":"+U.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+U.type)}if(x[x.l]!==13&&(x.l=b-1),x.read_shift(1)!==13)throw new Error("DBF Terminator not found "+x.l+" "+x[x.l]);x.l=b;var R=0,Q=0;for(d[0]=[],Q=0;Q!=T.length;++Q)d[0][Q]=T[Q].name;for(;y-- >0;){if(x[x.l]===42){x.l+=A;continue}for(++x.l,d[++R]=[],Q=0,Q=0;Q!=T.length;++Q){var G=x.slice(x.l,x.l+T[Q].len);x.l+=T[Q].len,Ur(G,0);var ae=io.utils.decode(M,G);switch(T[Q].type){case"C":ae.trim().length&&(d[R][Q]=ae.replace(/\s+$/,""));break;case"D":ae.length===8?d[R][Q]=new Date(+ae.slice(0,4),+ae.slice(4,6)-1,+ae.slice(6,8)):d[R][Q]=ae;break;case"F":d[R][Q]=parseFloat(ae.trim());break;case"+":case"I":d[R][Q]=w?G.read_shift(-4,"i")^2147483648:G.read_shift(4,"i");break;case"L":switch(ae.trim().toUpperCase()){case"Y":case"T":d[R][Q]=!0;break;case"N":case"F":d[R][Q]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+ae+"|")}break;case"M":if(!v)throw new Error("DBF Unexpected MEMO for type "+g.toString(16));d[R][Q]="##MEMO##"+(w?parseInt(ae.trim(),10):G.read_shift(4));break;case"N":ae=ae.replace(/\u0000/g,"").trim(),ae&&ae!="."&&(d[R][Q]=+ae||0);break;case"@":d[R][Q]=new Date(G.read_shift(-8,"f")-621356832e5);break;case"T":d[R][Q]=new Date((G.read_shift(4)-2440588)*864e5+G.read_shift(4));break;case"Y":d[R][Q]=G.read_shift(4,"i")/1e4+G.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[R][Q]=-G.read_shift(-8,"f");break;case"B":if(_&&T[Q].len==8){d[R][Q]=G.read_shift(8,"f");break}case"G":case"P":G.l+=T[Q].len;break;case"0":if(T[Q].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+T[Q].type)}}}if(g!=2&&x.l<x.length&&x[x.l++]!=26)throw new Error("DBF EOF Marker missing "+(x.l-1)+" of "+x.length+" "+x[x.l-1].toString(16));return h&&h.sheetRows&&(d=d.slice(0,h.sheetRows)),h.DBF=T,d}function n(u,h){var d=h||{};d.dateNF||(d.dateNF="yyyymmdd");var x=$l(r(u,d),d);return x["!cols"]=d.DBF.map(function(g){return{wch:g.len,DBF:g}}),delete d.DBF,x}function i(u,h){try{return Vi(n(u,h),h)}catch(d){if(h&&h.WTF)throw d}return{SheetNames:[],Sheets:{}}}var l={B:8,C:250,L:1,D:8,"?":0,"":0};function o(u,h){var d=h||{};if(+d.codepage>=0&&cn(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var x=ha(),g=Tu(u,{header:1,raw:!0,cellDates:!0}),v=g[0],_=g.slice(1),w=u["!cols"]||[],y=0,b=0,A=0,M=1;for(y=0;y<v.length;++y){if(((w[y]||{}).DBF||{}).name){v[y]=w[y].DBF.name,++A;continue}if(v[y]!=null){if(++A,typeof v[y]=="number"&&(v[y]=v[y].toString(10)),typeof v[y]!="string")throw new Error("DBF Invalid column name "+v[y]+" |"+typeof v[y]+"|");if(v.indexOf(v[y])!==y){for(b=0;b<1024;++b)if(v.indexOf(v[y]+"_"+b)==-1){v[y]+="_"+b;break}}}}var T=gt(u["!ref"]),U=[],q=[],I=[];for(y=0;y<=T.e.c-T.s.c;++y){var R="",Q="",G=0,ae=[];for(b=0;b<_.length;++b)_[b][y]!=null&&ae.push(_[b][y]);if(ae.length==0||v[y]==null){U[y]="?";continue}for(b=0;b<ae.length;++b){switch(typeof ae[b]){case"number":Q="B";break;case"string":Q="C";break;case"boolean":Q="L";break;case"object":Q=ae[b]instanceof Date?"D":"C";break;default:Q="C"}G=Math.max(G,String(ae[b]).length),R=R&&R!=Q?"C":Q}G>250&&(G=250),Q=((w[y]||{}).DBF||{}).type,Q=="C"&&w[y].DBF.len>G&&(G=w[y].DBF.len),R=="B"&&Q=="N"&&(R="N",I[y]=w[y].DBF.dec,G=w[y].DBF.len),q[y]=R=="C"||Q=="N"?G:l[R]||0,M+=q[y],U[y]=R}var ne=x.next(32);for(ne.write_shift(4,318902576),ne.write_shift(4,_.length),ne.write_shift(2,296+32*A),ne.write_shift(2,M),y=0;y<4;++y)ne.write_shift(4,0);for(ne.write_shift(4,0|(+t[Zy]||3)<<8),y=0,b=0;y<v.length;++y)if(v[y]!=null){var J=x.next(32),ge=(v[y].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);J.write_shift(1,ge,"sbcs"),J.write_shift(1,U[y]=="?"?"C":U[y],"sbcs"),J.write_shift(4,b),J.write_shift(1,q[y]||l[U[y]]||0),J.write_shift(1,I[y]||0),J.write_shift(1,2),J.write_shift(4,0),J.write_shift(1,0),J.write_shift(4,0),J.write_shift(4,0),b+=q[y]||l[U[y]]||0}var ke=x.next(264);for(ke.write_shift(4,13),y=0;y<65;++y)ke.write_shift(4,0);for(y=0;y<_.length;++y){var be=x.next(M);for(be.write_shift(1,0),b=0;b<v.length;++b)if(v[b]!=null)switch(U[b]){case"L":be.write_shift(1,_[y][b]==null?63:_[y][b]?84:70);break;case"B":be.write_shift(8,_[y][b]||0,"f");break;case"N":var Y="0";for(typeof _[y][b]=="number"&&(Y=_[y][b].toFixed(I[b]||0)),A=0;A<q[b]-Y.length;++A)be.write_shift(1,32);be.write_shift(1,Y,"sbcs");break;case"D":_[y][b]?(be.write_shift(4,("0000"+_[y][b].getFullYear()).slice(-4),"sbcs"),be.write_shift(2,("00"+(_[y][b].getMonth()+1)).slice(-2),"sbcs"),be.write_shift(2,("00"+_[y][b].getDate()).slice(-2),"sbcs")):be.write_shift(8,"00000000","sbcs");break;case"C":var le=String(_[y][b]!=null?_[y][b]:"").slice(0,q[b]);for(be.write_shift(1,le,"sbcs"),A=0;A<q[b]-le.length;++A)be.write_shift(1,32);break}}return x.next(1).write_shift(1,26),x.end()}return{to_workbook:i,to_sheet:n,from_sheet:o}})(),f2=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+ir(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(v,_){var w=e[_];return typeof w=="number"?vv(w):w},n=function(v,_,w){var y=_.charCodeAt(0)-32<<4|w.charCodeAt(0)-48;return y==59?v:vv(y)};e["|"]=254;function i(v,_){switch(_.type){case"base64":return l(Oa(v),_);case"binary":return l(v,_);case"buffer":return l(ct&&Buffer.isBuffer(v)?v.toString("binary"):Hi(v),_);case"array":return l(bs(v),_)}throw new Error("Unrecognized type "+_.type)}function l(v,_){var w=v.split(/[\n\r]+/),y=-1,b=-1,A=0,M=0,T=[],U=[],q=null,I={},R=[],Q=[],G=[],ae=0,ne;for(+_.codepage>=0&&cn(+_.codepage);A!==w.length;++A){ae=0;var J=w[A].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),ge=J.replace(/;;/g,"\0").split(";").map(function(V){return V.replace(/\u0000/g,";")}),ke=ge[0],be;if(J.length>0)switch(ke){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ge[1].charAt(0)=="P"&&U.push(J.slice(3).replace(/;;/g,";"));break;case"C":var Y=!1,le=!1,_e=!1,Z=!1,De=-1,j=-1;for(M=1;M<ge.length;++M)switch(ge[M].charAt(0)){case"A":break;case"X":b=parseInt(ge[M].slice(1))-1,le=!0;break;case"Y":for(y=parseInt(ge[M].slice(1))-1,le||(b=0),ne=T.length;ne<=y;++ne)T[ne]=[];break;case"K":be=ge[M].slice(1),be.charAt(0)==='"'?be=be.slice(1,be.length-1):be==="TRUE"?be=!0:be==="FALSE"?be=!1:isNaN(un(be))?isNaN(Ul(be).getDate())||(be=Gt(be)):(be=un(be),q!==null&&Hl(q)&&(be=Fu(be))),Y=!0;break;case"E":Z=!0;var N=Bl(ge[M].slice(1),{r:y,c:b});T[y][b]=[T[y][b],N];break;case"S":_e=!0,T[y][b]=[T[y][b],"S5S"];break;case"G":break;case"R":De=parseInt(ge[M].slice(1))-1;break;case"C":j=parseInt(ge[M].slice(1))-1;break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+J)}if(Y&&(T[y][b]&&T[y][b].length==2?T[y][b][0]=be:T[y][b]=be,q=null),_e){if(Z)throw new Error("SYLK shared formula cannot have own formula");var z=De>-1&&T[De][j];if(!z||!z[1])throw new Error("SYLK shared formula cannot find base");T[y][b][1]=N2(z[1],{r:y-De,c:b-j})}break;case"F":var P=0;for(M=1;M<ge.length;++M)switch(ge[M].charAt(0)){case"X":b=parseInt(ge[M].slice(1))-1,++P;break;case"Y":for(y=parseInt(ge[M].slice(1))-1,ne=T.length;ne<=y;++ne)T[ne]=[];break;case"M":ae=parseInt(ge[M].slice(1))/20;break;case"F":break;case"G":break;case"P":q=U[parseInt(ge[M].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(G=ge[M].slice(1).split(" "),ne=parseInt(G[0],10);ne<=parseInt(G[1],10);++ne)ae=parseInt(G[2],10),Q[ne-1]=ae===0?{hidden:!0}:{wch:ae},ji(Q[ne-1]);break;case"C":b=parseInt(ge[M].slice(1))-1,Q[b]||(Q[b]={});break;case"R":y=parseInt(ge[M].slice(1))-1,R[y]||(R[y]={}),ae>0?(R[y].hpt=ae,R[y].hpx=Pl(ae)):ae===0&&(R[y].hidden=!0);break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+J)}P<1&&(q=null);break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+J)}}return R.length>0&&(I["!rows"]=R),Q.length>0&&(I["!cols"]=Q),_&&_.sheetRows&&(T=T.slice(0,_.sheetRows)),[T,I]}function o(v,_){var w=i(v,_),y=w[0],b=w[1],A=$l(y,_);return ir(b).forEach(function(M){A[M]=b[M]}),A}function u(v,_){return Vi(o(v,_),_)}function h(v,_,w,y){var b="C;Y"+(w+1)+";X"+(y+1)+";K";switch(v.t){case"n":b+=v.v||0,v.f&&!v.F&&(b+=";E"+R1(v.f,{r:w,c:y}));break;case"b":b+=v.v?"TRUE":"FALSE";break;case"e":b+=v.w||v.v;break;case"d":b+='"'+(v.w||v.v)+'"';break;case"s":b+='"'+v.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return b}function d(v,_){_.forEach(function(w,y){var b="F;W"+(y+1)+" "+(y+1)+" ";w.hidden?b+="0":(typeof w.width=="number"&&!w.wpx&&(w.wpx=mo(w.width)),typeof w.wpx=="number"&&!w.wch&&(w.wch=xo(w.wpx)),typeof w.wch=="number"&&(b+=Math.round(w.wch))),b.charAt(b.length-1)!=" "&&v.push(b)})}function x(v,_){_.forEach(function(w,y){var b="F;";w.hidden?b+="M0;":w.hpt?b+="M"+20*w.hpt+";":w.hpx&&(b+="M"+20*po(w.hpx)+";"),b.length>2&&v.push(b+"R"+(y+1))})}function g(v,_){var w=["ID;PWXL;N;E"],y=[],b=gt(v["!ref"]),A,M=Array.isArray(v),T=`\r
`;w.push("P;PGeneral"),w.push("F;P0;DG0G8;M255"),v["!cols"]&&d(w,v["!cols"]),v["!rows"]&&x(w,v["!rows"]),w.push("B;Y"+(b.e.r-b.s.r+1)+";X"+(b.e.c-b.s.c+1)+";D"+[b.s.c,b.s.r,b.e.c,b.e.r].join(" "));for(var U=b.s.r;U<=b.e.r;++U)for(var q=b.s.c;q<=b.e.c;++q){var I=Ze({r:U,c:q});A=M?(v[U]||[])[q]:v[I],!(!A||A.v==null&&(!A.f||A.F))&&y.push(h(A,v,U,q))}return w.join(T)+T+y.join(T)+T+"E"+T}return{to_workbook:u,to_sheet:o,from_sheet:g}})(),h2=(function(){function e(l,o){switch(o.type){case"base64":return t(Oa(l),o);case"binary":return t(l,o);case"buffer":return t(ct&&Buffer.isBuffer(l)?l.toString("binary"):Hi(l),o);case"array":return t(bs(l),o)}throw new Error("Unrecognized type "+o.type)}function t(l,o){for(var u=l.split(`
`),h=-1,d=-1,x=0,g=[];x!==u.length;++x){if(u[x].trim()==="BOT"){g[++h]=[],d=0;continue}if(!(h<0)){var v=u[x].trim().split(","),_=v[0],w=v[1];++x;for(var y=u[x]||"";(y.match(/["]/g)||[]).length&1&&x<u.length-1;)y+=`
`+u[++x];switch(y=y.trim(),+_){case-1:if(y==="BOT"){g[++h]=[],d=0;continue}else if(y!=="EOD")throw new Error("Unrecognized DIF special command "+y);break;case 0:y==="TRUE"?g[h][d]=!0:y==="FALSE"?g[h][d]=!1:isNaN(un(w))?isNaN(Ul(w).getDate())?g[h][d]=w:g[h][d]=Gt(w):g[h][d]=un(w),++d;break;case 1:y=y.slice(1,y.length-1),y=y.replace(/""/g,'"'),y&&y.match(/^=".*"$/)&&(y=y.slice(2,-1)),g[h][d++]=y!==""?y:null;break}if(y==="EOD")break}}return o&&o.sheetRows&&(g=g.slice(0,o.sheetRows)),g}function r(l,o){return $l(e(l,o),o)}function n(l,o){return Vi(r(l,o),o)}var i=(function(){var l=function(h,d,x,g,v){h.push(d),h.push(x+","+g),h.push('"'+v.replace(/"/g,'""')+'"')},o=function(h,d,x,g){h.push(d+","+x),h.push(d==1?'"'+g.replace(/"/g,'""')+'"':g)};return function(h){var d=[],x=gt(h["!ref"]),g,v=Array.isArray(h);l(d,"TABLE",0,1,"sheetjs"),l(d,"VECTORS",0,x.e.r-x.s.r+1,""),l(d,"TUPLES",0,x.e.c-x.s.c+1,""),l(d,"DATA",0,0,"");for(var _=x.s.r;_<=x.e.r;++_){o(d,-1,0,"BOT");for(var w=x.s.c;w<=x.e.c;++w){var y=Ze({r:_,c:w});if(g=v?(h[_]||[])[w]:h[y],!g){o(d,1,0,"");continue}switch(g.t){case"n":var b=g.w;!b&&g.v!=null&&(b=g.v),b==null?g.f&&!g.F?o(d,1,0,"="+g.f):o(d,1,0,""):o(d,0,b,"V");break;case"b":o(d,0,g.v?1:0,g.v?"TRUE":"FALSE");break;case"s":o(d,1,0,isNaN(g.v)?g.v:'="'+g.v+'"');break;case"d":g.w||(g.w=Ya(g.z||Je[14],Er(Gt(g.v)))),o(d,0,g.w,"V");break;default:o(d,1,0,"")}}}o(d,-1,0,"EOD");var A=`\r
`,M=d.join(A);return M}})();return{to_workbook:n,to_sheet:r,from_sheet:i}})(),d2=(function(){function e(g){return g.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(g){return g.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(g,v){for(var _=g.split(`
`),w=-1,y=-1,b=0,A=[];b!==_.length;++b){var M=_[b].trim().split(":");if(M[0]==="cell"){var T=Zt(M[1]);if(A.length<=T.r)for(w=A.length;w<=T.r;++w)A[w]||(A[w]=[]);switch(w=T.r,y=T.c,M[2]){case"t":A[w][y]=e(M[3]);break;case"v":A[w][y]=+M[3];break;case"vtf":var U=M[M.length-1];case"vtc":M[3]==="nl"?A[w][y]=!!+M[4]:A[w][y]=+M[4],M[2]=="vtf"&&(A[w][y]=[A[w][y],U])}}}return v&&v.sheetRows&&(A=A.slice(0,v.sheetRows)),A}function n(g,v){return $l(r(g,v),v)}function i(g,v){return Vi(n(g,v),v)}var l=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),h="--SocialCalcSpreadsheetControlSave--";function d(g){if(!g||!g["!ref"])return"";for(var v=[],_=[],w,y="",b=da(g["!ref"]),A=Array.isArray(g),M=b.s.r;M<=b.e.r;++M)for(var T=b.s.c;T<=b.e.c;++T)if(y=Ze({r:M,c:T}),w=A?(g[M]||[])[T]:g[y],!(!w||w.v==null||w.t==="z")){switch(_=["cell",y,"t"],w.t){case"s":case"str":_.push(t(w.v));break;case"n":w.f?(_[2]="vtf",_[3]="n",_[4]=w.v,_[5]=t(w.f)):(_[2]="v",_[3]=w.v);break;case"b":_[2]="vt"+(w.f?"f":"c"),_[3]="nl",_[4]=w.v?"1":"0",_[5]=t(w.f||(w.v?"TRUE":"FALSE"));break;case"d":var U=Er(Gt(w.v));_[2]="vtc",_[3]="nd",_[4]=""+U,_[5]=w.w||Ya(w.z||Je[14],U);break;case"e":continue}v.push(_.join(":"))}return v.push("sheet:c:"+(b.e.c-b.s.c+1)+":r:"+(b.e.r-b.s.r+1)+":tvf:1"),v.push("valueformat:1:text-wiki"),v.join(`
`)}function x(g){return[l,o,u,o,d(g),h].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:x}})(),jl=(function(){function e(x,g,v,_,w){w.raw?g[v][_]=x:x===""||(x==="TRUE"?g[v][_]=!0:x==="FALSE"?g[v][_]=!1:isNaN(un(x))?isNaN(Ul(x).getDate())?g[v][_]=x:g[v][_]=Gt(x):g[v][_]=un(x))}function t(x,g){var v=g||{},_=[];if(!x||x.length===0)return _;for(var w=x.split(/[\r\n]/),y=w.length-1;y>=0&&w[y].length===0;)--y;for(var b=10,A=0,M=0;M<=y;++M)A=w[M].indexOf(" "),A==-1?A=w[M].length:A++,b=Math.max(b,A);for(M=0;M<=y;++M){_[M]=[];var T=0;for(e(w[M].slice(0,b).trim(),_,M,T,v),T=1;T<=(w[M].length-b)/10+1;++T)e(w[M].slice(b+(T-1)*10,b+T*10).trim(),_,M,T,v)}return v.sheetRows&&(_=_.slice(0,v.sheetRows)),_}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(x){for(var g={},v=!1,_=0,w=0;_<x.length;++_)(w=x.charCodeAt(_))==34?v=!v:!v&&w in r&&(g[w]=(g[w]||0)+1);w=[];for(_ in g)Object.prototype.hasOwnProperty.call(g,_)&&w.push([g[_],_]);if(!w.length){g=n;for(_ in g)Object.prototype.hasOwnProperty.call(g,_)&&w.push([g[_],_])}return w.sort(function(y,b){return y[0]-b[0]||n[y[1]]-n[b[1]]}),r[w.pop()[1]]||44}function l(x,g){var v=g||{},_="",w=v.dense?[]:{},y={s:{c:0,r:0},e:{c:0,r:0}};x.slice(0,4)=="sep="?x.charCodeAt(5)==13&&x.charCodeAt(6)==10?(_=x.charAt(4),x=x.slice(7)):x.charCodeAt(5)==13||x.charCodeAt(5)==10?(_=x.charAt(4),x=x.slice(6)):_=i(x.slice(0,1024)):v&&v.FS?_=v.FS:_=i(x.slice(0,1024));var b=0,A=0,M=0,T=0,U=0,q=_.charCodeAt(0),I=!1,R=0,Q=x.charCodeAt(0);x=x.replace(/\r\n/mg,`
`);var G=v.dateNF!=null?Pk(v.dateNF):null;function ae(){var ne=x.slice(T,U),J={};if(ne.charAt(0)=='"'&&ne.charAt(ne.length-1)=='"'&&(ne=ne.slice(1,-1).replace(/""/g,'"')),ne.length===0)J.t="z";else if(v.raw)J.t="s",J.v=ne;else if(ne.trim().length===0)J.t="s",J.v=ne;else if(ne.charCodeAt(0)==61)ne.charCodeAt(1)==34&&ne.charCodeAt(ne.length-1)==34?(J.t="s",J.v=ne.slice(2,-1).replace(/""/g,'"')):xN(ne)?(J.t="n",J.f=ne.slice(1)):(J.t="s",J.v=ne);else if(ne=="TRUE")J.t="b",J.v=!0;else if(ne=="FALSE")J.t="b",J.v=!1;else if(!isNaN(M=un(ne)))J.t="n",v.cellText!==!1&&(J.w=ne),J.v=M;else if(!isNaN(Ul(ne).getDate())||G&&ne.match(G)){J.z=v.dateNF||Je[14];var ge=0;G&&ne.match(G)&&(ne=zk(ne,v.dateNF,ne.match(G)||[]),ge=1),v.cellDates?(J.t="d",J.v=Gt(ne,ge)):(J.t="n",J.v=Er(Gt(ne,ge))),v.cellText!==!1&&(J.w=Ya(J.z,J.v instanceof Date?Er(J.v):J.v)),v.cellNF||delete J.z}else J.t="s",J.v=ne;if(J.t=="z"||(v.dense?(w[b]||(w[b]=[]),w[b][A]=J):w[Ze({c:A,r:b})]=J),T=U+1,Q=x.charCodeAt(T),y.e.c<A&&(y.e.c=A),y.e.r<b&&(y.e.r=b),R==q)++A;else if(A=0,++b,v.sheetRows&&v.sheetRows<=b)return!0}e:for(;U<x.length;++U)switch(R=x.charCodeAt(U)){case 34:Q===34&&(I=!I);break;case q:case 10:case 13:if(!I&&ae())break e;break}return U-T>0&&ae(),w["!ref"]=it(y),w}function o(x,g){return!(g&&g.PRN)||g.FS||x.slice(0,4)=="sep="||x.indexOf("	")>=0||x.indexOf(",")>=0||x.indexOf(";")>=0?l(x,g):$l(t(x,g),g)}function u(x,g){var v="",_=g.type=="string"?[0,0,0,0]:j1(x,g);switch(g.type){case"base64":v=Oa(x);break;case"binary":v=x;break;case"buffer":g.codepage==65001?v=x.toString("utf8"):g.codepage&&typeof io<"u"||(v=ct&&Buffer.isBuffer(x)?x.toString("binary"):Hi(x));break;case"array":v=bs(x);break;case"string":v=x;break;default:throw new Error("Unrecognized type "+g.type)}return _[0]==239&&_[1]==187&&_[2]==191?v=Lt(v.slice(3)):g.type!="string"&&g.type!="buffer"&&g.codepage==65001?v=Lt(v):g.type=="binary"&&typeof io<"u",v.slice(0,19)=="socialcalc:version:"?d2.to_sheet(g.type=="string"?v:Lt(v),g):o(v,g)}function h(x,g){return Vi(u(x,g),g)}function d(x){for(var g=[],v=gt(x["!ref"]),_,w=Array.isArray(x),y=v.s.r;y<=v.e.r;++y){for(var b=[],A=v.s.c;A<=v.e.c;++A){var M=Ze({r:y,c:A});if(_=w?(x[y]||[])[A]:x[M],!_||_.v==null){b.push("          ");continue}for(var T=(_.w||(Qn(_),_.w)||"").slice(0,10);T.length<10;)T+=" ";b.push(T+(A===0?" ":""))}g.push(b.join(""))}return g.join(`
`)}return{to_workbook:h,to_sheet:u,from_sheet:d}})();function t6(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var i=f2.to_workbook(e,r);return r.WTF=n,i}catch(l){if(r.WTF=n,!l.message.match(/SYLK bad record ID/)&&n)throw l;return jl.to_workbook(e,t)}}var _s=(function(){function e(N,z,P){if(N){Ur(N,N.l||0);for(var V=P.Enum||De;N.l<N.length;){var ce=N.read_shift(2),we=V[ce]||V[65535],Ce=N.read_shift(2),Ee=N.l+Ce,Oe=we.f&&we.f(N,Ce,P);if(N.l=Ee,z(Oe,we,ce))return}}}function t(N,z){switch(z.type){case"base64":return r(Ca(Oa(N)),z);case"binary":return r(Ca(N),z);case"buffer":case"array":return r(N,z)}throw"Unsupported type "+z.type}function r(N,z){if(!N)return N;var P=z||{},V=P.dense?[]:{},ce="Sheet1",we="",Ce=0,Ee={},Oe=[],Qe=[],H={s:{r:0,c:0},e:{r:0,c:0}},St=P.sheetRows||0;if(N[2]==0&&(N[3]==8||N[3]==9)&&N.length>=16&&N[14]==5&&N[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(N[2]==2)P.Enum=De,e(N,function(Ue,Ut,Tr){switch(Tr){case 0:P.vers=Ue,Ue>=4096&&(P.qpro=!0);break;case 6:H=Ue;break;case 204:Ue&&(we=Ue);break;case 222:we=Ue;break;case 15:case 51:P.qpro||(Ue[1].v=Ue[1].v.slice(1));case 13:case 14:case 16:Tr==14&&(Ue[2]&112)==112&&(Ue[2]&15)>1&&(Ue[2]&15)<15&&(Ue[1].z=P.dateNF||Je[14],P.cellDates&&(Ue[1].t="d",Ue[1].v=Fu(Ue[1].v))),P.qpro&&Ue[3]>Ce&&(V["!ref"]=it(H),Ee[ce]=V,Oe.push(ce),V=P.dense?[]:{},H={s:{r:0,c:0},e:{r:0,c:0}},Ce=Ue[3],ce=we||"Sheet"+(Ce+1),we="");var Pr=P.dense?(V[Ue[0].r]||[])[Ue[0].c]:V[Ze(Ue[0])];if(Pr){Pr.t=Ue[1].t,Pr.v=Ue[1].v,Ue[1].z!=null&&(Pr.z=Ue[1].z),Ue[1].f!=null&&(Pr.f=Ue[1].f);break}P.dense?(V[Ue[0].r]||(V[Ue[0].r]=[]),V[Ue[0].r][Ue[0].c]=Ue[1]):V[Ze(Ue[0])]=Ue[1];break}},P);else if(N[2]==26||N[2]==14)P.Enum=j,N[2]==14&&(P.qpro=!0,N.l=0),e(N,function(Ue,Ut,Tr){switch(Tr){case 204:ce=Ue;break;case 22:Ue[1].v=Ue[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ue[3]>Ce&&(V["!ref"]=it(H),Ee[ce]=V,Oe.push(ce),V=P.dense?[]:{},H={s:{r:0,c:0},e:{r:0,c:0}},Ce=Ue[3],ce="Sheet"+(Ce+1)),St>0&&Ue[0].r>=St)break;P.dense?(V[Ue[0].r]||(V[Ue[0].r]=[]),V[Ue[0].r][Ue[0].c]=Ue[1]):V[Ze(Ue[0])]=Ue[1],H.e.c<Ue[0].c&&(H.e.c=Ue[0].c),H.e.r<Ue[0].r&&(H.e.r=Ue[0].r);break;case 27:Ue[14e3]&&(Qe[Ue[14e3][0]]=Ue[14e3][1]);break;case 1537:Qe[Ue[0]]=Ue[1],Ue[0]==Ce&&(ce=Ue[1]);break}},P);else throw new Error("Unrecognized LOTUS BOF "+N[2]);if(V["!ref"]=it(H),Ee[we||ce]=V,Oe.push(we||ce),!Qe.length)return{SheetNames:Oe,Sheets:Ee};for(var tt={},xt=[],We=0;We<Qe.length;++We)Ee[Oe[We]]?(xt.push(Qe[We]||Oe[We]),tt[Qe[We]]=Ee[Qe[We]]||Ee[Oe[We]]):(xt.push(Qe[We]),tt[Qe[We]]={"!ref":"A1"});return{SheetNames:xt,Sheets:tt}}function n(N,z){var P=z||{};if(+P.codepage>=0&&cn(+P.codepage),P.type=="string")throw new Error("Cannot write WK1 to JS string");var V=ha(),ce=gt(N["!ref"]),we=Array.isArray(N),Ce=[];Ie(V,0,l(1030)),Ie(V,6,h(ce));for(var Ee=Math.min(ce.e.r,8191),Oe=ce.s.r;Oe<=Ee;++Oe)for(var Qe=or(Oe),H=ce.s.c;H<=ce.e.c;++H){Oe===ce.s.r&&(Ce[H]=Qt(H));var St=Ce[H]+Qe,tt=we?(N[Oe]||[])[H]:N[St];if(!(!tt||tt.t=="z"))if(tt.t=="n")(tt.v|0)==tt.v&&tt.v>=-32768&&tt.v<=32767?Ie(V,13,_(Oe,H,tt.v)):Ie(V,14,y(Oe,H,tt.v));else{var xt=Qn(tt);Ie(V,15,g(Oe,H,xt.slice(0,239)))}}return Ie(V,1),V.end()}function i(N,z){var P=z||{};if(+P.codepage>=0&&cn(+P.codepage),P.type=="string")throw new Error("Cannot write WK3 to JS string");var V=ha();Ie(V,0,o(N));for(var ce=0,we=0;ce<N.SheetNames.length;++ce)(N.Sheets[N.SheetNames[ce]]||{})["!ref"]&&Ie(V,27,Z(N.SheetNames[ce],we++));var Ce=0;for(ce=0;ce<N.SheetNames.length;++ce){var Ee=N.Sheets[N.SheetNames[ce]];if(!(!Ee||!Ee["!ref"])){for(var Oe=gt(Ee["!ref"]),Qe=Array.isArray(Ee),H=[],St=Math.min(Oe.e.r,8191),tt=Oe.s.r;tt<=St;++tt)for(var xt=or(tt),We=Oe.s.c;We<=Oe.e.c;++We){tt===Oe.s.r&&(H[We]=Qt(We));var Ue=H[We]+xt,Ut=Qe?(Ee[tt]||[])[We]:Ee[Ue];if(!(!Ut||Ut.t=="z"))if(Ut.t=="n")Ie(V,23,ae(tt,We,Ce,Ut.v));else{var Tr=Qn(Ut);Ie(V,22,R(tt,We,Ce,Tr.slice(0,239)))}}++Ce}}return Ie(V,1),V.end()}function l(N){var z=pe(2);return z.write_shift(2,N),z}function o(N){var z=pe(26);z.write_shift(2,4096),z.write_shift(2,4),z.write_shift(4,0);for(var P=0,V=0,ce=0,we=0;we<N.SheetNames.length;++we){var Ce=N.SheetNames[we],Ee=N.Sheets[Ce];if(!(!Ee||!Ee["!ref"])){++ce;var Oe=da(Ee["!ref"]);P<Oe.e.r&&(P=Oe.e.r),V<Oe.e.c&&(V=Oe.e.c)}}return P>8191&&(P=8191),z.write_shift(2,P),z.write_shift(1,ce),z.write_shift(1,V),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(1,1),z.write_shift(1,2),z.write_shift(4,0),z.write_shift(4,0),z}function u(N,z,P){var V={s:{c:0,r:0},e:{c:0,r:0}};return z==8&&P.qpro?(V.s.c=N.read_shift(1),N.l++,V.s.r=N.read_shift(2),V.e.c=N.read_shift(1),N.l++,V.e.r=N.read_shift(2),V):(V.s.c=N.read_shift(2),V.s.r=N.read_shift(2),z==12&&P.qpro&&(N.l+=2),V.e.c=N.read_shift(2),V.e.r=N.read_shift(2),z==12&&P.qpro&&(N.l+=2),V.s.c==65535&&(V.s.c=V.e.c=V.s.r=V.e.r=0),V)}function h(N){var z=pe(8);return z.write_shift(2,N.s.c),z.write_shift(2,N.s.r),z.write_shift(2,N.e.c),z.write_shift(2,N.e.r),z}function d(N,z,P){var V=[{c:0,r:0},{t:"n",v:0},0,0];return P.qpro&&P.vers!=20768?(V[0].c=N.read_shift(1),V[3]=N.read_shift(1),V[0].r=N.read_shift(2),N.l+=2):(V[2]=N.read_shift(1),V[0].c=N.read_shift(2),V[0].r=N.read_shift(2)),V}function x(N,z,P){var V=N.l+z,ce=d(N,z,P);if(ce[1].t="s",P.vers==20768){N.l++;var we=N.read_shift(1);return ce[1].v=N.read_shift(we,"utf8"),ce}return P.qpro&&N.l++,ce[1].v=N.read_shift(V-N.l,"cstr"),ce}function g(N,z,P){var V=pe(7+P.length);V.write_shift(1,255),V.write_shift(2,z),V.write_shift(2,N),V.write_shift(1,39);for(var ce=0;ce<V.length;++ce){var we=P.charCodeAt(ce);V.write_shift(1,we>=128?95:we)}return V.write_shift(1,0),V}function v(N,z,P){var V=d(N,z,P);return V[1].v=N.read_shift(2,"i"),V}function _(N,z,P){var V=pe(7);return V.write_shift(1,255),V.write_shift(2,z),V.write_shift(2,N),V.write_shift(2,P,"i"),V}function w(N,z,P){var V=d(N,z,P);return V[1].v=N.read_shift(8,"f"),V}function y(N,z,P){var V=pe(13);return V.write_shift(1,255),V.write_shift(2,z),V.write_shift(2,N),V.write_shift(8,P,"f"),V}function b(N,z,P){var V=N.l+z,ce=d(N,z,P);if(ce[1].v=N.read_shift(8,"f"),P.qpro)N.l=V;else{var we=N.read_shift(2);U(N.slice(N.l,N.l+we),ce),N.l+=we}return ce}function A(N,z,P){var V=z&32768;return z&=-32769,z=(V?N:0)+(z>=8192?z-16384:z),(V?"":"$")+(P?Qt(z):or(z))}var M={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},T=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function U(N,z){Ur(N,0);for(var P=[],V=0,ce="",we="",Ce="",Ee="";N.l<N.length;){var Oe=N[N.l++];switch(Oe){case 0:P.push(N.read_shift(8,"f"));break;case 1:we=A(z[0].c,N.read_shift(2),!0),ce=A(z[0].r,N.read_shift(2),!1),P.push(we+ce);break;case 2:{var Qe=A(z[0].c,N.read_shift(2),!0),H=A(z[0].r,N.read_shift(2),!1);we=A(z[0].c,N.read_shift(2),!0),ce=A(z[0].r,N.read_shift(2),!1),P.push(Qe+H+":"+we+ce)}break;case 3:if(N.l<N.length){console.error("WK1 premature formula end");return}break;case 4:P.push("("+P.pop()+")");break;case 5:P.push(N.read_shift(2));break;case 6:{for(var St="";Oe=N[N.l++];)St+=String.fromCharCode(Oe);P.push('"'+St.replace(/"/g,'""')+'"')}break;case 8:P.push("-"+P.pop());break;case 23:P.push("+"+P.pop());break;case 22:P.push("NOT("+P.pop()+")");break;case 20:case 21:Ee=P.pop(),Ce=P.pop(),P.push(["AND","OR"][Oe-20]+"("+Ce+","+Ee+")");break;default:if(Oe<32&&T[Oe])Ee=P.pop(),Ce=P.pop(),P.push(Ce+T[Oe]+Ee);else if(M[Oe]){if(V=M[Oe][1],V==69&&(V=N[N.l++]),V>P.length){console.error("WK1 bad formula parse 0x"+Oe.toString(16)+":|"+P.join("|")+"|");return}var tt=P.slice(-V);P.length-=V,P.push(M[Oe][0]+"("+tt.join(",")+")")}else return Oe<=7?console.error("WK1 invalid opcode "+Oe.toString(16)):Oe<=24?console.error("WK1 unsupported op "+Oe.toString(16)):Oe<=30?console.error("WK1 invalid opcode "+Oe.toString(16)):Oe<=115?console.error("WK1 unsupported function opcode "+Oe.toString(16)):console.error("WK1 unrecognized opcode "+Oe.toString(16))}}P.length==1?z[1].f=""+P[0]:console.error("WK1 bad formula parse |"+P.join("|")+"|")}function q(N){var z=[{c:0,r:0},{t:"n",v:0},0];return z[0].r=N.read_shift(2),z[3]=N[N.l++],z[0].c=N[N.l++],z}function I(N,z){var P=q(N);return P[1].t="s",P[1].v=N.read_shift(z-4,"cstr"),P}function R(N,z,P,V){var ce=pe(6+V.length);ce.write_shift(2,N),ce.write_shift(1,P),ce.write_shift(1,z),ce.write_shift(1,39);for(var we=0;we<V.length;++we){var Ce=V.charCodeAt(we);ce.write_shift(1,Ce>=128?95:Ce)}return ce.write_shift(1,0),ce}function Q(N,z){var P=q(N);P[1].v=N.read_shift(2);var V=P[1].v>>1;if(P[1].v&1)switch(V&7){case 0:V=(V>>3)*5e3;break;case 1:V=(V>>3)*500;break;case 2:V=(V>>3)/20;break;case 3:V=(V>>3)/200;break;case 4:V=(V>>3)/2e3;break;case 5:V=(V>>3)/2e4;break;case 6:V=(V>>3)/16;break;case 7:V=(V>>3)/64;break}return P[1].v=V,P}function G(N,z){var P=q(N),V=N.read_shift(4),ce=N.read_shift(4),we=N.read_shift(2);if(we==65535)return V===0&&ce===3221225472?(P[1].t="e",P[1].v=15):V===0&&ce===3489660928?(P[1].t="e",P[1].v=42):P[1].v=0,P;var Ce=we&32768;return we=(we&32767)-16446,P[1].v=(1-Ce*2)*(ce*Math.pow(2,we+32)+V*Math.pow(2,we)),P}function ae(N,z,P,V){var ce=pe(14);if(ce.write_shift(2,N),ce.write_shift(1,P),ce.write_shift(1,z),V==0)return ce.write_shift(4,0),ce.write_shift(4,0),ce.write_shift(2,65535),ce;var we=0,Ce=0,Ee=0,Oe=0;return V<0&&(we=1,V=-V),Ce=Math.log2(V)|0,V/=Math.pow(2,Ce-31),Oe=V>>>0,(Oe&2147483648)==0&&(V/=2,++Ce,Oe=V>>>0),V-=Oe,Oe|=2147483648,Oe>>>=0,V*=Math.pow(2,32),Ee=V>>>0,ce.write_shift(4,Ee),ce.write_shift(4,Oe),Ce+=16383+(we?32768:0),ce.write_shift(2,Ce),ce}function ne(N,z){var P=G(N);return N.l+=z-14,P}function J(N,z){var P=q(N),V=N.read_shift(4);return P[1].v=V>>6,P}function ge(N,z){var P=q(N),V=N.read_shift(8,"f");return P[1].v=V,P}function ke(N,z){var P=ge(N);return N.l+=z-10,P}function be(N,z){return N[N.l+z-1]==0?N.read_shift(z,"cstr"):""}function Y(N,z){var P=N[N.l++];P>z-1&&(P=z-1);for(var V="";V.length<P;)V+=String.fromCharCode(N[N.l++]);return V}function le(N,z,P){if(!(!P.qpro||z<21)){var V=N.read_shift(1);N.l+=17,N.l+=1,N.l+=2;var ce=N.read_shift(z-21,"cstr");return[V,ce]}}function _e(N,z){for(var P={},V=N.l+z;N.l<V;){var ce=N.read_shift(2);if(ce==14e3){for(P[ce]=[0,""],P[ce][0]=N.read_shift(2);N[N.l];)P[ce][1]+=String.fromCharCode(N[N.l]),N.l++;N.l++}}return P}function Z(N,z){var P=pe(5+N.length);P.write_shift(2,14e3),P.write_shift(2,z);for(var V=0;V<N.length;++V){var ce=N.charCodeAt(V);P[P.l++]=ce>127?95:ce}return P[P.l++]=0,P}var De={0:{n:"BOF",f:yr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:v},14:{n:"NUMBER",f:w},15:{n:"LABEL",f:x},16:{n:"FORMULA",f:b},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:x},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:be},222:{n:"SHEETNAMELP",f:Y},65535:{n:""}},j={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:I},23:{n:"NUMBER17",f:G},24:{n:"NUMBER18",f:Q},25:{n:"FORMULA19",f:ne},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:_e},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:J},38:{n:"??"},39:{n:"NUMBER27",f:ge},40:{n:"FORMULA28",f:ke},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:be},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:le},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:t}})();function r6(e){var t={},r=e.match(Yr),n=0,i=!1;if(r)for(;n!=r.length;++n){var l=et(r[n]);switch(l[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!l.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(l.val=="1")break;t.cp=r1[parseInt(l.val,10)];break;case"<outline":if(!l.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=l.val;break;case"<sz":t.sz=l.val;break;case"<strike":if(!l.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!l.val)break;switch(l.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(l.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(l.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":l.rgb&&(t.color=l.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=l.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=l.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(l[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+l[0])}}return t}var a6=(function(){var e=co("t"),t=co("rPr");function r(l){var o=l.match(e);if(!o)return{t:"s",v:""};var u={t:"s",v:pt(o[1])},h=l.match(t);return h&&(u.s=r6(h[1])),u}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(i).map(r).filter(function(u){return u.v})}})(),n6=(function(){var t=/(\r\n|\n)/g;function r(i,l,o){var u=[];i.u&&u.push("text-decoration: underline;"),i.uval&&u.push("text-underline-style:"+i.uval+";"),i.sz&&u.push("font-size:"+i.sz+"pt;"),i.outline&&u.push("text-effect: outline;"),i.shadow&&u.push("text-shadow: auto;"),l.push('<span style="'+u.join("")+'">'),i.b&&(l.push("<b>"),o.push("</b>")),i.i&&(l.push("<i>"),o.push("</i>")),i.strike&&(l.push("<s>"),o.push("</s>"));var h=i.valign||"";return h=="superscript"||h=="super"?h="sup":h=="subscript"&&(h="sub"),h!=""&&(l.push("<"+h+">"),o.push("</"+h+">")),o.push("</span>"),i}function n(i){var l=[[],i.v,[]];return i.v?(i.s&&r(i.s,l[0],l[2]),l[0].join("")+l[1].replace(t,"<br/>")+l[2].join("")):""}return function(l){return l.map(n).join("")}})(),i6=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,s6=/<(?:\w+:)?r>/,l6=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function k1(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=pt(Lt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Lt(e),r&&(n.h=h1(n.t))):e.match(s6)&&(n.r=Lt(e),n.t=pt(Lt((e.replace(l6,"").match(i6)||[]).join("").replace(Yr,""))),r&&(n.h=n6(a6(n.r)))),n):{t:""}}var c6=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,o6=/<(?:\w+:)?(?:si|sstItem)>/g,u6=/<\/(?:\w+:)?(?:si|sstItem)>/;function f6(e,t){var r=[],n="";if(!e)return r;var i=e.match(c6);if(i){n=i[2].replace(o6,"").split(u6);for(var l=0;l!=n.length;++l){var o=k1(n[l].trim(),t);o!=null&&(r[r.length]=o)}i=et(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}var h6=/^\s|\s$|[\t\n\r]/;function m2(e,t){if(!t.bookSST)return"";var r=[fr];r[r.length]=Be("sst",null,{xmlns:Cs[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var i=e[n],l="<si>";i.r?l+=i.r:(l+="<t",i.t||(i.t=""),i.t.match(h6)&&(l+=' xml:space="preserve"'),l+=">"+Ot(i.t)+"</t>"),l+="</si>",r[r.length]=l}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function d6(e){return[e.read_shift(4),e.read_shift(4)]}function m6(e,t){var r=[],n=!1;return ti(e,function(l,o,u){switch(u){case 159:r.Count=l[0],r.Unique=l[1];break;case 19:r.push(l);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}),r}function x6(e,t){return t||(t=pe(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var p6=kA;function g6(e){var t=ha();Ne(t,159,x6(e));for(var r=0;r<e.length;++r)Ne(t,19,p6(e[r]));return Ne(t,160),t.end()}function x2(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Jn(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function v6(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Jn(e,4),t.U=Jn(e,4),t.W=Jn(e,4),t}function y6(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},i=e.read_shift(4),l=[];i-- >0;)l.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=l,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function _6(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(y6(e));return t}function w6(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function S6(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Jn(e,4),t.U=Jn(e,4),t.W=Jn(e,4),t}function b6(e){var t=S6(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function p2(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function g2(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function E6(e){var t=Jn(e);switch(t.Minor){case 2:return[t.Minor,T6(e)];case 3:return[t.Minor,k6()];case 4:return[t.Minor,A6(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function T6(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=p2(e,r),i=g2(e,e.length-e.l);return{t:"Std",h:n,v:i}}function k6(){throw new Error("File is password-protected: ECMA-376 Extensible")}function A6(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Yr,function(l){var o=et(l);switch(bn(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(u){n[u]=o[u]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function C6(e,t){var r={},n=r.EncryptionVersionInfo=Jn(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var i=e.read_shift(4);return t-=4,r.EncryptionHeader=p2(e,i),t-=i,r.EncryptionVerifier=g2(e,t),r}function N6(e){var t={},r=t.EncryptionVersionInfo=Jn(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function A1(e){var t=0,r,n=x2(e),i=n.length+1,l,o,u,h,d;for(r=Ui(i),r[0]=n.length,l=1;l!=i;++l)r[l]=n[l-1];for(l=i-1;l>=0;--l)o=r[l],u=(t&16384)===0?0:1,h=t<<1&32767,d=u|h,t=d^o;return t^52811}var v2=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},i=function(o,u){return n(o^u)},l=function(o){for(var u=t[o.length-1],h=104,d=o.length-1;d>=0;--d)for(var x=o[d],g=0;g!=7;++g)x&64&&(u^=r[h]),x*=2,--h;return u};return function(o){for(var u=x2(o),h=l(u),d=u.length,x=Ui(16),g=0;g!=16;++g)x[g]=0;var v,_,w;for((d&1)===1&&(v=h>>8,x[d]=i(e[0],v),--d,v=h&255,_=u[u.length-1],x[d]=i(_,v));d>0;)--d,v=h>>8,x[d]=i(u[d],v),--d,v=h&255,x[d]=i(u[d],v);for(d=15,w=15-u.length;w>0;)v=h>>8,x[d]=i(e[w],v),--d,--w,v=h&255,x[d]=i(u[d],v),--d,--w;return x}})(),O6=function(e,t,r,n,i){i||(i=t),n||(n=v2(e));var l,o;for(l=0;l!=t.length;++l)o=t[l],o^=n[r],o=(o>>5|o<<3)&255,i[l]=o,++r;return[i,r,n]},R6=function(e){var t=0,r=v2(e);return function(n){var i=O6("",n,t,r);return t=i[1],i[0]}};function D6(e,t,r,n){var i={key:yr(e),verificationBytes:yr(e)};return r.password&&(i.verifier=A1(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=R6(r.password)),i}function F6(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=N6(e):n.Data=C6(e,t),n}function M6(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?F6(e,t-2,n):D6(e,r.biff>=8?t:t-2,r,n),n}var y2=(function(){function e(i,l){switch(l.type){case"base64":return t(Oa(i),l);case"binary":return t(i,l);case"buffer":return t(ct&&Buffer.isBuffer(i)?i.toString("binary"):Hi(i),l);case"array":return t(bs(i),l)}throw new Error("Unrecognized type "+l.type)}function t(i,l){var o=l||{},u=o.dense?[]:{},h=i.match(/\\trowd.*?\\row\b/g);if(!h.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:h.length-1}};return h.forEach(function(x,g){Array.isArray(u)&&(u[g]=[]);for(var v=/\\\w+\b/g,_=0,w,y=-1;w=v.exec(x);){switch(w[0]){case"\\cell":var b=x.slice(_,v.lastIndex-w[0].length);if(b[0]==" "&&(b=b.slice(1)),++y,b.length){var A={v:b,t:"s"};Array.isArray(u)?u[g][y]=A:u[Ze({r:g,c:y})]=A}break}_=v.lastIndex}y>d.e.c&&(d.e.c=y)}),u["!ref"]=it(d),u}function r(i,l){return Vi(e(i,l),l)}function n(i){for(var l=["{\\rtf1\\ansi"],o=gt(i["!ref"]),u,h=Array.isArray(i),d=o.s.r;d<=o.e.r;++d){l.push("\\trowd\\trautofit1");for(var x=o.s.c;x<=o.e.c;++x)l.push("\\cellx"+(x+1));for(l.push("\\pard\\intbl"),x=o.s.c;x<=o.e.c;++x){var g=Ze({r:d,c:x});u=h?(i[d]||[])[x]:i[g],!(!u||u.v==null&&(!u.f||u.F))&&(l.push(" "+(u.w||(Qn(u),u.w))),l.push("\\cell"))}l.push("\\pard\\intbl\\row")}return l.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}})();function B6(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function ho(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function L6(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,i=Math.max(t,r,n),l=Math.min(t,r,n),o=i-l;if(o===0)return[0,0,t];var u=0,h=0,d=i+l;switch(h=o/(d>1?2-d:d),i){case t:u=((r-n)/o+6)%6;break;case r:u=(n-t)/o+2;break;case n:u=(t-r)/o+4;break}return[u/6,h,d/2]}function I6(e){var t=e[0],r=e[1],n=e[2],i=r*2*(n<.5?n:1-n),l=n-i/2,o=[l,l,l],u=6*t,h;if(r!==0)switch(u|0){case 0:case 6:h=i*u,o[0]+=i,o[1]+=h;break;case 1:h=i*(2-u),o[0]+=h,o[1]+=i;break;case 2:h=i*(u-2),o[1]+=i,o[2]+=h;break;case 3:h=i*(4-u),o[1]+=h,o[2]+=i;break;case 4:h=i*(u-4),o[2]+=i,o[0]+=h;break;case 5:h=i*(6-u),o[2]+=h,o[0]+=i;break}for(var d=0;d!=3;++d)o[d]=Math.round(o[d]*255);return o}function bu(e,t){if(t===0)return e;var r=L6(B6(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),ho(I6(r))}var _2=6,U6=15,j6=1,qr=_2;function mo(e){return Math.floor((e+Math.round(128/qr)/256)*qr)}function xo(e){return Math.floor((e-5)/qr*100+.5)/100}function Eu(e){return Math.round((e*qr+5)/qr*256)/256}function md(e){return Eu(xo(mo(e)))}function C1(e){var t=Math.abs(e-md(e)),r=qr;if(t>.005)for(qr=j6;qr<U6;++qr)Math.abs(e-md(e))<=t&&(t=Math.abs(e-md(e)),r=qr);qr=r}function ji(e){e.width?(e.wpx=mo(e.width),e.wch=xo(e.wpx),e.MDW=qr):e.wpx?(e.wch=xo(e.wpx),e.width=Eu(e.wch),e.MDW=qr):typeof e.wch=="number"&&(e.width=Eu(e.wch),e.wpx=mo(e.width),e.MDW=qr),e.customWidth&&delete e.customWidth}var P6=96,w2=P6;function po(e){return e*96/w2}function Pl(e){return e*w2/96}var z6={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function H6(e,t,r,n){t.Borders=[];var i={},l=!1;(e[0].match(Yr)||[]).forEach(function(o){var u=et(o);switch(bn(u[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},u.diagonalUp&&(i.diagonalUp=$t(u.diagonalUp)),u.diagonalDown&&(i.diagonalDown=$t(u.diagonalDown)),t.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(n&&n.WTF&&!l)throw new Error("unrecognized "+u[0]+" in borders")}})}function V6(e,t,r,n){t.Fills=[];var i={},l=!1;(e[0].match(Yr)||[]).forEach(function(o){var u=et(o);switch(bn(u[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},t.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":u.patternType&&(i.patternType=u.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),u.indexed&&(i.bgColor.indexed=parseInt(u.indexed,10)),u.theme&&(i.bgColor.theme=parseInt(u.theme,10)),u.tint&&(i.bgColor.tint=parseFloat(u.tint)),u.rgb&&(i.bgColor.rgb=u.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),u.theme&&(i.fgColor.theme=parseInt(u.theme,10)),u.tint&&(i.fgColor.tint=parseFloat(u.tint)),u.rgb!=null&&(i.fgColor.rgb=u.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(n&&n.WTF&&!l)throw new Error("unrecognized "+u[0]+" in fills")}})}function $6(e,t,r,n){t.Fonts=[];var i={},l=!1;(e[0].match(Yr)||[]).forEach(function(o){var u=et(o);switch(bn(u[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(i),i={};break;case"<name":u.val&&(i.name=Lt(u.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=u.val?$t(u.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=u.val?$t(u.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(u.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=u.val?$t(u.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=u.val?$t(u.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=u.val?$t(u.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=u.val?$t(u.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=u.val?$t(u.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":u.val&&(i.sz=+u.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":u.val&&(i.vertAlign=u.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":u.val&&(i.family=parseInt(u.val,10));break;case"<family/>":case"</family>":break;case"<scheme":u.val&&(i.scheme=u.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(u.val=="1")break;u.codepage=r1[parseInt(u.val,10)];break;case"<color":if(i.color||(i.color={}),u.auto&&(i.color.auto=$t(u.auto)),u.rgb)i.color.rgb=u.rgb.slice(-6);else if(u.indexed){i.color.index=parseInt(u.indexed,10);var h=vs[i.color.index];i.color.index==81&&(h=vs[1]),h||(h=vs[1]),i.color.rgb=h[0].toString(16)+h[1].toString(16)+h[2].toString(16)}else u.theme&&(i.color.theme=parseInt(u.theme,10),u.tint&&(i.color.tint=parseFloat(u.tint)),u.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=bu(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":l=!0;break;case"</AlternateContent>":l=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(n&&n.WTF&&!l)throw new Error("unrecognized "+u[0]+" in fonts")}})}function G6(e,t,r){t.NumberFmt=[];for(var n=ir(Je),i=0;i<n.length;++i)t.NumberFmt[n[i]]=Je[n[i]];var l=e[0].match(Yr);if(l)for(i=0;i<l.length;++i){var o=et(l[i]);switch(bn(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var u=pt(Lt(o.formatCode)),h=parseInt(o.numFmtId,10);if(t.NumberFmt[h]=u,h>0){if(h>392){for(h=392;h>60&&t.NumberFmt[h]!=null;--h);t.NumberFmt[h]=u}Yn(u,h)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function q6(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Be("numFmt",null,{numFmtId:n,formatCode:Ot(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Be("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var ru=["numFmtId","fillId","fontId","borderId","xfId"],au=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function X6(e,t,r){t.CellXf=[];var n,i=!1;(e[0].match(Yr)||[]).forEach(function(l){var o=et(l),u=0;switch(bn(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],u=0;u<ru.length;++u)n[ru[u]]&&(n[ru[u]]=parseInt(n[ru[u]],10));for(u=0;u<au.length;++u)n[au[u]]&&(n[au[u]]=$t(n[au[u]]));if(t.NumberFmt&&n.numFmtId>392){for(u=392;u>60;--u)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[u]){n.numFmtId=u;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var h={};o.vertical&&(h.vertical=o.vertical),o.horizontal&&(h.horizontal=o.horizontal),o.textRotation!=null&&(h.textRotation=o.textRotation),o.indent&&(h.indent=o.indent),o.wrapText&&(h.wrapText=$t(o.wrapText)),n.alignment=h;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function W6(e){var t=[];return t[t.length]=Be("cellXfs",null),e.forEach(function(r){t[t.length]=Be("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Be("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var K6=(function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,l=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(u,h,d){var x={};if(!u)return x;u=u.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var g;return(g=u.match(t))&&G6(g,x,d),(g=u.match(i))&&$6(g,x,h,d),(g=u.match(n))&&V6(g,x,h,d),(g=u.match(l))&&H6(g,x,h,d),(g=u.match(r))&&X6(g,x,d),x}})();function S2(e,t){var r=[fr,Be("styleSheet",null,{xmlns:Cs[0],"xmlns:vt":br.vt})],n;return e.SSF&&(n=q6(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=W6(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function Y6(e,t){var r=e.read_shift(2),n=Wr(e);return[r,n]}function J6(e,t,r){r||(r=pe(6+4*t.length)),r.write_shift(2,e),Nr(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function Q6(e,t,r){var n={};n.sz=e.read_shift(2)/20;var i=FA(e);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var l=e.read_shift(2);switch(l===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(n.underline=o);var u=e.read_shift(1);u>0&&(n.family=u);var h=e.read_shift(1);switch(h>0&&(n.charset=h),e.l++,n.color=DA(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Wr(e),n}function Z6(e,t){t||(t=pe(153)),t.write_shift(2,e.sz*20),MA(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),_u(e.color,t);var n=0;return n=2,t.write_shift(1,n),Nr(e.name,t),t.length>t.l?t.slice(0,t.l):t}var e8=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],xd,t8=Kr;function cy(e,t){t||(t=pe(84)),xd||(xd=Ru(e8));var r=xd[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(_u({auto:1},t),_u({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function r8(e,t){var r=e.l+t,n=e.read_shift(2),i=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:i}}function b2(e,t,r){r||(r=pe(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Uc(e,t){return t||(t=pe(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var a8=Kr;function n8(e,t){return t||(t=pe(51)),t.write_shift(1,0),Uc(null,t),Uc(null,t),Uc(null,t),Uc(null,t),Uc(null,t),t.length>t.l?t.slice(0,t.l):t}function i8(e,t){return t||(t=pe(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),yu(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function s8(e,t,r){var n=pe(2052);return n.write_shift(4,e),yu(t,n),yu(r,n),n.length>n.l?n.slice(0,n.l):n}function l8(e,t,r){var n={};n.NumberFmt=[];for(var i in Je)n.NumberFmt[i]=Je[i];n.CellXf=[],n.Fonts=[];var l=[],o=!1;return ti(e,function(h,d,x){switch(x){case 44:n.NumberFmt[h[0]]=h[1],Yn(h[1],h[0]);break;case 43:n.Fonts.push(h),h.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(h.color.rgb=bu(t.themeElements.clrScheme[h.color.theme].rgb,h.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:l[l.length-1]==617&&n.CellXf.push(h);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:l.push(x),o=!0;break;case 38:l.pop(),o=!1;break;default:if(d.T>0)l.push(x);else if(d.T<0)l.pop();else if(!o||r.WTF&&l[l.length-1]!=37)throw new Error("Unexpected record 0x"+x.toString(16))}}),n}function c8(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&++r}),r!=0&&(Ne(e,615,fn(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&Ne(e,44,J6(i,t[i]))}),Ne(e,616))}}function o8(e){var t=1;Ne(e,611,fn(t)),Ne(e,43,Z6({sz:12,color:{theme:1},name:"Calibri",family:2})),Ne(e,612)}function u8(e){var t=2;Ne(e,603,fn(t)),Ne(e,45,cy({patternType:"none"})),Ne(e,45,cy({patternType:"gray125"})),Ne(e,604)}function f8(e){var t=1;Ne(e,613,fn(t)),Ne(e,46,n8()),Ne(e,614)}function h8(e){var t=1;Ne(e,626,fn(t)),Ne(e,47,b2({numFmtId:0},65535)),Ne(e,627)}function d8(e,t){Ne(e,617,fn(t.length)),t.forEach(function(r){Ne(e,47,b2(r,0))}),Ne(e,618)}function m8(e){var t=1;Ne(e,619,fn(t)),Ne(e,48,i8({xfId:0,name:"Normal"})),Ne(e,620)}function x8(e){var t=0;Ne(e,505,fn(t)),Ne(e,506)}function p8(e){var t=0;Ne(e,508,s8(t,"TableStyleMedium9","PivotStyleMedium4")),Ne(e,509)}function g8(e,t){var r=ha();return Ne(r,278),c8(r,e.SSF),o8(r),u8(r),f8(r),h8(r),d8(r,t.cellXfs),m8(r),x8(r),p8(r),Ne(r,279),r.end()}var v8=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function y8(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Yr)||[]).forEach(function(i){var l=et(i);switch(l[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=l.val;break;case"<a:sysClr":n.rgb=l.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":l[0].charAt(1)==="/"?(t.themeElements.clrScheme[v8.indexOf(l[0])]=n,n={}):n.name=l[0].slice(3,l[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+l[0]+" in clrScheme")}})}function _8(){}function w8(){}var S8=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,b8=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,E8=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function T8(e,t,r){t.themeElements={};var n;[["clrScheme",S8,y8],["fontScheme",b8,_8],["fmtScheme",E8,w8]].forEach(function(i){if(!(n=e.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,t,r)})}var k8=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function E2(e,t){(!e||e.length===0)&&(e=N1());var r,n={};if(!(r=e.match(k8)))throw new Error("themeElements not found in theme");return T8(r[0],n,t),n.raw=e,n}function N1(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[fr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function A8(e,t,r){var n=e.l+t,i=e.read_shift(4);if(i!==124226){if(!r.cellStyles){e.l=n;return}var l=e.slice(e.l);e.l=n;var o;try{o=p_(l,{type:"array"})}catch{return}var u=Na(o,"theme/theme/theme1.xml",!0);if(u)return E2(u,r)}}function C8(e){return e.read_shift(4)}function N8(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=O8(e,4);break;case 2:t.xclrValue=a2(e);break;case 3:t.xclrValue=C8(e);break;case 4:e.l+=4;break}return e.l+=8,t}function O8(e,t){return Kr(e,t)}function R8(e,t){return Kr(e,t)}function D8(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=N8(e);break;case 6:n[1]=R8(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function F8(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var i=e.read_shift(2),l=[];i-- >0;)l.push(D8(e,r-e.l));return{ixfe:n,ext:l}}function M8(e,t){t.forEach(function(r){r[0]})}function B8(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Wr(e)}}function L8(e){var t=pe(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Nr(e.name,t),t.slice(0,t.l)}function I8(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function U8(e){var t=pe(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function j8(e,t){var r=pe(8+2*t.length);return r.write_shift(4,e),Nr(t,r),r.slice(0,r.l)}function P8(e){return e.l+=4,e.read_shift(4)!=0}function z8(e,t){var r=pe(8);return r.write_shift(4,e),r.write_shift(4,1),r}function H8(e,t,r){var n={Types:[],Cell:[],Value:[]},i=r||{},l=[],o=!1,u=2;return ti(e,function(h,d,x){switch(x){case 335:n.Types.push({name:h.name});break;case 51:h.forEach(function(g){u==1?n.Cell.push({type:n.Types[g[0]-1].name,index:g[1]}):u==0&&n.Value.push({type:n.Types[g[0]-1].name,index:g[1]})});break;case 337:u=h?1:0;break;case 338:u=2;break;case 35:l.push(x),o=!0;break;case 36:l.pop(),o=!1;break;default:if(!d.T){if(!o||i.WTF&&l[l.length-1]!=35)throw new Error("Unexpected record 0x"+x.toString(16))}}}),n}function V8(){var e=ha();return Ne(e,332),Ne(e,334,fn(1)),Ne(e,335,L8({name:"XLDAPR",version:12e4,flags:3496657072})),Ne(e,336),Ne(e,339,j8(1,"XLDAPR")),Ne(e,52),Ne(e,35,fn(514)),Ne(e,4096,fn(0)),Ne(e,4097,Wa(1)),Ne(e,36),Ne(e,53),Ne(e,340),Ne(e,337,z8(1)),Ne(e,51,U8([[1,0]])),Ne(e,338),Ne(e,333),e.end()}function $8(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var i=!1,l=2,o;return e.replace(Yr,function(u){var h=et(u);switch(bn(h[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:h.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<n.Types.length;++d)n.Types[d].name==h.name&&(o=n.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":l==1?n.Cell.push({type:n.Types[h.t-1].name,index:+h.v}):l==0&&n.Value.push({type:n.Types[h.t-1].name,index:+h.v});break;case"</rc>":break;case"<cellMetadata":l=1;break;case"</cellMetadata>":l=2;break;case"<valueMetadata":l=0;break;case"</valueMetadata>":l=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+h.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+h[0]+" in metadata")}return u}),n}function T2(){var e=[fr];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function G8(e){var t=[];if(!e)return t;var r=1;return(e.match(Yr)||[]).forEach(function(n){var i=et(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,t.push(i);break}}),t}function q8(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Ze(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function X8(e,t,r){var n=[];return ti(e,function(l,o,u){switch(u){case 63:n.push(l);break;default:if(!o.T)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function W8(e,t,r,n){if(!e)return e;var i=n||{},l=!1;ti(e,function(u,h,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:l=!0;break;case 36:l=!1;break;default:if(!h.T){if(!l||i.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},i)}function K8(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var Rl=1024;function k2(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[Be("xml",null,{"xmlns:v":Ea.v,"xmlns:o":Ea.o,"xmlns:x":Ea.x,"xmlns:mv":Ea.mv}).replace(/\/>/,">"),Be("o:shapelayout",Be("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Be("v:shapetype",[Be("v:stroke",null,{joinstyle:"miter"}),Be("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Rl<e*1e3;)Rl+=1e3;return t.forEach(function(l){var o=Zt(l[0]),u={color2:"#BEFF82",type:"gradient"};u.type=="gradient"&&(u.angle="-180");var h=u.type=="gradient"?Be("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=Be("v:fill",h,u),x={on:"t",obscured:"t"};++Rl,i=i.concat(["<v:shape"+oo({id:"_x0000_s"+Rl,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(l[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,Be("v:shadow",null,x),Be("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",jr("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),jr("x:AutoFill","False"),jr("x:Row",String(o.r)),jr("x:Column",String(o.c)),l[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function oy(e,t,r,n){var i=Array.isArray(e),l;t.forEach(function(o){var u=Zt(o.ref);if(i?(e[u.r]||(e[u.r]=[]),l=e[u.r][u.c]):l=e[o.ref],!l){l={t:"z"},i?e[u.r][u.c]=l:e[o.ref]=l;var h=gt(e["!ref"]||"BDWGO1000001:A1");h.s.r>u.r&&(h.s.r=u.r),h.e.r<u.r&&(h.e.r=u.r),h.s.c>u.c&&(h.s.c=u.c),h.e.c<u.c&&(h.e.c=u.c);var d=it(h);d!==e["!ref"]&&(e["!ref"]=d)}l.c||(l.c=[]);var x={a:o.author,t:o.t,r:o.r,T:r};o.h&&(x.h=o.h);for(var g=l.c.length-1;g>=0;--g){if(!r&&l.c[g].T)return;r&&!l.c[g].T&&l.c.splice(g,1)}if(r&&n){for(g=0;g<n.length;++g)if(x.a==n[g].id){x.a=n[g].name||x.a;break}}l.c.push(x)})}function Y8(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var u=o.match(/<(?:\w+:)?author[^>]*>(.*)/);u&&r.push(u[1])}});var l=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return l&&l[1]&&l[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var u=o.match(/<(?:\w+:)?comment[^>]*>/);if(u){var h=et(u[0]),d={author:h.authorId&&r[h.authorId]||"sheetjsghost",ref:h.ref,guid:h.guid},x=Zt(h.ref);if(!(t.sheetRows&&t.sheetRows<=x.r)){var g=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),v=!!g&&!!g[1]&&k1(g[1])||{r:"",t:"",h:""};d.r=v.r,v.r=="<t></t>"&&(v.t=v.h=""),d.t=(v.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(d.h=v.h),n.push(d)}}}}),n}function A2(e){var t=[fr,Be("comments",null,{xmlns:Cs[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(i){var l=Ot(i.a);r.indexOf(l)==-1&&(r.push(l),t.push("<author>"+l+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),t.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var i=0,l=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(h){h.a&&(i=r.indexOf(Ot(h.a))),l.push(h.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),l.length<=1)t.push(jr("t",Ot(l[0]||"")));else{for(var o=`Comment:
    `+l[0]+`
`,u=1;u<l.length;++u)o+=`Reply:
    `+l[u]+`
`;t.push(jr("t",Ot(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function J8(e,t){var r=[],n=!1,i={},l=0;return e.replace(Yr,function(u,h){var d=et(u);switch(bn(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":l=h+u.length;break;case"</text>":i.t=e.slice(l,h).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return u}),r}function Q8(e,t,r){var n=[fr,Be("ThreadedComments",null,{xmlns:br.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(i){var l="";(i[1]||[]).forEach(function(o,u){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var h={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};u==0?l=h.id:h.parentId=l,o.ID=h.id,o.a&&(h.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),n.push(Be("threadedComment",jr("text",o.t||""),h))})}),n.push("</ThreadedComments>"),n.join("")}function Z8(e,t){var r=[],n=!1;return e.replace(Yr,function(l){var o=et(l);switch(bn(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return l}),r}function eN(e){var t=[fr,Be("personList",null,{xmlns:br.TCMNT,"xmlns:x":Cs[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Be("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function tN(e){var t={};t.iauthor=e.read_shift(4);var r=Ds(e);return t.rfx=r.s,t.ref=Ze(r.s),e.l+=16,t}function rN(e,t){return t==null&&(t=pe(36)),t.write_shift(4,e[1].iauthor),Gl(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var aN=Wr;function nN(e){return Nr(e.slice(0,54))}function iN(e,t){var r=[],n=[],i={},l=!1;return ti(e,function(u,h,d){switch(d){case 632:n.push(u);break;case 635:i=u;break;case 637:i.t=u.t,i.h=u.h,i.r=u.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,t.sheetRows&&i.rfx&&t.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!h.T){if(!l||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),r}function sN(e){var t=ha(),r=[];return Ne(t,628),Ne(t,630),e.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),Ne(t,632,nN(i.a)))})}),Ne(t,631),Ne(t,633),e.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var l={s:Zt(n[0]),e:Zt(n[0])};Ne(t,635,rN([l,i])),i.t&&i.t.length>0&&Ne(t,637,CA(i)),Ne(t,636),delete i.iauthor})}),Ne(t,634),Ne(t,629),t.end()}var lN="application/vnd.ms-office.vbaProject";function cN(e){var t=qe.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");qe.utils.cfb_add(t,i,e.FileIndex[n].content)}}),qe.write(t)}function oN(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&qe.utils.cfb_add(e,i,t.FileIndex[n].content)}})}var C2=["xlsb","xlsm","xlam","biff8","xla"];function uN(){return{"!type":"dialog"}}function fN(){return{"!type":"dialog"}}function hN(){return{"!type":"macro"}}function dN(){return{"!type":"macro"}}var Bl=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,i,l,o){var u=!1,h=!1;l.length==0?h=!0:l.charAt(0)=="["&&(h=!0,l=l.slice(1,-1)),o.length==0?u=!0:o.charAt(0)=="["&&(u=!0,o=o.slice(1,-1));var d=l.length>0?parseInt(l,10)|0:0,x=o.length>0?parseInt(o,10)|0:0;return u?x+=t.c:--x,h?d+=t.r:--d,i+(u?"":"$")+Qt(x)+(h?"":"$")+or(d)}return function(i,l){return t=l,i.replace(e,r)}})(),O1=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,R1=(function(){return function(t,r){return t.replace(O1,function(n,i,l,o,u,h){var d=g1(o)-(l?0:r.c),x=p1(h)-(u?0:r.r),g=x==0?"":u?x+1:"["+x+"]",v=d==0?"":l?d+1:"["+d+"]";return i+"R"+g+"C"+v})}})();function N2(e,t){return e.replace(O1,function(r,n,i,l,o,u){return n+(i=="$"?i+l:Qt(g1(l)+t.c))+(o=="$"?o+u:or(p1(u)+t.r))})}function mN(e,t,r){var n=da(t),i=n.s,l=Zt(r),o={r:l.r-i.r,c:l.c-i.c};return N2(e,o)}function xN(e){return e.length!=1}function uy(e){return e.replace(/_xlfn\./g,"")}function gr(e){e.l+=1}function Pi(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function O2(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return R2(e);r.biff==12&&(n=4)}var i=e.read_shift(n),l=e.read_shift(n),o=Pi(e),u=Pi(e);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:l,c:u[0],cRel:u[1],rRel:u[2]}}}function R2(e){var t=Pi(e),r=Pi(e),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function pN(e,t,r){if(r.biff<8)return R2(e);var n=e.read_shift(r.biff==12?4:2),i=e.read_shift(r.biff==12?4:2),l=Pi(e),o=Pi(e);return{s:{r:n,c:l[0],cRel:l[1],rRel:l[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function D2(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return gN(e);var n=e.read_shift(r&&r.biff==12?4:2),i=Pi(e);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function gN(e){var t=Pi(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function vN(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function yN(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return _N(e);var i=e.read_shift(n>=12?4:2),l=e.read_shift(2),o=(l&16384)>>14,u=(l&32768)>>15;if(l&=16383,u==1)for(;i>524287;)i-=1048576;if(o==1)for(;l>8191;)l=l-16384;return{r:i,c:l,cRel:o,rRel:u}}function _N(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),i==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:i,rRel:n}}function wN(e,t,r){var n=(e[e.l++]&96)>>5,i=O2(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function SN(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),l=8;if(r)switch(r.biff){case 5:e.l+=12,l=6;break;case 12:l=12;break}var o=O2(e,l,r);return[n,i,o]}function bN(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function EN(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),l=8;if(r)switch(r.biff){case 5:e.l+=12,l=6;break;case 12:l=12;break}return e.l+=l,[n,i]}function TN(e,t,r){var n=(e[e.l++]&96)>>5,i=pN(e,t-1,r);return[n,i]}function kN(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function fy(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function AN(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),i=[],l=0;l<=n;++l)i.push(e.read_shift(r&&r.biff==2?1:2));return i}function CN(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function NN(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function ON(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function RN(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function F2(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function DN(e){return e.read_shift(2),F2(e)}function FN(e){return e.read_shift(2),F2(e)}function MN(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=D2(e,0,r);return[n,i]}function BN(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=yN(e,0,r);return[n,i]}function LN(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var l=D2(e,0,r);return[n,i,l]}function IN(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(r&&r.biff<=3?1:2);return[PO[i],L2[i],n]}function UN(e,t,r){var n=e[e.l++],i=e.read_shift(1),l=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:jN(e);return[i,(l[0]===0?L2:jO)[l[1]]]}function jN(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function PN(e,t,r){e.l+=r&&r.biff==2?3:4}function zN(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function HN(e){return e.l++,ri[e.read_shift(1)]}function VN(e){return e.l++,e.read_shift(2)}function $N(e){return e.l++,e.read_shift(1)!==0}function GN(e){return e.l++,Xr(e)}function qN(e,t,r){return e.l++,To(e,t-1,r)}function XN(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=cr(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=ri[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Xr(e);break;case 2:r[1]=Fs(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function WN(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),i=[],l=0;l!=n;++l)i.push((r.biff==12?Ds:Mu)(e));return i}function KN(e,t,r){var n=0,i=0;r.biff==12?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var l=0,o=[];l!=n&&(o[l]=[]);++l)for(var u=0;u!=i;++u)o[l][u]=XN(e,r.biff);return o}function YN(e,t,r){var n=e.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,l=e.read_shift(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,l]}function JN(e,t,r){if(r.biff==5)return QN(e);var n=e.read_shift(1)>>>5&3,i=e.read_shift(2),l=e.read_shift(4);return[n,i,l]}function QN(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function ZN(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function eO(e,t,r){var n=e.read_shift(1)>>>5&3,i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function tO(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function rO(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),l=4;if(r)switch(r.biff){case 5:l=15;break;case 12:l=6;break}return e.l+=l,[n,i]}var aO=Kr,nO=Kr,iO=Kr;function Ao(e,t,r){return e.l+=2,[vN(e)]}function D1(e){return e.l+=6,[]}var sO=Ao,lO=D1,cO=D1,oO=Ao;function M2(e){return e.l+=2,[yr(e),e.read_shift(2)&1]}var uO=Ao,fO=M2,hO=D1,dO=Ao,mO=Ao,xO=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function pO(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),l=e.read_shift(2),o=xO[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:n,c:i,C:l}}function gO(e){return e.l+=2,[e.read_shift(4)]}function vO(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function yO(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function _O(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function wO(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function SO(e){return e.l+=4,[0,0]}var hy={1:{n:"PtgExp",f:zN},2:{n:"PtgTbl",f:iO},3:{n:"PtgAdd",f:gr},4:{n:"PtgSub",f:gr},5:{n:"PtgMul",f:gr},6:{n:"PtgDiv",f:gr},7:{n:"PtgPower",f:gr},8:{n:"PtgConcat",f:gr},9:{n:"PtgLt",f:gr},10:{n:"PtgLe",f:gr},11:{n:"PtgEq",f:gr},12:{n:"PtgGe",f:gr},13:{n:"PtgGt",f:gr},14:{n:"PtgNe",f:gr},15:{n:"PtgIsect",f:gr},16:{n:"PtgUnion",f:gr},17:{n:"PtgRange",f:gr},18:{n:"PtgUplus",f:gr},19:{n:"PtgUminus",f:gr},20:{n:"PtgPercent",f:gr},21:{n:"PtgParen",f:gr},22:{n:"PtgMissArg",f:gr},23:{n:"PtgStr",f:qN},26:{n:"PtgSheet",f:vO},27:{n:"PtgEndSheet",f:yO},28:{n:"PtgErr",f:HN},29:{n:"PtgBool",f:$N},30:{n:"PtgInt",f:VN},31:{n:"PtgNum",f:GN},32:{n:"PtgArray",f:kN},33:{n:"PtgFunc",f:IN},34:{n:"PtgFuncVar",f:UN},35:{n:"PtgName",f:YN},36:{n:"PtgRef",f:MN},37:{n:"PtgArea",f:wN},38:{n:"PtgMemArea",f:ZN},39:{n:"PtgMemErr",f:aO},40:{n:"PtgMemNoMem",f:nO},41:{n:"PtgMemFunc",f:eO},42:{n:"PtgRefErr",f:tO},43:{n:"PtgAreaErr",f:bN},44:{n:"PtgRefN",f:BN},45:{n:"PtgAreaN",f:TN},46:{n:"PtgMemAreaN",f:_O},47:{n:"PtgMemNoMemN",f:wO},57:{n:"PtgNameX",f:JN},58:{n:"PtgRef3d",f:LN},59:{n:"PtgArea3d",f:SN},60:{n:"PtgRefErr3d",f:rO},61:{n:"PtgAreaErr3d",f:EN},255:{}},bO={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},EO={1:{n:"PtgElfLel",f:M2},2:{n:"PtgElfRw",f:dO},3:{n:"PtgElfCol",f:sO},6:{n:"PtgElfRwV",f:mO},7:{n:"PtgElfColV",f:oO},10:{n:"PtgElfRadical",f:uO},11:{n:"PtgElfRadicalS",f:hO},13:{n:"PtgElfColS",f:lO},15:{n:"PtgElfColSV",f:cO},16:{n:"PtgElfRadicalLel",f:fO},25:{n:"PtgList",f:pO},29:{n:"PtgSxName",f:gO},255:{}},TO={0:{n:"PtgAttrNoop",f:SO},1:{n:"PtgAttrSemi",f:RN},2:{n:"PtgAttrIf",f:NN},4:{n:"PtgAttrChoose",f:AN},8:{n:"PtgAttrGoto",f:CN},16:{n:"PtgAttrSum",f:PN},32:{n:"PtgAttrBaxcel",f:fy},33:{n:"PtgAttrBaxcel",f:fy},64:{n:"PtgAttrSpace",f:DN},65:{n:"PtgAttrSpaceSemi",f:FN},128:{n:"PtgAttrIfError",f:ON},255:{}};function Co(e,t,r,n){if(n.biff<8)return Kr(e,t);for(var i=e.l+t,l=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=KN(e,0,n),l.push(r[o][1]);break;case"PtgMemArea":r[o][2]=WN(e,r[o][1],n),l.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=e.read_shift(4),l.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=i-e.l,t!==0&&l.push(Kr(e,t)),l}function No(e,t,r){for(var n=e.l+t,i,l,o=[];n!=e.l;)t=n-e.l,l=e[e.l],i=hy[l]||hy[bO[l]],(l===24||l===25)&&(i=(l===24?EO:TO)[e[e.l+1]]),!i||!i.f?Kr(e,t):o.push([i.n,i.f(e,t,r)]);return o}function kO(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],i=[],l=0;l<n.length;++l){var o=n[l];o?o[0]===2?i.push('"'+o[1].replace(/"/g,'""')+'"'):i.push(o[1]):i.push("")}t.push(i.join(","))}return t.join(";")}var AO={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function CO(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function B2(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[n[0]][0]){case 357:return i=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(l){return l.Name}).join(";;");default:return e[n[0]][0][3]?(i=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function dy(e,t,r){var n=B2(e,t,r);return n=="#REF"?n:CO(n,r)}function Gr(e,t,r,n,i){var l=i&&i.biff||8,o={s:{c:0,r:0}},u=[],h,d,x,g=0,v=0,_,w="";if(!e[0]||!e[0][0])return"";for(var y=-1,b="",A=0,M=e[0].length;A<M;++A){var T=e[0][A];switch(T[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(h=u.pop(),d=u.pop(),y>=0){switch(e[0][y][1][0]){case 0:b=ar(" ",e[0][y][1][1]);break;case 1:b=ar("\r",e[0][y][1][1]);break;default:if(b="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][y][1][0])}d=d+b,y=-1}u.push(d+AO[T[0]]+h);break;case"PtgIsect":h=u.pop(),d=u.pop(),u.push(d+" "+h);break;case"PtgUnion":h=u.pop(),d=u.pop(),u.push(d+","+h);break;case"PtgRange":h=u.pop(),d=u.pop(),u.push(d+":"+h);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":x=qc(T[1][1],o,i),u.push(Xc(x,l));break;case"PtgRefN":x=r?qc(T[1][1],r,i):T[1][1],u.push(Xc(x,l));break;case"PtgRef3d":g=T[1][1],x=qc(T[1][2],o,i),w=dy(n,g,i),u.push(w+"!"+Xc(x,l));break;case"PtgFunc":case"PtgFuncVar":var U=T[1][0],q=T[1][1];U||(U=0),U&=127;var I=U==0?[]:u.slice(-U);u.length-=U,q==="User"&&(q=I.shift()),u.push(q+"("+I.join(",")+")");break;case"PtgBool":u.push(T[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(T[1]);break;case"PtgNum":u.push(String(T[1]));break;case"PtgStr":u.push('"'+T[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(T[1]);break;case"PtgAreaN":_=Hv(T[1][1],r?{s:r}:o,i),u.push(fd(_,i));break;case"PtgArea":_=Hv(T[1][1],o,i),u.push(fd(_,i));break;case"PtgArea3d":g=T[1][1],_=T[1][2],w=dy(n,g,i),u.push(w+"!"+fd(_,i));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":v=T[1][2];var R=(n.names||[])[v-1]||(n[0]||[])[v],Q=R?R.Name:"SH33TJSNAME"+String(v);Q&&Q.slice(0,6)=="_xlfn."&&!i.xlfn&&(Q=Q.slice(6)),u.push(Q);break;case"PtgNameX":var G=T[1][1];v=T[1][2];var ae;if(i.biff<=5)G<0&&(G=-G),n[G]&&(ae=n[G][v]);else{var ne="";if(((n[G]||[])[0]||[])[0]==14849||(((n[G]||[])[0]||[])[0]==1025?n[G][v]&&n[G][v].itab>0&&(ne=n.SheetNames[n[G][v].itab-1]+"!"):ne=n.SheetNames[v-1]+"!"),n[G]&&n[G][v])ne+=n[G][v].Name;else if(n[0]&&n[0][v])ne+=n[0][v].Name;else{var J=(B2(n,G,i)||"").split(";;");J[v-1]?ne=J[v-1]:ne+="SH33TJSERRX"}u.push(ne);break}ae||(ae={Name:"SH33TJSERRY"}),u.push(ae.Name);break;case"PtgParen":var ge="(",ke=")";if(y>=0){switch(b="",e[0][y][1][0]){case 2:ge=ar(" ",e[0][y][1][1])+ge;break;case 3:ge=ar("\r",e[0][y][1][1])+ge;break;case 4:ke=ar(" ",e[0][y][1][1])+ke;break;case 5:ke=ar("\r",e[0][y][1][1])+ke;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][y][1][0])}y=-1}u.push(ge+u.pop()+ke);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":x={c:T[1][1],r:T[1][0]};var be={c:r.c,r:r.r};if(n.sharedf[Ze(x)]){var Y=n.sharedf[Ze(x)];u.push(Gr(Y,o,be,n,i))}else{var le=!1;for(h=0;h!=n.arrayf.length;++h)if(d=n.arrayf[h],!(x.c<d[0].s.c||x.c>d[0].e.c)&&!(x.r<d[0].s.r||x.r>d[0].e.r)){u.push(Gr(d[1],o,be,n,i)),le=!0;break}le||u.push(T[1])}break;case"PtgArray":u.push("{"+kO(T[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":y=A;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+T[1].idx+"[#"+T[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(T));default:throw new Error("Unrecognized Formula Token: "+String(T))}var _e=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&y>=0&&_e.indexOf(e[0][A][0])==-1){T=e[0][y];var Z=!0;switch(T[1][0]){case 4:Z=!1;case 0:b=ar(" ",T[1][1]);break;case 5:Z=!1;case 1:b=ar("\r",T[1][1]);break;default:if(b="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+T[1][0])}u.push((Z?b:"")+u.pop()+(Z?"":b)),y=-1}}if(u.length>1&&i.WTF)throw new Error("bad formula stack");return u[0]}function NO(e,t,r){var n=e.l+t,i=r.biff==2?1:2,l,o=e.read_shift(i);if(o==65535)return[[],Kr(e,t-2)];var u=No(e,o,r);return t!==o+i&&(l=Co(e,t-o-i,u,r)),e.l=n,[u,l]}function OO(e,t,r){var n=e.l+t,i=r.biff==2?1:2,l,o=e.read_shift(i);if(o==65535)return[[],Kr(e,t-2)];var u=No(e,o,r);return t!==o+i&&(l=Co(e,t-o-i,u,r)),e.l=n,[u,l]}function RO(e,t,r,n){var i=e.l+t,l=No(e,n,r),o;return i!==e.l&&(o=Co(e,i-e.l,l,r)),[l,o]}function DO(e,t,r){var n=e.l+t,i,l=e.read_shift(2),o=No(e,l,r);return l==65535?[[],Kr(e,t-2)]:(t!==l+2&&(i=Co(e,n-l-2,o,r)),[o,i])}function FO(e){var t;if(Wn(e,e.l+6)!==65535)return[Xr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function MO(e){if(e==null){var t=pe(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Es(e);return Es(0)}function pd(e,t,r){var n=e.l+t,i=En(e);r.biff==2&&++e.l;var l=FO(e),o=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var u=OO(e,n-e.l,r);return{cell:i,val:l[0],formula:u,shared:o>>3&1,tt:l[1]}}function BO(e,t,r,n,i){var l=ks(t,r,i),o=MO(e.v),u=pe(6),h=33;u.write_shift(2,h),u.write_shift(4,0);for(var d=pe(e.bf.length),x=0;x<e.bf.length;++x)d[x]=e.bf[x];var g=Cr([l,o,u,d]);return g}function Bu(e,t,r){var n=e.read_shift(4),i=No(e,n,r),l=e.read_shift(4),o=l>0?Co(e,l,i,r):null;return[i,o]}var LO=Bu,Lu=Bu,IO=Bu,UO=Bu,jO={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},L2={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},PO={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function my(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function zO(e){var t="of:="+e.replace(O1,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function gd(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function HO(e){return e.replace(/\./,"!")}var Kc={},Ll={},Yc=typeof Map<"u";function F1(e,t,r){var n=0,i=e.length;if(r){if(Yc?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var l=Yc?r.get(t):r[t];n<l.length;++n)if(e[l[n]].t===t)return e.Count++,l[n]}}else for(;n<i;++n)if(e[n].t===t)return e.Count++,n;return e[i]={t},e.Count++,e.Unique++,r&&(Yc?(r.has(t)||r.set(t,[]),r.get(t).push(i)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(i))),i}function Iu(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(qr=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=xo(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=Eu(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function ws(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function $i(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],i=60,l=e.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){Yn(t.z,i),r.ssf[i]=t.z,r.revssf[t.z]=n=i;break}}for(i=0;i!=l;++i)if(e[i].numFmtId===n)return i;return e[l]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},l}function I2(e,t,r,n,i,l){try{n.cellNF&&(e.z=Je[t])}catch(u){if(n.WTF)throw u}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Gt(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(Je[t]==null&&Yn(jk[t]||"General",t),e.t==="e")e.w=e.w||ri[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=lo(e.v);else if(e.t==="d"){var o=Er(e.v);(o|0)===o?e.w=o.toString(10):e.w=lo(o)}else{if(e.v===void 0)return"";e.w=Ss(e.v,Ll)}else e.t==="d"?e.w=Ya(t,Er(e.v),Ll):e.w=Ya(t,e.v,Ll)}catch(u){if(n.WTF)throw u}if(n.cellStyles&&r!=null)try{e.s=l.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=bu(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=bu(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(u){if(n.WTF&&l.Fills)throw u}}}function VO(e,t,r){if(e&&e["!ref"]){var n=gt(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function $O(e,t){var r=gt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=it(r))}var GO=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,qO=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,XO=/<(?:\w:)?hyperlink [^>]*>/mg,WO=/"(\w*:\w*)"/,KO=/<(?:\w:)?col\b[^>]*[\/]?>/g,YO=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,JO=/<(?:\w:)?pageMargins[^>]*\/>/g,U2=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,QO=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,ZO=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function e5(e,t,r,n,i,l,o){if(!e)return e;n||(n={"!id":{}});var u=t.dense?[]:{},h={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",x="",g=e.match(qO);g?(d=e.slice(0,g.index),x=e.slice(g.index+g[0].length)):d=x=e;var v=d.match(U2);v?M1(v[0],u,i,r):(v=d.match(QO))&&r5(v[0],v[1]||"",u,i,r);var _=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(_>0){var w=d.slice(_,_+50).match(WO);w&&$O(u,w[1])}var y=d.match(ZO);y&&y[1]&&x5(y[1],i);var b=[];if(t.cellStyles){var A=d.match(KO);A&&u5(b,A)}g&&v5(g[1],u,t,h,l,o);var M=x.match(YO);M&&(u["!autofilter"]=h5(M[0]));var T=[],U=x.match(GO);if(U)for(_=0;_!=U.length;++_)T[_]=gt(U[_].slice(U[_].indexOf('"')+1));var q=x.match(XO);q&&l5(u,q,n);var I=x.match(JO);if(I&&(u["!margins"]=c5(et(I[0]))),!u["!ref"]&&h.e.c>=h.s.c&&h.e.r>=h.s.r&&(u["!ref"]=it(h)),t.sheetRows>0&&u["!ref"]){var R=gt(u["!ref"]);t.sheetRows<=+R.e.r&&(R.e.r=t.sheetRows-1,R.e.r>h.e.r&&(R.e.r=h.e.r),R.e.r<R.s.r&&(R.s.r=R.e.r),R.e.c>h.e.c&&(R.e.c=h.e.c),R.e.c<R.s.c&&(R.s.c=R.e.c),u["!fullref"]=u["!ref"],u["!ref"]=it(R))}return b.length>0&&(u["!cols"]=b),T.length>0&&(u["!merges"]=T),u}function t5(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+it(e[r])+'"/>';return t+"</mergeCells>"}function M1(e,t,r,n){var i=et(e);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=pt(Lt(i.codeName)))}function r5(e,t,r,n,i){M1(e.slice(0,e.indexOf(">")),r,n,i)}function a5(e,t,r,n,i){var l=!1,o={},u=null;if(n.bookType!=="xlsx"&&t.vbaraw){var h=t.SheetNames[r];try{t.Workbook&&(h=t.Workbook.Sheets[r].CodeName||h)}catch{}l=!0,o.codeName=Sn(Ot(h))}if(e&&e["!outline"]){var d={summaryBelow:1,summaryRight:1};e["!outline"].above&&(d.summaryBelow=0),e["!outline"].left&&(d.summaryRight=0),u=(u||"")+Be("outlinePr",null,d)}!l&&!u||(i[i.length]=Be("sheetPr",u,o))}var n5=["objects","scenarios","selectLockedCells","selectUnlockedCells"],i5=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function s5(e){var t={sheet:1};return n5.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),i5.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=A1(e.password).toString(16).toUpperCase()),Be("sheetProtection",null,t)}function l5(e,t,r){for(var n=Array.isArray(e),i=0;i!=t.length;++i){var l=et(Lt(t[i]),!0);if(!l.ref)return;var o=((r||{})["!id"]||[])[l.id];o?(l.Target=o.Target,l.location&&(l.Target+="#"+pt(l.location))):(l.Target="#"+pt(l.location),o={Target:l.Target,TargetMode:"Internal"}),l.Rel=o,l.tooltip&&(l.Tooltip=l.tooltip,delete l.tooltip);for(var u=gt(l.ref),h=u.s.r;h<=u.e.r;++h)for(var d=u.s.c;d<=u.e.c;++d){var x=Ze({c:d,r:h});n?(e[h]||(e[h]=[]),e[h][d]||(e[h][d]={t:"z",v:void 0}),e[h][d].l=l):(e[x]||(e[x]={t:"z",v:void 0}),e[x].l=l)}}}function c5(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function o5(e){return ws(e),Be("pageMargins",null,e)}function u5(e,t){for(var r=!1,n=0;n!=t.length;++n){var i=et(t[n],!0);i.hidden&&(i.hidden=$t(i.hidden));var l=parseInt(i.min,10)-1,o=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,C1(i.width)),ji(i);l<=o;)e[l++]=qt(i)}}function f5(e,t){for(var r=["<cols>"],n,i=0;i!=t.length;++i)(n=t[i])&&(r[r.length]=Be("col",null,Iu(i,n)));return r[r.length]="</cols>",r.join("")}function h5(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function d5(e,t,r,n){var i=typeof e.ref=="string"?e.ref:it(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var l=r.Workbook.Names,o=da(i);o.s.r==o.e.r&&(o.e.r=da(t["!ref"]).e.r,i=it(o));for(var u=0;u<l.length;++u){var h=l[u];if(h.Name=="_xlnm._FilterDatabase"&&h.Sheet==n){h.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return u==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),Be("autoFilter",null,{ref:i})}var m5=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function x5(e,t){t.Views||(t.Views=[{}]),(e.match(m5)||[]).forEach(function(r,n){var i=et(r);t.Views[n]||(t.Views[n]={}),+i.zoomScale&&(t.Views[n].zoom=+i.zoomScale),$t(i.rightToLeft)&&(t.Views[n].RTL=!0)})}function p5(e,t,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Be("sheetViews",Be("sheetView",null,i),{})}function g5(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var i="",l=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":i=e.v?"1":"0";break;case"n":i=""+e.v;break;case"e":i=ri[e.v];break;case"d":n&&n.cellDates?i=Gt(e.v,-1).toISOString():(e=qt(e),e.t="n",i=""+(e.v=Er(Gt(e.v)))),typeof e.z>"u"&&(e.z=Je[14]);break;default:i=e.v;break}var u=jr("v",Ot(i)),h={r:t},d=$i(n.cellXfs,e,n);switch(d!==0&&(h.s=d),e.t){case"n":break;case"d":h.t="d";break;case"b":h.t="b";break;case"e":h.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){u=jr("v",""+F1(n.Strings,e.v,n.revStrings)),h.t="s";break}h.t="str";break}if(e.t!=l&&(e.t=l,e.v=o),typeof e.f=="string"&&e.f){var x=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;u=Be("f",Ot(e.f),x)+(e.v!=null?u:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(h.cm=1),Be("c",u,h)}var v5=(function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,l=co("v"),o=co("f");return function(h,d,x,g,v,_){for(var w=0,y="",b=[],A=[],M=0,T=0,U=0,q="",I,R,Q=0,G=0,ae,ne,J=0,ge=0,ke=Array.isArray(_.CellXf),be,Y=[],le=[],_e=Array.isArray(d),Z=[],De={},j=!1,N=!!x.sheetStubs,z=h.split(t),P=0,V=z.length;P!=V;++P){y=z[P].trim();var ce=y.length;if(ce!==0){var we=0;e:for(w=0;w<ce;++w)switch(y[w]){case">":if(y[w-1]!="/"){++w;break e}if(x&&x.cellStyles){if(R=et(y.slice(we,w),!0),Q=R.r!=null?parseInt(R.r,10):Q+1,G=-1,x.sheetRows&&x.sheetRows<Q)continue;De={},j=!1,R.ht&&(j=!0,De.hpt=parseFloat(R.ht),De.hpx=Pl(De.hpt)),R.hidden=="1"&&(j=!0,De.hidden=!0),R.outlineLevel!=null&&(j=!0,De.level=+R.outlineLevel),j&&(Z[Q-1]=De)}break;case"<":we=w;break}if(we>=w)break;if(R=et(y.slice(we,w),!0),Q=R.r!=null?parseInt(R.r,10):Q+1,G=-1,!(x.sheetRows&&x.sheetRows<Q)){g.s.r>Q-1&&(g.s.r=Q-1),g.e.r<Q-1&&(g.e.r=Q-1),x&&x.cellStyles&&(De={},j=!1,R.ht&&(j=!0,De.hpt=parseFloat(R.ht),De.hpx=Pl(De.hpt)),R.hidden=="1"&&(j=!0,De.hidden=!0),R.outlineLevel!=null&&(j=!0,De.level=+R.outlineLevel),j&&(Z[Q-1]=De)),b=y.slice(w).split(e);for(var Ce=0;Ce!=b.length&&b[Ce].trim().charAt(0)=="<";++Ce);for(b=b.slice(Ce),w=0;w!=b.length;++w)if(y=b[w].trim(),y.length!==0){if(A=y.match(r),M=w,T=0,U=0,y="<c "+(y.slice(0,1)=="<"?">":"")+y,A!=null&&A.length===2){for(M=0,q=A[1],T=0;T!=q.length&&!((U=q.charCodeAt(T)-64)<1||U>26);++T)M=26*M+U;--M,G=M}else++G;for(T=0;T!=y.length&&y.charCodeAt(T)!==62;++T);if(++T,R=et(y.slice(0,T),!0),R.r||(R.r=Ze({r:Q-1,c:G})),q=y.slice(T),I={t:""},(A=q.match(l))!=null&&A[1]!==""&&(I.v=pt(A[1])),x.cellFormula){if((A=q.match(o))!=null&&A[1]!==""){if(I.f=pt(Lt(A[1])).replace(/\r\n/g,`
`),x.xlfn||(I.f=uy(I.f)),A[0].indexOf('t="array"')>-1)I.F=(q.match(i)||[])[1],I.F.indexOf(":")>-1&&Y.push([gt(I.F),I.F]);else if(A[0].indexOf('t="shared"')>-1){ne=et(A[0]);var Ee=pt(Lt(A[1]));x.xlfn||(Ee=uy(Ee)),le[parseInt(ne.si,10)]=[ne,Ee,R.r]}}else(A=q.match(/<f[^>]*\/>/))&&(ne=et(A[0]),le[ne.si]&&(I.f=mN(le[ne.si][1],le[ne.si][2],R.r)));var Oe=Zt(R.r);for(T=0;T<Y.length;++T)Oe.r>=Y[T][0].s.r&&Oe.r<=Y[T][0].e.r&&Oe.c>=Y[T][0].s.c&&Oe.c<=Y[T][0].e.c&&(I.F=Y[T][1])}if(R.t==null&&I.v===void 0)if(I.f||I.F)I.v=0,I.t="n";else if(N)I.t="z";else continue;else I.t=R.t||"n";switch(g.s.c>G&&(g.s.c=G),g.e.c<G&&(g.e.c=G),I.t){case"n":if(I.v==""||I.v==null){if(!N)continue;I.t="z"}else I.v=parseFloat(I.v);break;case"s":if(typeof I.v>"u"){if(!N)continue;I.t="z"}else ae=Kc[parseInt(I.v,10)],I.v=ae.t,I.r=ae.r,x.cellHTML&&(I.h=ae.h);break;case"str":I.t="s",I.v=I.v!=null?Lt(I.v):"",x.cellHTML&&(I.h=h1(I.v));break;case"inlineStr":A=q.match(n),I.t="s",A!=null&&(ae=k1(A[1]))?(I.v=ae.t,x.cellHTML&&(I.h=ae.h)):I.v="";break;case"b":I.v=$t(I.v);break;case"d":x.cellDates?I.v=Gt(I.v,1):(I.v=Er(Gt(I.v,1)),I.t="n");break;case"e":(!x||x.cellText!==!1)&&(I.w=I.v),I.v=P_[I.v];break}if(J=ge=0,be=null,ke&&R.s!==void 0&&(be=_.CellXf[R.s],be!=null&&(be.numFmtId!=null&&(J=be.numFmtId),x.cellStyles&&be.fillId!=null&&(ge=be.fillId))),I2(I,J,ge,x,v,_),x.cellDates&&ke&&I.t=="n"&&Hl(Je[J])&&(I.t="d",I.v=Fu(I.v)),R.cm&&x.xlmeta){var Qe=(x.xlmeta.Cell||[])[+R.cm-1];Qe&&Qe.type=="XLDAPR"&&(I.D=!0)}if(_e){var H=Zt(R.r);d[H.r]||(d[H.r]=[]),d[H.r][H.c]=I}else d[R.r]=I}}}}Z.length>0&&(d["!rows"]=Z)}})();function y5(e,t,r,n){var i=[],l=[],o=gt(e["!ref"]),u="",h,d="",x=[],g=0,v=0,_=e["!rows"],w=Array.isArray(e),y={r:d},b,A=-1;for(v=o.s.c;v<=o.e.c;++v)x[v]=Qt(v);for(g=o.s.r;g<=o.e.r;++g){for(l=[],d=or(g),v=o.s.c;v<=o.e.c;++v){h=x[v]+d;var M=w?(e[g]||[])[v]:e[h];M!==void 0&&(u=g5(M,h,e,t))!=null&&l.push(u)}(l.length>0||_&&_[g])&&(y={r:d},_&&_[g]&&(b=_[g],b.hidden&&(y.hidden=1),A=-1,b.hpx?A=po(b.hpx):b.hpt&&(A=b.hpt),A>-1&&(y.ht=A,y.customHeight=1),b.level&&(y.outlineLevel=b.level)),i[i.length]=Be("row",l.join(""),y))}if(_)for(;g<_.length;++g)_&&_[g]&&(y={r:g+1},b=_[g],b.hidden&&(y.hidden=1),A=-1,b.hpx?A=po(b.hpx):b.hpt&&(A=b.hpt),A>-1&&(y.ht=A,y.customHeight=1),b.level&&(y.outlineLevel=b.level),i[i.length]=Be("row","",y));return i.join("")}function j2(e,t,r,n){var i=[fr,Be("worksheet",null,{xmlns:Cs[0],"xmlns:r":br.r})],l=r.SheetNames[e],o=0,u="",h=r.Sheets[l];h==null&&(h={});var d=h["!ref"]||"A1",x=gt(d);if(x.e.c>16383||x.e.r>1048575){if(t.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");x.e.c=Math.min(x.e.c,16383),x.e.r=Math.min(x.e.c,1048575),d=it(x)}n||(n={}),h["!comments"]=[];var g=[];a5(h,r,e,t,i),i[i.length]=Be("dimension",null,{ref:d}),i[i.length]=p5(h,t,e,r),t.sheetFormat&&(i[i.length]=Be("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),h["!cols"]!=null&&h["!cols"].length>0&&(i[i.length]=f5(h,h["!cols"])),i[o=i.length]="<sheetData/>",h["!links"]=[],h["!ref"]!=null&&(u=y5(h,t),u.length>0&&(i[i.length]=u)),i.length>o+1&&(i[i.length]="</sheetData>",i[o]=i[o].replace("/>",">")),h["!protect"]&&(i[i.length]=s5(h["!protect"])),h["!autofilter"]!=null&&(i[i.length]=d5(h["!autofilter"],h,r,e)),h["!merges"]!=null&&h["!merges"].length>0&&(i[i.length]=t5(h["!merges"]));var v=-1,_,w=-1;return h["!links"].length>0&&(i[i.length]="<hyperlinks>",h["!links"].forEach(function(y){y[1].Target&&(_={ref:y[0]},y[1].Target.charAt(0)!="#"&&(w=Nt(n,-1,Ot(y[1].Target).replace(/#.*$/,""),ot.HLINK),_["r:id"]="rId"+w),(v=y[1].Target.indexOf("#"))>-1&&(_.location=Ot(y[1].Target.slice(v+1))),y[1].Tooltip&&(_.tooltip=Ot(y[1].Tooltip)),i[i.length]=Be("hyperlink",null,_))}),i[i.length]="</hyperlinks>"),delete h["!links"],h["!margins"]!=null&&(i[i.length]=o5(h["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(i[i.length]=jr("ignoredErrors",Be("ignoredError",null,{numberStoredAsText:1,sqref:d}))),g.length>0&&(w=Nt(n,-1,"../drawings/drawing"+(e+1)+".xml",ot.DRAW),i[i.length]=Be("drawing",null,{"r:id":"rId"+w}),h["!drawing"]=g),h["!comments"].length>0&&(w=Nt(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",ot.VML),i[i.length]=Be("legacyDrawing",null,{"r:id":"rId"+w}),h["!legacy"]=w),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function _5(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var l=e.read_shift(1);return e.l=n,l&7&&(r.level=l&7),l&16&&(r.hidden=!0),l&32&&(r.hpt=i/20),r}function w5(e,t,r){var n=pe(145),i=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var l=320;i.hpx?l=po(i.hpx)*20:i.hpt&&(l=i.hpt*20),n.write_shift(2,l),n.write_shift(1,0);var o=0;i.level&&(o|=i.level),i.hidden&&(o|=16),(i.hpx||i.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var u=0,h=n.l;n.l+=4;for(var d={r:e,c:0},x=0;x<16;++x)if(!(t.s.c>x+1<<10||t.e.c<x<<10)){for(var g=-1,v=-1,_=x<<10;_<x+1<<10;++_){d.c=_;var w=Array.isArray(r)?(r[d.r]||[])[d.c]:r[Ze(d)];w&&(g<0&&(g=_),v=_)}g<0||(++u,n.write_shift(4,g),n.write_shift(4,v))}var y=n.l;return n.l=h,n.write_shift(4,u),n.l=y,n.length>n.l?n.slice(0,n.l):n}function S5(e,t,r,n){var i=w5(n,r,t);(i.length>17||(t["!rows"]||[])[n])&&Ne(e,0,i)}var b5=Ds,E5=Gl;function T5(){}function k5(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=NA(e),r}function A5(e,t,r){r==null&&(r=pe(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return _u({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),B_(e,r),r.slice(0,r.l)}function C5(e){var t=Ja(e);return[t]}function N5(e,t,r){return r==null&&(r=pe(8)),Ns(t,r)}function O5(e){var t=Os(e);return[t]}function R5(e,t,r){return r==null&&(r=pe(4)),Rs(t,r)}function D5(e){var t=Ja(e),r=e.read_shift(1);return[t,r,"b"]}function F5(e,t,r){return r==null&&(r=pe(9)),Ns(t,r),r.write_shift(1,e.v?1:0),r}function M5(e){var t=Os(e),r=e.read_shift(1);return[t,r,"b"]}function B5(e,t,r){return r==null&&(r=pe(5)),Rs(t,r),r.write_shift(1,e.v?1:0),r}function L5(e){var t=Ja(e),r=e.read_shift(1);return[t,r,"e"]}function I5(e,t,r){return r==null&&(r=pe(9)),Ns(t,r),r.write_shift(1,e.v),r}function U5(e){var t=Os(e),r=e.read_shift(1);return[t,r,"e"]}function j5(e,t,r){return r==null&&(r=pe(8)),Rs(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function P5(e){var t=Ja(e),r=e.read_shift(4);return[t,r,"s"]}function z5(e,t,r){return r==null&&(r=pe(12)),Ns(t,r),r.write_shift(4,t.v),r}function H5(e){var t=Os(e),r=e.read_shift(4);return[t,r,"s"]}function V5(e,t,r){return r==null&&(r=pe(8)),Rs(t,r),r.write_shift(4,t.v),r}function $5(e){var t=Ja(e),r=Xr(e);return[t,r,"n"]}function G5(e,t,r){return r==null&&(r=pe(16)),Ns(t,r),Es(e.v,r),r}function P2(e){var t=Os(e),r=Xr(e);return[t,r,"n"]}function q5(e,t,r){return r==null&&(r=pe(12)),Rs(t,r),Es(e.v,r),r}function X5(e){var t=Ja(e),r=w1(e);return[t,r,"n"]}function W5(e,t,r){return r==null&&(r=pe(12)),Ns(t,r),L_(e.v,r),r}function K5(e){var t=Os(e),r=w1(e);return[t,r,"n"]}function Y5(e,t,r){return r==null&&(r=pe(8)),Rs(t,r),L_(e.v,r),r}function J5(e){var t=Ja(e),r=v1(e);return[t,r,"is"]}function Q5(e){var t=Ja(e),r=Wr(e);return[t,r,"str"]}function Z5(e,t,r){return r==null&&(r=pe(12+4*e.v.length)),Ns(t,r),Nr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function eR(e){var t=Os(e),r=Wr(e);return[t,r,"str"]}function tR(e,t,r){return r==null&&(r=pe(8+4*e.v.length)),Rs(t,r),Nr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function rR(e,t,r){var n=e.l+t,i=Ja(e);i.r=r["!row"];var l=e.read_shift(1),o=[i,l,"b"];if(r.cellFormula){e.l+=2;var u=Lu(e,n-e.l,r);o[3]=Gr(u,null,i,r.supbooks,r)}else e.l=n;return o}function aR(e,t,r){var n=e.l+t,i=Ja(e);i.r=r["!row"];var l=e.read_shift(1),o=[i,l,"e"];if(r.cellFormula){e.l+=2;var u=Lu(e,n-e.l,r);o[3]=Gr(u,null,i,r.supbooks,r)}else e.l=n;return o}function nR(e,t,r){var n=e.l+t,i=Ja(e);i.r=r["!row"];var l=Xr(e),o=[i,l,"n"];if(r.cellFormula){e.l+=2;var u=Lu(e,n-e.l,r);o[3]=Gr(u,null,i,r.supbooks,r)}else e.l=n;return o}function iR(e,t,r){var n=e.l+t,i=Ja(e);i.r=r["!row"];var l=Wr(e),o=[i,l,"str"];if(r.cellFormula){e.l+=2;var u=Lu(e,n-e.l,r);o[3]=Gr(u,null,i,r.supbooks,r)}else e.l=n;return o}var sR=Ds,lR=Gl;function cR(e,t){return t==null&&(t=pe(4)),t.write_shift(4,e),t}function oR(e,t){var r=e.l+t,n=Ds(e),i=y1(e),l=Wr(e),o=Wr(e),u=Wr(e);e.l=r;var h={rfx:n,relId:i,loc:l,display:u};return o&&(h.Tooltip=o),h}function uR(e,t){var r=pe(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Gl({s:Zt(e[0]),e:Zt(e[0])},r),_1("rId"+t,r);var n=e[1].Target.indexOf("#"),i=n==-1?"":e[1].Target.slice(n+1);return Nr(i||"",r),Nr(e[1].Tooltip||"",r),Nr("",r),r.slice(0,r.l)}function fR(){}function hR(e,t,r){var n=e.l+t,i=I_(e),l=e.read_shift(1),o=[i];if(o[2]=l,r.cellFormula){var u=LO(e,n-e.l,r);o[1]=u}else e.l=n;return o}function dR(e,t,r){var n=e.l+t,i=Ds(e),l=[i];if(r.cellFormula){var o=UO(e,n-e.l,r);l[1]=o,e.l=n}else e.l=n;return l}function mR(e,t,r){r==null&&(r=pe(18));var n=Iu(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return t.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),t.level&&(i|=t.level<<8),r.write_shift(2,i),r}var z2=["left","right","top","bottom","header","footer"];function xR(e){var t={};return z2.forEach(function(r){t[r]=Xr(e)}),t}function pR(e,t){return t==null&&(t=pe(48)),ws(e),z2.forEach(function(r){Es(e[r],t)}),t}function gR(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function vR(e,t,r){r==null&&(r=pe(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function yR(e){var t=pe(24);return t.write_shift(4,4),t.write_shift(4,1),Gl(e,t),t}function _R(e,t){return t==null&&(t=pe(66)),t.write_shift(2,e.password?A1(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function wR(){}function SR(){}function bR(e,t,r,n,i,l,o){if(!e)return e;var u=t||{};n||(n={"!id":{}});var h=u.dense?[]:{},d,x={s:{r:2e6,c:2e6},e:{r:0,c:0}},g=!1,v=!1,_,w,y,b,A,M,T,U,q,I=[];u.biff=12,u["!row"]=0;var R=0,Q=!1,G=[],ae={},ne=u.supbooks||i.supbooks||[[]];if(ne.sharedf=ae,ne.arrayf=G,ne.SheetNames=i.SheetNames||i.Sheets.map(function(_e){return _e.name}),!u.supbooks&&(u.supbooks=ne,i.Names))for(var J=0;J<i.Names.length;++J)ne[0][J+1]=i.Names[J];var ge=[],ke=[],be=!1;go[16]={n:"BrtShortReal",f:P2};var Y;if(ti(e,function(Z,De,j){if(!v)switch(j){case 148:d=Z;break;case 0:_=Z,u.sheetRows&&u.sheetRows<=_.r&&(v=!0),U=or(b=_.r),u["!row"]=_.r,(Z.hidden||Z.hpt||Z.level!=null)&&(Z.hpt&&(Z.hpx=Pl(Z.hpt)),ke[Z.r]=Z);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(w={t:Z[2]},Z[2]){case"n":w.v=Z[1];break;case"s":T=Kc[Z[1]],w.v=T.t,w.r=T.r;break;case"b":w.v=!!Z[1];break;case"e":w.v=Z[1],u.cellText!==!1&&(w.w=ri[w.v]);break;case"str":w.t="s",w.v=Z[1];break;case"is":w.t="s",w.v=Z[1].t;break}if((y=o.CellXf[Z[0].iStyleRef])&&I2(w,y.numFmtId,null,u,l,o),A=Z[0].c==-1?A+1:Z[0].c,u.dense?(h[b]||(h[b]=[]),h[b][A]=w):h[Qt(A)+U]=w,u.cellFormula){for(Q=!1,R=0;R<G.length;++R){var N=G[R];_.r>=N[0].s.r&&_.r<=N[0].e.r&&A>=N[0].s.c&&A<=N[0].e.c&&(w.F=it(N[0]),Q=!0)}!Q&&Z.length>3&&(w.f=Z[3])}if(x.s.r>_.r&&(x.s.r=_.r),x.s.c>A&&(x.s.c=A),x.e.r<_.r&&(x.e.r=_.r),x.e.c<A&&(x.e.c=A),u.cellDates&&y&&w.t=="n"&&Hl(Je[y.numFmtId])){var z=gs(w.v);z&&(w.t="d",w.v=new Date(z.y,z.m-1,z.d,z.H,z.M,z.S,z.u))}Y&&(Y.type=="XLDAPR"&&(w.D=!0),Y=void 0);break;case 1:case 12:if(!u.sheetStubs||g)break;w={t:"z",v:void 0},A=Z[0].c==-1?A+1:Z[0].c,u.dense?(h[b]||(h[b]=[]),h[b][A]=w):h[Qt(A)+U]=w,x.s.r>_.r&&(x.s.r=_.r),x.s.c>A&&(x.s.c=A),x.e.r<_.r&&(x.e.r=_.r),x.e.c<A&&(x.e.c=A),Y&&(Y.type=="XLDAPR"&&(w.D=!0),Y=void 0);break;case 176:I.push(Z);break;case 49:Y=((u.xlmeta||{}).Cell||[])[Z-1];break;case 494:var P=n["!id"][Z.relId];for(P?(Z.Target=P.Target,Z.loc&&(Z.Target+="#"+Z.loc),Z.Rel=P):Z.relId==""&&(Z.Target="#"+Z.loc),b=Z.rfx.s.r;b<=Z.rfx.e.r;++b)for(A=Z.rfx.s.c;A<=Z.rfx.e.c;++A)u.dense?(h[b]||(h[b]=[]),h[b][A]||(h[b][A]={t:"z",v:void 0}),h[b][A].l=Z):(M=Ze({c:A,r:b}),h[M]||(h[M]={t:"z",v:void 0}),h[M].l=Z);break;case 426:if(!u.cellFormula)break;G.push(Z),q=u.dense?h[b][A]:h[Qt(A)+U],q.f=Gr(Z[1],x,{r:_.r,c:A},ne,u),q.F=it(Z[0]);break;case 427:if(!u.cellFormula)break;ae[Ze(Z[0].s)]=Z[1],q=u.dense?h[b][A]:h[Qt(A)+U],q.f=Gr(Z[1],x,{r:_.r,c:A},ne,u);break;case 60:if(!u.cellStyles)break;for(;Z.e>=Z.s;)ge[Z.e--]={width:Z.w/256,hidden:!!(Z.flags&1),level:Z.level},be||(be=!0,C1(Z.w/256)),ji(ge[Z.e+1]);break;case 161:h["!autofilter"]={ref:it(Z)};break;case 476:h["!margins"]=Z;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),Z.name&&(i.Sheets[r].CodeName=Z.name),(Z.above||Z.left)&&(h["!outline"]={above:Z.above,left:Z.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),Z.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:g=!0;break;case 36:g=!1;break;case 37:g=!0;break;case 38:g=!1;break;default:if(!De.T){if(!g||u.WTF)throw new Error("Unexpected record 0x"+j.toString(16))}}},u),delete u.supbooks,delete u["!row"],!h["!ref"]&&(x.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(h["!ref"]=it(d||x)),u.sheetRows&&h["!ref"]){var le=gt(h["!ref"]);u.sheetRows<=+le.e.r&&(le.e.r=u.sheetRows-1,le.e.r>x.e.r&&(le.e.r=x.e.r),le.e.r<le.s.r&&(le.s.r=le.e.r),le.e.c>x.e.c&&(le.e.c=x.e.c),le.e.c<le.s.c&&(le.s.c=le.e.c),h["!fullref"]=h["!ref"],h["!ref"]=it(le))}return I.length>0&&(h["!merges"]=I),ge.length>0&&(h["!cols"]=ge),ke.length>0&&(h["!rows"]=ke),h}function ER(e,t,r,n,i,l,o){if(t.v===void 0)return!1;var u="";switch(t.t){case"b":u=t.v?"1":"0";break;case"d":t=qt(t),t.z=t.z||Je[14],t.v=Er(Gt(t.v)),t.t="n";break;case"n":case"e":u=""+t.v;break;default:u=t.v;break}var h={r,c:n};switch(h.s=$i(i.cellXfs,t,i),t.l&&l["!links"].push([Ze(h),t.l]),t.c&&l["!comments"].push([Ze(h),t.c]),t.t){case"s":case"str":return i.bookSST?(u=F1(i.Strings,t.v,i.revStrings),h.t="s",h.v=u,o?Ne(e,18,V5(t,h)):Ne(e,7,z5(t,h))):(h.t="str",o?Ne(e,17,tR(t,h)):Ne(e,6,Z5(t,h))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?Ne(e,13,Y5(t,h)):Ne(e,2,W5(t,h)):o?Ne(e,16,q5(t,h)):Ne(e,5,G5(t,h)),!0;case"b":return h.t="b",o?Ne(e,15,B5(t,h)):Ne(e,4,F5(t,h)),!0;case"e":return h.t="e",o?Ne(e,14,j5(t,h)):Ne(e,3,I5(t,h)),!0}return o?Ne(e,12,R5(t,h)):Ne(e,1,N5(t,h)),!0}function TR(e,t,r,n){var i=gt(t["!ref"]||"A1"),l,o="",u=[];Ne(e,145);var h=Array.isArray(t),d=i.e.r;t["!rows"]&&(d=Math.max(i.e.r,t["!rows"].length-1));for(var x=i.s.r;x<=d;++x){o=or(x),S5(e,t,i,x);var g=!1;if(x<=i.e.r)for(var v=i.s.c;v<=i.e.c;++v){x===i.s.r&&(u[v]=Qt(v)),l=u[v]+o;var _=h?(t[x]||[])[v]:t[l];if(!_){g=!1;continue}g=ER(e,_,x,v,n,t,g)}}Ne(e,146)}function kR(e,t){!t||!t["!merges"]||(Ne(e,177,cR(t["!merges"].length)),t["!merges"].forEach(function(r){Ne(e,176,lR(r))}),Ne(e,178))}function AR(e,t){!t||!t["!cols"]||(Ne(e,390),t["!cols"].forEach(function(r,n){r&&Ne(e,60,mR(n,r))}),Ne(e,391))}function CR(e,t){!t||!t["!ref"]||(Ne(e,648),Ne(e,649,yR(gt(t["!ref"]))),Ne(e,650))}function NR(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var i=Nt(r,-1,n[1].Target.replace(/#.*$/,""),ot.HLINK);Ne(e,494,uR(n,i))}}),delete t["!links"]}function OR(e,t,r,n){if(t["!comments"].length>0){var i=Nt(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",ot.VML);Ne(e,551,_1("rId"+i)),t["!legacy"]=i}}function RR(e,t,r,n){if(t["!autofilter"]){var i=t["!autofilter"],l=typeof i.ref=="string"?i.ref:it(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,u=da(l);u.s.r==u.e.r&&(u.e.r=da(t["!ref"]).e.r,l=it(u));for(var h=0;h<o.length;++h){var d=o[h];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==n){d.Ref="'"+r.SheetNames[n]+"'!"+l;break}}h==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+l}),Ne(e,161,Gl(gt(l))),Ne(e,162)}}function DR(e,t,r){Ne(e,133),Ne(e,137,vR(t,r)),Ne(e,138),Ne(e,134)}function FR(e,t){t["!protect"]&&Ne(e,535,_R(t["!protect"]))}function MR(e,t,r,n){var i=ha(),l=r.SheetNames[e],o=r.Sheets[l]||{},u=l;try{r&&r.Workbook&&(u=r.Workbook.Sheets[e].CodeName||u)}catch{}var h=gt(o["!ref"]||"A1");if(h.e.c>16383||h.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],Ne(i,129),(r.vbaraw||o["!outline"])&&Ne(i,147,A5(u,o["!outline"])),Ne(i,148,E5(h)),DR(i,o,r.Workbook),AR(i,o),TR(i,o,e,t),FR(i,o),RR(i,o,r,e),kR(i,o),NR(i,o,n),o["!margins"]&&Ne(i,476,pR(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&CR(i,o),OR(i,o,e,n),Ne(i,130),i.end()}function BR(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(l){var o=l.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=r?+o[2]:o[2])});var i=pt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(l){n=l.replace(/<.*?>/g,"")}),[t,i,n]}function LR(e,t,r,n,i,l){var o=l||{"!type":"chart"};if(!e)return l;var u=0,h=0,d="A",x={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(g){var v=BR(g);x.s.r=x.s.c=0,x.e.c=u,d=Qt(u),v[0].forEach(function(_,w){o[d+or(w)]={t:"n",v:_,z:v[1]},h=w}),x.e.r<h&&(x.e.r=h),++u}),u>0&&(o["!ref"]=it(x)),o}function IR(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var l={"!type":"chart","!drawel":null,"!rel":""},o,u=e.match(U2);return u&&M1(u[0],l,i,r),(o=e.match(/drawing r:id="(.*?)"/))&&(l["!rel"]=o[1]),n["!id"][l["!rel"]]&&(l["!drawel"]=n["!id"][l["!rel"]]),l}function UR(e,t){e.l+=10;var r=Wr(e);return{name:r}}function jR(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var l={"!type":"chart","!drawel":null,"!rel":""},o=!1;return ti(e,function(h,d,x){switch(x){case 550:l["!rel"]=h;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),h.name&&(i.Sheets[r].CodeName=h.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+x.toString(16))}}}},t),n["!id"][l["!rel"]]&&(l["!drawel"]=n["!id"][l["!rel"]]),l}var B1=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],PR=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],zR=[],HR=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function xy(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],i=0;i!=t.length;++i){var l=t[i];if(n[l[0]]==null)n[l[0]]=l[1];else switch(l[2]){case"bool":typeof n[l[0]]=="string"&&(n[l[0]]=$t(n[l[0]]));break;case"int":typeof n[l[0]]=="string"&&(n[l[0]]=parseInt(n[l[0]],10));break}}}function py(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=$t(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function H2(e){py(e.WBProps,B1),py(e.CalcPr,HR),xy(e.WBView,PR),xy(e.Sheets,zR),Ll.date1904=$t(e.WBProps.date1904)}function VR(e){return!e.Workbook||!e.Workbook.WBProps?"false":$t(e.Workbook.WBProps.date1904)?"true":"false"}var $R="][*?/\\".split("");function V2(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return $R.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function GR(e,t,r){e.forEach(function(n,i){V2(n);for(var l=0;l<i;++l)if(n==e[l])throw new Error("Duplicate Sheet Name: "+n);if(r){var o=t&&t[i]&&t[i].CodeName||n;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function qR(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];GR(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)VO(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var XR=/<\w+:workbook/;function WR(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",l={},o=0;if(e.replace(Yr,function(h,d){var x=et(h);switch(bn(x[0])){case"<?xml":break;case"<workbook":h.match(XR)&&(i="xmlns"+h.match(/<(\w+):/)[1]),r.xmlns=x[i];break;case"</workbook>":break;case"<fileVersion":delete x[0],r.AppVersion=x;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":B1.forEach(function(g){if(x[g[0]]!=null)switch(g[2]){case"bool":r.WBProps[g[0]]=$t(x[g[0]]);break;case"int":r.WBProps[g[0]]=parseInt(x[g[0]],10);break;default:r.WBProps[g[0]]=x[g[0]]}}),x.codeName&&(r.WBProps.CodeName=Lt(x.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete x[0],r.WBView.push(x);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(x.state){case"hidden":x.Hidden=1;break;case"veryHidden":x.Hidden=2;break;default:x.Hidden=0}delete x.state,x.name=pt(Lt(x.name)),delete x[0],r.Sheets.push(x);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":l={},l.Name=Lt(x.name),x.comment&&(l.Comment=x.comment),x.localSheetId&&(l.Sheet=+x.localSheetId),$t(x.hidden||"0")&&(l.Hidden=!0),o=d+h.length;break;case"</definedName>":l.Ref=pt(Lt(e.slice(o,d))),r.Names.push(l);break;case"<definedName/>":break;case"<calcPr":delete x[0],r.CalcPr=x;break;case"<calcPr/>":delete x[0],r.CalcPr=x;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+x[0]+" in workbook")}return h}),Cs.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return H2(r),r}function $2(e){var t=[fr];t[t.length]=Be("workbook",null,{xmlns:Cs[0],"xmlns:r":br.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(B1.forEach(function(u){e.Workbook.WBProps[u[0]]!=null&&e.Workbook.WBProps[u[0]]!=u[1]&&(n[u[0]]=e.Workbook.WBProps[u[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Be("workbookPr",null,n);var i=e.Workbook&&e.Workbook.Sheets||[],l=0;if(i&&i[0]&&i[0].Hidden){for(t[t.length]="<bookViews>",l=0;l!=e.SheetNames.length&&!(!i[l]||!i[l].Hidden);++l);l==e.SheetNames.length&&(l=0),t[t.length]='<workbookView firstSheet="'+l+'" activeTab="'+l+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",l=0;l!=e.SheetNames.length;++l){var o={name:Ot(e.SheetNames[l].slice(0,31))};if(o.sheetId=""+(l+1),o["r:id"]="rId"+(l+1),i[l])switch(i[l].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=Be("sheet",null,o)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(u){var h={name:u.Name};u.Comment&&(h.comment=u.Comment),u.Sheet!=null&&(h.localSheetId=""+u.Sheet),u.Hidden&&(h.hidden="1"),u.Ref&&(t[t.length]=Be("definedName",Ot(u.Ref),h))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function KR(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Ld(e),r.name=Wr(e),r}function YR(e,t){return t||(t=pe(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),_1(e.strRelID,t),Nr(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function JR(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var i=t>8?Wr(e):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function QR(e,t){t||(t=pe(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),B_(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function ZR(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function eD(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),l=OA(e),o=IO(e,0,r),u=y1(e);e.l=n;var h={Name:l,Ptg:o};return i<268435455&&(h.Sheet=i),u&&(h.Comment=u),h}function tD(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;t||(t={}),t.biff=12;var l=[],o=[[]];return o.SheetNames=[],o.XTI=[],go[16]={n:"BrtFRTArchID$",f:ZR},ti(e,function(h,d,x){switch(x){case 156:o.SheetNames.push(h.name),r.Sheets.push(h);break;case 153:r.WBProps=h;break;case 39:h.Sheet!=null&&(t.SID=h.Sheet),h.Ref=Gr(h.Ptg,null,null,o,t),delete t.SID,delete h.Ptg,l.push(h);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([x,h]):o[0]=[x,h],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(h),o.XTI=o.XTI.concat(h);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(x),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(x),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!d.T){if(!i||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+x.toString(16))}}},t),H2(r),r.Names=l,r.supbooks=o,r}function rD(e,t){Ne(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};Ne(e,156,YR(i))}Ne(e,144)}function aD(e,t){t||(t=pe(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Nr("SheetJS",t),Nr(du.version,t),Nr(du.version,t),Nr("7262",t),t.length>t.l?t.slice(0,t.l):t}function nD(e,t){t||(t=pe(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function iD(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,i=-1,l=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&l==-1&&(l=n);l>i||(Ne(e,135),Ne(e,158,nD(i)),Ne(e,136))}}function sD(e,t){var r=ha();return Ne(r,131),Ne(r,128,aD()),Ne(r,153,QR(e.Workbook&&e.Workbook.WBProps||null)),iD(r,e),rD(r,e),Ne(r,132),r.end()}function lD(e,t,r){return t.slice(-4)===".bin"?tD(e,r):WR(e,r)}function cD(e,t,r,n,i,l,o,u){return t.slice(-4)===".bin"?bR(e,n,r,i,l,o,u):e5(e,n,r,i,l,o,u)}function oD(e,t,r,n,i,l,o,u){return t.slice(-4)===".bin"?jR(e,n,r,i,l):IR(e,n,r,i,l)}function uD(e,t,r,n,i,l,o,u){return t.slice(-4)===".bin"?hN():dN()}function fD(e,t,r,n,i,l,o,u){return t.slice(-4)===".bin"?uN():fN()}function hD(e,t,r,n){return t.slice(-4)===".bin"?l8(e,r,n):K6(e,r,n)}function dD(e,t,r){return E2(e,r)}function mD(e,t,r){return t.slice(-4)===".bin"?m6(e,r):f6(e,r)}function xD(e,t,r){return t.slice(-4)===".bin"?iN(e,r):Y8(e,r)}function pD(e,t,r){return t.slice(-4)===".bin"?X8(e):G8(e)}function gD(e,t,r,n){return r.slice(-4)===".bin"?W8(e,t,r,n):void 0}function vD(e,t,r){return t.slice(-4)===".bin"?H8(e,t,r):$8(e,t,r)}function yD(e,t,r){return(t.slice(-4)===".bin"?sD:$2)(e)}function _D(e,t,r,n,i){return(t.slice(-4)===".bin"?MR:j2)(e,r,n,i)}function wD(e,t,r){return(t.slice(-4)===".bin"?g8:S2)(e,r)}function SD(e,t,r){return(t.slice(-4)===".bin"?g6:m2)(e,r)}function bD(e,t,r){return(t.slice(-4)===".bin"?sN:A2)(e)}function ED(e){return(e.slice(-4)===".bin"?V8:T2)()}var G2=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,q2=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function an(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=e.match(G2),l,o,u,h;if(i)for(h=0;h!=i.length;++h)l=i[h].match(q2),(o=l[1].indexOf(":"))===-1?n[l[1]]=l[2].slice(1,l[2].length-1):(l[1].slice(0,6)==="xmlns:"?u="xmlns"+l[1].slice(6):u=l[1].slice(o+1),n[u]=l[2].slice(1,l[2].length-1));return n}function TD(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(G2),i,l,o,u;if(n)for(u=0;u!=n.length;++u)i=n[u].match(q2),(l=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(l+1),r[o]=i[2].slice(1,i[2].length-1));return r}var Jc;function kD(e,t){var r=Jc[e]||pt(e);return r==="General"?Ss(t):Ya(r,t)}function AD(e,t,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=$t(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=Gt(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[pt(t)]=i}function CD(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||ri[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=lo(e.v):e.w=Ss(e.v):e.w=kD(t||"General",e.v)}catch(l){if(r.WTF)throw l}try{var n=Jc[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&Hl(n)){var i=gs(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(l){if(r.WTF)throw l}}}function ND(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=z6[n.Pattern]||n.Pattern)}e[t.ID]=t}function OD(e,t,r,n,i,l,o,u,h,d){var x="General",g=n.StyleID,v={};d=d||{};var _=[],w=0;for(g===void 0&&u&&(g=u.StyleID),g===void 0&&o&&(g=o.StyleID);l[g]!==void 0&&(l[g].nf&&(x=l[g].nf),l[g].Interior&&_.push(l[g].Interior),!!l[g].Parent);)g=l[g].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=$t(e);break;case"String":n.t="s",n.r=Fv(pt(e)),n.v=e.indexOf("<")>-1?pt(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(Gt(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=pt(e):n.v<60&&(n.v=n.v-1),(!x||x=="General")&&(x="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=P_[e],d.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=Fv(t||e));break}if(CD(n,x,d),d.cellFormula!==!1)if(n.Formula){var y=pt(n.Formula);y.charCodeAt(0)==61&&(y=y.slice(1)),n.f=Bl(y,i),delete n.Formula,n.ArrayRange=="RC"?n.F=Bl("RC:RC",i):n.ArrayRange&&(n.F=Bl(n.ArrayRange,i),h.push([gt(n.F),n.F]))}else for(w=0;w<h.length;++w)i.r>=h[w][0].s.r&&i.r<=h[w][0].e.r&&i.c>=h[w][0].s.c&&i.c<=h[w][0].e.c&&(n.F=h[w][1]);d.cellStyles&&(_.forEach(function(b){!v.patternType&&b.patternType&&(v.patternType=b.patternType)}),n.s=v),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function RD(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function vd(e,t){var r=t||{};Vl();var n=Pc(d1(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Lt(n));var i=n.slice(0,1024).toLowerCase(),l=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var o=qt(r);return o.type="string",jl.to_workbook(n,o)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ut){i.indexOf("<"+Ut)>=0&&(l=!0)}),l)return pF(n,r);Jc={"General Number":"General","General Date":Je[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Je[15],"Short Date":Je[14],"Long Time":Je[19],"Medium Time":Je[18],"Short Time":Je[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Je[2],Standard:Je[4],Percent:Je[10],Scientific:Je[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var u,h=[],d,x={},g=[],v=r.dense?[]:{},_="",w={},y={},b=an('<Data ss:Type="String">'),A=0,M=0,T=0,U={s:{r:2e6,c:2e6},e:{r:0,c:0}},q={},I={},R="",Q=0,G=[],ae={},ne={},J=0,ge=[],ke=[],be={},Y=[],le,_e=!1,Z=[],De=[],j={},N=0,z=0,P={Sheets:[],WBProps:{date1904:!1}},V={};uo.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ce="";u=uo.exec(n);)switch(u[3]=(ce=u[3]).toLowerCase()){case"data":if(ce=="data"){if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break}if(h[h.length-1][1])break;u[1]==="/"?OD(n.slice(A,u.index),R,b,h[h.length-1][0]=="comment"?be:w,{c:M,r:T},q,Y[M],y,Z,r):(R="",b=an(u[0]),A=u.index+u[0].length);break;case"cell":if(u[1]==="/")if(ke.length>0&&(w.c=ke),(!r.sheetRows||r.sheetRows>T)&&w.v!==void 0&&(r.dense?(v[T]||(v[T]=[]),v[T][M]=w):v[Qt(M)+or(T)]=w),w.HRef&&(w.l={Target:pt(w.HRef)},w.HRefScreenTip&&(w.l.Tooltip=w.HRefScreenTip),delete w.HRef,delete w.HRefScreenTip),(w.MergeAcross||w.MergeDown)&&(N=M+(parseInt(w.MergeAcross,10)|0),z=T+(parseInt(w.MergeDown,10)|0),G.push({s:{c:M,r:T},e:{c:N,r:z}})),!r.sheetStubs)w.MergeAcross?M=N+1:++M;else if(w.MergeAcross||w.MergeDown){for(var we=M;we<=N;++we)for(var Ce=T;Ce<=z;++Ce)(we>M||Ce>T)&&(r.dense?(v[Ce]||(v[Ce]=[]),v[Ce][we]={t:"z"}):v[Qt(we)+or(Ce)]={t:"z"});M=N+1}else++M;else w=TD(u[0]),w.Index&&(M=+w.Index-1),M<U.s.c&&(U.s.c=M),M>U.e.c&&(U.e.c=M),u[0].slice(-2)==="/>"&&++M,ke=[];break;case"row":u[1]==="/"||u[0].slice(-2)==="/>"?(T<U.s.r&&(U.s.r=T),T>U.e.r&&(U.e.r=T),u[0].slice(-2)==="/>"&&(y=an(u[0]),y.Index&&(T=+y.Index-1)),M=0,++T):(y=an(u[0]),y.Index&&(T=+y.Index-1),j={},(y.AutoFitHeight=="0"||y.Height)&&(j.hpx=parseInt(y.Height,10),j.hpt=po(j.hpx),De[T]=j),y.Hidden=="1"&&(j.hidden=!0,De[T]=j));break;case"worksheet":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"));g.push(_),U.s.r<=U.e.r&&U.s.c<=U.e.c&&(v["!ref"]=it(U),r.sheetRows&&r.sheetRows<=U.e.r&&(v["!fullref"]=v["!ref"],U.e.r=r.sheetRows-1,v["!ref"]=it(U))),G.length&&(v["!merges"]=G),Y.length>0&&(v["!cols"]=Y),De.length>0&&(v["!rows"]=De),x[_]=v}else U={s:{r:2e6,c:2e6},e:{r:0,c:0}},T=M=0,h.push([u[3],!1]),d=an(u[0]),_=pt(d.Name),v=r.dense?[]:{},G=[],Z=[],De=[],V={name:_,Hidden:0},P.Sheets.push(V);break;case"table":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else{if(u[0].slice(-2)=="/>")break;h.push([u[3],!1]),Y=[],_e=!1}break;case"style":u[1]==="/"?ND(q,I,r):I=an(u[0]);break;case"numberformat":I.nf=pt(an(u[0]).Format||"General"),Jc[I.nf]&&(I.nf=Jc[I.nf]);for(var Ee=0;Ee!=392&&Je[Ee]!=I.nf;++Ee);if(Ee==392){for(Ee=57;Ee!=392;++Ee)if(Je[Ee]==null){Yn(I.nf,Ee);break}}break;case"column":if(h[h.length-1][0]!=="table")break;if(le=an(u[0]),le.Hidden&&(le.hidden=!0,delete le.Hidden),le.Width&&(le.wpx=parseInt(le.Width,10)),!_e&&le.wpx>10){_e=!0,qr=_2;for(var Oe=0;Oe<Y.length;++Oe)Y[Oe]&&ji(Y[Oe])}_e&&ji(le),Y[le.Index-1||Y.length]=le;for(var Qe=0;Qe<+le.Span;++Qe)Y[Y.length]=qt(le);break;case"namedrange":if(u[1]==="/")break;P.Names||(P.Names=[]);var H=et(u[0]),St={Name:H.Name,Ref:Bl(H.RefersTo.slice(1),{r:0,c:0})};P.Sheets.length>0&&(St.Sheet=P.Sheets.length-1),P.Names.push(St);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(u[0].slice(-2)==="/>")break;u[1]==="/"?R+=n.slice(Q,u.index):Q=u.index+u[0].length;break;case"interior":if(!r.cellStyles)break;I.Interior=an(u[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(u[0].slice(-2)==="/>")break;u[1]==="/"?t3(ae,ce,n.slice(J,u.index)):J=u.index+u[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else h.push([u[3],!1]);break;case"comment":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"));RD(be),ke.push(be)}else h.push([u[3],!1]),d=an(u[0]),be={a:d.Author};break;case"autofilter":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else if(u[0].charAt(u[0].length-2)!=="/"){var tt=an(u[0]);v["!autofilter"]={ref:Bl(tt.Range).replace(/\$/g,"")},h.push([u[3],!0])}break;case"name":break;case"datavalidation":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break;case"null":break;default:if(h.length==0&&u[3]=="document"||h.length==0&&u[3]=="uof")return wy(n,r);var xt=!0;switch(h[h.length-1][0]){case"officedocumentsettings":switch(u[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:xt=!1}break;case"componentoptions":switch(u[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:xt=!1}break;case"excelworkbook":switch(u[3]){case"date1904":P.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:xt=!1}break;case"workbookoptions":switch(u[3]){case"owcversion":break;case"height":break;case"width":break;default:xt=!1}break;case"worksheetoptions":switch(u[3]){case"visible":if(u[0].slice(-2)!=="/>")if(u[1]==="/")switch(n.slice(J,u.index)){case"SheetHidden":V.Hidden=1;break;case"SheetVeryHidden":V.Hidden=2;break}else J=u.index+u[0].length;break;case"header":v["!margins"]||ws(v["!margins"]={},"xlml"),isNaN(+et(u[0]).Margin)||(v["!margins"].header=+et(u[0]).Margin);break;case"footer":v["!margins"]||ws(v["!margins"]={},"xlml"),isNaN(+et(u[0]).Margin)||(v["!margins"].footer=+et(u[0]).Margin);break;case"pagemargins":var We=et(u[0]);v["!margins"]||ws(v["!margins"]={},"xlml"),isNaN(+We.Top)||(v["!margins"].top=+We.Top),isNaN(+We.Left)||(v["!margins"].left=+We.Left),isNaN(+We.Right)||(v["!margins"].right=+We.Right),isNaN(+We.Bottom)||(v["!margins"].bottom=+We.Bottom);break;case"displayrighttoleft":P.Views||(P.Views=[]),P.Views[0]||(P.Views[0]={}),P.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":v["!outline"]||(v["!outline"]={}),v["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":v["!outline"]||(v["!outline"]={}),v["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:xt=!1}break;case"pivottable":case"pivotcache":switch(u[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:xt=!1}break;case"pagebreaks":switch(u[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:xt=!1}break;case"autofilter":switch(u[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:xt=!1}break;case"querytable":switch(u[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:xt=!1}break;case"datavalidation":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:xt=!1}break;case"sorting":case"conditionalformatting":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:xt=!1}break;case"mapinfo":case"schema":case"data":switch(u[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:xt=!1}break;case"smarttags":break;default:xt=!1;break}if(xt||u[3].match(/!\[CDATA/))break;if(!h[h.length-1][1])throw"Unrecognized tag: "+u[3]+"|"+h.join("|");if(h[h.length-1][0]==="customdocumentproperties"){if(u[0].slice(-2)==="/>")break;u[1]==="/"?AD(ne,ce,ge,n.slice(J,u.index)):(ge=u,J=u.index+u[0].length);break}if(r.WTF)throw"Unrecognized tag: "+u[3]+"|"+h.join("|")}var Ue={};return!r.bookSheets&&!r.bookProps&&(Ue.Sheets=x),Ue.SheetNames=g,Ue.Workbook=P,Ue.SSF=qt(Je),Ue.Props=ae,Ue.Custprops=ne,Ue}function Vd(e,t){switch(I1(t=t||{}),t.type||"base64"){case"base64":return vd(Oa(e),t);case"binary":case"buffer":case"file":return vd(e,t);case"array":return vd(Hi(e),t)}}function DD(e,t){var r=[];return e.Props&&r.push(r3(e.Props,t)),e.Custprops&&r.push(a3(e.Props,e.Custprops)),r.join("")}function FD(){return""}function MD(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,i){var l=[];l.push(Be("NumberFormat",null,{"ss:Format":Ot(Je[n.numFmtId])}));var o={"ss:ID":"s"+(21+i)};r.push(Be("Style",l.join(""),o))}),Be("Styles",r.join(""))}function X2(e){return Be("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+R1(e.Ref,{r:0,c:0})})}function BD(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var i=t[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(X2(i)))}return Be("Names",r.join(""))}function LD(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,l=[],o=0;o<i.length;++o){var u=i[o];u.Sheet==r&&(u.Name.match(/^_xlfn\./)||l.push(X2(u)))}return l.join("")}function ID(e,t,r,n){if(!e)return"";var i=[];if(e["!margins"]&&(i.push("<PageSetup>"),e["!margins"].header&&i.push(Be("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&i.push(Be("Footer",null,{"x:Margin":e["!margins"].footer})),i.push(Be("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(Be("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var l=0;l<r&&!(n.Workbook.Sheets[l]&&!n.Workbook.Sheets[l].Hidden);++l);l==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),e["!protect"]&&(i.push(jr("ProtectContents","True")),e["!protect"].objects&&i.push(jr("ProtectObjects","True")),e["!protect"].scenarios&&i.push(jr("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?i.push(jr("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&i.push(jr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&i.push("<"+o[1]+"/>")})),i.length==0?"":Be("WorksheetOptions",i.join(""),{xmlns:Ea.x})}function UD(e){return e.map(function(t){var r=iA(t.t||""),n=Be("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Be("Comment",n,{"ss:Author":t.a})}).join("")}function jD(e,t,r,n,i,l,o){if(!e||e.v==null&&e.f==null)return"";var u={};if(e.f&&(u["ss:Formula"]="="+Ot(R1(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var h=Zt(e.F.slice(t.length+1));u["ss:ArrayRange"]="RC:R"+(h.r==o.r?"":"["+(h.r-o.r)+"]")+"C"+(h.c==o.c?"":"["+(h.c-o.c)+"]")}if(e.l&&e.l.Target&&(u["ss:HRef"]=Ot(e.l.Target),e.l.Tooltip&&(u["x:HRefScreenTip"]=Ot(e.l.Tooltip))),r["!merges"])for(var d=r["!merges"],x=0;x!=d.length;++x)d[x].s.c!=o.c||d[x].s.r!=o.r||(d[x].e.c>d[x].s.c&&(u["ss:MergeAcross"]=d[x].e.c-d[x].s.c),d[x].e.r>d[x].s.r&&(u["ss:MergeDown"]=d[x].e.r-d[x].s.r));var g="",v="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":g="Number",v=String(e.v);break;case"b":g="Boolean",v=e.v?"1":"0";break;case"e":g="Error",v=ri[e.v];break;case"d":g="DateTime",v=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Je[14]);break;case"s":g="String",v=nA(e.v||"");break}var _=$i(n.cellXfs,e,n);u["ss:StyleID"]="s"+(21+_),u["ss:Index"]=o.c+1;var w=e.v!=null?v:"",y=e.t=="z"?"":'<Data ss:Type="'+g+'">'+w+"</Data>";return(e.c||[]).length>0&&(y+=UD(e.c)),Be("Cell",y,u)}function PD(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Pl(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function zD(e,t,r,n){if(!e["!ref"])return"";var i=gt(e["!ref"]),l=e["!merges"]||[],o=0,u=[];e["!cols"]&&e["!cols"].forEach(function(b,A){ji(b);var M=!!b.width,T=Iu(A,b),U={"ss:Index":A+1};M&&(U["ss:Width"]=mo(T.width)),b.hidden&&(U["ss:Hidden"]="1"),u.push(Be("Column",null,U))});for(var h=Array.isArray(e),d=i.s.r;d<=i.e.r;++d){for(var x=[PD(d,(e["!rows"]||[])[d])],g=i.s.c;g<=i.e.c;++g){var v=!1;for(o=0;o!=l.length;++o)if(!(l[o].s.c>g)&&!(l[o].s.r>d)&&!(l[o].e.c<g)&&!(l[o].e.r<d)){(l[o].s.c!=g||l[o].s.r!=d)&&(v=!0);break}if(!v){var _={r:d,c:g},w=Ze(_),y=h?(e[d]||[])[g]:e[w];x.push(jD(y,w,e,t,r,n,_))}}x.push("</Row>"),x.length>2&&u.push(x.join(""))}return u.join("")}function HD(e,t,r){var n=[],i=r.SheetNames[e],l=r.Sheets[i],o=l?LD(l,t,e,r):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=l?zD(l,t,e,r):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push(ID(l,t,e,r)),n.join("")}function VD(e,t){t||(t={}),e.SSF||(e.SSF=qt(Je)),e.SSF&&(Vl(),Ou(e.SSF),t.revssf=Du(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],$i(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(DD(e,t)),r.push(FD()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Be("Worksheet",HD(n,t,e),{"ss:Name":Ot(e.SheetNames[n])}));return r[2]=MD(e,t),r[3]=BD(e),fr+Be("Workbook",r.join(""),{xmlns:Ea.ss,"xmlns:o":Ea.o,"xmlns:x":Ea.x,"xmlns:ss":Ea.ss,"xmlns:dt":Ea.dt,"xmlns:html":Ea.html})}function $D(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=BA(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=LA(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var GD=[60,1084,2066,2165,2175];function qD(e,t,r,n,i){var l=n,o=[],u=r.slice(r.l,r.l+l);if(i&&i.enc&&i.enc.insitu&&u.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(u)}o.push(u),r.l+=l;for(var h=Wn(r,r.l),d=$d[h],x=0;d!=null&&GD.indexOf(h)>-1;)l=Wn(r,r.l+2),x=r.l+4,h==2066?x+=4:(h==2165||h==2175)&&(x+=12),u=r.slice(x,r.l+4+l),o.push(u),r.l+=4+l,d=$d[h=Wn(r,r.l)];var g=Cr(o);Ur(g,0);var v=0;g.lens=[];for(var _=0;_<o.length;++_)g.lens.push(v),v+=o[_].length;if(g.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+g.length+" < "+n;return t.f(g,g.length,i)}function yn(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Je[n])}catch(l){if(t.WTF)throw l}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||ri[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=lo(e.v):e.w=Ss(e.v):e.w=Ya(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(l){if(t.WTF)throw l}if(t.cellDates&&n&&e.t=="n"&&Hl(Je[n]||String(n))){var i=gs(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function nu(e,t,r){return{v:e,ixfe:t,t:r}}function XD(e,t){var r={opts:{}},n={},i=t.dense?[]:{},l={},o={},u=null,h=[],d="",x={},g,v="",_,w,y,b,A={},M=[],T,U,q=[],I=[],R={Sheets:[],WBProps:{date1904:!1},Views:[{}]},Q={},G=function(at){return at<8?vs[at]:at<64&&I[at-8]||vs[at]},ae=function(at,Pt,zr){var Et=Pt.XF.data;if(!(!Et||!Et.patternType||!zr||!zr.cellStyles)){Pt.s={},Pt.s.patternType=Et.patternType;var Tt;(Tt=ho(G(Et.icvFore)))&&(Pt.s.fgColor={rgb:Tt}),(Tt=ho(G(Et.icvBack)))&&(Pt.s.bgColor={rgb:Tt})}},ne=function(at,Pt,zr){if(!(j>1)&&!(zr.sheetRows&&at.r>=zr.sheetRows)){if(zr.cellStyles&&Pt.XF&&Pt.XF.data&&ae(at,Pt,zr),delete Pt.ixfe,delete Pt.XF,g=at,v=Ze(at),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),at.r<o.s.r&&(o.s.r=at.r),at.c<o.s.c&&(o.s.c=at.c),at.r+1>o.e.r&&(o.e.r=at.r+1),at.c+1>o.e.c&&(o.e.c=at.c+1),zr.cellFormula&&Pt.f){for(var Et=0;Et<M.length;++Et)if(!(M[Et][0].s.c>at.c||M[Et][0].s.r>at.r)&&!(M[Et][0].e.c<at.c||M[Et][0].e.r<at.r)){Pt.F=it(M[Et][0]),(M[Et][0].s.c!=at.c||M[Et][0].s.r!=at.r)&&delete Pt.f,Pt.f&&(Pt.f=""+Gr(M[Et][1],o,at,Z,J));break}}zr.dense?(i[at.r]||(i[at.r]=[]),i[at.r][at.c]=Pt):i[v]=Pt}},J={enc:!1,sbcch:0,snames:[],sharedf:A,arrayf:M,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(J.password=t.password);var ge,ke=[],be=[],Y=[],le=[],_e=!1,Z=[];Z.SheetNames=J.snames,Z.sharedf=J.sharedf,Z.arrayf=J.arrayf,Z.names=[],Z.XTI=[];var De=0,j=0,N=0,z=[],P=[],V;J.codepage=1200,cn(1200);for(var ce=!1;e.l<e.length-1;){var we=e.l,Ce=e.read_shift(2);if(Ce===0&&De===10)break;var Ee=e.l===e.length?0:e.read_shift(2),Oe=$d[Ce];if(Oe&&Oe.f){if(t.bookSheets&&De===133&&Ce!==133)break;if(De=Ce,Oe.r===2||Oe.r==12){var Qe=e.read_shift(2);if(Ee-=2,!J.enc&&Qe!==Ce&&((Qe&255)<<8|Qe>>8)!==Ce)throw new Error("rt mismatch: "+Qe+"!="+Ce);Oe.r==12&&(e.l+=10,Ee-=10)}var H={};if(Ce===10?H=Oe.f(e,Ee,J):H=qD(Ce,Oe,e,Ee,J),j==0&&[9,521,1033,2057].indexOf(De)===-1)continue;switch(Ce){case 34:r.opts.Date1904=R.WBProps.date1904=H;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(J.enc||(e.l=0),J.enc=H,!t.password)throw new Error("File is password-protected");if(H.valid==null)throw new Error("Encryption scheme unsupported");if(!H.valid)throw new Error("Password is incorrect");break;case 92:J.lastuser=H;break;case 66:var St=Number(H);switch(St){case 21010:St=1200;break;case 32768:St=1e4;break;case 32769:St=1252;break}cn(J.codepage=St),ce=!0;break;case 317:J.rrtabid=H;break;case 25:J.winlocked=H;break;case 439:r.opts.RefreshAll=H;break;case 12:r.opts.CalcCount=H;break;case 16:r.opts.CalcDelta=H;break;case 17:r.opts.CalcIter=H;break;case 13:r.opts.CalcMode=H;break;case 14:r.opts.CalcPrecision=H;break;case 95:r.opts.CalcSaveRecalc=H;break;case 15:J.CalcRefMode=H;break;case 2211:r.opts.FullCalc=H;break;case 129:H.fDialog&&(i["!type"]="dialog"),H.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),H.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:q.push(H);break;case 430:Z.push([H]),Z[Z.length-1].XTI=[];break;case 35:case 547:Z[Z.length-1].push(H);break;case 24:case 536:V={Name:H.Name,Ref:Gr(H.rgce,o,null,Z,J)},H.itab>0&&(V.Sheet=H.itab-1),Z.names.push(V),Z[0]||(Z[0]=[],Z[0].XTI=[]),Z[Z.length-1].push(H),H.Name=="_xlnm._FilterDatabase"&&H.itab>0&&H.rgce&&H.rgce[0]&&H.rgce[0][0]&&H.rgce[0][0][0]=="PtgArea3d"&&(P[H.itab-1]={ref:it(H.rgce[0][0][1][2])});break;case 22:J.ExternCount=H;break;case 23:Z.length==0&&(Z[0]=[],Z[0].XTI=[]),Z[Z.length-1].XTI=Z[Z.length-1].XTI.concat(H),Z.XTI=Z.XTI.concat(H);break;case 2196:if(J.biff<8)break;V!=null&&(V.Comment=H[1]);break;case 18:i["!protect"]=H;break;case 19:H!==0&&J.WTF&&console.error("Password verifier: "+H);break;case 133:l[H.pos]=H,J.snames.push(H.name);break;case 10:{if(--j)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,i["!ref"]=it(o),t.sheetRows&&t.sheetRows<=o.e.r){var tt=o.e.r;o.e.r=t.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=it(o),o.e.r=tt}o.e.r++,o.e.c++}ke.length>0&&(i["!merges"]=ke),be.length>0&&(i["!objects"]=be),Y.length>0&&(i["!cols"]=Y),le.length>0&&(i["!rows"]=le),R.Sheets.push(Q)}d===""?x=i:n[d]=i,i=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(J.biff===8&&(J.biff={9:2,521:3,1033:4}[Ce]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[H.BIFFVer]||8),J.biffguess=H.BIFFVer==0,H.BIFFVer==0&&H.dt==4096&&(J.biff=5,ce=!0,cn(J.codepage=28591)),J.biff==8&&H.BIFFVer==0&&H.dt==16&&(J.biff=2),j++)break;if(i=t.dense?[]:{},J.biff<8&&!ce&&(ce=!0,cn(J.codepage=t.codepage||1252)),J.biff<5||H.BIFFVer==0&&H.dt==4096){d===""&&(d="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var xt={pos:e.l-Ee,name:d};l[xt.pos]=xt,J.snames.push(d)}else d=(l[we]||{name:""}).name;H.dt==32&&(i["!type"]="chart"),H.dt==64&&(i["!type"]="macro"),ke=[],be=[],J.arrayf=M=[],Y=[],le=[],_e=!1,Q={Hidden:(l[we]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(t.dense?(i[H.r]||[])[H.c]:i[Ze({c:H.c,r:H.r})])&&++H.c,T={ixfe:H.ixfe,XF:q[H.ixfe]||{},v:H.val,t:"n"},N>0&&(T.z=z[T.ixfe>>8&63]),yn(T,t,r.opts.Date1904),ne({c:H.c,r:H.r},T,t);break;case 5:case 517:T={ixfe:H.ixfe,XF:q[H.ixfe],v:H.val,t:H.t},N>0&&(T.z=z[T.ixfe>>8&63]),yn(T,t,r.opts.Date1904),ne({c:H.c,r:H.r},T,t);break;case 638:T={ixfe:H.ixfe,XF:q[H.ixfe],v:H.rknum,t:"n"},N>0&&(T.z=z[T.ixfe>>8&63]),yn(T,t,r.opts.Date1904),ne({c:H.c,r:H.r},T,t);break;case 189:for(var We=H.c;We<=H.C;++We){var Ue=H.rkrec[We-H.c][0];T={ixfe:Ue,XF:q[Ue],v:H.rkrec[We-H.c][1],t:"n"},N>0&&(T.z=z[T.ixfe>>8&63]),yn(T,t,r.opts.Date1904),ne({c:We,r:H.r},T,t)}break;case 6:case 518:case 1030:{if(H.val=="String"){u=H;break}if(T=nu(H.val,H.cell.ixfe,H.tt),T.XF=q[T.ixfe],t.cellFormula){var Ut=H.formula;if(Ut&&Ut[0]&&Ut[0][0]&&Ut[0][0][0]=="PtgExp"){var Tr=Ut[0][0][1][0],Pr=Ut[0][0][1][1],Jr=Ze({r:Tr,c:Pr});A[Jr]?T.f=""+Gr(H.formula,o,H.cell,Z,J):T.F=((t.dense?(i[Tr]||[])[Pr]:i[Jr])||{}).F}else T.f=""+Gr(H.formula,o,H.cell,Z,J)}N>0&&(T.z=z[T.ixfe>>8&63]),yn(T,t,r.opts.Date1904),ne(H.cell,T,t),u=H}break;case 7:case 519:if(u)u.val=H,T=nu(H,u.cell.ixfe,"s"),T.XF=q[T.ixfe],t.cellFormula&&(T.f=""+Gr(u.formula,o,u.cell,Z,J)),N>0&&(T.z=z[T.ixfe>>8&63]),yn(T,t,r.opts.Date1904),ne(u.cell,T,t),u=null;else throw new Error("String record expects Formula");break;case 33:case 545:{M.push(H);var Tn=Ze(H[0].s);if(_=t.dense?(i[H[0].s.r]||[])[H[0].s.c]:i[Tn],t.cellFormula&&_){if(!u||!Tn||!_)break;_.f=""+Gr(H[1],o,H[0],Z,J),_.F=it(H[0])}}break;case 1212:{if(!t.cellFormula)break;if(v){if(!u)break;A[Ze(u.cell)]=H[0],_=t.dense?(i[u.cell.r]||[])[u.cell.c]:i[Ze(u.cell)],(_||{}).f=""+Gr(H[0],o,g,Z,J)}}break;case 253:T=nu(h[H.isst].t,H.ixfe,"s"),h[H.isst].h&&(T.h=h[H.isst].h),T.XF=q[T.ixfe],N>0&&(T.z=z[T.ixfe>>8&63]),yn(T,t,r.opts.Date1904),ne({c:H.c,r:H.r},T,t);break;case 513:t.sheetStubs&&(T={ixfe:H.ixfe,XF:q[H.ixfe],t:"z"},N>0&&(T.z=z[T.ixfe>>8&63]),yn(T,t,r.opts.Date1904),ne({c:H.c,r:H.r},T,t));break;case 190:if(t.sheetStubs)for(var Ra=H.c;Ra<=H.C;++Ra){var bt=H.ixfe[Ra-H.c];T={ixfe:bt,XF:q[bt],t:"z"},N>0&&(T.z=z[T.ixfe>>8&63]),yn(T,t,r.opts.Date1904),ne({c:Ra,r:H.r},T,t)}break;case 214:case 516:case 4:T=nu(H.val,H.ixfe,"s"),T.XF=q[T.ixfe],N>0&&(T.z=z[T.ixfe>>8&63]),yn(T,t,r.opts.Date1904),ne({c:H.c,r:H.r},T,t);break;case 0:case 512:j===1&&(o=H);break;case 252:h=H;break;case 1054:if(J.biff==4){z[N++]=H[1];for(var Or=0;Or<N+163&&Je[Or]!=H[1];++Or);Or>=163&&Yn(H[1],N+163)}else Yn(H[1],H[0]);break;case 30:{z[N++]=H;for(var ma=0;ma<N+163&&Je[ma]!=H;++ma);ma>=163&&Yn(H,N+163)}break;case 229:ke=ke.concat(H);break;case 93:be[H.cmo[0]]=J.lastobj=H;break;case 438:J.lastobj.TxO=H;break;case 127:J.lastobj.ImData=H;break;case 440:for(b=H[0].s.r;b<=H[0].e.r;++b)for(y=H[0].s.c;y<=H[0].e.c;++y)_=t.dense?(i[b]||[])[y]:i[Ze({c:y,r:b})],_&&(_.l=H[1]);break;case 2048:for(b=H[0].s.r;b<=H[0].e.r;++b)for(y=H[0].s.c;y<=H[0].e.c;++y)_=t.dense?(i[b]||[])[y]:i[Ze({c:y,r:b})],_&&_.l&&(_.l.Tooltip=H[1]);break;case 28:{if(J.biff<=5&&J.biff>=2)break;_=t.dense?(i[H[0].r]||[])[H[0].c]:i[Ze(H[0])];var hn=be[H[2]];_||(t.dense?(i[H[0].r]||(i[H[0].r]=[]),_=i[H[0].r][H[0].c]={t:"z"}):_=i[Ze(H[0])]={t:"z"},o.e.r=Math.max(o.e.r,H[0].r),o.s.r=Math.min(o.s.r,H[0].r),o.e.c=Math.max(o.e.c,H[0].c),o.s.c=Math.min(o.s.c,H[0].c)),_.c||(_.c=[]),w={a:H[1],t:hn.TxO.t},_.c.push(w)}break;case 2173:M8(q[H.ixfe],H.ext);break;case 125:{if(!J.cellStyles)break;for(;H.e>=H.s;)Y[H.e--]={width:H.w/256,level:H.level||0,hidden:!!(H.flags&1)},_e||(_e=!0,C1(H.w/256)),ji(Y[H.e+1])}break;case 520:{var Xt={};H.level!=null&&(le[H.r]=Xt,Xt.level=H.level),H.hidden&&(le[H.r]=Xt,Xt.hidden=!0),H.hpt&&(le[H.r]=Xt,Xt.hpt=H.hpt,Xt.hpx=Pl(H.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||ws(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Ce]]=H;break;case 161:i["!margins"]||ws(i["!margins"]={}),i["!margins"].header=H.header,i["!margins"].footer=H.footer;break;case 574:H.RTL&&(R.Views[0].RTL=!0);break;case 146:I=H;break;case 2198:ge=H;break;case 140:U=H;break;case 442:d?Q.CodeName=H||Q.name:R.WBProps.CodeName=H||"ThisWorkbook";break}}else Oe||console.error("Missing Info for XLS Record 0x"+Ce.toString(16)),e.l+=Ee}return r.SheetNames=ir(l).sort(function(hr,at){return Number(hr)-Number(at)}).map(function(hr){return l[hr].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&x["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=x)):r.Preamble=x,r.Sheets&&P.forEach(function(hr,at){r.Sheets[r.SheetNames[at]]["!autofilter"]=hr}),r.Strings=h,r.SSF=qt(Je),J.enc&&(r.Encryption=J.enc),ge&&(r.Themes=ge),r.Metadata={},U!==void 0&&(r.Metadata.Country=U),Z.names.length>0&&(R.Names=Z.names),r.Workbook=R,r}var Qc={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function WD(e,t,r){var n=qe.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=Jv(n,Id,Qc.DSI);for(var l in i)t[l]=i[l]}catch(d){if(r.WTF)throw d}var o=qe.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var u=Jv(o,Ud,Qc.SI);for(var h in u)t[h]==null&&(t[h]=u[h])}catch(d){if(r.WTF)throw d}t.HeadingPairs&&t.TitlesOfParts&&(q_(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function KD(e,t){var r=[],n=[],i=[],l=0,o,u=Av(Id,"n"),h=Av(Ud,"n");if(e.Props)for(o=ir(e.Props),l=0;l<o.length;++l)(Object.prototype.hasOwnProperty.call(u,o[l])?r:Object.prototype.hasOwnProperty.call(h,o[l])?n:i).push([o[l],e.Props[o[l]]]);if(e.Custprops)for(o=ir(e.Custprops),l=0;l<o.length;++l)Object.prototype.hasOwnProperty.call(e.Props||{},o[l])||(Object.prototype.hasOwnProperty.call(u,o[l])?r:Object.prototype.hasOwnProperty.call(h,o[l])?n:i).push([o[l],e.Custprops[o[l]]]);var d=[];for(l=0;l<i.length;++l)Z_.indexOf(i[l][0])>-1||G_.indexOf(i[l][0])>-1||i[l][1]!=null&&d.push(i[l]);n.length&&qe.utils.cfb_add(t,"/SummaryInformation",Qv(n,Qc.SI,h,Ud)),(r.length||d.length)&&qe.utils.cfb_add(t,"/DocumentSummaryInformation",Qv(r,Qc.DSI,u,Id,d.length?d:null,Qc.UDI))}function W2(e,t){t||(t={}),I1(t),n1(),t.codepage&&a1(t.codepage);var r,n;if(e.FullPaths){if(qe.find(e,"/encryption"))throw new Error("File is password-protected");r=qe.find(e,"!CompObj"),n=qe.find(e,"/Workbook")||qe.find(e,"/Book")}else{switch(t.type){case"base64":e=Ca(Oa(e));break;case"binary":e=Ca(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Ur(e,0),n={content:e}}var i,l;if(r&&$D(r),t.bookProps&&!t.bookSheets)i={};else{var o=ct?"buffer":"array";if(n&&n.content)i=XD(n.content,t);else if((l=qe.find(e,"PerfectOffice_MAIN"))&&l.content)i=_s.to_workbook(l.content,(t.type=o,t));else if((l=qe.find(e,"NativeContent_MAIN"))&&l.content)i=_s.to_workbook(l.content,(t.type=o,t));else throw(l=qe.find(e,"MN0"))&&l.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&qe.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=cN(e))}var u={};return e.FullPaths&&WD(e,u,t),i.Props=i.Custprops=u,t.bookFiles&&(i.cfb=e),i}function YD(e,t){var r=t||{},n=qe.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return qe.utils.cfb_add(n,i,K2(e,r)),r.biff==8&&(e.Props||e.Custprops)&&KD(e,n),r.biff==8&&e.vbaraw&&oN(n,qe.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var go={0:{f:_5},1:{f:C5},2:{f:X5},3:{f:L5},4:{f:D5},5:{f:$5},6:{f:Q5},7:{f:P5},8:{f:iR},9:{f:nR},10:{f:rR},11:{f:aR},12:{f:O5},13:{f:K5},14:{f:U5},15:{f:M5},16:{f:P2},17:{f:eR},18:{f:H5},19:{f:v1},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:eD},40:{},42:{},43:{f:Q6},44:{f:Y6},45:{f:t8},46:{f:a8},47:{f:r8},48:{},49:{f:bA},50:{},51:{f:I8},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:u2},62:{f:J5},63:{f:q8},64:{f:wR},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Kr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:gR},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:k5},148:{f:b5,p:16},151:{f:fR},152:{},153:{f:JR},154:{},155:{},156:{f:KR},157:{},158:{},159:{T:1,f:d6},160:{T:-1},161:{T:1,f:Ds},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:sR},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:B8},336:{T:-1},337:{f:P8,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Ld},357:{},358:{},359:{},360:{T:1},361:{},362:{f:o2},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:hR},427:{f:dR},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:xR},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:T5},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:oR},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Ld},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:aN},633:{T:1},634:{T:-1},635:{T:1,f:tN},636:{T:-1},637:{f:AA},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:UR},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:SR},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},$d={6:{f:pd},10:{f:Di},12:{f:yr},13:{f:yr},14:{f:cr},15:{f:cr},16:{f:Xr},17:{f:cr},18:{f:cr},19:{f:yr},20:{f:ny},21:{f:ny},23:{f:o2},24:{f:sy},25:{f:cr},26:{},27:{},28:{f:SC},29:{},34:{f:cr},35:{f:iy},38:{f:Xr},39:{f:Xr},40:{f:Xr},41:{f:Xr},42:{f:cr},43:{f:cr},47:{f:M6},49:{f:K3},51:{f:yr},60:{},61:{f:$3},64:{f:cr},65:{f:W3},66:{f:yr},77:{},80:{},81:{},82:{},85:{f:yr},89:{},90:{},91:{},92:{f:F3},93:{f:TC},94:{},95:{f:cr},96:{},97:{},99:{f:cr},125:{f:u2},128:{f:uC},129:{f:B3},130:{f:yr},131:{f:cr},132:{f:cr},133:{f:L3},134:{},140:{f:FC},141:{f:yr},144:{},146:{f:LC},151:{},152:{},153:{},154:{},155:{},156:{f:yr},157:{},158:{},160:{f:VC},161:{f:jC},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:sC},190:{f:lC},193:{f:Di},197:{},198:{},199:{},200:{},201:{},202:{f:cr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:yr},220:{},221:{f:cr},222:{},224:{f:oC},225:{f:D3},226:{f:Di},227:{},229:{f:bC},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:U3},253:{f:J3},255:{f:P3},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:e2},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:cr},353:{f:Di},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:xC},431:{f:cr},432:{},433:{},434:{},437:{},438:{f:CC},439:{f:cr},440:{f:NC},441:{},442:{f:ko},443:{},444:{f:yr},445:{},446:{},448:{f:Di},449:{f:V3,r:2},450:{f:Di},512:{f:ty},513:{f:HC},515:{f:dC},516:{f:Z3},517:{f:ay},519:{f:$C},520:{f:z3},523:{},545:{f:ly},549:{f:ey},566:{},574:{f:q3},638:{f:iC},659:{},1048:{},1054:{f:tC},1084:{},1212:{f:yC},2048:{f:RC},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:tu},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Di},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:IC,r:12},2173:{f:F8,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:cr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:vC,r:12},2197:{},2198:{f:A8,r:12},2199:{},2200:{},2201:{},2202:{f:_C,r:12},2203:{f:Di},2204:{},2205:{},2206:{},2207:{},2211:{f:H3},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:yr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:PC},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:BC},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:ty},1:{},2:{f:KC},3:{f:XC},4:{f:qC},5:{f:ay},7:{f:JC},8:{},9:{f:tu},11:{},22:{f:yr},30:{f:aC},31:{},32:{},33:{f:ly},36:{},37:{f:ey},50:{f:QC},62:{},52:{},67:{},68:{f:yr},69:{},86:{},126:{},127:{f:GC},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:ZC},223:{},234:{},354:{},421:{},518:{f:pd},521:{f:tu},536:{f:sy},547:{f:iy},561:{},579:{},1030:{f:pd},1033:{f:tu},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ie(e,t,r,n){var i=t;if(!isNaN(i)){var l=n||(r||[]).length||0,o=e.next(4);o.write_shift(2,i),o.write_shift(2,l),l>0&&x1(r)&&e.push(r)}}function JD(e,t,r,n){var i=(r||[]).length||0;if(i<=8224)return Ie(e,t,r,i);var l=t;if(!isNaN(l)){for(var o=r.parts||[],u=0,h=0,d=0;d+(o[u]||8224)<=8224;)d+=o[u]||8224,u++;var x=e.next(4);for(x.write_shift(2,l),x.write_shift(2,d),e.push(r.slice(h,h+d)),h+=d;h<i;){for(x=e.next(4),x.write_shift(2,60),d=0;d+(o[u]||8224)<=8224;)d+=o[u]||8224,u++;x.write_shift(2,d),e.push(r.slice(h,h+d)),h+=d}}}function Oo(e,t,r){return e||(e=pe(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function QD(e,t,r,n){var i=pe(9);return Oo(i,e,t),t2(r,n||"b",i),i}function ZD(e,t,r){var n=pe(8+2*r.length);return Oo(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function eF(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var i=t.t=="d"?Er(Gt(t.v)):t.v;i==(i|0)&&i>=0&&i<65536?Ie(e,2,YC(r,n,i)):Ie(e,3,WC(r,n,i));return;case"b":case"e":Ie(e,5,QD(r,n,t.v,t.t));return;case"s":case"str":Ie(e,4,ZD(r,n,(t.v||"").slice(0,255)));return}Ie(e,1,Oo(null,r,n))}function tF(e,t,r,n){var i=Array.isArray(t),l=gt(t["!ref"]||"A1"),o,u="",h=[];if(l.e.c>255||l.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");l.e.c=Math.min(l.e.c,255),l.e.r=Math.min(l.e.c,16383),o=it(l)}for(var d=l.s.r;d<=l.e.r;++d){u=or(d);for(var x=l.s.c;x<=l.e.c;++x){d===l.s.r&&(h[x]=Qt(x)),o=h[x]+u;var g=i?(t[d]||[])[x]:t[o];g&&eF(e,g,d,x)}}}function rF(e,t){for(var r=t||{},n=ha(),i=0,l=0;l<e.SheetNames.length;++l)e.SheetNames[l]==r.sheet&&(i=l);if(i==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Ie(n,r.biff==4?1033:r.biff==3?521:9,T1(e,16,r)),tF(n,e.Sheets[e.SheetNames[i]],i,r),Ie(n,10),n.end()}function aF(e,t,r){Ie(e,49,Y3({sz:12,name:"Arial"},r))}function nF(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&Ie(e,1054,rC(i,t[i],r))})}function iF(e,t){var r=pe(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Ie(e,2151,r),r=pe(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),s2(gt(t["!ref"]||"A1"),r),r.write_shift(4,4),Ie(e,2152,r)}function sF(e,t){for(var r=0;r<16;++r)Ie(e,224,ry({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){Ie(e,224,ry(n,0,t))})}function lF(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];Ie(e,440,OC(n)),n[1].Tooltip&&Ie(e,2048,DC(n))}delete t["!links"]}function cF(e,t){if(t){var r=0;t.forEach(function(n,i){++r<=256&&n&&Ie(e,125,UC(Iu(i,n),i))})}}function oF(e,t,r,n,i){var l=16+$i(i.cellXfs,t,i);if(t.v==null&&!t.bf){Ie(e,513,ks(r,n,l));return}if(t.bf)Ie(e,6,BO(t,r,n,i,l));else switch(t.t){case"d":case"n":var o=t.t=="d"?Er(Gt(t.v)):t.v;Ie(e,515,mC(r,n,o,l));break;case"b":case"e":Ie(e,517,hC(r,n,t.v,l,i,t.t));break;case"s":case"str":if(i.bookSST){var u=F1(i.Strings,t.v,i.revStrings);Ie(e,253,Q3(r,n,u,l))}else Ie(e,516,eC(r,n,(t.v||"").slice(0,255),l,i));break;default:Ie(e,513,ks(r,n,l))}}function uF(e,t,r){var n=ha(),i=r.SheetNames[e],l=r.Sheets[i]||{},o=(r||{}).Workbook||{},u=(o.Sheets||[])[e]||{},h=Array.isArray(l),d=t.biff==8,x,g="",v=[],_=gt(l["!ref"]||"A1"),w=d?65536:16384;if(_.e.c>255||_.e.r>=w){if(t.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:IV16384");_.e.c=Math.min(_.e.c,255),_.e.r=Math.min(_.e.c,w-1)}Ie(n,2057,T1(r,16,t)),Ie(n,13,Wa(1)),Ie(n,12,Wa(100)),Ie(n,15,ea(!0)),Ie(n,17,ea(!1)),Ie(n,16,Es(.001)),Ie(n,95,ea(!0)),Ie(n,42,ea(!1)),Ie(n,43,ea(!1)),Ie(n,130,Wa(1)),Ie(n,128,fC()),Ie(n,131,ea(!1)),Ie(n,132,ea(!1)),d&&cF(n,l["!cols"]),Ie(n,512,nC(_,t)),d&&(l["!links"]=[]);for(var y=_.s.r;y<=_.e.r;++y){g=or(y);for(var b=_.s.c;b<=_.e.c;++b){y===_.s.r&&(v[b]=Qt(b)),x=v[b]+g;var A=h?(l[y]||[])[b]:l[x];A&&(oF(n,A,y,b,t),d&&A.l&&l["!links"].push([x,A.l]))}}var M=u.CodeName||u.name||i;return d&&Ie(n,574,X3((o.Views||[])[0])),d&&(l["!merges"]||[]).length&&Ie(n,229,EC(l["!merges"])),d&&lF(n,l),Ie(n,442,r2(M)),d&&iF(n,l),Ie(n,10),n.end()}function fF(e,t,r){var n=ha(),i=(e||{}).Workbook||{},l=i.Sheets||[],o=i.WBProps||{},u=r.biff==8,h=r.biff==5;if(Ie(n,2057,T1(e,5,r)),r.bookType=="xla"&&Ie(n,135),Ie(n,225,u?Wa(1200):null),Ie(n,193,h3(2)),h&&Ie(n,191),h&&Ie(n,192),Ie(n,226),Ie(n,92,M3("SheetJS",r)),Ie(n,66,Wa(u?1200:1252)),u&&Ie(n,353,Wa(0)),u&&Ie(n,448),Ie(n,317,zC(e.SheetNames.length)),u&&e.vbaraw&&Ie(n,211),u&&e.vbaraw){var d=o.CodeName||"ThisWorkbook";Ie(n,442,r2(d))}Ie(n,156,Wa(17)),Ie(n,25,ea(!1)),Ie(n,18,ea(!1)),Ie(n,19,Wa(0)),u&&Ie(n,431,ea(!1)),u&&Ie(n,444,Wa(0)),Ie(n,61,G3()),Ie(n,64,ea(!1)),Ie(n,141,Wa(0)),Ie(n,34,ea(VR(e)=="true")),Ie(n,14,ea(!0)),u&&Ie(n,439,ea(!1)),Ie(n,218,Wa(0)),aF(n,e,r),nF(n,e.SSF,r),sF(n,r),u&&Ie(n,352,ea(!1));var x=n.end(),g=ha();u&&Ie(g,140,MC()),u&&r.Strings&&JD(g,252,j3(r.Strings)),Ie(g,10);var v=g.end(),_=ha(),w=0,y=0;for(y=0;y<e.SheetNames.length;++y)w+=(u?12:11)+(u?2:1)*e.SheetNames[y].length;var b=x.length+w+v.length;for(y=0;y<e.SheetNames.length;++y){var A=l[y]||{};Ie(_,133,I3({pos:b,hs:A.Hidden||0,dt:0,name:e.SheetNames[y]},r)),b+=t[y].length}var M=_.end();if(w!=M.length)throw new Error("BS8 "+w+" != "+M.length);var T=[];return x.length&&T.push(x),M.length&&T.push(M),v.length&&T.push(v),Cr(T)}function hF(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=qt(Je)),e&&e.SSF&&(Vl(),Ou(e.SSF),r.revssf=Du(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,U1(r),r.cellXfs=[],$i(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var i=0;i<e.SheetNames.length;++i)n[n.length]=uF(i,r,e);return n.unshift(fF(e,n,r)),Cr(n)}function K2(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var i=da(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var l=t||{};switch(l.biff||2){case 8:case 5:return hF(e,t);case 4:case 3:case 2:return rF(e,t)}throw new Error("invalid type "+l.bookType+" for BIFF")}function gy(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var i=e.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var l=e.match(/<\/table/i),o=i.index,u=l&&l.index||e.length,h=Yk(e.slice(o,u),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,x=0,g=0,v=0,_={s:{r:1e7,c:1e7},e:{r:0,c:0}},w=[];for(o=0;o<h.length;++o){var y=h[o].trim(),b=y.slice(0,3).toLowerCase();if(b=="<tr"){if(++d,r.sheetRows&&r.sheetRows<=d){--d;break}x=0;continue}if(!(b!="<td"&&b!="<th")){var A=y.split(/<\/t[dh]>/i);for(u=0;u<A.length;++u){var M=A[u].trim();if(M.match(/<t[dh]/i)){for(var T=M,U=0;T.charAt(0)=="<"&&(U=T.indexOf(">"))>-1;)T=T.slice(U+1);for(var q=0;q<w.length;++q){var I=w[q];I.s.c==x&&I.s.r<d&&d<=I.e.r&&(x=I.e.c+1,q=-1)}var R=et(M.slice(0,M.indexOf(">")));v=R.colspan?+R.colspan:1,((g=+R.rowspan)>1||v>1)&&w.push({s:{r:d,c:x},e:{r:d+(g||1)-1,c:x+v-1}});var Q=R.t||R["data-t"]||"";if(!T.length){x+=v;continue}if(T=y_(T),_.s.r>d&&(_.s.r=d),_.e.r<d&&(_.e.r=d),_.s.c>x&&(_.s.c=x),_.e.c<x&&(_.e.c=x),!T.length){x+=v;continue}var G={t:"s",v:T};r.raw||!T.trim().length||Q=="s"||(T==="TRUE"?G={t:"b",v:!0}:T==="FALSE"?G={t:"b",v:!1}:isNaN(un(T))?isNaN(Ul(T).getDate())||(G={t:"d",v:Gt(T)},r.cellDates||(G={t:"n",v:Er(G.v)}),G.z=r.dateNF||Je[14]):G={t:"n",v:un(T)}),r.dense?(n[d]||(n[d]=[]),n[d][x]=G):n[Ze({r:d,c:x})]=G,x+=v}}}}return n["!ref"]=it(_),w.length&&(n["!merges"]=w),n}function dF(e,t,r,n){for(var i=e["!merges"]||[],l=[],o=t.s.c;o<=t.e.c;++o){for(var u=0,h=0,d=0;d<i.length;++d)if(!(i[d].s.r>r||i[d].s.c>o)&&!(i[d].e.r<r||i[d].e.c<o)){if(i[d].s.r<r||i[d].s.c<o){u=-1;break}u=i[d].e.r-i[d].s.r+1,h=i[d].e.c-i[d].s.c+1;break}if(!(u<0)){var x=Ze({r,c:o}),g=n.dense?(e[r]||[])[o]:e[x],v=g&&g.v!=null&&(g.h||h1(g.w||(Qn(g),g.w)||""))||"",_={};u>1&&(_.rowspan=u),h>1&&(_.colspan=h),n.editable?v='<span contenteditable="true">'+v+"</span>":g&&(_["data-t"]=g&&g.t||"z",g.v!=null&&(_["data-v"]=g.v),g.z!=null&&(_["data-z"]=g.z),g.l&&(g.l.Target||"#").charAt(0)!="#"&&(v='<a href="'+g.l.Target+'">'+v+"</a>")),_.id=(n.id||"sjs")+"-"+x,l.push(Be("td",v,_))}}var w="<tr>";return w+l.join("")+"</tr>"}var mF='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',xF="</body></html>";function pF(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Vi(gy(r[0],t),t);var n=z1();return r.forEach(function(i,l){H1(n,gy(i,t),"Sheet"+(l+1))}),n}function gF(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function Y2(e,t){var r=t||{},n=r.header!=null?r.header:mF,i=r.footer!=null?r.footer:xF,l=[n],o=da(e["!ref"]);r.dense=Array.isArray(e),l.push(gF(e,o,r));for(var u=o.s.r;u<=o.e.r;++u)l.push(dF(e,o,u,r));return l.push("</table>"+i),l.join("")}function J2(e,t,r){var n=r||{},i=0,l=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var o=typeof n.origin=="string"?Zt(n.origin):n.origin;i=o.r,l=o.c}var u=t.getElementsByTagName("tr"),h=Math.min(n.sheetRows||1e7,u.length),d={s:{r:0,c:0},e:{r:i,c:l}};if(e["!ref"]){var x=da(e["!ref"]);d.s.r=Math.min(d.s.r,x.s.r),d.s.c=Math.min(d.s.c,x.s.c),d.e.r=Math.max(d.e.r,x.e.r),d.e.c=Math.max(d.e.c,x.e.c),i==-1&&(d.e.r=i=x.e.r+1)}var g=[],v=0,_=e["!rows"]||(e["!rows"]=[]),w=0,y=0,b=0,A=0,M=0,T=0;for(e["!cols"]||(e["!cols"]=[]);w<u.length&&y<h;++w){var U=u[w];if(vy(U)){if(n.display)continue;_[y]={hidden:!0}}var q=U.children;for(b=A=0;b<q.length;++b){var I=q[b];if(!(n.display&&vy(I))){var R=I.hasAttribute("data-v")?I.getAttribute("data-v"):I.hasAttribute("v")?I.getAttribute("v"):y_(I.innerHTML),Q=I.getAttribute("data-z")||I.getAttribute("z");for(v=0;v<g.length;++v){var G=g[v];G.s.c==A+l&&G.s.r<y+i&&y+i<=G.e.r&&(A=G.e.c+1-l,v=-1)}T=+I.getAttribute("colspan")||1,((M=+I.getAttribute("rowspan")||1)>1||T>1)&&g.push({s:{r:y+i,c:A+l},e:{r:y+i+(M||1)-1,c:A+l+(T||1)-1}});var ae={t:"s",v:R},ne=I.getAttribute("data-t")||I.getAttribute("t")||"";R!=null&&(R.length==0?ae.t=ne||"z":n.raw||R.trim().length==0||ne=="s"||(R==="TRUE"?ae={t:"b",v:!0}:R==="FALSE"?ae={t:"b",v:!1}:isNaN(un(R))?isNaN(Ul(R).getDate())||(ae={t:"d",v:Gt(R)},n.cellDates||(ae={t:"n",v:Er(ae.v)}),ae.z=n.dateNF||Je[14]):ae={t:"n",v:un(R)})),ae.z===void 0&&Q!=null&&(ae.z=Q);var J="",ge=I.getElementsByTagName("A");if(ge&&ge.length)for(var ke=0;ke<ge.length&&!(ge[ke].hasAttribute("href")&&(J=ge[ke].getAttribute("href"),J.charAt(0)!="#"));++ke);J&&J.charAt(0)!="#"&&(ae.l={Target:J}),n.dense?(e[y+i]||(e[y+i]=[]),e[y+i][A+l]=ae):e[Ze({c:A+l,r:y+i})]=ae,d.e.c<A+l&&(d.e.c=A+l),A+=T}}++y}return g.length&&(e["!merges"]=(e["!merges"]||[]).concat(g)),d.e.r=Math.max(d.e.r,y-1+i),e["!ref"]=it(d),y>=h&&(e["!fullref"]=it((d.e.r=u.length-w+y-1+i,d))),e}function Q2(e,t){var r=t||{},n=r.dense?[]:{};return J2(n,e,t)}function vF(e,t){return Vi(Q2(e,t),t)}function vy(e){var t="",r=yF(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function yF(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function _F(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=pt(t.replace(/<[^>]*>/g,""));return[r]}var yy={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Z2(e,t){var r=t||{},n=d1(e),i=[],l,o,u={name:""},h="",d=0,x,g,v={},_=[],w=r.dense?[]:{},y,b,A={value:""},M="",T=0,U=[],q=-1,I=-1,R={s:{r:1e6,c:1e7},e:{r:0,c:0}},Q=0,G={},ae=[],ne={},J=0,ge=0,ke=[],be=1,Y=1,le=[],_e={Names:[]},Z={},De=["",""],j=[],N={},z="",P=0,V=!1,ce=!1,we=0;for(uo.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");y=uo.exec(n);)switch(y[3]=y[3].replace(/_.*$/,"")){case"table":case"":y[1]==="/"?(R.e.c>=R.s.c&&R.e.r>=R.s.r?w["!ref"]=it(R):w["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=R.e.r&&(w["!fullref"]=w["!ref"],R.e.r=r.sheetRows-1,w["!ref"]=it(R)),ae.length&&(w["!merges"]=ae),ke.length&&(w["!rows"]=ke),x.name=x.||x.name,typeof JSON<"u"&&JSON.stringify(x),_.push(x.name),v[x.name]=w,ce=!1):y[0].charAt(y[0].length-2)!=="/"&&(x=et(y[0],!1),q=I=-1,R.s.r=R.s.c=1e7,R.e.r=R.e.c=0,w=r.dense?[]:{},ae=[],ke=[],ce=!0);break;case"table-row-group":y[1]==="/"?--Q:++Q;break;case"table-row":case"":if(y[1]==="/"){q+=be,be=1;break}if(g=et(y[0],!1),g.?q=g.-1:q==-1&&(q=0),be=+g["number-rows-repeated"]||1,be<10)for(we=0;we<be;++we)Q>0&&(ke[q+we]={level:Q});I=-1;break;case"covered-table-cell":y[1]!=="/"&&++I,r.sheetStubs&&(r.dense?(w[q]||(w[q]=[]),w[q][I]={t:"z"}):w[Ze({r:q,c:I})]={t:"z"}),M="",U=[];break;case"table-cell":case"":if(y[0].charAt(y[0].length-2)==="/")++I,A=et(y[0],!1),Y=parseInt(A["number-columns-repeated"]||"1",10),b={t:"z",v:null},A.formula&&r.cellFormula!=!1&&(b.f=my(pt(A.formula))),(A.||A["value-type"])=="string"&&(b.t="s",b.v=pt(A["string-value"]||""),r.dense?(w[q]||(w[q]=[]),w[q][I]=b):w[Ze({r:q,c:I})]=b),I+=Y-1;else if(y[1]!=="/"){++I,M="",T=0,U=[],Y=1;var Ce=be?q+be-1:q;if(I>R.e.c&&(R.e.c=I),I<R.s.c&&(R.s.c=I),q<R.s.r&&(R.s.r=q),Ce>R.e.r&&(R.e.r=Ce),A=et(y[0],!1),j=[],N={},b={t:A.||A["value-type"],v:null},r.cellFormula)if(A.formula&&(A.formula=pt(A.formula)),A["number-matrix-columns-spanned"]&&A["number-matrix-rows-spanned"]&&(J=parseInt(A["number-matrix-rows-spanned"],10)||0,ge=parseInt(A["number-matrix-columns-spanned"],10)||0,ne={s:{r:q,c:I},e:{r:q+J-1,c:I+ge-1}},b.F=it(ne),le.push([ne,b.F])),A.formula)b.f=my(A.formula);else for(we=0;we<le.length;++we)q>=le[we][0].s.r&&q<=le[we][0].e.r&&I>=le[we][0].s.c&&I<=le[we][0].e.c&&(b.F=le[we][1]);switch((A["number-columns-spanned"]||A["number-rows-spanned"])&&(J=parseInt(A["number-rows-spanned"],10)||0,ge=parseInt(A["number-columns-spanned"],10)||0,ne={s:{r:q,c:I},e:{r:q+J-1,c:I+ge-1}},ae.push(ne)),A["number-columns-repeated"]&&(Y=parseInt(A["number-columns-repeated"],10)),b.t){case"boolean":b.t="b",b.v=$t(A["boolean-value"]);break;case"float":b.t="n",b.v=parseFloat(A.value);break;case"percentage":b.t="n",b.v=parseFloat(A.value);break;case"currency":b.t="n",b.v=parseFloat(A.value);break;case"date":b.t="d",b.v=Gt(A["date-value"]),r.cellDates||(b.t="n",b.v=Er(b.v)),b.z="m/d/yy";break;case"time":b.t="n",b.v=Xk(A["time-value"])/86400,r.cellDates&&(b.t="d",b.v=Fu(b.v)),b.z="HH:MM:SS";break;case"number":b.t="n",b.v=parseFloat(A.);break;default:if(b.t==="string"||b.t==="text"||!b.t)b.t="s",A["string-value"]!=null&&(M=pt(A["string-value"]),U=[]);else throw new Error("Unsupported value type "+b.t)}}else{if(V=!1,b.t==="s"&&(b.v=M||"",U.length&&(b.R=U),V=T==0),Z.Target&&(b.l=Z),j.length>0&&(b.c=j,j=[]),M&&r.cellText!==!1&&(b.w=M),V&&(b.t="z",delete b.v),(!V||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=q))for(var Ee=0;Ee<be;++Ee){if(Y=parseInt(A["number-columns-repeated"]||"1",10),r.dense)for(w[q+Ee]||(w[q+Ee]=[]),w[q+Ee][I]=Ee==0?b:qt(b);--Y>0;)w[q+Ee][I+Y]=qt(b);else for(w[Ze({r:q+Ee,c:I})]=b;--Y>0;)w[Ze({r:q+Ee,c:I+Y})]=qt(b);R.e.c<=I&&(R.e.c=I)}Y=parseInt(A["number-columns-repeated"]||"1",10),I+=Y-1,Y=0,b={},M="",U=[]}Z={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(y[1]==="/"){if((l=i.pop())[0]!==y[3])throw"Bad state: "+l}else y[0].charAt(y[0].length-2)!=="/"&&i.push([y[3],!0]);break;case"annotation":if(y[1]==="/"){if((l=i.pop())[0]!==y[3])throw"Bad state: "+l;N.t=M,U.length&&(N.R=U),N.a=z,j.push(N)}else y[0].charAt(y[0].length-2)!=="/"&&i.push([y[3],!1]);z="",P=0,M="",T=0,U=[];break;case"creator":y[1]==="/"?z=n.slice(P,y.index):P=y.index+y[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(y[1]==="/"){if((l=i.pop())[0]!==y[3])throw"Bad state: "+l}else y[0].charAt(y[0].length-2)!=="/"&&i.push([y[3],!1]);M="",T=0,U=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(y[1]==="/"){if(G[u.name]=h,(l=i.pop())[0]!==y[3])throw"Bad state: "+l}else y[0].charAt(y[0].length-2)!=="/"&&(h="",u=et(y[0],!1),i.push([y[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":o=et(y[0],!1),h+=yy[y[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":o=et(y[0],!1),h+=yy[y[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(y[0].slice(-2)==="/>")break;if(y[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":h+=n.slice(d,y.index);break}else d=y.index+y[0].length;break;case"named-range":o=et(y[0],!1),De=gd(o["cell-range-address"]);var Oe={Name:o.name,Ref:De[0]+"!"+De[1]};ce&&(Oe.Sheet=_.length),_e.Names.push(Oe);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(y[1]==="/"&&(!A||!A["string-value"])){var Qe=_F(n.slice(T,y.index));M=(M.length>0?M+`
`:"")+Qe[0]}else et(y[0],!1),T=y.index+y[0].length;break;case"s":break;case"database-range":if(y[1]==="/")break;try{De=gd(et(y[0])["target-range-address"]),v[De[0]]["!autofilter"]={ref:De[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(y[1]!=="/"){if(Z=et(y[0],!1),!Z.href)break;Z.Target=pt(Z.href),delete Z.href,Z.Target.charAt(0)=="#"&&Z.Target.indexOf(".")>-1?(De=gd(Z.Target.slice(1)),Z.Target="#"+De[0]+"!"+De[1]):Z.Target.match(/^\.\.[\\\/]/)&&(Z.Target=Z.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(y[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(y)}}var H={Sheets:v,SheetNames:_,Workbook:_e};return r.bookSheets&&delete H.Sheets,H}function _y(e,t){t=t||{},Xa(e,"META-INF/manifest.xml")&&XA(vr(e,"META-INF/manifest.xml"),t);var r=Na(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=Z2(Lt(r),t);return Xa(e,"meta.xml")&&(n.Props=V_(vr(e,"meta.xml"))),n}function wy(e,t){return Z2(e,t)}var wF=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+oo({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return fr+t}})(),Sy=(function(){var e=function(l){return Ot(l).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(l,o,u){var h=[];h.push('      <table:table table:name="'+Ot(o.SheetNames[u])+`" table:style-name="ta1">
`);var d=0,x=0,g=da(l["!ref"]||"A1"),v=l["!merges"]||[],_=0,w=Array.isArray(l);if(l["!cols"])for(x=0;x<=g.e.c;++x)h.push("        <table:table-column"+(l["!cols"][x]?' table:style-name="co'+l["!cols"][x].ods+'"':"")+`></table:table-column>
`);var y="",b=l["!rows"]||[];for(d=0;d<g.s.r;++d)y=b[d]?' table:style-name="ro'+b[d].ods+'"':"",h.push("        <table:table-row"+y+`></table:table-row>
`);for(;d<=g.e.r;++d){for(y=b[d]?' table:style-name="ro'+b[d].ods+'"':"",h.push("        <table:table-row"+y+`>
`),x=0;x<g.s.c;++x)h.push(t);for(;x<=g.e.c;++x){var A=!1,M={},T="";for(_=0;_!=v.length;++_)if(!(v[_].s.c>x)&&!(v[_].s.r>d)&&!(v[_].e.c<x)&&!(v[_].e.r<d)){(v[_].s.c!=x||v[_].s.r!=d)&&(A=!0),M["table:number-columns-spanned"]=v[_].e.c-v[_].s.c+1,M["table:number-rows-spanned"]=v[_].e.r-v[_].s.r+1;break}if(A){h.push(r);continue}var U=Ze({r:d,c:x}),q=w?(l[d]||[])[x]:l[U];if(q&&q.f&&(M["table:formula"]=Ot(zO(q.f)),q.F&&q.F.slice(0,U.length)==U)){var I=da(q.F);M["table:number-matrix-columns-spanned"]=I.e.c-I.s.c+1,M["table:number-matrix-rows-spanned"]=I.e.r-I.s.r+1}if(!q){h.push(t);continue}switch(q.t){case"b":T=q.v?"TRUE":"FALSE",M["office:value-type"]="boolean",M["office:boolean-value"]=q.v?"true":"false";break;case"n":T=q.w||String(q.v||0),M["office:value-type"]="float",M["office:value"]=q.v||0;break;case"s":case"str":T=q.v==null?"":q.v,M["office:value-type"]="string";break;case"d":T=q.w||Gt(q.v).toISOString(),M["office:value-type"]="date",M["office:date-value"]=Gt(q.v).toISOString(),M["table:style-name"]="ce1";break;default:h.push(t);continue}var R=e(T);if(q.l&&q.l.Target){var Q=q.l.Target;Q=Q.charAt(0)=="#"?"#"+HO(Q.slice(1)):Q,Q.charAt(0)!="#"&&!Q.match(/^\w+:/)&&(Q="../"+Q),R=Be("text:a",R,{"xlink:href":Q.replace(/&/g,"&amp;")})}h.push("          "+Be("table:table-cell",Be("text:p",R,{}),M)+`
`)}h.push(`        </table:table-row>
`)}return h.push(`      </table:table>
`),h.join("")},i=function(l,o){l.push(` <office:automatic-styles>
`),l.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),l.push(`   <number:month number:style="long"/>
`),l.push(`   <number:text>/</number:text>
`),l.push(`   <number:day number:style="long"/>
`),l.push(`   <number:text>/</number:text>
`),l.push(`   <number:year/>
`),l.push(`  </number:date-style>
`);var u=0;o.SheetNames.map(function(d){return o.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var x=0;x<d["!cols"].length;++x)if(d["!cols"][x]){var g=d["!cols"][x];if(g.width==null&&g.wpx==null&&g.wch==null)continue;ji(g),g.ods=u;var v=d["!cols"][x].wpx+"px";l.push('  <style:style style:name="co'+u+`" style:family="table-column">
`),l.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+v+`"/>
`),l.push(`  </style:style>
`),++u}}});var h=0;o.SheetNames.map(function(d){return o.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var x=0;x<d["!rows"].length;++x)if(d["!rows"][x]){d["!rows"][x].ods=h;var g=d["!rows"][x].hpx+"px";l.push('  <style:style style:name="ro'+h+`" style:family="table-row">
`),l.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+g+`"/>
`),l.push(`  </style:style>
`),++h}}}),l.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),l.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),l.push(`  </style:style>
`),l.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),l.push(` </office:automatic-styles>
`)};return function(o,u){var h=[fr],d=oo({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),x=oo({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});u.bookType=="fods"?(h.push("<office:document"+d+x+`>
`),h.push(H_().replace(/office:document-meta/g,"office:meta"))):h.push("<office:document-content"+d+`>
`),i(h,o),h.push(`  <office:body>
`),h.push(`    <office:spreadsheet>
`);for(var g=0;g!=o.SheetNames.length;++g)h.push(n(o.Sheets[o.SheetNames[g]],o,g));return h.push(`    </office:spreadsheet>
`),h.push(`  </office:body>
`),u.bookType=="fods"?h.push("</office:document>"):h.push("</office:document-content>"),h.join("")}})();function ew(e,t){if(t.bookType=="fods")return Sy(e,t);var r=o1(),n="",i=[],l=[];return n="mimetype",lt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",lt(r,n,Sy(e,t)),i.push([n,"text/xml"]),l.push([n,"ContentFile"]),n="styles.xml",lt(r,n,wF(e,t)),i.push([n,"text/xml"]),l.push([n,"StylesFile"]),n="meta.xml",lt(r,n,fr+H_()),i.push([n,"text/xml"]),l.push([n,"MetadataFile"]),n="manifest.rdf",lt(r,n,YA(l)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",lt(r,n,WA(i)),r}function As(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Gd(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Lt(Hi(e))}function SF(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Ca(Sn(e))}function bF(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function zi(e){var t=e.reduce(function(i,l){return i+l.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(i){r.set(i,n),n+=i.length}),r}function by(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function EF(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,i=t+13;i>=t;--i)n=n*256+e[i];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function TF(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var l=0;i>=1;++l,i/=256)e[t+l]=i&255;e[t+15]|=r>=0?0:128}function vo(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Ct(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function nr(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function _t(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],i=vo(e,r),l=i&7;i=Math.floor(i/8);var o=0,u;if(i==0)break;switch(l){case 0:{for(var h=r[0];e[r[0]++]>=128;);u=e.slice(h,r[0])}break;case 5:o=4,u=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,u=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=vo(e,r),u=e.slice(r[0],r[0]+o),r[0]+=o;break;default:throw new Error("PB Type ".concat(l," for Field ").concat(i," at offset ").concat(n))}var d={data:u,type:l};t[i]==null?t[i]=[d]:t[i].push(d)}return t}function Ir(e){var t=[];return e.forEach(function(r,n){r.forEach(function(i){i.data&&(t.push(Ct(n*8+i.type)),i.type==2&&t.push(Ct(i.data.length)),t.push(i.data))})}),zi(t)}function L1(e,t){return e?.map(function(r){return t(r.data)})||[]}function Ga(e){for(var t,r=[],n=[0];n[0]<e.length;){var i=vo(e,n),l=_t(e.slice(n[0],n[0]+i));n[0]+=i;var o={id:nr(l[1][0].data),messages:[]};l[2].forEach(function(u){var h=_t(u.data),d=nr(h[3][0].data);o.messages.push({meta:h,data:e.slice(n[0],n[0]+d)}),n[0]+=d}),(t=l[3])!=null&&t[0]&&(o.merge=nr(l[3][0].data)>>>0>0),r.push(o)}return r}function El(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:Ct(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Ct(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(o){i.push(o.data),o.meta[3]=[{type:0,data:Ct(o.data.length)}],n[2].push({data:Ir(o.meta),type:2})});var l=Ir(n);t.push(Ct(l.length)),t.push(l),i.forEach(function(o){return t.push(o)})}),zi(t)}function kF(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=vo(t,r),i=[];r[0]<t.length;){var l=t[r[0]]&3;if(l==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var u=o-59;o=t[r[0]],u>1&&(o|=t[r[0]+1]<<8),u>2&&(o|=t[r[0]+2]<<16),u>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=u}i.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var h=0,d=0;if(l==1?(d=(t[r[0]]>>2&7)+4,h=(t[r[0]++]&224)<<3,h|=t[r[0]++]):(d=(t[r[0]++]>>2)+1,l==2?(h=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(h=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),i=[zi(i)],h==0)throw new Error("Invalid offset 0");if(h>i[0].length)throw new Error("Invalid offset beyond length");if(d>=h)for(i.push(i[0].slice(-h)),d-=h;d>=i[i.length-1].length;)i.push(i[i.length-1]),d-=i[i.length-1].length;i.push(i[0].slice(-h,-h+d))}}var x=zi(i);if(x.length!=n)throw new Error("Unexpected length: ".concat(x.length," != ").concat(n));return x}function qa(e){for(var t=[],r=0;r<e.length;){var n=e[r++],i=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(kF(n,e.slice(r,r+i))),r+=i}if(r!==e.length)throw new Error("data is not a valid framed stream!");return zi(t)}function Tl(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),i=new Uint8Array(4);t.push(i);var l=Ct(n),o=l.length;t.push(l),n<=60?(o++,t.push(new Uint8Array([n-1<<2]))):n<=256?(o+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(o+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(o+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(o+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),o+=n,i[0]=0,i[1]=o&255,i[2]=o>>8&255,i[3]=o>>16&255,r+=n}return zi(t)}function AF(e,t,r,n){var i=As(e),l=i.getUint32(4,!0),o=(n>1?12:8)+by(l&(n>1?3470:398))*4,u=-1,h=-1,d=NaN,x=new Date(2001,0,1);l&512&&(u=i.getUint32(o,!0),o+=4),o+=by(l&(n>1?12288:4096))*4,l&16&&(h=i.getUint32(o,!0),o+=4),l&32&&(d=i.getFloat64(o,!0),o+=8),l&64&&(x.setTime(x.getTime()+i.getFloat64(o,!0)*1e3),o+=8);var g;switch(e[2]){case 0:break;case 2:g={t:"n",v:d};break;case 3:g={t:"s",v:t[h]};break;case 5:g={t:"d",v:x};break;case 6:g={t:"b",v:d>0};break;case 7:g={t:"n",v:d/86400};break;case 8:g={t:"e",v:0};break;case 9:if(u>-1)g={t:"s",v:r[u]};else if(h>-1)g={t:"s",v:t[h]};else if(!isNaN(d))g={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return g}function CF(e,t,r){var n=As(e),i=n.getUint32(8,!0),l=12,o=-1,u=-1,h=NaN,d=NaN,x=new Date(2001,0,1);i&1&&(h=EF(e,l),l+=16),i&2&&(d=n.getFloat64(l,!0),l+=8),i&4&&(x.setTime(x.getTime()+n.getFloat64(l,!0)*1e3),l+=8),i&8&&(u=n.getUint32(l,!0),l+=4),i&16&&(o=n.getUint32(l,!0),l+=4);var g;switch(e[1]){case 0:break;case 2:g={t:"n",v:h};break;case 3:g={t:"s",v:t[u]};break;case 5:g={t:"d",v:x};break;case 6:g={t:"b",v:d>0};break;case 7:g={t:"n",v:d/86400};break;case 8:g={t:"e",v:0};break;case 9:if(o>-1)g={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)));break;case 10:g={t:"n",v:h};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)))}return g}function yd(e,t){var r=new Uint8Array(32),n=As(r),i=12,l=0;switch(r[0]=5,e.t){case"n":r[1]=2,TF(r,i,e.v),l|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,e.v?1:0,!0),l|=2,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(i,t.indexOf(e.v),!0),l|=8,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,l,!0),r.slice(0,i)}function _d(e,t){var r=new Uint8Array(32),n=As(r),i=12,l=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(i,e.v,!0),l|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,e.v?1:0,!0),l|=32,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(i,t.indexOf(e.v),!0),l|=16,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,l,!0),r.slice(0,i)}function NF(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return AF(e,t,r,e[0]);case 5:return CF(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function $r(e){var t=_t(e);return vo(t[1][0].data)}function Ey(e,t){var r=_t(t.data),n=nr(r[1][0].data),i=r[3],l=[];return(i||[]).forEach(function(o){var u=_t(o.data),h=nr(u[1][0].data)>>>0;switch(n){case 1:l[h]=Gd(u[3][0].data);break;case 8:{var d=e[$r(u[9][0].data)][0],x=_t(d.data),g=e[$r(x[1][0].data)][0],v=nr(g.meta[1][0].data);if(v!=2001)throw new Error("2000 unexpected reference to ".concat(v));var _=_t(g.data);l[h]=_[3].map(function(w){return Gd(w.data)}).join("")}break}}),l}function OF(e,t){var r,n,i,l,o,u,h,d,x,g,v,_,w,y,b=_t(e),A=nr(b[1][0].data)>>>0,M=nr(b[2][0].data)>>>0,T=((n=(r=b[8])==null?void 0:r[0])==null?void 0:n.data)&&nr(b[8][0].data)>0||!1,U,q;if((l=(i=b[7])==null?void 0:i[0])!=null&&l.data&&t!=0)U=(u=(o=b[7])==null?void 0:o[0])==null?void 0:u.data,q=(d=(h=b[6])==null?void 0:h[0])==null?void 0:d.data;else if((g=(x=b[4])==null?void 0:x[0])!=null&&g.data&&t!=1)U=(_=(v=b[4])==null?void 0:v[0])==null?void 0:_.data,q=(y=(w=b[3])==null?void 0:w[0])==null?void 0:y.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var I=T?4:1,R=As(U),Q=[],G=0;G<U.length/2;++G){var ae=R.getUint16(G*2,!0);ae<65535&&Q.push([G,ae])}if(Q.length!=M)throw"Expected ".concat(M," cells, found ").concat(Q.length);var ne=[];for(G=0;G<Q.length-1;++G)ne[Q[G][0]]=q.subarray(Q[G][1]*I,Q[G+1][1]*I);return Q.length>=1&&(ne[Q[Q.length-1][0]]=q.subarray(Q[Q.length-1][1]*I)),{R:A,cells:ne}}function RF(e,t){var r,n=_t(t.data),i=(r=n?.[7])!=null&&r[0]?nr(n[7][0].data)>>>0>0?1:0:-1,l=L1(n[5],function(o){return OF(o,i)});return{nrows:nr(n[4][0].data)>>>0,data:l.reduce(function(o,u){return o[u.R]||(o[u.R]=[]),u.cells.forEach(function(h,d){if(o[u.R][d])throw new Error("Duplicate cell r=".concat(u.R," c=").concat(d));o[u.R][d]=h}),o},[])}}function DF(e,t,r){var n,i=_t(t.data),l={s:{r:0,c:0},e:{r:0,c:0}};if(l.e.r=(nr(i[6][0].data)>>>0)-1,l.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(l.e.c=(nr(i[7][0].data)>>>0)-1,l.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=it(l);var o=_t(i[4][0].data),u=Ey(e,e[$r(o[4][0].data)][0]),h=(n=o[17])!=null&&n[0]?Ey(e,e[$r(o[17][0].data)][0]):[],d=_t(o[3][0].data),x=0;d[1].forEach(function(g){var v=_t(g.data),_=e[$r(v[2][0].data)][0],w=nr(_.meta[1][0].data);if(w!=6002)throw new Error("6001 unexpected reference to ".concat(w));var y=RF(e,_);y.data.forEach(function(b,A){b.forEach(function(M,T){var U=Ze({r:x+A,c:T}),q=NF(M,u,h);q&&(r[U]=q)})}),x+=y.nrows})}function FF(e,t){var r=_t(t.data),n={"!ref":"A1"},i=e[$r(r[2][0].data)],l=nr(i[0].meta[1][0].data);if(l!=6001)throw new Error("6000 unexpected reference to ".concat(l));return DF(e,i[0],n),n}function MF(e,t){var r,n=_t(t.data),i={name:(r=n[1])!=null&&r[0]?Gd(n[1][0].data):"",sheets:[]},l=L1(n[2],$r);return l.forEach(function(o){e[o].forEach(function(u){var h=nr(u.meta[1][0].data);h==6e3&&i.sheets.push(FF(e,u))})}),i}function BF(e,t){var r=z1(),n=_t(t.data),i=L1(n[1],$r);if(i.forEach(function(l){e[l].forEach(function(o){var u=nr(o.meta[1][0].data);if(u==2){var h=MF(e,o);h.sheets.forEach(function(d,x){H1(r,d,x==0?h.name:h.name+"_"+x,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function wd(e){var t,r,n,i,l={},o=[];if(e.FullPaths.forEach(function(h){if(h.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(h){if(h.name.match(/\.iwa$/)){var d;try{d=qa(h.content)}catch(g){return console.log("?? "+h.content.length+" "+(g.message||g))}var x;try{x=Ga(d)}catch(g){return console.log("## "+(g.message||g))}x.forEach(function(g){l[g.id]=g.messages,o.push(g.id)})}}),!o.length)throw new Error("File has no messages");var u=((i=(n=(r=(t=l?.[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&nr(l[1][0].meta[1][0].data)==1&&l[1][0];if(u||o.forEach(function(h){l[h].forEach(function(d){var x=nr(d.meta[1][0].data)>>>0;if(x==1)if(!u)u=d;else throw new Error("Document has multiple roots")})}),!u)throw new Error("Cannot find Document root");return BF(l,u)}function LF(e,t,r){var n,i,l,o;if(!((n=e[6])!=null&&n[0])||!((i=e[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var u=((o=(l=e[8])==null?void 0:l[0])==null?void 0:o.data)&&nr(e[8][0].data)>0||!1;if(u)throw"Math only works with normal offsets";for(var h=0,d=As(e[7][0].data),x=0,g=[],v=As(e[4][0].data),_=0,w=[],y=0;y<t.length;++y){if(t[y]==null){d.setUint16(y*2,65535,!0),v.setUint16(y*2,65535);continue}d.setUint16(y*2,x,!0),v.setUint16(y*2,_,!0);var b,A;switch(typeof t[y]){case"string":b=yd({t:"s",v:t[y]},r),A=_d({t:"s",v:t[y]},r);break;case"number":b=yd({t:"n",v:t[y]},r),A=_d({t:"n",v:t[y]},r);break;case"boolean":b=yd({t:"b",v:t[y]},r),A=_d({t:"b",v:t[y]},r);break;default:throw new Error("Unsupported value "+t[y])}g.push(b),x+=b.length,w.push(A),_+=A.length,++h}for(e[2][0].data=Ct(h);y<e[7][0].data.length/2;++y)d.setUint16(y*2,65535,!0),v.setUint16(y*2,65535,!0);return e[6][0].data=zi(g),e[3][0].data=zi(w),h}function IF(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=da(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(it(n)));var l=Tu(r,{range:n,header:1}),o=["~Sh33tJ5~"];l.forEach(function(z){return z.forEach(function(P){typeof P=="string"&&o.push(P)})});var u={},h=[],d=qe.read(t.numbers,{type:"base64"});d.FileIndex.map(function(z,P){return[z,d.FullPaths[P]]}).forEach(function(z){var P=z[0],V=z[1];if(P.type==2&&P.name.match(/\.iwa/)){var ce=P.content,we=qa(ce),Ce=Ga(we);Ce.forEach(function(Ee){h.push(Ee.id),u[Ee.id]={deps:[],location:V,type:nr(Ee.messages[0].meta[1][0].data)}})}}),h.sort(function(z,P){return z-P});var x=h.filter(function(z){return z>1}).map(function(z){return[z,Ct(z)]});d.FileIndex.map(function(z,P){return[z,d.FullPaths[P]]}).forEach(function(z){var P=z[0];if(z[1],!!P.name.match(/\.iwa/)){var V=Ga(qa(P.content));V.forEach(function(ce){ce.messages.forEach(function(we){x.forEach(function(Ce){ce.messages.some(function(Ee){return nr(Ee.meta[1][0].data)!=11006&&bF(Ee.data,Ce[1])})&&u[Ce[0]].deps.push(ce.id)})})})}});for(var g=qe.find(d,u[1].location),v=Ga(qa(g.content)),_,w=0;w<v.length;++w){var y=v[w];y.id==1&&(_=y)}var b=$r(_t(_.messages[0].data)[1][0].data);for(g=qe.find(d,u[b].location),v=Ga(qa(g.content)),w=0;w<v.length;++w)y=v[w],y.id==b&&(_=y);for(b=$r(_t(_.messages[0].data)[2][0].data),g=qe.find(d,u[b].location),v=Ga(qa(g.content)),w=0;w<v.length;++w)y=v[w],y.id==b&&(_=y);for(b=$r(_t(_.messages[0].data)[2][0].data),g=qe.find(d,u[b].location),v=Ga(qa(g.content)),w=0;w<v.length;++w)y=v[w],y.id==b&&(_=y);var A=_t(_.messages[0].data);{A[6][0].data=Ct(n.e.r+1),A[7][0].data=Ct(n.e.c+1);var M=$r(A[46][0].data),T=qe.find(d,u[M].location),U=Ga(qa(T.content));{for(var q=0;q<U.length&&U[q].id!=M;++q);if(U[q].id!=M)throw"Bad ColumnRowUIDMapArchive";var I=_t(U[q].messages[0].data);I[1]=[],I[2]=[],I[3]=[];for(var R=0;R<=n.e.c;++R){var Q=[];Q[1]=Q[2]=[{type:0,data:Ct(R+420690)}],I[1].push({type:2,data:Ir(Q)}),I[2].push({type:0,data:Ct(R)}),I[3].push({type:0,data:Ct(R)})}I[4]=[],I[5]=[],I[6]=[];for(var G=0;G<=n.e.r;++G)Q=[],Q[1]=Q[2]=[{type:0,data:Ct(G+726270)}],I[4].push({type:2,data:Ir(Q)}),I[5].push({type:0,data:Ct(G)}),I[6].push({type:0,data:Ct(G)});U[q].messages[0].data=Ir(I)}T.content=Tl(El(U)),T.size=T.content.length,delete A[46];var ae=_t(A[4][0].data);{ae[7][0].data=Ct(n.e.r+1);var ne=_t(ae[1][0].data),J=$r(ne[2][0].data);T=qe.find(d,u[J].location),U=Ga(qa(T.content));{if(U[0].id!=J)throw"Bad HeaderStorageBucket";var ge=_t(U[0].messages[0].data);for(G=0;G<l.length;++G){var ke=_t(ge[2][0].data);ke[1][0].data=Ct(G),ke[4][0].data=Ct(l[G].length),ge[2][G]={type:ge[2][0].type,data:Ir(ke)}}U[0].messages[0].data=Ir(ge)}T.content=Tl(El(U)),T.size=T.content.length;var be=$r(ae[2][0].data);T=qe.find(d,u[be].location),U=Ga(qa(T.content));{if(U[0].id!=be)throw"Bad HeaderStorageBucket";for(ge=_t(U[0].messages[0].data),R=0;R<=n.e.c;++R)ke=_t(ge[2][0].data),ke[1][0].data=Ct(R),ke[4][0].data=Ct(n.e.r+1),ge[2][R]={type:ge[2][0].type,data:Ir(ke)};U[0].messages[0].data=Ir(ge)}T.content=Tl(El(U)),T.size=T.content.length;var Y=$r(ae[4][0].data);(function(){for(var z=qe.find(d,u[Y].location),P=Ga(qa(z.content)),V,ce=0;ce<P.length;++ce){var we=P[ce];we.id==Y&&(V=we)}var Ce=_t(V.messages[0].data);{Ce[3]=[];var Ee=[];o.forEach(function(H,St){Ee[1]=[{type:0,data:Ct(St)}],Ee[2]=[{type:0,data:Ct(1)}],Ee[3]=[{type:2,data:SF(H)}],Ce[3].push({type:2,data:Ir(Ee)})})}V.messages[0].data=Ir(Ce);var Oe=El(P),Qe=Tl(Oe);z.content=Qe,z.size=z.content.length})();var le=_t(ae[3][0].data);{var _e=le[1][0];delete le[2];var Z=_t(_e.data);{var De=$r(Z[2][0].data);(function(){for(var z=qe.find(d,u[De].location),P=Ga(qa(z.content)),V,ce=0;ce<P.length;++ce){var we=P[ce];we.id==De&&(V=we)}var Ce=_t(V.messages[0].data);{delete Ce[6],delete le[7];var Ee=new Uint8Array(Ce[5][0].data);Ce[5]=[];for(var Oe=0,Qe=0;Qe<=n.e.r;++Qe){var H=_t(Ee);Oe+=LF(H,l[Qe],o),H[1][0].data=Ct(Qe),Ce[5].push({data:Ir(H),type:2})}Ce[1]=[{type:0,data:Ct(n.e.c+1)}],Ce[2]=[{type:0,data:Ct(n.e.r+1)}],Ce[3]=[{type:0,data:Ct(Oe)}],Ce[4]=[{type:0,data:Ct(n.e.r+1)}]}V.messages[0].data=Ir(Ce);var St=El(P),tt=Tl(St);z.content=tt,z.size=z.content.length})()}_e.data=Ir(Z)}ae[3][0].data=Ir(le)}A[4][0].data=Ir(ae)}_.messages[0].data=Ir(A);var j=El(v),N=Tl(j);return g.content=N,g.size=g.content.length,d}function tw(e){return function(r){for(var n=0;n!=e.length;++n){var i=e[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function I1(e){tw([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function U1(e){tw([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function UF(e){return ot.WS.indexOf(e)>-1?"sheet":e==ot.CS?"chart":e==ot.DS?"dialog":e==ot.MS?"macro":e&&e.length?e:"sheet"}function jF(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,UF(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function PF(e,t,r,n,i,l,o,u,h,d,x,g){try{l[n]=Wc(Na(e,r,!0),t);var v=vr(e,t),_;switch(u){case"sheet":_=cD(v,t,i,h,l[n],d,x,g);break;case"chart":if(_=oD(v,t,i,h,l[n],d,x,g),!_||!_["!drawel"])break;var w=Hc(_["!drawel"].Target,t),y=fo(w),b=K8(Na(e,w,!0),Wc(Na(e,y,!0),w)),A=Hc(b,w),M=fo(A);_=LR(Na(e,A,!0),A,h,Wc(Na(e,M,!0),A),d,_);break;case"macro":_=uD(v,t,i,h,l[n],d,x,g);break;case"dialog":_=fD(v,t,i,h,l[n],d,x,g);break;default:throw new Error("Unrecognized sheet type "+u)}o[n]=_;var T=[];l&&l[n]&&ir(l[n]).forEach(function(U){var q="";if(l[n][U].Type==ot.CMNT){q=Hc(l[n][U].Target,t);var I=xD(vr(e,q,!0),q,h);if(!I||!I.length)return;oy(_,I,!1)}l[n][U].Type==ot.TCMNT&&(q=Hc(l[n][U].Target,t),T=T.concat(J8(vr(e,q,!0),h)))}),T&&T.length&&oy(_,T,!0,h.people||[])}catch(U){if(h.WTF)throw U}}function Va(e){return e.charAt(0)=="/"?e.slice(1):e}function zF(e,t){if(Vl(),t=t||{},I1(t),Xa(e,"META-INF/manifest.xml")||Xa(e,"objectdata.xml"))return _y(e,t);if(Xa(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof wd<"u"){if(e.FileIndex)return wd(e);var r=qe.utils.cfb_new();return Ov(e).forEach(function(ke){lt(r,ke,Qk(e,ke))}),wd(r)}throw new Error("Unsupported NUMBERS file")}if(!Xa(e,"[Content_Types].xml"))throw Xa(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Xa(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Ov(e),i=GA(Na(e,"[Content_Types].xml")),l=!1,o,u;if(i.workbooks.length===0&&(u="xl/workbook.xml",vr(e,u,!0)&&i.workbooks.push(u)),i.workbooks.length===0){if(u="xl/workbook.bin",!vr(e,u,!0))throw new Error("Could not find workbook");i.workbooks.push(u),l=!0}i.workbooks[0].slice(-3)=="bin"&&(l=!0);var h={},d={};if(!t.bookSheets&&!t.bookProps){if(Kc=[],i.sst)try{Kc=mD(vr(e,Va(i.sst)),i.sst,t)}catch(ke){if(t.WTF)throw ke}t.cellStyles&&i.themes.length&&(h=dD(Na(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],t)),i.style&&(d=hD(vr(e,Va(i.style)),i.style,h,t))}i.links.map(function(ke){try{var be=Wc(Na(e,fo(Va(ke))),ke);return gD(vr(e,Va(ke)),be,ke,t)}catch{}});var x=lD(vr(e,Va(i.workbooks[0])),i.workbooks[0],t),g={},v="";i.coreprops.length&&(v=vr(e,Va(i.coreprops[0]),!0),v&&(g=V_(v)),i.extprops.length!==0&&(v=vr(e,Va(i.extprops[0]),!0),v&&QA(v,g,t)));var _={};(!t.bookSheets||t.bookProps)&&i.custprops.length!==0&&(v=Na(e,Va(i.custprops[0]),!0),v&&(_=e3(v,t)));var w={};if((t.bookSheets||t.bookProps)&&(x.Sheets?o=x.Sheets.map(function(be){return be.name}):g.Worksheets&&g.SheetNames.length>0&&(o=g.SheetNames),t.bookProps&&(w.Props=g,w.Custprops=_),t.bookSheets&&typeof o<"u"&&(w.SheetNames=o),t.bookSheets?w.SheetNames:t.bookProps))return w;o={};var y={};t.bookDeps&&i.calcchain&&(y=pD(vr(e,Va(i.calcchain)),i.calcchain));var b=0,A={},M,T;{var U=x.Sheets;g.Worksheets=U.length,g.SheetNames=[];for(var q=0;q!=U.length;++q)g.SheetNames[q]=U[q].name}var I=l?"bin":"xml",R=i.workbooks[0].lastIndexOf("/"),Q=(i.workbooks[0].slice(0,R+1)+"_rels/"+i.workbooks[0].slice(R+1)+".rels").replace(/^\//,"");Xa(e,Q)||(Q="xl/_rels/workbook."+I+".rels");var G=Wc(Na(e,Q,!0),Q.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(t.xlmeta=vD(vr(e,Va(i.metadata[0])),i.metadata[0],t)),(i.people||[]).length>=1&&(t.people=Z8(vr(e,Va(i.people[0])),t)),G&&(G=jF(G,x.Sheets));var ae=vr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(b=0;b!=g.Worksheets;++b){var ne="sheet";if(G&&G[b]?(M="xl/"+G[b][1].replace(/[\/]?xl\//,""),Xa(e,M)||(M=G[b][1]),Xa(e,M)||(M=Q.replace(/_rels\/.*$/,"")+G[b][1]),ne=G[b][2]):(M="xl/worksheets/sheet"+(b+1-ae)+"."+I,M=M.replace(/sheet0\./,"sheet.")),T=M.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(b!=t.sheets)continue e;break;case"string":if(g.SheetNames[b].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var J=!1,ge=0;ge!=t.sheets.length;++ge)typeof t.sheets[ge]=="number"&&t.sheets[ge]==b&&(J=1),typeof t.sheets[ge]=="string"&&t.sheets[ge].toLowerCase()==g.SheetNames[b].toLowerCase()&&(J=1);if(!J)continue e}}PF(e,M,T,g.SheetNames[b],b,A,o,ne,t,x,h,d)}return w={Directory:i,Workbook:x,Props:g,Custprops:_,Deps:y,Sheets:o,SheetNames:g.SheetNames,Strings:Kc,Styles:d,Themes:h,SSF:qt(Je)},t&&t.bookFiles&&(e.files?(w.keys=n,w.files=e.files):(w.keys=[],w.files={},e.FullPaths.forEach(function(ke,be){ke=ke.replace(/^Root Entry[\/]/,""),w.keys.push(ke),w.files[ke]=e.FileIndex[be]}))),t&&t.bookVBA&&(i.vba.length>0?w.vbaraw=vr(e,Va(i.vba[0]),!0):i.defaults&&i.defaults.bin===lN&&(w.vbaraw=vr(e,"xl/vbaProject.bin",!0))),w}function HF(e,t){var r=t||{},n="Workbook",i=qe.find(e,n);try{if(n="/!DataSpaces/Version",i=qe.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(v6(i.content),n="/!DataSpaces/DataSpaceMap",i=qe.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=_6(i.content);if(l.length!==1||l[0].comps.length!==1||l[0].comps[0].t!==0||l[0].name!=="StrongEncryptionDataSpace"||l[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=qe.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=w6(i.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=qe.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);b6(i.content)}catch{}if(n="/EncryptionInfo",i=qe.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var u=E6(i.content);if(n="/EncryptedPackage",i=qe.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(u[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(u[1],i.content,r.password||"",r);if(u[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(u[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function VF(e,t){return t.bookType=="ods"?ew(e,t):t.bookType=="numbers"?IF(e,t):t.bookType=="xlsb"?$F(e,t):GF(e,t)}function $F(e,t){Rl=1024,e&&!e.SSF&&(e.SSF=qt(Je)),e&&e.SSF&&(Vl(),Ou(e.SSF),t.revssf=Du(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Yc?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=C2.indexOf(t.bookType)>-1,i=b1();U1(t=t||{});var l=o1(),o="",u=0;if(t.cellXfs=[],$i(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",lt(l,o,$_(e.Props,t)),i.coreprops.push(o),Nt(t.rels,2,o,ot.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var h=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&h.push(e.SheetNames[d]);e.Props.SheetNames=h}for(e.Props.Worksheets=e.Props.SheetNames.length,lt(l,o,X_(e.Props)),i.extprops.push(o),Nt(t.rels,3,o,ot.EXT_PROPS),e.Custprops!==e.Props&&ir(e.Custprops||{}).length>0&&(o="docProps/custom.xml",lt(l,o,W_(e.Custprops)),i.custprops.push(o),Nt(t.rels,4,o,ot.CUST_PROPS)),u=1;u<=e.SheetNames.length;++u){var x={"!id":{}},g=e.Sheets[e.SheetNames[u-1]],v=(g||{})["!type"]||"sheet";if(o="xl/worksheets/sheet"+u+"."+r,lt(l,o,_D(u-1,o,t,e,x)),i.sheets.push(o),Nt(t.wbrels,-1,"worksheets/sheet"+u+"."+r,ot.WS[0]),g){var _=g["!comments"],w=!1,y="";_&&_.length>0&&(y="xl/comments"+u+"."+r,lt(l,y,bD(_,y)),i.comments.push(y),Nt(x,-1,"../comments"+u+"."+r,ot.CMNT),w=!0),g["!legacy"]&&w&&lt(l,"xl/drawings/vmlDrawing"+u+".vml",k2(u,g["!comments"])),delete g["!comments"],delete g["!legacy"]}x["!id"].rId1&&lt(l,fo(o),Ml(x))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,lt(l,o,SD(t.Strings,o,t)),i.strs.push(o),Nt(t.wbrels,-1,"sharedStrings."+r,ot.SST)),o="xl/workbook."+r,lt(l,o,yD(e,o)),i.workbooks.push(o),Nt(t.rels,1,o,ot.WB),o="xl/theme/theme1.xml",lt(l,o,N1(e.Themes,t)),i.themes.push(o),Nt(t.wbrels,-1,"theme/theme1.xml",ot.THEME),o="xl/styles."+r,lt(l,o,wD(e,o,t)),i.styles.push(o),Nt(t.wbrels,-1,"styles."+r,ot.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",lt(l,o,e.vbaraw),i.vba.push(o),Nt(t.wbrels,-1,"vbaProject.bin",ot.VBA)),o="xl/metadata."+r,lt(l,o,ED(o)),i.metadata.push(o),Nt(t.wbrels,-1,"metadata."+r,ot.XLMETA),lt(l,"[Content_Types].xml",z_(i,t)),lt(l,"_rels/.rels",Ml(t.rels)),lt(l,"xl/_rels/workbook."+r+".rels",Ml(t.wbrels)),delete t.revssf,delete t.ssf,l}function GF(e,t){Rl=1024,e&&!e.SSF&&(e.SSF=qt(Je)),e&&e.SSF&&(Vl(),Ou(e.SSF),t.revssf=Du(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Yc?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=C2.indexOf(t.bookType)>-1,i=b1();U1(t=t||{});var l=o1(),o="",u=0;if(t.cellXfs=[],$i(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",lt(l,o,$_(e.Props,t)),i.coreprops.push(o),Nt(t.rels,2,o,ot.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var h=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&h.push(e.SheetNames[d]);e.Props.SheetNames=h}e.Props.Worksheets=e.Props.SheetNames.length,lt(l,o,X_(e.Props)),i.extprops.push(o),Nt(t.rels,3,o,ot.EXT_PROPS),e.Custprops!==e.Props&&ir(e.Custprops||{}).length>0&&(o="docProps/custom.xml",lt(l,o,W_(e.Custprops)),i.custprops.push(o),Nt(t.rels,4,o,ot.CUST_PROPS));var x=["SheetJ5"];for(t.tcid=0,u=1;u<=e.SheetNames.length;++u){var g={"!id":{}},v=e.Sheets[e.SheetNames[u-1]],_=(v||{})["!type"]||"sheet";if(o="xl/worksheets/sheet"+u+"."+r,lt(l,o,j2(u-1,t,e,g)),i.sheets.push(o),Nt(t.wbrels,-1,"worksheets/sheet"+u+"."+r,ot.WS[0]),v){var w=v["!comments"],y=!1,b="";if(w&&w.length>0){var A=!1;w.forEach(function(M){M[1].forEach(function(T){T.T==!0&&(A=!0)})}),A&&(b="xl/threadedComments/threadedComment"+u+"."+r,lt(l,b,Q8(w,x,t)),i.threadedcomments.push(b),Nt(g,-1,"../threadedComments/threadedComment"+u+"."+r,ot.TCMNT)),b="xl/comments"+u+"."+r,lt(l,b,A2(w)),i.comments.push(b),Nt(g,-1,"../comments"+u+"."+r,ot.CMNT),y=!0}v["!legacy"]&&y&&lt(l,"xl/drawings/vmlDrawing"+u+".vml",k2(u,v["!comments"])),delete v["!comments"],delete v["!legacy"]}g["!id"].rId1&&lt(l,fo(o),Ml(g))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,lt(l,o,m2(t.Strings,t)),i.strs.push(o),Nt(t.wbrels,-1,"sharedStrings."+r,ot.SST)),o="xl/workbook."+r,lt(l,o,$2(e)),i.workbooks.push(o),Nt(t.rels,1,o,ot.WB),o="xl/theme/theme1.xml",lt(l,o,N1(e.Themes,t)),i.themes.push(o),Nt(t.wbrels,-1,"theme/theme1.xml",ot.THEME),o="xl/styles."+r,lt(l,o,S2(e,t)),i.styles.push(o),Nt(t.wbrels,-1,"styles."+r,ot.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",lt(l,o,e.vbaraw),i.vba.push(o),Nt(t.wbrels,-1,"vbaProject.bin",ot.VBA)),o="xl/metadata."+r,lt(l,o,T2()),i.metadata.push(o),Nt(t.wbrels,-1,"metadata."+r,ot.XLMETA),x.length>1&&(o="xl/persons/person.xml",lt(l,o,eN(x)),i.people.push(o),Nt(t.wbrels,-1,"persons/person.xml",ot.PEOPLE)),lt(l,"[Content_Types].xml",z_(i,t)),lt(l,"_rels/.rels",Ml(t.rels)),lt(l,"xl/_rels/workbook."+r+".rels",Ml(t.wbrels)),delete t.revssf,delete t.ssf,l}function j1(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Oa(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function qF(e,t){return qe.find(e,"EncryptedPackage")?HF(e,t):W2(e,t)}function XF(e,t){var r,n=e,i=t||{};return i.type||(i.type=ct&&Buffer.isBuffer(e)?"buffer":"base64"),r=p_(n,i),zF(r,i)}function rw(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Vd(e.slice(r),t);default:break e}return jl.to_workbook(e,t)}function WF(e,t){var r="",n=j1(e,t);switch(t.type){case"base64":r=Oa(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=bs(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Lt(r)),t.type="binary",rw(r,t)}function KF(e,t){var r=e;return t.type=="base64"&&(r=Oa(r)),r=io.utils.decode(1200,r.slice(2),"str"),t.type="binary",rw(r,t)}function YF(e){return e.match(/[^\x00-\x7F]/)?Sn(e):e}function Sd(e,t,r,n){return n?(r.type="string",jl.to_workbook(e,r)):jl.to_workbook(t,r)}function qd(e,t){n1();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return qd(new Uint8Array(e),(r=qt(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,i=[0,0,0,0],l=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Ll={},r.dateNF&&(Ll.dateNF=r.dateNF),r.type||(r.type=ct&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=ct?"buffer":"binary",n=$k(e),typeof Uint8Array<"u"&&!ct&&(r.type="array")),r.type=="string"&&(l=!0,r.type="binary",r.codepage=65001,n=YF(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),u=new Uint8Array(o);if(u.foo="bar",!u.foo)return r=qt(r),r.type="array",qd(i1(n),r)}switch((i=j1(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return qF(qe.read(n,r),r);break;case 9:if(i[1]<=8)return W2(n,r);break;case 60:return Vd(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return t6(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return h2.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?XF(n,r):Sd(e,n,r,l);case 239:return i[3]===60?Vd(n,r):Sd(e,n,r,l);case 255:if(i[1]===254)return KF(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return _s.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return _s.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Hd.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return y2.to_workbook(n,r);break;case 10:case 13:case 32:return WF(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return e6.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?Hd.to_workbook(n,r):Sd(e,n,r,l)}function aw(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return bo(t.file,qe.write(e,{type:ct?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return qe.write(e,t)}function JF(e,t){var r=qt(t||{}),n=VF(e,r);return QF(n,r)}function QF(e,t){var r={},n=ct?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var i=e.FullPaths?qe.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(t.type=="binary"||t.type=="base64")return i;i=new Uint8Array(Nu(i))}return t.password&&typeof encrypt_agile<"u"?aw(encrypt_agile(i,t.password),t):t.type==="file"?bo(t.file,i):t.type=="string"?Lt(i):i}function ZF(e,t){var r=t||{},n=YD(e,r);return aw(n,r)}function wn(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return so(Sn(n));case"binary":return Sn(n);case"string":return e;case"file":return bo(t.file,n,"utf8");case"buffer":return ct?ei(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):wn(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function e7(e,t){switch(t.type){case"base64":return so(e);case"binary":return e;case"string":return e;case"file":return bo(t.file,e,"binary");case"buffer":return ct?ei(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function iu(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?so(r):t.type=="string"?Lt(r):r;case"file":return bo(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function nw(e,t){n1(),qR(e);var r=qt(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=nw(e,r);return r.type="array",Nu(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=e.SheetNames.indexOf(r.sheet),!e.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return wn(VD(e,r),r);case"slk":case"sylk":return wn(f2.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"htm":case"html":return wn(Y2(e.Sheets[e.SheetNames[i]],r),r);case"txt":return e7(iw(e.Sheets[e.SheetNames[i]],r),r);case"csv":return wn(P1(e.Sheets[e.SheetNames[i]],r),r,"\uFEFF");case"dif":return wn(h2.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"dbf":return iu(Hd.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"prn":return wn(jl.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"rtf":return wn(y2.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"eth":return wn(d2.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"fods":return wn(ew(e,r),r);case"wk1":return iu(_s.sheet_to_wk1(e.Sheets[e.SheetNames[i]],r),r);case"wk3":return iu(_s.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),iu(K2(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),ZF(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return JF(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function t7(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function r7(e,t,r){var n={};return n.type="file",n.file=t,t7(n),nw(e,n)}function a7(e,t,r,n,i,l,o,u){var h=or(r),d=u.defval,x=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),g=!0,v=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(v,"__rowNum__",{value:r,enumerable:!1})}catch{v.__rowNum__=r}else v.__rowNum__=r;if(!o||e[r])for(var _=t.s.c;_<=t.e.c;++_){var w=o?e[r][_]:e[n[_]+h];if(w===void 0||w.t===void 0){if(d===void 0)continue;l[_]!=null&&(v[l[_]]=d);continue}var y=w.v;switch(w.t){case"z":if(y==null)break;continue;case"e":y=y==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+w.t)}if(l[_]!=null){if(y==null)if(w.t=="e"&&y===null)v[l[_]]=null;else if(d!==void 0)v[l[_]]=d;else if(x&&y===null)v[l[_]]=null;else continue;else v[l[_]]=x&&(w.t!=="n"||w.t==="n"&&u.rawNumbers!==!1)?y:Qn(w,y,u);y!=null&&(g=!1)}}return{row:v,isempty:g}}function Tu(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,l=[],o=0,u="",h={s:{r:0,c:0},e:{r:0,c:0}},d=t||{},x=d.range!=null?d.range:e["!ref"];switch(d.header===1?n=1:d.header==="A"?n=2:Array.isArray(d.header)?n=3:d.header==null&&(n=0),typeof x){case"string":h=gt(x);break;case"number":h=gt(e["!ref"]),h.s.r=x;break;default:h=x}n>0&&(i=0);var g=or(h.s.r),v=[],_=[],w=0,y=0,b=Array.isArray(e),A=h.s.r,M=0,T={};b&&!e[A]&&(e[A]=[]);var U=d.skipHidden&&e["!cols"]||[],q=d.skipHidden&&e["!rows"]||[];for(M=h.s.c;M<=h.e.c;++M)if(!(U[M]||{}).hidden)switch(v[M]=Qt(M),r=b?e[A][M]:e[v[M]+g],n){case 1:l[M]=M-h.s.c;break;case 2:l[M]=v[M];break;case 3:l[M]=d.header[M-h.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),u=o=Qn(r,null,d),y=T[o]||0,!y)T[o]=1;else{do u=o+"_"+y++;while(T[u]);T[o]=y,T[u]=1}l[M]=u}for(A=h.s.r+i;A<=h.e.r;++A)if(!(q[A]||{}).hidden){var I=a7(e,h,A,v,n,l,b,d);(I.isempty===!1||(n===1?d.blankrows!==!1:d.blankrows))&&(_[w++]=I.row)}return _.length=w,_}var Ty=/"/g;function n7(e,t,r,n,i,l,o,u){for(var h=!0,d=[],x="",g=or(r),v=t.s.c;v<=t.e.c;++v)if(n[v]){var _=u.dense?(e[r]||[])[v]:e[n[v]+g];if(_==null)x="";else if(_.v!=null){h=!1,x=""+(u.rawNumbers&&_.t=="n"?_.v:Qn(_,null,u));for(var w=0,y=0;w!==x.length;++w)if((y=x.charCodeAt(w))===i||y===l||y===34||u.forceQuotes){x='"'+x.replace(Ty,'""')+'"';break}x=="ID"&&(x='"ID"')}else _.f!=null&&!_.F?(h=!1,x="="+_.f,x.indexOf(",")>=0&&(x='"'+x.replace(Ty,'""')+'"')):x="";d.push(x)}return u.blankrows===!1&&h?null:d.join(o)}function P1(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var i=gt(e["!ref"]),l=n.FS!==void 0?n.FS:",",o=l.charCodeAt(0),u=n.RS!==void 0?n.RS:`
`,h=u.charCodeAt(0),d=new RegExp((l=="|"?"\\|":l)+"+$"),x="",g=[];n.dense=Array.isArray(e);for(var v=n.skipHidden&&e["!cols"]||[],_=n.skipHidden&&e["!rows"]||[],w=i.s.c;w<=i.e.c;++w)(v[w]||{}).hidden||(g[w]=Qt(w));for(var y=0,b=i.s.r;b<=i.e.r;++b)(_[b]||{}).hidden||(x=n7(e,i,b,g,o,h,l,n),x!=null&&(n.strip&&(x=x.replace(d,"")),(x||n.blankrows!==!1)&&r.push((y++?u:"")+x)));return delete n.dense,r.join("")}function iw(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=P1(e,t);return r}function i7(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var i=gt(e["!ref"]),l="",o=[],u,h=[],d=Array.isArray(e);for(u=i.s.c;u<=i.e.c;++u)o[u]=Qt(u);for(var x=i.s.r;x<=i.e.r;++x)for(l=or(x),u=i.s.c;u<=i.e.c;++u)if(t=o[u]+l,r=d?(e[x]||[])[u]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}h[h.length]=t+"="+n}return h}function sw(e,t,r){var n=r||{},i=+!n.skipHeader,l=e||{},o=0,u=0;if(l&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var h=typeof n.origin=="string"?Zt(n.origin):n.origin;o=h.r,u=h.c}var d,x={s:{c:0,r:0},e:{c:u,r:o+t.length-1+i}};if(l["!ref"]){var g=gt(l["!ref"]);x.e.c=Math.max(x.e.c,g.e.c),x.e.r=Math.max(x.e.r,g.e.r),o==-1&&(o=g.e.r+1,x.e.r=o+t.length-1+i)}else o==-1&&(o=0,x.e.r=t.length-1+i);var v=n.header||[],_=0;t.forEach(function(y,b){ir(y).forEach(function(A){(_=v.indexOf(A))==-1&&(v[_=v.length]=A);var M=y[A],T="z",U="",q=Ze({c:u+_,r:o+b+i});d=yo(l,q),M&&typeof M=="object"&&!(M instanceof Date)?l[q]=M:(typeof M=="number"?T="n":typeof M=="boolean"?T="b":typeof M=="string"?T="s":M instanceof Date?(T="d",n.cellDates||(T="n",M=Er(M)),U=n.dateNF||Je[14]):M===null&&n.nullError&&(T="e",M=0),d?(d.t=T,d.v=M,delete d.w,delete d.R,U&&(d.z=U)):l[q]=d={t:T,v:M},U&&(d.z=U))})}),x.e.c=Math.max(x.e.c,u+v.length-1);var w=or(o);if(i)for(_=0;_<v.length;++_)l[Qt(_+u)+w]={t:"s",v:v[_]};return l["!ref"]=it(x),l}function s7(e,t){return sw(null,e,t)}function yo(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Zt(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?yo(e,Ze(t)):yo(e,Ze({r:t,c:r||0}))}function l7(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function z1(){return{SheetNames:[],Sheets:{}}}function H1(e,t,r,n){var i=1;if(!r)for(;i<=65535&&e.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var l=r.match(/(^.*?)(\d+)$/);i=l&&+l[2]||0;var o=l&&l[1]||r;for(++i;i<=65535&&e.SheetNames.indexOf(r=o+i)!=-1;++i);}if(V2(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function c7(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=l7(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function o7(e,t){return e.z=t,e}function lw(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function u7(e,t,r){return lw(e,"#"+t,r)}function f7(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function h7(e,t,r,n){for(var i=typeof t!="string"?t:gt(t),l=typeof t=="string"?t:it(t),o=i.s.r;o<=i.e.r;++o)for(var u=i.s.c;u<=i.e.c;++u){var h=yo(e,o,u);h.t="n",h.F=l,delete h.v,o==i.s.r&&u==i.s.c&&(h.f=r,n&&(h.D=!0))}return e}var su={encode_col:Qt,encode_row:or,encode_cell:Ze,encode_range:it,decode_col:g1,decode_row:p1,split_cell:SA,decode_cell:Zt,decode_range:da,format_cell:Qn,sheet_add_aoa:M_,sheet_add_json:sw,sheet_add_dom:J2,aoa_to_sheet:$l,json_to_sheet:s7,table_to_sheet:Q2,table_to_book:vF,sheet_to_csv:P1,sheet_to_txt:iw,sheet_to_json:Tu,sheet_to_html:Y2,sheet_to_formulae:i7,sheet_to_row_object_array:Tu,sheet_get_cell:yo,book_new:z1,book_append_sheet:H1,book_set_sheet_visibility:c7,cell_set_number_format:o7,cell_set_hyperlink:lw,cell_set_internal_link:u7,cell_add_comment:f7,sheet_set_array_formula:h7,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function d7(){const[e,t]=$e.useState("dashboard"),[r,n]=$e.useState(!0),[i,l]=$e.useState([]),[o,u]=$e.useState(""),[h,d]=$e.useState("772"),[x,g]=$e.useState(!1),[v,_]=$e.useState(50),[w,y]=$e.useState({771:1,772:1}),[b,A]=$e.useState(!1),[M,T]=$e.useState(null),[U,q]=$e.useState({loading:!0,message:"",type:""}),I=$e.useRef(null),[R,Q]=$e.useState({loading:!1,message:"",type:""}),G=$e.useRef(null),[ae,ne]=$e.useState({loading:!1,message:"",type:""}),J=$e.useRef(null),[ge,ke]=$e.useState({loading:!1,message:"",type:""}),[be,Y]=$e.useState([]),[le,_e]=$e.useState(null),Z=$e.useRef(null),[De,j]=$e.useState({loading:!1,message:"",type:""}),[N,z]=$e.useState([]),[P,V]=$e.useState(""),[ce,we]=$e.useState(1),[Ce,Ee]=$e.useState(50),Oe=he=>{const xe=he?.message?String(he.message):"";return xe.toLowerCase().includes("schema cache")||xe.toLowerCase().includes("could not find the table")?"Parece que en Supabase an no existe (o no se ha refrescado) la tabla `public.tertiary_packaging`. Ejecuta `supabase/schema.sql` en Supabase (SQL Editor) y luego recarga el schema con: NOTIFY pgrst, 'reload schema';":""};$e.useEffect(()=>{let he=!1;async function xe(){q({loading:!0,message:Mi?"Conectando a Supabase...":"Cargando datos locales...",type:"info"});try{const[Re,Le,je]=await Promise.all([Vt.getMedications(),Vt.getMonthlyBatches(),Vt.getSelectedMonthlyBatchId?.()]);if(he)return;l(Re??[]);const k=(Le??[]).map(L=>({...L,id:L?.id!=null?String(L.id):L.id}));Y(k);try{const L=await Vt.getTertiaryPackaging?.()??[];he||z(L??[])}catch(L){const re=Oe(L);he||(z([]),j({loading:!1,message:re?`${String(L?.message||L||"Error al cargar Empaque Terciario.")}. ${re}`:String(L?.message||L||"Error al cargar Empaque Terciario."),type:"error"}))}const F=je!=null?String(je):null,C=k?.[0]?.id??null,B=F&&k.some(L=>L.id===F)?F:C;_e(B),await Vt.setSelectedMonthlyBatchId?.(B),q({loading:!1,message:"",type:""})}catch(Re){if(he)return;q({loading:!1,message:Re?.message?String(Re.message):"No se pudieron cargar los datos.",type:"error"})}}return xe(),()=>{he=!0}},[]);const Qe=he=>{const xe=he==null?null:String(he);_e(xe),Vt.setSelectedMonthlyBatchId?.(xe)},H=he=>{const xe=String(he??"").trim();if(!xe)return"";const Re=xe.replace(/\D/g,"");return Re.length===9?`${Re.slice(0,3)}-${Re.slice(3,5)}-${Re.slice(5,9)}`:xe.replace(/\s+/g," ")},St=he=>{const xe=String(he??"").trim();if(!xe)return 0;const Re=xe.replace(/\s/g,""),Le=Re.includes(","),je=Re.includes(".");let k=Re;Le&&je?k=Re.replace(/,/g,""):Le&&!je&&(k=Re.replace(/,/g,"."));const F=Number.parseFloat(k);return Number.isFinite(F)?F:0},tt=$e.useMemo(()=>i.filter(he=>he.stock<=he.min_stock),[i]),xt=$e.useMemo(()=>({totalItems:i.length,lowStockCount:tt.length,totalStockValue:i.reduce((he,xe)=>he+xe.stock,0),recentConsumptions:be[0]?.items?.length||0}),[i,tt,be]),We=$e.useMemo(()=>{const he=String(h||"772"),xe=o.trim().toLowerCase(),Re=({siges_code:F,name:C})=>{const O=String(F||"").trim();if(O)return`code:${O.toLowerCase()}`;const B=String(C||"").trim().toLowerCase();return B?`name:${B}`:""},Le=F=>{F.sort((C,O)=>{const B=String(C.batch).localeCompare(String(O.batch));return B!==0?B:String(C.expiry_date).localeCompare(String(O.expiry_date))})},je=F=>{const C=[],O=new Map;for(const B of F){const L=String(B.siges_code||"").trim(),re=String(B.name||"").trim(),ie=`${L}||${re}`.toLowerCase(),W=O.get(ie),K={id:B.id,batch:String(B.batch||"").trim()||"S/N",expiry_date:B.expiry_date?String(B.expiry_date).trim():"",stock:Number(B.stock)||0};if(W)W.lots.push(K),W.stock+=K.stock;else{const te={id:`group:${ie}`,inventory_type:"771",siges_code:L,name:re,lots:[K],stock:K.stock};O.set(ie,te),C.push(te)}}for(const B of C)Le(B.lots);return C};if(he==="771"){const F=i.filter(O=>String(O.inventory_type||"772")==="771"),C=je(F);return xe?C.filter(O=>{const B=O.lots.map(re=>`${re.batch} ${re.expiry_date} ${re.stock}`).join(" ");return`${O.siges_code} ${O.name} ${B}`.toLowerCase().includes(xe)}):C}if(he==="total"){const F=(()=>{const W=(be??[]).slice().sort((te,ve)=>{const me=new Date(te?.created_at||te?.updated_at||0).getTime();return new Date(ve?.created_at||ve?.updated_at||0).getTime()-me}).slice(0,4),K=new Map;for(const te of W)for(const ve of te?.items??[]){const me=H(ve?.siges_code);if(!me)continue;const Fe=Number(ve?.quantity)||0;K.set(me,(K.get(me)||0)+Fe)}return K})(),C=new Map,O=({siges_code:ie,name:W})=>{const K=Re({siges_code:ie,name:W});if(!K)return null;const te=C.get(K);if(te)return te;const ve={id:`total:${K}`,inventory_type:"total",siges_code:String(ie||"").trim(),name:String(W||"").trim(),lots:[],stock772:0,stock771:0,stock:0};return C.set(K,ve),ve};for(const ie of i){const W=String(ie.inventory_type||"772");if(W!=="771"&&W!=="772")continue;const K=O({siges_code:ie.siges_code,name:ie.name});if(K)if(K.siges_code||(K.siges_code=String(ie.siges_code||"").trim()),K.name||(K.name=String(ie.name||"").trim()),W==="772")K.stock772+=Number(ie.stock)||0;else{const te={id:ie.id,batch:String(ie.batch||"").trim()||"S/N",expiry_date:ie.expiry_date?String(ie.expiry_date).trim():"",stock:Number(ie.stock)||0};K.lots.push(te),K.stock771+=te.stock}}const B=Array.from(C.values()).map(ie=>(Le(ie.lots),ie.stock=ie.stock772+ie.stock771,ie)),L=(be??[]).some(ie=>(ie?.items??[]).length>0),re=x&&L?B.filter(ie=>{const W=String(ie.siges_code||"").trim();return W?(F.get(W)||0)>0:!1}):B;return xe?re.filter(ie=>{const W=ie.lots.map(te=>`${te.batch} ${te.expiry_date} ${te.stock}`).join(" ");return`${ie.siges_code} ${ie.name} ${ie.stock772} ${ie.stock771} ${ie.stock} ${W}`.toLowerCase().includes(xe)}):re}const k=i.filter(F=>String(F.inventory_type||"772")===he);return xe?k.filter(F=>`${F.siges_code} ${F.name} ${F.category} ${F.batch} ${F.expiry_date} ${F.unit}`.toLowerCase().includes(xe)):k},[x,o,i,h,be]),Ue=w?.[String(h||"772")]??1,Ut=$e.useMemo(()=>{const he=v||50,xe=Math.max(1,Math.ceil(We.length/he)),Le=(Math.min(Math.max(Ue,1),xe)-1)*he;return We.slice(Le,Le+he)},[We,Ue,v]),Tr=$e.useMemo(()=>{const he=String(h||"772");return he==="total"?We.length:he!=="771"?i.filter(xe=>String(xe.inventory_type||"772")===he).length:We.length},[We,h,i]),Pr=$e.useMemo(()=>(be??[]).some(he=>(he?.items??[]).length>0),[be]),Jr=async()=>{try{j({loading:!0,message:"Sincronizando...",type:"info"});const he=await Vt.getTertiaryPackaging?.()??[];z(he),j({loading:!1,message:`Sincronizado: ${he.length} registros.`,type:"success"}),window.setTimeout(()=>j({loading:!1,message:"",type:""}),4e3)}catch(he){const xe=Oe(he);j({loading:!1,message:xe?`${String(he?.message||"No se pudo sincronizar.")}. ${xe}`:he?.message?String(he.message):"No se pudo sincronizar.",type:"error"})}},Tn=()=>{const he=[["CODIGO","MEDICAMENTO","EMPAQUE TERCIARIO"],["110-16-0010","PARACETAMOL 500 MG., TABLETAS",200]],xe=su.aoa_to_sheet(he),Re=su.book_new();su.book_append_sheet(Re,xe,"Empaque"),r7(Re,"empaque_terciario.xlsx")},Ra=async()=>{if(window.confirm("Desea eliminar toda la carga de Empaque Terciario? Esta accin no se puede deshacer."))try{j({loading:!0,message:"Eliminando...",type:"info"}),await Vt.clearTertiaryPackaging?.(),z([]),j({loading:!1,message:"Carga eliminada.",type:"success"}),window.setTimeout(()=>j({loading:!1,message:"",type:""}),4e3)}catch(xe){const Re=Oe(xe);j({loading:!1,message:Re?`${String(xe?.message||"No se pudo eliminar la carga.")}. ${Re}`:xe?.message?String(xe.message):"No se pudo eliminar la carga.",type:"error"})}},bt=he=>{const xe=he.target.files?.[0];if(!xe)return;j({loading:!0,message:`Procesando: ${xe.name}`,type:"info"});const Re=new FileReader;Re.onerror=()=>{j({loading:!1,message:"No se pudo leer el archivo.",type:"error"})},Re.onload=async Le=>{try{const je=Le.target?.result,k=qd(je,{type:"array"}),F=k.SheetNames?.[0];if(!F)throw new Error("El XLSX no tiene hojas.");const C=k.Sheets[F],O=su.sheet_to_json(C,{header:1,raw:!1,blankrows:!1}),B=Array.isArray(O)?O:[],re=(te=>{const ve=Me=>String(Me??"").trim().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]/g,""),me=ve(te?.[0]),Fe=ve(te?.[1]),Ae=ve(te?.[2]);return me.includes("siges")||me.includes("codigo")||Fe.includes("medicamento")||Ae.includes("cantidad")})(B?.[0])?B.slice(1):B,ie=new Map((i??[]).map(te=>[H(te.siges_code),String(te.name||"").trim()]).filter(([te])=>!!te)),W=re.map((te,ve)=>{const me=H(te?.[0]),Ae=String(te?.[1]??"").trim()||ie.get(me)||"",Me=St(te?.[2]);return me?{id:globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():String(Date.now())+ve,siges_code:me,medication_name:Ae,tertiary_quantity:Me}:null}).filter(Boolean),K=await Vt.upsertTertiaryPackaging?.(W)??W;z(K),j({loading:!1,message:`Empaque Terciario: ${W.length} registros importados/actualizados.`,type:"success"}),window.setTimeout(()=>j({loading:!1,message:"",type:""}),4e3)}catch(je){const k=Oe(je);j({loading:!1,message:k?`${String(je?.message||"Error al procesar/guardar el XLSX.")}. ${k}`:je?.message?String(je.message):"Error al procesar/guardar el XLSX.",type:"error"})}},Re.readAsArrayBuffer(xe),he.target.value=null},Or=$e.useMemo(()=>{const he=P.trim().toLowerCase(),xe=(N??[]).map(Re=>{const Le=H(Re?.siges_code),je=(i??[]).find(k=>H(k.siges_code)===Le)?.name;return{...Re,siges_code:Le,medication_name:String(Re?.medication_name||je||"").trim(),tertiary_quantity:Number(Re?.tertiary_quantity)||0}});return he?xe.filter(Re=>`${Re.siges_code} ${Re.medication_name}`.toLowerCase().includes(he)):xe},[i,N,P]),ma=$e.useMemo(()=>{const he=Ce||50,xe=Math.max(1,Math.ceil(Or.length/he)),Le=(Math.min(Math.max(ce,1),xe)-1)*he;return Or.slice(Le,Le+he)},[Or,ce,Ce]),hn=()=>{T(null),A(!0)},Xt=he=>{T(he),A(!0)},hr=async()=>{const he=await Vt.getMedications();l(he??[])},at=async he=>{he.preventDefault();const xe=new FormData(he.target),Re={id:M?M.id:globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():Date.now(),inventory_type:M?.inventory_type??String(h||"772"),siges_code:M?.siges_code??"",sicop_classifier:M?.sicop_classifier??"",sicop_identifier:M?.sicop_identifier??"",name:String(xe.get("name")||"").trim(),category:String(xe.get("category")||"").trim(),batch:String(xe.get("batch")||"").trim(),expiry_date:String(xe.get("expiry_date")||"").trim(),stock:Number.parseFloat(String(xe.get("stock")||"0"))||0,min_stock:Number.parseFloat(String(xe.get("min_stock")||"0"))||0,unit:String(xe.get("unit")||"").trim()};try{q({loading:!0,message:"Guardando...",type:"info"}),await Vt.upsertMedication(Re),await hr(),T(null),A(!1),q({loading:!1,message:"",type:""})}catch(Le){q({loading:!1,message:Le?.message?String(Le.message):"No se pudo guardar el medicamento.",type:"error"})}},Pt=async he=>{try{q({loading:!0,message:"Eliminando...",type:"info"}),await Vt.deleteMedication(he),await hr(),q({loading:!1,message:"",type:""})}catch(xe){q({loading:!1,message:xe?.message?String(xe.message):"No se pudo eliminar el medicamento.",type:"error"})}},zr=async()=>{try{q({loading:!0,message:"Eliminando catlogo...",type:"info"}),await Vt.clearMedications(),await hr(),q({loading:!1,message:"",type:""})}catch(he){q({loading:!1,message:he?.message?String(he.message):"No se pudo limpiar el catlogo.",type:"error"})}},Et=({siges_code:he,name:xe})=>{const Re=String(he||"").trim();if(Re)return`code:${Re}`;const Le=String(xe||"").trim().toLowerCase();return Le?`name:${Le}`:""},Tt=he=>{const xe=String(he??"").trim();if(!xe)return 0;const Re=xe.replace(/\s/g,""),Le=Re.includes(","),je=Re.includes(".");let k=Re;Le&&je?k=Re.replace(/,/g,""):Le&&!je&&(k=Re.replace(/,/g,"."));const F=Number.parseFloat(k);return Number.isFinite(F)?F:0},ra=he=>{const xe=String(he??"").trim();if(!xe)return null;const Re=xe.slice(0,10);if(/^\d{4}-\d{2}-\d{2}$/.test(Re))return Re;const Le=xe.replace(/\D/g,"");if(Le.length===8){const F=Le.slice(0,4),C=Le.slice(4,6),O=Le.slice(6,8);return`${F}-${C}-${O}`}const je=xe.match(/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/);if(je){const F=je[1].padStart(2,"0"),C=je[2].padStart(2,"0");return`${je[3]}-${C}-${F}`}const k=new Date(xe);return Number.isNaN(k.getTime())?null:k.toISOString().slice(0,10)},Wt=(he,xe,Re=[])=>{if(!he)return"";for(const Le of xe){const je=he.getElementsByTagName(Le)?.[0],k=je?.textContent!=null?String(je.textContent).trim():"";if(k)return k}for(const Le of Re){const je=he.getAttribute?.(Le);if(je!=null&&String(je).trim())return String(je).trim()}return""},ql=he=>{const Re=Array.from(he.getElementsByTagNameNS("*","FormattedAreaPair")).filter(F=>F.getAttribute("Level")==="4"&&F.getAttribute("Type")==="Group");if(!Re.length)return null;const Le=(F,C)=>{const O=Array.from(F.getElementsByTagNameNS("*","FormattedReportObject"));for(const B of O){const L=B.getAttribute?.("FieldName");if(!L||!C(L))continue;const re=B.getElementsByTagNameNS("*","Value")?.[0],ie=B.getElementsByTagNameNS("*","FormattedValue")?.[0],K=((re?.textContent!=null?String(re.textContent):"")||(ie?.textContent!=null?String(ie.textContent):"")).trim();if(K)return K}return""},je=F=>C=>String(C).includes(F),k=[];for(const F of Re){const C=Le(F,je(".PRODUCTO}")),O=Le(F,je(".DSC_PRODUCTO}")),B=H(C),L=String(O||"").trim();if(!B||!L)continue;const re=Array.from(F.getElementsByTagNameNS("*","FormattedAreaPair")).filter(ie=>ie.getAttribute("Level")==="5"&&ie.getAttribute("Type")==="Details");for(const ie of re){const W=Le(ie,je(".IDE_LOTE}"))||"S/N",K=Le(ie,je(".CAN_LOTE}"))||"0",te=Le(ie,je(".FEC_VENCIMIENTO}")),ve=Tt(K),me=ra(te);k.push({siges_code:B,name:L,batch:String(W).trim()||"S/N",expiry_date:me,stock:ve})}}return k},Ms=he=>{const Re=new DOMParser().parseFromString(String(he||""),"application/xml");if(Re.querySelector("parsererror"))throw new Error("XML invlido o mal formado.");const Le=ql(Re);if(Array.isArray(Le))return Le;const je=["CodigoSIGES","CodigoSiges","codigoSIGES","codigoSiges","Codigo","codigo","SIGES","Siges","siges_code"],k=["Medicamento","medicamento","Nombre","nombre","Descripcion","descripcion","Medication"],F=["Lote","lote","Batch","batch","LoteMedicamento","loteMedicamento"],C=["Vencimiento","vencimiento","FechaVencimiento","fechaVencimiento","FechaCaducidad","fechaCaducidad","expiry_date","ExpiryDate"],O=["Inventario","inventario","Stock","stock","Existencia","existencia","Cantidad","cantidad"],B=new Set;for(const re of je){const ie=Re.getElementsByTagName(re);for(const W of ie){let K=W.parentElement,te=0;for(;K&&K!==Re.documentElement&&te<6;){const ve=!!Wt(K,F,["lote","Lote","batch","Batch"]),me=!!Wt(K,C,["vencimiento","Vencimiento","expiry","Expiry"]),Fe=!!Wt(K,O,["inventario","Inventario","stock","Stock"]);if(ve||me||Fe)break;K=K.parentElement,te+=1}K&&B.add(K)}}const L=[];for(const re of B){const ie=Wt(re,je,["CodigoSIGES","codigoSIGES","siges_code","Codigo","codigo"]),W=Wt(re,k,["Medicamento","medicamento","Nombre","nombre"]).trim(),K=Wt(re,F,["Lote","lote","Batch","batch"]).trim(),te=Wt(re,C,["Vencimiento","vencimiento","ExpiryDate","expiry_date"]).trim(),ve=Wt(re,O,["Inventario","inventario","Stock","stock"]).trim();!ie||!W||L.push({siges_code:H(ie),name:W||"Sin nombre",batch:K||"S/N",expiry_date:ra(te),stock:Tt(ve)})}return L},ai=({siges_code:he,name:xe,batch:Re,expiry_date:Le})=>{const je=String(he||"").trim(),k=String(xe||"").trim().toLowerCase(),F=String(Re||"").trim().toLowerCase(),C=Le?String(Le).trim():"";return je?`code:${je}|lot:${F}|exp:${C}`:`name:${k}|lot:${F}|exp:${C}`},kn=async({text:he})=>{const Re=Ms(he),Le=[],je=new Set;for(const W of Re){const K=ai(W);!K||je.has(K)||(je.add(K),Le.push(W))}const F=(await Vt.getMedications()??[]).filter(W=>String(W.inventory_type||"772")==="771"),C=new Map(F.map(W=>[ai(W),W.id]).filter(([W])=>!!W)),O=Date.now(),B=Le.map((W,K)=>{const te=ai(W);return{id:C.get(te)??(globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():O+K),inventory_type:"771",siges_code:W.siges_code,sicop_classifier:"",sicop_identifier:"",name:W.name,category:"General",batch:W.batch||"S/N",expiry_date:W.expiry_date,stock:W.stock,min_stock:0,unit:"Unidad"}});await Vt.upsertMedications(B);const L=await Vt.getMedications()??[],re=L.filter(W=>String(W.inventory_type||"772")==="771").length,ie=L.reduce((W,K)=>{const te=String(K.inventory_type||"772");return W[te]=(W[te]||0)+1,W},{});return await hr(),{importedCount:B.length,visibleCountForType:re,totalCountByType:ie}},ni=he=>{const xe=k=>String(k??"").trim().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]/g,""),Re=xe(he?.[0]),Le=xe(he?.[1]),je=xe(he?.[2]);return Re.includes("siges")||Re.includes("codigosiges")||Le.includes("medicamento")||Le.includes("nombre")||je.includes("inventario")||je.includes("stock")},ii=async({text:he,type:xe})=>{const Re=String(xe||"772").trim()||"772",Le=$g(he),je=ni(Le?.[0])?Le.slice(1):Le,k=je.some(me=>{const Fe=String(me?.[0]??"").trim(),Ae=String(me?.[1]??"").trim();return!!(Fe&&Ae)}),F=k?null:Gg(he),O=(await Vt.getMedications()??[]).filter(me=>String(me.inventory_type||"772")===Re),B=new Map(O.map(me=>[Et(me),me.id]).filter(([me])=>!!me)),L=Date.now(),re=(je??[]).map((me,Fe)=>{if(!k)return null;const Ae=String(me?.[0]??"").trim(),Me=String(me?.[1]??"").trim();if(!Ae||!Me)return null;const Pe=Et({siges_code:Ae,name:Me});return Pe?{id:B.get(Pe)??(globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():L+Fe),inventory_type:Re,siges_code:Ae,sicop_classifier:"",sicop_identifier:"",name:Me,category:"General",batch:"S/N",expiry_date:Qh(""),stock:Tt(me?.[2]),min_stock:0,unit:"Unidad"}:null}).filter(Boolean),ie=(F??[]).map((me,Fe)=>{if(k)return null;const Ae=String(me.CodigoSIGES||"").trim(),Me=String(me.Medicamento||me.Nombre||"").trim(),Pe=Et({siges_code:Ae,name:Me});return Pe?{id:B.get(Pe)??(globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():L+Fe),inventory_type:Re,siges_code:Ae,sicop_classifier:String(me.ClasificadorSICOP||"").trim(),sicop_identifier:String(me.IdentificadorSICOP||"").trim(),name:Me||"Sin nombre",category:String(me.Categoria||"General").trim()||"General",batch:String(me.Lote||"S/N").trim()||"S/N",expiry_date:Qh(me.Vencimiento),stock:Tt(me.Stock),min_stock:Tt(me.StockMinimo||0),unit:String(me.Unidad||"Unidad").trim()||"Unidad"}:null}).filter(Boolean),W=k?re:ie;await Vt.upsertMedications(W);const K=await Vt.getMedications()??[],te=K.filter(me=>String(me.inventory_type||"772")===Re).length,ve=K.reduce((me,Fe)=>{const Ae=String(Fe.inventory_type||"772");return me[Ae]=(me[Ae]||0)+1,me},{});return await hr(),{importedCount:W.length,visibleCountForType:te,totalCountByType:ve}},aa=he=>{const xe=he.target.files?.[0];if(!xe)return;Q({loading:!0,message:"Procesando archivo...",type:"info"});const Re=new FileReader;Re.onerror=()=>{Q({loading:!1,message:"No se pudo leer el archivo.",type:"error"})},Re.onload=async Le=>{try{const je=String(Le.target?.result||""),k=Gg(je),F=Date.now(),C=k.map((O,B)=>({id:globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():F+B,inventory_type:"772",siges_code:String(O.CodigoSIGES||"").trim(),sicop_classifier:String(O.ClasificadorSICOP||"").trim(),sicop_identifier:String(O.IdentificadorSICOP||"").trim(),name:O.Medicamento||O.Nombre||"Sin nombre",category:O.Categoria||"General",batch:O.Lote||"S/N",expiry_date:Qh(O.Vencimiento),stock:Tt(O.Stock),min_stock:Tt(O.StockMinimo||10),unit:O.Unidad||"Unidad"}));await Vt.upsertMedications(C),await hr(),Q({loading:!1,message:`Se han importado ${C.length} medicamentos con xito.`,type:"success"}),window.setTimeout(()=>Q({loading:!1,message:"",type:""}),4e3)}catch(je){const k=je?.message?String(je.message):"",C=k.includes("invalid input syntax for type integer")?"Tu base de datos en Supabase tiene `stock`/`min_stock` como INTEGER. Ejecuta `supabase/schema.sql` (ALTER COLUMN a NUMERIC) o usa valores enteros.":"";Q({loading:!1,message:C?`${k}. ${C}`:k||"Error al procesar/guardar el CSV.",type:"error"})}},Re.readAsText(xe),he.target.value=null},si=he=>{const xe=String(he||h||"772");if(xe!=="total")return xe==="771"?NE(xe):CE(xe)},An=he=>{const xe=he.target.files?.[0];if(!xe)return;const Re=String(h||"772");if(Re==="total"){ne({loading:!1,message:"Inventario total no admite carga de archivos.",type:"error"}),he.target.value=null;return}const Le=String(xe.name||"").toLowerCase(),je=Le.endsWith(".xml"),k=Le.endsWith(".csv");if(Re==="771"&&!je){ne({loading:!1,message:"Para inventario 771, selecciona un archivo .xml.",type:"error"}),he.target.value=null;return}if(Re!=="771"&&!k){ne({loading:!1,message:"Para inventario 772, selecciona un archivo .csv.",type:"error"}),he.target.value=null;return}ne({loading:!0,message:`Procesando inventario ${Re}: ${xe.name}`,type:"info"});const F=new FileReader;F.onerror=()=>{ne({loading:!1,message:"No se pudo leer el archivo.",type:"error"})},F.onload=async C=>{try{const O=String(C.target?.result||""),B=Re==="771"?await kn({text:O}):await ii({text:O,type:Re}),L=B?.importedCount??0,re=B?.visibleCountForType??0,ie=L>0&&re===0&&W0==="supabase"&&Mi?"Import datos pero no se pueden listar. Revisa RLS/policies en Supabase para `medications` (SELECT/ALL para `anon`).":"";ne({loading:!1,message:`Inventario ${Re}: ${L} medicamentos importados/actualizados.${ie?` ${ie}`:""}`,type:"success"}),window.setTimeout(()=>ne({loading:!1,message:"",type:""}),4e3)}catch(O){const B=O?.message?String(O.message):"",re=B.includes("invalid input syntax for type integer")?"Tu base de datos en Supabase tiene `stock`/`min_stock` como INTEGER. Ejecuta `supabase/schema.sql` (ALTER COLUMN a NUMERIC) y vuelve a intentar.":"";ne({loading:!1,message:re?`${B}. ${re}`:B||`Error al procesar/guardar el ${Re==="771"?"XML":"CSV"}.`,type:"error"})}},F.readAsText(xe),he.target.value=null},Xl=async he=>{const xe=String(he||h||"772");if(!(xe==="total"||!window.confirm(`Desea eliminar toda la carga del inventario ${xe}? Esta accin no se puede deshacer.`)))try{ne({loading:!0,message:`Eliminando inventario ${xe}...`,type:"info"}),await Vt.clearMedicationsByInventoryType?.(xe),await hr(),ne({loading:!1,message:`Inventario ${xe} eliminado.`,type:"success"}),window.setTimeout(()=>ne({loading:!1,message:"",type:""}),4e3)}catch(Le){ne({loading:!1,message:Le?.message?String(Le.message):"No se pudo eliminar el inventario.",type:"error"})}},Bs=he=>String(he||"").replace(/\.[^/.]+$/,"").trim()||"Mes sin nombre",Gi=he=>{const xe=he.target.files?.[0];if(!xe)return;const Re=Bs(xe.name);ke({loading:!0,message:`Procesando: ${xe.name}`,type:"info"});const Le=new FileReader;Le.onerror=()=>{ke({loading:!1,message:"No se pudo leer el archivo.",type:"error"})},Le.onload=async je=>{try{const k=String(je.target?.result||""),F=$g(k),C=W=>(W||[]).some(K=>/codigo|siges|medicamento|consumo|costo/i.test(String(K||""))),O=W=>{const K=String(W??"").trim();if(!K)return 0;const te=K.includes(",")&&K.includes(".")?K.replace(/,/g,""):K.includes(",")&&!K.includes(".")?K.replace(/,/g,"."):K,ve=Number.parseFloat(te.replace(/\s+/g,""));return Number.isFinite(ve)?ve:0},L=(C(F[0])?F.slice(1):F).map(W=>{const K=String(W?.[0]??"").trim(),te=String(W?.[1]??"").trim(),ve=O(W?.[2]),me=O(W?.[3]);return!K||!te?null:{id:globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():String(Date.now())+Math.random(),siges_code:K,medication_name:te,quantity:ve,cost:me}}).filter(Boolean),re=await Vt.saveMonthlyBatch({id:globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():String(Date.now()),label:Re,items:L}),ie=await Vt.getMonthlyBatches();Y(ie??[]),Qe(re?.id??null),ke({loading:!1,message:`Mes "${Re}": ${L.length} registros importados.`,type:"success"}),window.setTimeout(()=>ke({loading:!1,message:"",type:""}),4e3)}catch(k){ke({loading:!1,message:k?.message?String(k.message):"Error al procesar/guardar el CSV.",type:"error"})}},Le.readAsText(xe),he.target.value=null},Qa=async()=>{try{ke({loading:!0,message:"Sincronizando consumos...",type:"info"});const xe=(await Vt.getMonthlyBatches()??[]).map(C=>({...C,id:C?.id!=null?String(C.id):C.id}));Y(xe);const Re=le!=null?String(le):null,je=Re&&xe.some(C=>C.id===Re)?Re:xe?.[0]?.id??null;Qe(je);const k=W0==="supabase"&&Mi?`supabase${X0?` (${X0})`:""}`:`local${Mi?" (Supabase disponible pero no seleccionado)":" (Supabase no configurado)"}`,F=xe.length===0&&W0==="supabase"&&Mi?"Si en Supabase ves meses cargados, revisa RLS/policies para `anon` (SELECT en `monthly_batches`).":xe.length===0?"Si tus consumos estn en Supabase, configura `VITE_SUPABASE_URL` y `VITE_SUPABASE_ANON_KEY` y usa `VITE_DATA_PROVIDER=supabase`.":"";ke({loading:!1,message:`Sincronizado (${k}): ${xe.length} meses encontrados.${F?` ${F}`:""}`,type:"success"}),window.setTimeout(()=>ke({loading:!1,message:"",type:""}),4e3)}catch(he){ke({loading:!1,message:he?.message?String(he.message):"No se pudieron sincronizar los consumos.",type:"error"})}},Ls=async()=>{try{ne({loading:!0,message:"Sincronizando inventarios...",type:"info"});const he=await Vt.getMedications()??[];l(he);const xe=he.reduce((Le,je)=>{const k=String(je.inventory_type||"772");return Le[k]=(Le[k]||0)+1,Le},{771:0,772:0}),Re=W0==="supabase"&&Mi?`supabase${X0?` (${X0})`:""}`:"local";ne({loading:!1,message:`Sincronizado (${Re}): 771=${xe[771]||0}, 772=${xe[772]||0}.`,type:"success"}),window.setTimeout(()=>ne({loading:!1,message:"",type:""}),4e3)}catch(he){ne({loading:!1,message:he?.message?String(he.message):"No se pudieron sincronizar los inventarios.",type:"error"})}};return E.jsxs("div",{className:"flex h-screen bg-slate-50 font-sans text-slate-900 overflow-hidden",children:[E.jsx(lE,{activeTab:e,isSidebarOpen:r,onSelectTab:t,onToggleSidebar:()=>n(he=>!he)}),E.jsxs("main",{className:"flex-1 overflow-y-auto p-8",children:[E.jsx(sE,{activeTab:e,onNewMedication:hn}),U.message&&E.jsxs("div",{className:`mb-6 p-3 rounded-lg text-xs flex items-center justify-between gap-3 ${U.type==="error"?"bg-red-50 text-red-700 border border-red-100":"bg-blue-50 text-blue-700 border border-blue-100"}`,children:[E.jsx("span",{children:U.message}),E.jsx("button",{type:"button",onClick:()=>q({loading:!1,message:"",type:""}),className:"text-[11px] font-bold hover:underline",children:"Cerrar"})]}),e==="catalog"&&E.jsx(oE,{medications:i,excelStatus:R,fileInputRef:I,onChooseFile:()=>I.current?.click(),onDownloadTemplate:kE,onFileChange:aa,onEditMedication:Xt,onDeleteMedication:Pt,onClearCatalog:zr}),e==="dashboard"&&E.jsx(mE,{stats:xt,consumptions:be[0]?.items||[],lowStockItems:tt,onViewAllConsumptions:()=>t("consumption-monthly"),onEditMedication:Xt}),e==="inventory"&&E.jsx(xE,{inventoryType:h,onInventoryTypeChange:he=>{d(he),u(""),y(xe=>({...xe,[String(he||"772")]:1})),ne({loading:!1,message:"",type:""})},inventoryStatus:ae,fileInputRef:G,onChooseFile:()=>G.current?.click(),onFileChange:An,onDownloadTemplate:si,onRefresh:Ls,canClear:String(h||"772")!=="total"&&Tr>0,onClearInventory:Xl,hideNoMovement:x,canToggleHideNoMovement:Pr,onToggleHideNoMovement:()=>{g(he=>!he),y(he=>({...he,total:1}))},search:o,onSearchChange:he=>{u(he),y(xe=>({...xe,[String(h||"772")]:1}))},items:Ut,totalItems:We.length,page:Ue,pageSize:v,onPageChange:he=>{const xe=Math.max(1,Math.ceil(We.length/(v||1))),Re=Math.min(Math.max(Number(he)||1,1),xe);y(Le=>({...Le,[String(h||"772")]:Re}))},onPageSizeChange:he=>{_(he),y(xe=>({...xe,[String(h||"772")]:1}))}}),e==="consumption-monthly"&&E.jsx(gE,{months:be,selectedMonthId:le,onSelectMonth:Qe,monthlyStatus:ge,fileInputRef:J,onChooseFile:()=>J.current?.click(),onFileChange:Gi,onDownloadTemplate:AE,onRefresh:Qa}),e==="consumption-summary"&&E.jsx(dE,{months:be,onRefresh:Qa,status:ge}),e==="order-request"&&E.jsx(_E,{medications:i,months:be,inventoryStatus:ae,monthlyStatus:ge,onRefreshInventories:Ls,onRefreshConsumptions:Qa}),e==="tertiary-packaging"&&E.jsx(wE,{status:De,fileInputRef:Z,onChooseFile:()=>Z.current?.click(),onFileChange:bt,onDownloadTemplate:Tn,onRefresh:Jr,canClear:(N??[]).length>0,onClear:Ra,search:P,onSearchChange:he=>{V(he),we(1)},items:ma,totalItems:Or.length,page:ce,pageSize:Ce,onPageChange:he=>{const xe=Math.max(1,Math.ceil(Or.length/(Ce||1))),Re=Math.min(Math.max(Number(he)||1,1),xe);we(Re)},onPageSizeChange:he=>{Ee(he),we(1)}}),e==="alerts"&&E.jsx(cE,{lowStockItems:tt,onEditMedication:Xt})]}),b&&E.jsx(iE,{editingMed:M,onClose:()=>A(!1),onSubmit:at})]})}function m7(){return E.jsx(d7,{})}Eb.createRoot(document.getElementById("root")).render(E.jsx($e.StrictMode,{children:E.jsx(m7,{})}));
