(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function r(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(s){if(s.ep)return;s.ep=!0;const l=r(s);fetch(s.href,l)}})();var cd={exports:{}},ic={};var Bx;function vS(){if(Bx)return ic;Bx=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function r(a,s,l){var c=null;if(l!==void 0&&(c=""+l),s.key!==void 0&&(c=""+s.key),"key"in s){l={};for(var u in s)u!=="key"&&(l[u]=s[u])}else l=s;return s=l.ref,{$$typeof:e,type:a,key:c,ref:s!==void 0?s:null,props:l}}return ic.Fragment=t,ic.jsx=r,ic.jsxs=r,ic}var Ix;function yS(){return Ix||(Ix=1,cd.exports=vS()),cd.exports}var w=yS(),ud={exports:{}},gt={};var jx;function _S(){if(jx)return gt;jx=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),c=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),x=Symbol.for("react.activity"),v=Symbol.iterator;function _(I){return I===null||typeof I!="object"?null:(I=v&&I[v]||I["@@iterator"],typeof I=="function"?I:null)}var b={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,S={};function k(I,N,U){this.props=I,this.context=N,this.refs=S,this.updater=U||b}k.prototype.isReactComponent={},k.prototype.setState=function(I,N){if(typeof I!="object"&&typeof I!="function"&&I!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,I,N,"setState")},k.prototype.forceUpdate=function(I){this.updater.enqueueForceUpdate(this,I,"forceUpdate")};function R(){}R.prototype=k.prototype;function T(I,N,U){this.props=I,this.context=N,this.refs=S,this.updater=U||b}var j=T.prototype=new R;j.constructor=T,y(j,k.prototype),j.isPureReactComponent=!0;var X=Array.isArray;function L(){}var A={H:null,A:null,T:null,S:null},K=Object.prototype.hasOwnProperty;function q(I,N,U){var M=U.ref;return{$$typeof:e,type:I,key:N,ref:M!==void 0?M:null,props:U}}function ie(I,N){return q(I.type,N,I.props)}function ne(I){return typeof I=="object"&&I!==null&&I.$$typeof===e}function Z(I){var N={"=":"=0",":":"=2"};return"$"+I.replace(/[=:]/g,function(U){return N[U]})}var me=/\/+/g;function Re(I,N){return typeof I=="object"&&I!==null&&I.key!=null?Z(""+I.key):N.toString(36)}function Ae(I){switch(I.status){case"fulfilled":return I.value;case"rejected":throw I.reason;default:switch(typeof I.status=="string"?I.then(L,L):(I.status="pending",I.then(function(N){I.status==="pending"&&(I.status="fulfilled",I.value=N)},function(N){I.status==="pending"&&(I.status="rejected",I.reason=N)})),I.status){case"fulfilled":return I.value;case"rejected":throw I.reason}}throw I}function V(I,N,U,M,P){var te=typeof I;(te==="undefined"||te==="boolean")&&(I=null);var pe=!1;if(I===null)pe=!0;else switch(te){case"bigint":case"string":case"number":pe=!0;break;case"object":switch(I.$$typeof){case e:case t:pe=!0;break;case g:return pe=I._init,V(pe(I._payload),N,U,M,P)}}if(pe)return P=P(I),pe=M===""?"."+Re(I,0):M,X(P)?(U="",pe!=null&&(U=pe.replace(me,"$&/")+"/"),V(P,N,U,"",function(Te){return Te})):P!=null&&(ne(P)&&(P=ie(P,U+(P.key==null||I&&I.key===P.key?"":(""+P.key).replace(me,"$&/")+"/")+pe)),N.push(P)),1;pe=0;var Ee=M===""?".":M+":";if(X(I))for(var ve=0;ve<I.length;ve++)M=I[ve],te=Ee+Re(M,ve),pe+=V(M,N,U,te,P);else if(ve=_(I),typeof ve=="function")for(I=ve.call(I),ve=0;!(M=I.next()).done;)M=M.value,te=Ee+Re(M,ve++),pe+=V(M,N,U,te,P);else if(te==="object"){if(typeof I.then=="function")return V(Ae(I),N,U,M,P);throw N=String(I),Error("Objects are not valid as a React child (found: "+(N==="[object Object]"?"object with keys {"+Object.keys(I).join(", ")+"}":N)+"). If you meant to render a collection of children, use an array instead.")}return pe}function ae(I,N,U){if(I==null)return I;var M=[],P=0;return V(I,M,"","",function(te){return N.call(U,te,P++)}),M}function xe(I){if(I._status===-1){var N=I._result;N=N(),N.then(function(U){(I._status===0||I._status===-1)&&(I._status=1,I._result=U)},function(U){(I._status===0||I._status===-1)&&(I._status=2,I._result=U)}),I._status===-1&&(I._status=0,I._result=N)}if(I._status===1)return I._result.default;throw I._result}var J=typeof reportError=="function"?reportError:function(I){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var N=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof I=="object"&&I!==null&&typeof I.message=="string"?String(I.message):String(I),error:I});if(!window.dispatchEvent(N))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",I);return}console.error(I)},be={map:ae,forEach:function(I,N,U){ae(I,function(){N.apply(this,arguments)},U)},count:function(I){var N=0;return ae(I,function(){N++}),N},toArray:function(I){return ae(I,function(N){return N})||[]},only:function(I){if(!ne(I))throw Error("React.Children.only expected to receive a single React element child.");return I}};return gt.Activity=x,gt.Children=be,gt.Component=k,gt.Fragment=r,gt.Profiler=s,gt.PureComponent=T,gt.StrictMode=a,gt.Suspense=h,gt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=A,gt.__COMPILER_RUNTIME={__proto__:null,c:function(I){return A.H.useMemoCache(I)}},gt.cache=function(I){return function(){return I.apply(null,arguments)}},gt.cacheSignal=function(){return null},gt.cloneElement=function(I,N,U){if(I==null)throw Error("The argument must be a React element, but you passed "+I+".");var M=y({},I.props),P=I.key;if(N!=null)for(te in N.key!==void 0&&(P=""+N.key),N)!K.call(N,te)||te==="key"||te==="__self"||te==="__source"||te==="ref"&&N.ref===void 0||(M[te]=N[te]);var te=arguments.length-2;if(te===1)M.children=U;else if(1<te){for(var pe=Array(te),Ee=0;Ee<te;Ee++)pe[Ee]=arguments[Ee+2];M.children=pe}return q(I.type,P,M)},gt.createContext=function(I){return I={$$typeof:c,_currentValue:I,_currentValue2:I,_threadCount:0,Provider:null,Consumer:null},I.Provider=I,I.Consumer={$$typeof:l,_context:I},I},gt.createElement=function(I,N,U){var M,P={},te=null;if(N!=null)for(M in N.key!==void 0&&(te=""+N.key),N)K.call(N,M)&&M!=="key"&&M!=="__self"&&M!=="__source"&&(P[M]=N[M]);var pe=arguments.length-2;if(pe===1)P.children=U;else if(1<pe){for(var Ee=Array(pe),ve=0;ve<pe;ve++)Ee[ve]=arguments[ve+2];P.children=Ee}if(I&&I.defaultProps)for(M in pe=I.defaultProps,pe)P[M]===void 0&&(P[M]=pe[M]);return q(I,te,P)},gt.createRef=function(){return{current:null}},gt.forwardRef=function(I){return{$$typeof:u,render:I}},gt.isValidElement=ne,gt.lazy=function(I){return{$$typeof:g,_payload:{_status:-1,_result:I},_init:xe}},gt.memo=function(I,N){return{$$typeof:d,type:I,compare:N===void 0?null:N}},gt.startTransition=function(I){var N=A.T,U={};A.T=U;try{var M=I(),P=A.S;P!==null&&P(U,M),typeof M=="object"&&M!==null&&typeof M.then=="function"&&M.then(L,J)}catch(te){J(te)}finally{N!==null&&U.types!==null&&(N.types=U.types),A.T=N}},gt.unstable_useCacheRefresh=function(){return A.H.useCacheRefresh()},gt.use=function(I){return A.H.use(I)},gt.useActionState=function(I,N,U){return A.H.useActionState(I,N,U)},gt.useCallback=function(I,N){return A.H.useCallback(I,N)},gt.useContext=function(I){return A.H.useContext(I)},gt.useDebugValue=function(){},gt.useDeferredValue=function(I,N){return A.H.useDeferredValue(I,N)},gt.useEffect=function(I,N){return A.H.useEffect(I,N)},gt.useEffectEvent=function(I){return A.H.useEffectEvent(I)},gt.useId=function(){return A.H.useId()},gt.useImperativeHandle=function(I,N,U){return A.H.useImperativeHandle(I,N,U)},gt.useInsertionEffect=function(I,N){return A.H.useInsertionEffect(I,N)},gt.useLayoutEffect=function(I,N){return A.H.useLayoutEffect(I,N)},gt.useMemo=function(I,N){return A.H.useMemo(I,N)},gt.useOptimistic=function(I,N){return A.H.useOptimistic(I,N)},gt.useReducer=function(I,N,U){return A.H.useReducer(I,N,U)},gt.useRef=function(I){return A.H.useRef(I)},gt.useState=function(I){return A.H.useState(I)},gt.useSyncExternalStore=function(I,N,U){return A.H.useSyncExternalStore(I,N,U)},gt.useTransition=function(){return A.H.useTransition()},gt.version="19.2.3",gt}var Ux;function om(){return Ux||(Ux=1,ud.exports=_S()),ud.exports}var Ie=om(),fd={exports:{}},lc={},hd={exports:{}},dd={};var Px;function wS(){return Px||(Px=1,(function(e){function t(V,ae){var xe=V.length;V.push(ae);e:for(;0<xe;){var J=xe-1>>>1,be=V[J];if(0<s(be,ae))V[J]=ae,V[xe]=be,xe=J;else break e}}function r(V){return V.length===0?null:V[0]}function a(V){if(V.length===0)return null;var ae=V[0],xe=V.pop();if(xe!==ae){V[0]=xe;e:for(var J=0,be=V.length,I=be>>>1;J<I;){var N=2*(J+1)-1,U=V[N],M=N+1,P=V[M];if(0>s(U,xe))M<be&&0>s(P,U)?(V[J]=P,V[M]=xe,J=M):(V[J]=U,V[N]=xe,J=N);else if(M<be&&0>s(P,xe))V[J]=P,V[M]=xe,J=M;else break e}}return ae}function s(V,ae){var xe=V.sortIndex-ae.sortIndex;return xe!==0?xe:V.id-ae.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var c=Date,u=c.now();e.unstable_now=function(){return c.now()-u}}var h=[],d=[],g=1,x=null,v=3,_=!1,b=!1,y=!1,S=!1,k=typeof setTimeout=="function"?setTimeout:null,R=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;function j(V){for(var ae=r(d);ae!==null;){if(ae.callback===null)a(d);else if(ae.startTime<=V)a(d),ae.sortIndex=ae.expirationTime,t(h,ae);else break;ae=r(d)}}function X(V){if(y=!1,j(V),!b)if(r(h)!==null)b=!0,L||(L=!0,Z());else{var ae=r(d);ae!==null&&Ae(X,ae.startTime-V)}}var L=!1,A=-1,K=5,q=-1;function ie(){return S?!0:!(e.unstable_now()-q<K)}function ne(){if(S=!1,L){var V=e.unstable_now();q=V;var ae=!0;try{e:{b=!1,y&&(y=!1,R(A),A=-1),_=!0;var xe=v;try{t:{for(j(V),x=r(h);x!==null&&!(x.expirationTime>V&&ie());){var J=x.callback;if(typeof J=="function"){x.callback=null,v=x.priorityLevel;var be=J(x.expirationTime<=V);if(V=e.unstable_now(),typeof be=="function"){x.callback=be,j(V),ae=!0;break t}x===r(h)&&a(h),j(V)}else a(h);x=r(h)}if(x!==null)ae=!0;else{var I=r(d);I!==null&&Ae(X,I.startTime-V),ae=!1}}break e}finally{x=null,v=xe,_=!1}ae=void 0}}finally{ae?Z():L=!1}}}var Z;if(typeof T=="function")Z=function(){T(ne)};else if(typeof MessageChannel<"u"){var me=new MessageChannel,Re=me.port2;me.port1.onmessage=ne,Z=function(){Re.postMessage(null)}}else Z=function(){k(ne,0)};function Ae(V,ae){A=k(function(){V(e.unstable_now())},ae)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(V){V.callback=null},e.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):K=0<V?Math.floor(1e3/V):5},e.unstable_getCurrentPriorityLevel=function(){return v},e.unstable_next=function(V){switch(v){case 1:case 2:case 3:var ae=3;break;default:ae=v}var xe=v;v=ae;try{return V()}finally{v=xe}},e.unstable_requestPaint=function(){S=!0},e.unstable_runWithPriority=function(V,ae){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var xe=v;v=V;try{return ae()}finally{v=xe}},e.unstable_scheduleCallback=function(V,ae,xe){var J=e.unstable_now();switch(typeof xe=="object"&&xe!==null?(xe=xe.delay,xe=typeof xe=="number"&&0<xe?J+xe:J):xe=J,V){case 1:var be=-1;break;case 2:be=250;break;case 5:be=1073741823;break;case 4:be=1e4;break;default:be=5e3}return be=xe+be,V={id:g++,callback:ae,priorityLevel:V,startTime:xe,expirationTime:be,sortIndex:-1},xe>J?(V.sortIndex=xe,t(d,V),r(h)===null&&V===r(d)&&(y?(R(A),A=-1):y=!0,Ae(X,xe-J))):(V.sortIndex=be,t(h,V),b||_||(b=!0,L||(L=!0,Z()))),V},e.unstable_shouldYield=ie,e.unstable_wrapCallback=function(V){var ae=v;return function(){var xe=v;v=ae;try{return V.apply(this,arguments)}finally{v=xe}}}})(dd)),dd}var zx;function bS(){return zx||(zx=1,hd.exports=wS()),hd.exports}var md={exports:{}},oa={};var Hx;function SS(){if(Hx)return oa;Hx=1;var e=om();function t(h){var d="https://react.dev/errors/"+h;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)d+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+h+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var a={d:{f:r,r:function(){throw Error(t(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},s=Symbol.for("react.portal");function l(h,d,g){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:x==null?null:""+x,children:h,containerInfo:d,implementation:g}}var c=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(h,d){if(h==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return oa.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,oa.createPortal=function(h,d){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(t(299));return l(h,d,null,g)},oa.flushSync=function(h){var d=c.T,g=a.p;try{if(c.T=null,a.p=2,h)return h()}finally{c.T=d,a.p=g,a.d.f()}},oa.preconnect=function(h,d){typeof h=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,a.d.C(h,d))},oa.prefetchDNS=function(h){typeof h=="string"&&a.d.D(h)},oa.preinit=function(h,d){if(typeof h=="string"&&d&&typeof d.as=="string"){var g=d.as,x=u(g,d.crossOrigin),v=typeof d.integrity=="string"?d.integrity:void 0,_=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;g==="style"?a.d.S(h,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:x,integrity:v,fetchPriority:_}):g==="script"&&a.d.X(h,{crossOrigin:x,integrity:v,fetchPriority:_,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},oa.preinitModule=function(h,d){if(typeof h=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var g=u(d.as,d.crossOrigin);a.d.M(h,{crossOrigin:g,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&a.d.M(h)},oa.preload=function(h,d){if(typeof h=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var g=d.as,x=u(g,d.crossOrigin);a.d.L(h,g,{crossOrigin:x,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},oa.preloadModule=function(h,d){if(typeof h=="string")if(d){var g=u(d.as,d.crossOrigin);a.d.m(h,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:g,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else a.d.m(h)},oa.requestFormReset=function(h){a.d.r(h)},oa.unstable_batchedUpdates=function(h,d){return h(d)},oa.useFormState=function(h,d,g){return c.H.useFormState(h,d,g)},oa.useFormStatus=function(){return c.H.useHostTransitionStatus()},oa.version="19.2.3",oa}var $x;function ES(){if($x)return md.exports;$x=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),md.exports=SS(),md.exports}var Vx;function TS(){if(Vx)return lc;Vx=1;var e=bS(),t=om(),r=ES();function a(n){var i="https://react.dev/errors/"+n;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)i+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+n+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function l(n){var i=n,o=n;if(n.alternate)for(;i.return;)i=i.return;else{n=i;do i=n,(i.flags&4098)!==0&&(o=i.return),n=i.return;while(n)}return i.tag===3?o:null}function c(n){if(n.tag===13){var i=n.memoizedState;if(i===null&&(n=n.alternate,n!==null&&(i=n.memoizedState)),i!==null)return i.dehydrated}return null}function u(n){if(n.tag===31){var i=n.memoizedState;if(i===null&&(n=n.alternate,n!==null&&(i=n.memoizedState)),i!==null)return i.dehydrated}return null}function h(n){if(l(n)!==n)throw Error(a(188))}function d(n){var i=n.alternate;if(!i){if(i=l(n),i===null)throw Error(a(188));return i!==n?null:n}for(var o=n,f=i;;){var m=o.return;if(m===null)break;var p=m.alternate;if(p===null){if(f=m.return,f!==null){o=f;continue}break}if(m.child===p.child){for(p=m.child;p;){if(p===o)return h(m),n;if(p===f)return h(m),i;p=p.sibling}throw Error(a(188))}if(o.return!==f.return)o=m,f=p;else{for(var E=!1,O=m.child;O;){if(O===o){E=!0,o=m,f=p;break}if(O===f){E=!0,f=m,o=p;break}O=O.sibling}if(!E){for(O=p.child;O;){if(O===o){E=!0,o=p,f=m;break}if(O===f){E=!0,f=p,o=m;break}O=O.sibling}if(!E)throw Error(a(189))}}if(o.alternate!==f)throw Error(a(190))}if(o.tag!==3)throw Error(a(188));return o.stateNode.current===o?n:i}function g(n){var i=n.tag;if(i===5||i===26||i===27||i===6)return n;for(n=n.child;n!==null;){if(i=g(n),i!==null)return i;n=n.sibling}return null}var x=Object.assign,v=Symbol.for("react.element"),_=Symbol.for("react.transitional.element"),b=Symbol.for("react.portal"),y=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),k=Symbol.for("react.profiler"),R=Symbol.for("react.consumer"),T=Symbol.for("react.context"),j=Symbol.for("react.forward_ref"),X=Symbol.for("react.suspense"),L=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),K=Symbol.for("react.lazy"),q=Symbol.for("react.activity"),ie=Symbol.for("react.memo_cache_sentinel"),ne=Symbol.iterator;function Z(n){return n===null||typeof n!="object"?null:(n=ne&&n[ne]||n["@@iterator"],typeof n=="function"?n:null)}var me=Symbol.for("react.client.reference");function Re(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===me?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case y:return"Fragment";case k:return"Profiler";case S:return"StrictMode";case X:return"Suspense";case L:return"SuspenseList";case q:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case b:return"Portal";case T:return n.displayName||"Context";case R:return(n._context.displayName||"Context")+".Consumer";case j:var i=n.render;return n=n.displayName,n||(n=i.displayName||i.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case A:return i=n.displayName||null,i!==null?i:Re(n.type)||"Memo";case K:i=n._payload,n=n._init;try{return Re(n(i))}catch{}}return null}var Ae=Array.isArray,V=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ae=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,xe={pending:!1,data:null,method:null,action:null},J=[],be=-1;function I(n){return{current:n}}function N(n){0>be||(n.current=J[be],J[be]=null,be--)}function U(n,i){be++,J[be]=n.current,n.current=i}var M=I(null),P=I(null),te=I(null),pe=I(null);function Ee(n,i){switch(U(te,i),U(P,n),U(M,null),i.nodeType){case 9:case 11:n=(n=i.documentElement)&&(n=n.namespaceURI)?sx(n):0;break;default:if(n=i.tagName,i=i.namespaceURI)i=sx(i),n=ix(i,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}N(M),U(M,n)}function ve(){N(M),N(P),N(te)}function Te(n){n.memoizedState!==null&&U(pe,n);var i=M.current,o=ix(i,n.type);i!==o&&(U(P,n),U(M,o))}function tt(n){P.current===n&&(N(M),N(P)),pe.current===n&&(N(pe),rc._currentValue=xe)}var G,Rt;function We(n){if(G===void 0)try{throw Error()}catch(o){var i=o.stack.trim().match(/\n( *(at )?)/);G=i&&i[1]||"",Rt=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+G+n+Rt}var bt=!1;function lt(n,i){if(!n||bt)return"";bt=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var f={DetermineComponentFrameRoot:function(){try{if(i){var ke=function(){throw Error()};if(Object.defineProperty(ke.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ke,[])}catch(ge){var de=ge}Reflect.construct(n,[],ke)}else{try{ke.call()}catch(ge){de=ge}n.call(ke.prototype)}}else{try{throw Error()}catch(ge){de=ge}(ke=n())&&typeof ke.catch=="function"&&ke.catch(function(){})}}catch(ge){if(ge&&de&&typeof ge.stack=="string")return[ge.stack,de.stack]}return[null,null]}};f.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(f.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(f.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var p=f.DetermineComponentFrameRoot(),E=p[0],O=p[1];if(E&&O){var W=E.split(`
`),ue=O.split(`
`);for(m=f=0;f<W.length&&!W[f].includes("DetermineComponentFrameRoot");)f++;for(;m<ue.length&&!ue[m].includes("DetermineComponentFrameRoot");)m++;if(f===W.length||m===ue.length)for(f=W.length-1,m=ue.length-1;1<=f&&0<=m&&W[f]!==ue[m];)m--;for(;1<=f&&0<=m;f--,m--)if(W[f]!==ue[m]){if(f!==1||m!==1)do if(f--,m--,0>m||W[f]!==ue[m]){var we=`
`+W[f].replace(" at new "," at ");return n.displayName&&we.includes("<anonymous>")&&(we=we.replace("<anonymous>",n.displayName)),we}while(1<=f&&0<=m);break}}}finally{bt=!1,Error.prepareStackTrace=o}return(o=n?n.displayName||n.name:"")?We(o):""}function Pe(n,i){switch(n.tag){case 26:case 27:case 5:return We(n.type);case 16:return We("Lazy");case 13:return n.child!==i&&i!==null?We("Suspense Fallback"):We("Suspense");case 19:return We("SuspenseList");case 0:case 15:return lt(n.type,!1);case 11:return lt(n.type.render,!1);case 1:return lt(n.type,!0);case 31:return We("Activity");default:return""}}function Zt(n){try{var i="",o=null;do i+=Pe(n,o),o=n,n=n.return;while(n);return i}catch(f){return`
Error generating stack: `+f.message+`
`+f.stack}}var Ar=Object.prototype.hasOwnProperty,Hr=e.unstable_scheduleCallback,$r=e.unstable_cancelCallback,zn=e.unstable_shouldYield,Ja=e.unstable_requestPaint,Et=e.unstable_now,xa=e.unstable_getCurrentPriorityLevel,sa=e.unstable_ImmediatePriority,Ma=e.unstable_UserBlockingPriority,Jt=e.unstable_NormalPriority,ia=e.unstable_LowPriority,mt=e.unstable_IdlePriority,Dt=e.log,Ir=e.unstable_setDisableYieldValue,Vt=null,er=null;function La(n){if(typeof Dt=="function"&&Ir(n),er&&typeof er.setStrictMode=="function")try{er.setStrictMode(Vt,n)}catch{}}var cr=Math.clz32?Math.clz32:rl,ui=Math.log,tl=Math.LN2;function rl(n){return n>>>=0,n===0?32:31-(ui(n)/tl|0)|0}var Hn=256,_s=262144,ws=4194304;function ba(n){var i=n&42;if(i!==0)return i;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return n&261888;case 262144:case 524288:case 1048576:case 2097152:return n&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function bs(n,i,o){var f=n.pendingLanes;if(f===0)return 0;var m=0,p=n.suspendedLanes,E=n.pingedLanes;n=n.warmLanes;var O=f&134217727;return O!==0?(f=O&~p,f!==0?m=ba(f):(E&=O,E!==0?m=ba(E):o||(o=O&~n,o!==0&&(m=ba(o))))):(O=f&~p,O!==0?m=ba(O):E!==0?m=ba(E):o||(o=f&~n,o!==0&&(m=ba(o)))),m===0?0:i!==0&&i!==m&&(i&p)===0&&(p=m&-m,o=i&-i,p>=o||p===32&&(o&4194048)!==0)?i:m}function $n(n,i){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&i)===0}function xo(n,i){switch(n){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function al(){var n=ws;return ws<<=1,(ws&62914560)===0&&(ws=4194304),n}function fi(n){for(var i=[],o=0;31>o;o++)i.push(n);return i}function Vn(n,i){n.pendingLanes|=i,i!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function vo(n,i,o,f,m,p){var E=n.pendingLanes;n.pendingLanes=o,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=o,n.entangledLanes&=o,n.errorRecoveryDisabledLanes&=o,n.shellSuspendCounter=0;var O=n.entanglements,W=n.expirationTimes,ue=n.hiddenUpdates;for(o=E&~o;0<o;){var we=31-cr(o),ke=1<<we;O[we]=0,W[we]=-1;var de=ue[we];if(de!==null)for(ue[we]=null,we=0;we<de.length;we++){var ge=de[we];ge!==null&&(ge.lane&=-536870913)}o&=~ke}f!==0&&nl(n,f,0),p!==0&&m===0&&n.tag!==0&&(n.suspendedLanes|=p&~(E&~i))}function nl(n,i,o){n.pendingLanes|=i,n.suspendedLanes&=~i;var f=31-cr(i);n.entangledLanes|=i,n.entanglements[f]=n.entanglements[f]|1073741824|o&261930}function Ss(n,i){var o=n.entangledLanes|=i;for(n=n.entanglements;o;){var f=31-cr(o),m=1<<f;m&i|n[f]&i&&(n[f]|=i),o&=~m}}function sl(n,i){var o=i&-i;return o=(o&42)!==0?1:xn(o),(o&(n.suspendedLanes|i))!==0?0:o}function xn(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function hi(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function C(){var n=ae.p;return n!==0?n:(n=window.event,n===void 0?32:Nx(n.type))}function z(n,i){var o=ae.p;try{return ae.p=n,i()}finally{ae.p=o}}var D=Math.random().toString(36).slice(2),F="__reactFiber$"+D,B="__reactProps$"+D,H="__reactContainer$"+D,fe="__reactEvents$"+D,_e="__reactListeners$"+D,oe="__reactHandles$"+D,le="__reactResources$"+D,he="__reactMarker$"+D;function Ne(n){delete n[F],delete n[B],delete n[fe],delete n[_e],delete n[oe]}function Le(n){var i=n[F];if(i)return i;for(var o=n.parentNode;o;){if(i=o[H]||o[F]){if(o=i.alternate,i.child!==null||o!==null&&o.child!==null)for(n=dx(n);n!==null;){if(o=n[F])return o;n=dx(n)}return i}n=o,o=n.parentNode}return null}function He(n){if(n=n[F]||n[H]){var i=n.tag;if(i===5||i===6||i===13||i===31||i===26||i===27||i===3)return n}return null}function De(n){var i=n.tag;if(i===5||i===26||i===27||i===6)return n.stateNode;throw Error(a(33))}function ze(n){var i=n[le];return i||(i=n[le]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function Qe(n){n[he]=!0}var Gt=new Set,qt={};function tr(n,i){Sa(n,i),Sa(n+"Capture",i)}function Sa(n,i){for(qt[n]=i,n=0;n<i.length;n++)Gt.add(i[n])}var Gn=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Nn={},Qa={};function qn(n){return Ar.call(Qa,n)?!0:Ar.call(Nn,n)?!1:Gn.test(n)?Qa[n]=!0:(Nn[n]=!0,!1)}function Kr(n,i,o){if(qn(i))if(o===null)n.removeAttribute(i);else{switch(typeof o){case"undefined":case"function":case"symbol":n.removeAttribute(i);return;case"boolean":var f=i.toLowerCase().slice(0,5);if(f!=="data-"&&f!=="aria-"){n.removeAttribute(i);return}}n.setAttribute(i,""+o)}}function Y(n,i,o){if(o===null)n.removeAttribute(i);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(i);return}n.setAttribute(i,""+o)}}function ee(n,i,o,f){if(f===null)n.removeAttribute(o);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(o);return}n.setAttributeNS(i,o,""+f)}}function se(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Oe(n){var i=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function Ue(n,i,o){var f=Object.getOwnPropertyDescriptor(n.constructor.prototype,i);if(!n.hasOwnProperty(i)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var m=f.get,p=f.set;return Object.defineProperty(n,i,{configurable:!0,get:function(){return m.call(this)},set:function(E){o=""+E,p.call(this,E)}}),Object.defineProperty(n,i,{enumerable:f.enumerable}),{getValue:function(){return o},setValue:function(E){o=""+E},stopTracking:function(){n._valueTracker=null,delete n[i]}}}}function Fe(n){if(!n._valueTracker){var i=Oe(n)?"checked":"value";n._valueTracker=Ue(n,i,""+n[i])}}function Me(n){if(!n)return!1;var i=n._valueTracker;if(!i)return!0;var o=i.getValue(),f="";return n&&(f=Oe(n)?n.checked?"true":"false":n.value),n=f,n!==o?(i.setValue(n),!0):!1}function $e(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var Ye=/[\n"\\]/g;function Ve(n){return n.replace(Ye,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function Ke(n,i,o,f,m,p,E,O){n.name="",E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"?n.type=E:n.removeAttribute("type"),i!=null?E==="number"?(i===0&&n.value===""||n.value!=i)&&(n.value=""+se(i)):n.value!==""+se(i)&&(n.value=""+se(i)):E!=="submit"&&E!=="reset"||n.removeAttribute("value"),i!=null?qe(n,E,se(i)):o!=null?qe(n,E,se(o)):f!=null&&n.removeAttribute("value"),m==null&&p!=null&&(n.defaultChecked=!!p),m!=null&&(n.checked=m&&typeof m!="function"&&typeof m!="symbol"),O!=null&&typeof O!="function"&&typeof O!="symbol"&&typeof O!="boolean"?n.name=""+se(O):n.removeAttribute("name")}function nt(n,i,o,f,m,p,E,O){if(p!=null&&typeof p!="function"&&typeof p!="symbol"&&typeof p!="boolean"&&(n.type=p),i!=null||o!=null){if(!(p!=="submit"&&p!=="reset"||i!=null)){Fe(n);return}o=o!=null?""+se(o):"",i=i!=null?""+se(i):o,O||i===n.value||(n.value=i),n.defaultValue=i}f=f??m,f=typeof f!="function"&&typeof f!="symbol"&&!!f,n.checked=O?n.checked:!!f,n.defaultChecked=!!f,E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"&&(n.name=E),Fe(n)}function qe(n,i,o){i==="number"&&$e(n.ownerDocument)===n||n.defaultValue===""+o||(n.defaultValue=""+o)}function Ge(n,i,o,f){if(n=n.options,i){i={};for(var m=0;m<o.length;m++)i["$"+o[m]]=!0;for(o=0;o<n.length;o++)m=i.hasOwnProperty("$"+n[o].value),n[o].selected!==m&&(n[o].selected=m),m&&f&&(n[o].defaultSelected=!0)}else{for(o=""+se(o),i=null,m=0;m<n.length;m++){if(n[m].value===o){n[m].selected=!0,f&&(n[m].defaultSelected=!0);return}i!==null||n[m].disabled||(i=n[m])}i!==null&&(i.selected=!0)}}function Xe(n,i,o){if(i!=null&&(i=""+se(i),i!==n.value&&(n.value=i),o==null)){n.defaultValue!==i&&(n.defaultValue=i);return}n.defaultValue=o!=null?""+se(o):""}function Ze(n,i,o,f){if(i==null){if(f!=null){if(o!=null)throw Error(a(92));if(Ae(f)){if(1<f.length)throw Error(a(93));f=f[0]}o=f}o==null&&(o=""),i=o}o=se(i),n.defaultValue=o,f=n.textContent,f===o&&f!==""&&f!==null&&(n.value=f),Fe(n)}function pt(n,i){if(i){var o=n.firstChild;if(o&&o===n.lastChild&&o.nodeType===3){o.nodeValue=i;return}}n.textContent=i}var rt=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function gr(n,i,o){var f=i.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?f?n.setProperty(i,""):i==="float"?n.cssFloat="":n[i]="":f?n.setProperty(i,o):typeof o!="number"||o===0||rt.has(i)?i==="float"?n.cssFloat=o:n[i]=(""+o).trim():n[i]=o+"px"}function fr(n,i,o){if(i!=null&&typeof i!="object")throw Error(a(62));if(n=n.style,o!=null){for(var f in o)!o.hasOwnProperty(f)||i!=null&&i.hasOwnProperty(f)||(f.indexOf("--")===0?n.setProperty(f,""):f==="float"?n.cssFloat="":n[f]="");for(var m in i)f=i[m],i.hasOwnProperty(m)&&o[m]!==f&&gr(n,m,f)}else for(var p in i)i.hasOwnProperty(p)&&gr(n,p,i[p])}function la(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var di=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),nf=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function il(n){return nf.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}function Xn(){}var sf=null;function lf(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var ll=null,ol=null;function n1(n){var i=He(n);if(i&&(n=i.stateNode)){var o=n[B]||null;e:switch(n=i.stateNode,i.type){case"input":if(Ke(n,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),i=o.name,o.type==="radio"&&i!=null){for(o=n;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+Ve(""+i)+'"][type="radio"]'),i=0;i<o.length;i++){var f=o[i];if(f!==n&&f.form===n.form){var m=f[B]||null;if(!m)throw Error(a(90));Ke(f,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(i=0;i<o.length;i++)f=o[i],f.form===n.form&&Me(f)}break e;case"textarea":Xe(n,o.value,o.defaultValue);break e;case"select":i=o.value,i!=null&&Ge(n,!!o.multiple,i,!1)}}}var of=!1;function s1(n,i,o){if(of)return n(i,o);of=!0;try{var f=n(i);return f}finally{if(of=!1,(ll!==null||ol!==null)&&(z0(),ll&&(i=ll,n=ol,ol=ll=null,n1(i),n)))for(i=0;i<n.length;i++)n1(n[i])}}function yo(n,i){var o=n.stateNode;if(o===null)return null;var f=o[B]||null;if(f===null)return null;o=f[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(n=n.type,f=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!f;break e;default:n=!1}if(n)return null;if(o&&typeof o!="function")throw Error(a(231,i,typeof o));return o}var Wn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),cf=!1;if(Wn)try{var _o={};Object.defineProperty(_o,"passive",{get:function(){cf=!0}}),window.addEventListener("test",_o,_o),window.removeEventListener("test",_o,_o)}catch{cf=!1}var Es=null,uf=null,t0=null;function i1(){if(t0)return t0;var n,i=uf,o=i.length,f,m="value"in Es?Es.value:Es.textContent,p=m.length;for(n=0;n<o&&i[n]===m[n];n++);var E=o-n;for(f=1;f<=E&&i[o-f]===m[p-f];f++);return t0=m.slice(n,1<f?1-f:void 0)}function r0(n){var i=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&i===13&&(n=13)):n=i,n===10&&(n=13),32<=n||n===13?n:0}function a0(){return!0}function l1(){return!1}function Ea(n){function i(o,f,m,p,E){this._reactName=o,this._targetInst=m,this.type=f,this.nativeEvent=p,this.target=E,this.currentTarget=null;for(var O in n)n.hasOwnProperty(O)&&(o=n[O],this[O]=o?o(p):p[O]);return this.isDefaultPrevented=(p.defaultPrevented!=null?p.defaultPrevented:p.returnValue===!1)?a0:l1,this.isPropagationStopped=l1,this}return x(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=a0)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=a0)},persist:function(){},isPersistent:a0}),i}var mi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},n0=Ea(mi),wo=x({},mi,{view:0,detail:0}),pw=Ea(wo),ff,hf,bo,s0=x({},wo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:mf,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==bo&&(bo&&n.type==="mousemove"?(ff=n.screenX-bo.screenX,hf=n.screenY-bo.screenY):hf=ff=0,bo=n),ff)},movementY:function(n){return"movementY"in n?n.movementY:hf}}),o1=Ea(s0),xw=x({},s0,{dataTransfer:0}),vw=Ea(xw),yw=x({},wo,{relatedTarget:0}),df=Ea(yw),_w=x({},mi,{animationName:0,elapsedTime:0,pseudoElement:0}),ww=Ea(_w),bw=x({},mi,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),Sw=Ea(bw),Ew=x({},mi,{data:0}),c1=Ea(Ew),Tw={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},kw={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Aw={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Cw(n){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(n):(n=Aw[n])?!!i[n]:!1}function mf(){return Cw}var Nw=x({},wo,{key:function(n){if(n.key){var i=Tw[n.key]||n.key;if(i!=="Unidentified")return i}return n.type==="keypress"?(n=r0(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?kw[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:mf,charCode:function(n){return n.type==="keypress"?r0(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?r0(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),Ow=Ea(Nw),Rw=x({},s0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),u1=Ea(Rw),Dw=x({},wo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:mf}),Fw=Ea(Dw),Mw=x({},mi,{propertyName:0,elapsedTime:0,pseudoElement:0}),Lw=Ea(Mw),Bw=x({},s0,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),Iw=Ea(Bw),jw=x({},mi,{newState:0,oldState:0}),Uw=Ea(jw),Pw=[9,13,27,32],gf=Wn&&"CompositionEvent"in window,So=null;Wn&&"documentMode"in document&&(So=document.documentMode);var zw=Wn&&"TextEvent"in window&&!So,f1=Wn&&(!gf||So&&8<So&&11>=So),h1=" ",d1=!1;function m1(n,i){switch(n){case"keyup":return Pw.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function g1(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var cl=!1;function Hw(n,i){switch(n){case"compositionend":return g1(i);case"keypress":return i.which!==32?null:(d1=!0,h1);case"textInput":return n=i.data,n===h1&&d1?null:n;default:return null}}function $w(n,i){if(cl)return n==="compositionend"||!gf&&m1(n,i)?(n=i1(),t0=uf=Es=null,cl=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return f1&&i.locale!=="ko"?null:i.data;default:return null}}var Vw={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function p1(n){var i=n&&n.nodeName&&n.nodeName.toLowerCase();return i==="input"?!!Vw[n.type]:i==="textarea"}function x1(n,i,o,f){ll?ol?ol.push(f):ol=[f]:ll=f,i=W0(i,"onChange"),0<i.length&&(o=new n0("onChange","change",null,o,f),n.push({event:o,listeners:i}))}var Eo=null,To=null;function Gw(n){Zp(n,0)}function i0(n){var i=De(n);if(Me(i))return n}function v1(n,i){if(n==="change")return i}var y1=!1;if(Wn){var pf;if(Wn){var xf="oninput"in document;if(!xf){var _1=document.createElement("div");_1.setAttribute("oninput","return;"),xf=typeof _1.oninput=="function"}pf=xf}else pf=!1;y1=pf&&(!document.documentMode||9<document.documentMode)}function w1(){Eo&&(Eo.detachEvent("onpropertychange",b1),To=Eo=null)}function b1(n){if(n.propertyName==="value"&&i0(To)){var i=[];x1(i,To,n,lf(n)),s1(Gw,i)}}function qw(n,i,o){n==="focusin"?(w1(),Eo=i,To=o,Eo.attachEvent("onpropertychange",b1)):n==="focusout"&&w1()}function Xw(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return i0(To)}function Ww(n,i){if(n==="click")return i0(i)}function Kw(n,i){if(n==="input"||n==="change")return i0(i)}function Yw(n,i){return n===i&&(n!==0||1/n===1/i)||n!==n&&i!==i}var Ba=typeof Object.is=="function"?Object.is:Yw;function ko(n,i){if(Ba(n,i))return!0;if(typeof n!="object"||n===null||typeof i!="object"||i===null)return!1;var o=Object.keys(n),f=Object.keys(i);if(o.length!==f.length)return!1;for(f=0;f<o.length;f++){var m=o[f];if(!Ar.call(i,m)||!Ba(n[m],i[m]))return!1}return!0}function S1(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function E1(n,i){var o=S1(n);n=0;for(var f;o;){if(o.nodeType===3){if(f=n+o.textContent.length,n<=i&&f>=i)return{node:o,offset:i-n};n=f}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=S1(o)}}function T1(n,i){return n&&i?n===i?!0:n&&n.nodeType===3?!1:i&&i.nodeType===3?T1(n,i.parentNode):"contains"in n?n.contains(i):n.compareDocumentPosition?!!(n.compareDocumentPosition(i)&16):!1:!1}function k1(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var i=$e(n.document);i instanceof n.HTMLIFrameElement;){try{var o=typeof i.contentWindow.location.href=="string"}catch{o=!1}if(o)n=i.contentWindow;else break;i=$e(n.document)}return i}function vf(n){var i=n&&n.nodeName&&n.nodeName.toLowerCase();return i&&(i==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||i==="textarea"||n.contentEditable==="true")}var Jw=Wn&&"documentMode"in document&&11>=document.documentMode,ul=null,yf=null,Ao=null,_f=!1;function A1(n,i,o){var f=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;_f||ul==null||ul!==$e(f)||(f=ul,"selectionStart"in f&&vf(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),Ao&&ko(Ao,f)||(Ao=f,f=W0(yf,"onSelect"),0<f.length&&(i=new n0("onSelect","select",null,i,o),n.push({event:i,listeners:f}),i.target=ul)))}function gi(n,i){var o={};return o[n.toLowerCase()]=i.toLowerCase(),o["Webkit"+n]="webkit"+i,o["Moz"+n]="moz"+i,o}var fl={animationend:gi("Animation","AnimationEnd"),animationiteration:gi("Animation","AnimationIteration"),animationstart:gi("Animation","AnimationStart"),transitionrun:gi("Transition","TransitionRun"),transitionstart:gi("Transition","TransitionStart"),transitioncancel:gi("Transition","TransitionCancel"),transitionend:gi("Transition","TransitionEnd")},wf={},C1={};Wn&&(C1=document.createElement("div").style,"AnimationEvent"in window||(delete fl.animationend.animation,delete fl.animationiteration.animation,delete fl.animationstart.animation),"TransitionEvent"in window||delete fl.transitionend.transition);function pi(n){if(wf[n])return wf[n];if(!fl[n])return n;var i=fl[n],o;for(o in i)if(i.hasOwnProperty(o)&&o in C1)return wf[n]=i[o];return n}var N1=pi("animationend"),O1=pi("animationiteration"),R1=pi("animationstart"),Qw=pi("transitionrun"),Zw=pi("transitionstart"),eb=pi("transitioncancel"),D1=pi("transitionend"),F1=new Map,bf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");bf.push("scrollEnd");function vn(n,i){F1.set(n,i),tr(i,[n])}var l0=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)},Za=[],hl=0,Sf=0;function o0(){for(var n=hl,i=Sf=hl=0;i<n;){var o=Za[i];Za[i++]=null;var f=Za[i];Za[i++]=null;var m=Za[i];Za[i++]=null;var p=Za[i];if(Za[i++]=null,f!==null&&m!==null){var E=f.pending;E===null?m.next=m:(m.next=E.next,E.next=m),f.pending=m}p!==0&&M1(o,m,p)}}function c0(n,i,o,f){Za[hl++]=n,Za[hl++]=i,Za[hl++]=o,Za[hl++]=f,Sf|=f,n.lanes|=f,n=n.alternate,n!==null&&(n.lanes|=f)}function Ef(n,i,o,f){return c0(n,i,o,f),u0(n)}function xi(n,i){return c0(n,null,null,i),u0(n)}function M1(n,i,o){n.lanes|=o;var f=n.alternate;f!==null&&(f.lanes|=o);for(var m=!1,p=n.return;p!==null;)p.childLanes|=o,f=p.alternate,f!==null&&(f.childLanes|=o),p.tag===22&&(n=p.stateNode,n===null||n._visibility&1||(m=!0)),n=p,p=p.return;return n.tag===3?(p=n.stateNode,m&&i!==null&&(m=31-cr(o),n=p.hiddenUpdates,f=n[m],f===null?n[m]=[i]:f.push(i),i.lane=o|536870912),p):null}function u0(n){if(50<Ko)throw Ko=0,Fh=null,Error(a(185));for(var i=n.return;i!==null;)n=i,i=n.return;return n.tag===3?n.stateNode:null}var dl={};function tb(n,i,o,f){this.tag=n,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ia(n,i,o,f){return new tb(n,i,o,f)}function Tf(n){return n=n.prototype,!(!n||!n.isReactComponent)}function Kn(n,i){var o=n.alternate;return o===null?(o=Ia(n.tag,i,n.key,n.mode),o.elementType=n.elementType,o.type=n.type,o.stateNode=n.stateNode,o.alternate=n,n.alternate=o):(o.pendingProps=i,o.type=n.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=n.flags&65011712,o.childLanes=n.childLanes,o.lanes=n.lanes,o.child=n.child,o.memoizedProps=n.memoizedProps,o.memoizedState=n.memoizedState,o.updateQueue=n.updateQueue,i=n.dependencies,o.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},o.sibling=n.sibling,o.index=n.index,o.ref=n.ref,o.refCleanup=n.refCleanup,o}function L1(n,i){n.flags&=65011714;var o=n.alternate;return o===null?(n.childLanes=0,n.lanes=i,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=o.childLanes,n.lanes=o.lanes,n.child=o.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=o.memoizedProps,n.memoizedState=o.memoizedState,n.updateQueue=o.updateQueue,n.type=o.type,i=o.dependencies,n.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),n}function f0(n,i,o,f,m,p){var E=0;if(f=n,typeof n=="function")Tf(n)&&(E=1);else if(typeof n=="string")E=iS(n,o,M.current)?26:n==="html"||n==="head"||n==="body"?27:5;else e:switch(n){case q:return n=Ia(31,o,i,m),n.elementType=q,n.lanes=p,n;case y:return vi(o.children,m,p,i);case S:E=8,m|=24;break;case k:return n=Ia(12,o,i,m|2),n.elementType=k,n.lanes=p,n;case X:return n=Ia(13,o,i,m),n.elementType=X,n.lanes=p,n;case L:return n=Ia(19,o,i,m),n.elementType=L,n.lanes=p,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case T:E=10;break e;case R:E=9;break e;case j:E=11;break e;case A:E=14;break e;case K:E=16,f=null;break e}E=29,o=Error(a(130,n===null?"null":typeof n,"")),f=null}return i=Ia(E,o,i,m),i.elementType=n,i.type=f,i.lanes=p,i}function vi(n,i,o,f){return n=Ia(7,n,f,i),n.lanes=o,n}function kf(n,i,o){return n=Ia(6,n,null,i),n.lanes=o,n}function B1(n){var i=Ia(18,null,null,0);return i.stateNode=n,i}function Af(n,i,o){return i=Ia(4,n.children!==null?n.children:[],n.key,i),i.lanes=o,i.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},i}var I1=new WeakMap;function en(n,i){if(typeof n=="object"&&n!==null){var o=I1.get(n);return o!==void 0?o:(i={value:n,source:i,stack:Zt(i)},I1.set(n,i),i)}return{value:n,source:i,stack:Zt(i)}}var ml=[],gl=0,h0=null,Co=0,tn=[],rn=0,Ts=null,On=1,Rn="";function Yn(n,i){ml[gl++]=Co,ml[gl++]=h0,h0=n,Co=i}function j1(n,i,o){tn[rn++]=On,tn[rn++]=Rn,tn[rn++]=Ts,Ts=n;var f=On;n=Rn;var m=32-cr(f)-1;f&=~(1<<m),o+=1;var p=32-cr(i)+m;if(30<p){var E=m-m%5;p=(f&(1<<E)-1).toString(32),f>>=E,m-=E,On=1<<32-cr(i)+m|o<<m|f,Rn=p+n}else On=1<<p|o<<m|f,Rn=n}function Cf(n){n.return!==null&&(Yn(n,1),j1(n,1,0))}function Nf(n){for(;n===h0;)h0=ml[--gl],ml[gl]=null,Co=ml[--gl],ml[gl]=null;for(;n===Ts;)Ts=tn[--rn],tn[rn]=null,Rn=tn[--rn],tn[rn]=null,On=tn[--rn],tn[rn]=null}function U1(n,i){tn[rn++]=On,tn[rn++]=Rn,tn[rn++]=Ts,On=i.id,Rn=i.overflow,Ts=n}var Yr=null,ar=null,Ot=!1,ks=null,an=!1,Of=Error(a(519));function As(n){var i=Error(a(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw No(en(i,n)),Of}function P1(n){var i=n.stateNode,o=n.type,f=n.memoizedProps;switch(i[F]=n,i[B]=f,o){case"dialog":kt("cancel",i),kt("close",i);break;case"iframe":case"object":case"embed":kt("load",i);break;case"video":case"audio":for(o=0;o<Jo.length;o++)kt(Jo[o],i);break;case"source":kt("error",i);break;case"img":case"image":case"link":kt("error",i),kt("load",i);break;case"details":kt("toggle",i);break;case"input":kt("invalid",i),nt(i,f.value,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name,!0);break;case"select":kt("invalid",i);break;case"textarea":kt("invalid",i),Ze(i,f.value,f.defaultValue,f.children)}o=f.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||i.textContent===""+o||f.suppressHydrationWarning===!0||ax(i.textContent,o)?(f.popover!=null&&(kt("beforetoggle",i),kt("toggle",i)),f.onScroll!=null&&kt("scroll",i),f.onScrollEnd!=null&&kt("scrollend",i),f.onClick!=null&&(i.onclick=Xn),i=!0):i=!1,i||As(n,!0)}function z1(n){for(Yr=n.return;Yr;)switch(Yr.tag){case 5:case 31:case 13:an=!1;return;case 27:case 3:an=!0;return;default:Yr=Yr.return}}function pl(n){if(n!==Yr)return!1;if(!Ot)return z1(n),Ot=!0,!1;var i=n.tag,o;if((o=i!==3&&i!==27)&&((o=i===5)&&(o=n.type,o=!(o!=="form"&&o!=="button")||Wh(n.type,n.memoizedProps)),o=!o),o&&ar&&As(n),z1(n),i===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(a(317));ar=hx(n)}else if(i===31){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(a(317));ar=hx(n)}else i===27?(i=ar,zs(n.type)?(n=Zh,Zh=null,ar=n):ar=i):ar=Yr?sn(n.stateNode.nextSibling):null;return!0}function yi(){ar=Yr=null,Ot=!1}function Rf(){var n=ks;return n!==null&&(Ca===null?Ca=n:Ca.push.apply(Ca,n),ks=null),n}function No(n){ks===null?ks=[n]:ks.push(n)}var Df=I(null),_i=null,Jn=null;function Cs(n,i,o){U(Df,i._currentValue),i._currentValue=o}function Qn(n){n._currentValue=Df.current,N(Df)}function Ff(n,i,o){for(;n!==null;){var f=n.alternate;if((n.childLanes&i)!==i?(n.childLanes|=i,f!==null&&(f.childLanes|=i)):f!==null&&(f.childLanes&i)!==i&&(f.childLanes|=i),n===o)break;n=n.return}}function Mf(n,i,o,f){var m=n.child;for(m!==null&&(m.return=n);m!==null;){var p=m.dependencies;if(p!==null){var E=m.child;p=p.firstContext;e:for(;p!==null;){var O=p;p=m;for(var W=0;W<i.length;W++)if(O.context===i[W]){p.lanes|=o,O=p.alternate,O!==null&&(O.lanes|=o),Ff(p.return,o,n),f||(E=null);break e}p=O.next}}else if(m.tag===18){if(E=m.return,E===null)throw Error(a(341));E.lanes|=o,p=E.alternate,p!==null&&(p.lanes|=o),Ff(E,o,n),E=null}else E=m.child;if(E!==null)E.return=m;else for(E=m;E!==null;){if(E===n){E=null;break}if(m=E.sibling,m!==null){m.return=E.return,E=m;break}E=E.return}m=E}}function xl(n,i,o,f){n=null;for(var m=i,p=!1;m!==null;){if(!p){if((m.flags&524288)!==0)p=!0;else if((m.flags&262144)!==0)break}if(m.tag===10){var E=m.alternate;if(E===null)throw Error(a(387));if(E=E.memoizedProps,E!==null){var O=m.type;Ba(m.pendingProps.value,E.value)||(n!==null?n.push(O):n=[O])}}else if(m===pe.current){if(E=m.alternate,E===null)throw Error(a(387));E.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(n!==null?n.push(rc):n=[rc])}m=m.return}n!==null&&Mf(i,n,o,f),i.flags|=262144}function d0(n){for(n=n.firstContext;n!==null;){if(!Ba(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function wi(n){_i=n,Jn=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function Jr(n){return H1(_i,n)}function m0(n,i){return _i===null&&wi(n),H1(n,i)}function H1(n,i){var o=i._currentValue;if(i={context:i,memoizedValue:o,next:null},Jn===null){if(n===null)throw Error(a(308));Jn=i,n.dependencies={lanes:0,firstContext:i},n.flags|=524288}else Jn=Jn.next=i;return o}var rb=typeof AbortController<"u"?AbortController:function(){var n=[],i=this.signal={aborted:!1,addEventListener:function(o,f){n.push(f)}};this.abort=function(){i.aborted=!0,n.forEach(function(o){return o()})}},ab=e.unstable_scheduleCallback,nb=e.unstable_NormalPriority,Cr={$$typeof:T,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Lf(){return{controller:new rb,data:new Map,refCount:0}}function Oo(n){n.refCount--,n.refCount===0&&ab(nb,function(){n.controller.abort()})}var Ro=null,Bf=0,vl=0,yl=null;function sb(n,i){if(Ro===null){var o=Ro=[];Bf=0,vl=Uh(),yl={status:"pending",value:void 0,then:function(f){o.push(f)}}}return Bf++,i.then($1,$1),i}function $1(){if(--Bf===0&&Ro!==null){yl!==null&&(yl.status="fulfilled");var n=Ro;Ro=null,vl=0,yl=null;for(var i=0;i<n.length;i++)(0,n[i])()}}function ib(n,i){var o=[],f={status:"pending",value:null,reason:null,then:function(m){o.push(m)}};return n.then(function(){f.status="fulfilled",f.value=i;for(var m=0;m<o.length;m++)(0,o[m])(i)},function(m){for(f.status="rejected",f.reason=m,m=0;m<o.length;m++)(0,o[m])(void 0)}),f}var V1=V.S;V.S=function(n,i){Ap=Et(),typeof i=="object"&&i!==null&&typeof i.then=="function"&&sb(n,i),V1!==null&&V1(n,i)};var bi=I(null);function If(){var n=bi.current;return n!==null?n:Qt.pooledCache}function g0(n,i){i===null?U(bi,bi.current):U(bi,i.pool)}function G1(){var n=If();return n===null?null:{parent:Cr._currentValue,pool:n}}var _l=Error(a(460)),jf=Error(a(474)),p0=Error(a(542)),x0={then:function(){}};function q1(n){return n=n.status,n==="fulfilled"||n==="rejected"}function X1(n,i,o){switch(o=n[o],o===void 0?n.push(i):o!==i&&(i.then(Xn,Xn),i=o),i.status){case"fulfilled":return i.value;case"rejected":throw n=i.reason,K1(n),n;default:if(typeof i.status=="string")i.then(Xn,Xn);else{if(n=Qt,n!==null&&100<n.shellSuspendCounter)throw Error(a(482));n=i,n.status="pending",n.then(function(f){if(i.status==="pending"){var m=i;m.status="fulfilled",m.value=f}},function(f){if(i.status==="pending"){var m=i;m.status="rejected",m.reason=f}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw n=i.reason,K1(n),n}throw Ei=i,_l}}function Si(n){try{var i=n._init;return i(n._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(Ei=o,_l):o}}var Ei=null;function W1(){if(Ei===null)throw Error(a(459));var n=Ei;return Ei=null,n}function K1(n){if(n===_l||n===p0)throw Error(a(483))}var wl=null,Do=0;function v0(n){var i=Do;return Do+=1,wl===null&&(wl=[]),X1(wl,n,i)}function Fo(n,i){i=i.props.ref,n.ref=i!==void 0?i:null}function y0(n,i){throw i.$$typeof===v?Error(a(525)):(n=Object.prototype.toString.call(i),Error(a(31,n==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":n)))}function Y1(n){function i(re,Q){if(n){var ce=re.deletions;ce===null?(re.deletions=[Q],re.flags|=16):ce.push(Q)}}function o(re,Q){if(!n)return null;for(;Q!==null;)i(re,Q),Q=Q.sibling;return null}function f(re){for(var Q=new Map;re!==null;)re.key!==null?Q.set(re.key,re):Q.set(re.index,re),re=re.sibling;return Q}function m(re,Q){return re=Kn(re,Q),re.index=0,re.sibling=null,re}function p(re,Q,ce){return re.index=ce,n?(ce=re.alternate,ce!==null?(ce=ce.index,ce<Q?(re.flags|=67108866,Q):ce):(re.flags|=67108866,Q)):(re.flags|=1048576,Q)}function E(re){return n&&re.alternate===null&&(re.flags|=67108866),re}function O(re,Q,ce,Se){return Q===null||Q.tag!==6?(Q=kf(ce,re.mode,Se),Q.return=re,Q):(Q=m(Q,ce),Q.return=re,Q)}function W(re,Q,ce,Se){var st=ce.type;return st===y?we(re,Q,ce.props.children,Se,ce.key):Q!==null&&(Q.elementType===st||typeof st=="object"&&st!==null&&st.$$typeof===K&&Si(st)===Q.type)?(Q=m(Q,ce.props),Fo(Q,ce),Q.return=re,Q):(Q=f0(ce.type,ce.key,ce.props,null,re.mode,Se),Fo(Q,ce),Q.return=re,Q)}function ue(re,Q,ce,Se){return Q===null||Q.tag!==4||Q.stateNode.containerInfo!==ce.containerInfo||Q.stateNode.implementation!==ce.implementation?(Q=Af(ce,re.mode,Se),Q.return=re,Q):(Q=m(Q,ce.children||[]),Q.return=re,Q)}function we(re,Q,ce,Se,st){return Q===null||Q.tag!==7?(Q=vi(ce,re.mode,Se,st),Q.return=re,Q):(Q=m(Q,ce),Q.return=re,Q)}function ke(re,Q,ce){if(typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint")return Q=kf(""+Q,re.mode,ce),Q.return=re,Q;if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case _:return ce=f0(Q.type,Q.key,Q.props,null,re.mode,ce),Fo(ce,Q),ce.return=re,ce;case b:return Q=Af(Q,re.mode,ce),Q.return=re,Q;case K:return Q=Si(Q),ke(re,Q,ce)}if(Ae(Q)||Z(Q))return Q=vi(Q,re.mode,ce,null),Q.return=re,Q;if(typeof Q.then=="function")return ke(re,v0(Q),ce);if(Q.$$typeof===T)return ke(re,m0(re,Q),ce);y0(re,Q)}return null}function de(re,Q,ce,Se){var st=Q!==null?Q.key:null;if(typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint")return st!==null?null:O(re,Q,""+ce,Se);if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case _:return ce.key===st?W(re,Q,ce,Se):null;case b:return ce.key===st?ue(re,Q,ce,Se):null;case K:return ce=Si(ce),de(re,Q,ce,Se)}if(Ae(ce)||Z(ce))return st!==null?null:we(re,Q,ce,Se,null);if(typeof ce.then=="function")return de(re,Q,v0(ce),Se);if(ce.$$typeof===T)return de(re,Q,m0(re,ce),Se);y0(re,ce)}return null}function ge(re,Q,ce,Se,st){if(typeof Se=="string"&&Se!==""||typeof Se=="number"||typeof Se=="bigint")return re=re.get(ce)||null,O(Q,re,""+Se,st);if(typeof Se=="object"&&Se!==null){switch(Se.$$typeof){case _:return re=re.get(Se.key===null?ce:Se.key)||null,W(Q,re,Se,st);case b:return re=re.get(Se.key===null?ce:Se.key)||null,ue(Q,re,Se,st);case K:return Se=Si(Se),ge(re,Q,ce,Se,st)}if(Ae(Se)||Z(Se))return re=re.get(ce)||null,we(Q,re,Se,st,null);if(typeof Se.then=="function")return ge(re,Q,ce,v0(Se),st);if(Se.$$typeof===T)return ge(re,Q,ce,m0(Q,Se),st);y0(Q,Se)}return null}function Je(re,Q,ce,Se){for(var st=null,Lt=null,et=Q,yt=Q=0,Nt=null;et!==null&&yt<ce.length;yt++){et.index>yt?(Nt=et,et=null):Nt=et.sibling;var Bt=de(re,et,ce[yt],Se);if(Bt===null){et===null&&(et=Nt);break}n&&et&&Bt.alternate===null&&i(re,et),Q=p(Bt,Q,yt),Lt===null?st=Bt:Lt.sibling=Bt,Lt=Bt,et=Nt}if(yt===ce.length)return o(re,et),Ot&&Yn(re,yt),st;if(et===null){for(;yt<ce.length;yt++)et=ke(re,ce[yt],Se),et!==null&&(Q=p(et,Q,yt),Lt===null?st=et:Lt.sibling=et,Lt=et);return Ot&&Yn(re,yt),st}for(et=f(et);yt<ce.length;yt++)Nt=ge(et,re,yt,ce[yt],Se),Nt!==null&&(n&&Nt.alternate!==null&&et.delete(Nt.key===null?yt:Nt.key),Q=p(Nt,Q,yt),Lt===null?st=Nt:Lt.sibling=Nt,Lt=Nt);return n&&et.forEach(function(qs){return i(re,qs)}),Ot&&Yn(re,yt),st}function ot(re,Q,ce,Se){if(ce==null)throw Error(a(151));for(var st=null,Lt=null,et=Q,yt=Q=0,Nt=null,Bt=ce.next();et!==null&&!Bt.done;yt++,Bt=ce.next()){et.index>yt?(Nt=et,et=null):Nt=et.sibling;var qs=de(re,et,Bt.value,Se);if(qs===null){et===null&&(et=Nt);break}n&&et&&qs.alternate===null&&i(re,et),Q=p(qs,Q,yt),Lt===null?st=qs:Lt.sibling=qs,Lt=qs,et=Nt}if(Bt.done)return o(re,et),Ot&&Yn(re,yt),st;if(et===null){for(;!Bt.done;yt++,Bt=ce.next())Bt=ke(re,Bt.value,Se),Bt!==null&&(Q=p(Bt,Q,yt),Lt===null?st=Bt:Lt.sibling=Bt,Lt=Bt);return Ot&&Yn(re,yt),st}for(et=f(et);!Bt.done;yt++,Bt=ce.next())Bt=ge(et,re,yt,Bt.value,Se),Bt!==null&&(n&&Bt.alternate!==null&&et.delete(Bt.key===null?yt:Bt.key),Q=p(Bt,Q,yt),Lt===null?st=Bt:Lt.sibling=Bt,Lt=Bt);return n&&et.forEach(function(xS){return i(re,xS)}),Ot&&Yn(re,yt),st}function Kt(re,Q,ce,Se){if(typeof ce=="object"&&ce!==null&&ce.type===y&&ce.key===null&&(ce=ce.props.children),typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case _:e:{for(var st=ce.key;Q!==null;){if(Q.key===st){if(st=ce.type,st===y){if(Q.tag===7){o(re,Q.sibling),Se=m(Q,ce.props.children),Se.return=re,re=Se;break e}}else if(Q.elementType===st||typeof st=="object"&&st!==null&&st.$$typeof===K&&Si(st)===Q.type){o(re,Q.sibling),Se=m(Q,ce.props),Fo(Se,ce),Se.return=re,re=Se;break e}o(re,Q);break}else i(re,Q);Q=Q.sibling}ce.type===y?(Se=vi(ce.props.children,re.mode,Se,ce.key),Se.return=re,re=Se):(Se=f0(ce.type,ce.key,ce.props,null,re.mode,Se),Fo(Se,ce),Se.return=re,re=Se)}return E(re);case b:e:{for(st=ce.key;Q!==null;){if(Q.key===st)if(Q.tag===4&&Q.stateNode.containerInfo===ce.containerInfo&&Q.stateNode.implementation===ce.implementation){o(re,Q.sibling),Se=m(Q,ce.children||[]),Se.return=re,re=Se;break e}else{o(re,Q);break}else i(re,Q);Q=Q.sibling}Se=Af(ce,re.mode,Se),Se.return=re,re=Se}return E(re);case K:return ce=Si(ce),Kt(re,Q,ce,Se)}if(Ae(ce))return Je(re,Q,ce,Se);if(Z(ce)){if(st=Z(ce),typeof st!="function")throw Error(a(150));return ce=st.call(ce),ot(re,Q,ce,Se)}if(typeof ce.then=="function")return Kt(re,Q,v0(ce),Se);if(ce.$$typeof===T)return Kt(re,Q,m0(re,ce),Se);y0(re,ce)}return typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint"?(ce=""+ce,Q!==null&&Q.tag===6?(o(re,Q.sibling),Se=m(Q,ce),Se.return=re,re=Se):(o(re,Q),Se=kf(ce,re.mode,Se),Se.return=re,re=Se),E(re)):o(re,Q)}return function(re,Q,ce,Se){try{Do=0;var st=Kt(re,Q,ce,Se);return wl=null,st}catch(et){if(et===_l||et===p0)throw et;var Lt=Ia(29,et,null,re.mode);return Lt.lanes=Se,Lt.return=re,Lt}}}var Ti=Y1(!0),J1=Y1(!1),Ns=!1;function Uf(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Pf(n,i){n=n.updateQueue,i.updateQueue===n&&(i.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function Os(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function Rs(n,i,o){var f=n.updateQueue;if(f===null)return null;if(f=f.shared,(jt&2)!==0){var m=f.pending;return m===null?i.next=i:(i.next=m.next,m.next=i),f.pending=i,i=u0(n),M1(n,null,o),i}return c0(n,f,i,o),u0(n)}function Mo(n,i,o){if(i=i.updateQueue,i!==null&&(i=i.shared,(o&4194048)!==0)){var f=i.lanes;f&=n.pendingLanes,o|=f,i.lanes=o,Ss(n,o)}}function zf(n,i){var o=n.updateQueue,f=n.alternate;if(f!==null&&(f=f.updateQueue,o===f)){var m=null,p=null;if(o=o.firstBaseUpdate,o!==null){do{var E={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};p===null?m=p=E:p=p.next=E,o=o.next}while(o!==null);p===null?m=p=i:p=p.next=i}else m=p=i;o={baseState:f.baseState,firstBaseUpdate:m,lastBaseUpdate:p,shared:f.shared,callbacks:f.callbacks},n.updateQueue=o;return}n=o.lastBaseUpdate,n===null?o.firstBaseUpdate=i:n.next=i,o.lastBaseUpdate=i}var Hf=!1;function Lo(){if(Hf){var n=yl;if(n!==null)throw n}}function Bo(n,i,o,f){Hf=!1;var m=n.updateQueue;Ns=!1;var p=m.firstBaseUpdate,E=m.lastBaseUpdate,O=m.shared.pending;if(O!==null){m.shared.pending=null;var W=O,ue=W.next;W.next=null,E===null?p=ue:E.next=ue,E=W;var we=n.alternate;we!==null&&(we=we.updateQueue,O=we.lastBaseUpdate,O!==E&&(O===null?we.firstBaseUpdate=ue:O.next=ue,we.lastBaseUpdate=W))}if(p!==null){var ke=m.baseState;E=0,we=ue=W=null,O=p;do{var de=O.lane&-536870913,ge=de!==O.lane;if(ge?(Ct&de)===de:(f&de)===de){de!==0&&de===vl&&(Hf=!0),we!==null&&(we=we.next={lane:0,tag:O.tag,payload:O.payload,callback:null,next:null});e:{var Je=n,ot=O;de=i;var Kt=o;switch(ot.tag){case 1:if(Je=ot.payload,typeof Je=="function"){ke=Je.call(Kt,ke,de);break e}ke=Je;break e;case 3:Je.flags=Je.flags&-65537|128;case 0:if(Je=ot.payload,de=typeof Je=="function"?Je.call(Kt,ke,de):Je,de==null)break e;ke=x({},ke,de);break e;case 2:Ns=!0}}de=O.callback,de!==null&&(n.flags|=64,ge&&(n.flags|=8192),ge=m.callbacks,ge===null?m.callbacks=[de]:ge.push(de))}else ge={lane:de,tag:O.tag,payload:O.payload,callback:O.callback,next:null},we===null?(ue=we=ge,W=ke):we=we.next=ge,E|=de;if(O=O.next,O===null){if(O=m.shared.pending,O===null)break;ge=O,O=ge.next,ge.next=null,m.lastBaseUpdate=ge,m.shared.pending=null}}while(!0);we===null&&(W=ke),m.baseState=W,m.firstBaseUpdate=ue,m.lastBaseUpdate=we,p===null&&(m.shared.lanes=0),Bs|=E,n.lanes=E,n.memoizedState=ke}}function Q1(n,i){if(typeof n!="function")throw Error(a(191,n));n.call(i)}function Z1(n,i){var o=n.callbacks;if(o!==null)for(n.callbacks=null,n=0;n<o.length;n++)Q1(o[n],i)}var bl=I(null),_0=I(0);function eg(n,i){n=ls,U(_0,n),U(bl,i),ls=n|i.baseLanes}function $f(){U(_0,ls),U(bl,bl.current)}function Vf(){ls=_0.current,N(bl),N(_0)}var ja=I(null),nn=null;function Ds(n){var i=n.alternate;U(br,br.current&1),U(ja,n),nn===null&&(i===null||bl.current!==null||i.memoizedState!==null)&&(nn=n)}function Gf(n){U(br,br.current),U(ja,n),nn===null&&(nn=n)}function tg(n){n.tag===22?(U(br,br.current),U(ja,n),nn===null&&(nn=n)):Fs()}function Fs(){U(br,br.current),U(ja,ja.current)}function Ua(n){N(ja),nn===n&&(nn=null),N(br)}var br=I(0);function w0(n){for(var i=n;i!==null;){if(i.tag===13){var o=i.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||Jh(o)||Qh(o)))return i}else if(i.tag===19&&(i.memoizedProps.revealOrder==="forwards"||i.memoizedProps.revealOrder==="backwards"||i.memoizedProps.revealOrder==="unstable_legacy-backwards"||i.memoizedProps.revealOrder==="together")){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===n)break;for(;i.sibling===null;){if(i.return===null||i.return===n)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var Zn=0,xt=null,Xt=null,Nr=null,b0=!1,Sl=!1,ki=!1,S0=0,Io=0,El=null,lb=0;function pr(){throw Error(a(321))}function qf(n,i){if(i===null)return!1;for(var o=0;o<i.length&&o<n.length;o++)if(!Ba(n[o],i[o]))return!1;return!0}function Xf(n,i,o,f,m,p){return Zn=p,xt=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,V.H=n===null||n.memoizedState===null?jg:oh,ki=!1,p=o(f,m),ki=!1,Sl&&(p=ag(i,o,f,m)),rg(n),p}function rg(n){V.H=Po;var i=Xt!==null&&Xt.next!==null;if(Zn=0,Nr=Xt=xt=null,b0=!1,Io=0,El=null,i)throw Error(a(300));n===null||Or||(n=n.dependencies,n!==null&&d0(n)&&(Or=!0))}function ag(n,i,o,f){xt=n;var m=0;do{if(Sl&&(El=null),Io=0,Sl=!1,25<=m)throw Error(a(301));if(m+=1,Nr=Xt=null,n.updateQueue!=null){var p=n.updateQueue;p.lastEffect=null,p.events=null,p.stores=null,p.memoCache!=null&&(p.memoCache.index=0)}V.H=Ug,p=i(o,f)}while(Sl);return p}function ob(){var n=V.H,i=n.useState()[0];return i=typeof i.then=="function"?jo(i):i,n=n.useState()[0],(Xt!==null?Xt.memoizedState:null)!==n&&(xt.flags|=1024),i}function Wf(){var n=S0!==0;return S0=0,n}function Kf(n,i,o){i.updateQueue=n.updateQueue,i.flags&=-2053,n.lanes&=~o}function Yf(n){if(b0){for(n=n.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}b0=!1}Zn=0,Nr=Xt=xt=null,Sl=!1,Io=S0=0,El=null}function va(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Nr===null?xt.memoizedState=Nr=n:Nr=Nr.next=n,Nr}function Sr(){if(Xt===null){var n=xt.alternate;n=n!==null?n.memoizedState:null}else n=Xt.next;var i=Nr===null?xt.memoizedState:Nr.next;if(i!==null)Nr=i,Xt=n;else{if(n===null)throw xt.alternate===null?Error(a(467)):Error(a(310));Xt=n,n={memoizedState:Xt.memoizedState,baseState:Xt.baseState,baseQueue:Xt.baseQueue,queue:Xt.queue,next:null},Nr===null?xt.memoizedState=Nr=n:Nr=Nr.next=n}return Nr}function E0(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function jo(n){var i=Io;return Io+=1,El===null&&(El=[]),n=X1(El,n,i),i=xt,(Nr===null?i.memoizedState:Nr.next)===null&&(i=i.alternate,V.H=i===null||i.memoizedState===null?jg:oh),n}function T0(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return jo(n);if(n.$$typeof===T)return Jr(n)}throw Error(a(438,String(n)))}function Jf(n){var i=null,o=xt.updateQueue;if(o!==null&&(i=o.memoCache),i==null){var f=xt.alternate;f!==null&&(f=f.updateQueue,f!==null&&(f=f.memoCache,f!=null&&(i={data:f.data.map(function(m){return m.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),o===null&&(o=E0(),xt.updateQueue=o),o.memoCache=i,o=i.data[i.index],o===void 0)for(o=i.data[i.index]=Array(n),f=0;f<n;f++)o[f]=ie;return i.index++,o}function es(n,i){return typeof i=="function"?i(n):i}function k0(n){var i=Sr();return Qf(i,Xt,n)}function Qf(n,i,o){var f=n.queue;if(f===null)throw Error(a(311));f.lastRenderedReducer=o;var m=n.baseQueue,p=f.pending;if(p!==null){if(m!==null){var E=m.next;m.next=p.next,p.next=E}i.baseQueue=m=p,f.pending=null}if(p=n.baseState,m===null)n.memoizedState=p;else{i=m.next;var O=E=null,W=null,ue=i,we=!1;do{var ke=ue.lane&-536870913;if(ke!==ue.lane?(Ct&ke)===ke:(Zn&ke)===ke){var de=ue.revertLane;if(de===0)W!==null&&(W=W.next={lane:0,revertLane:0,gesture:null,action:ue.action,hasEagerState:ue.hasEagerState,eagerState:ue.eagerState,next:null}),ke===vl&&(we=!0);else if((Zn&de)===de){ue=ue.next,de===vl&&(we=!0);continue}else ke={lane:0,revertLane:ue.revertLane,gesture:null,action:ue.action,hasEagerState:ue.hasEagerState,eagerState:ue.eagerState,next:null},W===null?(O=W=ke,E=p):W=W.next=ke,xt.lanes|=de,Bs|=de;ke=ue.action,ki&&o(p,ke),p=ue.hasEagerState?ue.eagerState:o(p,ke)}else de={lane:ke,revertLane:ue.revertLane,gesture:ue.gesture,action:ue.action,hasEagerState:ue.hasEagerState,eagerState:ue.eagerState,next:null},W===null?(O=W=de,E=p):W=W.next=de,xt.lanes|=ke,Bs|=ke;ue=ue.next}while(ue!==null&&ue!==i);if(W===null?E=p:W.next=O,!Ba(p,n.memoizedState)&&(Or=!0,we&&(o=yl,o!==null)))throw o;n.memoizedState=p,n.baseState=E,n.baseQueue=W,f.lastRenderedState=p}return m===null&&(f.lanes=0),[n.memoizedState,f.dispatch]}function Zf(n){var i=Sr(),o=i.queue;if(o===null)throw Error(a(311));o.lastRenderedReducer=n;var f=o.dispatch,m=o.pending,p=i.memoizedState;if(m!==null){o.pending=null;var E=m=m.next;do p=n(p,E.action),E=E.next;while(E!==m);Ba(p,i.memoizedState)||(Or=!0),i.memoizedState=p,i.baseQueue===null&&(i.baseState=p),o.lastRenderedState=p}return[p,f]}function ng(n,i,o){var f=xt,m=Sr(),p=Ot;if(p){if(o===void 0)throw Error(a(407));o=o()}else o=i();var E=!Ba((Xt||m).memoizedState,o);if(E&&(m.memoizedState=o,Or=!0),m=m.queue,rh(lg.bind(null,f,m,n),[n]),m.getSnapshot!==i||E||Nr!==null&&Nr.memoizedState.tag&1){if(f.flags|=2048,Tl(9,{destroy:void 0},ig.bind(null,f,m,o,i),null),Qt===null)throw Error(a(349));p||(Zn&127)!==0||sg(f,i,o)}return o}function sg(n,i,o){n.flags|=16384,n={getSnapshot:i,value:o},i=xt.updateQueue,i===null?(i=E0(),xt.updateQueue=i,i.stores=[n]):(o=i.stores,o===null?i.stores=[n]:o.push(n))}function ig(n,i,o,f){i.value=o,i.getSnapshot=f,og(i)&&cg(n)}function lg(n,i,o){return o(function(){og(i)&&cg(n)})}function og(n){var i=n.getSnapshot;n=n.value;try{var o=i();return!Ba(n,o)}catch{return!0}}function cg(n){var i=xi(n,2);i!==null&&Na(i,n,2)}function eh(n){var i=va();if(typeof n=="function"){var o=n;if(n=o(),ki){La(!0);try{o()}finally{La(!1)}}}return i.memoizedState=i.baseState=n,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:es,lastRenderedState:n},i}function ug(n,i,o,f){return n.baseState=o,Qf(n,Xt,typeof f=="function"?f:es)}function cb(n,i,o,f,m){if(N0(n))throw Error(a(485));if(n=i.action,n!==null){var p={payload:m,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(E){p.listeners.push(E)}};V.T!==null?o(!0):p.isTransition=!1,f(p),o=i.pending,o===null?(p.next=i.pending=p,fg(i,p)):(p.next=o.next,i.pending=o.next=p)}}function fg(n,i){var o=i.action,f=i.payload,m=n.state;if(i.isTransition){var p=V.T,E={};V.T=E;try{var O=o(m,f),W=V.S;W!==null&&W(E,O),hg(n,i,O)}catch(ue){th(n,i,ue)}finally{p!==null&&E.types!==null&&(p.types=E.types),V.T=p}}else try{p=o(m,f),hg(n,i,p)}catch(ue){th(n,i,ue)}}function hg(n,i,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(f){dg(n,i,f)},function(f){return th(n,i,f)}):dg(n,i,o)}function dg(n,i,o){i.status="fulfilled",i.value=o,mg(i),n.state=o,i=n.pending,i!==null&&(o=i.next,o===i?n.pending=null:(o=o.next,i.next=o,fg(n,o)))}function th(n,i,o){var f=n.pending;if(n.pending=null,f!==null){f=f.next;do i.status="rejected",i.reason=o,mg(i),i=i.next;while(i!==f)}n.action=null}function mg(n){n=n.listeners;for(var i=0;i<n.length;i++)(0,n[i])()}function gg(n,i){return i}function pg(n,i){if(Ot){var o=Qt.formState;if(o!==null){e:{var f=xt;if(Ot){if(ar){t:{for(var m=ar,p=an;m.nodeType!==8;){if(!p){m=null;break t}if(m=sn(m.nextSibling),m===null){m=null;break t}}p=m.data,m=p==="F!"||p==="F"?m:null}if(m){ar=sn(m.nextSibling),f=m.data==="F!";break e}}As(f)}f=!1}f&&(i=o[0])}}return o=va(),o.memoizedState=o.baseState=i,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:gg,lastRenderedState:i},o.queue=f,o=Lg.bind(null,xt,f),f.dispatch=o,f=eh(!1),p=lh.bind(null,xt,!1,f.queue),f=va(),m={state:i,dispatch:null,action:n,pending:null},f.queue=m,o=cb.bind(null,xt,m,p,o),m.dispatch=o,f.memoizedState=n,[i,o,!1]}function xg(n){var i=Sr();return vg(i,Xt,n)}function vg(n,i,o){if(i=Qf(n,i,gg)[0],n=k0(es)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var f=jo(i)}catch(E){throw E===_l?p0:E}else f=i;i=Sr();var m=i.queue,p=m.dispatch;return o!==i.memoizedState&&(xt.flags|=2048,Tl(9,{destroy:void 0},ub.bind(null,m,o),null)),[f,p,n]}function ub(n,i){n.action=i}function yg(n){var i=Sr(),o=Xt;if(o!==null)return vg(i,o,n);Sr(),i=i.memoizedState,o=Sr();var f=o.queue.dispatch;return o.memoizedState=n,[i,f,!1]}function Tl(n,i,o,f){return n={tag:n,create:o,deps:f,inst:i,next:null},i=xt.updateQueue,i===null&&(i=E0(),xt.updateQueue=i),o=i.lastEffect,o===null?i.lastEffect=n.next=n:(f=o.next,o.next=n,n.next=f,i.lastEffect=n),n}function _g(){return Sr().memoizedState}function A0(n,i,o,f){var m=va();xt.flags|=n,m.memoizedState=Tl(1|i,{destroy:void 0},o,f===void 0?null:f)}function C0(n,i,o,f){var m=Sr();f=f===void 0?null:f;var p=m.memoizedState.inst;Xt!==null&&f!==null&&qf(f,Xt.memoizedState.deps)?m.memoizedState=Tl(i,p,o,f):(xt.flags|=n,m.memoizedState=Tl(1|i,p,o,f))}function wg(n,i){A0(8390656,8,n,i)}function rh(n,i){C0(2048,8,n,i)}function fb(n){xt.flags|=4;var i=xt.updateQueue;if(i===null)i=E0(),xt.updateQueue=i,i.events=[n];else{var o=i.events;o===null?i.events=[n]:o.push(n)}}function bg(n){var i=Sr().memoizedState;return fb({ref:i,nextImpl:n}),function(){if((jt&2)!==0)throw Error(a(440));return i.impl.apply(void 0,arguments)}}function Sg(n,i){return C0(4,2,n,i)}function Eg(n,i){return C0(4,4,n,i)}function Tg(n,i){if(typeof i=="function"){n=n();var o=i(n);return function(){typeof o=="function"?o():i(null)}}if(i!=null)return n=n(),i.current=n,function(){i.current=null}}function kg(n,i,o){o=o!=null?o.concat([n]):null,C0(4,4,Tg.bind(null,i,n),o)}function ah(){}function Ag(n,i){var o=Sr();i=i===void 0?null:i;var f=o.memoizedState;return i!==null&&qf(i,f[1])?f[0]:(o.memoizedState=[n,i],n)}function Cg(n,i){var o=Sr();i=i===void 0?null:i;var f=o.memoizedState;if(i!==null&&qf(i,f[1]))return f[0];if(f=n(),ki){La(!0);try{n()}finally{La(!1)}}return o.memoizedState=[f,i],f}function nh(n,i,o){return o===void 0||(Zn&1073741824)!==0&&(Ct&261930)===0?n.memoizedState=i:(n.memoizedState=o,n=Np(),xt.lanes|=n,Bs|=n,o)}function Ng(n,i,o,f){return Ba(o,i)?o:bl.current!==null?(n=nh(n,o,f),Ba(n,i)||(Or=!0),n):(Zn&42)===0||(Zn&1073741824)!==0&&(Ct&261930)===0?(Or=!0,n.memoizedState=o):(n=Np(),xt.lanes|=n,Bs|=n,i)}function Og(n,i,o,f,m){var p=ae.p;ae.p=p!==0&&8>p?p:8;var E=V.T,O={};V.T=O,lh(n,!1,i,o);try{var W=m(),ue=V.S;if(ue!==null&&ue(O,W),W!==null&&typeof W=="object"&&typeof W.then=="function"){var we=ib(W,f);Uo(n,i,we,Ha(n))}else Uo(n,i,f,Ha(n))}catch(ke){Uo(n,i,{then:function(){},status:"rejected",reason:ke},Ha())}finally{ae.p=p,E!==null&&O.types!==null&&(E.types=O.types),V.T=E}}function hb(){}function sh(n,i,o,f){if(n.tag!==5)throw Error(a(476));var m=Rg(n).queue;Og(n,m,i,xe,o===null?hb:function(){return Dg(n),o(f)})}function Rg(n){var i=n.memoizedState;if(i!==null)return i;i={memoizedState:xe,baseState:xe,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:es,lastRenderedState:xe},next:null};var o={};return i.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:es,lastRenderedState:o},next:null},n.memoizedState=i,n=n.alternate,n!==null&&(n.memoizedState=i),i}function Dg(n){var i=Rg(n);i.next===null&&(i=n.alternate.memoizedState),Uo(n,i.next.queue,{},Ha())}function ih(){return Jr(rc)}function Fg(){return Sr().memoizedState}function Mg(){return Sr().memoizedState}function db(n){for(var i=n.return;i!==null;){switch(i.tag){case 24:case 3:var o=Ha();n=Os(o);var f=Rs(i,n,o);f!==null&&(Na(f,i,o),Mo(f,i,o)),i={cache:Lf()},n.payload=i;return}i=i.return}}function mb(n,i,o){var f=Ha();o={lane:f,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},N0(n)?Bg(i,o):(o=Ef(n,i,o,f),o!==null&&(Na(o,n,f),Ig(o,i,f)))}function Lg(n,i,o){var f=Ha();Uo(n,i,o,f)}function Uo(n,i,o,f){var m={lane:f,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(N0(n))Bg(i,m);else{var p=n.alternate;if(n.lanes===0&&(p===null||p.lanes===0)&&(p=i.lastRenderedReducer,p!==null))try{var E=i.lastRenderedState,O=p(E,o);if(m.hasEagerState=!0,m.eagerState=O,Ba(O,E))return c0(n,i,m,0),Qt===null&&o0(),!1}catch{}if(o=Ef(n,i,m,f),o!==null)return Na(o,n,f),Ig(o,i,f),!0}return!1}function lh(n,i,o,f){if(f={lane:2,revertLane:Uh(),gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},N0(n)){if(i)throw Error(a(479))}else i=Ef(n,o,f,2),i!==null&&Na(i,n,2)}function N0(n){var i=n.alternate;return n===xt||i!==null&&i===xt}function Bg(n,i){Sl=b0=!0;var o=n.pending;o===null?i.next=i:(i.next=o.next,o.next=i),n.pending=i}function Ig(n,i,o){if((o&4194048)!==0){var f=i.lanes;f&=n.pendingLanes,o|=f,i.lanes=o,Ss(n,o)}}var Po={readContext:Jr,use:T0,useCallback:pr,useContext:pr,useEffect:pr,useImperativeHandle:pr,useLayoutEffect:pr,useInsertionEffect:pr,useMemo:pr,useReducer:pr,useRef:pr,useState:pr,useDebugValue:pr,useDeferredValue:pr,useTransition:pr,useSyncExternalStore:pr,useId:pr,useHostTransitionStatus:pr,useFormState:pr,useActionState:pr,useOptimistic:pr,useMemoCache:pr,useCacheRefresh:pr};Po.useEffectEvent=pr;var jg={readContext:Jr,use:T0,useCallback:function(n,i){return va().memoizedState=[n,i===void 0?null:i],n},useContext:Jr,useEffect:wg,useImperativeHandle:function(n,i,o){o=o!=null?o.concat([n]):null,A0(4194308,4,Tg.bind(null,i,n),o)},useLayoutEffect:function(n,i){return A0(4194308,4,n,i)},useInsertionEffect:function(n,i){A0(4,2,n,i)},useMemo:function(n,i){var o=va();i=i===void 0?null:i;var f=n();if(ki){La(!0);try{n()}finally{La(!1)}}return o.memoizedState=[f,i],f},useReducer:function(n,i,o){var f=va();if(o!==void 0){var m=o(i);if(ki){La(!0);try{o(i)}finally{La(!1)}}}else m=i;return f.memoizedState=f.baseState=m,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:m},f.queue=n,n=n.dispatch=mb.bind(null,xt,n),[f.memoizedState,n]},useRef:function(n){var i=va();return n={current:n},i.memoizedState=n},useState:function(n){n=eh(n);var i=n.queue,o=Lg.bind(null,xt,i);return i.dispatch=o,[n.memoizedState,o]},useDebugValue:ah,useDeferredValue:function(n,i){var o=va();return nh(o,n,i)},useTransition:function(){var n=eh(!1);return n=Og.bind(null,xt,n.queue,!0,!1),va().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,i,o){var f=xt,m=va();if(Ot){if(o===void 0)throw Error(a(407));o=o()}else{if(o=i(),Qt===null)throw Error(a(349));(Ct&127)!==0||sg(f,i,o)}m.memoizedState=o;var p={value:o,getSnapshot:i};return m.queue=p,wg(lg.bind(null,f,p,n),[n]),f.flags|=2048,Tl(9,{destroy:void 0},ig.bind(null,f,p,o,i),null),o},useId:function(){var n=va(),i=Qt.identifierPrefix;if(Ot){var o=Rn,f=On;o=(f&~(1<<32-cr(f)-1)).toString(32)+o,i="_"+i+"R_"+o,o=S0++,0<o&&(i+="H"+o.toString(32)),i+="_"}else o=lb++,i="_"+i+"r_"+o.toString(32)+"_";return n.memoizedState=i},useHostTransitionStatus:ih,useFormState:pg,useActionState:pg,useOptimistic:function(n){var i=va();i.memoizedState=i.baseState=n;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=o,i=lh.bind(null,xt,!0,o),o.dispatch=i,[n,i]},useMemoCache:Jf,useCacheRefresh:function(){return va().memoizedState=db.bind(null,xt)},useEffectEvent:function(n){var i=va(),o={impl:n};return i.memoizedState=o,function(){if((jt&2)!==0)throw Error(a(440));return o.impl.apply(void 0,arguments)}}},oh={readContext:Jr,use:T0,useCallback:Ag,useContext:Jr,useEffect:rh,useImperativeHandle:kg,useInsertionEffect:Sg,useLayoutEffect:Eg,useMemo:Cg,useReducer:k0,useRef:_g,useState:function(){return k0(es)},useDebugValue:ah,useDeferredValue:function(n,i){var o=Sr();return Ng(o,Xt.memoizedState,n,i)},useTransition:function(){var n=k0(es)[0],i=Sr().memoizedState;return[typeof n=="boolean"?n:jo(n),i]},useSyncExternalStore:ng,useId:Fg,useHostTransitionStatus:ih,useFormState:xg,useActionState:xg,useOptimistic:function(n,i){var o=Sr();return ug(o,Xt,n,i)},useMemoCache:Jf,useCacheRefresh:Mg};oh.useEffectEvent=bg;var Ug={readContext:Jr,use:T0,useCallback:Ag,useContext:Jr,useEffect:rh,useImperativeHandle:kg,useInsertionEffect:Sg,useLayoutEffect:Eg,useMemo:Cg,useReducer:Zf,useRef:_g,useState:function(){return Zf(es)},useDebugValue:ah,useDeferredValue:function(n,i){var o=Sr();return Xt===null?nh(o,n,i):Ng(o,Xt.memoizedState,n,i)},useTransition:function(){var n=Zf(es)[0],i=Sr().memoizedState;return[typeof n=="boolean"?n:jo(n),i]},useSyncExternalStore:ng,useId:Fg,useHostTransitionStatus:ih,useFormState:yg,useActionState:yg,useOptimistic:function(n,i){var o=Sr();return Xt!==null?ug(o,Xt,n,i):(o.baseState=n,[n,o.queue.dispatch])},useMemoCache:Jf,useCacheRefresh:Mg};Ug.useEffectEvent=bg;function ch(n,i,o,f){i=n.memoizedState,o=o(f,i),o=o==null?i:x({},i,o),n.memoizedState=o,n.lanes===0&&(n.updateQueue.baseState=o)}var uh={enqueueSetState:function(n,i,o){n=n._reactInternals;var f=Ha(),m=Os(f);m.payload=i,o!=null&&(m.callback=o),i=Rs(n,m,f),i!==null&&(Na(i,n,f),Mo(i,n,f))},enqueueReplaceState:function(n,i,o){n=n._reactInternals;var f=Ha(),m=Os(f);m.tag=1,m.payload=i,o!=null&&(m.callback=o),i=Rs(n,m,f),i!==null&&(Na(i,n,f),Mo(i,n,f))},enqueueForceUpdate:function(n,i){n=n._reactInternals;var o=Ha(),f=Os(o);f.tag=2,i!=null&&(f.callback=i),i=Rs(n,f,o),i!==null&&(Na(i,n,o),Mo(i,n,o))}};function Pg(n,i,o,f,m,p,E){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(f,p,E):i.prototype&&i.prototype.isPureReactComponent?!ko(o,f)||!ko(m,p):!0}function zg(n,i,o,f){n=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(o,f),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(o,f),i.state!==n&&uh.enqueueReplaceState(i,i.state,null)}function Ai(n,i){var o=i;if("ref"in i){o={};for(var f in i)f!=="ref"&&(o[f]=i[f])}if(n=n.defaultProps){o===i&&(o=x({},o));for(var m in n)o[m]===void 0&&(o[m]=n[m])}return o}function Hg(n){l0(n)}function $g(n){console.error(n)}function Vg(n){l0(n)}function O0(n,i){try{var o=n.onUncaughtError;o(i.value,{componentStack:i.stack})}catch(f){setTimeout(function(){throw f})}}function Gg(n,i,o){try{var f=n.onCaughtError;f(o.value,{componentStack:o.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function fh(n,i,o){return o=Os(o),o.tag=3,o.payload={element:null},o.callback=function(){O0(n,i)},o}function qg(n){return n=Os(n),n.tag=3,n}function Xg(n,i,o,f){var m=o.type.getDerivedStateFromError;if(typeof m=="function"){var p=f.value;n.payload=function(){return m(p)},n.callback=function(){Gg(i,o,f)}}var E=o.stateNode;E!==null&&typeof E.componentDidCatch=="function"&&(n.callback=function(){Gg(i,o,f),typeof m!="function"&&(Is===null?Is=new Set([this]):Is.add(this));var O=f.stack;this.componentDidCatch(f.value,{componentStack:O!==null?O:""})})}function gb(n,i,o,f,m){if(o.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){if(i=o.alternate,i!==null&&xl(i,o,m,!0),o=ja.current,o!==null){switch(o.tag){case 31:case 13:return nn===null?H0():o.alternate===null&&xr===0&&(xr=3),o.flags&=-257,o.flags|=65536,o.lanes=m,f===x0?o.flags|=16384:(i=o.updateQueue,i===null?o.updateQueue=new Set([f]):i.add(f),Bh(n,f,m)),!1;case 22:return o.flags|=65536,f===x0?o.flags|=16384:(i=o.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([f])},o.updateQueue=i):(o=i.retryQueue,o===null?i.retryQueue=new Set([f]):o.add(f)),Bh(n,f,m)),!1}throw Error(a(435,o.tag))}return Bh(n,f,m),H0(),!1}if(Ot)return i=ja.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=m,f!==Of&&(n=Error(a(422),{cause:f}),No(en(n,o)))):(f!==Of&&(i=Error(a(423),{cause:f}),No(en(i,o))),n=n.current.alternate,n.flags|=65536,m&=-m,n.lanes|=m,f=en(f,o),m=fh(n.stateNode,f,m),zf(n,m),xr!==4&&(xr=2)),!1;var p=Error(a(520),{cause:f});if(p=en(p,o),Wo===null?Wo=[p]:Wo.push(p),xr!==4&&(xr=2),i===null)return!0;f=en(f,o),o=i;do{switch(o.tag){case 3:return o.flags|=65536,n=m&-m,o.lanes|=n,n=fh(o.stateNode,f,n),zf(o,n),!1;case 1:if(i=o.type,p=o.stateNode,(o.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||p!==null&&typeof p.componentDidCatch=="function"&&(Is===null||!Is.has(p))))return o.flags|=65536,m&=-m,o.lanes|=m,m=qg(m),Xg(m,n,o,f),zf(o,m),!1}o=o.return}while(o!==null);return!1}var hh=Error(a(461)),Or=!1;function Qr(n,i,o,f){i.child=n===null?J1(i,null,o,f):Ti(i,n.child,o,f)}function Wg(n,i,o,f,m){o=o.render;var p=i.ref;if("ref"in f){var E={};for(var O in f)O!=="ref"&&(E[O]=f[O])}else E=f;return wi(i),f=Xf(n,i,o,E,p,m),O=Wf(),n!==null&&!Or?(Kf(n,i,m),ts(n,i,m)):(Ot&&O&&Cf(i),i.flags|=1,Qr(n,i,f,m),i.child)}function Kg(n,i,o,f,m){if(n===null){var p=o.type;return typeof p=="function"&&!Tf(p)&&p.defaultProps===void 0&&o.compare===null?(i.tag=15,i.type=p,Yg(n,i,p,f,m)):(n=f0(o.type,null,f,i,i.mode,m),n.ref=i.ref,n.return=i,i.child=n)}if(p=n.child,!_h(n,m)){var E=p.memoizedProps;if(o=o.compare,o=o!==null?o:ko,o(E,f)&&n.ref===i.ref)return ts(n,i,m)}return i.flags|=1,n=Kn(p,f),n.ref=i.ref,n.return=i,i.child=n}function Yg(n,i,o,f,m){if(n!==null){var p=n.memoizedProps;if(ko(p,f)&&n.ref===i.ref)if(Or=!1,i.pendingProps=f=p,_h(n,m))(n.flags&131072)!==0&&(Or=!0);else return i.lanes=n.lanes,ts(n,i,m)}return dh(n,i,o,f,m)}function Jg(n,i,o,f){var m=f.children,p=n!==null?n.memoizedState:null;if(n===null&&i.stateNode===null&&(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),f.mode==="hidden"){if((i.flags&128)!==0){if(p=p!==null?p.baseLanes|o:o,n!==null){for(f=i.child=n.child,m=0;f!==null;)m=m|f.lanes|f.childLanes,f=f.sibling;f=m&~p}else f=0,i.child=null;return Qg(n,i,p,o,f)}if((o&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},n!==null&&g0(i,p!==null?p.cachePool:null),p!==null?eg(i,p):$f(),tg(i);else return f=i.lanes=536870912,Qg(n,i,p!==null?p.baseLanes|o:o,o,f)}else p!==null?(g0(i,p.cachePool),eg(i,p),Fs(),i.memoizedState=null):(n!==null&&g0(i,null),$f(),Fs());return Qr(n,i,m,o),i.child}function zo(n,i){return n!==null&&n.tag===22||i.stateNode!==null||(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.sibling}function Qg(n,i,o,f,m){var p=If();return p=p===null?null:{parent:Cr._currentValue,pool:p},i.memoizedState={baseLanes:o,cachePool:p},n!==null&&g0(i,null),$f(),tg(i),n!==null&&xl(n,i,f,!0),i.childLanes=m,null}function R0(n,i){return i=F0({mode:i.mode,children:i.children},n.mode),i.ref=n.ref,n.child=i,i.return=n,i}function Zg(n,i,o){return Ti(i,n.child,null,o),n=R0(i,i.pendingProps),n.flags|=2,Ua(i),i.memoizedState=null,n}function pb(n,i,o){var f=i.pendingProps,m=(i.flags&128)!==0;if(i.flags&=-129,n===null){if(Ot){if(f.mode==="hidden")return n=R0(i,f),i.lanes=536870912,zo(null,n);if(Gf(i),(n=ar)?(n=fx(n,an),n=n!==null&&n.data==="&"?n:null,n!==null&&(i.memoizedState={dehydrated:n,treeContext:Ts!==null?{id:On,overflow:Rn}:null,retryLane:536870912,hydrationErrors:null},o=B1(n),o.return=i,i.child=o,Yr=i,ar=null)):n=null,n===null)throw As(i);return i.lanes=536870912,null}return R0(i,f)}var p=n.memoizedState;if(p!==null){var E=p.dehydrated;if(Gf(i),m)if(i.flags&256)i.flags&=-257,i=Zg(n,i,o);else if(i.memoizedState!==null)i.child=n.child,i.flags|=128,i=null;else throw Error(a(558));else if(Or||xl(n,i,o,!1),m=(o&n.childLanes)!==0,Or||m){if(f=Qt,f!==null&&(E=sl(f,o),E!==0&&E!==p.retryLane))throw p.retryLane=E,xi(n,E),Na(f,n,E),hh;H0(),i=Zg(n,i,o)}else n=p.treeContext,ar=sn(E.nextSibling),Yr=i,Ot=!0,ks=null,an=!1,n!==null&&U1(i,n),i=R0(i,f),i.flags|=4096;return i}return n=Kn(n.child,{mode:f.mode,children:f.children}),n.ref=i.ref,i.child=n,n.return=i,n}function D0(n,i){var o=i.ref;if(o===null)n!==null&&n.ref!==null&&(i.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(a(284));(n===null||n.ref!==o)&&(i.flags|=4194816)}}function dh(n,i,o,f,m){return wi(i),o=Xf(n,i,o,f,void 0,m),f=Wf(),n!==null&&!Or?(Kf(n,i,m),ts(n,i,m)):(Ot&&f&&Cf(i),i.flags|=1,Qr(n,i,o,m),i.child)}function ep(n,i,o,f,m,p){return wi(i),i.updateQueue=null,o=ag(i,f,o,m),rg(n),f=Wf(),n!==null&&!Or?(Kf(n,i,p),ts(n,i,p)):(Ot&&f&&Cf(i),i.flags|=1,Qr(n,i,o,p),i.child)}function tp(n,i,o,f,m){if(wi(i),i.stateNode===null){var p=dl,E=o.contextType;typeof E=="object"&&E!==null&&(p=Jr(E)),p=new o(f,p),i.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,p.updater=uh,i.stateNode=p,p._reactInternals=i,p=i.stateNode,p.props=f,p.state=i.memoizedState,p.refs={},Uf(i),E=o.contextType,p.context=typeof E=="object"&&E!==null?Jr(E):dl,p.state=i.memoizedState,E=o.getDerivedStateFromProps,typeof E=="function"&&(ch(i,o,E,f),p.state=i.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof p.getSnapshotBeforeUpdate=="function"||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(E=p.state,typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount(),E!==p.state&&uh.enqueueReplaceState(p,p.state,null),Bo(i,f,p,m),Lo(),p.state=i.memoizedState),typeof p.componentDidMount=="function"&&(i.flags|=4194308),f=!0}else if(n===null){p=i.stateNode;var O=i.memoizedProps,W=Ai(o,O);p.props=W;var ue=p.context,we=o.contextType;E=dl,typeof we=="object"&&we!==null&&(E=Jr(we));var ke=o.getDerivedStateFromProps;we=typeof ke=="function"||typeof p.getSnapshotBeforeUpdate=="function",O=i.pendingProps!==O,we||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(O||ue!==E)&&zg(i,p,f,E),Ns=!1;var de=i.memoizedState;p.state=de,Bo(i,f,p,m),Lo(),ue=i.memoizedState,O||de!==ue||Ns?(typeof ke=="function"&&(ch(i,o,ke,f),ue=i.memoizedState),(W=Ns||Pg(i,o,W,f,de,ue,E))?(we||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount()),typeof p.componentDidMount=="function"&&(i.flags|=4194308)):(typeof p.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=f,i.memoizedState=ue),p.props=f,p.state=ue,p.context=E,f=W):(typeof p.componentDidMount=="function"&&(i.flags|=4194308),f=!1)}else{p=i.stateNode,Pf(n,i),E=i.memoizedProps,we=Ai(o,E),p.props=we,ke=i.pendingProps,de=p.context,ue=o.contextType,W=dl,typeof ue=="object"&&ue!==null&&(W=Jr(ue)),O=o.getDerivedStateFromProps,(ue=typeof O=="function"||typeof p.getSnapshotBeforeUpdate=="function")||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(E!==ke||de!==W)&&zg(i,p,f,W),Ns=!1,de=i.memoizedState,p.state=de,Bo(i,f,p,m),Lo();var ge=i.memoizedState;E!==ke||de!==ge||Ns||n!==null&&n.dependencies!==null&&d0(n.dependencies)?(typeof O=="function"&&(ch(i,o,O,f),ge=i.memoizedState),(we=Ns||Pg(i,o,we,f,de,ge,W)||n!==null&&n.dependencies!==null&&d0(n.dependencies))?(ue||typeof p.UNSAFE_componentWillUpdate!="function"&&typeof p.componentWillUpdate!="function"||(typeof p.componentWillUpdate=="function"&&p.componentWillUpdate(f,ge,W),typeof p.UNSAFE_componentWillUpdate=="function"&&p.UNSAFE_componentWillUpdate(f,ge,W)),typeof p.componentDidUpdate=="function"&&(i.flags|=4),typeof p.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof p.componentDidUpdate!="function"||E===n.memoizedProps&&de===n.memoizedState||(i.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||E===n.memoizedProps&&de===n.memoizedState||(i.flags|=1024),i.memoizedProps=f,i.memoizedState=ge),p.props=f,p.state=ge,p.context=W,f=we):(typeof p.componentDidUpdate!="function"||E===n.memoizedProps&&de===n.memoizedState||(i.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||E===n.memoizedProps&&de===n.memoizedState||(i.flags|=1024),f=!1)}return p=f,D0(n,i),f=(i.flags&128)!==0,p||f?(p=i.stateNode,o=f&&typeof o.getDerivedStateFromError!="function"?null:p.render(),i.flags|=1,n!==null&&f?(i.child=Ti(i,n.child,null,m),i.child=Ti(i,null,o,m)):Qr(n,i,o,m),i.memoizedState=p.state,n=i.child):n=ts(n,i,m),n}function rp(n,i,o,f){return yi(),i.flags|=256,Qr(n,i,o,f),i.child}var mh={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function gh(n){return{baseLanes:n,cachePool:G1()}}function ph(n,i,o){return n=n!==null?n.childLanes&~o:0,i&&(n|=za),n}function ap(n,i,o){var f=i.pendingProps,m=!1,p=(i.flags&128)!==0,E;if((E=p)||(E=n!==null&&n.memoizedState===null?!1:(br.current&2)!==0),E&&(m=!0,i.flags&=-129),E=(i.flags&32)!==0,i.flags&=-33,n===null){if(Ot){if(m?Ds(i):Fs(),(n=ar)?(n=fx(n,an),n=n!==null&&n.data!=="&"?n:null,n!==null&&(i.memoizedState={dehydrated:n,treeContext:Ts!==null?{id:On,overflow:Rn}:null,retryLane:536870912,hydrationErrors:null},o=B1(n),o.return=i,i.child=o,Yr=i,ar=null)):n=null,n===null)throw As(i);return Qh(n)?i.lanes=32:i.lanes=536870912,null}var O=f.children;return f=f.fallback,m?(Fs(),m=i.mode,O=F0({mode:"hidden",children:O},m),f=vi(f,m,o,null),O.return=i,f.return=i,O.sibling=f,i.child=O,f=i.child,f.memoizedState=gh(o),f.childLanes=ph(n,E,o),i.memoizedState=mh,zo(null,f)):(Ds(i),xh(i,O))}var W=n.memoizedState;if(W!==null&&(O=W.dehydrated,O!==null)){if(p)i.flags&256?(Ds(i),i.flags&=-257,i=vh(n,i,o)):i.memoizedState!==null?(Fs(),i.child=n.child,i.flags|=128,i=null):(Fs(),O=f.fallback,m=i.mode,f=F0({mode:"visible",children:f.children},m),O=vi(O,m,o,null),O.flags|=2,f.return=i,O.return=i,f.sibling=O,i.child=f,Ti(i,n.child,null,o),f=i.child,f.memoizedState=gh(o),f.childLanes=ph(n,E,o),i.memoizedState=mh,i=zo(null,f));else if(Ds(i),Qh(O)){if(E=O.nextSibling&&O.nextSibling.dataset,E)var ue=E.dgst;E=ue,f=Error(a(419)),f.stack="",f.digest=E,No({value:f,source:null,stack:null}),i=vh(n,i,o)}else if(Or||xl(n,i,o,!1),E=(o&n.childLanes)!==0,Or||E){if(E=Qt,E!==null&&(f=sl(E,o),f!==0&&f!==W.retryLane))throw W.retryLane=f,xi(n,f),Na(E,n,f),hh;Jh(O)||H0(),i=vh(n,i,o)}else Jh(O)?(i.flags|=192,i.child=n.child,i=null):(n=W.treeContext,ar=sn(O.nextSibling),Yr=i,Ot=!0,ks=null,an=!1,n!==null&&U1(i,n),i=xh(i,f.children),i.flags|=4096);return i}return m?(Fs(),O=f.fallback,m=i.mode,W=n.child,ue=W.sibling,f=Kn(W,{mode:"hidden",children:f.children}),f.subtreeFlags=W.subtreeFlags&65011712,ue!==null?O=Kn(ue,O):(O=vi(O,m,o,null),O.flags|=2),O.return=i,f.return=i,f.sibling=O,i.child=f,zo(null,f),f=i.child,O=n.child.memoizedState,O===null?O=gh(o):(m=O.cachePool,m!==null?(W=Cr._currentValue,m=m.parent!==W?{parent:W,pool:W}:m):m=G1(),O={baseLanes:O.baseLanes|o,cachePool:m}),f.memoizedState=O,f.childLanes=ph(n,E,o),i.memoizedState=mh,zo(n.child,f)):(Ds(i),o=n.child,n=o.sibling,o=Kn(o,{mode:"visible",children:f.children}),o.return=i,o.sibling=null,n!==null&&(E=i.deletions,E===null?(i.deletions=[n],i.flags|=16):E.push(n)),i.child=o,i.memoizedState=null,o)}function xh(n,i){return i=F0({mode:"visible",children:i},n.mode),i.return=n,n.child=i}function F0(n,i){return n=Ia(22,n,null,i),n.lanes=0,n}function vh(n,i,o){return Ti(i,n.child,null,o),n=xh(i,i.pendingProps.children),n.flags|=2,i.memoizedState=null,n}function np(n,i,o){n.lanes|=i;var f=n.alternate;f!==null&&(f.lanes|=i),Ff(n.return,i,o)}function yh(n,i,o,f,m,p){var E=n.memoizedState;E===null?n.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:f,tail:o,tailMode:m,treeForkCount:p}:(E.isBackwards=i,E.rendering=null,E.renderingStartTime=0,E.last=f,E.tail=o,E.tailMode=m,E.treeForkCount=p)}function sp(n,i,o){var f=i.pendingProps,m=f.revealOrder,p=f.tail;f=f.children;var E=br.current,O=(E&2)!==0;if(O?(E=E&1|2,i.flags|=128):E&=1,U(br,E),Qr(n,i,f,o),f=Ot?Co:0,!O&&n!==null&&(n.flags&128)!==0)e:for(n=i.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&np(n,o,i);else if(n.tag===19)np(n,o,i);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===i)break e;for(;n.sibling===null;){if(n.return===null||n.return===i)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}switch(m){case"forwards":for(o=i.child,m=null;o!==null;)n=o.alternate,n!==null&&w0(n)===null&&(m=o),o=o.sibling;o=m,o===null?(m=i.child,i.child=null):(m=o.sibling,o.sibling=null),yh(i,!1,m,o,p,f);break;case"backwards":case"unstable_legacy-backwards":for(o=null,m=i.child,i.child=null;m!==null;){if(n=m.alternate,n!==null&&w0(n)===null){i.child=m;break}n=m.sibling,m.sibling=o,o=m,m=n}yh(i,!0,o,null,p,f);break;case"together":yh(i,!1,null,null,void 0,f);break;default:i.memoizedState=null}return i.child}function ts(n,i,o){if(n!==null&&(i.dependencies=n.dependencies),Bs|=i.lanes,(o&i.childLanes)===0)if(n!==null){if(xl(n,i,o,!1),(o&i.childLanes)===0)return null}else return null;if(n!==null&&i.child!==n.child)throw Error(a(153));if(i.child!==null){for(n=i.child,o=Kn(n,n.pendingProps),i.child=o,o.return=i;n.sibling!==null;)n=n.sibling,o=o.sibling=Kn(n,n.pendingProps),o.return=i;o.sibling=null}return i.child}function _h(n,i){return(n.lanes&i)!==0?!0:(n=n.dependencies,!!(n!==null&&d0(n)))}function xb(n,i,o){switch(i.tag){case 3:Ee(i,i.stateNode.containerInfo),Cs(i,Cr,n.memoizedState.cache),yi();break;case 27:case 5:Te(i);break;case 4:Ee(i,i.stateNode.containerInfo);break;case 10:Cs(i,i.type,i.memoizedProps.value);break;case 31:if(i.memoizedState!==null)return i.flags|=128,Gf(i),null;break;case 13:var f=i.memoizedState;if(f!==null)return f.dehydrated!==null?(Ds(i),i.flags|=128,null):(o&i.child.childLanes)!==0?ap(n,i,o):(Ds(i),n=ts(n,i,o),n!==null?n.sibling:null);Ds(i);break;case 19:var m=(n.flags&128)!==0;if(f=(o&i.childLanes)!==0,f||(xl(n,i,o,!1),f=(o&i.childLanes)!==0),m){if(f)return sp(n,i,o);i.flags|=128}if(m=i.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),U(br,br.current),f)break;return null;case 22:return i.lanes=0,Jg(n,i,o,i.pendingProps);case 24:Cs(i,Cr,n.memoizedState.cache)}return ts(n,i,o)}function ip(n,i,o){if(n!==null)if(n.memoizedProps!==i.pendingProps)Or=!0;else{if(!_h(n,o)&&(i.flags&128)===0)return Or=!1,xb(n,i,o);Or=(n.flags&131072)!==0}else Or=!1,Ot&&(i.flags&1048576)!==0&&j1(i,Co,i.index);switch(i.lanes=0,i.tag){case 16:e:{var f=i.pendingProps;if(n=Si(i.elementType),i.type=n,typeof n=="function")Tf(n)?(f=Ai(n,f),i.tag=1,i=tp(null,i,n,f,o)):(i.tag=0,i=dh(null,i,n,f,o));else{if(n!=null){var m=n.$$typeof;if(m===j){i.tag=11,i=Wg(null,i,n,f,o);break e}else if(m===A){i.tag=14,i=Kg(null,i,n,f,o);break e}}throw i=Re(n)||n,Error(a(306,i,""))}}return i;case 0:return dh(n,i,i.type,i.pendingProps,o);case 1:return f=i.type,m=Ai(f,i.pendingProps),tp(n,i,f,m,o);case 3:e:{if(Ee(i,i.stateNode.containerInfo),n===null)throw Error(a(387));f=i.pendingProps;var p=i.memoizedState;m=p.element,Pf(n,i),Bo(i,f,null,o);var E=i.memoizedState;if(f=E.cache,Cs(i,Cr,f),f!==p.cache&&Mf(i,[Cr],o,!0),Lo(),f=E.element,p.isDehydrated)if(p={element:f,isDehydrated:!1,cache:E.cache},i.updateQueue.baseState=p,i.memoizedState=p,i.flags&256){i=rp(n,i,f,o);break e}else if(f!==m){m=en(Error(a(424)),i),No(m),i=rp(n,i,f,o);break e}else for(n=i.stateNode.containerInfo,n.nodeType===9?n=n.body:n=n.nodeName==="HTML"?n.ownerDocument.body:n,ar=sn(n.firstChild),Yr=i,Ot=!0,ks=null,an=!0,o=J1(i,null,f,o),i.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(yi(),f===m){i=ts(n,i,o);break e}Qr(n,i,f,o)}i=i.child}return i;case 26:return D0(n,i),n===null?(o=xx(i.type,null,i.pendingProps,null))?i.memoizedState=o:Ot||(o=i.type,n=i.pendingProps,f=K0(te.current).createElement(o),f[F]=i,f[B]=n,Zr(f,o,n),Qe(f),i.stateNode=f):i.memoizedState=xx(i.type,n.memoizedProps,i.pendingProps,n.memoizedState),null;case 27:return Te(i),n===null&&Ot&&(f=i.stateNode=mx(i.type,i.pendingProps,te.current),Yr=i,an=!0,m=ar,zs(i.type)?(Zh=m,ar=sn(f.firstChild)):ar=m),Qr(n,i,i.pendingProps.children,o),D0(n,i),n===null&&(i.flags|=4194304),i.child;case 5:return n===null&&Ot&&((m=f=ar)&&(f=Xb(f,i.type,i.pendingProps,an),f!==null?(i.stateNode=f,Yr=i,ar=sn(f.firstChild),an=!1,m=!0):m=!1),m||As(i)),Te(i),m=i.type,p=i.pendingProps,E=n!==null?n.memoizedProps:null,f=p.children,Wh(m,p)?f=null:E!==null&&Wh(m,E)&&(i.flags|=32),i.memoizedState!==null&&(m=Xf(n,i,ob,null,null,o),rc._currentValue=m),D0(n,i),Qr(n,i,f,o),i.child;case 6:return n===null&&Ot&&((n=o=ar)&&(o=Wb(o,i.pendingProps,an),o!==null?(i.stateNode=o,Yr=i,ar=null,n=!0):n=!1),n||As(i)),null;case 13:return ap(n,i,o);case 4:return Ee(i,i.stateNode.containerInfo),f=i.pendingProps,n===null?i.child=Ti(i,null,f,o):Qr(n,i,f,o),i.child;case 11:return Wg(n,i,i.type,i.pendingProps,o);case 7:return Qr(n,i,i.pendingProps,o),i.child;case 8:return Qr(n,i,i.pendingProps.children,o),i.child;case 12:return Qr(n,i,i.pendingProps.children,o),i.child;case 10:return f=i.pendingProps,Cs(i,i.type,f.value),Qr(n,i,f.children,o),i.child;case 9:return m=i.type._context,f=i.pendingProps.children,wi(i),m=Jr(m),f=f(m),i.flags|=1,Qr(n,i,f,o),i.child;case 14:return Kg(n,i,i.type,i.pendingProps,o);case 15:return Yg(n,i,i.type,i.pendingProps,o);case 19:return sp(n,i,o);case 31:return pb(n,i,o);case 22:return Jg(n,i,o,i.pendingProps);case 24:return wi(i),f=Jr(Cr),n===null?(m=If(),m===null&&(m=Qt,p=Lf(),m.pooledCache=p,p.refCount++,p!==null&&(m.pooledCacheLanes|=o),m=p),i.memoizedState={parent:f,cache:m},Uf(i),Cs(i,Cr,m)):((n.lanes&o)!==0&&(Pf(n,i),Bo(i,null,null,o),Lo()),m=n.memoizedState,p=i.memoizedState,m.parent!==f?(m={parent:f,cache:f},i.memoizedState=m,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=m),Cs(i,Cr,f)):(f=p.cache,Cs(i,Cr,f),f!==m.cache&&Mf(i,[Cr],o,!0))),Qr(n,i,i.pendingProps.children,o),i.child;case 29:throw i.pendingProps}throw Error(a(156,i.tag))}function rs(n){n.flags|=4}function wh(n,i,o,f,m){if((i=(n.mode&32)!==0)&&(i=!1),i){if(n.flags|=16777216,(m&335544128)===m)if(n.stateNode.complete)n.flags|=8192;else if(Fp())n.flags|=8192;else throw Ei=x0,jf}else n.flags&=-16777217}function lp(n,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!bx(i))if(Fp())n.flags|=8192;else throw Ei=x0,jf}function M0(n,i){i!==null&&(n.flags|=4),n.flags&16384&&(i=n.tag!==22?al():536870912,n.lanes|=i,Nl|=i)}function Ho(n,i){if(!Ot)switch(n.tailMode){case"hidden":i=n.tail;for(var o=null;i!==null;)i.alternate!==null&&(o=i),i=i.sibling;o===null?n.tail=null:o.sibling=null;break;case"collapsed":o=n.tail;for(var f=null;o!==null;)o.alternate!==null&&(f=o),o=o.sibling;f===null?i||n.tail===null?n.tail=null:n.tail.sibling=null:f.sibling=null}}function nr(n){var i=n.alternate!==null&&n.alternate.child===n.child,o=0,f=0;if(i)for(var m=n.child;m!==null;)o|=m.lanes|m.childLanes,f|=m.subtreeFlags&65011712,f|=m.flags&65011712,m.return=n,m=m.sibling;else for(m=n.child;m!==null;)o|=m.lanes|m.childLanes,f|=m.subtreeFlags,f|=m.flags,m.return=n,m=m.sibling;return n.subtreeFlags|=f,n.childLanes=o,i}function vb(n,i,o){var f=i.pendingProps;switch(Nf(i),i.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return nr(i),null;case 1:return nr(i),null;case 3:return o=i.stateNode,f=null,n!==null&&(f=n.memoizedState.cache),i.memoizedState.cache!==f&&(i.flags|=2048),Qn(Cr),ve(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(n===null||n.child===null)&&(pl(i)?rs(i):n===null||n.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,Rf())),nr(i),null;case 26:var m=i.type,p=i.memoizedState;return n===null?(rs(i),p!==null?(nr(i),lp(i,p)):(nr(i),wh(i,m,null,f,o))):p?p!==n.memoizedState?(rs(i),nr(i),lp(i,p)):(nr(i),i.flags&=-16777217):(n=n.memoizedProps,n!==f&&rs(i),nr(i),wh(i,m,n,f,o)),null;case 27:if(tt(i),o=te.current,m=i.type,n!==null&&i.stateNode!=null)n.memoizedProps!==f&&rs(i);else{if(!f){if(i.stateNode===null)throw Error(a(166));return nr(i),null}n=M.current,pl(i)?P1(i):(n=mx(m,f,o),i.stateNode=n,rs(i))}return nr(i),null;case 5:if(tt(i),m=i.type,n!==null&&i.stateNode!=null)n.memoizedProps!==f&&rs(i);else{if(!f){if(i.stateNode===null)throw Error(a(166));return nr(i),null}if(p=M.current,pl(i))P1(i);else{var E=K0(te.current);switch(p){case 1:p=E.createElementNS("http://www.w3.org/2000/svg",m);break;case 2:p=E.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;default:switch(m){case"svg":p=E.createElementNS("http://www.w3.org/2000/svg",m);break;case"math":p=E.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;case"script":p=E.createElement("div"),p.innerHTML="<script><\/script>",p=p.removeChild(p.firstChild);break;case"select":p=typeof f.is=="string"?E.createElement("select",{is:f.is}):E.createElement("select"),f.multiple?p.multiple=!0:f.size&&(p.size=f.size);break;default:p=typeof f.is=="string"?E.createElement(m,{is:f.is}):E.createElement(m)}}p[F]=i,p[B]=f;e:for(E=i.child;E!==null;){if(E.tag===5||E.tag===6)p.appendChild(E.stateNode);else if(E.tag!==4&&E.tag!==27&&E.child!==null){E.child.return=E,E=E.child;continue}if(E===i)break e;for(;E.sibling===null;){if(E.return===null||E.return===i)break e;E=E.return}E.sibling.return=E.return,E=E.sibling}i.stateNode=p;e:switch(Zr(p,m,f),m){case"button":case"input":case"select":case"textarea":f=!!f.autoFocus;break e;case"img":f=!0;break e;default:f=!1}f&&rs(i)}}return nr(i),wh(i,i.type,n===null?null:n.memoizedProps,i.pendingProps,o),null;case 6:if(n&&i.stateNode!=null)n.memoizedProps!==f&&rs(i);else{if(typeof f!="string"&&i.stateNode===null)throw Error(a(166));if(n=te.current,pl(i)){if(n=i.stateNode,o=i.memoizedProps,f=null,m=Yr,m!==null)switch(m.tag){case 27:case 5:f=m.memoizedProps}n[F]=i,n=!!(n.nodeValue===o||f!==null&&f.suppressHydrationWarning===!0||ax(n.nodeValue,o)),n||As(i,!0)}else n=K0(n).createTextNode(f),n[F]=i,i.stateNode=n}return nr(i),null;case 31:if(o=i.memoizedState,n===null||n.memoizedState!==null){if(f=pl(i),o!==null){if(n===null){if(!f)throw Error(a(318));if(n=i.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(a(557));n[F]=i}else yi(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;nr(i),n=!1}else o=Rf(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=o),n=!0;if(!n)return i.flags&256?(Ua(i),i):(Ua(i),null);if((i.flags&128)!==0)throw Error(a(558))}return nr(i),null;case 13:if(f=i.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(m=pl(i),f!==null&&f.dehydrated!==null){if(n===null){if(!m)throw Error(a(318));if(m=i.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(a(317));m[F]=i}else yi(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;nr(i),m=!1}else m=Rf(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=m),m=!0;if(!m)return i.flags&256?(Ua(i),i):(Ua(i),null)}return Ua(i),(i.flags&128)!==0?(i.lanes=o,i):(o=f!==null,n=n!==null&&n.memoizedState!==null,o&&(f=i.child,m=null,f.alternate!==null&&f.alternate.memoizedState!==null&&f.alternate.memoizedState.cachePool!==null&&(m=f.alternate.memoizedState.cachePool.pool),p=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(p=f.memoizedState.cachePool.pool),p!==m&&(f.flags|=2048)),o!==n&&o&&(i.child.flags|=8192),M0(i,i.updateQueue),nr(i),null);case 4:return ve(),n===null&&$h(i.stateNode.containerInfo),nr(i),null;case 10:return Qn(i.type),nr(i),null;case 19:if(N(br),f=i.memoizedState,f===null)return nr(i),null;if(m=(i.flags&128)!==0,p=f.rendering,p===null)if(m)Ho(f,!1);else{if(xr!==0||n!==null&&(n.flags&128)!==0)for(n=i.child;n!==null;){if(p=w0(n),p!==null){for(i.flags|=128,Ho(f,!1),n=p.updateQueue,i.updateQueue=n,M0(i,n),i.subtreeFlags=0,n=o,o=i.child;o!==null;)L1(o,n),o=o.sibling;return U(br,br.current&1|2),Ot&&Yn(i,f.treeForkCount),i.child}n=n.sibling}f.tail!==null&&Et()>U0&&(i.flags|=128,m=!0,Ho(f,!1),i.lanes=4194304)}else{if(!m)if(n=w0(p),n!==null){if(i.flags|=128,m=!0,n=n.updateQueue,i.updateQueue=n,M0(i,n),Ho(f,!0),f.tail===null&&f.tailMode==="hidden"&&!p.alternate&&!Ot)return nr(i),null}else 2*Et()-f.renderingStartTime>U0&&o!==536870912&&(i.flags|=128,m=!0,Ho(f,!1),i.lanes=4194304);f.isBackwards?(p.sibling=i.child,i.child=p):(n=f.last,n!==null?n.sibling=p:i.child=p,f.last=p)}return f.tail!==null?(n=f.tail,f.rendering=n,f.tail=n.sibling,f.renderingStartTime=Et(),n.sibling=null,o=br.current,U(br,m?o&1|2:o&1),Ot&&Yn(i,f.treeForkCount),n):(nr(i),null);case 22:case 23:return Ua(i),Vf(),f=i.memoizedState!==null,n!==null?n.memoizedState!==null!==f&&(i.flags|=8192):f&&(i.flags|=8192),f?(o&536870912)!==0&&(i.flags&128)===0&&(nr(i),i.subtreeFlags&6&&(i.flags|=8192)):nr(i),o=i.updateQueue,o!==null&&M0(i,o.retryQueue),o=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),f=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(f=i.memoizedState.cachePool.pool),f!==o&&(i.flags|=2048),n!==null&&N(bi),null;case 24:return o=null,n!==null&&(o=n.memoizedState.cache),i.memoizedState.cache!==o&&(i.flags|=2048),Qn(Cr),nr(i),null;case 25:return null;case 30:return null}throw Error(a(156,i.tag))}function yb(n,i){switch(Nf(i),i.tag){case 1:return n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 3:return Qn(Cr),ve(),n=i.flags,(n&65536)!==0&&(n&128)===0?(i.flags=n&-65537|128,i):null;case 26:case 27:case 5:return tt(i),null;case 31:if(i.memoizedState!==null){if(Ua(i),i.alternate===null)throw Error(a(340));yi()}return n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 13:if(Ua(i),n=i.memoizedState,n!==null&&n.dehydrated!==null){if(i.alternate===null)throw Error(a(340));yi()}return n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 19:return N(br),null;case 4:return ve(),null;case 10:return Qn(i.type),null;case 22:case 23:return Ua(i),Vf(),n!==null&&N(bi),n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 24:return Qn(Cr),null;case 25:return null;default:return null}}function op(n,i){switch(Nf(i),i.tag){case 3:Qn(Cr),ve();break;case 26:case 27:case 5:tt(i);break;case 4:ve();break;case 31:i.memoizedState!==null&&Ua(i);break;case 13:Ua(i);break;case 19:N(br);break;case 10:Qn(i.type);break;case 22:case 23:Ua(i),Vf(),n!==null&&N(bi);break;case 24:Qn(Cr)}}function $o(n,i){try{var o=i.updateQueue,f=o!==null?o.lastEffect:null;if(f!==null){var m=f.next;o=m;do{if((o.tag&n)===n){f=void 0;var p=o.create,E=o.inst;f=p(),E.destroy=f}o=o.next}while(o!==m)}}catch(O){Pt(i,i.return,O)}}function Ms(n,i,o){try{var f=i.updateQueue,m=f!==null?f.lastEffect:null;if(m!==null){var p=m.next;f=p;do{if((f.tag&n)===n){var E=f.inst,O=E.destroy;if(O!==void 0){E.destroy=void 0,m=i;var W=o,ue=O;try{ue()}catch(we){Pt(m,W,we)}}}f=f.next}while(f!==p)}}catch(we){Pt(i,i.return,we)}}function cp(n){var i=n.updateQueue;if(i!==null){var o=n.stateNode;try{Z1(i,o)}catch(f){Pt(n,n.return,f)}}}function up(n,i,o){o.props=Ai(n.type,n.memoizedProps),o.state=n.memoizedState;try{o.componentWillUnmount()}catch(f){Pt(n,i,f)}}function Vo(n,i){try{var o=n.ref;if(o!==null){switch(n.tag){case 26:case 27:case 5:var f=n.stateNode;break;case 30:f=n.stateNode;break;default:f=n.stateNode}typeof o=="function"?n.refCleanup=o(f):o.current=f}}catch(m){Pt(n,i,m)}}function Dn(n,i){var o=n.ref,f=n.refCleanup;if(o!==null)if(typeof f=="function")try{f()}catch(m){Pt(n,i,m)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(m){Pt(n,i,m)}else o.current=null}function fp(n){var i=n.type,o=n.memoizedProps,f=n.stateNode;try{e:switch(i){case"button":case"input":case"select":case"textarea":o.autoFocus&&f.focus();break e;case"img":o.src?f.src=o.src:o.srcSet&&(f.srcset=o.srcSet)}}catch(m){Pt(n,n.return,m)}}function bh(n,i,o){try{var f=n.stateNode;zb(f,n.type,o,i),f[B]=i}catch(m){Pt(n,n.return,m)}}function hp(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&zs(n.type)||n.tag===4}function Sh(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||hp(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&zs(n.type)||n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Eh(n,i,o){var f=n.tag;if(f===5||f===6)n=n.stateNode,i?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(n,i):(i=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,i.appendChild(n),o=o._reactRootContainer,o!=null||i.onclick!==null||(i.onclick=Xn));else if(f!==4&&(f===27&&zs(n.type)&&(o=n.stateNode,i=null),n=n.child,n!==null))for(Eh(n,i,o),n=n.sibling;n!==null;)Eh(n,i,o),n=n.sibling}function L0(n,i,o){var f=n.tag;if(f===5||f===6)n=n.stateNode,i?o.insertBefore(n,i):o.appendChild(n);else if(f!==4&&(f===27&&zs(n.type)&&(o=n.stateNode),n=n.child,n!==null))for(L0(n,i,o),n=n.sibling;n!==null;)L0(n,i,o),n=n.sibling}function dp(n){var i=n.stateNode,o=n.memoizedProps;try{for(var f=n.type,m=i.attributes;m.length;)i.removeAttributeNode(m[0]);Zr(i,f,o),i[F]=n,i[B]=o}catch(p){Pt(n,n.return,p)}}var as=!1,Rr=!1,Th=!1,mp=typeof WeakSet=="function"?WeakSet:Set,Vr=null;function _b(n,i){if(n=n.containerInfo,qh=ru,n=k1(n),vf(n)){if("selectionStart"in n)var o={start:n.selectionStart,end:n.selectionEnd};else e:{o=(o=n.ownerDocument)&&o.defaultView||window;var f=o.getSelection&&o.getSelection();if(f&&f.rangeCount!==0){o=f.anchorNode;var m=f.anchorOffset,p=f.focusNode;f=f.focusOffset;try{o.nodeType,p.nodeType}catch{o=null;break e}var E=0,O=-1,W=-1,ue=0,we=0,ke=n,de=null;t:for(;;){for(var ge;ke!==o||m!==0&&ke.nodeType!==3||(O=E+m),ke!==p||f!==0&&ke.nodeType!==3||(W=E+f),ke.nodeType===3&&(E+=ke.nodeValue.length),(ge=ke.firstChild)!==null;)de=ke,ke=ge;for(;;){if(ke===n)break t;if(de===o&&++ue===m&&(O=E),de===p&&++we===f&&(W=E),(ge=ke.nextSibling)!==null)break;ke=de,de=ke.parentNode}ke=ge}o=O===-1||W===-1?null:{start:O,end:W}}else o=null}o=o||{start:0,end:0}}else o=null;for(Xh={focusedElem:n,selectionRange:o},ru=!1,Vr=i;Vr!==null;)if(i=Vr,n=i.child,(i.subtreeFlags&1028)!==0&&n!==null)n.return=i,Vr=n;else for(;Vr!==null;){switch(i=Vr,p=i.alternate,n=i.flags,i.tag){case 0:if((n&4)!==0&&(n=i.updateQueue,n=n!==null?n.events:null,n!==null))for(o=0;o<n.length;o++)m=n[o],m.ref.impl=m.nextImpl;break;case 11:case 15:break;case 1:if((n&1024)!==0&&p!==null){n=void 0,o=i,m=p.memoizedProps,p=p.memoizedState,f=o.stateNode;try{var Je=Ai(o.type,m);n=f.getSnapshotBeforeUpdate(Je,p),f.__reactInternalSnapshotBeforeUpdate=n}catch(ot){Pt(o,o.return,ot)}}break;case 3:if((n&1024)!==0){if(n=i.stateNode.containerInfo,o=n.nodeType,o===9)Yh(n);else if(o===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":Yh(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(a(163))}if(n=i.sibling,n!==null){n.return=i.return,Vr=n;break}Vr=i.return}}function gp(n,i,o){var f=o.flags;switch(o.tag){case 0:case 11:case 15:ss(n,o),f&4&&$o(5,o);break;case 1:if(ss(n,o),f&4)if(n=o.stateNode,i===null)try{n.componentDidMount()}catch(E){Pt(o,o.return,E)}else{var m=Ai(o.type,i.memoizedProps);i=i.memoizedState;try{n.componentDidUpdate(m,i,n.__reactInternalSnapshotBeforeUpdate)}catch(E){Pt(o,o.return,E)}}f&64&&cp(o),f&512&&Vo(o,o.return);break;case 3:if(ss(n,o),f&64&&(n=o.updateQueue,n!==null)){if(i=null,o.child!==null)switch(o.child.tag){case 27:case 5:i=o.child.stateNode;break;case 1:i=o.child.stateNode}try{Z1(n,i)}catch(E){Pt(o,o.return,E)}}break;case 27:i===null&&f&4&&dp(o);case 26:case 5:ss(n,o),i===null&&f&4&&fp(o),f&512&&Vo(o,o.return);break;case 12:ss(n,o);break;case 31:ss(n,o),f&4&&vp(n,o);break;case 13:ss(n,o),f&4&&yp(n,o),f&64&&(n=o.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(o=Nb.bind(null,o),Kb(n,o))));break;case 22:if(f=o.memoizedState!==null||as,!f){i=i!==null&&i.memoizedState!==null||Rr,m=as;var p=Rr;as=f,(Rr=i)&&!p?is(n,o,(o.subtreeFlags&8772)!==0):ss(n,o),as=m,Rr=p}break;case 30:break;default:ss(n,o)}}function pp(n){var i=n.alternate;i!==null&&(n.alternate=null,pp(i)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(i=n.stateNode,i!==null&&Ne(i)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var ur=null,Ta=!1;function ns(n,i,o){for(o=o.child;o!==null;)xp(n,i,o),o=o.sibling}function xp(n,i,o){if(er&&typeof er.onCommitFiberUnmount=="function")try{er.onCommitFiberUnmount(Vt,o)}catch{}switch(o.tag){case 26:Rr||Dn(o,i),ns(n,i,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:Rr||Dn(o,i);var f=ur,m=Ta;zs(o.type)&&(ur=o.stateNode,Ta=!1),ns(n,i,o),Zo(o.stateNode),ur=f,Ta=m;break;case 5:Rr||Dn(o,i);case 6:if(f=ur,m=Ta,ur=null,ns(n,i,o),ur=f,Ta=m,ur!==null)if(Ta)try{(ur.nodeType===9?ur.body:ur.nodeName==="HTML"?ur.ownerDocument.body:ur).removeChild(o.stateNode)}catch(p){Pt(o,i,p)}else try{ur.removeChild(o.stateNode)}catch(p){Pt(o,i,p)}break;case 18:ur!==null&&(Ta?(n=ur,cx(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,o.stateNode),Il(n)):cx(ur,o.stateNode));break;case 4:f=ur,m=Ta,ur=o.stateNode.containerInfo,Ta=!0,ns(n,i,o),ur=f,Ta=m;break;case 0:case 11:case 14:case 15:Ms(2,o,i),Rr||Ms(4,o,i),ns(n,i,o);break;case 1:Rr||(Dn(o,i),f=o.stateNode,typeof f.componentWillUnmount=="function"&&up(o,i,f)),ns(n,i,o);break;case 21:ns(n,i,o);break;case 22:Rr=(f=Rr)||o.memoizedState!==null,ns(n,i,o),Rr=f;break;default:ns(n,i,o)}}function vp(n,i){if(i.memoizedState===null&&(n=i.alternate,n!==null&&(n=n.memoizedState,n!==null))){n=n.dehydrated;try{Il(n)}catch(o){Pt(i,i.return,o)}}}function yp(n,i){if(i.memoizedState===null&&(n=i.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{Il(n)}catch(o){Pt(i,i.return,o)}}function wb(n){switch(n.tag){case 31:case 13:case 19:var i=n.stateNode;return i===null&&(i=n.stateNode=new mp),i;case 22:return n=n.stateNode,i=n._retryCache,i===null&&(i=n._retryCache=new mp),i;default:throw Error(a(435,n.tag))}}function B0(n,i){var o=wb(n);i.forEach(function(f){if(!o.has(f)){o.add(f);var m=Ob.bind(null,n,f);f.then(m,m)}})}function ka(n,i){var o=i.deletions;if(o!==null)for(var f=0;f<o.length;f++){var m=o[f],p=n,E=i,O=E;e:for(;O!==null;){switch(O.tag){case 27:if(zs(O.type)){ur=O.stateNode,Ta=!1;break e}break;case 5:ur=O.stateNode,Ta=!1;break e;case 3:case 4:ur=O.stateNode.containerInfo,Ta=!0;break e}O=O.return}if(ur===null)throw Error(a(160));xp(p,E,m),ur=null,Ta=!1,p=m.alternate,p!==null&&(p.return=null),m.return=null}if(i.subtreeFlags&13886)for(i=i.child;i!==null;)_p(i,n),i=i.sibling}var yn=null;function _p(n,i){var o=n.alternate,f=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:ka(i,n),Aa(n),f&4&&(Ms(3,n,n.return),$o(3,n),Ms(5,n,n.return));break;case 1:ka(i,n),Aa(n),f&512&&(Rr||o===null||Dn(o,o.return)),f&64&&as&&(n=n.updateQueue,n!==null&&(f=n.callbacks,f!==null&&(o=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=o===null?f:o.concat(f))));break;case 26:var m=yn;if(ka(i,n),Aa(n),f&512&&(Rr||o===null||Dn(o,o.return)),f&4){var p=o!==null?o.memoizedState:null;if(f=n.memoizedState,o===null)if(f===null)if(n.stateNode===null){e:{f=n.type,o=n.memoizedProps,m=m.ownerDocument||m;t:switch(f){case"title":p=m.getElementsByTagName("title")[0],(!p||p[he]||p[F]||p.namespaceURI==="http://www.w3.org/2000/svg"||p.hasAttribute("itemprop"))&&(p=m.createElement(f),m.head.insertBefore(p,m.querySelector("head > title"))),Zr(p,f,o),p[F]=n,Qe(p),f=p;break e;case"link":var E=_x("link","href",m).get(f+(o.href||""));if(E){for(var O=0;O<E.length;O++)if(p=E[O],p.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&p.getAttribute("rel")===(o.rel==null?null:o.rel)&&p.getAttribute("title")===(o.title==null?null:o.title)&&p.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){E.splice(O,1);break t}}p=m.createElement(f),Zr(p,f,o),m.head.appendChild(p);break;case"meta":if(E=_x("meta","content",m).get(f+(o.content||""))){for(O=0;O<E.length;O++)if(p=E[O],p.getAttribute("content")===(o.content==null?null:""+o.content)&&p.getAttribute("name")===(o.name==null?null:o.name)&&p.getAttribute("property")===(o.property==null?null:o.property)&&p.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&p.getAttribute("charset")===(o.charSet==null?null:o.charSet)){E.splice(O,1);break t}}p=m.createElement(f),Zr(p,f,o),m.head.appendChild(p);break;default:throw Error(a(468,f))}p[F]=n,Qe(p),f=p}n.stateNode=f}else wx(m,n.type,n.stateNode);else n.stateNode=yx(m,f,n.memoizedProps);else p!==f?(p===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):p.count--,f===null?wx(m,n.type,n.stateNode):yx(m,f,n.memoizedProps)):f===null&&n.stateNode!==null&&bh(n,n.memoizedProps,o.memoizedProps)}break;case 27:ka(i,n),Aa(n),f&512&&(Rr||o===null||Dn(o,o.return)),o!==null&&f&4&&bh(n,n.memoizedProps,o.memoizedProps);break;case 5:if(ka(i,n),Aa(n),f&512&&(Rr||o===null||Dn(o,o.return)),n.flags&32){m=n.stateNode;try{pt(m,"")}catch(Je){Pt(n,n.return,Je)}}f&4&&n.stateNode!=null&&(m=n.memoizedProps,bh(n,m,o!==null?o.memoizedProps:m)),f&1024&&(Th=!0);break;case 6:if(ka(i,n),Aa(n),f&4){if(n.stateNode===null)throw Error(a(162));f=n.memoizedProps,o=n.stateNode;try{o.nodeValue=f}catch(Je){Pt(n,n.return,Je)}}break;case 3:if(Q0=null,m=yn,yn=Y0(i.containerInfo),ka(i,n),yn=m,Aa(n),f&4&&o!==null&&o.memoizedState.isDehydrated)try{Il(i.containerInfo)}catch(Je){Pt(n,n.return,Je)}Th&&(Th=!1,wp(n));break;case 4:f=yn,yn=Y0(n.stateNode.containerInfo),ka(i,n),Aa(n),yn=f;break;case 12:ka(i,n),Aa(n);break;case 31:ka(i,n),Aa(n),f&4&&(f=n.updateQueue,f!==null&&(n.updateQueue=null,B0(n,f)));break;case 13:ka(i,n),Aa(n),n.child.flags&8192&&n.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(j0=Et()),f&4&&(f=n.updateQueue,f!==null&&(n.updateQueue=null,B0(n,f)));break;case 22:m=n.memoizedState!==null;var W=o!==null&&o.memoizedState!==null,ue=as,we=Rr;if(as=ue||m,Rr=we||W,ka(i,n),Rr=we,as=ue,Aa(n),f&8192)e:for(i=n.stateNode,i._visibility=m?i._visibility&-2:i._visibility|1,m&&(o===null||W||as||Rr||Ci(n)),o=null,i=n;;){if(i.tag===5||i.tag===26){if(o===null){W=o=i;try{if(p=W.stateNode,m)E=p.style,typeof E.setProperty=="function"?E.setProperty("display","none","important"):E.display="none";else{O=W.stateNode;var ke=W.memoizedProps.style,de=ke!=null&&ke.hasOwnProperty("display")?ke.display:null;O.style.display=de==null||typeof de=="boolean"?"":(""+de).trim()}}catch(Je){Pt(W,W.return,Je)}}}else if(i.tag===6){if(o===null){W=i;try{W.stateNode.nodeValue=m?"":W.memoizedProps}catch(Je){Pt(W,W.return,Je)}}}else if(i.tag===18){if(o===null){W=i;try{var ge=W.stateNode;m?ux(ge,!0):ux(W.stateNode,!1)}catch(Je){Pt(W,W.return,Je)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===n)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===n)break e;for(;i.sibling===null;){if(i.return===null||i.return===n)break e;o===i&&(o=null),i=i.return}o===i&&(o=null),i.sibling.return=i.return,i=i.sibling}f&4&&(f=n.updateQueue,f!==null&&(o=f.retryQueue,o!==null&&(f.retryQueue=null,B0(n,o))));break;case 19:ka(i,n),Aa(n),f&4&&(f=n.updateQueue,f!==null&&(n.updateQueue=null,B0(n,f)));break;case 30:break;case 21:break;default:ka(i,n),Aa(n)}}function Aa(n){var i=n.flags;if(i&2){try{for(var o,f=n.return;f!==null;){if(hp(f)){o=f;break}f=f.return}if(o==null)throw Error(a(160));switch(o.tag){case 27:var m=o.stateNode,p=Sh(n);L0(n,p,m);break;case 5:var E=o.stateNode;o.flags&32&&(pt(E,""),o.flags&=-33);var O=Sh(n);L0(n,O,E);break;case 3:case 4:var W=o.stateNode.containerInfo,ue=Sh(n);Eh(n,ue,W);break;default:throw Error(a(161))}}catch(we){Pt(n,n.return,we)}n.flags&=-3}i&4096&&(n.flags&=-4097)}function wp(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var i=n;wp(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),n=n.sibling}}function ss(n,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)gp(n,i.alternate,i),i=i.sibling}function Ci(n){for(n=n.child;n!==null;){var i=n;switch(i.tag){case 0:case 11:case 14:case 15:Ms(4,i,i.return),Ci(i);break;case 1:Dn(i,i.return);var o=i.stateNode;typeof o.componentWillUnmount=="function"&&up(i,i.return,o),Ci(i);break;case 27:Zo(i.stateNode);case 26:case 5:Dn(i,i.return),Ci(i);break;case 22:i.memoizedState===null&&Ci(i);break;case 30:Ci(i);break;default:Ci(i)}n=n.sibling}}function is(n,i,o){for(o=o&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var f=i.alternate,m=n,p=i,E=p.flags;switch(p.tag){case 0:case 11:case 15:is(m,p,o),$o(4,p);break;case 1:if(is(m,p,o),f=p,m=f.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch(ue){Pt(f,f.return,ue)}if(f=p,m=f.updateQueue,m!==null){var O=f.stateNode;try{var W=m.shared.hiddenCallbacks;if(W!==null)for(m.shared.hiddenCallbacks=null,m=0;m<W.length;m++)Q1(W[m],O)}catch(ue){Pt(f,f.return,ue)}}o&&E&64&&cp(p),Vo(p,p.return);break;case 27:dp(p);case 26:case 5:is(m,p,o),o&&f===null&&E&4&&fp(p),Vo(p,p.return);break;case 12:is(m,p,o);break;case 31:is(m,p,o),o&&E&4&&vp(m,p);break;case 13:is(m,p,o),o&&E&4&&yp(m,p);break;case 22:p.memoizedState===null&&is(m,p,o),Vo(p,p.return);break;case 30:break;default:is(m,p,o)}i=i.sibling}}function kh(n,i){var o=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),n=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(n=i.memoizedState.cachePool.pool),n!==o&&(n!=null&&n.refCount++,o!=null&&Oo(o))}function Ah(n,i){n=null,i.alternate!==null&&(n=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==n&&(i.refCount++,n!=null&&Oo(n))}function _n(n,i,o,f){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)bp(n,i,o,f),i=i.sibling}function bp(n,i,o,f){var m=i.flags;switch(i.tag){case 0:case 11:case 15:_n(n,i,o,f),m&2048&&$o(9,i);break;case 1:_n(n,i,o,f);break;case 3:_n(n,i,o,f),m&2048&&(n=null,i.alternate!==null&&(n=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==n&&(i.refCount++,n!=null&&Oo(n)));break;case 12:if(m&2048){_n(n,i,o,f),n=i.stateNode;try{var p=i.memoizedProps,E=p.id,O=p.onPostCommit;typeof O=="function"&&O(E,i.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(W){Pt(i,i.return,W)}}else _n(n,i,o,f);break;case 31:_n(n,i,o,f);break;case 13:_n(n,i,o,f);break;case 23:break;case 22:p=i.stateNode,E=i.alternate,i.memoizedState!==null?p._visibility&2?_n(n,i,o,f):Go(n,i):p._visibility&2?_n(n,i,o,f):(p._visibility|=2,kl(n,i,o,f,(i.subtreeFlags&10256)!==0||!1)),m&2048&&kh(E,i);break;case 24:_n(n,i,o,f),m&2048&&Ah(i.alternate,i);break;default:_n(n,i,o,f)}}function kl(n,i,o,f,m){for(m=m&&((i.subtreeFlags&10256)!==0||!1),i=i.child;i!==null;){var p=n,E=i,O=o,W=f,ue=E.flags;switch(E.tag){case 0:case 11:case 15:kl(p,E,O,W,m),$o(8,E);break;case 23:break;case 22:var we=E.stateNode;E.memoizedState!==null?we._visibility&2?kl(p,E,O,W,m):Go(p,E):(we._visibility|=2,kl(p,E,O,W,m)),m&&ue&2048&&kh(E.alternate,E);break;case 24:kl(p,E,O,W,m),m&&ue&2048&&Ah(E.alternate,E);break;default:kl(p,E,O,W,m)}i=i.sibling}}function Go(n,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var o=n,f=i,m=f.flags;switch(f.tag){case 22:Go(o,f),m&2048&&kh(f.alternate,f);break;case 24:Go(o,f),m&2048&&Ah(f.alternate,f);break;default:Go(o,f)}i=i.sibling}}var qo=8192;function Al(n,i,o){if(n.subtreeFlags&qo)for(n=n.child;n!==null;)Sp(n,i,o),n=n.sibling}function Sp(n,i,o){switch(n.tag){case 26:Al(n,i,o),n.flags&qo&&n.memoizedState!==null&&lS(o,yn,n.memoizedState,n.memoizedProps);break;case 5:Al(n,i,o);break;case 3:case 4:var f=yn;yn=Y0(n.stateNode.containerInfo),Al(n,i,o),yn=f;break;case 22:n.memoizedState===null&&(f=n.alternate,f!==null&&f.memoizedState!==null?(f=qo,qo=16777216,Al(n,i,o),qo=f):Al(n,i,o));break;default:Al(n,i,o)}}function Ep(n){var i=n.alternate;if(i!==null&&(n=i.child,n!==null)){i.child=null;do i=n.sibling,n.sibling=null,n=i;while(n!==null)}}function Xo(n){var i=n.deletions;if((n.flags&16)!==0){if(i!==null)for(var o=0;o<i.length;o++){var f=i[o];Vr=f,kp(f,n)}Ep(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)Tp(n),n=n.sibling}function Tp(n){switch(n.tag){case 0:case 11:case 15:Xo(n),n.flags&2048&&Ms(9,n,n.return);break;case 3:Xo(n);break;case 12:Xo(n);break;case 22:var i=n.stateNode;n.memoizedState!==null&&i._visibility&2&&(n.return===null||n.return.tag!==13)?(i._visibility&=-3,I0(n)):Xo(n);break;default:Xo(n)}}function I0(n){var i=n.deletions;if((n.flags&16)!==0){if(i!==null)for(var o=0;o<i.length;o++){var f=i[o];Vr=f,kp(f,n)}Ep(n)}for(n=n.child;n!==null;){switch(i=n,i.tag){case 0:case 11:case 15:Ms(8,i,i.return),I0(i);break;case 22:o=i.stateNode,o._visibility&2&&(o._visibility&=-3,I0(i));break;default:I0(i)}n=n.sibling}}function kp(n,i){for(;Vr!==null;){var o=Vr;switch(o.tag){case 0:case 11:case 15:Ms(8,o,i);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var f=o.memoizedState.cachePool.pool;f!=null&&f.refCount++}break;case 24:Oo(o.memoizedState.cache)}if(f=o.child,f!==null)f.return=o,Vr=f;else e:for(o=n;Vr!==null;){f=Vr;var m=f.sibling,p=f.return;if(pp(f),f===o){Vr=null;break e}if(m!==null){m.return=p,Vr=m;break e}Vr=p}}}var bb={getCacheForType:function(n){var i=Jr(Cr),o=i.data.get(n);return o===void 0&&(o=n(),i.data.set(n,o)),o},cacheSignal:function(){return Jr(Cr).controller.signal}},Sb=typeof WeakMap=="function"?WeakMap:Map,jt=0,Qt=null,Tt=null,Ct=0,Ut=0,Pa=null,Ls=!1,Cl=!1,Ch=!1,ls=0,xr=0,Bs=0,Ni=0,Nh=0,za=0,Nl=0,Wo=null,Ca=null,Oh=!1,j0=0,Ap=0,U0=1/0,P0=null,Is=null,jr=0,js=null,Ol=null,os=0,Rh=0,Dh=null,Cp=null,Ko=0,Fh=null;function Ha(){return(jt&2)!==0&&Ct!==0?Ct&-Ct:V.T!==null?Uh():C()}function Np(){if(za===0)if((Ct&536870912)===0||Ot){var n=_s;_s<<=1,(_s&3932160)===0&&(_s=262144),za=n}else za=536870912;return n=ja.current,n!==null&&(n.flags|=32),za}function Na(n,i,o){(n===Qt&&(Ut===2||Ut===9)||n.cancelPendingCommit!==null)&&(Rl(n,0),Us(n,Ct,za,!1)),Vn(n,o),((jt&2)===0||n!==Qt)&&(n===Qt&&((jt&2)===0&&(Ni|=o),xr===4&&Us(n,Ct,za,!1)),Fn(n))}function Op(n,i,o){if((jt&6)!==0)throw Error(a(327));var f=!o&&(i&127)===0&&(i&n.expiredLanes)===0||$n(n,i),m=f?kb(n,i):Lh(n,i,!0),p=f;do{if(m===0){Cl&&!f&&Us(n,i,0,!1);break}else{if(o=n.current.alternate,p&&!Eb(o)){m=Lh(n,i,!1),p=!1;continue}if(m===2){if(p=i,n.errorRecoveryDisabledLanes&p)var E=0;else E=n.pendingLanes&-536870913,E=E!==0?E:E&536870912?536870912:0;if(E!==0){i=E;e:{var O=n;m=Wo;var W=O.current.memoizedState.isDehydrated;if(W&&(Rl(O,E).flags|=256),E=Lh(O,E,!1),E!==2){if(Ch&&!W){O.errorRecoveryDisabledLanes|=p,Ni|=p,m=4;break e}p=Ca,Ca=m,p!==null&&(Ca===null?Ca=p:Ca.push.apply(Ca,p))}m=E}if(p=!1,m!==2)continue}}if(m===1){Rl(n,0),Us(n,i,0,!0);break}e:{switch(f=n,p=m,p){case 0:case 1:throw Error(a(345));case 4:if((i&4194048)!==i)break;case 6:Us(f,i,za,!Ls);break e;case 2:Ca=null;break;case 3:case 5:break;default:throw Error(a(329))}if((i&62914560)===i&&(m=j0+300-Et(),10<m)){if(Us(f,i,za,!Ls),bs(f,0,!0)!==0)break e;os=i,f.timeoutHandle=lx(Rp.bind(null,f,o,Ca,P0,Oh,i,za,Ni,Nl,Ls,p,"Throttled",-0,0),m);break e}Rp(f,o,Ca,P0,Oh,i,za,Ni,Nl,Ls,p,null,-0,0)}}break}while(!0);Fn(n)}function Rp(n,i,o,f,m,p,E,O,W,ue,we,ke,de,ge){if(n.timeoutHandle=-1,ke=i.subtreeFlags,ke&8192||(ke&16785408)===16785408){ke={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Xn},Sp(i,p,ke);var Je=(p&62914560)===p?j0-Et():(p&4194048)===p?Ap-Et():0;if(Je=oS(ke,Je),Je!==null){os=p,n.cancelPendingCommit=Je(Up.bind(null,n,i,p,o,f,m,E,O,W,we,ke,null,de,ge)),Us(n,p,E,!ue);return}}Up(n,i,p,o,f,m,E,O,W)}function Eb(n){for(var i=n;;){var o=i.tag;if((o===0||o===11||o===15)&&i.flags&16384&&(o=i.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var f=0;f<o.length;f++){var m=o[f],p=m.getSnapshot;m=m.value;try{if(!Ba(p(),m))return!1}catch{return!1}}if(o=i.child,i.subtreeFlags&16384&&o!==null)o.return=i,i=o;else{if(i===n)break;for(;i.sibling===null;){if(i.return===null||i.return===n)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function Us(n,i,o,f){i&=~Nh,i&=~Ni,n.suspendedLanes|=i,n.pingedLanes&=~i,f&&(n.warmLanes|=i),f=n.expirationTimes;for(var m=i;0<m;){var p=31-cr(m),E=1<<p;f[p]=-1,m&=~E}o!==0&&nl(n,o,i)}function z0(){return(jt&6)===0?(Yo(0),!1):!0}function Mh(){if(Tt!==null){if(Ut===0)var n=Tt.return;else n=Tt,Jn=_i=null,Yf(n),wl=null,Do=0,n=Tt;for(;n!==null;)op(n.alternate,n),n=n.return;Tt=null}}function Rl(n,i){var o=n.timeoutHandle;o!==-1&&(n.timeoutHandle=-1,Vb(o)),o=n.cancelPendingCommit,o!==null&&(n.cancelPendingCommit=null,o()),os=0,Mh(),Qt=n,Tt=o=Kn(n.current,null),Ct=i,Ut=0,Pa=null,Ls=!1,Cl=$n(n,i),Ch=!1,Nl=za=Nh=Ni=Bs=xr=0,Ca=Wo=null,Oh=!1,(i&8)!==0&&(i|=i&32);var f=n.entangledLanes;if(f!==0)for(n=n.entanglements,f&=i;0<f;){var m=31-cr(f),p=1<<m;i|=n[m],f&=~p}return ls=i,o0(),o}function Dp(n,i){xt=null,V.H=Po,i===_l||i===p0?(i=W1(),Ut=3):i===jf?(i=W1(),Ut=4):Ut=i===hh?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,Pa=i,Tt===null&&(xr=1,O0(n,en(i,n.current)))}function Fp(){var n=ja.current;return n===null?!0:(Ct&4194048)===Ct?nn===null:(Ct&62914560)===Ct||(Ct&536870912)!==0?n===nn:!1}function Mp(){var n=V.H;return V.H=Po,n===null?Po:n}function Lp(){var n=V.A;return V.A=bb,n}function H0(){xr=4,Ls||(Ct&4194048)!==Ct&&ja.current!==null||(Cl=!0),(Bs&134217727)===0&&(Ni&134217727)===0||Qt===null||Us(Qt,Ct,za,!1)}function Lh(n,i,o){var f=jt;jt|=2;var m=Mp(),p=Lp();(Qt!==n||Ct!==i)&&(P0=null,Rl(n,i)),i=!1;var E=xr;e:do try{if(Ut!==0&&Tt!==null){var O=Tt,W=Pa;switch(Ut){case 8:Mh(),E=6;break e;case 3:case 2:case 9:case 6:ja.current===null&&(i=!0);var ue=Ut;if(Ut=0,Pa=null,Dl(n,O,W,ue),o&&Cl){E=0;break e}break;default:ue=Ut,Ut=0,Pa=null,Dl(n,O,W,ue)}}Tb(),E=xr;break}catch(we){Dp(n,we)}while(!0);return i&&n.shellSuspendCounter++,Jn=_i=null,jt=f,V.H=m,V.A=p,Tt===null&&(Qt=null,Ct=0,o0()),E}function Tb(){for(;Tt!==null;)Bp(Tt)}function kb(n,i){var o=jt;jt|=2;var f=Mp(),m=Lp();Qt!==n||Ct!==i?(P0=null,U0=Et()+500,Rl(n,i)):Cl=$n(n,i);e:do try{if(Ut!==0&&Tt!==null){i=Tt;var p=Pa;t:switch(Ut){case 1:Ut=0,Pa=null,Dl(n,i,p,1);break;case 2:case 9:if(q1(p)){Ut=0,Pa=null,Ip(i);break}i=function(){Ut!==2&&Ut!==9||Qt!==n||(Ut=7),Fn(n)},p.then(i,i);break e;case 3:Ut=7;break e;case 4:Ut=5;break e;case 7:q1(p)?(Ut=0,Pa=null,Ip(i)):(Ut=0,Pa=null,Dl(n,i,p,7));break;case 5:var E=null;switch(Tt.tag){case 26:E=Tt.memoizedState;case 5:case 27:var O=Tt;if(E?bx(E):O.stateNode.complete){Ut=0,Pa=null;var W=O.sibling;if(W!==null)Tt=W;else{var ue=O.return;ue!==null?(Tt=ue,$0(ue)):Tt=null}break t}}Ut=0,Pa=null,Dl(n,i,p,5);break;case 6:Ut=0,Pa=null,Dl(n,i,p,6);break;case 8:Mh(),xr=6;break e;default:throw Error(a(462))}}Ab();break}catch(we){Dp(n,we)}while(!0);return Jn=_i=null,V.H=f,V.A=m,jt=o,Tt!==null?0:(Qt=null,Ct=0,o0(),xr)}function Ab(){for(;Tt!==null&&!zn();)Bp(Tt)}function Bp(n){var i=ip(n.alternate,n,ls);n.memoizedProps=n.pendingProps,i===null?$0(n):Tt=i}function Ip(n){var i=n,o=i.alternate;switch(i.tag){case 15:case 0:i=ep(o,i,i.pendingProps,i.type,void 0,Ct);break;case 11:i=ep(o,i,i.pendingProps,i.type.render,i.ref,Ct);break;case 5:Yf(i);default:op(o,i),i=Tt=L1(i,ls),i=ip(o,i,ls)}n.memoizedProps=n.pendingProps,i===null?$0(n):Tt=i}function Dl(n,i,o,f){Jn=_i=null,Yf(i),wl=null,Do=0;var m=i.return;try{if(gb(n,m,i,o,Ct)){xr=1,O0(n,en(o,n.current)),Tt=null;return}}catch(p){if(m!==null)throw Tt=m,p;xr=1,O0(n,en(o,n.current)),Tt=null;return}i.flags&32768?(Ot||f===1?n=!0:Cl||(Ct&536870912)!==0?n=!1:(Ls=n=!0,(f===2||f===9||f===3||f===6)&&(f=ja.current,f!==null&&f.tag===13&&(f.flags|=16384))),jp(i,n)):$0(i)}function $0(n){var i=n;do{if((i.flags&32768)!==0){jp(i,Ls);return}n=i.return;var o=vb(i.alternate,i,ls);if(o!==null){Tt=o;return}if(i=i.sibling,i!==null){Tt=i;return}Tt=i=n}while(i!==null);xr===0&&(xr=5)}function jp(n,i){do{var o=yb(n.alternate,n);if(o!==null){o.flags&=32767,Tt=o;return}if(o=n.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!i&&(n=n.sibling,n!==null)){Tt=n;return}Tt=n=o}while(n!==null);xr=6,Tt=null}function Up(n,i,o,f,m,p,E,O,W){n.cancelPendingCommit=null;do V0();while(jr!==0);if((jt&6)!==0)throw Error(a(327));if(i!==null){if(i===n.current)throw Error(a(177));if(p=i.lanes|i.childLanes,p|=Sf,vo(n,o,p,E,O,W),n===Qt&&(Tt=Qt=null,Ct=0),Ol=i,js=n,os=o,Rh=p,Dh=m,Cp=f,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,Rb(Jt,function(){return Vp(),null})):(n.callbackNode=null,n.callbackPriority=0),f=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||f){f=V.T,V.T=null,m=ae.p,ae.p=2,E=jt,jt|=4;try{_b(n,i,o)}finally{jt=E,ae.p=m,V.T=f}}jr=1,Pp(),zp(),Hp()}}function Pp(){if(jr===1){jr=0;var n=js,i=Ol,o=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||o){o=V.T,V.T=null;var f=ae.p;ae.p=2;var m=jt;jt|=4;try{_p(i,n);var p=Xh,E=k1(n.containerInfo),O=p.focusedElem,W=p.selectionRange;if(E!==O&&O&&O.ownerDocument&&T1(O.ownerDocument.documentElement,O)){if(W!==null&&vf(O)){var ue=W.start,we=W.end;if(we===void 0&&(we=ue),"selectionStart"in O)O.selectionStart=ue,O.selectionEnd=Math.min(we,O.value.length);else{var ke=O.ownerDocument||document,de=ke&&ke.defaultView||window;if(de.getSelection){var ge=de.getSelection(),Je=O.textContent.length,ot=Math.min(W.start,Je),Kt=W.end===void 0?ot:Math.min(W.end,Je);!ge.extend&&ot>Kt&&(E=Kt,Kt=ot,ot=E);var re=E1(O,ot),Q=E1(O,Kt);if(re&&Q&&(ge.rangeCount!==1||ge.anchorNode!==re.node||ge.anchorOffset!==re.offset||ge.focusNode!==Q.node||ge.focusOffset!==Q.offset)){var ce=ke.createRange();ce.setStart(re.node,re.offset),ge.removeAllRanges(),ot>Kt?(ge.addRange(ce),ge.extend(Q.node,Q.offset)):(ce.setEnd(Q.node,Q.offset),ge.addRange(ce))}}}}for(ke=[],ge=O;ge=ge.parentNode;)ge.nodeType===1&&ke.push({element:ge,left:ge.scrollLeft,top:ge.scrollTop});for(typeof O.focus=="function"&&O.focus(),O=0;O<ke.length;O++){var Se=ke[O];Se.element.scrollLeft=Se.left,Se.element.scrollTop=Se.top}}ru=!!qh,Xh=qh=null}finally{jt=m,ae.p=f,V.T=o}}n.current=i,jr=2}}function zp(){if(jr===2){jr=0;var n=js,i=Ol,o=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||o){o=V.T,V.T=null;var f=ae.p;ae.p=2;var m=jt;jt|=4;try{gp(n,i.alternate,i)}finally{jt=m,ae.p=f,V.T=o}}jr=3}}function Hp(){if(jr===4||jr===3){jr=0,Ja();var n=js,i=Ol,o=os,f=Cp;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?jr=5:(jr=0,Ol=js=null,$p(n,n.pendingLanes));var m=n.pendingLanes;if(m===0&&(Is=null),hi(o),i=i.stateNode,er&&typeof er.onCommitFiberRoot=="function")try{er.onCommitFiberRoot(Vt,i,void 0,(i.current.flags&128)===128)}catch{}if(f!==null){i=V.T,m=ae.p,ae.p=2,V.T=null;try{for(var p=n.onRecoverableError,E=0;E<f.length;E++){var O=f[E];p(O.value,{componentStack:O.stack})}}finally{V.T=i,ae.p=m}}(os&3)!==0&&V0(),Fn(n),m=n.pendingLanes,(o&261930)!==0&&(m&42)!==0?n===Fh?Ko++:(Ko=0,Fh=n):Ko=0,Yo(0)}}function $p(n,i){(n.pooledCacheLanes&=i)===0&&(i=n.pooledCache,i!=null&&(n.pooledCache=null,Oo(i)))}function V0(){return Pp(),zp(),Hp(),Vp()}function Vp(){if(jr!==5)return!1;var n=js,i=Rh;Rh=0;var o=hi(os),f=V.T,m=ae.p;try{ae.p=32>o?32:o,V.T=null,o=Dh,Dh=null;var p=js,E=os;if(jr=0,Ol=js=null,os=0,(jt&6)!==0)throw Error(a(331));var O=jt;if(jt|=4,Tp(p.current),bp(p,p.current,E,o),jt=O,Yo(0,!1),er&&typeof er.onPostCommitFiberRoot=="function")try{er.onPostCommitFiberRoot(Vt,p)}catch{}return!0}finally{ae.p=m,V.T=f,$p(n,i)}}function Gp(n,i,o){i=en(o,i),i=fh(n.stateNode,i,2),n=Rs(n,i,2),n!==null&&(Vn(n,2),Fn(n))}function Pt(n,i,o){if(n.tag===3)Gp(n,n,o);else for(;i!==null;){if(i.tag===3){Gp(i,n,o);break}else if(i.tag===1){var f=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(Is===null||!Is.has(f))){n=en(o,n),o=qg(2),f=Rs(i,o,2),f!==null&&(Xg(o,f,i,n),Vn(f,2),Fn(f));break}}i=i.return}}function Bh(n,i,o){var f=n.pingCache;if(f===null){f=n.pingCache=new Sb;var m=new Set;f.set(i,m)}else m=f.get(i),m===void 0&&(m=new Set,f.set(i,m));m.has(o)||(Ch=!0,m.add(o),n=Cb.bind(null,n,i,o),i.then(n,n))}function Cb(n,i,o){var f=n.pingCache;f!==null&&f.delete(i),n.pingedLanes|=n.suspendedLanes&o,n.warmLanes&=~o,Qt===n&&(Ct&o)===o&&(xr===4||xr===3&&(Ct&62914560)===Ct&&300>Et()-j0?(jt&2)===0&&Rl(n,0):Nh|=o,Nl===Ct&&(Nl=0)),Fn(n)}function qp(n,i){i===0&&(i=al()),n=xi(n,i),n!==null&&(Vn(n,i),Fn(n))}function Nb(n){var i=n.memoizedState,o=0;i!==null&&(o=i.retryLane),qp(n,o)}function Ob(n,i){var o=0;switch(n.tag){case 31:case 13:var f=n.stateNode,m=n.memoizedState;m!==null&&(o=m.retryLane);break;case 19:f=n.stateNode;break;case 22:f=n.stateNode._retryCache;break;default:throw Error(a(314))}f!==null&&f.delete(i),qp(n,o)}function Rb(n,i){return Hr(n,i)}var G0=null,Fl=null,Ih=!1,q0=!1,jh=!1,Ps=0;function Fn(n){n!==Fl&&n.next===null&&(Fl===null?G0=Fl=n:Fl=Fl.next=n),q0=!0,Ih||(Ih=!0,Fb())}function Yo(n,i){if(!jh&&q0){jh=!0;do for(var o=!1,f=G0;f!==null;){if(n!==0){var m=f.pendingLanes;if(m===0)var p=0;else{var E=f.suspendedLanes,O=f.pingedLanes;p=(1<<31-cr(42|n)+1)-1,p&=m&~(E&~O),p=p&201326741?p&201326741|1:p?p|2:0}p!==0&&(o=!0,Yp(f,p))}else p=Ct,p=bs(f,f===Qt?p:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),(p&3)===0||$n(f,p)||(o=!0,Yp(f,p));f=f.next}while(o);jh=!1}}function Db(){Xp()}function Xp(){q0=Ih=!1;var n=0;Ps!==0&&$b()&&(n=Ps);for(var i=Et(),o=null,f=G0;f!==null;){var m=f.next,p=Wp(f,i);p===0?(f.next=null,o===null?G0=m:o.next=m,m===null&&(Fl=o)):(o=f,(n!==0||(p&3)!==0)&&(q0=!0)),f=m}jr!==0&&jr!==5||Yo(n),Ps!==0&&(Ps=0)}function Wp(n,i){for(var o=n.suspendedLanes,f=n.pingedLanes,m=n.expirationTimes,p=n.pendingLanes&-62914561;0<p;){var E=31-cr(p),O=1<<E,W=m[E];W===-1?((O&o)===0||(O&f)!==0)&&(m[E]=xo(O,i)):W<=i&&(n.expiredLanes|=O),p&=~O}if(i=Qt,o=Ct,o=bs(n,n===i?o:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),f=n.callbackNode,o===0||n===i&&(Ut===2||Ut===9)||n.cancelPendingCommit!==null)return f!==null&&f!==null&&$r(f),n.callbackNode=null,n.callbackPriority=0;if((o&3)===0||$n(n,o)){if(i=o&-o,i===n.callbackPriority)return i;switch(f!==null&&$r(f),hi(o)){case 2:case 8:o=Ma;break;case 32:o=Jt;break;case 268435456:o=mt;break;default:o=Jt}return f=Kp.bind(null,n),o=Hr(o,f),n.callbackPriority=i,n.callbackNode=o,i}return f!==null&&f!==null&&$r(f),n.callbackPriority=2,n.callbackNode=null,2}function Kp(n,i){if(jr!==0&&jr!==5)return n.callbackNode=null,n.callbackPriority=0,null;var o=n.callbackNode;if(V0()&&n.callbackNode!==o)return null;var f=Ct;return f=bs(n,n===Qt?f:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),f===0?null:(Op(n,f,i),Wp(n,Et()),n.callbackNode!=null&&n.callbackNode===o?Kp.bind(null,n):null)}function Yp(n,i){if(V0())return null;Op(n,i,!0)}function Fb(){Gb(function(){(jt&6)!==0?Hr(sa,Db):Xp()})}function Uh(){if(Ps===0){var n=vl;n===0&&(n=Hn,Hn<<=1,(Hn&261888)===0&&(Hn=256)),Ps=n}return Ps}function Jp(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:il(""+n)}function Qp(n,i){var o=i.ownerDocument.createElement("input");return o.name=i.name,o.value=i.value,n.id&&o.setAttribute("form",n.id),i.parentNode.insertBefore(o,i),n=new FormData(n),o.parentNode.removeChild(o),n}function Mb(n,i,o,f,m){if(i==="submit"&&o&&o.stateNode===m){var p=Jp((m[B]||null).action),E=f.submitter;E&&(i=(i=E[B]||null)?Jp(i.formAction):E.getAttribute("formAction"),i!==null&&(p=i,E=null));var O=new n0("action","action",null,f,m);n.push({event:O,listeners:[{instance:null,listener:function(){if(f.defaultPrevented){if(Ps!==0){var W=E?Qp(m,E):new FormData(m);sh(o,{pending:!0,data:W,method:m.method,action:p},null,W)}}else typeof p=="function"&&(O.preventDefault(),W=E?Qp(m,E):new FormData(m),sh(o,{pending:!0,data:W,method:m.method,action:p},p,W))},currentTarget:m}]})}}for(var Ph=0;Ph<bf.length;Ph++){var zh=bf[Ph],Lb=zh.toLowerCase(),Bb=zh[0].toUpperCase()+zh.slice(1);vn(Lb,"on"+Bb)}vn(N1,"onAnimationEnd"),vn(O1,"onAnimationIteration"),vn(R1,"onAnimationStart"),vn("dblclick","onDoubleClick"),vn("focusin","onFocus"),vn("focusout","onBlur"),vn(Qw,"onTransitionRun"),vn(Zw,"onTransitionStart"),vn(eb,"onTransitionCancel"),vn(D1,"onTransitionEnd"),Sa("onMouseEnter",["mouseout","mouseover"]),Sa("onMouseLeave",["mouseout","mouseover"]),Sa("onPointerEnter",["pointerout","pointerover"]),Sa("onPointerLeave",["pointerout","pointerover"]),tr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),tr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),tr("onBeforeInput",["compositionend","keypress","textInput","paste"]),tr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),tr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),tr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Jo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ib=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Jo));function Zp(n,i){i=(i&4)!==0;for(var o=0;o<n.length;o++){var f=n[o],m=f.event;f=f.listeners;e:{var p=void 0;if(i)for(var E=f.length-1;0<=E;E--){var O=f[E],W=O.instance,ue=O.currentTarget;if(O=O.listener,W!==p&&m.isPropagationStopped())break e;p=O,m.currentTarget=ue;try{p(m)}catch(we){l0(we)}m.currentTarget=null,p=W}else for(E=0;E<f.length;E++){if(O=f[E],W=O.instance,ue=O.currentTarget,O=O.listener,W!==p&&m.isPropagationStopped())break e;p=O,m.currentTarget=ue;try{p(m)}catch(we){l0(we)}m.currentTarget=null,p=W}}}}function kt(n,i){var o=i[fe];o===void 0&&(o=i[fe]=new Set);var f=n+"__bubble";o.has(f)||(ex(i,n,2,!1),o.add(f))}function Hh(n,i,o){var f=0;i&&(f|=4),ex(o,n,f,i)}var X0="_reactListening"+Math.random().toString(36).slice(2);function $h(n){if(!n[X0]){n[X0]=!0,Gt.forEach(function(o){o!=="selectionchange"&&(Ib.has(o)||Hh(o,!1,n),Hh(o,!0,n))});var i=n.nodeType===9?n:n.ownerDocument;i===null||i[X0]||(i[X0]=!0,Hh("selectionchange",!1,i))}}function ex(n,i,o,f){switch(Nx(i)){case 2:var m=fS;break;case 8:m=hS;break;default:m=nd}o=m.bind(null,i,o,n),m=void 0,!cf||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(m=!0),f?m!==void 0?n.addEventListener(i,o,{capture:!0,passive:m}):n.addEventListener(i,o,!0):m!==void 0?n.addEventListener(i,o,{passive:m}):n.addEventListener(i,o,!1)}function Vh(n,i,o,f,m){var p=f;if((i&1)===0&&(i&2)===0&&f!==null)e:for(;;){if(f===null)return;var E=f.tag;if(E===3||E===4){var O=f.stateNode.containerInfo;if(O===m)break;if(E===4)for(E=f.return;E!==null;){var W=E.tag;if((W===3||W===4)&&E.stateNode.containerInfo===m)return;E=E.return}for(;O!==null;){if(E=Le(O),E===null)return;if(W=E.tag,W===5||W===6||W===26||W===27){f=p=E;continue e}O=O.parentNode}}f=f.return}s1(function(){var ue=p,we=lf(o),ke=[];e:{var de=F1.get(n);if(de!==void 0){var ge=n0,Je=n;switch(n){case"keypress":if(r0(o)===0)break e;case"keydown":case"keyup":ge=Ow;break;case"focusin":Je="focus",ge=df;break;case"focusout":Je="blur",ge=df;break;case"beforeblur":case"afterblur":ge=df;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ge=o1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ge=vw;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ge=Fw;break;case N1:case O1:case R1:ge=ww;break;case D1:ge=Lw;break;case"scroll":case"scrollend":ge=pw;break;case"wheel":ge=Iw;break;case"copy":case"cut":case"paste":ge=Sw;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ge=u1;break;case"toggle":case"beforetoggle":ge=Uw}var ot=(i&4)!==0,Kt=!ot&&(n==="scroll"||n==="scrollend"),re=ot?de!==null?de+"Capture":null:de;ot=[];for(var Q=ue,ce;Q!==null;){var Se=Q;if(ce=Se.stateNode,Se=Se.tag,Se!==5&&Se!==26&&Se!==27||ce===null||re===null||(Se=yo(Q,re),Se!=null&&ot.push(Qo(Q,Se,ce))),Kt)break;Q=Q.return}0<ot.length&&(de=new ge(de,Je,null,o,we),ke.push({event:de,listeners:ot}))}}if((i&7)===0){e:{if(de=n==="mouseover"||n==="pointerover",ge=n==="mouseout"||n==="pointerout",de&&o!==sf&&(Je=o.relatedTarget||o.fromElement)&&(Le(Je)||Je[H]))break e;if((ge||de)&&(de=we.window===we?we:(de=we.ownerDocument)?de.defaultView||de.parentWindow:window,ge?(Je=o.relatedTarget||o.toElement,ge=ue,Je=Je?Le(Je):null,Je!==null&&(Kt=l(Je),ot=Je.tag,Je!==Kt||ot!==5&&ot!==27&&ot!==6)&&(Je=null)):(ge=null,Je=ue),ge!==Je)){if(ot=o1,Se="onMouseLeave",re="onMouseEnter",Q="mouse",(n==="pointerout"||n==="pointerover")&&(ot=u1,Se="onPointerLeave",re="onPointerEnter",Q="pointer"),Kt=ge==null?de:De(ge),ce=Je==null?de:De(Je),de=new ot(Se,Q+"leave",ge,o,we),de.target=Kt,de.relatedTarget=ce,Se=null,Le(we)===ue&&(ot=new ot(re,Q+"enter",Je,o,we),ot.target=ce,ot.relatedTarget=Kt,Se=ot),Kt=Se,ge&&Je)t:{for(ot=jb,re=ge,Q=Je,ce=0,Se=re;Se;Se=ot(Se))ce++;Se=0;for(var st=Q;st;st=ot(st))Se++;for(;0<ce-Se;)re=ot(re),ce--;for(;0<Se-ce;)Q=ot(Q),Se--;for(;ce--;){if(re===Q||Q!==null&&re===Q.alternate){ot=re;break t}re=ot(re),Q=ot(Q)}ot=null}else ot=null;ge!==null&&tx(ke,de,ge,ot,!1),Je!==null&&Kt!==null&&tx(ke,Kt,Je,ot,!0)}}e:{if(de=ue?De(ue):window,ge=de.nodeName&&de.nodeName.toLowerCase(),ge==="select"||ge==="input"&&de.type==="file")var Lt=v1;else if(p1(de))if(y1)Lt=Kw;else{Lt=Xw;var et=qw}else ge=de.nodeName,!ge||ge.toLowerCase()!=="input"||de.type!=="checkbox"&&de.type!=="radio"?ue&&la(ue.elementType)&&(Lt=v1):Lt=Ww;if(Lt&&(Lt=Lt(n,ue))){x1(ke,Lt,o,we);break e}et&&et(n,de,ue),n==="focusout"&&ue&&de.type==="number"&&ue.memoizedProps.value!=null&&qe(de,"number",de.value)}switch(et=ue?De(ue):window,n){case"focusin":(p1(et)||et.contentEditable==="true")&&(ul=et,yf=ue,Ao=null);break;case"focusout":Ao=yf=ul=null;break;case"mousedown":_f=!0;break;case"contextmenu":case"mouseup":case"dragend":_f=!1,A1(ke,o,we);break;case"selectionchange":if(Jw)break;case"keydown":case"keyup":A1(ke,o,we)}var yt;if(gf)e:{switch(n){case"compositionstart":var Nt="onCompositionStart";break e;case"compositionend":Nt="onCompositionEnd";break e;case"compositionupdate":Nt="onCompositionUpdate";break e}Nt=void 0}else cl?m1(n,o)&&(Nt="onCompositionEnd"):n==="keydown"&&o.keyCode===229&&(Nt="onCompositionStart");Nt&&(f1&&o.locale!=="ko"&&(cl||Nt!=="onCompositionStart"?Nt==="onCompositionEnd"&&cl&&(yt=i1()):(Es=we,uf="value"in Es?Es.value:Es.textContent,cl=!0)),et=W0(ue,Nt),0<et.length&&(Nt=new c1(Nt,n,null,o,we),ke.push({event:Nt,listeners:et}),yt?Nt.data=yt:(yt=g1(o),yt!==null&&(Nt.data=yt)))),(yt=zw?Hw(n,o):$w(n,o))&&(Nt=W0(ue,"onBeforeInput"),0<Nt.length&&(et=new c1("onBeforeInput","beforeinput",null,o,we),ke.push({event:et,listeners:Nt}),et.data=yt)),Mb(ke,n,ue,o,we)}Zp(ke,i)})}function Qo(n,i,o){return{instance:n,listener:i,currentTarget:o}}function W0(n,i){for(var o=i+"Capture",f=[];n!==null;){var m=n,p=m.stateNode;if(m=m.tag,m!==5&&m!==26&&m!==27||p===null||(m=yo(n,o),m!=null&&f.unshift(Qo(n,m,p)),m=yo(n,i),m!=null&&f.push(Qo(n,m,p))),n.tag===3)return f;n=n.return}return[]}function jb(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function tx(n,i,o,f,m){for(var p=i._reactName,E=[];o!==null&&o!==f;){var O=o,W=O.alternate,ue=O.stateNode;if(O=O.tag,W!==null&&W===f)break;O!==5&&O!==26&&O!==27||ue===null||(W=ue,m?(ue=yo(o,p),ue!=null&&E.unshift(Qo(o,ue,W))):m||(ue=yo(o,p),ue!=null&&E.push(Qo(o,ue,W)))),o=o.return}E.length!==0&&n.push({event:i,listeners:E})}var Ub=/\r\n?/g,Pb=/\u0000|\uFFFD/g;function rx(n){return(typeof n=="string"?n:""+n).replace(Ub,`
`).replace(Pb,"")}function ax(n,i){return i=rx(i),rx(n)===i}function Wt(n,i,o,f,m,p){switch(o){case"children":typeof f=="string"?i==="body"||i==="textarea"&&f===""||pt(n,f):(typeof f=="number"||typeof f=="bigint")&&i!=="body"&&pt(n,""+f);break;case"className":Y(n,"class",f);break;case"tabIndex":Y(n,"tabindex",f);break;case"dir":case"role":case"viewBox":case"width":case"height":Y(n,o,f);break;case"style":fr(n,f,p);break;case"data":if(i!=="object"){Y(n,"data",f);break}case"src":case"href":if(f===""&&(i!=="a"||o!=="href")){n.removeAttribute(o);break}if(f==null||typeof f=="function"||typeof f=="symbol"||typeof f=="boolean"){n.removeAttribute(o);break}f=il(""+f),n.setAttribute(o,f);break;case"action":case"formAction":if(typeof f=="function"){n.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof p=="function"&&(o==="formAction"?(i!=="input"&&Wt(n,i,"name",m.name,m,null),Wt(n,i,"formEncType",m.formEncType,m,null),Wt(n,i,"formMethod",m.formMethod,m,null),Wt(n,i,"formTarget",m.formTarget,m,null)):(Wt(n,i,"encType",m.encType,m,null),Wt(n,i,"method",m.method,m,null),Wt(n,i,"target",m.target,m,null)));if(f==null||typeof f=="symbol"||typeof f=="boolean"){n.removeAttribute(o);break}f=il(""+f),n.setAttribute(o,f);break;case"onClick":f!=null&&(n.onclick=Xn);break;case"onScroll":f!=null&&kt("scroll",n);break;case"onScrollEnd":f!=null&&kt("scrollend",n);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(a(61));if(o=f.__html,o!=null){if(m.children!=null)throw Error(a(60));n.innerHTML=o}}break;case"multiple":n.multiple=f&&typeof f!="function"&&typeof f!="symbol";break;case"muted":n.muted=f&&typeof f!="function"&&typeof f!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(f==null||typeof f=="function"||typeof f=="boolean"||typeof f=="symbol"){n.removeAttribute("xlink:href");break}o=il(""+f),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":f!=null&&typeof f!="function"&&typeof f!="symbol"?n.setAttribute(o,""+f):n.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":f&&typeof f!="function"&&typeof f!="symbol"?n.setAttribute(o,""):n.removeAttribute(o);break;case"capture":case"download":f===!0?n.setAttribute(o,""):f!==!1&&f!=null&&typeof f!="function"&&typeof f!="symbol"?n.setAttribute(o,f):n.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":f!=null&&typeof f!="function"&&typeof f!="symbol"&&!isNaN(f)&&1<=f?n.setAttribute(o,f):n.removeAttribute(o);break;case"rowSpan":case"start":f==null||typeof f=="function"||typeof f=="symbol"||isNaN(f)?n.removeAttribute(o):n.setAttribute(o,f);break;case"popover":kt("beforetoggle",n),kt("toggle",n),Kr(n,"popover",f);break;case"xlinkActuate":ee(n,"http://www.w3.org/1999/xlink","xlink:actuate",f);break;case"xlinkArcrole":ee(n,"http://www.w3.org/1999/xlink","xlink:arcrole",f);break;case"xlinkRole":ee(n,"http://www.w3.org/1999/xlink","xlink:role",f);break;case"xlinkShow":ee(n,"http://www.w3.org/1999/xlink","xlink:show",f);break;case"xlinkTitle":ee(n,"http://www.w3.org/1999/xlink","xlink:title",f);break;case"xlinkType":ee(n,"http://www.w3.org/1999/xlink","xlink:type",f);break;case"xmlBase":ee(n,"http://www.w3.org/XML/1998/namespace","xml:base",f);break;case"xmlLang":ee(n,"http://www.w3.org/XML/1998/namespace","xml:lang",f);break;case"xmlSpace":ee(n,"http://www.w3.org/XML/1998/namespace","xml:space",f);break;case"is":Kr(n,"is",f);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=di.get(o)||o,Kr(n,o,f))}}function Gh(n,i,o,f,m,p){switch(o){case"style":fr(n,f,p);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(a(61));if(o=f.__html,o!=null){if(m.children!=null)throw Error(a(60));n.innerHTML=o}}break;case"children":typeof f=="string"?pt(n,f):(typeof f=="number"||typeof f=="bigint")&&pt(n,""+f);break;case"onScroll":f!=null&&kt("scroll",n);break;case"onScrollEnd":f!=null&&kt("scrollend",n);break;case"onClick":f!=null&&(n.onclick=Xn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!qt.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(m=o.endsWith("Capture"),i=o.slice(2,m?o.length-7:void 0),p=n[B]||null,p=p!=null?p[o]:null,typeof p=="function"&&n.removeEventListener(i,p,m),typeof f=="function")){typeof p!="function"&&p!==null&&(o in n?n[o]=null:n.hasAttribute(o)&&n.removeAttribute(o)),n.addEventListener(i,f,m);break e}o in n?n[o]=f:f===!0?n.setAttribute(o,""):Kr(n,o,f)}}}function Zr(n,i,o){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":kt("error",n),kt("load",n);var f=!1,m=!1,p;for(p in o)if(o.hasOwnProperty(p)){var E=o[p];if(E!=null)switch(p){case"src":f=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,i));default:Wt(n,i,p,E,o,null)}}m&&Wt(n,i,"srcSet",o.srcSet,o,null),f&&Wt(n,i,"src",o.src,o,null);return;case"input":kt("invalid",n);var O=p=E=m=null,W=null,ue=null;for(f in o)if(o.hasOwnProperty(f)){var we=o[f];if(we!=null)switch(f){case"name":m=we;break;case"type":E=we;break;case"checked":W=we;break;case"defaultChecked":ue=we;break;case"value":p=we;break;case"defaultValue":O=we;break;case"children":case"dangerouslySetInnerHTML":if(we!=null)throw Error(a(137,i));break;default:Wt(n,i,f,we,o,null)}}nt(n,p,O,W,ue,E,m,!1);return;case"select":kt("invalid",n),f=E=p=null;for(m in o)if(o.hasOwnProperty(m)&&(O=o[m],O!=null))switch(m){case"value":p=O;break;case"defaultValue":E=O;break;case"multiple":f=O;default:Wt(n,i,m,O,o,null)}i=p,o=E,n.multiple=!!f,i!=null?Ge(n,!!f,i,!1):o!=null&&Ge(n,!!f,o,!0);return;case"textarea":kt("invalid",n),p=m=f=null;for(E in o)if(o.hasOwnProperty(E)&&(O=o[E],O!=null))switch(E){case"value":f=O;break;case"defaultValue":m=O;break;case"children":p=O;break;case"dangerouslySetInnerHTML":if(O!=null)throw Error(a(91));break;default:Wt(n,i,E,O,o,null)}Ze(n,f,m,p);return;case"option":for(W in o)o.hasOwnProperty(W)&&(f=o[W],f!=null)&&(W==="selected"?n.selected=f&&typeof f!="function"&&typeof f!="symbol":Wt(n,i,W,f,o,null));return;case"dialog":kt("beforetoggle",n),kt("toggle",n),kt("cancel",n),kt("close",n);break;case"iframe":case"object":kt("load",n);break;case"video":case"audio":for(f=0;f<Jo.length;f++)kt(Jo[f],n);break;case"image":kt("error",n),kt("load",n);break;case"details":kt("toggle",n);break;case"embed":case"source":case"link":kt("error",n),kt("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ue in o)if(o.hasOwnProperty(ue)&&(f=o[ue],f!=null))switch(ue){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,i));default:Wt(n,i,ue,f,o,null)}return;default:if(la(i)){for(we in o)o.hasOwnProperty(we)&&(f=o[we],f!==void 0&&Gh(n,i,we,f,o,void 0));return}}for(O in o)o.hasOwnProperty(O)&&(f=o[O],f!=null&&Wt(n,i,O,f,o,null))}function zb(n,i,o,f){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,p=null,E=null,O=null,W=null,ue=null,we=null;for(ge in o){var ke=o[ge];if(o.hasOwnProperty(ge)&&ke!=null)switch(ge){case"checked":break;case"value":break;case"defaultValue":W=ke;default:f.hasOwnProperty(ge)||Wt(n,i,ge,null,f,ke)}}for(var de in f){var ge=f[de];if(ke=o[de],f.hasOwnProperty(de)&&(ge!=null||ke!=null))switch(de){case"type":p=ge;break;case"name":m=ge;break;case"checked":ue=ge;break;case"defaultChecked":we=ge;break;case"value":E=ge;break;case"defaultValue":O=ge;break;case"children":case"dangerouslySetInnerHTML":if(ge!=null)throw Error(a(137,i));break;default:ge!==ke&&Wt(n,i,de,ge,f,ke)}}Ke(n,E,O,W,ue,we,p,m);return;case"select":ge=E=O=de=null;for(p in o)if(W=o[p],o.hasOwnProperty(p)&&W!=null)switch(p){case"value":break;case"multiple":ge=W;default:f.hasOwnProperty(p)||Wt(n,i,p,null,f,W)}for(m in f)if(p=f[m],W=o[m],f.hasOwnProperty(m)&&(p!=null||W!=null))switch(m){case"value":de=p;break;case"defaultValue":O=p;break;case"multiple":E=p;default:p!==W&&Wt(n,i,m,p,f,W)}i=O,o=E,f=ge,de!=null?Ge(n,!!o,de,!1):!!f!=!!o&&(i!=null?Ge(n,!!o,i,!0):Ge(n,!!o,o?[]:"",!1));return;case"textarea":ge=de=null;for(O in o)if(m=o[O],o.hasOwnProperty(O)&&m!=null&&!f.hasOwnProperty(O))switch(O){case"value":break;case"children":break;default:Wt(n,i,O,null,f,m)}for(E in f)if(m=f[E],p=o[E],f.hasOwnProperty(E)&&(m!=null||p!=null))switch(E){case"value":de=m;break;case"defaultValue":ge=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(a(91));break;default:m!==p&&Wt(n,i,E,m,f,p)}Xe(n,de,ge);return;case"option":for(var Je in o)de=o[Je],o.hasOwnProperty(Je)&&de!=null&&!f.hasOwnProperty(Je)&&(Je==="selected"?n.selected=!1:Wt(n,i,Je,null,f,de));for(W in f)de=f[W],ge=o[W],f.hasOwnProperty(W)&&de!==ge&&(de!=null||ge!=null)&&(W==="selected"?n.selected=de&&typeof de!="function"&&typeof de!="symbol":Wt(n,i,W,de,f,ge));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ot in o)de=o[ot],o.hasOwnProperty(ot)&&de!=null&&!f.hasOwnProperty(ot)&&Wt(n,i,ot,null,f,de);for(ue in f)if(de=f[ue],ge=o[ue],f.hasOwnProperty(ue)&&de!==ge&&(de!=null||ge!=null))switch(ue){case"children":case"dangerouslySetInnerHTML":if(de!=null)throw Error(a(137,i));break;default:Wt(n,i,ue,de,f,ge)}return;default:if(la(i)){for(var Kt in o)de=o[Kt],o.hasOwnProperty(Kt)&&de!==void 0&&!f.hasOwnProperty(Kt)&&Gh(n,i,Kt,void 0,f,de);for(we in f)de=f[we],ge=o[we],!f.hasOwnProperty(we)||de===ge||de===void 0&&ge===void 0||Gh(n,i,we,de,f,ge);return}}for(var re in o)de=o[re],o.hasOwnProperty(re)&&de!=null&&!f.hasOwnProperty(re)&&Wt(n,i,re,null,f,de);for(ke in f)de=f[ke],ge=o[ke],!f.hasOwnProperty(ke)||de===ge||de==null&&ge==null||Wt(n,i,ke,de,f,ge)}function nx(n){switch(n){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Hb(){if(typeof performance.getEntriesByType=="function"){for(var n=0,i=0,o=performance.getEntriesByType("resource"),f=0;f<o.length;f++){var m=o[f],p=m.transferSize,E=m.initiatorType,O=m.duration;if(p&&O&&nx(E)){for(E=0,O=m.responseEnd,f+=1;f<o.length;f++){var W=o[f],ue=W.startTime;if(ue>O)break;var we=W.transferSize,ke=W.initiatorType;we&&nx(ke)&&(W=W.responseEnd,E+=we*(W<O?1:(O-ue)/(W-ue)))}if(--f,i+=8*(p+E)/(m.duration/1e3),n++,10<n)break}}if(0<n)return i/n/1e6}return navigator.connection&&(n=navigator.connection.downlink,typeof n=="number")?n:5}var qh=null,Xh=null;function K0(n){return n.nodeType===9?n:n.ownerDocument}function sx(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function ix(n,i){if(n===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&i==="foreignObject"?0:n}function Wh(n,i){return n==="textarea"||n==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Kh=null;function $b(){var n=window.event;return n&&n.type==="popstate"?n===Kh?!1:(Kh=n,!0):(Kh=null,!1)}var lx=typeof setTimeout=="function"?setTimeout:void 0,Vb=typeof clearTimeout=="function"?clearTimeout:void 0,ox=typeof Promise=="function"?Promise:void 0,Gb=typeof queueMicrotask=="function"?queueMicrotask:typeof ox<"u"?function(n){return ox.resolve(null).then(n).catch(qb)}:lx;function qb(n){setTimeout(function(){throw n})}function zs(n){return n==="head"}function cx(n,i){var o=i,f=0;do{var m=o.nextSibling;if(n.removeChild(o),m&&m.nodeType===8)if(o=m.data,o==="/$"||o==="/&"){if(f===0){n.removeChild(m),Il(i);return}f--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")f++;else if(o==="html")Zo(n.ownerDocument.documentElement);else if(o==="head"){o=n.ownerDocument.head,Zo(o);for(var p=o.firstChild;p;){var E=p.nextSibling,O=p.nodeName;p[he]||O==="SCRIPT"||O==="STYLE"||O==="LINK"&&p.rel.toLowerCase()==="stylesheet"||o.removeChild(p),p=E}}else o==="body"&&Zo(n.ownerDocument.body);o=m}while(o);Il(i)}function ux(n,i){var o=n;n=0;do{var f=o.nextSibling;if(o.nodeType===1?i?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(i?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),f&&f.nodeType===8)if(o=f.data,o==="/$"){if(n===0)break;n--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||n++;o=f}while(o)}function Yh(n){var i=n.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var o=i;switch(i=i.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":Yh(o),Ne(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}n.removeChild(o)}}function Xb(n,i,o,f){for(;n.nodeType===1;){var m=o;if(n.nodeName.toLowerCase()!==i.toLowerCase()){if(!f&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(f){if(!n[he])switch(i){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(p=n.getAttribute("rel"),p==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(p!==m.rel||n.getAttribute("href")!==(m.href==null||m.href===""?null:m.href)||n.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||n.getAttribute("title")!==(m.title==null?null:m.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(p=n.getAttribute("src"),(p!==(m.src==null?null:m.src)||n.getAttribute("type")!==(m.type==null?null:m.type)||n.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&p&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(i==="input"&&n.type==="hidden"){var p=m.name==null?null:""+m.name;if(m.type==="hidden"&&n.getAttribute("name")===p)return n}else return n;if(n=sn(n.nextSibling),n===null)break}return null}function Wb(n,i,o){if(i==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!o||(n=sn(n.nextSibling),n===null))return null;return n}function fx(n,i){for(;n.nodeType!==8;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!i||(n=sn(n.nextSibling),n===null))return null;return n}function Jh(n){return n.data==="$?"||n.data==="$~"}function Qh(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState!=="loading"}function Kb(n,i){var o=n.ownerDocument;if(n.data==="$~")n._reactRetry=i;else if(n.data!=="$?"||o.readyState!=="loading")i();else{var f=function(){i(),o.removeEventListener("DOMContentLoaded",f)};o.addEventListener("DOMContentLoaded",f),n._reactRetry=f}}function sn(n){for(;n!=null;n=n.nextSibling){var i=n.nodeType;if(i===1||i===3)break;if(i===8){if(i=n.data,i==="$"||i==="$!"||i==="$?"||i==="$~"||i==="&"||i==="F!"||i==="F")break;if(i==="/$"||i==="/&")return null}}return n}var Zh=null;function hx(n){n=n.nextSibling;for(var i=0;n;){if(n.nodeType===8){var o=n.data;if(o==="/$"||o==="/&"){if(i===0)return sn(n.nextSibling);i--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||i++}n=n.nextSibling}return null}function dx(n){n=n.previousSibling;for(var i=0;n;){if(n.nodeType===8){var o=n.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(i===0)return n;i--}else o!=="/$"&&o!=="/&"||i++}n=n.previousSibling}return null}function mx(n,i,o){switch(i=K0(o),n){case"html":if(n=i.documentElement,!n)throw Error(a(452));return n;case"head":if(n=i.head,!n)throw Error(a(453));return n;case"body":if(n=i.body,!n)throw Error(a(454));return n;default:throw Error(a(451))}}function Zo(n){for(var i=n.attributes;i.length;)n.removeAttributeNode(i[0]);Ne(n)}var ln=new Map,gx=new Set;function Y0(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var cs=ae.d;ae.d={f:Yb,r:Jb,D:Qb,C:Zb,L:eS,m:tS,X:aS,S:rS,M:nS};function Yb(){var n=cs.f(),i=z0();return n||i}function Jb(n){var i=He(n);i!==null&&i.tag===5&&i.type==="form"?Dg(i):cs.r(n)}var Ml=typeof document>"u"?null:document;function px(n,i,o){var f=Ml;if(f&&typeof i=="string"&&i){var m=Ve(i);m='link[rel="'+n+'"][href="'+m+'"]',typeof o=="string"&&(m+='[crossorigin="'+o+'"]'),gx.has(m)||(gx.add(m),n={rel:n,crossOrigin:o,href:i},f.querySelector(m)===null&&(i=f.createElement("link"),Zr(i,"link",n),Qe(i),f.head.appendChild(i)))}}function Qb(n){cs.D(n),px("dns-prefetch",n,null)}function Zb(n,i){cs.C(n,i),px("preconnect",n,i)}function eS(n,i,o){cs.L(n,i,o);var f=Ml;if(f&&n&&i){var m='link[rel="preload"][as="'+Ve(i)+'"]';i==="image"&&o&&o.imageSrcSet?(m+='[imagesrcset="'+Ve(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(m+='[imagesizes="'+Ve(o.imageSizes)+'"]')):m+='[href="'+Ve(n)+'"]';var p=m;switch(i){case"style":p=Ll(n);break;case"script":p=Bl(n)}ln.has(p)||(n=x({rel:"preload",href:i==="image"&&o&&o.imageSrcSet?void 0:n,as:i},o),ln.set(p,n),f.querySelector(m)!==null||i==="style"&&f.querySelector(ec(p))||i==="script"&&f.querySelector(tc(p))||(i=f.createElement("link"),Zr(i,"link",n),Qe(i),f.head.appendChild(i)))}}function tS(n,i){cs.m(n,i);var o=Ml;if(o&&n){var f=i&&typeof i.as=="string"?i.as:"script",m='link[rel="modulepreload"][as="'+Ve(f)+'"][href="'+Ve(n)+'"]',p=m;switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":p=Bl(n)}if(!ln.has(p)&&(n=x({rel:"modulepreload",href:n},i),ln.set(p,n),o.querySelector(m)===null)){switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(tc(p)))return}f=o.createElement("link"),Zr(f,"link",n),Qe(f),o.head.appendChild(f)}}}function rS(n,i,o){cs.S(n,i,o);var f=Ml;if(f&&n){var m=ze(f).hoistableStyles,p=Ll(n);i=i||"default";var E=m.get(p);if(!E){var O={loading:0,preload:null};if(E=f.querySelector(ec(p)))O.loading=5;else{n=x({rel:"stylesheet",href:n,"data-precedence":i},o),(o=ln.get(p))&&ed(n,o);var W=E=f.createElement("link");Qe(W),Zr(W,"link",n),W._p=new Promise(function(ue,we){W.onload=ue,W.onerror=we}),W.addEventListener("load",function(){O.loading|=1}),W.addEventListener("error",function(){O.loading|=2}),O.loading|=4,J0(E,i,f)}E={type:"stylesheet",instance:E,count:1,state:O},m.set(p,E)}}}function aS(n,i){cs.X(n,i);var o=Ml;if(o&&n){var f=ze(o).hoistableScripts,m=Bl(n),p=f.get(m);p||(p=o.querySelector(tc(m)),p||(n=x({src:n,async:!0},i),(i=ln.get(m))&&td(n,i),p=o.createElement("script"),Qe(p),Zr(p,"link",n),o.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},f.set(m,p))}}function nS(n,i){cs.M(n,i);var o=Ml;if(o&&n){var f=ze(o).hoistableScripts,m=Bl(n),p=f.get(m);p||(p=o.querySelector(tc(m)),p||(n=x({src:n,async:!0,type:"module"},i),(i=ln.get(m))&&td(n,i),p=o.createElement("script"),Qe(p),Zr(p,"link",n),o.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},f.set(m,p))}}function xx(n,i,o,f){var m=(m=te.current)?Y0(m):null;if(!m)throw Error(a(446));switch(n){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(i=Ll(o.href),o=ze(m).hoistableStyles,f=o.get(i),f||(f={type:"style",instance:null,count:0,state:null},o.set(i,f)),f):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){n=Ll(o.href);var p=ze(m).hoistableStyles,E=p.get(n);if(E||(m=m.ownerDocument||m,E={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},p.set(n,E),(p=m.querySelector(ec(n)))&&!p._p&&(E.instance=p,E.state.loading=5),ln.has(n)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},ln.set(n,o),p||sS(m,n,o,E.state))),i&&f===null)throw Error(a(528,""));return E}if(i&&f!==null)throw Error(a(529,""));return null;case"script":return i=o.async,o=o.src,typeof o=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=Bl(o),o=ze(m).hoistableScripts,f=o.get(i),f||(f={type:"script",instance:null,count:0,state:null},o.set(i,f)),f):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,n))}}function Ll(n){return'href="'+Ve(n)+'"'}function ec(n){return'link[rel="stylesheet"]['+n+"]"}function vx(n){return x({},n,{"data-precedence":n.precedence,precedence:null})}function sS(n,i,o,f){n.querySelector('link[rel="preload"][as="style"]['+i+"]")?f.loading=1:(i=n.createElement("link"),f.preload=i,i.addEventListener("load",function(){return f.loading|=1}),i.addEventListener("error",function(){return f.loading|=2}),Zr(i,"link",o),Qe(i),n.head.appendChild(i))}function Bl(n){return'[src="'+Ve(n)+'"]'}function tc(n){return"script[async]"+n}function yx(n,i,o){if(i.count++,i.instance===null)switch(i.type){case"style":var f=n.querySelector('style[data-href~="'+Ve(o.href)+'"]');if(f)return i.instance=f,Qe(f),f;var m=x({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return f=(n.ownerDocument||n).createElement("style"),Qe(f),Zr(f,"style",m),J0(f,o.precedence,n),i.instance=f;case"stylesheet":m=Ll(o.href);var p=n.querySelector(ec(m));if(p)return i.state.loading|=4,i.instance=p,Qe(p),p;f=vx(o),(m=ln.get(m))&&ed(f,m),p=(n.ownerDocument||n).createElement("link"),Qe(p);var E=p;return E._p=new Promise(function(O,W){E.onload=O,E.onerror=W}),Zr(p,"link",f),i.state.loading|=4,J0(p,o.precedence,n),i.instance=p;case"script":return p=Bl(o.src),(m=n.querySelector(tc(p)))?(i.instance=m,Qe(m),m):(f=o,(m=ln.get(p))&&(f=x({},o),td(f,m)),n=n.ownerDocument||n,m=n.createElement("script"),Qe(m),Zr(m,"link",f),n.head.appendChild(m),i.instance=m);case"void":return null;default:throw Error(a(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(f=i.instance,i.state.loading|=4,J0(f,o.precedence,n));return i.instance}function J0(n,i,o){for(var f=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=f.length?f[f.length-1]:null,p=m,E=0;E<f.length;E++){var O=f[E];if(O.dataset.precedence===i)p=O;else if(p!==m)break}p?p.parentNode.insertBefore(n,p.nextSibling):(i=o.nodeType===9?o.head:o,i.insertBefore(n,i.firstChild))}function ed(n,i){n.crossOrigin==null&&(n.crossOrigin=i.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=i.referrerPolicy),n.title==null&&(n.title=i.title)}function td(n,i){n.crossOrigin==null&&(n.crossOrigin=i.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=i.referrerPolicy),n.integrity==null&&(n.integrity=i.integrity)}var Q0=null;function _x(n,i,o){if(Q0===null){var f=new Map,m=Q0=new Map;m.set(o,f)}else m=Q0,f=m.get(o),f||(f=new Map,m.set(o,f));if(f.has(n))return f;for(f.set(n,null),o=o.getElementsByTagName(n),m=0;m<o.length;m++){var p=o[m];if(!(p[he]||p[F]||n==="link"&&p.getAttribute("rel")==="stylesheet")&&p.namespaceURI!=="http://www.w3.org/2000/svg"){var E=p.getAttribute(i)||"";E=n+E;var O=f.get(E);O?O.push(p):f.set(E,[p])}}return f}function wx(n,i,o){n=n.ownerDocument||n,n.head.insertBefore(o,i==="title"?n.querySelector("head > title"):null)}function iS(n,i,o){if(o===1||i.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;return i.rel==="stylesheet"?(n=i.disabled,typeof i.precedence=="string"&&n==null):!0;case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function bx(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}function lS(n,i,o,f){if(o.type==="stylesheet"&&(typeof f.media!="string"||matchMedia(f.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var m=Ll(f.href),p=i.querySelector(ec(m));if(p){i=p._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(n.count++,n=Z0.bind(n),i.then(n,n)),o.state.loading|=4,o.instance=p,Qe(p);return}p=i.ownerDocument||i,f=vx(f),(m=ln.get(m))&&ed(f,m),p=p.createElement("link"),Qe(p);var E=p;E._p=new Promise(function(O,W){E.onload=O,E.onerror=W}),Zr(p,"link",f),o.instance=p}n.stylesheets===null&&(n.stylesheets=new Map),n.stylesheets.set(o,i),(i=o.state.preload)&&(o.state.loading&3)===0&&(n.count++,o=Z0.bind(n),i.addEventListener("load",o),i.addEventListener("error",o))}}var rd=0;function oS(n,i){return n.stylesheets&&n.count===0&&tu(n,n.stylesheets),0<n.count||0<n.imgCount?function(o){var f=setTimeout(function(){if(n.stylesheets&&tu(n,n.stylesheets),n.unsuspend){var p=n.unsuspend;n.unsuspend=null,p()}},6e4+i);0<n.imgBytes&&rd===0&&(rd=62500*Hb());var m=setTimeout(function(){if(n.waitingForImages=!1,n.count===0&&(n.stylesheets&&tu(n,n.stylesheets),n.unsuspend)){var p=n.unsuspend;n.unsuspend=null,p()}},(n.imgBytes>rd?50:800)+i);return n.unsuspend=o,function(){n.unsuspend=null,clearTimeout(f),clearTimeout(m)}}:null}function Z0(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)tu(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var eu=null;function tu(n,i){n.stylesheets=null,n.unsuspend!==null&&(n.count++,eu=new Map,i.forEach(cS,n),eu=null,Z0.call(n))}function cS(n,i){if(!(i.state.loading&4)){var o=eu.get(n);if(o)var f=o.get(null);else{o=new Map,eu.set(n,o);for(var m=n.querySelectorAll("link[data-precedence],style[data-precedence]"),p=0;p<m.length;p++){var E=m[p];(E.nodeName==="LINK"||E.getAttribute("media")!=="not all")&&(o.set(E.dataset.precedence,E),f=E)}f&&o.set(null,f)}m=i.instance,E=m.getAttribute("data-precedence"),p=o.get(E)||f,p===f&&o.set(null,m),o.set(E,m),this.count++,f=Z0.bind(this),m.addEventListener("load",f),m.addEventListener("error",f),p?p.parentNode.insertBefore(m,p.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(m,n.firstChild)),i.state.loading|=4}}var rc={$$typeof:T,Provider:null,Consumer:null,_currentValue:xe,_currentValue2:xe,_threadCount:0};function uS(n,i,o,f,m,p,E,O,W){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=fi(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=fi(0),this.hiddenUpdates=fi(null),this.identifierPrefix=f,this.onUncaughtError=m,this.onCaughtError=p,this.onRecoverableError=E,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=W,this.incompleteTransitions=new Map}function Sx(n,i,o,f,m,p,E,O,W,ue,we,ke){return n=new uS(n,i,o,E,W,ue,we,ke,O),i=1,p===!0&&(i|=24),p=Ia(3,null,null,i),n.current=p,p.stateNode=n,i=Lf(),i.refCount++,n.pooledCache=i,i.refCount++,p.memoizedState={element:f,isDehydrated:o,cache:i},Uf(p),n}function Ex(n){return n?(n=dl,n):dl}function Tx(n,i,o,f,m,p){m=Ex(m),f.context===null?f.context=m:f.pendingContext=m,f=Os(i),f.payload={element:o},p=p===void 0?null:p,p!==null&&(f.callback=p),o=Rs(n,f,i),o!==null&&(Na(o,n,i),Mo(o,n,i))}function kx(n,i){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var o=n.retryLane;n.retryLane=o!==0&&o<i?o:i}}function ad(n,i){kx(n,i),(n=n.alternate)&&kx(n,i)}function Ax(n){if(n.tag===13||n.tag===31){var i=xi(n,67108864);i!==null&&Na(i,n,67108864),ad(n,67108864)}}function Cx(n){if(n.tag===13||n.tag===31){var i=Ha();i=xn(i);var o=xi(n,i);o!==null&&Na(o,n,i),ad(n,i)}}var ru=!0;function fS(n,i,o,f){var m=V.T;V.T=null;var p=ae.p;try{ae.p=2,nd(n,i,o,f)}finally{ae.p=p,V.T=m}}function hS(n,i,o,f){var m=V.T;V.T=null;var p=ae.p;try{ae.p=8,nd(n,i,o,f)}finally{ae.p=p,V.T=m}}function nd(n,i,o,f){if(ru){var m=sd(f);if(m===null)Vh(n,i,f,au,o),Ox(n,f);else if(mS(m,n,i,o,f))f.stopPropagation();else if(Ox(n,f),i&4&&-1<dS.indexOf(n)){for(;m!==null;){var p=He(m);if(p!==null)switch(p.tag){case 3:if(p=p.stateNode,p.current.memoizedState.isDehydrated){var E=ba(p.pendingLanes);if(E!==0){var O=p;for(O.pendingLanes|=2,O.entangledLanes|=2;E;){var W=1<<31-cr(E);O.entanglements[1]|=W,E&=~W}Fn(p),(jt&6)===0&&(U0=Et()+500,Yo(0))}}break;case 31:case 13:O=xi(p,2),O!==null&&Na(O,p,2),z0(),ad(p,2)}if(p=sd(f),p===null&&Vh(n,i,f,au,o),p===m)break;m=p}m!==null&&f.stopPropagation()}else Vh(n,i,f,null,o)}}function sd(n){return n=lf(n),id(n)}var au=null;function id(n){if(au=null,n=Le(n),n!==null){var i=l(n);if(i===null)n=null;else{var o=i.tag;if(o===13){if(n=c(i),n!==null)return n;n=null}else if(o===31){if(n=u(i),n!==null)return n;n=null}else if(o===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;n=null}else i!==n&&(n=null)}}return au=n,null}function Nx(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(xa()){case sa:return 2;case Ma:return 8;case Jt:case ia:return 32;case mt:return 268435456;default:return 32}default:return 32}}var ld=!1,Hs=null,$s=null,Vs=null,ac=new Map,nc=new Map,Gs=[],dS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Ox(n,i){switch(n){case"focusin":case"focusout":Hs=null;break;case"dragenter":case"dragleave":$s=null;break;case"mouseover":case"mouseout":Vs=null;break;case"pointerover":case"pointerout":ac.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":nc.delete(i.pointerId)}}function sc(n,i,o,f,m,p){return n===null||n.nativeEvent!==p?(n={blockedOn:i,domEventName:o,eventSystemFlags:f,nativeEvent:p,targetContainers:[m]},i!==null&&(i=He(i),i!==null&&Ax(i)),n):(n.eventSystemFlags|=f,i=n.targetContainers,m!==null&&i.indexOf(m)===-1&&i.push(m),n)}function mS(n,i,o,f,m){switch(i){case"focusin":return Hs=sc(Hs,n,i,o,f,m),!0;case"dragenter":return $s=sc($s,n,i,o,f,m),!0;case"mouseover":return Vs=sc(Vs,n,i,o,f,m),!0;case"pointerover":var p=m.pointerId;return ac.set(p,sc(ac.get(p)||null,n,i,o,f,m)),!0;case"gotpointercapture":return p=m.pointerId,nc.set(p,sc(nc.get(p)||null,n,i,o,f,m)),!0}return!1}function Rx(n){var i=Le(n.target);if(i!==null){var o=l(i);if(o!==null){if(i=o.tag,i===13){if(i=c(o),i!==null){n.blockedOn=i,z(n.priority,function(){Cx(o)});return}}else if(i===31){if(i=u(o),i!==null){n.blockedOn=i,z(n.priority,function(){Cx(o)});return}}else if(i===3&&o.stateNode.current.memoizedState.isDehydrated){n.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}n.blockedOn=null}function nu(n){if(n.blockedOn!==null)return!1;for(var i=n.targetContainers;0<i.length;){var o=sd(n.nativeEvent);if(o===null){o=n.nativeEvent;var f=new o.constructor(o.type,o);sf=f,o.target.dispatchEvent(f),sf=null}else return i=He(o),i!==null&&Ax(i),n.blockedOn=o,!1;i.shift()}return!0}function Dx(n,i,o){nu(n)&&o.delete(i)}function gS(){ld=!1,Hs!==null&&nu(Hs)&&(Hs=null),$s!==null&&nu($s)&&($s=null),Vs!==null&&nu(Vs)&&(Vs=null),ac.forEach(Dx),nc.forEach(Dx)}function su(n,i){n.blockedOn===i&&(n.blockedOn=null,ld||(ld=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,gS)))}var iu=null;function Fx(n){iu!==n&&(iu=n,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){iu===n&&(iu=null);for(var i=0;i<n.length;i+=3){var o=n[i],f=n[i+1],m=n[i+2];if(typeof f!="function"){if(id(f||o)===null)continue;break}var p=He(o);p!==null&&(n.splice(i,3),i-=3,sh(p,{pending:!0,data:m,method:o.method,action:f},f,m))}}))}function Il(n){function i(W){return su(W,n)}Hs!==null&&su(Hs,n),$s!==null&&su($s,n),Vs!==null&&su(Vs,n),ac.forEach(i),nc.forEach(i);for(var o=0;o<Gs.length;o++){var f=Gs[o];f.blockedOn===n&&(f.blockedOn=null)}for(;0<Gs.length&&(o=Gs[0],o.blockedOn===null);)Rx(o),o.blockedOn===null&&Gs.shift();if(o=(n.ownerDocument||n).$$reactFormReplay,o!=null)for(f=0;f<o.length;f+=3){var m=o[f],p=o[f+1],E=m[B]||null;if(typeof p=="function")E||Fx(o);else if(E){var O=null;if(p&&p.hasAttribute("formAction")){if(m=p,E=p[B]||null)O=E.formAction;else if(id(m)!==null)continue}else O=E.action;typeof O=="function"?o[f+1]=O:(o.splice(f,3),f-=3),Fx(o)}}}function Mx(){function n(p){p.canIntercept&&p.info==="react-transition"&&p.intercept({handler:function(){return new Promise(function(E){return m=E})},focusReset:"manual",scroll:"manual"})}function i(){m!==null&&(m(),m=null),f||setTimeout(o,20)}function o(){if(!f&&!navigation.transition){var p=navigation.currentEntry;p&&p.url!=null&&navigation.navigate(p.url,{state:p.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var f=!1,m=null;return navigation.addEventListener("navigate",n),navigation.addEventListener("navigatesuccess",i),navigation.addEventListener("navigateerror",i),setTimeout(o,100),function(){f=!0,navigation.removeEventListener("navigate",n),navigation.removeEventListener("navigatesuccess",i),navigation.removeEventListener("navigateerror",i),m!==null&&(m(),m=null)}}}function od(n){this._internalRoot=n}lu.prototype.render=od.prototype.render=function(n){var i=this._internalRoot;if(i===null)throw Error(a(409));var o=i.current,f=Ha();Tx(o,f,n,i,null,null)},lu.prototype.unmount=od.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var i=n.containerInfo;Tx(n.current,2,null,n,null,null),z0(),i[H]=null}};function lu(n){this._internalRoot=n}lu.prototype.unstable_scheduleHydration=function(n){if(n){var i=C();n={blockedOn:null,target:n,priority:i};for(var o=0;o<Gs.length&&i!==0&&i<Gs[o].priority;o++);Gs.splice(o,0,n),o===0&&Rx(n)}};var Lx=t.version;if(Lx!=="19.2.3")throw Error(a(527,Lx,"19.2.3"));ae.findDOMNode=function(n){var i=n._reactInternals;if(i===void 0)throw typeof n.render=="function"?Error(a(188)):(n=Object.keys(n).join(","),Error(a(268,n)));return n=d(i),n=n!==null?g(n):null,n=n===null?null:n.stateNode,n};var pS={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:V,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ou=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ou.isDisabled&&ou.supportsFiber)try{Vt=ou.inject(pS),er=ou}catch{}}return lc.createRoot=function(n,i){if(!s(n))throw Error(a(299));var o=!1,f="",m=Hg,p=$g,E=Vg;return i!=null&&(i.unstable_strictMode===!0&&(o=!0),i.identifierPrefix!==void 0&&(f=i.identifierPrefix),i.onUncaughtError!==void 0&&(m=i.onUncaughtError),i.onCaughtError!==void 0&&(p=i.onCaughtError),i.onRecoverableError!==void 0&&(E=i.onRecoverableError)),i=Sx(n,1,!1,null,null,o,f,null,m,p,E,Mx),n[H]=i.current,$h(n),new od(i)},lc.hydrateRoot=function(n,i,o){if(!s(n))throw Error(a(299));var f=!1,m="",p=Hg,E=$g,O=Vg,W=null;return o!=null&&(o.unstable_strictMode===!0&&(f=!0),o.identifierPrefix!==void 0&&(m=o.identifierPrefix),o.onUncaughtError!==void 0&&(p=o.onUncaughtError),o.onCaughtError!==void 0&&(E=o.onCaughtError),o.onRecoverableError!==void 0&&(O=o.onRecoverableError),o.formState!==void 0&&(W=o.formState)),i=Sx(n,1,!0,i,o??null,f,m,W,p,E,O,Mx),i.context=Ex(null),o=i.current,f=Ha(),f=xn(f),m=Os(f),m.callback=null,Rs(o,m,f),o=f,i.current.lanes=o,Vn(i,o),Fn(i),n[H]=i.current,$h(n),new lu(i)},lc.version="19.2.3",lc}var Gx;function kS(){if(Gx)return fd.exports;Gx=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),fd.exports=TS(),fd.exports}var AS=kS();const CS=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),NS=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,a)=>a?a.toUpperCase():r.toLowerCase()),qx=e=>{const t=NS(e);return t.charAt(0).toUpperCase()+t.slice(1)},By=(...e)=>e.filter((t,r,a)=>!!t&&t.trim()!==""&&a.indexOf(t)===r).join(" ").trim(),OS=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};var RS={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const DS=Ie.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:a,className:s="",children:l,iconNode:c,...u},h)=>Ie.createElement("svg",{ref:h,...RS,width:t,height:t,stroke:e,strokeWidth:a?Number(r)*24/Number(t):r,className:By("lucide",s),...!l&&!OS(u)&&{"aria-hidden":"true"},...u},[...c.map(([d,g])=>Ie.createElement(d,g)),...Array.isArray(l)?l:[l]]));const or=(e,t)=>{const r=Ie.forwardRef(({className:a,...s},l)=>Ie.createElement(DS,{ref:l,iconNode:t,className:By(`lucide-${CS(qx(e))}`,`lucide-${e}`,a),...s}));return r.displayName=qx(e),r};const FS=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],MS=or("calendar-days",FS);const LS=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],Iy=or("chart-column",LS);const BS=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],IS=or("chevron-right",BS);const jS=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Vc=or("circle-check",jS);const US=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],cm=or("clipboard-list",US);const PS=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Gc=or("download",PS);const zS=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],HS=or("eye-off",zS);const $S=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],VS=or("eye",$S);const GS=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],qS=or("file-down",GS);const XS=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],jy=or("file-spreadsheet",XS);const WS=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],KS=or("layout-dashboard",WS);const YS=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],JS=or("menu",YS);const QS=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],Au=or("package",QS);const ZS=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],eE=or("pen",ZS);const tE=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],rE=or("pencil",tE);const aE=[["path",{d:"m10.5 20.5 10-10a4.95 4.95 0 1 0-7-7l-10 10a4.95 4.95 0 1 0 7 7Z",key:"wa1lgi"}],["path",{d:"m8.5 8.5 7 7",key:"rvfmvr"}]],Uy=or("pill",aE);const nE=[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]],Wi=or("refresh-ccw",nE);const sE=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],iE=or("save",sE);const lE=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],um=or("search",lE);const oE=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],cE=or("tag",oE);const uE=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],io=or("trash-2",uE);const fE=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],hE=or("trending-down",fE);const dE=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],ii=or("triangle-alert",dE);const mE=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],fo=or("upload",mE);const gE=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],fm=or("x",gE);function pE({editingMed:e,onClose:t,onSubmit:r}){return w.jsx("div",{className:"fixed inset-0 bg-slate-900/60 backdrop-blur-sm flex items-center justify-center z-50 p-4 font-sans",children:w.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-lg overflow-hidden",children:[w.jsxs("div",{className:"p-6 border-b border-slate-100 flex justify-between items-center bg-slate-50",children:[w.jsx("h3",{className:"text-lg font-bold text-slate-800",children:e?"Editar Medicamento":"Nuevo Medicamento"}),w.jsx("button",{type:"button",onClick:t,className:"text-slate-400 hover:text-slate-600 transition-colors",children:w.jsx(fm,{size:24})})]}),w.jsxs("form",{onSubmit:r,className:"p-6 grid grid-cols-2 gap-4",children:[w.jsxs("div",{className:"col-span-2",children:[w.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase mb-1",children:"Nombre Comercial"}),w.jsx("input",{required:!0,name:"name",defaultValue:e?.name,className:"w-full border p-2.5 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm transition-all",placeholder:"Ej. Amoxicilina 500mg"})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase mb-1",children:"Categora"}),w.jsxs("select",{name:"category",defaultValue:e?.category,className:"w-full border p-2.5 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm bg-white",children:[w.jsx("option",{children:"Analgsico"}),w.jsx("option",{children:"Antibitico"}),w.jsx("option",{children:"Antiinflamatorio"}),w.jsx("option",{children:"Insumo Mdico"}),w.jsx("option",{children:"Protector Gstrico"})]})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase mb-1",children:"Unidad"}),w.jsx("input",{name:"unit",defaultValue:e?.unit||"Tabletas",className:"w-full border p-2.5 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm",placeholder:"Cajas, Tabletas..."})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase mb-1",children:"Lote"}),w.jsx("input",{name:"batch",defaultValue:e?.batch,className:"w-full border p-2.5 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm font-mono",placeholder:"LOT-000"})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase mb-1",children:"Vencimiento"}),w.jsx("input",{type:"date",name:"expiry_date",defaultValue:e?.expiry_date,className:"w-full border p-2.5 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm font-mono"})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase mb-1",children:"Stock Inicial"}),w.jsx("input",{type:"number",name:"stock",defaultValue:e?.stock||0,className:"w-full border p-2.5 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm font-mono"})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase mb-1",children:"Stock Mnimo"}),w.jsx("input",{type:"number",name:"min_stock",defaultValue:e?.min_stock||10,className:"w-full border p-2.5 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm font-mono"})]}),w.jsxs("div",{className:"col-span-2 pt-4 flex space-x-3",children:[w.jsx("button",{type:"button",onClick:t,className:"flex-1 border border-slate-200 py-3 rounded-xl hover:bg-slate-50 font-semibold transition-colors text-sm",children:"Cancelar"}),w.jsx("button",{type:"submit",className:"flex-1 bg-blue-600 text-white py-3 rounded-xl hover:bg-blue-700 font-semibold shadow-lg shadow-blue-200 transition-all text-sm",children:e?"Guardar Cambios":"Registrar"})]})]})]})})}function xE({activeTab:e}){const t=e==="dashboard"?"Resumen General":e==="inventory"?"Gestin de Inventario":e==="catalog"?"Catlogo de Productos":e==="consumption-monthly"?"Consumo Mensual":e==="consumption-summary"?"Resumen de Consumo":e==="order-request"?"Solicitud Pedido":e==="calendar"?"Calendario":e==="tertiary-packaging"?"Empaque Terciario":e==="categories"?"Categoras":"Alertas de Stock";return w.jsx("header",{className:"flex justify-between items-center mb-8",children:w.jsxs("div",{children:[w.jsx("h2",{className:"text-2xl font-bold text-slate-800 capitalize",children:t}),w.jsx("p",{className:"text-slate-500",children:"Sistema central de suministros mdicos."})]})})}function Mn({id:e,icon:t,label:r,activeTab:a,isSidebarOpen:s,onSelect:l}){return w.jsxs("button",{onClick:()=>l(e),className:`w-full flex items-center space-x-3 p-3 rounded-lg transition-colors ${a===e?"bg-blue-600 text-white shadow-md":"text-slate-600 hover:bg-blue-50"}`,children:[w.jsx(t,{size:20}),s&&w.jsx("span",{className:"font-medium",children:r})]})}function vE({activeTab:e,isSidebarOpen:t,onSelectTab:r,onToggleSidebar:a}){return w.jsxs("aside",{className:`bg-white border-r border-slate-200 transition-all duration-300 flex flex-col ${t?"w-64":"w-20"}`,children:[w.jsxs("div",{className:"p-6 flex items-center space-x-3 border-b border-slate-100",children:[w.jsx("div",{className:"bg-blue-600 p-2 rounded-lg text-white",children:w.jsx(Au,{size:24})}),t&&w.jsxs("h1",{className:"text-xl font-bold tracking-tight text-blue-900 leading-none",children:["BODEGA",w.jsx("br",{}),w.jsx("span",{className:"text-sm font-normal text-slate-500 tracking-normal",children:"PharmaStock v1.1"})]})]}),w.jsxs("nav",{className:"flex-1 p-4 space-y-2 mt-4",children:[w.jsx(Mn,{id:"dashboard",icon:KS,label:"Panel de Control",activeTab:e,isSidebarOpen:t,onSelect:r}),w.jsx(Mn,{id:"inventory",icon:Uy,label:"Inventario",activeTab:e,isSidebarOpen:t,onSelect:r}),w.jsx(Mn,{id:"catalog",icon:jy,label:"Catlogo",activeTab:e,isSidebarOpen:t,onSelect:r}),w.jsx(Mn,{id:"consumption-monthly",icon:fo,label:"Consumo mensual",activeTab:e,isSidebarOpen:t,onSelect:r}),w.jsx(Mn,{id:"consumption-summary",icon:Iy,label:"Resumen consumo",activeTab:e,isSidebarOpen:t,onSelect:r}),w.jsx(Mn,{id:"order-request",icon:cm,label:"Solicitud Pedido",activeTab:e,isSidebarOpen:t,onSelect:r}),w.jsx(Mn,{id:"calendar",icon:MS,label:"Calendario",activeTab:e,isSidebarOpen:t,onSelect:r}),w.jsx(Mn,{id:"tertiary-packaging",icon:Au,label:"Empaque Terciario",activeTab:e,isSidebarOpen:t,onSelect:r}),w.jsx(Mn,{id:"categories",icon:cE,label:"Categoras",activeTab:e,isSidebarOpen:t,onSelect:r}),w.jsx(Mn,{id:"alerts",icon:ii,label:"Alertas de Stock",activeTab:e,isSidebarOpen:t,onSelect:r})]}),w.jsx("div",{className:"p-4 border-t border-slate-100",children:w.jsx("button",{onClick:a,className:"p-2 hover:bg-slate-100 rounded-lg text-slate-400 w-full flex justify-center",children:t?w.jsx(fm,{size:20}):w.jsx(JS,{size:20})})})]})}function yE({lowStockItems:e,onEditMedication:t}){const r=a=>{const s=Number(a);return Number.isFinite(s)?s.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):String(a??"0")};return w.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.map(a=>w.jsxs("div",{className:"bg-white p-6 rounded-xl border-l-4 border-red-500 shadow-sm flex flex-col justify-between",children:[w.jsxs("div",{children:[w.jsxs("div",{className:"flex justify-between items-start mb-4",children:[w.jsx("h3",{className:"text-lg font-bold text-slate-800",children:a.name}),w.jsx("div",{className:"bg-red-100 p-2 rounded-full text-red-600",children:w.jsx(ii,{size:20})})]}),w.jsxs("div",{className:"space-y-2 mb-6 text-sm text-slate-600",children:[w.jsxs("p",{className:"flex justify-between",children:[w.jsx("span",{children:"Categora:"})," ",w.jsx("span",{className:"font-semibold",children:a.category})]}),w.jsxs("p",{className:"flex justify-between",children:[w.jsx("span",{children:"Stock Mnimo:"})," ",w.jsx("span",{className:"font-semibold",children:r(a.computed_min_stock??a.min_stock)})]}),w.jsxs("p",{className:"flex justify-between",children:[w.jsx("span",{children:"Stock Actual:"})," ",w.jsx("span",{className:"font-bold text-red-600 text-base",children:r(a.stock)})]})]})]}),w.jsx("button",{type:"button",onClick:()=>t(a),className:"w-full bg-blue-600 hover:bg-blue-700 text-white py-2 rounded-lg font-medium transition-colors",children:"Generar Orden de Compra"})]},a.id)),e.length===0&&w.jsxs("div",{className:"col-span-full py-20 text-center bg-white border border-dashed border-slate-300 rounded-2xl",children:[w.jsx("div",{className:"bg-green-100 text-green-600 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4",children:w.jsx(Au,{size:32})}),w.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"Todo en Orden!"}),w.jsx("p",{className:"text-slate-500 max-w-sm mx-auto",children:"No hay medicamentos que requieran atencin inmediata por falta de inventario."})]})]})}function _E({medications:e,excelStatus:t,fileInputRef:r,onChooseFile:a,onDownloadTemplate:s,onFileChange:l,onEditMedication:c,onDeleteMedication:u,onClearCatalog:h}){const d=x=>{const v=String(x??"").trim();return v.length<=50?{display:v,full:v}:{display:`${v.slice(0,50)}`,full:v}},g=Ie.useMemo(()=>{const x=_=>{const b=String(_||"").replace(/\D/g,"");return b.length<4?Number.POSITIVE_INFINITY:Number.parseInt(b.slice(-4),10)},v=_=>String(_||"").trim().startsWith("1-10");return[...e||[]].sort((_,b)=>{const y=_?.siges_code||"",S=b?.siges_code||"",k=v(y),R=v(S);if(k!==R)return k?-1:1;const T=x(y),j=x(S);return T!==j?T-j:String(y).localeCompare(String(S),"es",{numeric:!0,sensitivity:"base"})})},[e]);return w.jsx("div",{className:"space-y-6",children:w.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[w.jsxs("div",{className:"lg:col-span-1 bg-white p-6 rounded-2xl border border-slate-200 shadow-sm",children:[w.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[w.jsx("div",{className:"bg-green-100 text-green-600 p-2 rounded-lg",children:w.jsx(fo,{size:20})}),w.jsx("h3",{className:"font-bold text-slate-800",children:"Importar CSV"})]}),w.jsxs("p",{className:"text-sm text-slate-500 mb-6 leading-relaxed",children:["Cargue su catlogo masivamente. El archivo debe contener las columnas: ",w.jsx("br",{}),w.jsx("code",{className:"bg-slate-100 px-1 rounded text-blue-600 font-mono text-xs",children:"CodigoSIGES, ClasificadorSICOP, IdentificadorSICOP, Medicamento, Categoria, Lote, Vencimiento, Stock, StockMinimo, Unidad"})]}),w.jsx("input",{type:"file",ref:r,onChange:l,accept:".csv",className:"hidden"}),w.jsxs("button",{type:"button",onClick:a,className:"w-full flex flex-col items-center justify-center border-2 border-dashed border-slate-300 rounded-xl py-10 hover:border-blue-400 hover:bg-blue-50 transition-all group",children:[w.jsx(jy,{size:40,className:"text-slate-300 group-hover:text-blue-500 mb-2 transition-colors"}),w.jsx("span",{className:"text-sm font-semibold text-slate-600 group-hover:text-blue-700",children:"Seleccionar archivo CSV"}),w.jsx("span",{className:"text-xs text-slate-400 mt-1",children:"Soporta .csv"})]}),t.message&&w.jsxs("div",{className:`mt-4 p-3 rounded-lg text-xs flex items-center space-x-2 ${t.type==="success"?"bg-green-50 text-green-700 border border-green-100":t.type==="error"?"bg-red-50 text-red-700 border border-red-100":"bg-blue-50 text-blue-700 border border-blue-100"}`,children:[t.type==="success"?w.jsx(Vc,{size:16}):w.jsx(ii,{size:16}),w.jsx("span",{children:t.message})]})]}),w.jsxs("div",{className:"lg:col-span-2 bg-white rounded-2xl border border-slate-200 shadow-sm overflow-hidden",children:[w.jsxs("div",{className:"p-4 border-b border-slate-100 bg-slate-50 flex justify-between items-center",children:[w.jsx("h3",{className:"font-bold text-slate-800",children:"Vista Previa del Catlogo"}),w.jsxs("div",{className:"flex items-center gap-3",children:[w.jsxs("button",{type:"button",onClick:()=>{!e?.length||!window.confirm("Desea eliminar todo el catlogo? Esta accin no se puede deshacer.")||h?.()},disabled:!e?.length,className:"text-xs text-red-600 font-bold flex items-center space-x-1 hover:underline disabled:opacity-40 disabled:hover:no-underline",children:[w.jsx(io,{size:14}),w.jsx("span",{children:"Eliminar Catlogo"})]}),w.jsxs("button",{type:"button",onClick:s,className:"text-xs text-blue-600 font-bold flex items-center space-x-1 hover:underline",children:[w.jsx(Gc,{size:14}),w.jsx("span",{children:"Descargar Plantilla"})]})]})]}),w.jsx("div",{className:"max-h-[400px] overflow-y-auto",children:w.jsxs("table",{className:"w-full text-left",children:[w.jsx("thead",{className:"sticky top-0 bg-white shadow-sm text-slate-500 text-[10px] uppercase font-bold",children:w.jsxs("tr",{children:[w.jsx("th",{className:"px-6 py-3",children:"Cdigo SIGES"}),w.jsx("th",{className:"px-6 py-3",children:"Clasificador SICOP"}),w.jsx("th",{className:"px-6 py-3",children:"Identificador SICOP"}),w.jsx("th",{className:"px-6 py-3",children:"Medicamento"}),w.jsx("th",{className:"px-6 py-3 text-center",children:"Acciones"})]})}),w.jsx("tbody",{className:"divide-y divide-slate-100",children:g.map(x=>w.jsxs("tr",{className:"hover:bg-slate-50 transition-colors group",children:[w.jsx("td",{className:"px-6 py-3 text-sm text-slate-700 font-mono",children:x.siges_code||""}),w.jsx("td",{className:"px-6 py-3 text-sm text-slate-700 font-mono",children:x.sicop_classifier||""}),w.jsx("td",{className:"px-6 py-3 text-sm text-slate-700 font-mono",children:x.sicop_identifier||""}),w.jsx("td",{className:"px-6 py-3 text-sm font-medium text-slate-700",title:d(x.name).full,children:d(x.name).display}),w.jsx("td",{className:"px-6 py-3",children:w.jsxs("div",{className:"flex justify-center space-x-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[w.jsx("button",{type:"button",onClick:()=>c?.(x),className:"p-1.5 text-slate-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg","aria-label":"Editar",title:"Editar",children:w.jsx(eE,{size:14})}),w.jsx("button",{type:"button",onClick:()=>u?.(x.id),className:"p-1.5 text-slate-400 hover:text-red-600 hover:bg-red-50 rounded-lg","aria-label":"Eliminar",title:"Eliminar",children:w.jsx(io,{size:14})})]})})]},x.id))})]})})]})]})})}function Ud(e){const t=typeof e=="number"?e:Number(String(e??"").replace(/,/g,""));return Number.isFinite(t)?t:0}function jl(e){const t=Ud(e);return new Intl.NumberFormat("es-CR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(t)}function Py(e){return e.length?e.reduce((t,r)=>t+r,0)/e.length:0}function wE(e){if(e.length<=1)return 0;const t=Py(e),r=e.reduce((a,s)=>a+(s-t)**2,0)/e.length;return Math.sqrt(r)}function bE({siges_code:e,medication_name:t}){const r=String(e??"").trim();if(r)return`code:${r}`;const a=String(t??"").trim().toLowerCase();return a?`name:${a}`:""}function Xx(e){const t=String(e||"").replace(/\D/g,"");return t.length<4?Number.POSITIVE_INFINITY:Number.parseInt(t.slice(-4),10)}function Wx(e){return String(e||"").trim().startsWith("110")}function SE({status:e}){if(!e?.message)return null;const t=e.type==="success"?"bg-emerald-50 border-emerald-200 text-emerald-800":e.type==="error"?"bg-rose-50 border-rose-200 text-rose-800":"bg-blue-50 border-blue-200 text-blue-800";return w.jsx("div",{className:`border rounded-lg px-4 py-3 text-sm ${t}`,children:w.jsx("span",{children:e.message})})}function EE({months:e,onRefresh:t,status:r}){const a=(e??[]).slice(0,3),s=a.map(L=>String(L?.label??"").trim()).filter(Boolean),[l,c]=Ie.useState(""),[u,h]=Ie.useState(!0),[d,g]=Ie.useState(50),[x,v]=Ie.useState(1),_=Ie.useMemo(()=>{const L=new Map;return a.forEach((A,K)=>{const q=A?.items??[];for(const ie of q){const ne=String(ie?.siges_code??"").trim(),Z=String(ie?.medication_name??"").trim(),me=bE({siges_code:ne,medication_name:Z});if(!me)continue;const Re=L.get(me)??{siges_code:ne,medication_name:Z,perMonth:[0,0,0]};Re.siges_code=Re.siges_code||ne,Re.medication_name=Re.medication_name||Z,Re.perMonth[K]+=Ud(ie?.quantity),L.set(me,Re)}}),Array.from(L.values()).map(A=>{const K=A.perMonth.slice(0,3),q=Py(K),ie=wE(K);return{...A,avg:q,sd:ie,total:q+ie}})},[a]),b=Ie.useMemo(()=>{const L=l.trim().toLowerCase(),A=u?_.filter(q=>Ud(q.total)>0):_;return(L?A.filter(q=>`${q.siges_code} ${q.medication_name}`.toLowerCase().includes(L)):A).sort((q,ie)=>{const ne=q?.siges_code||"",Z=ie?.siges_code||"",me=Wx(ne),Re=Wx(Z);if(me!==Re)return me?-1:1;const Ae=Xx(ne),V=Xx(Z);return Ae!==V?Ae-V:String(ne).localeCompare(String(Z),"es",{numeric:!0,sensitivity:"base"})})},[u,_,l]),y=b.length,S=Math.max(1,Number(d)||50),k=Math.max(1,Math.ceil(y/S)),R=Math.min(Math.max(x,1),k),T=Ie.useMemo(()=>{const L=(R-1)*S;return b.slice(L,L+S)},[b,R,S]),j=y===0?0:(R-1)*S+1,X=Math.min(R*S,y);return w.jsxs("div",{className:"space-y-6",children:[w.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-5",children:[w.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[w.jsxs("div",{className:"space-y-1",children:[w.jsx("h3",{className:"font-semibold text-slate-800",children:"Resumen de consumo"}),w.jsx("p",{className:"text-xs text-slate-500",children:"Muestra por medicamento: cdigo, consumos de los ltimos 3 meses, promedio, desviacin estndar y total (promedio + desviacin)."})]}),w.jsx("div",{className:"flex flex-wrap items-center gap-2",children:w.jsxs("button",{type:"button",onClick:t,className:"px-3 py-2 rounded-lg border border-slate-200 text-slate-700 hover:bg-slate-50 text-sm flex items-center gap-2",children:[w.jsx(Wi,{size:16}),"Sincronizar"]})})]}),w.jsx("div",{className:"mt-4",children:w.jsx(SE,{status:r})})]}),w.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm overflow-hidden",children:[w.jsxs("div",{className:"p-4 border-b border-slate-100 bg-slate-50 flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("div",{className:"bg-blue-50 text-blue-600 p-2 rounded-lg",children:w.jsx(Iy,{size:18})}),w.jsx("h3",{className:"font-bold text-slate-800",children:"Consumo por medicamento (ltimos 3 meses)"})]}),w.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[w.jsx("button",{type:"button",onClick:()=>{h(L=>!L),v(1)},className:"px-3 py-2 rounded-lg border border-slate-200 text-slate-700 hover:bg-slate-50 text-sm",title:"Oculta medicamentos con consumo 0 en los ltimos 3 meses",children:u?"Mostrar sin consumo":"Ocultar sin consumo"}),w.jsx("input",{value:l,onChange:L=>{c(L.target.value),v(1)},placeholder:"Buscar por cdigo o medicamento...",className:"w-72 border border-slate-200 rounded-lg px-3 py-2 text-sm bg-white"})]})]}),a.length===0?w.jsx("div",{className:"p-8 text-center text-slate-500 text-sm",children:"No hay consumos cargados."}):w.jsxs(w.Fragment,{children:[w.jsx("div",{className:"overflow-x-auto",children:w.jsxs("table",{className:"w-full min-w-[1100px] text-left",children:[w.jsx("thead",{className:"sticky top-0 z-10 bg-slate-50 text-slate-500 text-[10px] uppercase font-bold shadow-sm",children:w.jsxs("tr",{children:[w.jsx("th",{className:"px-4 py-4 whitespace-nowrap w-36 text-center",children:"Cdigo SIGES"}),w.jsx("th",{className:"px-4 py-4 whitespace-nowrap text-center",children:"Medicamento"}),w.jsx("th",{className:"px-3 py-4 text-center whitespace-nowrap w-32",children:s[2]??"Mes 3"}),w.jsx("th",{className:"px-3 py-4 text-center whitespace-nowrap w-32",children:s[1]??"Mes 2"}),w.jsx("th",{className:"px-3 py-4 text-center whitespace-nowrap w-32",children:s[0]??"Mes 1"}),w.jsx("th",{className:"px-3 py-4 text-center whitespace-nowrap w-28",children:"Promedio"}),w.jsx("th",{className:"px-3 py-4 text-center whitespace-nowrap w-28",children:"Desv. Est."}),w.jsx("th",{className:"px-3 py-4 text-center whitespace-nowrap w-36",children:"Total (Prom.+Desv.)"})]})}),w.jsxs("tbody",{className:"divide-y divide-slate-100",children:[T.map((L,A)=>w.jsxs("tr",{className:"hover:bg-slate-50",children:[w.jsx("td",{className:"px-4 py-4 text-xs text-slate-600 font-mono whitespace-nowrap text-center",children:L.siges_code||""}),w.jsx("td",{className:"px-4 py-4 text-sm font-medium text-slate-700 whitespace-normal break-words",children:L.medication_name}),w.jsx("td",{className:"px-3 py-4 text-center font-mono text-sm tabular-nums",children:jl(L.perMonth[2]??0)}),w.jsx("td",{className:"px-3 py-4 text-center font-mono text-sm tabular-nums",children:jl(L.perMonth[1]??0)}),w.jsx("td",{className:"px-3 py-4 text-center font-mono text-sm tabular-nums",children:jl(L.perMonth[0]??0)}),w.jsx("td",{className:"px-3 py-4 text-center font-mono text-sm tabular-nums",children:jl(L.avg)}),w.jsx("td",{className:"px-3 py-4 text-center font-mono text-sm tabular-nums",children:jl(L.sd)}),w.jsx("td",{className:"px-3 py-4 text-center font-mono text-sm font-bold text-blue-700 tabular-nums",children:jl(L.total)})]},`${L.siges_code||L.medication_name}-${A}`)),T.length===0&&w.jsx("tr",{children:w.jsx("td",{colSpan:8,className:"px-6 py-10 text-center text-sm text-slate-400",children:"No hay resultados."})})]})]})}),w.jsxs("div",{className:"p-4 border-t border-slate-100 bg-slate-50 flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[w.jsx("div",{className:"text-xs text-slate-500",children:y===0?"0 resultados":`Mostrando ${j}-${X} de ${y}`}),w.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[w.jsx("label",{className:"text-xs text-slate-500",children:"Filas"}),w.jsx("select",{value:S,onChange:L=>{g(Number(L.target.value)||50),v(1)},className:"border border-slate-200 rounded-lg px-2 py-1 text-xs bg-white",children:[25,50,100,200].map(L=>w.jsx("option",{value:L,children:L},L))}),w.jsx("button",{type:"button",onClick:()=>v(L=>Math.max(1,L-1)),disabled:R<=1,className:"px-3 py-1.5 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 disabled:opacity-40 disabled:hover:bg-white",children:"Anterior"}),w.jsxs("span",{className:"text-xs text-slate-600",children:["Pgina ",R," de ",k]}),w.jsx("button",{type:"button",onClick:()=>v(L=>Math.min(k,L+1)),disabled:R>=k,className:"px-3 py-1.5 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 disabled:opacity-40 disabled:hover:bg-white",children:"Siguiente"})]})]})]})]})]})}function cu({title:e,value:t,icon:r,color:a}){const s={blue:"bg-blue-50 text-blue-600 border-blue-100",red:"bg-red-50 text-red-600 border-red-100",green:"bg-green-50 text-green-600 border-green-100",purple:"bg-purple-50 text-purple-600 border-purple-100"},l=typeof t=="number"?new Intl.NumberFormat("en-US",{minimumFractionDigits:0,maximumFractionDigits:e==="Total Unidades"?2:0}).format(t):t;return w.jsxs("div",{className:"p-6 rounded-2xl border bg-white shadow-sm flex items-center space-x-4",children:[w.jsx("div",{className:`p-4 rounded-xl ${s[a]||s.blue}`,children:w.jsx(r,{size:24})}),w.jsxs("div",{children:[w.jsx("p",{className:"text-sm font-medium text-slate-500",children:e}),w.jsx("p",{className:"text-2xl font-bold text-slate-800",children:l})]})]})}function TE({stats:e,consumptions:t,lowStockItems:r,onViewAllConsumptions:a,onEditMedication:s}){const l=c=>{const u=Number(c);return Number.isFinite(u)?u.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):String(c??"0")};return w.jsxs("div",{className:"space-y-8",children:[w.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[w.jsx(cu,{title:"Total Medicamentos",value:e.totalItems,icon:Uy,color:"blue"}),w.jsx(cu,{title:"Stock Crtico",value:e.lowStockCount,icon:ii,color:"red"}),w.jsx(cu,{title:"Total Unidades",value:e.totalStockValue,icon:Au,color:"green"}),w.jsx(cu,{title:"Consumos Recientes",value:e.recentConsumptions,icon:cm,color:"purple"})]}),w.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[w.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[w.jsxs("div",{className:"flex justify-between items-center mb-4",children:[w.jsx("h3",{className:"font-bold text-slate-800",children:"ltimos Consumos"}),w.jsxs("button",{type:"button",onClick:a,className:"text-blue-600 text-sm flex items-center hover:underline",children:["Ver todo ",w.jsx(IS,{size:14})]})]}),w.jsx("div",{className:"space-y-4",children:t.slice(0,5).map(c=>w.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-lg",children:[w.jsxs("div",{className:"flex items-center space-x-3",children:[w.jsx("div",{className:"bg-white p-2 rounded-md shadow-sm border border-slate-100 text-slate-400",children:w.jsx(hE,{size:16})}),w.jsxs("div",{children:[w.jsx("p",{className:"font-semibold text-sm",children:c.medication_name}),w.jsx("p",{className:"text-xs text-slate-500",children:c.siges_code||c.date||""})]})]}),w.jsxs("div",{className:"text-right",children:[w.jsx("p",{className:"text-sm font-bold text-slate-800",children:c.quantity}),w.jsx("p",{className:"text-xs text-slate-500 font-mono",children:c.cost??c.user??""})]})]},c.id))})]}),w.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[w.jsxs("div",{className:"flex justify-between items-center mb-4",children:[w.jsx("h3",{className:"font-bold text-slate-800",children:"Medicamentos Agotndose"}),w.jsxs("span",{className:"bg-red-100 text-red-700 text-xs px-2 py-1 rounded-full font-bold",children:[r.length," Alertas"]})]}),w.jsx("div",{className:"space-y-4",children:r.length>0?r.map(c=>w.jsxs("div",{className:"flex items-center justify-between p-3 border-l-4 border-red-500 bg-red-50 rounded-r-lg",children:[w.jsxs("div",{children:[w.jsx("p",{className:"font-semibold text-sm text-slate-800",children:c.name}),w.jsxs("p",{className:"text-xs text-slate-500",children:["Mnimo: ",l(c.computed_min_stock??c.min_stock)," | Actual: ",l(c.stock)]})]}),w.jsx("button",{type:"button",onClick:()=>s(c),className:"text-xs bg-white border border-red-200 text-red-600 px-3 py-1 rounded hover:bg-red-100 transition-colors",children:"Reponer"})]},c.id)):w.jsx("div",{className:"text-center py-8",children:w.jsx("p",{className:"text-slate-400 text-sm italic",children:"No hay alertas activas de inventario."})})})]})]})]})}function kE({inventoryType:e,onInventoryTypeChange:t,inventoryStatus:r,fileInputRef:a,onChooseFile:s,onFileChange:l,onDownloadTemplate:c,onRefresh:u,canClear:h,onClearInventory:d,hideNoMovement:g,canToggleHideNoMovement:x,onToggleHideNoMovement:v,search:_,onSearchChange:b,items:y,totalItems:S,page:k,pageSize:R,onPageChange:T,onPageSizeChange:j}){const X=String(e||"772"),L=X==="771",A=X==="total",K=A?"w-[260px] max-w-[260px]":"max-w-[620px]",q=xe=>{const J=Number(xe);return Number.isFinite(J)?J.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):String(xe??"0")},ie=xe=>{const J=String(xe??"").trim();if(!J)return"S/N";const be=J.match(/^(\d{4})-(\d{2})-(\d{2})/);if(be)return`${be[3]}/${be[2]}/${be[1]}`;const I=new Date(J);if(!Number.isNaN(I.getTime())){const N=String(I.getDate()).padStart(2,"0"),U=String(I.getMonth()+1).padStart(2,"0"),M=String(I.getFullYear());return`${N}/${U}/${M}`}return J},ne=xe=>{if(!xe)return"";const J=String(xe.batch||"").trim()||"S/N",be=ie(xe.expiry_date),I=q(xe.stock);return`${J} (${be}): ${I}`},Z=Number(S)||0,me=Number(R)||50,Re=Math.max(1,Math.ceil(Z/me)),Ae=Math.min(Math.max(Number(k)||1,1),Re),V=Z===0?0:(Ae-1)*me+1,ae=Math.min(Ae*me,Z);return w.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden",children:[w.jsxs("div",{className:"p-4 border-b border-slate-100 bg-slate-50 flex flex-col gap-3",children:[w.jsxs("div",{className:"flex flex-wrap gap-3 items-center justify-between",children:[w.jsx("div",{className:"flex items-center gap-2",children:[{key:"772",label:"Inventario 772"},{key:"771",label:"Inventario 771"},{key:"total",label:"Inventario total"}].map(xe=>w.jsx("button",{type:"button",onClick:()=>t?.(xe.key),className:`px-3 py-1.5 rounded-lg text-xs font-bold border transition-colors ${X===xe.key?"bg-blue-600 text-white border-blue-600":"bg-white text-slate-600 border-slate-200 hover:bg-blue-50 hover:text-blue-700"}`,children:xe.label},xe.key))}),w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsxs("button",{type:"button",onClick:u,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 flex items-center gap-2",title:"Sincronizar inventarios",children:[w.jsx(Wi,{size:14}),"Sincronizar"]}),A&&w.jsxs("button",{type:"button",onClick:()=>v?.(),disabled:!x,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 flex items-center gap-2 disabled:opacity-40 disabled:hover:bg-white",title:x?"Oculta medicamentos sin consumo en los ltimos 4 meses.":"No hay consumos cargados para filtrar.",children:[g?w.jsx(VS,{size:14}):w.jsx(HS,{size:14}),g?"Mostrar sin movimiento":"Ocultar sin movimiento (4 meses)"]}),!A&&w.jsxs(w.Fragment,{children:[w.jsx("input",{type:"file",ref:a,onChange:l,accept:L?".xml":".csv",className:"hidden"}),w.jsxs("button",{type:"button",onClick:s,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-blue-50 hover:text-blue-700 flex items-center gap-2",children:[w.jsx(fo,{size:14}),L?"Cargar XML":"Cargar CSV"]}),w.jsxs("button",{type:"button",onClick:()=>c?.(e),className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 flex items-center gap-2",children:[w.jsx(Gc,{size:14}),"Plantilla"]}),w.jsxs("button",{type:"button",onClick:()=>d?.(e),disabled:!h,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-red-200 text-red-600 hover:bg-red-50 flex items-center gap-2 disabled:opacity-40 disabled:hover:bg-white",title:"Eliminar toda la carga de este inventario",children:[w.jsx(io,{size:14}),"Eliminar carga"]})]})]})]}),r?.message&&w.jsxs("div",{className:`p-3 rounded-lg text-xs flex items-center gap-2 ${r.type==="success"?"bg-green-50 text-green-700 border border-green-100":r.type==="error"?"bg-red-50 text-red-700 border border-red-100":"bg-blue-50 text-blue-700 border border-blue-100"}`,children:[r.type==="success"?w.jsx(Vc,{size:16}):w.jsx(ii,{size:16}),w.jsx("span",{children:r.message})]}),w.jsxs("div",{className:"relative w-72",children:[w.jsx(um,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:18}),w.jsx("input",{type:"text",value:_,onChange:xe=>b(xe.target.value),placeholder:"Buscar medicamento...",className:"w-full pl-10 pr-4 py-2 border border-slate-200 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 outline-none"})]})]}),w.jsx("div",{className:"overflow-x-auto",children:w.jsxs("table",{className:"min-w-max w-full text-left",children:[w.jsx("thead",{className:"bg-slate-50 text-slate-500 text-[10px] uppercase font-bold",children:w.jsxs("tr",{children:[w.jsx("th",{className:"px-6 py-4 text-center whitespace-nowrap",children:"Cdigo SIGES"}),w.jsx("th",{className:`px-6 py-4 whitespace-nowrap ${K}`,children:"Medicamento"}),A&&w.jsx("th",{className:"px-6 py-4 text-center whitespace-nowrap",children:"Inv. 772"}),(L||A)&&w.jsx("th",{className:"px-6 py-4 whitespace-nowrap",children:"Lotes 771 (venc. / cant.)"}),A&&w.jsx("th",{className:"px-6 py-4 text-center whitespace-nowrap",children:"Inv. 771"}),w.jsx("th",{className:"px-6 py-4 text-center whitespace-nowrap",children:A?"Inventario total":"Inventario"})]})}),w.jsxs("tbody",{className:"divide-y divide-slate-100",children:[y.map(xe=>w.jsxs("tr",{className:"hover:bg-slate-50 transition-colors group text-sm",children:[w.jsx("td",{className:"px-6 py-4 text-slate-700 font-mono text-center whitespace-nowrap",children:xe.siges_code||""}),w.jsx("td",{className:`px-6 py-4 ${K} text-slate-700`,children:w.jsx("span",{className:"block truncate",children:xe.name})}),A&&w.jsx("td",{className:"px-6 py-4 text-center whitespace-nowrap text-slate-700 font-mono",children:q(xe.stock772)}),(L||A)&&w.jsx("td",{className:`px-6 py-4 text-slate-600 font-mono ${A?"text-center":""}`,children:w.jsx("div",{className:`flex flex-col gap-1 ${A?"items-center":""}`,children:Array.isArray(xe.lots)&&xe.lots.length>0?xe.lots.map(J=>w.jsx("div",{className:"whitespace-nowrap",children:ne(J)},J.id||`${J.batch}-${J.expiry_date}`)):w.jsx("div",{className:"whitespace-nowrap",children:A?"":ne(xe)})})}),A&&w.jsx("td",{className:"px-6 py-4 text-center whitespace-nowrap text-slate-700 font-mono",children:q(xe.stock771)}),w.jsx("td",{className:"px-6 py-4 text-center whitespace-nowrap text-slate-800",children:w.jsx("span",{className:"font-bold",children:q(xe.stock)})})]},xe.id)),y.length===0&&w.jsx("tr",{children:w.jsxs("td",{colSpan:A?6:L?4:3,className:"px-6 py-10 text-center text-sm text-slate-400",children:['No hay resultados para "',_,'".']})})]})]})}),w.jsxs("div",{className:"p-4 border-t border-slate-100 bg-slate-50 flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[w.jsx("div",{className:"text-xs text-slate-500",children:Z===0?"0 resultados":`Mostrando ${V}-${ae} de ${Z}`}),w.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[w.jsx("label",{className:"text-xs text-slate-500",children:"Filas"}),w.jsx("select",{value:me,onChange:xe=>j?.(Number(xe.target.value)||50),className:"border border-slate-200 rounded-lg px-2 py-1 text-xs bg-white",children:[25,50,100,200].map(xe=>w.jsx("option",{value:xe,children:xe},xe))}),w.jsx("button",{type:"button",onClick:()=>T?.(Ae-1),disabled:Ae<=1,className:"px-3 py-1.5 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 disabled:opacity-40 disabled:hover:bg-white",children:"Anterior"}),w.jsxs("span",{className:"text-xs text-slate-600",children:["Pgina ",Ae," de ",Re]}),w.jsx("button",{type:"button",onClick:()=>T?.(Ae+1),disabled:Ae>=Re,className:"px-3 py-1.5 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 disabled:opacity-40 disabled:hover:bg-white",children:"Siguiente"})]})]})]})}function AE({status:e}){if(!e?.message)return null;const t=e.type==="success"?"bg-emerald-50 border-emerald-200 text-emerald-800":e.type==="error"?"bg-rose-50 border-rose-200 text-rose-800":"bg-blue-50 border-blue-200 text-blue-800";return w.jsx("div",{className:`border rounded-lg px-4 py-3 text-sm ${t}`,children:w.jsx("span",{children:e.message})})}function CE({months:e,selectedMonthId:t,onSelectMonth:r,monthlyStatus:a,fileInputRef:s,onChooseFile:l,onFileChange:c,onDownloadTemplate:u,onRefresh:h}){const d=e.find(v=>v.id===t)||null,g=v=>{const _=typeof v=="number"?v:Number(v);return Number.isFinite(_)?new Intl.NumberFormat("es-CR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(_):""},x=v=>{const _=typeof v=="number"?v:Number(v);return Number.isFinite(_)?new Intl.NumberFormat("es-CR",{style:"currency",currency:"CRC",minimumFractionDigits:2,maximumFractionDigits:2}).format(_):""};return w.jsxs("div",{className:"space-y-4",children:[w.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-5",children:[w.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[w.jsxs("div",{className:"space-y-1",children:[w.jsx("h3",{className:"font-semibold text-slate-800",children:"Importar consumo mensual"}),w.jsxs("p",{className:"text-xs text-slate-500",children:["Recomendado: nombre del archivo ",w.jsx("span",{className:"font-mono",children:"Enero 2025.csv"})," (se usa como nombre del mes)."]})]}),w.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[w.jsx("input",{type:"file",ref:s,onChange:c,accept:".csv",className:"hidden"}),w.jsxs("button",{type:"button",onClick:u,className:"px-3 py-2 rounded-lg border border-slate-200 text-slate-700 hover:bg-slate-50 text-sm flex items-center gap-2",children:[w.jsx(qS,{size:16}),"Descargar plantilla"]}),w.jsxs("button",{type:"button",onClick:h,className:"px-3 py-2 rounded-lg border border-slate-200 text-slate-700 hover:bg-slate-50 text-sm flex items-center gap-2",children:[w.jsx(Wi,{size:16}),"Sincronizar"]}),w.jsxs("button",{type:"button",onClick:l,className:"px-3 py-2 rounded-lg bg-blue-600 hover:bg-blue-700 text-white text-sm flex items-center gap-2",children:[w.jsx(fo,{size:16}),"Importar CSV"]})]})]}),w.jsx("div",{className:"mt-4",children:w.jsx(AE,{status:a})}),w.jsxs("div",{className:"mt-4 flex flex-col gap-2 md:flex-row md:items-center",children:[w.jsx("label",{className:"text-xs font-semibold text-slate-600",children:"Mes cargado"}),w.jsxs("select",{className:"border border-slate-200 rounded-lg px-3 py-2 text-sm bg-white",value:t??"",onChange:v=>r(v.target.value||null),children:[w.jsx("option",{value:"",children:"Seleccione un mes..."}),e.map(v=>w.jsx("option",{value:v.id,children:v.label},v.id))]})]})]}),w.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden",children:[w.jsxs("div",{className:"px-6 py-4 border-b border-slate-100 flex items-center justify-between",children:[w.jsx("h4",{className:"font-semibold text-slate-800",children:d?`Detalle: ${d.label}`:"Detalle del mes"}),d&&w.jsxs("span",{className:"text-xs text-slate-500",children:[d.items.length," registros"]})]}),d?d.items.length===0?w.jsx("div",{className:"p-8 text-center text-slate-500 text-sm",children:"No hay consumos en este mes."}):w.jsxs("table",{className:"w-full text-left",children:[w.jsx("thead",{className:"bg-slate-50 text-slate-500 text-[10px] uppercase font-bold",children:w.jsxs("tr",{children:[w.jsx("th",{className:"px-6 py-4 whitespace-nowrap w-32 text-center",children:"Cdigo SIGES"}),w.jsx("th",{className:"px-6 py-4",children:"Medicamento"}),w.jsx("th",{className:"px-6 py-4 text-center whitespace-nowrap",children:"Consumo"}),w.jsx("th",{className:"px-6 py-4 text-center whitespace-nowrap",children:"Costo"})]})}),w.jsx("tbody",{className:"divide-y divide-slate-100",children:d.items.map(v=>w.jsxs("tr",{className:"hover:bg-slate-50",children:[w.jsx("td",{className:"px-6 py-4 text-xs text-slate-500 font-mono whitespace-nowrap w-32 text-center",children:v.siges_code||""}),w.jsx("td",{className:"px-6 py-4 text-sm font-medium",children:v.medication_name}),w.jsx("td",{className:"px-6 py-4 text-center text-slate-800 font-semibold text-sm tabular-nums",children:g(v.quantity)}),w.jsx("td",{className:"px-6 py-4 text-center text-slate-700 text-sm font-mono tabular-nums",children:x(v.cost)})]},v.id))})]}):w.jsx("div",{className:"p-8 text-center text-slate-500 text-sm",children:"Importa un CSV y selecciona un mes para ver el detalle."})]})]})}function Ys(e){const t=typeof e=="number"?e:Number(String(e??"").trim().replace(/\s/g,"").replace(/,/g,""));return Number.isFinite(t)?t:0}function Xs(e){const t=Ys(e);return new Intl.NumberFormat("es-CR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(t)}function zy(e){return e.length?e.reduce((t,r)=>t+r,0)/e.length:0}function NE(e){if(e.length<=1)return 0;const t=zy(e),r=e.reduce((a,s)=>a+(s-t)**2,0)/e.length;return Math.sqrt(r)}function OE({siges_code:e,medication_name:t}){const r=String(e??"").trim();if(r)return`code:${r}`;const a=String(t??"").trim().toLowerCase();return a?`name:${a}`:""}function Kx(e){const t=String(e||"").replace(/\D/g,"");return t.length<4?Number.POSITIVE_INFINITY:Number.parseInt(t.slice(-4),10)}function Yx(e){return String(e||"").trim().startsWith("110")}function Jx({status:e}){if(!e?.message)return null;const t=e.type==="success"?"bg-emerald-50 border-emerald-200 text-emerald-800":e.type==="error"?"bg-rose-50 border-rose-200 text-rose-800":"bg-blue-50 border-blue-200 text-blue-800";return w.jsx("div",{className:`border rounded-lg px-4 py-3 text-sm ${t}`,children:w.jsx("span",{children:e.message})})}function RE({medications:e,months:t,tertiaryPackaging:r,medicationCategories:a,inventoryStatus:s,monthlyStatus:l,onRefreshInventories:c,onRefreshConsumptions:u}){const[h,d]=Ie.useState(2),[g,x]=Ie.useState(""),[v,_]=Ie.useState(!0),[b,y]=Ie.useState("Todas"),[S,k]=Ie.useState(50),[R,T]=Ie.useState(1),j=Ie.useMemo(()=>{const V=(t??[]).slice(0,3),ae=V.map(M=>String(M?.label??"").trim()).filter(Boolean),xe=new Map;for(const M of a??[]){const P=String(M?.siges_code??"").trim();if(!P)continue;const te=String(M?.category??"").trim();te&&xe.set(P,te)}const J=new Map;for(const M of r??[]){const P=String(M?.siges_code??"").trim();if(!P)continue;const te=Ys(M?.tertiary_quantity);te>0&&J.set(P,te)}const be=new Map;for(const M of e??[]){const P=String(M?.siges_code??"").trim();if(!P)continue;const te=String(M?.inventory_type||"772"),pe=be.get(P)??{inv771:0,inv772:0};te==="771"&&(pe.inv771+=Ys(M?.stock)),te==="772"&&(pe.inv772+=Ys(M?.stock)),be.set(P,pe)}const I=new Map;V.forEach((M,P)=>{const te=M?.items??[];for(const pe of te){const Ee=String(pe?.siges_code??"").trim(),ve=String(pe?.medication_name??"").trim(),Te=OE({siges_code:Ee,medication_name:ve});if(!Te)continue;const tt=I.get(Te)??{siges_code:Ee,medication_name:ve,perMonth:[0,0,0]};tt.siges_code=tt.siges_code||Ee,tt.medication_name=tt.medication_name||ve,tt.perMonth[P]+=Ys(pe?.quantity),I.set(Te,tt)}});const N=Math.max(0,Number(h)||0),U=Array.from(I.values()).map(M=>{const P=M.perMonth.slice(0,3),te=zy(P),pe=NE(P),Ee=te+pe,ve=String(M.siges_code??"").trim(),Te=be.get(ve)??{inv771:0,inv772:0},tt=Ys(Te.inv771)+Ys(Te.inv772),G=Ee*N-tt,Rt=Math.max(0,G),We=J.get(ve)??0,bt=We>0?Rt===0?0:Math.ceil(Rt/We)*We:Rt,lt=xe.get(ve)??"";return{siges_code:ve,medication_name:M.medication_name,consumoTotal:Ee,invTotal:tt,empaqueTerciario:We,pedido:bt,category:lt}});return{monthLabels:ae,rows:U}},[a,e,t,h,r]),X=j.monthLabels??[],L=Ie.useMemo(()=>{const V=g.trim().toLowerCase(),ae=j.rows??[],xe=v?ae.filter(I=>Ys(I.pedido)>0):ae,J=b==="Todas"?xe:b==="Sin categora"?xe.filter(I=>!String(I.category||"").trim()):xe.filter(I=>String(I.category||"").trim()===b);return(V?J.filter(I=>`${I.siges_code} ${I.medication_name}`.toLowerCase().includes(V)):J).sort((I,N)=>{const U=I?.siges_code||"",M=N?.siges_code||"",P=Yx(U),te=Yx(M);if(P!==te)return P?-1:1;const pe=Kx(U),Ee=Kx(M);return pe!==Ee?pe-Ee:String(U).localeCompare(String(M),"es",{numeric:!0,sensitivity:"base"})})},[b,j.rows,v,g]),A=L.length,K=Math.max(1,Number(S)||50),q=Math.max(1,Math.ceil(A/K)),ie=Math.min(Math.max(R,1),q),ne=A===0?0:(ie-1)*K+1,Z=Math.min(ie*K,A),me=Ie.useMemo(()=>{const V=(ie-1)*K;return L.slice(V,V+K)},[L,ie,K]),Re=Ie.useMemo(()=>{const V=new Set;for(const ae of a??[]){const xe=String(ae?.category??"").trim();xe&&V.add(xe)}return["Todas",...Array.from(V).sort((ae,xe)=>ae.localeCompare(xe,"es")),"Sin categora"]},[a]),Ae=()=>{const V=new Date,ae=`${String(V.getDate()).padStart(2,"0")}/${String(V.getMonth()+1).padStart(2,"0")}/${V.getFullYear()}`,xe="Solicitud Pedido (filtrado)",J=X.length?X.slice().reverse().join(", "):"Sin datos",be=b||"Todas",I=P=>String(P??"").replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;"),N=L.map(P=>{const te=I(P.siges_code),pe=I(P.medication_name),Ee=I(Xs(P.consumoTotal)),ve=I(Xs(P.invTotal)),Te=P.empaqueTerciario?I(Xs(P.empaqueTerciario)):"",tt=I(Xs(P.pedido));return`<tr>
          <td class="mono center">${te}</td>
          <td>${pe}</td>
          <td class="mono right">${Ee}</td>
          <td class="mono right">${ve}</td>
          <td class="mono right">${Te}</td>
          <td class="mono right strong">${tt}</td>
        </tr>`}).join(""),U=`<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>${I(xe)}</title>
    <style>
      @page { size: A4 landscape; margin: 12mm; }
      body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; color: #0f172a; }
      h1 { font-size: 16px; margin: 0 0 4px; }
      .meta { font-size: 12px; color: #475569; margin-bottom: 10px; }
      table { width: 100%; border-collapse: collapse; font-size: 11px; }
      th, td { border: 1px solid #e2e8f0; padding: 6px 8px; vertical-align: top; }
      th { background: #f8fafc; text-transform: uppercase; font-size: 10px; letter-spacing: .04em; }
      .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace; }
      .center { text-align: center; }
      .right { text-align: right; }
      .strong { font-weight: 700; color: #1d4ed8; }
    </style>
  </head>
  <body>
    <h1>${I(xe)}</h1>
    <div class="meta">Generado: ${I(ae)}  Meses usados: ${I(J)}  Meses a pedir: ${I(h)}  Categora: ${I(be)}  Filas: ${I(L.length)}</div>
    <table>
      <thead>
        <tr>
          <th>Cdigo</th>
          <th>Medicamento</th>
          <th>Consumo total</th>
          <th>Inventario total</th>
          <th>Empaque terciario</th>
          <th>Pedido</th>
        </tr>
      </thead>
      <tbody>${N||""}</tbody>
    </table>
    <script>window.onload = () => { window.focus(); window.print(); };<\/script>
  </body>
</html>`,M=window.open("","_blank","noopener,noreferrer");M&&(M.document.open(),M.document.write(U),M.document.close())};return w.jsxs("div",{className:"space-y-6",children:[w.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-5",children:[w.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[w.jsxs("div",{className:"space-y-1",children:[w.jsx("h3",{className:"font-semibold text-slate-800",children:"Solicitud Pedido"}),w.jsx("p",{className:"text-xs text-slate-500",children:"Pedido = (Consumo total  Meses)  (Inventario total). Consumo total = Promedio + Desv. Est. Inventario total = Inv. 772 + Inv. 771."})]}),w.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[w.jsxs("button",{type:"button",onClick:()=>{u?.(),c?.()},className:"px-3 py-2 rounded-lg border border-slate-200 text-slate-700 hover:bg-slate-50 text-sm flex items-center gap-2",children:[w.jsx(Wi,{size:16}),"Sincronizar"]}),w.jsxs("button",{type:"button",onClick:Ae,className:"px-3 py-2 rounded-lg border border-slate-200 text-slate-700 hover:bg-slate-50 text-sm flex items-center gap-2",title:"Exporta lo filtrado usando la impresora del navegador (Guardar como PDF).",children:[w.jsx(Gc,{size:16}),"Exportar PDF"]})]})]}),w.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-3 gap-3",children:[w.jsxs("div",{className:"md:col-span-1",children:[w.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase mb-1",children:"Meses a pedir"}),w.jsx("input",{type:"number",min:0,step:1,value:h,onChange:V=>{d(Number(V.target.value)||0),T(1)},className:"w-full border border-slate-200 rounded-lg px-3 py-2 text-sm bg-white"})]}),w.jsxs("div",{className:"md:col-span-2 flex flex-col gap-2",children:[w.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase mb-1",children:"Filtros"}),w.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[w.jsx("select",{value:b,onChange:V=>{y(V.target.value),T(1)},className:"border border-slate-200 rounded-lg px-3 py-2 text-sm bg-white",title:"Filtrar por categora",children:Re.map(V=>w.jsx("option",{value:V,children:V},V))}),w.jsx("button",{type:"button",onClick:()=>{_(V=>!V),T(1)},className:"px-3 py-2 rounded-lg border border-slate-200 text-slate-700 hover:bg-slate-50 text-sm",children:v?"Mostrar pedido 0":"Ocultar pedido 0"}),w.jsx("input",{value:g,onChange:V=>{x(V.target.value),T(1)},placeholder:"Buscar por cdigo o medicamento...",className:"flex-1 min-w-72 border border-slate-200 rounded-lg px-3 py-2 text-sm bg-white"})]})]})]}),w.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-3",children:[w.jsx(Jx,{status:s}),w.jsx(Jx,{status:l})]})]}),w.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm overflow-hidden",children:[w.jsxs("div",{className:"p-4 border-b border-slate-100 bg-slate-50 flex items-center justify-between",children:[w.jsxs("div",{className:"flex items-center gap-3",children:[w.jsx("div",{className:"bg-blue-50 text-blue-600 p-2 rounded-lg",children:w.jsx(cm,{size:18})}),w.jsxs("div",{children:[w.jsx("h3",{className:"font-bold text-slate-800",children:"Clculo por medicamento"}),w.jsxs("p",{className:"text-xs text-slate-500",children:["Meses usados: ",X.length?X.slice().reverse().join(", "):"Sin datos"]})]})]}),w.jsxs("span",{className:"text-xs text-slate-500",children:[A," filas"]})]}),w.jsx("div",{className:"overflow-auto max-h-[70vh]",children:w.jsxs("table",{className:"w-full min-w-[860px] text-left",children:[w.jsx("thead",{className:"sticky top-0 z-10 bg-slate-50 text-slate-500 text-[10px] uppercase font-bold shadow-sm",children:w.jsxs("tr",{children:[w.jsx("th",{className:"px-4 py-4 whitespace-nowrap w-36 text-center",children:"Cdigo"}),w.jsx("th",{className:"px-4 py-4 whitespace-nowrap",children:"Medicamento"}),w.jsx("th",{className:"px-3 py-4 text-center whitespace-nowrap w-40",children:"Consumo total"}),w.jsx("th",{className:"px-3 py-4 text-center whitespace-nowrap w-40",children:"Inventario total"}),w.jsx("th",{className:"px-3 py-4 text-center whitespace-nowrap w-40",children:"Empaque terciario"}),w.jsx("th",{className:"px-3 py-4 text-center whitespace-nowrap w-40",children:"Pedido"})]})}),w.jsxs("tbody",{className:"divide-y divide-slate-100",children:[me.map((V,ae)=>w.jsxs("tr",{className:"hover:bg-slate-50",children:[w.jsx("td",{className:"px-4 py-4 text-xs text-slate-600 font-mono whitespace-nowrap text-center",children:V.siges_code||""}),w.jsx("td",{className:"px-4 py-4 text-sm font-medium text-slate-700 whitespace-normal break-words",children:V.medication_name}),w.jsx("td",{className:"px-3 py-4 text-center font-mono text-sm tabular-nums",children:Xs(V.consumoTotal)}),w.jsx("td",{className:"px-3 py-4 text-center font-mono text-sm tabular-nums",children:Xs(V.invTotal)}),w.jsx("td",{className:"px-3 py-4 text-center font-mono text-sm tabular-nums",children:V.empaqueTerciario?Xs(V.empaqueTerciario):""}),w.jsx("td",{className:"px-3 py-4 text-center font-mono text-sm font-bold text-blue-700 tabular-nums",children:Xs(V.pedido)})]},`${V.siges_code||V.medication_name}-${ae}`)),me.length===0&&w.jsx("tr",{children:w.jsx("td",{colSpan:6,className:"px-6 py-10 text-center text-sm text-slate-400",children:"No hay resultados."})})]})]})}),w.jsxs("div",{className:"p-4 border-t border-slate-100 bg-slate-50 flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[w.jsx("div",{className:"text-xs text-slate-500",children:A===0?"0 resultados":`Mostrando ${ne}-${Z} de ${A}`}),w.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[w.jsx("label",{className:"text-xs text-slate-500",children:"Filas"}),w.jsx("select",{value:K,onChange:V=>{k(Number(V.target.value)||50),T(1)},className:"border border-slate-200 rounded-lg px-2 py-1 text-xs bg-white",children:[25,50,100,200].map(V=>w.jsx("option",{value:V,children:V},V))}),w.jsx("button",{type:"button",onClick:()=>T(V=>Math.max(1,V-1)),disabled:ie<=1,className:"px-3 py-1.5 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 disabled:opacity-40 disabled:hover:bg-white",children:"Anterior"}),w.jsxs("span",{className:"text-xs text-slate-600",children:["Pgina ",ie," de ",q]}),w.jsx("button",{type:"button",onClick:()=>T(V=>Math.min(q,V+1)),disabled:ie>=q,className:"px-3 py-1.5 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 disabled:opacity-40 disabled:hover:bg-white",children:"Siguiente"})]})]})]})]})}function DE({status:e,fileInputRef:t,onChooseFile:r,onFileChange:a,onDownloadTemplate:s,onRefresh:l,canClear:c,onClear:u,search:h,onSearchChange:d,items:g,totalItems:x,page:v,pageSize:_,onPageChange:b,onPageSizeChange:y}){const S=A=>{const K=Number(A);return Number.isFinite(K)?K.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):String(A??"0")},k=Number(x)||0,R=Number(_)||50,T=Math.max(1,Math.ceil(k/R)),j=Math.min(Math.max(Number(v)||1,1),T),X=k===0?0:(j-1)*R+1,L=Math.min(j*R,k);return w.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden",children:[w.jsxs("div",{className:"p-4 border-b border-slate-100 bg-slate-50 flex flex-col gap-3",children:[w.jsxs("div",{className:"flex flex-wrap gap-3 items-center justify-between",children:[w.jsxs("div",{className:"relative w-80",children:[w.jsx(um,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:18}),w.jsx("input",{type:"text",value:h,onChange:A=>d?.(A.target.value),placeholder:"Buscar por cdigo o medicamento...",className:"w-full pl-10 pr-4 py-2 border border-slate-200 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 outline-none"})]}),w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("input",{type:"file",ref:t,onChange:a,accept:".xlsx",className:"hidden"}),w.jsxs("button",{type:"button",onClick:l,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 flex items-center gap-2",title:"Sincronizar empaque terciario",children:[w.jsx(Wi,{size:14}),"Sincronizar"]}),w.jsxs("button",{type:"button",onClick:r,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-blue-50 hover:text-blue-700 flex items-center gap-2",children:[w.jsx(fo,{size:14}),"Cargar XLSX"]}),w.jsxs("button",{type:"button",onClick:s,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 flex items-center gap-2",children:[w.jsx(Gc,{size:14}),"Plantilla"]}),w.jsxs("button",{type:"button",onClick:u,disabled:!c,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-red-200 text-red-600 hover:bg-red-50 flex items-center gap-2 disabled:opacity-40 disabled:hover:bg-white",title:"Eliminar toda la carga",children:[w.jsx(io,{size:14}),"Eliminar carga"]})]})]}),e?.message&&w.jsxs("div",{className:`p-3 rounded-lg text-xs flex items-center gap-2 ${e.type==="success"?"bg-green-50 text-green-700 border border-green-100":e.type==="error"?"bg-red-50 text-red-700 border border-red-100":"bg-blue-50 text-blue-700 border border-blue-100"}`,children:[e.type==="success"?w.jsx(Vc,{size:16}):w.jsx(ii,{size:16}),w.jsx("span",{children:e.message})]})]}),w.jsx("div",{className:"overflow-x-auto",children:w.jsxs("table",{className:"min-w-max w-full text-left",children:[w.jsx("thead",{className:"bg-slate-50 text-slate-500 text-[10px] uppercase font-bold",children:w.jsxs("tr",{children:[w.jsx("th",{className:"px-6 py-4 text-center whitespace-nowrap",children:"Cdigo SIGES"}),w.jsx("th",{className:"px-6 py-4 whitespace-nowrap",children:"Medicamento"}),w.jsx("th",{className:"px-6 py-4 text-center whitespace-nowrap",children:"Empaque terciario"})]})}),w.jsxs("tbody",{className:"divide-y divide-slate-100",children:[g.map(A=>w.jsxs("tr",{className:"hover:bg-slate-50 transition-colors group text-sm",children:[w.jsx("td",{className:"px-6 py-4 text-slate-700 font-mono text-center whitespace-nowrap",children:A.siges_code}),w.jsx("td",{className:"px-6 py-4 text-slate-700 max-w-[520px]",children:w.jsx("span",{className:"block truncate",children:A.medication_name})}),w.jsx("td",{className:"px-6 py-4 text-center whitespace-nowrap text-slate-800 font-mono",children:S(A.tertiary_quantity)})]},A.id)),g.length===0&&w.jsx("tr",{children:w.jsxs("td",{colSpan:3,className:"px-6 py-10 text-center text-sm text-slate-400",children:['No hay resultados para "',h,'".']})})]})]})}),w.jsxs("div",{className:"p-4 border-t border-slate-100 bg-slate-50 flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[w.jsx("div",{className:"text-xs text-slate-500",children:k===0?"0 resultados":`Mostrando ${X}-${L} de ${k}`}),w.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[w.jsx("label",{className:"text-xs text-slate-500",children:"Filas"}),w.jsx("select",{value:R,onChange:A=>y?.(Number(A.target.value)||50),className:"border border-slate-200 rounded-lg px-2 py-1 text-xs bg-white",children:[25,50,100,200].map(A=>w.jsx("option",{value:A,children:A},A))}),w.jsx("button",{type:"button",onClick:()=>b?.(j-1),disabled:j<=1,className:"px-3 py-1.5 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 disabled:opacity-40 disabled:hover:bg-white",children:"Anterior"}),w.jsxs("span",{className:"text-xs text-slate-600",children:["Pgina ",j," de ",T]}),w.jsx("button",{type:"button",onClick:()=>b?.(j+1),disabled:j>=T,className:"px-3 py-1.5 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 disabled:opacity-40 disabled:hover:bg-white",children:"Siguiente"})]})]})]})}const Ul=["Ordinario","Fro","Estupefaciente","Psicotrpico","Alcohol","Suero","Compra Local"];function FE({status:e,fileInputRef:t,onChooseFile:r,onFileChange:a,onDownloadTemplate:s,onRefresh:l,canClear:c,onClear:u,onEdit:h,onDelete:d,search:g,onSearchChange:x,items:v,totalItems:_,page:b,pageSize:y,onPageChange:S,onPageSizeChange:k}){const[R,T]=Ie.useState(null),[j,X]=Ie.useState(Ul[0]),[L,A]=Ie.useState(""),K=!!h,q=!!d,ie=be=>{if(!be)return;T(be),A(String(be.medication_name||"").trim());const I=String(be.category||"").trim();X(Ul.includes(I)?I:Ul[0])},ne=()=>{T(null),A(""),X(Ul[0])},Z=async()=>{R&&(await h?.({...R,medication_name:L,category:j}),ne())},me=Number(_)||0,Re=Number(y)||50,Ae=Math.max(1,Math.ceil(me/Re)),V=Math.min(Math.max(Number(b)||1,1),Ae),ae=me===0?0:(V-1)*Re+1,xe=Math.min(V*Re,me),J=Ie.useMemo(()=>K||q,[q,K]);return w.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden",children:[w.jsxs("div",{className:"p-4 border-b border-slate-100 bg-slate-50 flex flex-col gap-3",children:[w.jsxs("div",{className:"flex flex-wrap gap-3 items-center justify-between",children:[w.jsxs("div",{className:"relative w-80",children:[w.jsx(um,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:18}),w.jsx("input",{type:"text",value:g,onChange:be=>x?.(be.target.value),placeholder:"Buscar por cdigo o medicamento...",className:"w-full pl-10 pr-4 py-2 border border-slate-200 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 outline-none"})]}),w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("input",{type:"file",ref:t,onChange:a,accept:".xlsx",className:"hidden"}),w.jsxs("button",{type:"button",onClick:l,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 flex items-center gap-2",title:"Sincronizar categoras",children:[w.jsx(Wi,{size:14}),"Sincronizar"]}),w.jsxs("button",{type:"button",onClick:r,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-blue-50 hover:text-blue-700 flex items-center gap-2",children:[w.jsx(fo,{size:14}),"Cargar XLSX"]}),w.jsxs("button",{type:"button",onClick:s,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 flex items-center gap-2",children:[w.jsx(Gc,{size:14}),"Plantilla"]}),w.jsxs("button",{type:"button",onClick:u,disabled:!c,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-red-200 text-red-600 hover:bg-red-50 flex items-center gap-2 disabled:opacity-40 disabled:hover:bg-white",title:"Eliminar toda la carga",children:[w.jsx(io,{size:14}),"Eliminar carga"]})]})]}),w.jsxs("div",{className:"text-[11px] text-slate-500",children:["Categoras permitidas: ",Ul.join(", "),"."]}),e?.message&&w.jsxs("div",{className:`p-3 rounded-lg text-xs flex items-center gap-2 ${e.type==="success"?"bg-green-50 text-green-700 border border-green-100":e.type==="error"?"bg-red-50 text-red-700 border border-red-100":"bg-blue-50 text-blue-700 border border-blue-100"}`,children:[e.type==="success"?w.jsx(Vc,{size:16}):w.jsx(ii,{size:16}),w.jsx("span",{children:e.message})]})]}),w.jsx("div",{className:"overflow-x-auto",children:w.jsxs("table",{className:"min-w-max w-full text-left",children:[w.jsx("thead",{className:"bg-slate-50 text-slate-500 text-[10px] uppercase font-bold",children:w.jsxs("tr",{children:[w.jsx("th",{className:"px-6 py-4 text-center whitespace-nowrap",children:"Cdigo"}),w.jsx("th",{className:"px-6 py-4 whitespace-nowrap",children:"Medicamento"}),w.jsx("th",{className:"px-6 py-4 text-center whitespace-nowrap",children:"Categora"}),J&&w.jsx("th",{className:"px-6 py-4 text-center whitespace-nowrap",children:"Acciones"})]})}),w.jsxs("tbody",{className:"divide-y divide-slate-100",children:[v.map(be=>w.jsxs("tr",{className:"hover:bg-slate-50 transition-colors group text-sm",children:[w.jsx("td",{className:"px-6 py-4 text-slate-700 font-mono text-center whitespace-nowrap",children:be.siges_code}),w.jsx("td",{className:"px-6 py-4 text-slate-700 max-w-[520px]",children:w.jsx("span",{className:"block truncate",children:be.medication_name})}),w.jsx("td",{className:"px-6 py-4 text-center whitespace-nowrap text-slate-800 font-mono",children:be.category}),J&&w.jsx("td",{className:"px-6 py-4 text-center whitespace-nowrap",children:w.jsxs("div",{className:"flex items-center justify-center gap-2",children:[K&&w.jsx("button",{type:"button",onClick:()=>ie(be),className:"p-2 rounded-lg border border-slate-200 text-slate-600 hover:bg-slate-100",title:"Editar",children:w.jsx(rE,{size:16})}),q&&w.jsx("button",{type:"button",onClick:()=>d?.(be),className:"p-2 rounded-lg border border-red-200 text-red-600 hover:bg-red-50",title:"Eliminar",children:w.jsx(io,{size:16})})]})})]},be.id)),v.length===0&&w.jsx("tr",{children:w.jsxs("td",{colSpan:J?4:3,className:"px-6 py-10 text-center text-sm text-slate-400",children:['No hay resultados para "',g,'".']})})]})]})}),R&&w.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 p-4",children:w.jsxs("div",{className:"w-full max-w-lg rounded-xl bg-white border border-slate-200 shadow-xl overflow-hidden",children:[w.jsxs("div",{className:"p-4 border-b border-slate-100 bg-slate-50 flex items-center justify-between",children:[w.jsxs("div",{children:[w.jsx("div",{className:"text-sm font-bold text-slate-800",children:"Editar categora"}),w.jsx("div",{className:"text-xs text-slate-500 font-mono",children:R.siges_code})]}),w.jsx("button",{type:"button",onClick:ne,className:"p-2 rounded-lg text-slate-500 hover:bg-slate-100",title:"Cerrar",children:w.jsx(fm,{size:18})})]}),w.jsxs("div",{className:"p-4 space-y-3",children:[w.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase",children:"Medicamento"}),w.jsx("input",{value:L,onChange:be=>A(be.target.value),className:"w-full border border-slate-200 rounded-lg px-3 py-2 text-sm",placeholder:"Nombre del medicamento"}),w.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase",children:"Categora"}),w.jsx("select",{value:j,onChange:be=>X(be.target.value),className:"w-full border border-slate-200 rounded-lg px-3 py-2 text-sm bg-white",children:Ul.map(be=>w.jsx("option",{value:be,children:be},be))})]}),w.jsxs("div",{className:"p-4 border-t border-slate-100 bg-slate-50 flex items-center justify-end gap-2",children:[w.jsx("button",{type:"button",onClick:ne,className:"px-3 py-2 rounded-lg border border-slate-200 text-slate-700 hover:bg-white text-sm",children:"Cancelar"}),w.jsx("button",{type:"button",onClick:Z,className:"px-3 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 text-sm font-bold",children:"Guardar"})]})]})}),w.jsxs("div",{className:"p-4 border-t border-slate-100 bg-slate-50 flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[w.jsx("div",{className:"text-xs text-slate-500",children:me===0?"0 resultados":`Mostrando ${ae}-${xe} de ${me}`}),w.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[w.jsx("label",{className:"text-xs text-slate-500",children:"Filas"}),w.jsx("select",{value:Re,onChange:be=>k?.(Number(be.target.value)||50),className:"border border-slate-200 rounded-lg px-2 py-1 text-xs bg-white",children:[25,50,100,200].map(be=>w.jsx("option",{value:be,children:be},be))}),w.jsx("button",{type:"button",onClick:()=>S?.(V-1),disabled:V<=1,className:"px-3 py-1.5 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 disabled:opacity-40 disabled:hover:bg-white",children:"Anterior"}),w.jsxs("span",{className:"text-xs text-slate-600",children:["Pgina ",V," de ",Ae]}),w.jsx("button",{type:"button",onClick:()=>S?.(V+1),disabled:V>=Ae,className:"px-3 py-1.5 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 disabled:opacity-40 disabled:hover:bg-white",children:"Siguiente"})]})]})]})}const ME=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"];function LE(e){const t=String(e??"").trim();if(!t)return"";const r=t.slice(0,10);return/^\d{4}-\d{2}-\d{2}$/.test(r)?r:""}function BE({status:e,entries:t,onRefresh:r,onSave:a}){const s=new Date().getFullYear(),[l,c]=Ie.useState(s),[u,h]=Ie.useState(()=>Array.from({length:12},()=>"")),[d,g]=Ie.useState(!1),[x,v]=Ie.useState(!1),_=Ie.useMemo(()=>{const S=new Set([s,s+1]);for(const k of t??[]){const R=Number(k?.year);Number.isFinite(R)&&R>0&&S.add(R)}return Array.from(S).sort((k,R)=>R-k)},[s,t]),b=Ie.useMemo(()=>{const S=new Map;for(const k of t??[]){const R=Number(k?.year)||0,T=Number(k?.month)||0;!R||T<1||T>12||S.set(`${R}-${T}`,k)}return S},[t]);Ie.useEffect(()=>{_.includes(l)||c(_[0]??s)},[_.join(","),l]),Ie.useEffect(()=>{const S=Array.from({length:12},(k,R)=>{const T=b.get(`${l}-${R+1}`);return LE(T?.scheduled_receipt_date)});h(S),v(!1)},[b,l]);const y=async()=>{if(!(!a||d)){g(!0);try{const S=Array.from({length:12},(k,R)=>({year:l,month:R+1,scheduled_receipt_date:u[R]?String(u[R]):null}));await a(S),v(!1)}finally{g(!1)}}};return w.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden",children:[w.jsxs("div",{className:"p-4 border-b border-slate-100 bg-slate-50 flex flex-col gap-3",children:[w.jsxs("div",{className:"flex flex-wrap gap-3 items-center justify-between",children:[w.jsx("div",{className:"flex items-center gap-3",children:w.jsxs("div",{children:[w.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase mb-1",children:"Ao"}),w.jsx("select",{value:l,onChange:S=>c(Number(S.target.value)||s),className:"border border-slate-200 rounded-lg px-3 py-2 text-sm bg-white",children:_.map(S=>w.jsx("option",{value:S,children:S},S))})]})}),w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsxs("button",{type:"button",onClick:r,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 flex items-center gap-2",title:"Sincronizar calendario",children:[w.jsx(Wi,{size:14}),"Sincronizar"]}),w.jsxs("button",{type:"button",onClick:y,disabled:!x||d,className:"px-3 py-2 rounded-lg text-xs font-bold bg-blue-600 text-white hover:bg-blue-700 flex items-center gap-2 disabled:opacity-40 disabled:hover:bg-blue-600",title:"Guardar cambios",children:[w.jsx(iE,{size:14}),"Guardar"]})]})]}),e?.message&&w.jsxs("div",{className:`p-3 rounded-lg text-xs flex items-center gap-2 ${e.type==="success"?"bg-green-50 text-green-700 border border-green-100":e.type==="error"?"bg-red-50 text-red-700 border border-red-100":"bg-blue-50 text-blue-700 border border-blue-100"}`,children:[e.type==="success"?w.jsx(Vc,{size:16}):w.jsx(ii,{size:16}),w.jsx("span",{children:e.message})]})]}),w.jsx("div",{className:"overflow-x-auto",children:w.jsxs("table",{className:"min-w-max w-full text-left",children:[w.jsx("thead",{className:"bg-slate-50 text-slate-500 text-[10px] uppercase font-bold",children:w.jsxs("tr",{children:[w.jsx("th",{className:"px-6 py-4 whitespace-nowrap",children:"Mes"}),w.jsx("th",{className:"px-6 py-4 whitespace-nowrap",children:"Recepcin programada"})]})}),w.jsx("tbody",{className:"divide-y divide-slate-100",children:ME.map((S,k)=>w.jsxs("tr",{className:"hover:bg-slate-50 transition-colors text-sm",children:[w.jsx("td",{className:"px-6 py-4 text-slate-700 whitespace-nowrap",children:S}),w.jsx("td",{className:"px-6 py-4 text-slate-700 whitespace-nowrap",children:w.jsx("input",{type:"date",value:u[k]??"",onChange:R=>{const T=R.target.value;h(j=>{const X=[...j];return X[k]=T,X}),v(!0)},className:"border border-slate-200 rounded-lg px-3 py-2 text-sm bg-white"})})]},S))})]})})]})}function IE(e){return e.replace(/^\uFEFF/,"")}function jE(e){const t=(e.match(/,/g)||[]).length;return(e.match(/;/g)||[]).length>t?";":","}function Hy(e){const t=IE(e).replace(/\r\n/g,`
`).replace(/\r/g,`
`),r=[];let a=[],s="",l=!1,c=0;const u=t.split(`
`)[0]||"",h=jE(u);for(;c<t.length;){const g=t[c];if(l){if(g==='"'){if(t[c+1]==='"'){s+='"',c+=2;continue}l=!1,c+=1;continue}s+=g,c+=1;continue}if(g==='"'){l=!0,c+=1;continue}if(g===h){a.push(s),s="",c+=1;continue}if(g===`
`){a.push(s),s="",a.every(v=>String(v||"").trim()==="")||r.push(a),a=[],c+=1;continue}s+=g,c+=1}return a.push(s),a.every(g=>String(g||"").trim()==="")||r.push(a),{rows:r,delimiter:h}}function Qx(e){const{rows:t}=Hy(e);return t}function UE(e){return String(e||"").trim().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]/g,"")}function PE(e){const t={nombre:"Nombre",name:"Nombre",categoria:"Categoria",category:"Categoria",codigosiges:"CodigoSIGES",codsiges:"CodigoSIGES",siges:"CodigoSIGES",codigosicop:"IdentificadorSICOP",identificadorsicop:"IdentificadorSICOP",identificac:"IdentificadorSICOP",identificador:"IdentificadorSICOP",idsicop:"IdentificadorSICOP",clasificadorsicop:"ClasificadorSICOP",clasificador:"ClasificadorSICOP",sicopclasificador:"ClasificadorSICOP",sicopidentificador:"IdentificadorSICOP",medicamento:"Medicamento",descripcionsicop:"Medicamento",descripcion:"Medicamento",lote:"Lote",batch:"Lote",vencimiento:"Vencimiento",expirydate:"Vencimiento",stock:"Stock",stockminimo:"StockMinimo",minstock:"StockMinimo",unidad:"Unidad",unit:"Unidad",producto:"Medicamento",item:"Medicamento",cantidad:"Cantidad",consumo:"Cantidad",salida:"Cantidad",responsable:"Responsable",usuario:"Responsable",user:"Responsable",motivo:"Motivo",destino:"Motivo",observacion:"Motivo",fecha:"Fecha",fechahora:"Fecha",date:"Fecha"};return e.map(r=>t[UE(r)]||String(r||"").trim())}function gd(e){if(e instanceof Date&&!Number.isNaN(e.getTime()))return e.toISOString().slice(0,10);const t=String(e??"").trim();if(!t)return new Date().toISOString().slice(0,10);const r=t.slice(0,10);if(/^\d{4}-\d{2}-\d{2}$/.test(r))return r;const a=new Date(t);return Number.isNaN(a.getTime())?new Date().toISOString().slice(0,10):a.toISOString().slice(0,10)}function lo(e,t){const r=String(e??"");return r.includes('"')||r.includes(`
`)||r.includes("\r")||r.includes(t)?`"${r.replace(/"/g,'""')}"`:r}function zE(){const t=["CodigoSIGES","ClasificadorSICOP","IdentificadorSICOP","Medicamento","Categoria","Lote","Vencimiento","Stock","StockMinimo","Unidad"],r=["SIG-0001","SICOP-CL-01","SICOP-ID-0001","Paracetamol","Analgsico","LOT-2025-01","2027-12-31",100,20,"Tabletas"],s=`\uFEFF${[t.map(h=>lo(h,";")).join(";"),r.map(h=>lo(h,";")).join(";")].join(`
`)}
`,l=new Blob([s],{type:"text/csv;charset=utf-8"}),c=URL.createObjectURL(l),u=document.createElement("a");u.href=c,u.download="plantilla_catalogo.csv",document.body.appendChild(u),u.click(),u.remove(),URL.revokeObjectURL(c)}function HE(){const t=["CodigoSIGES","Medicamento","Consumo","Costo"],r=["110-16-0010","Paracetamol",1555.85,148621015e-2],s=`\uFEFF${[t.map(h=>lo(h,";")).join(";"),r.map(h=>lo(h,";")).join(";")].join(`
`)}
`,l=new Blob([s],{type:"text/csv;charset=utf-8"}),c=URL.createObjectURL(l),u=document.createElement("a");u.href=c,u.download="plantilla_consumo_mensual.csv",document.body.appendChild(u),u.click(),u.remove(),URL.revokeObjectURL(c)}function Zx(e){const{rows:t}=Hy(e);if(t.length===0)return[];const r=t[0],a=PE(r);return t.slice(1).map(l=>{const c={};for(let u=0;u<a.length;u+=1){const h=a[u];h&&(c[h]=l[u]??"")}return c})}function $E(e){const t=String(e||"772").trim()||"772",r=";",a=["CodigoSIGES","ClasificadorSICOP","IdentificadorSICOP","Medicamento","Categoria","Lote","Vencimiento","Stock","StockMinimo","Unidad"],s=["SIG-0001","SICOP-CL-01","SICOP-ID-0001","Paracetamol","General","LOT-2025-01","2027-12-31",100,20,"Tabletas"],c=`\uFEFF${[a.map(g=>lo(g,r)).join(r),s.map(g=>lo(g,r)).join(r)].join(`
`)}
`,u=new Blob([c],{type:"text/csv;charset=utf-8"}),h=URL.createObjectURL(u),d=document.createElement("a");d.href=h,d.download=`plantilla_inventario_${t}.csv`,document.body.appendChild(d),d.click(),d.remove(),URL.revokeObjectURL(h)}function VE(e){const t=String(e||"771").trim()||"771",r=`<?xml version="1.0" encoding="UTF-8"?>
<Inventario tipo="${t}">
  <Item>
    <CodigoSIGES>110-16-0010</CodigoSIGES>
    <Medicamento>Paracetamol</Medicamento>
    <Lote>LOT-2025-01</Lote>
    <Vencimiento>2027-12-31</Vencimiento>
    <Inventario>100</Inventario>
  </Item>
</Inventario>
`,a=new Blob([r],{type:"application/xml;charset=utf-8"}),s=URL.createObjectURL(a),l=document.createElement("a");l.href=s,l.download=`plantilla_inventario_${t}.xml`,document.body.appendChild(l),l.click(),l.remove(),URL.revokeObjectURL(s)}function qu(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,a=Object.getOwnPropertySymbols(e);s<a.length;s++)t.indexOf(a[s])<0&&Object.prototype.propertyIsEnumerable.call(e,a[s])&&(r[a[s]]=e[a[s]]);return r}function GE(e,t,r,a){function s(l){return l instanceof r?l:new r(function(c){c(l)})}return new(r||(r=Promise))(function(l,c){function u(g){try{d(a.next(g))}catch(x){c(x)}}function h(g){try{d(a.throw(g))}catch(x){c(x)}}function d(g){g.done?l(g.value):s(g.value).then(u,h)}d((a=a.apply(e,t||[])).next())})}const qE=e=>e?(...t)=>e(...t):(...t)=>fetch(...t);class hm extends Error{constructor(t,r="FunctionsError",a){super(t),this.name=r,this.context=a}}class XE extends hm{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class ev extends hm{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class tv extends hm{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Pd;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(Pd||(Pd={}));class WE{constructor(t,{headers:r={},customFetch:a,region:s=Pd.Any}={}){this.url=t,this.headers=r,this.region=s,this.fetch=qE(a)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return GE(this,arguments,void 0,function*(r,a={}){var s;let l,c;try{const{headers:u,method:h,body:d,signal:g,timeout:x}=a;let v={},{region:_}=a;_||(_=this.region);const b=new URL(`${this.url}/${r}`);_&&_!=="any"&&(v["x-region"]=_,b.searchParams.set("forceFunctionRegion",_));let y;d&&(u&&!Object.prototype.hasOwnProperty.call(u,"Content-Type")||!u)?typeof Blob<"u"&&d instanceof Blob||d instanceof ArrayBuffer?(v["Content-Type"]="application/octet-stream",y=d):typeof d=="string"?(v["Content-Type"]="text/plain",y=d):typeof FormData<"u"&&d instanceof FormData?y=d:(v["Content-Type"]="application/json",y=JSON.stringify(d)):y=d;let S=g;x&&(c=new AbortController,l=setTimeout(()=>c.abort(),x),g?(S=c.signal,g.addEventListener("abort",()=>c.abort())):S=c.signal);const k=yield this.fetch(b.toString(),{method:h||"POST",headers:Object.assign(Object.assign(Object.assign({},v),this.headers),u),body:y,signal:S}).catch(X=>{throw new XE(X)}),R=k.headers.get("x-relay-error");if(R&&R==="true")throw new ev(k);if(!k.ok)throw new tv(k);let T=((s=k.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),j;return T==="application/json"?j=yield k.json():T==="application/octet-stream"||T==="application/pdf"?j=yield k.blob():T==="text/event-stream"?j=k:T==="multipart/form-data"?j=yield k.formData():j=yield k.text(),{data:j,error:null,response:k}}catch(u){return{data:null,error:u,response:u instanceof tv||u instanceof ev?u.context:void 0}}finally{l&&clearTimeout(l)}})}}var KE=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}},YE=class{constructor(e){var t,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(t=e.shouldThrowOnError)!==null&&t!==void 0?t:!1,this.signal=e.signal,this.isMaybeSingle=(r=e.isMaybeSingle)!==null&&r!==void 0?r:!1,e.fetch?this.fetch=e.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){var r=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const a=this.fetch;let s=a(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async l=>{let c=null,u=null,h=null,d=l.status,g=l.statusText;if(l.ok){var x,v;if(r.method!=="HEAD"){var _;const k=await l.text();k===""||(r.headers.get("Accept")==="text/csv"||r.headers.get("Accept")&&(!((_=r.headers.get("Accept"))===null||_===void 0)&&_.includes("application/vnd.pgrst.plan+text"))?u=k:u=JSON.parse(k))}const y=(x=r.headers.get("Prefer"))===null||x===void 0?void 0:x.match(/count=(exact|planned|estimated)/),S=(v=l.headers.get("content-range"))===null||v===void 0?void 0:v.split("/");y&&S&&S.length>1&&(h=parseInt(S[1])),r.isMaybeSingle&&r.method==="GET"&&Array.isArray(u)&&(u.length>1?(c={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,h=null,d=406,g="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{var b;const y=await l.text();try{c=JSON.parse(y),Array.isArray(c)&&l.status===404&&(u=[],c=null,d=200,g="OK")}catch{l.status===404&&y===""?(d=204,g="No Content"):c={message:y}}if(c&&r.isMaybeSingle&&(!(c==null||(b=c.details)===null||b===void 0)&&b.includes("0 rows"))&&(c=null,d=200,g="OK"),c&&r.shouldThrowOnError)throw new KE(c)}return{error:c,data:u,count:h,status:d,statusText:g}});return this.shouldThrowOnError||(s=s.catch(l=>{var c;let u="";const h=l?.cause;if(h){var d,g,x,v;const b=(d=h?.message)!==null&&d!==void 0?d:"",y=(g=h?.code)!==null&&g!==void 0?g:"";u=`${(x=l?.name)!==null&&x!==void 0?x:"FetchError"}: ${l?.message}`,u+=`

Caused by: ${(v=h?.name)!==null&&v!==void 0?v:"Error"}: ${b}`,y&&(u+=` (${y})`),h?.stack&&(u+=`
${h.stack}`)}else{var _;u=(_=l?.stack)!==null&&_!==void 0?_:""}return{error:{message:`${(c=l?.name)!==null&&c!==void 0?c:"FetchError"}: ${l?.message}`,details:u,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),s.then(e,t)}returns(){return this}overrideTypes(){return this}},JE=class extends YE{select(e){let t=!1;const r=(e??"*").split("").map(a=>/\s/.test(a)&&!t?"":(a==='"'&&(t=!t),a)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:a,referencedTable:s=a}={}){const l=s?`${s}.order`:"order",c=this.url.searchParams.get(l);return this.url.searchParams.set(l,`${c?`${c},`:""}${e}.${t?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const a=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(a,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:a=r}={}){const s=typeof a>"u"?"offset":`${a}.offset`,l=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(s,`${e}`),this.url.searchParams.set(l,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:a=!1,wal:s=!1,format:l="text"}={}){var c;const u=[e?"analyze":null,t?"verbose":null,r?"settings":null,a?"buffers":null,s?"wal":null].filter(Boolean).join("|"),h=(c=this.headers.get("Accept"))!==null&&c!==void 0?c:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${l}; for="${h}"; options=${u};`),l==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};const rv=new RegExp("[,()]");var Kl=class extends JE{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}regexMatch(e,t){return this.url.searchParams.append(e,`match.${t}`),this}regexIMatch(e,t){return this.url.searchParams.append(e,`imatch.${t}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}isDistinct(e,t){return this.url.searchParams.append(e,`isdistinct.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map(a=>typeof a=="string"&&rv.test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}notIn(e,t){const r=Array.from(new Set(t)).map(a=>typeof a=="string"&&rv.test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(e,`not.in.(${r})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:a}={}){let s="";a==="plain"?s="pl":a==="phrase"?s="ph":a==="websearch"&&(s="w");const l=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${s}fts${l}.${t}`),this}match(e){return Object.entries(e).forEach(([t,r])=>{this.url.searchParams.append(t,`eq.${r}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const a=r?`${r}.or`:"or";return this.url.searchParams.append(a,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}},QE=class{constructor(e,{headers:t={},schema:r,fetch:a}){this.url=e,this.headers=new Headers(t),this.schema=r,this.fetch=a}select(e,t){const{head:r=!1,count:a}=t??{},s=r?"HEAD":"GET";let l=!1;const c=(e??"*").split("").map(u=>/\s/.test(u)&&!l?"":(u==='"'&&(l=!l),u)).join("");return this.url.searchParams.set("select",c),a&&this.headers.append("Prefer",`count=${a}`),new Kl({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(e,{count:t,defaultToNull:r=!0}={}){var a;const s="POST";if(t&&this.headers.append("Prefer",`count=${t}`),r||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const l=e.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(l.length>0){const c=[...new Set(l)].map(u=>`"${u}"`);this.url.searchParams.set("columns",c.join(","))}}return new Kl({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:a,defaultToNull:s=!0}={}){var l;const c="POST";if(this.headers.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),t!==void 0&&this.url.searchParams.set("on_conflict",t),a&&this.headers.append("Prefer",`count=${a}`),s||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const u=e.reduce((h,d)=>h.concat(Object.keys(d)),[]);if(u.length>0){const h=[...new Set(u)].map(d=>`"${d}"`);this.url.searchParams.set("columns",h.join(","))}}return new Kl({method:c,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}update(e,{count:t}={}){var r;const a="PATCH";return t&&this.headers.append("Prefer",`count=${t}`),new Kl({method:a,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:e}={}){var t;const r="DELETE";return e&&this.headers.append("Prefer",`count=${e}`),new Kl({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}},ZE=class $y{constructor(t,{headers:r={},schema:a,fetch:s}={}){this.url=t,this.headers=new Headers(r),this.schemaName=a,this.fetch=s}from(t){if(!t||typeof t!="string"||t.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new QE(new URL(`${this.url}/${t}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new $y(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:a=!1,get:s=!1,count:l}={}){var c;let u;const h=new URL(`${this.url}/rpc/${t}`);let d;a||s?(u=a?"HEAD":"GET",Object.entries(r).filter(([x,v])=>v!==void 0).map(([x,v])=>[x,Array.isArray(v)?`{${v.join(",")}}`:`${v}`]).forEach(([x,v])=>{h.searchParams.append(x,v)})):(u="POST",d=r);const g=new Headers(this.headers);return l&&g.set("Prefer",`count=${l}`),new Kl({method:u,url:h,headers:g,schema:this.schemaName,body:d,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}};class eT{constructor(){}static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const a=r.node,s=parseInt(a.replace(/^v/,"").split(".")[0]);return s>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${s} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const a=this.getWebSocketConstructor();return new a(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const tT="2.89.0",rT=`realtime-js/${tT}`,Vy="1.0.0",aT="2.0.0",av=Vy,zd=1e4,nT=1e3,sT=100;var Js;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(Js||(Js={}));var Ur;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Ur||(Ur={}));var En;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(En||(En={}));var Hd;(function(e){e.websocket="websocket"})(Hd||(Hd={}));var Fi;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Fi||(Fi={}));class iT{constructor(t){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=t??[]}encode(t,r){if(t.event===this.BROADCAST_EVENT&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(t));let a=[t.join_ref,t.ref,t.topic,t.event,t.payload];return r(JSON.stringify(a))}_binaryEncodeUserBroadcastPush(t){var r;return this._isArrayBuffer((r=t.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var r,a;const s=(a=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&a!==void 0?a:new ArrayBuffer(0);return this._encodeUserBroadcastPush(t,this.BINARY_ENCODING,s)}_encodeJsonUserBroadcastPush(t){var r,a;const s=(a=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&a!==void 0?a:{},c=new TextEncoder().encode(JSON.stringify(s)).buffer;return this._encodeUserBroadcastPush(t,this.JSON_ENCODING,c)}_encodeUserBroadcastPush(t,r,a){var s,l;const c=t.topic,u=(s=t.ref)!==null&&s!==void 0?s:"",h=(l=t.join_ref)!==null&&l!==void 0?l:"",d=t.payload.event,g=this.allowedMetadataKeys?this._pick(t.payload,this.allowedMetadataKeys):{},x=Object.keys(g).length===0?"":JSON.stringify(g);if(h.length>255)throw new Error(`joinRef length ${h.length} exceeds maximum of 255`);if(u.length>255)throw new Error(`ref length ${u.length} exceeds maximum of 255`);if(c.length>255)throw new Error(`topic length ${c.length} exceeds maximum of 255`);if(d.length>255)throw new Error(`userEvent length ${d.length} exceeds maximum of 255`);if(x.length>255)throw new Error(`metadata length ${x.length} exceeds maximum of 255`);const v=this.USER_BROADCAST_PUSH_META_LENGTH+h.length+u.length+c.length+d.length+x.length,_=new ArrayBuffer(this.HEADER_LENGTH+v);let b=new DataView(_),y=0;b.setUint8(y++,this.KINDS.userBroadcastPush),b.setUint8(y++,h.length),b.setUint8(y++,u.length),b.setUint8(y++,c.length),b.setUint8(y++,d.length),b.setUint8(y++,x.length),b.setUint8(y++,r),Array.from(h,k=>b.setUint8(y++,k.charCodeAt(0))),Array.from(u,k=>b.setUint8(y++,k.charCodeAt(0))),Array.from(c,k=>b.setUint8(y++,k.charCodeAt(0))),Array.from(d,k=>b.setUint8(y++,k.charCodeAt(0))),Array.from(x,k=>b.setUint8(y++,k.charCodeAt(0)));var S=new Uint8Array(_.byteLength+a.byteLength);return S.set(new Uint8Array(_),0),S.set(new Uint8Array(a),_.byteLength),S.buffer}decode(t,r){if(this._isArrayBuffer(t)){let a=this._binaryDecode(t);return r(a)}if(typeof t=="string"){const a=JSON.parse(t),[s,l,c,u,h]=a;return r({join_ref:s,ref:l,topic:c,event:u,payload:h})}return r({})}_binaryDecode(t){const r=new DataView(t),a=r.getUint8(0),s=new TextDecoder;if(a===this.KINDS.userBroadcast)return this._decodeUserBroadcast(t,r,s)}_decodeUserBroadcast(t,r,a){const s=r.getUint8(1),l=r.getUint8(2),c=r.getUint8(3),u=r.getUint8(4);let h=this.HEADER_LENGTH+4;const d=a.decode(t.slice(h,h+s));h=h+s;const g=a.decode(t.slice(h,h+l));h=h+l;const x=a.decode(t.slice(h,h+c));h=h+c;const v=t.slice(h,t.byteLength),_=u===this.JSON_ENCODING?JSON.parse(a.decode(v)):v,b={type:this.BROADCAST_EVENT,event:g,payload:_};return c>0&&(b.meta=JSON.parse(x)),{join_ref:null,ref:null,topic:d,event:this.BROADCAST_EVENT,payload:b}}_isArrayBuffer(t){var r;return t instanceof ArrayBuffer||((r=t?.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(t,r){return!t||typeof t!="object"?{}:Object.fromEntries(Object.entries(t).filter(([a])=>r.includes(a)))}}class Gy{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var rr;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(rr||(rr={}));const nv=(e,t,r={})=>{var a;const s=(a=r.skipTypes)!==null&&a!==void 0?a:[];return t?Object.keys(t).reduce((l,c)=>(l[c]=lT(c,e,t,s),l),{}):{}},lT=(e,t,r,a)=>{const s=t.find(u=>u.name===e),l=s?.type,c=r[e];return l&&!a.includes(l)?qy(l,c):$d(c)},qy=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return fT(t,r)}switch(e){case rr.bool:return oT(t);case rr.float4:case rr.float8:case rr.int2:case rr.int4:case rr.int8:case rr.numeric:case rr.oid:return cT(t);case rr.json:case rr.jsonb:return uT(t);case rr.timestamp:return hT(t);case rr.abstime:case rr.date:case rr.daterange:case rr.int4range:case rr.int8range:case rr.money:case rr.reltime:case rr.text:case rr.time:case rr.timestamptz:case rr.timetz:case rr.tsrange:case rr.tstzrange:return $d(t);default:return $d(t)}},$d=e=>e,oT=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},cT=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},uT=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e},fT=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,a=e[r];if(e[0]==="{"&&a==="}"){let l;const c=e.slice(1,r);try{l=JSON.parse("["+c+"]")}catch{l=c?c.split(","):[]}return l.map(u=>qy(t,u))}return e},hT=e=>typeof e=="string"?e.replace(" ","T"):e,Xy=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class pd{constructor(t,r,a={},s=zd){this.channel=t,this.event=r,this.payload=a,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var a;return this._hasReceived(t)&&r((a=this.receivedResp)===null||a===void 0?void 0:a.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(a=>a.status===t).forEach(a=>a.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var sv;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(sv||(sv={}));class mc{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const a=r?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(a.state,{},s=>{const{onJoin:l,onLeave:c,onSync:u}=this.caller;this.joinRef=this.channel._joinRef(),this.state=mc.syncState(this.state,s,l,c),this.pendingDiffs.forEach(h=>{this.state=mc.syncDiff(this.state,h,l,c)}),this.pendingDiffs=[],u()}),this.channel._on(a.diff,{},s=>{const{onJoin:l,onLeave:c,onSync:u}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=mc.syncDiff(this.state,s,l,c),u())}),this.onJoin((s,l,c)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:l,newPresences:c})}),this.onLeave((s,l,c)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:l,leftPresences:c})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,a,s){const l=this.cloneDeep(t),c=this.transformState(r),u={},h={};return this.map(l,(d,g)=>{c[d]||(h[d]=g)}),this.map(c,(d,g)=>{const x=l[d];if(x){const v=g.map(S=>S.presence_ref),_=x.map(S=>S.presence_ref),b=g.filter(S=>_.indexOf(S.presence_ref)<0),y=x.filter(S=>v.indexOf(S.presence_ref)<0);b.length>0&&(u[d]=b),y.length>0&&(h[d]=y)}else u[d]=g}),this.syncDiff(l,{joins:u,leaves:h},a,s)}static syncDiff(t,r,a,s){const{joins:l,leaves:c}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return a||(a=()=>{}),s||(s=()=>{}),this.map(l,(u,h)=>{var d;const g=(d=t[u])!==null&&d!==void 0?d:[];if(t[u]=this.cloneDeep(h),g.length>0){const x=t[u].map(_=>_.presence_ref),v=g.filter(_=>x.indexOf(_.presence_ref)<0);t[u].unshift(...v)}a(u,g,h)}),this.map(c,(u,h)=>{let d=t[u];if(!d)return;const g=h.map(x=>x.presence_ref);d=d.filter(x=>g.indexOf(x.presence_ref)<0),t[u]=d,s(u,d,h),d.length===0&&delete t[u]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(a=>r(a,t[a]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,a)=>{const s=t[a];return"metas"in s?r[a]=s.metas.map(l=>(l.presence_ref=l.phx_ref,delete l.phx_ref,delete l.phx_ref_prev,l)):r[a]=s,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var iv;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(iv||(iv={}));var gc;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(gc||(gc={}));var us;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(us||(us={}));class Zl{constructor(t,r={config:{}},a){var s,l;if(this.topic=t,this.params=r,this.socket=a,this.bindings={},this.state=Ur.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new pd(this,En.join,this.params,this.timeout),this.rejoinTimer=new Gy(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Ur.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(c=>c.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Ur.closed,this.socket._remove(this)}),this._onError(c=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,c),this.state=Ur.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Ur.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",c=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,c),this.state=Ur.errored,this.rejoinTimer.scheduleTimeout())}),this._on(En.reply,{},(c,u)=>{this._trigger(this._replyEventName(u),c)}),this.presence=new mc(this),this.broadcastEndpointURL=Xy(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((l=(s=this.params.config)===null||s===void 0?void 0:s.broadcast)===null||l===void 0)&&l.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var a,s,l;if(this.socket.isConnected()||this.socket.connect(),this.state==Ur.closed){const{config:{broadcast:c,presence:u,private:h}}=this.params,d=(s=(a=this.bindings.postgres_changes)===null||a===void 0?void 0:a.map(_=>_.filter))!==null&&s!==void 0?s:[],g=!!this.bindings[gc.PRESENCE]&&this.bindings[gc.PRESENCE].length>0||((l=this.params.config.presence)===null||l===void 0?void 0:l.enabled)===!0,x={},v={broadcast:c,presence:Object.assign(Object.assign({},u),{enabled:g}),postgres_changes:d,private:h};this.socket.accessTokenValue&&(x.access_token=this.socket.accessTokenValue),this._onError(_=>t?.(us.CHANNEL_ERROR,_)),this._onClose(()=>t?.(us.CLOSED)),this.updateJoinPayload(Object.assign({config:v},x)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:_})=>{var b;if(this.socket._isManualToken()||this.socket.setAuth(),_===void 0){t?.(us.SUBSCRIBED);return}else{const y=this.bindings.postgres_changes,S=(b=y?.length)!==null&&b!==void 0?b:0,k=[];for(let R=0;R<S;R++){const T=y[R],{filter:{event:j,schema:X,table:L,filter:A}}=T,K=_&&_[R];if(K&&K.event===j&&Zl.isFilterValueEqual(K.schema,X)&&Zl.isFilterValueEqual(K.table,L)&&Zl.isFilterValueEqual(K.filter,A))k.push(Object.assign(Object.assign({},T),{id:K.id}));else{this.unsubscribe(),this.state=Ur.errored,t?.(us.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=k,t&&t(us.SUBSCRIBED);return}}).receive("error",_=>{this.state=Ur.errored,t?.(us.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(_).join(", ")||"error")))}).receive("timeout",()=>{t?.(us.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,a){return this.state===Ur.joined&&t===gc.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(t,r,a)}async httpSend(t,r,a={}){var s;if(r==null)return Promise.reject("Payload is required for httpSend()");const l={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(l.Authorization=`Bearer ${this.socket.accessTokenValue}`);const c={method:"POST",headers:l,body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:r,private:this.private}]})},u=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(s=a.timeout)!==null&&s!==void 0?s:this.timeout);if(u.status===202)return{success:!0};let h=u.statusText;try{const d=await u.json();h=d.error||d.message||h}catch{}return Promise.reject(new Error(h))}async send(t,r={}){var a,s;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:l,payload:c}=t,u={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(u.Authorization=`Bearer ${this.socket.accessTokenValue}`);const h={method:"POST",headers:u,body:JSON.stringify({messages:[{topic:this.subTopic,event:l,payload:c,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,h,(a=r.timeout)!==null&&a!==void 0?a:this.timeout);return await((s=d.body)===null||s===void 0?void 0:s.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(l=>{var c,u,h;const d=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((h=(u=(c=this.params)===null||c===void 0?void 0:c.config)===null||u===void 0?void 0:u.broadcast)===null||h===void 0)&&h.ack)&&l("ok"),d.receive("ok",()=>l("ok")),d.receive("error",()=>l("error")),d.receive("timeout",()=>l("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Ur.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(En.close,"leave",this._joinRef())};this.joinPush.destroy();let a=null;return new Promise(s=>{a=new pd(this,En.leave,{},t),a.receive("ok",()=>{r(),s("ok")}).receive("timeout",()=>{r(),s("timed out")}).receive("error",()=>{s("error")}),a.send(),this._canPush()||a.trigger("ok",{})}).finally(()=>{a?.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Ur.closed,this.bindings={}}async _fetchWithTimeout(t,r,a){const s=new AbortController,l=setTimeout(()=>s.abort(),a),c=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:s.signal}));return clearTimeout(l),c}_push(t,r,a=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new pd(this,t,r,a);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>sT){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,a){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,a){var s,l;const c=t.toLocaleLowerCase(),{close:u,error:h,leave:d,join:g}=En;if(a&&[u,h,d,g].indexOf(c)>=0&&a!==this._joinRef())return;let v=this._onMessage(c,r,a);if(r&&!v)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(c)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(_=>{var b,y,S;return((b=_.filter)===null||b===void 0?void 0:b.event)==="*"||((S=(y=_.filter)===null||y===void 0?void 0:y.event)===null||S===void 0?void 0:S.toLocaleLowerCase())===c}).map(_=>_.callback(v,a)):(l=this.bindings[c])===null||l===void 0||l.filter(_=>{var b,y,S,k,R,T;if(["broadcast","presence","postgres_changes"].includes(c))if("id"in _){const j=_.id,X=(b=_.filter)===null||b===void 0?void 0:b.event;return j&&((y=r.ids)===null||y===void 0?void 0:y.includes(j))&&(X==="*"||X?.toLocaleLowerCase()===((S=r.data)===null||S===void 0?void 0:S.type.toLocaleLowerCase()))}else{const j=(R=(k=_?.filter)===null||k===void 0?void 0:k.event)===null||R===void 0?void 0:R.toLocaleLowerCase();return j==="*"||j===((T=r?.event)===null||T===void 0?void 0:T.toLocaleLowerCase())}else return _.type.toLocaleLowerCase()===c}).map(_=>{if(typeof v=="object"&&"ids"in v){const b=v.data,{schema:y,table:S,commit_timestamp:k,type:R,errors:T}=b;v=Object.assign(Object.assign({},{schema:y,table:S,commit_timestamp:k,eventType:R,new:{},old:{},errors:T}),this._getPayloadRecords(b))}_.callback(v,a)})}_isClosed(){return this.state===Ur.closed}_isJoined(){return this.state===Ur.joined}_isJoining(){return this.state===Ur.joining}_isLeaving(){return this.state===Ur.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,a){const s=t.toLocaleLowerCase(),l={type:s,filter:r,callback:a};return this.bindings[s]?this.bindings[s].push(l):this.bindings[s]=[l],this}_off(t,r){const a=t.toLocaleLowerCase();return this.bindings[a]&&(this.bindings[a]=this.bindings[a].filter(s=>{var l;return!(((l=s.type)===null||l===void 0?void 0:l.toLocaleLowerCase())===a&&Zl.isEqual(s.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const a in t)if(t[a]!==r[a])return!1;return!0}static isFilterValueEqual(t,r){return(t??void 0)===(r??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(En.close,{},t)}_onError(t){this._on(En.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Ur.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=nv(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=nv(t.columns,t.old_record)),r}}const xd=()=>{},uu={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},dT=[1e3,2e3,5e3,1e4],mT=1e4,gT=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class pT{constructor(t,r){var a;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=zd,this.transport=null,this.heartbeatIntervalMs=uu.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=xd,this.ref=0,this.reconnectTimer=null,this.vsn=av,this.logger=xd,this.conn=null,this.sendBuffer=[],this.serializer=new iT,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=s=>s?(...l)=>s(...l):(...l)=>fetch(...l),!(!((a=r?.params)===null||a===void 0)&&a.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${Hd.websocket}`,this.httpEndpoint=Xy(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=eT.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const a=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(a),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,a){this.logger(t,r,a)}connectionState(){switch(this.conn&&this.conn.readyState){case Js.connecting:return Fi.Connecting;case Js.open:return Fi.Open;case Js.closing:return Fi.Closing;default:return Fi.Closed}}isConnected(){return this.connectionState()===Fi.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const a=`realtime:${t}`,s=this.getChannels().find(l=>l.topic===a);if(s)return s;{const l=new Zl(`realtime:${t}`,r,this);return this.channels.push(l),l}}push(t){const{topic:r,event:a,payload:s,ref:l}=t,c=()=>{this.encode(t,u=>{var h;(h=this.conn)===null||h===void 0||h.send(u)})};this.log("push",`${r} ${a} (${l})`,s),this.isConnected()?c():this.sendBuffer.push(c)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(nT,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},uu.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(a=>a.topic===t&&(a._isJoined()||a._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(d){this.log("error","error in heartbeat callback",d)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:a,event:s,payload:l,ref:c}=r,u=c?`(${c})`:"",h=l.status||"";this.log("receive",`${h} ${a} ${s} ${u}`.trim(),l),this.channels.filter(d=>d._isMember(a)).forEach(d=>d._trigger(s,l,c)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t),this.conn.readyState===Js.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===Js.open||this.conn.readyState===Js.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this._terminateWorker()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(En.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const a=t.match(/\?/)?"&":"?",s=new URLSearchParams(r);return`${t}${a}${s}`}_workerObjectUrl(t){let r;if(t)r=t;else{const a=new Blob([gT],{type:"application/javascript"});r=URL.createObjectURL(a)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r,a=!1;if(t)r=t,a=!0;else if(this.accessToken)try{r=await this.accessToken()}catch(s){this.log("error","Error fetching access token from callback",s),r=this.accessTokenValue}else r=this.accessTokenValue;a?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(s=>{const l={access_token:r,version:rT};r&&s.updateJoinPayload(l),s.joinedOnce&&s._isJoined()&&s._push(En.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this._isManualToken()||this.setAuth().catch(r=>{this.log("error",`Error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(a=>{try{a(r)}catch(s){this.log("error",`error in ${t} callback`,s)}})}catch(a){this.log("error",`error triggering ${t} callbacks`,a)}}_setupReconnectionTimer(){this.reconnectTimer=new Gy(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},uu.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,a,s,l,c,u,h,d,g,x,v,_;switch(this.transport=(r=t?.transport)!==null&&r!==void 0?r:null,this.timeout=(a=t?.timeout)!==null&&a!==void 0?a:zd,this.heartbeatIntervalMs=(s=t?.heartbeatIntervalMs)!==null&&s!==void 0?s:uu.HEARTBEAT_INTERVAL,this.worker=(l=t?.worker)!==null&&l!==void 0?l:!1,this.accessToken=(c=t?.accessToken)!==null&&c!==void 0?c:null,this.heartbeatCallback=(u=t?.heartbeatCallback)!==null&&u!==void 0?u:xd,this.vsn=(h=t?.vsn)!==null&&h!==void 0?h:av,t?.params&&(this.params=t.params),t?.logger&&(this.logger=t.logger),(t?.logLevel||t?.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(d=t?.reconnectAfterMs)!==null&&d!==void 0?d:(b=>dT[b-1]||mT),this.vsn){case Vy:this.encode=(g=t?.encode)!==null&&g!==void 0?g:((b,y)=>y(JSON.stringify(b))),this.decode=(x=t?.decode)!==null&&x!==void 0?x:((b,y)=>y(JSON.parse(b)));break;case aT:this.encode=(v=t?.encode)!==null&&v!==void 0?v:this.serializer.encode.bind(this.serializer),this.decode=(_=t?.decode)!==null&&_!==void 0?_:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t?.workerUrl}}}var Ec=class extends Error{constructor(e,t){super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown=t.icebergType==="CommitStateUnknownException"||[500,502,504].includes(t.status)&&t.icebergType?.includes("CommitState")===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function xT(e,t,r){const a=new URL(t,e);if(r)for(const[s,l]of Object.entries(r))l!==void 0&&a.searchParams.set(s,l);return a.toString()}async function vT(e){return!e||e.type==="none"?{}:e.type==="bearer"?{Authorization:`Bearer ${e.token}`}:e.type==="header"?{[e.name]:e.value}:e.type==="custom"?await e.getHeaders():{}}function yT(e){const t=e.fetchImpl??globalThis.fetch;return{async request({method:r,path:a,query:s,body:l,headers:c}){const u=xT(e.baseUrl,a,s),h=await vT(e.auth),d=await t(u,{method:r,headers:{...l?{"Content-Type":"application/json"}:{},...h,...c},body:l?JSON.stringify(l):void 0}),g=await d.text(),x=(d.headers.get("content-type")||"").includes("application/json"),v=x&&g?JSON.parse(g):g;if(!d.ok){const _=x?v:void 0,b=_?.error;throw new Ec(b?.message??`Request failed with status ${d.status}`,{status:d.status,icebergType:b?.type,icebergCode:b?.code,details:_})}return{status:d.status,headers:d.headers,data:v}}}}function fu(e){return e.join("")}var _T=class{constructor(e,t=""){this.client=e,this.prefix=t}async listNamespaces(e){const t=e?{parent:fu(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(a=>({namespace:a}))}async createNamespace(e,t){const r={namespace:e.namespace,properties:t?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${fu(e.namespace)}`})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${fu(e.namespace)}`})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${fu(e.namespace)}`}),!0}catch(t){if(t instanceof Ec&&t.status===404)return!1;throw t}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(r){if(r instanceof Ec&&r.status===409)return;throw r}}};function Pl(e){return e.join("")}var wT=class{constructor(e,t="",r){this.client=e,this.prefix=t,this.accessDelegation=r}async listTables(e){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Pl(e.namespace)}/tables`})).data.identifiers}async createTable(e,t){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Pl(e.namespace)}/tables`,body:t,headers:r})).data.metadata}async updateTable(e,t){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Pl(e.namespace)}/tables/${e.name}`,body:t});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(e,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Pl(e.namespace)}/tables/${e.name}`,query:{purgeRequested:String(t?.purge??!1)}})}async loadTable(e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Pl(e.namespace)}/tables/${e.name}`,headers:t})).data.metadata}async tableExists(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Pl(e.namespace)}/tables/${e.name}`,headers:t}),!0}catch(r){if(r instanceof Ec&&r.status===404)return!1;throw r}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(r){if(r instanceof Ec&&r.status===409)return await this.loadTable({namespace:e.namespace,name:t.name});throw r}}},bT=class{constructor(e){let t="v1";e.catalogName&&(t+=`/${e.catalogName}`);const r=e.baseUrl.endsWith("/")?e.baseUrl:`${e.baseUrl}/`;this.client=yT({baseUrl:r,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=e.accessDelegation?.join(","),this.namespaceOps=new _T(this.client,t),this.tableOps=new wT(this.client,t,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}},Xu=class extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}};function hr(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}var ST=class extends Xu{constructor(e,t,r){super(e),this.name="StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Vd=class extends Xu{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}};const dm=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),ET=()=>Response,Gd=e=>{if(Array.isArray(e))return e.map(r=>Gd(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,a])=>{const s=r.replace(/([-_][a-z])/gi,l=>l.toUpperCase().replace(/[-_]/g,""));t[s]=Gd(a)}),t},TT=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},kT=e=>!e||typeof e!="string"||e.length===0||e.length>100||e.trim()!==e||e.includes("/")||e.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(e);function Tc(e){"@babel/helpers - typeof";return Tc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tc(e)}function AT(e,t){if(Tc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Tc(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function CT(e){var t=AT(e,"string");return Tc(t)=="symbol"?t:t+""}function NT(e,t,r){return(t=CT(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lv(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function ut(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?lv(Object(r),!0).forEach(function(a){NT(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lv(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}const vd=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},OT=async(e,t,r)=>{e instanceof await ET()&&!r?.noResolveJson?e.json().then(a=>{const s=e.status||500,l=a?.statusCode||s+"";t(new ST(vd(a),s,l))}).catch(a=>{t(new Vd(vd(a),a))}):t(new Vd(vd(e),e))},RT=(e,t,r,a)=>{const s={method:e,headers:t?.headers||{}};return e==="GET"||!a?s:(TT(a)?(s.headers=ut({"Content-Type":"application/json"},t?.headers),s.body=JSON.stringify(a)):s.body=a,t?.duplex&&(s.duplex=t.duplex),ut(ut({},s),r))};async function qc(e,t,r,a,s,l){return new Promise((c,u)=>{e(r,RT(t,a,s,l)).then(h=>{if(!h.ok)throw h;return a?.noResolveJson?h:h.json()}).then(h=>c(h)).catch(h=>OT(h,u,a))})}async function kc(e,t,r,a){return qc(e,"GET",t,r,a)}async function Sn(e,t,r,a,s){return qc(e,"POST",t,a,s,r)}async function qd(e,t,r,a,s){return qc(e,"PUT",t,a,s,r)}async function DT(e,t,r,a){return qc(e,"HEAD",t,ut(ut({},r),{},{noResolveJson:!0}),a)}async function mm(e,t,r,a,s){return qc(e,"DELETE",t,a,s,r)}var FT=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}async execute(){var e=this;try{return{data:(await e.downloadFn()).body,error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(hr(t))return{data:null,error:t};throw t}}};let Wy;Wy=Symbol.toStringTag;var MT=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[Wy]="BlobDownloadBuilder",this.promise=null}asStream(){return new FT(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var e=this;try{return{data:await(await e.downloadFn()).blob(),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(hr(t))return{data:null,error:t};throw t}}};const LT={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},ov={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var BT=class{constructor(e,t={},r,a){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=r,this.fetch=dm(a)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(e,t,r,a){var s=this;try{let l;const c=ut(ut({},ov),a);let u=ut(ut({},s.headers),e==="POST"&&{"x-upsert":String(c.upsert)});const h=c.metadata;typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),h&&l.append("metadata",s.encodeMetadata(h)),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.has("cacheControl")||l.append("cacheControl",c.cacheControl),h&&!l.has("metadata")&&l.append("metadata",s.encodeMetadata(h))):(l=r,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType,h&&(u["x-metadata"]=s.toBase64(s.encodeMetadata(h))),(typeof ReadableStream<"u"&&l instanceof ReadableStream||l&&typeof l=="object"&&"pipe"in l&&typeof l.pipe=="function")&&!c.duplex&&(c.duplex="half")),a?.headers&&(u=ut(ut({},u),a.headers));const d=s._removeEmptyFolders(t),g=s._getFinalPath(d),x=await(e=="PUT"?qd:Sn)(s.fetch,`${s.url}/object/${g}`,l,ut({headers:u},c?.duplex?{duplex:c.duplex}:{}));return{data:{path:d,id:x.Id,fullPath:x.Key},error:null}}catch(l){if(s.shouldThrowOnError)throw l;if(hr(l))return{data:null,error:l};throw l}}async upload(e,t,r){return this.uploadOrUpdate("POST",e,t,r)}async uploadToSignedUrl(e,t,r,a){var s=this;const l=s._removeEmptyFolders(e),c=s._getFinalPath(l),u=new URL(s.url+`/object/upload/sign/${c}`);u.searchParams.set("token",t);try{let h;const d=ut({upsert:ov.upsert},a),g=ut(ut({},s.headers),{"x-upsert":String(d.upsert)});return typeof Blob<"u"&&r instanceof Blob?(h=new FormData,h.append("cacheControl",d.cacheControl),h.append("",r)):typeof FormData<"u"&&r instanceof FormData?(h=r,h.append("cacheControl",d.cacheControl)):(h=r,g["cache-control"]=`max-age=${d.cacheControl}`,g["content-type"]=d.contentType),{data:{path:l,fullPath:(await qd(s.fetch,u.toString(),h,{headers:g})).Key},error:null}}catch(h){if(s.shouldThrowOnError)throw h;if(hr(h))return{data:null,error:h};throw h}}async createSignedUploadUrl(e,t){var r=this;try{let a=r._getFinalPath(e);const s=ut({},r.headers);t?.upsert&&(s["x-upsert"]="true");const l=await Sn(r.fetch,`${r.url}/object/upload/sign/${a}`,{},{headers:s}),c=new URL(r.url+l.url),u=c.searchParams.get("token");if(!u)throw new Xu("No token returned by API");return{data:{signedUrl:c.toString(),path:e,token:u},error:null}}catch(a){if(r.shouldThrowOnError)throw a;if(hr(a))return{data:null,error:a};throw a}}async update(e,t,r){return this.uploadOrUpdate("PUT",e,t,r)}async move(e,t,r){var a=this;try{return{data:await Sn(a.fetch,`${a.url}/object/move`,{bucketId:a.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r?.destinationBucket},{headers:a.headers}),error:null}}catch(s){if(a.shouldThrowOnError)throw s;if(hr(s))return{data:null,error:s};throw s}}async copy(e,t,r){var a=this;try{return{data:{path:(await Sn(a.fetch,`${a.url}/object/copy`,{bucketId:a.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r?.destinationBucket},{headers:a.headers})).Key},error:null}}catch(s){if(a.shouldThrowOnError)throw s;if(hr(s))return{data:null,error:s};throw s}}async createSignedUrl(e,t,r){var a=this;try{let s=a._getFinalPath(e),l=await Sn(a.fetch,`${a.url}/object/sign/${s}`,ut({expiresIn:t},r?.transform?{transform:r.transform}:{}),{headers:a.headers});const c=r?.download?`&download=${r.download===!0?"":r.download}`:"";return l={signedUrl:encodeURI(`${a.url}${l.signedURL}${c}`)},{data:l,error:null}}catch(s){if(a.shouldThrowOnError)throw s;if(hr(s))return{data:null,error:s};throw s}}async createSignedUrls(e,t,r){var a=this;try{const s=await Sn(a.fetch,`${a.url}/object/sign/${a.bucketId}`,{expiresIn:t,paths:e},{headers:a.headers}),l=r?.download?`&download=${r.download===!0?"":r.download}`:"";return{data:s.map(c=>ut(ut({},c),{},{signedUrl:c.signedURL?encodeURI(`${a.url}${c.signedURL}${l}`):null})),error:null}}catch(s){if(a.shouldThrowOnError)throw s;if(hr(s))return{data:null,error:s};throw s}}download(e,t){const r=typeof t?.transform<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString(t?.transform||{}),s=a?`?${a}`:"",l=this._getFinalPath(e),c=()=>kc(this.fetch,`${this.url}/${r}/${l}${s}`,{headers:this.headers,noResolveJson:!0});return new MT(c,this.shouldThrowOnError)}async info(e){var t=this;const r=t._getFinalPath(e);try{return{data:Gd(await kc(t.fetch,`${t.url}/object/info/${r}`,{headers:t.headers})),error:null}}catch(a){if(t.shouldThrowOnError)throw a;if(hr(a))return{data:null,error:a};throw a}}async exists(e){var t=this;const r=t._getFinalPath(e);try{return await DT(t.fetch,`${t.url}/object/${r}`,{headers:t.headers}),{data:!0,error:null}}catch(a){if(t.shouldThrowOnError)throw a;if(hr(a)&&a instanceof Vd){const s=a.originalError;if([400,404].includes(s?.status))return{data:!1,error:a}}throw a}}getPublicUrl(e,t){const r=this._getFinalPath(e),a=[],s=t?.download?`download=${t.download===!0?"":t.download}`:"";s!==""&&a.push(s);const l=typeof t?.transform<"u"?"render/image":"object",c=this.transformOptsToQueryString(t?.transform||{});c!==""&&a.push(c);let u=a.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${r}${u}`)}}}async remove(e){var t=this;try{return{data:await mm(t.fetch,`${t.url}/object/${t.bucketId}`,{prefixes:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(hr(r))return{data:null,error:r};throw r}}async list(e,t,r){var a=this;try{const s=ut(ut(ut({},LT),t),{},{prefix:e||""});return{data:await Sn(a.fetch,`${a.url}/object/list/${a.bucketId}`,s,{headers:a.headers},r),error:null}}catch(s){if(a.shouldThrowOnError)throw s;if(hr(s))return{data:null,error:s};throw s}}async listV2(e,t){var r=this;try{const a=ut({},e);return{data:await Sn(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,a,{headers:r.headers},t),error:null}}catch(a){if(r.shouldThrowOnError)throw a;if(hr(a))return{data:null,error:a};throw a}}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}};const Ky="2.89.0",Yy={"X-Client-Info":`storage-js/${Ky}`};var IT=class{constructor(e,t={},r,a){this.shouldThrowOnError=!1;const s=new URL(e);a?.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase.")),this.url=s.href.replace(/\/$/,""),this.headers=ut(ut({},Yy),t),this.fetch=dm(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(e){var t=this;try{const r=t.listBucketOptionsToQueryString(e);return{data:await kc(t.fetch,`${t.url}/bucket${r}`,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(hr(r))return{data:null,error:r};throw r}}async getBucket(e){var t=this;try{return{data:await kc(t.fetch,`${t.url}/bucket/${e}`,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(hr(r))return{data:null,error:r};throw r}}async createBucket(e,t={public:!1}){var r=this;try{return{data:await Sn(r.fetch,`${r.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}),error:null}}catch(a){if(r.shouldThrowOnError)throw a;if(hr(a))return{data:null,error:a};throw a}}async updateBucket(e,t){var r=this;try{return{data:await qd(r.fetch,`${r.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}),error:null}}catch(a){if(r.shouldThrowOnError)throw a;if(hr(a))return{data:null,error:a};throw a}}async emptyBucket(e){var t=this;try{return{data:await Sn(t.fetch,`${t.url}/bucket/${e}/empty`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(hr(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await mm(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(hr(r))return{data:null,error:r};throw r}}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}},jT=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=ut(ut({},Yy),t),this.fetch=dm(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var t=this;try{return{data:await Sn(t.fetch,`${t.url}/bucket`,{name:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(hr(r))return{data:null,error:r};throw r}}async listBuckets(e){var t=this;try{const r=new URLSearchParams;e?.limit!==void 0&&r.set("limit",e.limit.toString()),e?.offset!==void 0&&r.set("offset",e.offset.toString()),e?.sortColumn&&r.set("sortColumn",e.sortColumn),e?.sortOrder&&r.set("sortOrder",e.sortOrder),e?.search&&r.set("search",e.search);const a=r.toString(),s=a?`${t.url}/bucket?${a}`:`${t.url}/bucket`;return{data:await kc(t.fetch,s,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(hr(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await mm(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(hr(r))return{data:null,error:r};throw r}}from(e){var t=this;if(!kT(e))throw new Xu("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new bT({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:async()=>t.headers},fetch:this.fetch}),a=this.shouldThrowOnError;return new Proxy(r,{get(s,l){const c=s[l];return typeof c!="function"?c:async(...u)=>{try{return{data:await c.apply(s,u),error:null}}catch(h){if(a)throw h;return{data:null,error:h}}}}})}};const gm={"X-Client-Info":`storage-js/${Ky}`,"Content-Type":"application/json"};var Jy=class extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function qa(e){return typeof e=="object"&&e!==null&&"__isStorageVectorsError"in e}var yd=class extends Jy{constructor(e,t,r){super(e),this.name="StorageVectorsApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},UT=class extends Jy{constructor(e,t){super(e),this.name="StorageVectorsUnknownError",this.originalError=t}};const pm=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),PT=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},cv=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),zT=async(e,t,r)=>{if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!r?.noResolveJson){const a=e.status||500,s=e;if(typeof s.json=="function")s.json().then(l=>{const c=l?.statusCode||l?.code||a+"";t(new yd(cv(l),a,c))}).catch(()=>{const l=a+"";t(new yd(s.statusText||`HTTP ${a} error`,a,l))});else{const l=a+"";t(new yd(s.statusText||`HTTP ${a} error`,a,l))}}else t(new UT(cv(e),e))},HT=(e,t,r,a)=>{const s={method:e,headers:t?.headers||{}};return a?(PT(a)?(s.headers=ut({"Content-Type":"application/json"},t?.headers),s.body=JSON.stringify(a)):s.body=a,ut(ut({},s),r)):s};async function $T(e,t,r,a,s,l){return new Promise((c,u)=>{e(r,HT(t,a,s,l)).then(h=>{if(!h.ok)throw h;if(a?.noResolveJson)return h;const d=h.headers.get("content-type");return!d||!d.includes("application/json")?{}:h.json()}).then(h=>c(h)).catch(h=>zT(h,u,a))})}async function Xa(e,t,r,a,s){return $T(e,"POST",t,a,s,r)}var VT=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=ut(ut({},gm),t),this.fetch=pm(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(e){var t=this;try{return{data:await Xa(t.fetch,`${t.url}/CreateIndex`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(qa(r))return{data:null,error:r};throw r}}async getIndex(e,t){var r=this;try{return{data:await Xa(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers}),error:null}}catch(a){if(r.shouldThrowOnError)throw a;if(qa(a))return{data:null,error:a};throw a}}async listIndexes(e){var t=this;try{return{data:await Xa(t.fetch,`${t.url}/ListIndexes`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(qa(r))return{data:null,error:r};throw r}}async deleteIndex(e,t){var r=this;try{return{data:await Xa(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers})||{},error:null}}catch(a){if(r.shouldThrowOnError)throw a;if(qa(a))return{data:null,error:a};throw a}}},GT=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=ut(ut({},gm),t),this.fetch=pm(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(e){var t=this;try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await Xa(t.fetch,`${t.url}/PutVectors`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(qa(r))return{data:null,error:r};throw r}}async getVectors(e){var t=this;try{return{data:await Xa(t.fetch,`${t.url}/GetVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(qa(r))return{data:null,error:r};throw r}}async listVectors(e){var t=this;try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:await Xa(t.fetch,`${t.url}/ListVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(qa(r))return{data:null,error:r};throw r}}async queryVectors(e){var t=this;try{return{data:await Xa(t.fetch,`${t.url}/QueryVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(qa(r))return{data:null,error:r};throw r}}async deleteVectors(e){var t=this;try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await Xa(t.fetch,`${t.url}/DeleteVectors`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(qa(r))return{data:null,error:r};throw r}}},qT=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=ut(ut({},gm),t),this.fetch=pm(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var t=this;try{return{data:await Xa(t.fetch,`${t.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(qa(r))return{data:null,error:r};throw r}}async getBucket(e){var t=this;try{return{data:await Xa(t.fetch,`${t.url}/GetVectorBucket`,{vectorBucketName:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(qa(r))return{data:null,error:r};throw r}}async listBuckets(e={}){var t=this;try{return{data:await Xa(t.fetch,`${t.url}/ListVectorBuckets`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(qa(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await Xa(t.fetch,`${t.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(qa(r))return{data:null,error:r};throw r}}},XT=class extends qT{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new WT(this.url,this.headers,e,this.fetch)}async createBucket(e){var t=()=>super.createBucket,r=this;return t().call(r,e)}async getBucket(e){var t=()=>super.getBucket,r=this;return t().call(r,e)}async listBuckets(e={}){var t=()=>super.listBuckets,r=this;return t().call(r,e)}async deleteBucket(e){var t=()=>super.deleteBucket,r=this;return t().call(r,e)}},WT=class extends VT{constructor(e,t,r,a){super(e,t,a),this.vectorBucketName=r}async createIndex(e){var t=()=>super.createIndex,r=this;return t().call(r,ut(ut({},e),{},{vectorBucketName:r.vectorBucketName}))}async listIndexes(e={}){var t=()=>super.listIndexes,r=this;return t().call(r,ut(ut({},e),{},{vectorBucketName:r.vectorBucketName}))}async getIndex(e){var t=()=>super.getIndex,r=this;return t().call(r,r.vectorBucketName,e)}async deleteIndex(e){var t=()=>super.deleteIndex,r=this;return t().call(r,r.vectorBucketName,e)}index(e){return new KT(this.url,this.headers,this.vectorBucketName,e,this.fetch)}},KT=class extends GT{constructor(e,t,r,a,s){super(e,t,s),this.vectorBucketName=r,this.indexName=a}async putVectors(e){var t=()=>super.putVectors,r=this;return t().call(r,ut(ut({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async getVectors(e){var t=()=>super.getVectors,r=this;return t().call(r,ut(ut({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async listVectors(e={}){var t=()=>super.listVectors,r=this;return t().call(r,ut(ut({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async queryVectors(e){var t=()=>super.queryVectors,r=this;return t().call(r,ut(ut({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async deleteVectors(e){var t=()=>super.deleteVectors,r=this;return t().call(r,ut(ut({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}},YT=class extends IT{constructor(e,t={},r,a){super(e,t,r,a)}from(e){return new BT(this.url,this.headers,e,this.fetch)}get vectors(){return new XT(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new jT(this.url+"/iceberg",this.headers,this.fetch)}};const Qy="2.89.0",Yl=30*1e3,Xd=3,_d=Xd*Yl,JT="http://localhost:9999",QT="supabase.auth.token",ZT={"X-Client-Info":`gotrue-js/${Qy}`},Wd="X-Supabase-Api-Version",Zy={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},e4=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,t4=600*1e3;class Ac extends Error{constructor(t,r,a){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=a}}function at(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class r4 extends Ac{constructor(t,r,a){super(t,r,a),this.name="AuthApiError",this.status=r,this.code=a}}function a4(e){return at(e)&&e.name==="AuthApiError"}class Mi extends Ac{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class ps extends Ac{constructor(t,r,a,s){super(t,a,s),this.name=r,this.status=a}}class $a extends ps{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function n4(e){return at(e)&&e.name==="AuthSessionMissingError"}class zl extends ps{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class hu extends ps{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class du extends ps{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function s4(e){return at(e)&&e.name==="AuthImplicitGrantRedirectError"}class uv extends ps{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class i4 extends ps{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class Kd extends ps{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function wd(e){return at(e)&&e.name==="AuthRetryableFetchError"}class fv extends ps{constructor(t,r,a){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=a}}class Yd extends ps{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Cu="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),hv=` 	
\r=`.split(""),l4=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<hv.length;t+=1)e[hv[t].charCodeAt(0)]=-2;for(let t=0;t<Cu.length;t+=1)e[Cu[t].charCodeAt(0)]=t;return e})();function dv(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const a=t.queue>>t.queuedBits-6&63;r(Cu[a]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const a=t.queue>>t.queuedBits-6&63;r(Cu[a]),t.queuedBits-=6}}function e_(e,t,r){const a=l4[e];if(a>-1)for(t.queue=t.queue<<6|a,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(a===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function mv(e){const t=[],r=c=>{t.push(String.fromCodePoint(c))},a={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},l=c=>{u4(c,a,r)};for(let c=0;c<e.length;c+=1)e_(e.charCodeAt(c),s,l);return t.join("")}function o4(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function c4(e,t){for(let r=0;r<e.length;r+=1){let a=e.charCodeAt(r);if(a>55295&&a<=56319){const s=(a-55296)*1024&65535;a=(e.charCodeAt(r+1)-56320&65535|s)+65536,r+=1}o4(a,t)}}function u4(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let a=1;a<6;a+=1)if((e>>7-a&1)===0){t.utf8seq=a;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function to(e){const t=[],r={queue:0,queuedBits:0},a=s=>{t.push(s)};for(let s=0;s<e.length;s+=1)e_(e.charCodeAt(s),r,a);return new Uint8Array(t)}function f4(e){const t=[];return c4(e,r=>t.push(r)),new Uint8Array(t)}function Bi(e){const t=[],r={queue:0,queuedBits:0},a=s=>{t.push(s)};return e.forEach(s=>dv(s,r,a)),dv(null,r,a),t.join("")}function h4(e){return Math.round(Date.now()/1e3)+e}function d4(){return Symbol("auth-callback")}const ta=()=>typeof window<"u"&&typeof document<"u",Oi={tested:!1,writable:!1},t_=()=>{if(!ta())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Oi.tested)return Oi.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Oi.tested=!0,Oi.writable=!0}catch{Oi.tested=!0,Oi.writable=!1}return Oi.writable};function m4(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((s,l)=>{t[l]=s})}catch{}return r.searchParams.forEach((a,s)=>{t[s]=a}),t}const r_=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),g4=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Jl=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},Ri=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},ea=async(e,t)=>{await e.removeItem(t)};class Wu{constructor(){this.promise=new Wu.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}Wu.promiseConstructor=Promise;function bd(e){const t=e.split(".");if(t.length!==3)throw new Yd("Invalid JWT structure");for(let a=0;a<t.length;a++)if(!e4.test(t[a]))throw new Yd("JWT not in base64url format");return{header:JSON.parse(mv(t[0])),payload:JSON.parse(mv(t[1])),signature:to(t[2]),raw:{header:t[0],payload:t[1]}}}async function p4(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function x4(e,t){return new Promise((a,s)=>{(async()=>{for(let l=0;l<1/0;l++)try{const c=await e(l);if(!t(l,null,c)){a(c);return}}catch(c){if(!t(l,c)){s(c);return}}})()})}function v4(e){return("0"+e.toString(16)).substr(-2)}function y4(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",a=r.length;let s="";for(let l=0;l<56;l++)s+=r.charAt(Math.floor(Math.random()*a));return s}return crypto.getRandomValues(t),Array.from(t,v4).join("")}async function _4(e){const r=new TextEncoder().encode(e),a=await crypto.subtle.digest("SHA-256",r),s=new Uint8Array(a);return Array.from(s).map(l=>String.fromCharCode(l)).join("")}async function w4(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await _4(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Hl(e,t,r=!1){const a=y4();let s=a;r&&(s+="/PASSWORD_RECOVERY"),await Jl(e,`${t}-code-verifier`,s);const l=await w4(a);return[l,a===l?"plain":"s256"]}const b4=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function S4(e){const t=e.headers.get(Wd);if(!t||!t.match(b4))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function E4(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function T4(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const k4=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function $l(e){if(!k4.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Sd(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const a=r.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function A4(e,t){return new Proxy(e,{get:(r,a,s)=>{if(a==="__isInsecureUserWarningProxy")return!0;if(typeof a=="symbol"){const l=a.toString();if(l==="Symbol(Symbol.toPrimitive)"||l==="Symbol(Symbol.toStringTag)"||l==="Symbol(util.inspect.custom)"||l==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,a,s)}return!t.value&&typeof a=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(r,a,s)}})}function gv(e){return JSON.parse(JSON.stringify(e))}const Di=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),C4=[502,503,504];async function pv(e){var t;if(!g4(e))throw new Kd(Di(e),0);if(C4.includes(e.status))throw new Kd(Di(e),e.status);let r;try{r=await e.json()}catch(l){throw new Mi(Di(l),l)}let a;const s=S4(e);if(s&&s.getTime()>=Zy["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?a=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(a=r.error_code),a){if(a==="weak_password")throw new fv(Di(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(a==="session_not_found")throw new $a}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((l,c)=>l&&typeof c=="string",!0))throw new fv(Di(r),e.status,r.weak_password.reasons);throw new r4(Di(r),e.status||500,a)}const N4=(e,t,r,a)=>{const s={method:e,headers:t?.headers||{}};return e==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t?.headers),s.body=JSON.stringify(a),Object.assign(Object.assign({},s),r))};async function ct(e,t,r,a){var s;const l=Object.assign({},a?.headers);l[Wd]||(l[Wd]=Zy["2024-01-01"].name),a?.jwt&&(l.Authorization=`Bearer ${a.jwt}`);const c=(s=a?.query)!==null&&s!==void 0?s:{};a?.redirectTo&&(c.redirect_to=a.redirectTo);const u=Object.keys(c).length?"?"+new URLSearchParams(c).toString():"",h=await O4(e,t,r+u,{headers:l,noResolveJson:a?.noResolveJson},{},a?.body);return a?.xform?a?.xform(h):{data:Object.assign({},h),error:null}}async function O4(e,t,r,a,s,l){const c=N4(t,a,s,l);let u;try{u=await e(r,Object.assign({},c))}catch(h){throw console.error(h),new Kd(Di(h),0)}if(u.ok||await pv(u),a?.noResolveJson)return u;try{return await u.json()}catch(h){await pv(h)}}function bn(e){var t;let r=null;F4(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=h4(e.expires_in)));const a=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:a},error:null}}function xv(e){const t=bn(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,a)=>r&&typeof a=="string",!0)&&(t.data.weak_password=e.weak_password),t}function Zs(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function R4(e){return{data:e,error:null}}function D4(e){const{action_link:t,email_otp:r,hashed_token:a,redirect_to:s,verification_type:l}=e,c=qu(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),u={action_link:t,email_otp:r,hashed_token:a,redirect_to:s,verification_type:l},h=Object.assign({},c);return{data:{properties:u,user:h},error:null}}function vv(e){return e}function F4(e){return e.access_token&&e.refresh_token&&e.expires_in}const Ed=["global","local","others"];class M4{constructor({url:t="",headers:r={},fetch:a}){this.url=t,this.headers=r,this.fetch=r_(a),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=Ed[0]){if(Ed.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Ed.join(", ")}`);try{return await ct(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(a){if(at(a))return{data:null,error:a};throw a}}async inviteUserByEmail(t,r={}){try{return await ct(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Zs})}catch(a){if(at(a))return{data:{user:null},error:a};throw a}}async generateLink(t){try{const{options:r}=t,a=qu(t,["options"]),s=Object.assign(Object.assign({},a),r);return"newEmail"in a&&(s.new_email=a?.newEmail,delete s.newEmail),await ct(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:D4,redirectTo:r?.redirectTo})}catch(r){if(at(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await ct(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Zs})}catch(r){if(at(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,a,s,l,c,u,h;try{const d={nextPage:null,lastPage:0,total:0},g=await ct(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(r=t?.page)===null||r===void 0?void 0:r.toString())!==null&&a!==void 0?a:"",per_page:(l=(s=t?.perPage)===null||s===void 0?void 0:s.toString())!==null&&l!==void 0?l:""},xform:vv});if(g.error)throw g.error;const x=await g.json(),v=(c=g.headers.get("x-total-count"))!==null&&c!==void 0?c:0,_=(h=(u=g.headers.get("link"))===null||u===void 0?void 0:u.split(","))!==null&&h!==void 0?h:[];return _.length>0&&(_.forEach(b=>{const y=parseInt(b.split(";")[0].split("=")[1].substring(0,1)),S=JSON.parse(b.split(";")[1].split("=")[1]);d[`${S}Page`]=y}),d.total=parseInt(v)),{data:Object.assign(Object.assign({},x),d),error:null}}catch(d){if(at(d))return{data:{users:[]},error:d};throw d}}async getUserById(t){$l(t);try{return await ct(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Zs})}catch(r){if(at(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){$l(t);try{return await ct(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:Zs})}catch(a){if(at(a))return{data:{user:null},error:a};throw a}}async deleteUser(t,r=!1){$l(t);try{return await ct(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:Zs})}catch(a){if(at(a))return{data:{user:null},error:a};throw a}}async _listFactors(t){$l(t.userId);try{const{data:r,error:a}=await ct(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:r,error:a}}catch(r){if(at(r))return{data:null,error:r};throw r}}async _deleteFactor(t){$l(t.userId),$l(t.id);try{return{data:await ct(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(at(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,a,s,l,c,u,h;try{const d={nextPage:null,lastPage:0,total:0},g=await ct(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(r=t?.page)===null||r===void 0?void 0:r.toString())!==null&&a!==void 0?a:"",per_page:(l=(s=t?.perPage)===null||s===void 0?void 0:s.toString())!==null&&l!==void 0?l:""},xform:vv});if(g.error)throw g.error;const x=await g.json(),v=(c=g.headers.get("x-total-count"))!==null&&c!==void 0?c:0,_=(h=(u=g.headers.get("link"))===null||u===void 0?void 0:u.split(","))!==null&&h!==void 0?h:[];return _.length>0&&(_.forEach(b=>{const y=parseInt(b.split(";")[0].split("=")[1].substring(0,1)),S=JSON.parse(b.split(";")[1].split("=")[1]);d[`${S}Page`]=y}),d.total=parseInt(v)),{data:Object.assign(Object.assign({},x),d),error:null}}catch(d){if(at(d))return{data:{clients:[]},error:d};throw d}}async _createOAuthClient(t){try{return await ct(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(at(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await ct(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(at(r))return{data:null,error:r};throw r}}async _updateOAuthClient(t,r){try{return await ct(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:r,headers:this.headers,xform:a=>({data:a,error:null})})}catch(a){if(at(a))return{data:null,error:a};throw a}}async _deleteOAuthClient(t){try{return await ct(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(at(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await ct(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(at(r))return{data:null,error:r};throw r}}}function yv(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const Vl={debug:!!(globalThis&&t_()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class a_ extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class L4 extends a_{}async function B4(e,t,r){Vl.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const a=new globalThis.AbortController;return t>0&&setTimeout(()=>{a.abort(),Vl.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:a.signal},async s=>{if(s){Vl.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,s.name);try{return await r()}finally{Vl.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,s.name)}}else{if(t===0)throw Vl.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new L4(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Vl.debug)try{const l=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(l,null,"  "))}catch(l){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",l)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function I4(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function n_(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function j4(e){return parseInt(e,16)}function U4(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,a=>a.toString(16).padStart(2,"0")).join("")}function P4(e){var t;const{chainId:r,domain:a,expirationTime:s,issuedAt:l=new Date,nonce:c,notBefore:u,requestId:h,resources:d,scheme:g,uri:x,version:v}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!a)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(c&&c.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${c}`);if(!x)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(v!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${v}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const _=n_(e.address),b=g?`${g}://${a}`:a,y=e.statement?`${e.statement}
`:"",S=`${b} wants you to sign in with your Ethereum account:
${_}

${y}`;let k=`URI: ${x}
Version: ${v}
Chain ID: ${r}${c?`
Nonce: ${c}`:""}
Issued At: ${l.toISOString()}`;if(s&&(k+=`
Expiration Time: ${s.toISOString()}`),u&&(k+=`
Not Before: ${u.toISOString()}`),h&&(k+=`
Request ID: ${h}`),d){let R=`
Resources:`;for(const T of d){if(!T||typeof T!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${T}`);R+=`
- ${T}`}k+=R}return`${S}
${k}`}class Br extends Error{constructor({message:t,code:r,cause:a,name:s}){var l;super(t,{cause:a}),this.__isWebAuthnError=!0,this.name=(l=s??(a instanceof Error?a.name:void 0))!==null&&l!==void 0?l:"Unknown Error",this.code=r}}class Nu extends Br{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function z4({error:e,options:t}){var r,a,s;const{publicKey:l}=t;if(!l)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Br({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=l.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new Br({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((a=l.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new Br({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((s=l.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new Br({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new Br({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new Br({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return l.pubKeyCredParams.filter(u=>u.type==="public-key").length===0?new Br({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new Br({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const c=window.location.hostname;if(s_(c)){if(l.rp.id!==c)return new Br({message:`The RP ID "${l.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Br({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(l.user.id.byteLength<1||l.user.id.byteLength>64)return new Br({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new Br({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Br({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function H4({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Br({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new Br({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const a=window.location.hostname;if(s_(a)){if(r.rpId!==a)return new Br({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Br({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new Br({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Br({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class $4{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const V4=new $4;function G4(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:a}=e,s=qu(e,["challenge","user","excludeCredentials"]),l=to(t).buffer,c=Object.assign(Object.assign({},r),{id:to(r.id).buffer}),u=Object.assign(Object.assign({},s),{challenge:l,user:c});if(a&&a.length>0){u.excludeCredentials=new Array(a.length);for(let h=0;h<a.length;h++){const d=a[h];u.excludeCredentials[h]=Object.assign(Object.assign({},d),{id:to(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return u}function q4(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,a=qu(e,["challenge","allowCredentials"]),s=to(t).buffer,l=Object.assign(Object.assign({},a),{challenge:s});if(r&&r.length>0){l.allowCredentials=new Array(r.length);for(let c=0;c<r.length;c++){const u=r[c];l.allowCredentials[c]=Object.assign(Object.assign({},u),{id:to(u.id).buffer,type:u.type||"public-key",transports:u.transports})}}return l}function X4(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:Bi(new Uint8Array(e.response.attestationObject)),clientDataJSON:Bi(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function W4(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,a=e.getClientExtensionResults(),s=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:Bi(new Uint8Array(s.authenticatorData)),clientDataJSON:Bi(new Uint8Array(s.clientDataJSON)),signature:Bi(new Uint8Array(s.signature)),userHandle:s.userHandle?Bi(new Uint8Array(s.userHandle)):void 0},type:"public-key",clientExtensionResults:a,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function s_(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function _v(){var e,t;return!!(ta()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator?.credentials)===null||t===void 0?void 0:t.get)=="function")}async function K4(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Nu("Browser returned unexpected credential type",t)}:{data:null,error:new Nu("Empty credential response",t)}}catch(t){return{data:null,error:z4({error:t,options:e})}}}async function Y4(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Nu("Browser returned unexpected credential type",t)}:{data:null,error:new Nu("Empty credential response",t)}}catch(t){return{data:null,error:H4({error:t,options:e})}}}const J4={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},Q4={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Ou(...e){const t=s=>s!==null&&typeof s=="object"&&!Array.isArray(s),r=s=>s instanceof ArrayBuffer||ArrayBuffer.isView(s),a={};for(const s of e)if(s)for(const l in s){const c=s[l];if(c!==void 0)if(Array.isArray(c))a[l]=c;else if(r(c))a[l]=c;else if(t(c)){const u=a[l];t(u)?a[l]=Ou(u,c):a[l]=Ou(c)}else a[l]=c}return a}function Z4(e,t){return Ou(J4,e,t||{})}function ek(e,t){return Ou(Q4,e,t||{})}class tk{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:a,signal:s},l){try{const{data:c,error:u}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!c)return{data:null,error:u};const h=s??V4.createNewAbortSignal();if(c.webauthn.type==="create"){const{user:d}=c.webauthn.credential_options.publicKey;d.name||(d.name=`${d.id}:${a}`),d.displayName||(d.displayName=d.name)}switch(c.webauthn.type){case"create":{const d=Z4(c.webauthn.credential_options.publicKey,l?.create),{data:g,error:x}=await K4({publicKey:d,signal:h});return g?{data:{factorId:t,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:g}},error:null}:{data:null,error:x}}case"request":{const d=ek(c.webauthn.credential_options.publicKey,l?.request),{data:g,error:x}=await Y4(Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:d,signal:h}));return g?{data:{factorId:t,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:g}},error:null}:{data:null,error:x}}}}catch(c){return at(c)?{data:null,error:c}:{data:null,error:new Mi("Unexpected error in challenge",c)}}}async _verify({challengeId:t,factorId:r,webauthn:a}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:a})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:a=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},l){if(!r)return{data:null,error:new Ac("rpId is required for WebAuthn authentication")};try{if(!_v())return{data:null,error:new Mi("Browser does not support WebAuthn",null)};const{data:c,error:u}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:a},signal:s},{request:l});if(!c)return{data:null,error:u};const{webauthn:h}=c;return this._verify({factorId:t,challengeId:c.challengeId,webauthn:{type:h.type,rpId:r,rpOrigins:a,credential_response:h.credential_response}})}catch(c){return at(c)?{data:null,error:c}:{data:null,error:new Mi("Unexpected error in authenticate",c)}}}async _register({friendlyName:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:a=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},l){if(!r)return{data:null,error:new Ac("rpId is required for WebAuthn registration")};try{if(!_v())return{data:null,error:new Mi("Browser does not support WebAuthn",null)};const{data:c,error:u}=await this._enroll({friendlyName:t});if(!c)return await this.client.mfa.listFactors().then(g=>{var x;return(x=g.data)===null||x===void 0?void 0:x.all.find(v=>v.factor_type==="webauthn"&&v.friendly_name===t&&v.status!=="unverified")}).then(g=>g?this.client.mfa.unenroll({factorId:g?.id}):void 0),{data:null,error:u};const{data:h,error:d}=await this._challenge({factorId:c.id,friendlyName:c.friendly_name,webauthn:{rpId:r,rpOrigins:a},signal:s},{create:l});return h?this._verify({factorId:c.id,challengeId:h.challengeId,webauthn:{rpId:r,rpOrigins:a,type:h.webauthn.type,credential_response:h.webauthn.credential_response}}):{data:null,error:d}}catch(c){return at(c)?{data:null,error:c}:{data:null,error:new Mi("Unexpected error in register",c)}}}}I4();const rk={url:JT,storageKey:QT,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:ZT,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function wv(e,t,r){return await r()}const Gl={};class Cc{get jwks(){var t,r;return(r=(t=Gl[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){Gl[this.storageKey]=Object.assign(Object.assign({},Gl[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=Gl[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){Gl[this.storageKey]=Object.assign(Object.assign({},Gl[this.storageKey]),{cachedAt:t})}constructor(t){var r,a,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const l=Object.assign(Object.assign({},rk),t);if(this.storageKey=l.storageKey,this.instanceID=(r=Cc.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,Cc.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!l.debug,typeof l.debug=="function"&&(this.logger=l.debug),this.instanceID>0&&ta()){const c=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(c),this.logDebugMessages&&console.trace(c)}if(this.persistSession=l.persistSession,this.autoRefreshToken=l.autoRefreshToken,this.admin=new M4({url:l.url,headers:l.headers,fetch:l.fetch}),this.url=l.url,this.headers=l.headers,this.fetch=r_(l.fetch),this.lock=l.lock||wv,this.detectSessionInUrl=l.detectSessionInUrl,this.flowType=l.flowType,this.hasCustomAuthorizationHeader=l.hasCustomAuthorizationHeader,this.throwOnError=l.throwOnError,l.lock?this.lock=l.lock:this.persistSession&&ta()&&(!((a=globalThis?.navigator)===null||a===void 0)&&a.locks)?this.lock=B4:this.lock=wv,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new tk(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(l.storage?this.storage=l.storage:t_()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=yv(this.memoryStorage)),l.userStorage&&(this.userStorage=l.userStorage)):(this.memoryStorage={},this.storage=yv(this.memoryStorage)),ta()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(c){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",c)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async c=>{this._debug("received broadcast notification from other tab or client",c),await this._notifyAllSubscribers(c.data.event,c.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${Qy}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let r={},a="none";if(ta()&&(r=m4(window.location.href),this._isImplicitGrantCallback(r)?a="implicit":await this._isPKCECallback(r)&&(a="pkce")),ta()&&this.detectSessionInUrl&&a!=="none"){const{data:s,error:l}=await this._getSessionFromURL(r,a);if(l){if(this._debug("#_initialize()","error detecting session from URL",l),s4(l)){const h=(t=l.details)===null||t===void 0?void 0:t.code;if(h==="identity_already_exists"||h==="identity_not_found"||h==="single_identity_not_deletable")return{error:l}}return await this._removeSession(),{error:l}}const{session:c,redirectType:u}=s;return this._debug("#_initialize()","detected session in URL",c,"redirect type",u),await this._saveSession(c),setTimeout(async()=>{u==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",c):await this._notifyAllSubscribers("SIGNED_IN",c)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return at(r)?this._returnResult({error:r}):this._returnResult({error:new Mi("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,a,s;try{const l=await ct(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(a=(r=t?.options)===null||r===void 0?void 0:r.data)!==null&&a!==void 0?a:{},gotrue_meta_security:{captcha_token:(s=t?.options)===null||s===void 0?void 0:s.captchaToken}},xform:bn}),{data:c,error:u}=l;if(u||!c)return this._returnResult({data:{user:null,session:null},error:u});const h=c.session,d=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",h)),this._returnResult({data:{user:d,session:h},error:null})}catch(l){if(at(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async signUp(t){var r,a,s;try{let l;if("email"in t){const{email:g,password:x,options:v}=t;let _=null,b=null;this.flowType==="pkce"&&([_,b]=await Hl(this.storage,this.storageKey)),l=await ct(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:v?.emailRedirectTo,body:{email:g,password:x,data:(r=v?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:v?.captchaToken},code_challenge:_,code_challenge_method:b},xform:bn})}else if("phone"in t){const{phone:g,password:x,options:v}=t;l=await ct(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:g,password:x,data:(a=v?.data)!==null&&a!==void 0?a:{},channel:(s=v?.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:v?.captchaToken}},xform:bn})}else throw new hu("You must provide either an email or phone number and a password");const{data:c,error:u}=l;if(u||!c)return await ea(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:u});const h=c.session,d=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",h)),this._returnResult({data:{user:d,session:h},error:null})}catch(l){if(await ea(this.storage,`${this.storageKey}-code-verifier`),at(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async signInWithPassword(t){try{let r;if("email"in t){const{email:l,password:c,options:u}=t;r=await ct(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:l,password:c,gotrue_meta_security:{captcha_token:u?.captchaToken}},xform:xv})}else if("phone"in t){const{phone:l,password:c,options:u}=t;r=await ct(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:l,password:c,gotrue_meta_security:{captcha_token:u?.captchaToken}},xform:xv})}else throw new hu("You must provide either an email or phone number and a password");const{data:a,error:s}=r;if(s)return this._returnResult({data:{user:null,session:null},error:s});if(!a||!a.session||!a.user){const l=new zl;return this._returnResult({data:{user:null,session:null},error:l})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:Object.assign({user:a.user,session:a.session},a.weak_password?{weakPassword:a.weak_password}:null),error:s})}catch(r){if(at(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(t){var r,a,s,l;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(a=t.options)===null||a===void 0?void 0:a.scopes,queryParams:(s=t.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(l=t.options)===null||l===void 0?void 0:l.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,a,s,l,c,u,h,d,g,x,v;let _,b;if("message"in t)_=t.message,b=t.signature;else{const{chain:y,wallet:S,statement:k,options:R}=t;let T;if(ta())if(typeof S=="object")T=S;else{const q=window;if("ethereum"in q&&typeof q.ethereum=="object"&&"request"in q.ethereum&&typeof q.ethereum.request=="function")T=q.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof S!="object"||!R?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");T=S}const j=new URL((r=R?.url)!==null&&r!==void 0?r:window.location.href),X=await T.request({method:"eth_requestAccounts"}).then(q=>q).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!X||X.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const L=n_(X[0]);let A=(a=R?.signInWithEthereum)===null||a===void 0?void 0:a.chainId;if(!A){const q=await T.request({method:"eth_chainId"});A=j4(q)}const K={domain:j.host,address:L,statement:k,uri:j.href,version:"1",chainId:A,nonce:(s=R?.signInWithEthereum)===null||s===void 0?void 0:s.nonce,issuedAt:(c=(l=R?.signInWithEthereum)===null||l===void 0?void 0:l.issuedAt)!==null&&c!==void 0?c:new Date,expirationTime:(u=R?.signInWithEthereum)===null||u===void 0?void 0:u.expirationTime,notBefore:(h=R?.signInWithEthereum)===null||h===void 0?void 0:h.notBefore,requestId:(d=R?.signInWithEthereum)===null||d===void 0?void 0:d.requestId,resources:(g=R?.signInWithEthereum)===null||g===void 0?void 0:g.resources};_=P4(K),b=await T.request({method:"personal_sign",params:[U4(_),L]})}try{const{data:y,error:S}=await ct(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:_,signature:b},!((x=t.options)===null||x===void 0)&&x.captchaToken?{gotrue_meta_security:{captcha_token:(v=t.options)===null||v===void 0?void 0:v.captchaToken}}:null),xform:bn});if(S)throw S;if(!y||!y.session||!y.user){const k=new zl;return this._returnResult({data:{user:null,session:null},error:k})}return y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("SIGNED_IN",y.session)),this._returnResult({data:Object.assign({},y),error:S})}catch(y){if(at(y))return this._returnResult({data:{user:null,session:null},error:y});throw y}}async signInWithSolana(t){var r,a,s,l,c,u,h,d,g,x,v,_;let b,y;if("message"in t)b=t.message,y=t.signature;else{const{chain:S,wallet:k,statement:R,options:T}=t;let j;if(ta())if(typeof k=="object")j=k;else{const L=window;if("solana"in L&&typeof L.solana=="object"&&("signIn"in L.solana&&typeof L.solana.signIn=="function"||"signMessage"in L.solana&&typeof L.solana.signMessage=="function"))j=L.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof k!="object"||!T?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");j=k}const X=new URL((r=T?.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in j&&j.signIn){const L=await j.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},T?.signInWithSolana),{version:"1",domain:X.host,uri:X.href}),R?{statement:R}:null));let A;if(Array.isArray(L)&&L[0]&&typeof L[0]=="object")A=L[0];else if(L&&typeof L=="object"&&"signedMessage"in L&&"signature"in L)A=L;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in A&&"signature"in A&&(typeof A.signedMessage=="string"||A.signedMessage instanceof Uint8Array)&&A.signature instanceof Uint8Array)b=typeof A.signedMessage=="string"?A.signedMessage:new TextDecoder().decode(A.signedMessage),y=A.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in j)||typeof j.signMessage!="function"||!("publicKey"in j)||typeof j!="object"||!j.publicKey||!("toBase58"in j.publicKey)||typeof j.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");b=[`${X.host} wants you to sign in with your Solana account:`,j.publicKey.toBase58(),...R?["",R,""]:[""],"Version: 1",`URI: ${X.href}`,`Issued At: ${(s=(a=T?.signInWithSolana)===null||a===void 0?void 0:a.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((l=T?.signInWithSolana)===null||l===void 0)&&l.notBefore?[`Not Before: ${T.signInWithSolana.notBefore}`]:[],...!((c=T?.signInWithSolana)===null||c===void 0)&&c.expirationTime?[`Expiration Time: ${T.signInWithSolana.expirationTime}`]:[],...!((u=T?.signInWithSolana)===null||u===void 0)&&u.chainId?[`Chain ID: ${T.signInWithSolana.chainId}`]:[],...!((h=T?.signInWithSolana)===null||h===void 0)&&h.nonce?[`Nonce: ${T.signInWithSolana.nonce}`]:[],...!((d=T?.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${T.signInWithSolana.requestId}`]:[],...!((x=(g=T?.signInWithSolana)===null||g===void 0?void 0:g.resources)===null||x===void 0)&&x.length?["Resources",...T.signInWithSolana.resources.map(A=>`- ${A}`)]:[]].join(`
`);const L=await j.signMessage(new TextEncoder().encode(b),"utf8");if(!L||!(L instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");y=L}}try{const{data:S,error:k}=await ct(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:b,signature:Bi(y)},!((v=t.options)===null||v===void 0)&&v.captchaToken?{gotrue_meta_security:{captcha_token:(_=t.options)===null||_===void 0?void 0:_.captchaToken}}:null),xform:bn});if(k)throw k;if(!S||!S.session||!S.user){const R=new zl;return this._returnResult({data:{user:null,session:null},error:R})}return S.session&&(await this._saveSession(S.session),await this._notifyAllSubscribers("SIGNED_IN",S.session)),this._returnResult({data:Object.assign({},S),error:k})}catch(S){if(at(S))return this._returnResult({data:{user:null,session:null},error:S});throw S}}async _exchangeCodeForSession(t){const r=await Ri(this.storage,`${this.storageKey}-code-verifier`),[a,s]=(r??"").split("/");try{if(!a&&this.flowType==="pkce")throw new i4;const{data:l,error:c}=await ct(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:a},xform:bn});if(await ea(this.storage,`${this.storageKey}-code-verifier`),c)throw c;if(!l||!l.session||!l.user){const u=new zl;return this._returnResult({data:{user:null,session:null,redirectType:null},error:u})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:Object.assign(Object.assign({},l),{redirectType:s??null}),error:c})}catch(l){if(await ea(this.storage,`${this.storageKey}-code-verifier`),at(l))return this._returnResult({data:{user:null,session:null,redirectType:null},error:l});throw l}}async signInWithIdToken(t){try{const{options:r,provider:a,token:s,access_token:l,nonce:c}=t,u=await ct(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:a,id_token:s,access_token:l,nonce:c,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:bn}),{data:h,error:d}=u;if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!h||!h.session||!h.user){const g=new zl;return this._returnResult({data:{user:null,session:null},error:g})}return h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",h.session)),this._returnResult({data:h,error:d})}catch(r){if(at(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(t){var r,a,s,l,c;try{if("email"in t){const{email:u,options:h}=t;let d=null,g=null;this.flowType==="pkce"&&([d,g]=await Hl(this.storage,this.storageKey));const{error:x}=await ct(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:u,data:(r=h?.data)!==null&&r!==void 0?r:{},create_user:(a=h?.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:h?.captchaToken},code_challenge:d,code_challenge_method:g},redirectTo:h?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:x})}if("phone"in t){const{phone:u,options:h}=t,{data:d,error:g}=await ct(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:u,data:(s=h?.data)!==null&&s!==void 0?s:{},create_user:(l=h?.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:h?.captchaToken},channel:(c=h?.channel)!==null&&c!==void 0?c:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:d?.message_id},error:g})}throw new hu("You must provide either an email or phone number.")}catch(u){if(await ea(this.storage,`${this.storageKey}-code-verifier`),at(u))return this._returnResult({data:{user:null,session:null},error:u});throw u}}async verifyOtp(t){var r,a;try{let s,l;"options"in t&&(s=(r=t.options)===null||r===void 0?void 0:r.redirectTo,l=(a=t.options)===null||a===void 0?void 0:a.captchaToken);const{data:c,error:u}=await ct(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:l}}),redirectTo:s,xform:bn});if(u)throw u;if(!c)throw new Error("An error occurred on token verification.");const h=c.session,d=c.user;return h?.access_token&&(await this._saveSession(h),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",h)),this._returnResult({data:{user:d,session:h},error:null})}catch(s){if(at(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithSSO(t){var r,a,s,l,c;try{let u=null,h=null;this.flowType==="pkce"&&([u,h]=await Hl(this.storage,this.storageKey));const d=await ct(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&a!==void 0?a:void 0}),!((s=t?.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:u,code_challenge_method:h}),headers:this.headers,xform:R4});return!((l=d.data)===null||l===void 0)&&l.url&&ta()&&!(!((c=t.options)===null||c===void 0)&&c.skipBrowserRedirect)&&window.location.assign(d.data.url),this._returnResult(d)}catch(u){if(await ea(this.storage,`${this.storageKey}-code-verifier`),at(u))return this._returnResult({data:null,error:u});throw u}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:a}=t;if(a)throw a;if(!r)throw new $a;const{error:s}=await ct(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:s})})}catch(t){if(at(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:a,type:s,options:l}=t,{error:c}=await ct(this.fetch,"POST",r,{headers:this.headers,body:{email:a,type:s,gotrue_meta_security:{captcha_token:l?.captchaToken}},redirectTo:l?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:c})}else if("phone"in t){const{phone:a,type:s,options:l}=t,{data:c,error:u}=await ct(this.fetch,"POST",r,{headers:this.headers,body:{phone:a,type:s,gotrue_meta_security:{captcha_token:l?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:c?.message_id},error:u})}throw new hu("You must provide either an email or phone number and a type")}catch(r){if(at(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const a=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await a,await r()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const a=r();for(this.pendingInLock.push((async()=>{try{await a}catch{}})()),await a;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await a}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await Ri(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const a=t.expires_at?t.expires_at*1e3-Date.now()<_d:!1;if(this._debug("#__loadSession()",`session has${a?"":" not"} expired`,"expires_at",t.expires_at),!a){if(this.userStorage){const c=await Ri(this.userStorage,this.storageKey+"-user");c?.user?t.user=c.user:t.user=Sd()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const c={value:this.suppressGetSessionWarning};t.user=A4(t.user,c),c.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:s,error:l}=await this._callRefreshToken(t.refresh_token);return l?this._returnResult({data:{session:null},error:l}):this._returnResult({data:{session:s},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){if(t)return await this._getUser(t);await this.initializePromise;const r=await this._acquireLock(-1,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(t){try{return t?await ct(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Zs}):await this._useSession(async r=>{var a,s,l;const{data:c,error:u}=r;if(u)throw u;return!(!((a=c.session)===null||a===void 0)&&a.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new $a}:await ct(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(l=(s=c.session)===null||s===void 0?void 0:s.access_token)!==null&&l!==void 0?l:void 0,xform:Zs})})}catch(r){if(at(r))return n4(r)&&(await this._removeSession(),await ea(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async a=>{const{data:s,error:l}=a;if(l)throw l;if(!s.session)throw new $a;const c=s.session;let u=null,h=null;this.flowType==="pkce"&&t.email!=null&&([u,h]=await Hl(this.storage,this.storageKey));const{data:d,error:g}=await ct(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:u,code_challenge_method:h}),jwt:c.access_token,xform:Zs});if(g)throw g;return c.user=d.user,await this._saveSession(c),await this._notifyAllSubscribers("USER_UPDATED",c),this._returnResult({data:{user:c.user},error:null})})}catch(a){if(await ea(this.storage,`${this.storageKey}-code-verifier`),at(a))return this._returnResult({data:{user:null},error:a});throw a}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new $a;const r=Date.now()/1e3;let a=r,s=!0,l=null;const{payload:c}=bd(t.access_token);if(c.exp&&(a=c.exp,s=a<=r),s){const{data:u,error:h}=await this._callRefreshToken(t.refresh_token);if(h)return this._returnResult({data:{user:null,session:null},error:h});if(!u)return{data:{user:null,session:null},error:null};l=u}else{const{data:u,error:h}=await this._getUser(t.access_token);if(h)throw h;l={access_token:t.access_token,refresh_token:t.refresh_token,user:u.user,token_type:"bearer",expires_in:a-r,expires_at:a},await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)}return this._returnResult({data:{user:l.user,session:l},error:null})}catch(r){if(at(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var a;if(!t){const{data:c,error:u}=r;if(u)throw u;t=(a=c.session)!==null&&a!==void 0?a:void 0}if(!t?.refresh_token)throw new $a;const{data:s,error:l}=await this._callRefreshToken(t.refresh_token);return l?this._returnResult({data:{user:null,session:null},error:l}):s?this._returnResult({data:{user:s.user,session:s},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(at(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(t,r){try{if(!ta())throw new du("No browser detected.");if(t.error||t.error_description||t.error_code)throw new du(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new uv("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new du("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new uv("No code detected.");const{data:R,error:T}=await this._exchangeCodeForSession(t.code);if(T)throw T;const j=new URL(window.location.href);return j.searchParams.delete("code"),window.history.replaceState(window.history.state,"",j.toString()),{data:{session:R.session,redirectType:null},error:null}}const{provider_token:a,provider_refresh_token:s,access_token:l,refresh_token:c,expires_in:u,expires_at:h,token_type:d}=t;if(!l||!u||!c||!d)throw new du("No session defined in URL");const g=Math.round(Date.now()/1e3),x=parseInt(u);let v=g+x;h&&(v=parseInt(h));const _=v-g;_*1e3<=Yl&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${_}s, should have been closer to ${x}s`);const b=v-x;g-b>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",b,v,g):g-b<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",b,v,g);const{data:y,error:S}=await this._getUser(l);if(S)throw S;const k={provider_token:a,provider_refresh_token:s,access_token:l,expires_in:x,expires_at:v,refresh_token:c,token_type:d,user:y.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:k,redirectType:t.type},error:null})}catch(a){if(at(a))return this._returnResult({data:{session:null,redirectType:null},error:a});throw a}}_isImplicitGrantCallback(t){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),t):!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await Ri(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var a;const{data:s,error:l}=r;if(l)return this._returnResult({error:l});const c=(a=s.session)===null||a===void 0?void 0:a.access_token;if(c){const{error:u}=await this.admin.signOut(c,t);if(u&&!(a4(u)&&(u.status===404||u.status===401||u.status===403)))return this._returnResult({error:u})}return t!=="others"&&(await this._removeSession(),await ea(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const r=d4(),a={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,a),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:a}}}async _emitInitialSession(t){return await this._useSession(async r=>{var a,s;try{const{data:{session:l},error:c}=r;if(c)throw c;await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",l)),this._debug("INITIAL_SESSION","callback id",t,"session",l)}catch(l){await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",l),console.error(l)}})}async resetPasswordForEmail(t,r={}){let a=null,s=null;this.flowType==="pkce"&&([a,s]=await Hl(this.storage,this.storageKey,!0));try{return await ct(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:a,code_challenge_method:s,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(l){if(await ea(this.storage,`${this.storageKey}-code-verifier`),at(l))return this._returnResult({data:null,error:l});throw l}}async getUserIdentities(){var t;try{const{data:r,error:a}=await this.getUser();if(a)throw a;return this._returnResult({data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(r){if(at(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:a,error:s}=await this._useSession(async l=>{var c,u,h,d,g;const{data:x,error:v}=l;if(v)throw v;const _=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(c=t.options)===null||c===void 0?void 0:c.redirectTo,scopes:(u=t.options)===null||u===void 0?void 0:u.scopes,queryParams:(h=t.options)===null||h===void 0?void 0:h.queryParams,skipBrowserRedirect:!0});return await ct(this.fetch,"GET",_,{headers:this.headers,jwt:(g=(d=x.session)===null||d===void 0?void 0:d.access_token)!==null&&g!==void 0?g:void 0})});if(s)throw s;return ta()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(a?.url),this._returnResult({data:{provider:t.provider,url:a?.url},error:null})}catch(a){if(at(a))return this._returnResult({data:{provider:t.provider,url:null},error:a});throw a}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var a;try{const{error:s,data:{session:l}}=r;if(s)throw s;const{options:c,provider:u,token:h,access_token:d,nonce:g}=t,x=await ct(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(a=l?.access_token)!==null&&a!==void 0?a:void 0,body:{provider:u,id_token:h,access_token:d,nonce:g,link_identity:!0,gotrue_meta_security:{captcha_token:c?.captchaToken}},xform:bn}),{data:v,error:_}=x;return _?this._returnResult({data:{user:null,session:null},error:_}):!v||!v.session||!v.user?this._returnResult({data:{user:null,session:null},error:new zl}):(v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers("USER_UPDATED",v.session)),this._returnResult({data:v,error:_}))}catch(s){if(await ea(this.storage,`${this.storageKey}-code-verifier`),at(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var a,s;const{data:l,error:c}=r;if(c)throw c;return await ct(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(s=(a=l.session)===null||a===void 0?void 0:a.access_token)!==null&&s!==void 0?s:void 0})})}catch(r){if(at(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const a=Date.now();return await x4(async s=>(s>0&&await p4(200*Math.pow(2,s-1)),this._debug(r,"refreshing attempt",s),await ct(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:bn})),(s,l)=>{const c=200*Math.pow(2,s);return l&&wd(l)&&Date.now()+c-a<Yl})}catch(a){if(this._debug(r,"error",a),at(a))return this._returnResult({data:{session:null,user:null},error:a});throw a}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const a=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",a),ta()&&!r.skipBrowserRedirect&&window.location.assign(a),{data:{provider:t,url:a},error:null}}async _recoverAndRefresh(){var t,r;const a="#_recoverAndRefresh()";this._debug(a,"begin");try{const s=await Ri(this.storage,this.storageKey);if(s&&this.userStorage){let c=await Ri(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!c&&(c={user:s.user},await Jl(this.userStorage,this.storageKey+"-user",c)),s.user=(t=c?.user)!==null&&t!==void 0?t:Sd()}else if(s&&!s.user&&!s.user){const c=await Ri(this.storage,this.storageKey+"-user");c&&c?.user?(s.user=c.user,await ea(this.storage,this.storageKey+"-user"),await Jl(this.storage,this.storageKey,s)):s.user=Sd()}if(this._debug(a,"session from storage",s),!this._isValidSession(s)){this._debug(a,"session is not valid"),s!==null&&await this._removeSession();return}const l=((r=s.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<_d;if(this._debug(a,`session has${l?"":" not"} expired with margin of ${_d}s`),l){if(this.autoRefreshToken&&s.refresh_token){const{error:c}=await this._callRefreshToken(s.refresh_token);c&&(console.error(c),wd(c)||(this._debug(a,"refresh failed with a non-retryable error, removing the session",c),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:c,error:u}=await this._getUser(s.access_token);!u&&c?.user?(s.user=c.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(a,"could not get user data, skipping SIGNED_IN notification")}catch(c){console.error("Error getting user data:",c),this._debug(a,"error getting user data, skipping SIGNED_IN notification",c)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(a,"error",s),console.error(s);return}finally{this._debug(a,"end")}}async _callRefreshToken(t){var r,a;if(!t)throw new $a;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new Wu;const{data:l,error:c}=await this._refreshAccessToken(t);if(c)throw c;if(!l.session)throw new $a;await this._saveSession(l.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",l.session);const u={data:l.session,error:null};return this.refreshingDeferred.resolve(u),u}catch(l){if(this._debug(s,"error",l),at(l)){const c={data:null,error:l};return wd(l)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(c),c}throw(a=this.refreshingDeferred)===null||a===void 0||a.reject(l),l}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(t,r,a=!0){const s=`#_notifyAllSubscribers(${t})`;this._debug(s,"begin",r,`broadcast = ${a}`);try{this.broadcastChannel&&a&&this.broadcastChannel.postMessage({event:t,session:r});const l=[],c=Array.from(this.stateChangeEmitters.values()).map(async u=>{try{await u.callback(t,r)}catch(h){l.push(h)}});if(await Promise.all(c),l.length>0){for(let u=0;u<l.length;u+=1)console.error(l[u]);throw l[0]}}finally{this._debug(s,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await ea(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},t),a=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!a&&r.user&&await Jl(this.userStorage,this.storageKey+"-user",{user:r.user});const s=Object.assign({},r);delete s.user;const l=gv(s);await Jl(this.storage,this.storageKey,l)}else{const s=gv(r);await Jl(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await ea(this.storage,this.storageKey),await ea(this.storage,this.storageKey+"-code-verifier"),await ea(this.storage,this.storageKey+"-user"),this.userStorage&&await ea(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&ta()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Yl);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:a}}=r;if(!a||!a.refresh_token||!a.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((a.expires_at*1e3-t)/Yl);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${Yl}ms, refresh threshold is ${Xd} ticks`),s<=Xd&&await this._callRefreshToken(a.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof a_)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!ta()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,a){const s=[`provider=${encodeURIComponent(r)}`];if(a?.redirectTo&&s.push(`redirect_to=${encodeURIComponent(a.redirectTo)}`),a?.scopes&&s.push(`scopes=${encodeURIComponent(a.scopes)}`),this.flowType==="pkce"){const[l,c]=await Hl(this.storage,this.storageKey),u=new URLSearchParams({code_challenge:`${encodeURIComponent(l)}`,code_challenge_method:`${encodeURIComponent(c)}`});s.push(u.toString())}if(a?.queryParams){const l=new URLSearchParams(a.queryParams);s.push(l.toString())}return a?.skipBrowserRedirect&&s.push(`skip_http_redirect=${a.skipBrowserRedirect}`),`${t}?${s.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var a;const{data:s,error:l}=r;return l?this._returnResult({data:null,error:l}):await ct(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(a=s?.session)===null||a===void 0?void 0:a.access_token})})}catch(r){if(at(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(t){try{return await this._useSession(async r=>{var a,s;const{data:l,error:c}=r;if(c)return this._returnResult({data:null,error:c});const u=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:h,error:d}=await ct(this.fetch,"POST",`${this.url}/factors`,{body:u,headers:this.headers,jwt:(a=l?.session)===null||a===void 0?void 0:a.access_token});return d?this._returnResult({data:null,error:d}):(t.factorType==="totp"&&h.type==="totp"&&(!((s=h?.totp)===null||s===void 0)&&s.qr_code)&&(h.totp.qr_code=`data:image/svg+xml;utf-8,${h.totp.qr_code}`),this._returnResult({data:h,error:null}))})}catch(r){if(at(r))return this._returnResult({data:null,error:r});throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var a;const{data:s,error:l}=r;if(l)return this._returnResult({data:null,error:l});const c=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?X4(t.webauthn.credential_response):W4(t.webauthn.credential_response)})}:{code:t.code}),{data:u,error:h}=await ct(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:c,headers:this.headers,jwt:(a=s?.session)===null||a===void 0?void 0:a.access_token});return h?this._returnResult({data:null,error:h}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+u.expires_in},u)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",u),this._returnResult({data:u,error:h}))})}catch(r){if(at(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var a;const{data:s,error:l}=r;if(l)return this._returnResult({data:null,error:l});const c=await ct(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(a=s?.session)===null||a===void 0?void 0:a.access_token});if(c.error)return c;const{data:u}=c;if(u.type!=="webauthn")return{data:u,error:null};switch(u.webauthn.type){case"create":return{data:Object.assign(Object.assign({},u),{webauthn:Object.assign(Object.assign({},u.webauthn),{credential_options:Object.assign(Object.assign({},u.webauthn.credential_options),{publicKey:G4(u.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},u),{webauthn:Object.assign(Object.assign({},u.webauthn),{credential_options:Object.assign(Object.assign({},u.webauthn.credential_options),{publicKey:q4(u.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(at(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(t){const{data:r,error:a}=await this._challenge({factorId:t.factorId});return a?this._returnResult({data:null,error:a}):await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:a}=await this.getUser();if(a)return{data:null,error:a};const s={all:[],phone:[],totp:[],webauthn:[]};for(const l of(t=r?.factors)!==null&&t!==void 0?t:[])s.all.push(l),l.status==="verified"&&s[l.factor_type].push(l);return{data:s,error:null}}async _getAuthenticatorAssuranceLevel(){var t,r;const{data:{session:a},error:s}=await this.getSession();if(s)return this._returnResult({data:null,error:s});if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:l}=bd(a.access_token);let c=null;l.aal&&(c=l.aal);let u=c;((r=(t=a.user.factors)===null||t===void 0?void 0:t.filter(g=>g.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(u="aal2");const d=l.amr||[];return{data:{currentLevel:c,nextLevel:u,currentAuthenticationMethods:d},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async r=>{const{data:{session:a},error:s}=r;return s?this._returnResult({data:null,error:s}):a?await ct(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:a.access_token,xform:l=>({data:l,error:null})}):this._returnResult({data:null,error:new $a})})}catch(r){if(at(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(t,r){try{return await this._useSession(async a=>{const{data:{session:s},error:l}=a;if(l)return this._returnResult({data:null,error:l});if(!s)return this._returnResult({data:null,error:new $a});const c=await ct(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"approve"},xform:u=>({data:u,error:null})});return c.data&&c.data.redirect_url&&ta()&&!r?.skipBrowserRedirect&&window.location.assign(c.data.redirect_url),c})}catch(a){if(at(a))return this._returnResult({data:null,error:a});throw a}}async _denyAuthorization(t,r){try{return await this._useSession(async a=>{const{data:{session:s},error:l}=a;if(l)return this._returnResult({data:null,error:l});if(!s)return this._returnResult({data:null,error:new $a});const c=await ct(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"deny"},xform:u=>({data:u,error:null})});return c.data&&c.data.redirect_url&&ta()&&!r?.skipBrowserRedirect&&window.location.assign(c.data.redirect_url),c})}catch(a){if(at(a))return this._returnResult({data:null,error:a});throw a}}async _listOAuthGrants(){try{return await this._useSession(async t=>{const{data:{session:r},error:a}=t;return a?this._returnResult({data:null,error:a}):r?await ct(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:s=>({data:s,error:null})}):this._returnResult({data:null,error:new $a})})}catch(t){if(at(t))return this._returnResult({data:null,error:t});throw t}}async _revokeOAuthGrant(t){try{return await this._useSession(async r=>{const{data:{session:a},error:s}=r;return s?this._returnResult({data:null,error:s}):a?(await ct(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:a.access_token,query:{client_id:t.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new $a})})}catch(r){if(at(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(t,r={keys:[]}){let a=r.keys.find(u=>u.kid===t);if(a)return a;const s=Date.now();if(a=this.jwks.keys.find(u=>u.kid===t),a&&this.jwks_cached_at+t4>s)return a;const{data:l,error:c}=await ct(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(c)throw c;return!l.keys||l.keys.length===0||(this.jwks=l,this.jwks_cached_at=s,a=l.keys.find(u=>u.kid===t),!a)?null:a}async getClaims(t,r={}){try{let a=t;if(!a){const{data:_,error:b}=await this.getSession();if(b||!_.session)return this._returnResult({data:null,error:b});a=_.session.access_token}const{header:s,payload:l,signature:c,raw:{header:u,payload:h}}=bd(a);r?.allowExpired||E4(l.exp);const d=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,r?.keys?{keys:r.keys}:r?.jwks);if(!d){const{error:_}=await this.getUser(a);if(_)throw _;return{data:{claims:l,header:s,signature:c},error:null}}const g=T4(s.alg),x=await crypto.subtle.importKey("jwk",d,g,!0,["verify"]);if(!await crypto.subtle.verify(g,x,c,f4(`${u}.${h}`)))throw new Yd("Invalid JWT signature");return{data:{claims:l,header:s,signature:c},error:null}}catch(a){if(at(a))return this._returnResult({data:null,error:a});throw a}}}Cc.nextInstanceID={};const ak=Cc,nk="2.89.0";let uc="";typeof Deno<"u"?uc="deno":typeof document<"u"?uc="web":typeof navigator<"u"&&navigator.product==="ReactNative"?uc="react-native":uc="node";const sk={"X-Client-Info":`supabase-js-${uc}/${nk}`},ik={headers:sk},lk={schema:"public"},ok={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},ck={};function Nc(e){"@babel/helpers - typeof";return Nc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nc(e)}function uk(e,t){if(Nc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Nc(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fk(e){var t=uk(e,"string");return Nc(t)=="symbol"?t:t+""}function hk(e,t,r){return(t=fk(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bv(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function vr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?bv(Object(r),!0).forEach(function(a){hk(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):bv(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}const dk=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),mk=()=>Headers,gk=(e,t,r)=>{const a=dk(r),s=mk();return async(l,c)=>{var u;const h=(u=await t())!==null&&u!==void 0?u:e;let d=new s(c?.headers);return d.has("apikey")||d.set("apikey",e),d.has("Authorization")||d.set("Authorization",`Bearer ${h}`),a(l,vr(vr({},c),{},{headers:d}))}};function pk(e){return e.endsWith("/")?e:e+"/"}function xk(e,t){var r,a;const{db:s,auth:l,realtime:c,global:u}=e,{db:h,auth:d,realtime:g,global:x}=t,v={db:vr(vr({},h),s),auth:vr(vr({},d),l),realtime:vr(vr({},g),c),storage:{},global:vr(vr(vr({},x),u),{},{headers:vr(vr({},(r=x?.headers)!==null&&r!==void 0?r:{}),(a=u?.headers)!==null&&a!==void 0?a:{})}),accessToken:async()=>""};return e.accessToken?v.accessToken=e.accessToken:delete v.accessToken,v}function vk(e){const t=e?.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(pk(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var yk=class extends ak{constructor(e){super(e)}},_k=class{constructor(e,t,r){var a,s;this.supabaseUrl=e,this.supabaseKey=t;const l=vk(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,u={db:lk,realtime:ck,auth:vr(vr({},ok),{},{storageKey:c}),global:ik},h=xk(r??{},u);if(this.storageKey=(a=h.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(s=h.global.headers)!==null&&s!==void 0?s:{},h.accessToken)this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(g,x)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(x)} is not possible`)}});else{var d;this.auth=this._initSupabaseAuthClient((d=h.auth)!==null&&d!==void 0?d:{},this.headers,h.global.fetch)}this.fetch=gk(t,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(vr({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.accessToken&&this.accessToken().then(g=>this.realtime.setAuth(g)).catch(g=>console.warn("Failed to set initial Realtime auth token:",g)),this.rest=new ZE(new URL("rest/v1",l).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),this.storage=new YT(this.storageUrl.href,this.headers,this.fetch,r?.storage),h.accessToken||this._listenForAuthEvents()}get functions(){return new WE(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e=this,t,r;if(e.accessToken)return await e.accessToken();const{data:a}=await e.auth.getSession();return(t=(r=a.session)===null||r===void 0?void 0:r.access_token)!==null&&t!==void 0?t:e.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:a,userStorage:s,storageKey:l,flowType:c,lock:u,debug:h,throwOnError:d},g,x){const v={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new yk({url:this.authUrl.href,headers:vr(vr({},v),g),storageKey:l,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:a,userStorage:s,flowType:c,lock:u,debug:h,throwOnError:d,fetch:x,hasCustomAuthorizationHeader:Object.keys(this.headers).some(_=>_.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new pT(this.realtimeUrl.href,vr(vr({},e),{},{params:vr(vr({},{apikey:this.supabaseKey}),e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",t?.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const wk=(e,t,r)=>new _k(e,t,r);function bk(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}bk()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Ru="",Sk="",Qs=!!Ru,mu=(()=>{try{return Ru&&new URL(Ru).hostname.split(".")[0]||null}catch{return null}})(),gu="supabase",Sv=Qs?wk(Ru,Sk,{auth:{persistSession:!0,autoRefreshToken:!0}}):null,Dr={medications:"bodegapp:medications",monthlyBatches:"bodegapp:monthlyBatches",selectedMonthlyBatchId:"bodegapp:selectedMonthlyBatchId",tertiaryPackaging:"bodegapp:tertiaryPackaging",medicationCategories:"bodegapp:medicationCategories",orderCalendar:"bodegapp:orderCalendar"},Ek=[{id:1,inventory_type:"772",name:"Paracetamol",siges_code:"SIG-0001",sicop_classifier:"SICOP-CL-01",sicop_identifier:"SICOP-ID-0001",category:"Analgsico",batch:"LOT-2023-01",expiry_date:"2025-12-30",stock:500,min_stock:100,unit:"Tabletas"},{id:2,inventory_type:"772",name:"Amoxicilina",siges_code:"SIG-0002",sicop_classifier:"SICOP-CL-02",sicop_identifier:"SICOP-ID-0002",category:"Antibiotico",batch:"LOT-2023-05",expiry_date:"2024-06-15",stock:45,min_stock:50,unit:"Cpsulas"},{id:3,inventory_type:"772",name:"Ibuprofeno",siges_code:"SIG-0003",sicop_classifier:"SICOP-CL-03",sicop_identifier:"SICOP-ID-0003",category:"Antiinflamatorio",batch:"LOT-2023-09",expiry_date:"2026-01-20",stock:120,min_stock:40,unit:"Jarabe"},{id:4,inventory_type:"772",name:"Omeprazol",siges_code:"SIG-0004",sicop_classifier:"SICOP-CL-04",sicop_identifier:"SICOP-ID-0004",category:"Protector Gstrico",batch:"LOT-2023-12",expiry_date:"2025-03-10",stock:15,min_stock:30,unit:"Cpsulas"}];function i_(e){try{return JSON.parse(e)}catch{return null}}function oc(e){const t=window.localStorage.getItem(e);if(!t)return null;const r=i_(t);return Array.isArray(r)?r:null}function Oa(e,t){window.localStorage.setItem(e,JSON.stringify(t))}const Tk={async getMedications(){return oc(Dr.medications)??Ek},async clearMedicationsByInventoryType(e){const t=String(e||"772"),a=(await this.getMedications()??[]).filter(s=>String(s.inventory_type||"772")!==t);return Oa(Dr.medications,a),a},async upsertMedication(e){const t=await this.getMedications()??[],r=e?.id,a=r==null?[...t,e]:t.some(s=>s.id===r)?t.map(s=>s.id===r?e:s):[...t,e];return Oa(Dr.medications,a),e},async upsertMedications(e){const t=await this.getMedications()??[],r=new Map(t.map(s=>[s.id,s]));for(const s of e)r.set(s.id,s);const a=Array.from(r.values());return Oa(Dr.medications,a),a},async deleteMedication(e){const r=(await this.getMedications()??[]).filter(a=>a.id!==e);Oa(Dr.medications,r)},async clearMedications(){Oa(Dr.medications,[])},async getMonthlyBatches(){return(oc(Dr.monthlyBatches)??[]).map(t=>({...t,id:t?.id!=null?String(t.id):t.id}))},async saveMonthlyBatch(e){const t=await this.getMonthlyBatches()??[],r={...e,id:e?.id!=null?String(e.id):e.id},a=[r,...t.filter(s=>String(s.id)!==String(r.id))];return Oa(Dr.monthlyBatches,a),r},async getSelectedMonthlyBatchId(){const e=window.localStorage.getItem(Dr.selectedMonthlyBatchId),t=e?i_(e)??e:null;return t==null?null:String(t)},async setSelectedMonthlyBatchId(e){Oa(Dr.selectedMonthlyBatchId,e)},async getTertiaryPackaging(){return oc(Dr.tertiaryPackaging)??[]},async upsertTertiaryPackaging(e){const t=await this.getTertiaryPackaging()??[],r=new Map(t.map(s=>[String(s.siges_code||"").trim(),s]));for(const s of e??[]){const l=String(s?.siges_code||"").trim();l&&r.set(l,{...s,siges_code:l})}const a=Array.from(r.values());return Oa(Dr.tertiaryPackaging,a),a},async clearTertiaryPackaging(){Oa(Dr.tertiaryPackaging,[])},async getMedicationCategories(){return oc(Dr.medicationCategories)??[]},async upsertMedicationCategories(e){const t=await this.getMedicationCategories()??[],r=new Map(t.map(s=>[String(s.siges_code||"").trim(),s]));for(const s of e??[]){const l=String(s?.siges_code||"").trim();l&&r.set(l,{...s,siges_code:l})}const a=Array.from(r.values());return Oa(Dr.medicationCategories,a),a},async clearMedicationCategories(){Oa(Dr.medicationCategories,[])},async deleteMedicationCategory(e){const r=(await this.getMedicationCategories()??[]).filter(a=>String(a.id)!==String(e));Oa(Dr.medicationCategories,r)},async getOrderCalendar(){return oc(Dr.orderCalendar)??[]},async upsertOrderCalendarEntries(e){const t=await this.getOrderCalendar()??[],r=new Map(t.map(s=>[`${Number(s.year)||0}-${Number(s.month)||0}`,s]));for(const s of e??[]){const l=Number(s?.year)||0,c=Number(s?.month)||0;if(!l||c<1||c>12)continue;const u=`${l}-${c}`;r.set(u,{...s,year:l,month:c,scheduled_receipt_date:s?.scheduled_receipt_date?String(s.scheduled_receipt_date):null})}const a=Array.from(r.values());return Oa(Dr.orderCalendar,a),a},async clearOrderCalendar(){Oa(Dr.orderCalendar,[])}};function Gr(){if(!Sv)throw new Error("Supabase no est configurado (faltan VITE_SUPABASE_URL / VITE_SUPABASE_ANON_KEY).");return Sv}function Ev(e){return e?.id?e:globalThis.crypto?.randomUUID?{...e,id:globalThis.crypto.randomUUID()}:{...e,id:String(Date.now())}}const kk={async getMedications(){const e=Gr(),t=1e3;let r=0;const a=[];for(;;){const{data:s,error:l}=await e.from("medications").select("*").order("created_at",{ascending:!0}).range(r,r+t-1);if(l)throw l;const c=s??[];if(a.push(...c),c.length<t)break;r+=t}return a},async clearMedicationsByInventoryType(e){const t=Gr(),r=String(e||"772"),{error:a}=await t.from("medications").delete().eq("inventory_type",r);if(a)throw a},async upsertMedication(e){const t=Gr(),r=Ev(e),{data:a,error:s}=await t.from("medications").upsert(r,{onConflict:"id"}).select("*").single();if(s)throw s;return a},async upsertMedications(e){const t=Gr(),r=(e??[]).map(Ev),{data:a,error:s}=await t.from("medications").upsert(r,{onConflict:"id"}).select("*");if(s)throw s;return a??[]},async deleteMedication(e){const t=Gr(),{error:r}=await t.from("medications").delete().eq("id",e);if(r)throw r},async clearMedications(){const e=Gr(),{error:t}=await e.from("medications").delete().neq("id","00000000-0000-0000-0000-000000000000");if(t)throw t},async getMonthlyBatches(){const e=Gr(),{data:t,error:r}=await e.from("monthly_batches").select("id,label,items:monthly_batch_items(id,siges_code,medication_name,quantity,cost)").order("created_at",{ascending:!1});if(r)throw r;return(t??[]).map(a=>({...a,items:a.items??[]}))},async saveMonthlyBatch({id:e,label:t,items:r}){const a=Gr(),{data:s,error:l}=await a.from("monthly_batches").upsert({id:e,label:t},{onConflict:"label"}).select("id,label").single();if(l)throw l;const{error:c}=await a.from("monthly_batch_items").delete().eq("batch_id",s.id);if(c)throw c;const u=(r??[]).map(h=>({id:globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():String(Date.now())+Math.random(),batch_id:s.id,siges_code:h.siges_code,medication_name:h.medication_name,quantity:h.quantity,cost:h.cost}));if(u.length>0){const{error:h}=await a.from("monthly_batch_items").insert(u);if(h)throw h}return{...s,items:r}},async getSelectedMonthlyBatchId(){return null},async setSelectedMonthlyBatchId(){},async getTertiaryPackaging(){const e=Gr(),{data:t,error:r}=await e.from("tertiary_packaging").select("*").order("siges_code",{ascending:!0});if(r)throw r;return t??[]},async upsertTertiaryPackaging(e){const t=Gr(),a=(e??[]).map(c=>({id:c?.id||(globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():String(Date.now())+Math.random()),siges_code:String(c?.siges_code||"").trim(),medication_name:String(c?.medication_name||"").trim(),tertiary_quantity:Number(c?.tertiary_quantity)||0})).filter(c=>!!c.siges_code);if(a.length===0)return[];const{data:s,error:l}=await t.from("tertiary_packaging").upsert(a,{onConflict:"siges_code"}).select("*");if(l)throw l;return s??[]},async clearTertiaryPackaging(){const e=Gr(),{error:t}=await e.from("tertiary_packaging").delete().neq("id","00000000-0000-0000-0000-000000000000");if(t)throw t},async getMedicationCategories(){const e=Gr(),{data:t,error:r}=await e.from("medication_categories").select("*").order("siges_code",{ascending:!0});if(r)throw r;return t??[]},async upsertMedicationCategories(e){const t=Gr(),a=(e??[]).map(c=>({id:c?.id||(globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():String(Date.now())+Math.random()),siges_code:String(c?.siges_code||"").trim(),medication_name:String(c?.medication_name||"").trim(),category:String(c?.category||"").trim()})).filter(c=>!!(c.siges_code&&c.category));if(a.length===0)return[];const{data:s,error:l}=await t.from("medication_categories").upsert(a,{onConflict:"siges_code"}).select("*");if(l)throw l;return s??[]},async clearMedicationCategories(){const e=Gr(),{error:t}=await e.from("medication_categories").delete().neq("id","00000000-0000-0000-0000-000000000000");if(t)throw t},async deleteMedicationCategory(e){const t=Gr(),{error:r}=await t.from("medication_categories").delete().eq("id",e);if(r)throw r},async getOrderCalendar(){const e=Gr(),{data:t,error:r}=await e.from("order_calendar").select("*").order("year",{ascending:!0}).order("month",{ascending:!0});if(r)throw r;return t??[]},async upsertOrderCalendarEntries(e){const t=Gr(),a=(e??[]).map(c=>({id:c?.id||(globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():String(Date.now())+Math.random()),year:Number(c?.year)||0,month:Number(c?.month)||0,scheduled_receipt_date:c?.scheduled_receipt_date?String(c.scheduled_receipt_date):null})).filter(c=>c.year&&c.month>=1&&c.month<=12);if(a.length===0)return[];const{data:s,error:l}=await t.from("order_calendar").upsert(a,{onConflict:"year,month"}).select("*");if(l)throw l;return s??[]},async clearOrderCalendar(){const e=Gr(),{error:t}=await e.from("order_calendar").delete().neq("id","00000000-0000-0000-0000-000000000000");if(t)throw t}},At=Qs?kk:Tk;var Du={};Du.version="0.18.5";var l_=1252,Ak=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],xm={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},vm=function(e){Ak.indexOf(e)!=-1&&(l_=xm[0]=e)};function Ck(){vm(1252)}var Tn=function(e){vm(e)};function ym(){Tn(1200),Ck()}function Tv(e){for(var t=[],r=0,a=e.length;r<a;++r)t[r]=e.charCodeAt(r);return t}function Nk(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function o_(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var fc=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?Nk(e.slice(2)):t==254&&r==255?o_(e.slice(2)):t==65279?e.slice(1):e},pu=function(t){return String.fromCharCode(t)},kv=function(t){return String.fromCharCode(t)},Oc,ei="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Rc(e){for(var t="",r=0,a=0,s=0,l=0,c=0,u=0,h=0,d=0;d<e.length;)r=e.charCodeAt(d++),l=r>>2,a=e.charCodeAt(d++),c=(r&3)<<4|a>>4,s=e.charCodeAt(d++),u=(a&15)<<2|s>>6,h=s&63,isNaN(a)?u=h=64:isNaN(s)&&(h=64),t+=ei.charAt(l)+ei.charAt(c)+ei.charAt(u)+ei.charAt(h);return t}function Ya(e){var t="",r=0,a=0,s=0,l=0,c=0,u=0,h=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<e.length;)l=ei.indexOf(e.charAt(d++)),c=ei.indexOf(e.charAt(d++)),r=l<<2|c>>4,t+=String.fromCharCode(r),u=ei.indexOf(e.charAt(d++)),a=(c&15)<<4|u>>2,u!==64&&(t+=String.fromCharCode(a)),h=ei.indexOf(e.charAt(d++)),s=(u&3)<<6|h,h!==64&&(t+=String.fromCharCode(s));return t}var wt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),xs=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function ri(e){return wt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Av(e){return wt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Wa=function(t){return wt?xs(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Ku(e){if(typeof ArrayBuffer>"u")return Wa(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),a=0;a!=e.length;++a)r[a]=e.charCodeAt(a)&255;return t}function li(e){if(Array.isArray(e))return e.map(function(a){return String.fromCharCode(a)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function Ok(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function _m(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return _m(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Xr=wt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:xs(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var a=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)a.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";a.set(new Uint8Array(e[t]),r)}return a}return[].concat.apply([],e.map(function(l){return Array.isArray(l)?l:[].slice.call(l)}))};function Rk(e){for(var t=[],r=0,a=e.length+250,s=ri(e.length+255),l=0;l<e.length;++l){var c=e.charCodeAt(l);if(c<128)s[r++]=c;else if(c<2048)s[r++]=192|c>>6&31,s[r++]=128|c&63;else if(c>=55296&&c<57344){c=(c&1023)+64;var u=e.charCodeAt(++l)&1023;s[r++]=240|c>>8&7,s[r++]=128|c>>2&63,s[r++]=128|u>>6&15|(c&3)<<4,s[r++]=128|u&63}else s[r++]=224|c>>12&15,s[r++]=128|c>>6&63,s[r++]=128|c&63;r>a&&(t.push(s.slice(0,r)),r=0,s=ri(65535),a=65530)}return t.push(s.slice(0,r)),Xr(t)}var wa=/\u0000/g,hc=/[\u0001-\u0006]/g;function ro(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function kn(e,t){var r=""+e;return r.length>=t?r:yr("0",t-r.length)+r}function wm(e,t){var r=""+e;return r.length>=t?r:yr(" ",t-r.length)+r}function Fu(e,t){var r=""+e;return r.length>=t?r:r+yr(" ",t-r.length)}function Dk(e,t){var r=""+Math.round(e);return r.length>=t?r:yr("0",t-r.length)+r}function Fk(e,t){var r=""+e;return r.length>=t?r:yr("0",t-r.length)+r}var Cv=Math.pow(2,32);function ql(e,t){if(e>Cv||e<-Cv)return Dk(e,t);var r=Math.round(e);return Fk(r,t)}function Mu(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Nv=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Td=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Mk(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var ft={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Ov={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Lk={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Lu(e,t,r){for(var a=e<0?-1:1,s=e*a,l=0,c=1,u=0,h=1,d=0,g=0,x=Math.floor(s);d<t&&(x=Math.floor(s),u=x*c+l,g=x*d+h,!(s-x<5e-8));)s=1/(s-x),l=c,c=u,h=d,d=g;if(g>t&&(d>t?(g=h,u=l):(g=d,u=c)),!r)return[0,a*u,g];var v=Math.floor(a*u/g);return[v,a*u-v*g,g]}function Ii(e,t,r){if(e>2958465||e<0)return null;var a=e|0,s=Math.floor(86400*(e-a)),l=0,c=[],u={D:a,T:s,u:86400*(e-a)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),t&&t.date1904&&(a+=1462),u.u>.9999&&(u.u=0,++s==86400&&(u.T=s=0,++a,++u.D)),a===60)c=r?[1317,10,29]:[1900,2,29],l=3;else if(a===0)c=r?[1317,8,29]:[1900,1,0],l=6;else{a>60&&--a;var h=new Date(1900,0,1);h.setDate(h.getDate()+a-1),c=[h.getFullYear(),h.getMonth()+1,h.getDate()],l=h.getDay(),a<60&&(l=(l+6)%7),r&&(l=zk(h,c))}return u.y=c[0],u.m=c[1],u.d=c[2],u.S=s%60,s=Math.floor(s/60),u.M=s%60,s=Math.floor(s/60),u.H=s,u.q=l,u}var c_=new Date(1899,11,31,0,0,0),Bk=c_.getTime(),Ik=new Date(1900,2,1,0,0,0);function u_(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=Ik&&(r+=1440*60*1e3),(r-(Bk+(e.getTimezoneOffset()-c_.getTimezoneOffset())*6e4))/(1440*60*1e3)}function bm(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function jk(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Uk(e){var t=e<0?12:11,r=bm(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function Pk(e){var t=bm(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Dc(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=Uk(e):t===10?r=e.toFixed(10).substr(0,12):r=Pk(e),bm(jk(r.toUpperCase()))}function Hi(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Dc(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return gn(14,u_(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function zk(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function Hk(e,t,r,a){var s="",l=0,c=0,u=r.y,h,d=0;switch(e){case 98:u=r.y+543;case 121:switch(t.length){case 1:case 2:h=u%100,d=2;break;default:h=u%1e4,d=4;break}break;case 109:switch(t.length){case 1:case 2:h=r.m,d=t.length;break;case 3:return Td[r.m-1][1];case 5:return Td[r.m-1][0];default:return Td[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:h=r.d,d=t.length;break;case 3:return Nv[r.q][0];default:return Nv[r.q][1]}break;case 104:switch(t.length){case 1:case 2:h=1+(r.H+11)%12,d=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:h=r.H,d=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:h=r.M,d=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?kn(r.S,t.length):(a>=2?c=a===3?1e3:100:c=a===1?10:1,l=Math.round(c*(r.S+r.u)),l>=60*c&&(l=0),t==="s"?l===0?"0":""+l/c:(s=kn(l,2+a),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":h=r.D*24+r.H;break;case"[m]":case"[mm]":h=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":h=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}d=t.length===3?1:2;break;case 101:h=u,d=1;break}var g=d>0?kn(h,d):"";return g}function ti(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,a=e.substr(0,r);r!=e.length;r+=t)a+=(a.length>0?",":"")+e.substr(r,t);return a}var f_=/%/g;function $k(e,t,r){var a=t.replace(f_,""),s=t.length-a.length;return hs(e,a,r*Math.pow(10,2*s))+yr("%",s)}function Vk(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return hs(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function h_(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+h_(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var l=Math.floor(Math.log(t)*Math.LOG10E)%s;if(l<0&&(l+=s),r=(t/Math.pow(10,l)).toPrecision(a+1+(s+l)%s),r.indexOf("e")===-1){var c=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(c-r.length+l):r+="E+"+(c-l);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,h,d,g){return h+d+g.substr(0,(s+l)%s)+"."+g.substr(l)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var d_=/# (\?+)( ?)\/( ?)(\d+)/;function Gk(e,t,r){var a=parseInt(e[4],10),s=Math.round(t*a),l=Math.floor(s/a),c=s-l*a,u=a;return r+(l===0?"":""+l)+" "+(c===0?yr(" ",e[1].length+1+e[4].length):wm(c,e[1].length)+e[2]+"/"+e[3]+kn(u,e[4].length))}function qk(e,t,r){return r+(t===0?"":""+t)+yr(" ",e[1].length+2+e[4].length)}var m_=/^#*0*\.([0#]+)/,g_=/\).*[0#]/,p_=/\(###\) ###\\?-####/;function ya(e){for(var t="",r,a=0;a!=e.length;++a)switch(r=e.charCodeAt(a)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function Rv(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Dv(e,t){var r=e-Math.floor(e),a=Math.pow(10,t);return t<(""+Math.round(r*a)).length?0:Math.round(r*a)}function Xk(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function Wk(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function cn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(g_)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?cn("n",a,r):"("+cn("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Vk(e,t,r);if(t.indexOf("%")!==-1)return $k(e,t,r);if(t.indexOf("E")!==-1)return h_(t,r);if(t.charCodeAt(0)===36)return"$"+cn(e,t.substr(t.charAt(1)==" "?2:1),r);var s,l,c,u,h=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+ql(h,t.length);if(t.match(/^[#?]+$/))return s=ql(r,0),s==="0"&&(s=""),s.length>t.length?s:ya(t.substr(0,t.length-s.length))+s;if(l=t.match(d_))return Gk(l,h,d);if(t.match(/^#+0+$/))return d+ql(h,t.length-t.indexOf("0"));if(l=t.match(m_))return s=Rv(r,l[1].length).replace(/^([^\.]+)$/,"$1."+ya(l[1])).replace(/\.$/,"."+ya(l[1])).replace(/\.(\d*)$/,function(b,y){return"."+y+yr("0",ya(l[1]).length-y.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),l=t.match(/^(0*)\.(#*)$/))return d+Rv(h,l[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=t.match(/^#{1,3},##0(\.?)$/))return d+ti(ql(h,0));if(l=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+cn(e,t,-r):ti(""+(Math.floor(r)+Xk(r,l[1].length)))+"."+kn(Dv(r,l[1].length),l[1].length);if(l=t.match(/^#,#*,#0/))return cn(e,t.replace(/^#,#*,/,""),r);if(l=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=ro(cn(e,t.replace(/[\\-]/g,""),r)),c=0,ro(ro(t.replace(/\\/g,"")).replace(/[0#]/g,function(b){return c<s.length?s.charAt(c++):b==="0"?"0":""}));if(t.match(p_))return s=cn(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var g="";if(l=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(l[4].length,7),u=Lu(h,Math.pow(10,c)-1,!1),s=""+d,g=hs("n",l[1],u[1]),g.charAt(g.length-1)==" "&&(g=g.substr(0,g.length-1)+"0"),s+=g+l[2]+"/"+l[3],g=Fu(u[2],c),g.length<l[4].length&&(g=ya(l[4].substr(l[4].length-g.length))+g),s+=g,s;if(l=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(l[1].length,l[4].length),7),u=Lu(h,Math.pow(10,c)-1,!0),d+(u[0]||(u[1]?"":"0"))+" "+(u[1]?wm(u[1],c)+l[2]+"/"+l[3]+Fu(u[2],c):yr(" ",2*c+1+l[2].length+l[3].length));if(l=t.match(/^[#0?]+$/))return s=ql(r,0),t.length<=s.length?s:ya(t.substr(0,t.length-s.length))+s;if(l=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),c=s.indexOf(".");var x=t.indexOf(".")-c,v=t.length-s.length-x;return ya(t.substr(0,x)+s+t.substr(t.length-v))}if(l=t.match(/^00,000\.([#0]*0)$/))return c=Dv(r,l[1].length),r<0?"-"+cn(e,t,-r):ti(Wk(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?kn(0,3-b.length):"")+b})+"."+kn(c,l[1].length);switch(t){case"###,##0.00":return cn(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var _=ti(ql(h,0));return _!=="0"?d+_:"";case"###,###.00":return cn(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return cn(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function Kk(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return hs(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function Yk(e,t,r){var a=t.replace(f_,""),s=t.length-a.length;return hs(e,a,r*Math.pow(10,2*s))+yr("%",s)}function x_(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+x_(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var l=Math.floor(Math.log(t)*Math.LOG10E)%s;if(l<0&&(l+=s),r=(t/Math.pow(10,l)).toPrecision(a+1+(s+l)%s),!r.match(/[Ee]/)){var c=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(c-r.length+l):r+="E+"+(c-l),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,h,d,g){return h+d+g.substr(0,(s+l)%s)+"."+g.substr(l)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Bn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(g_)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Bn("n",a,r):"("+Bn("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Kk(e,t,r);if(t.indexOf("%")!==-1)return Yk(e,t,r);if(t.indexOf("E")!==-1)return x_(t,r);if(t.charCodeAt(0)===36)return"$"+Bn(e,t.substr(t.charAt(1)==" "?2:1),r);var s,l,c,u,h=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+kn(h,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:ya(t.substr(0,t.length-s.length))+s;if(l=t.match(d_))return qk(l,h,d);if(t.match(/^#+0+$/))return d+kn(h,t.length-t.indexOf("0"));if(l=t.match(m_))return s=(""+r).replace(/^([^\.]+)$/,"$1."+ya(l[1])).replace(/\.$/,"."+ya(l[1])),s=s.replace(/\.(\d*)$/,function(b,y){return"."+y+yr("0",ya(l[1]).length-y.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),l=t.match(/^(0*)\.(#*)$/))return d+(""+h).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=t.match(/^#{1,3},##0(\.?)$/))return d+ti(""+h);if(l=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Bn(e,t,-r):ti(""+r)+"."+yr("0",l[1].length);if(l=t.match(/^#,#*,#0/))return Bn(e,t.replace(/^#,#*,/,""),r);if(l=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=ro(Bn(e,t.replace(/[\\-]/g,""),r)),c=0,ro(ro(t.replace(/\\/g,"")).replace(/[0#]/g,function(b){return c<s.length?s.charAt(c++):b==="0"?"0":""}));if(t.match(p_))return s=Bn(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var g="";if(l=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(l[4].length,7),u=Lu(h,Math.pow(10,c)-1,!1),s=""+d,g=hs("n",l[1],u[1]),g.charAt(g.length-1)==" "&&(g=g.substr(0,g.length-1)+"0"),s+=g+l[2]+"/"+l[3],g=Fu(u[2],c),g.length<l[4].length&&(g=ya(l[4].substr(l[4].length-g.length))+g),s+=g,s;if(l=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(l[1].length,l[4].length),7),u=Lu(h,Math.pow(10,c)-1,!0),d+(u[0]||(u[1]?"":"0"))+" "+(u[1]?wm(u[1],c)+l[2]+"/"+l[3]+Fu(u[2],c):yr(" ",2*c+1+l[2].length+l[3].length));if(l=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:ya(t.substr(0,t.length-s.length))+s;if(l=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),c=s.indexOf(".");var x=t.indexOf(".")-c,v=t.length-s.length-x;return ya(t.substr(0,x)+s+t.substr(t.length-v))}if(l=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Bn(e,t,-r):ti(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?kn(0,3-b.length):"")+b})+"."+kn(0,l[1].length);switch(t){case"###,###":case"##,###":case"#,###":var _=ti(""+h);return _!=="0"?d+_:"";default:if(t.match(/\.[0#?]*$/))return Bn(e,t.slice(0,t.lastIndexOf(".")),r)+ya(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function hs(e,t,r){return(r|0)===r?Bn(e,t,r):cn(e,t,r)}function Jk(e){for(var t=[],r=!1,a=0,s=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:r=!r;break;case 95:case 42:case 92:++a;break;case 59:t[t.length]=e.substr(s,a-s),s=a+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var v_=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function ho(e){for(var t=0,r="",a="";t<e.length;)switch(r=e.charAt(t)){case"G":Mu(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(a=r;e.charAt(t++)!=="]"&&t<e.length;)a+=e.charAt(t);if(a.match(v_))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function Qk(e,t,r,a){for(var s=[],l="",c=0,u="",h="t",d,g,x,v="H";c<e.length;)switch(u=e.charAt(c)){case"G":if(!Mu(e,c))throw new Error("unrecognized character "+u+" in "+e);s[s.length]={t:"G",v:"General"},c+=7;break;case'"':for(l="";(x=e.charCodeAt(++c))!==34&&c<e.length;)l+=String.fromCharCode(x);s[s.length]={t:"t",v:l},++c;break;case"\\":var _=e.charAt(++c),b=_==="("||_===")"?_:"t";s[s.length]={t:b,v:_},++c;break;case"_":s[s.length]={t:"t",v:" "},c+=2;break;case"@":s[s.length]={t:"T",v:t},++c;break;case"B":case"b":if(e.charAt(c+1)==="1"||e.charAt(c+1)==="2"){if(d==null&&(d=Ii(t,r,e.charAt(c+1)==="2"),d==null))return"";s[s.length]={t:"X",v:e.substr(c,2)},h=u,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||d==null&&(d=Ii(t,r),d==null))return"";for(l=u;++c<e.length&&e.charAt(c).toLowerCase()===u;)l+=u;u==="m"&&h.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=v),s[s.length]={t:u,v:l},h=u;break;case"A":case"a":case"":var y={t:u,v:u};if(d==null&&(d=Ii(t,r)),e.substr(c,3).toUpperCase()==="A/P"?(d!=null&&(y.v=d.H>=12?"P":"A"),y.t="T",v="h",c+=3):e.substr(c,5).toUpperCase()==="AM/PM"?(d!=null&&(y.v=d.H>=12?"PM":"AM"),y.t="T",c+=5,v="h"):e.substr(c,5).toUpperCase()==="/"?(d!=null&&(y.v=d.H>=12?"":""),y.t="T",c+=5,v="h"):(y.t="t",++c),d==null&&y.t==="T")return"";s[s.length]=y,h=u;break;case"[":for(l=u;e.charAt(c++)!=="]"&&c<e.length;)l+=e.charAt(c);if(l.slice(-1)!=="]")throw'unterminated "[" block: |'+l+"|";if(l.match(v_)){if(d==null&&(d=Ii(t,r),d==null))return"";s[s.length]={t:"Z",v:l.toLowerCase()},h=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",ho(e)||(s[s.length]={t:"t",v:l}));break;case".":if(d!=null){for(l=u;++c<e.length&&(u=e.charAt(c))==="0";)l+=u;s[s.length]={t:"s",v:l};break}case"0":case"#":for(l=u;++c<e.length&&"0#?.,E+-%".indexOf(u=e.charAt(c))>-1;)l+=u;s[s.length]={t:"n",v:l};break;case"?":for(l=u;e.charAt(++c)===u;)l+=u;s[s.length]={t:u,v:l},h=u;break;case"*":++c,(e.charAt(c)==" "||e.charAt(c)=="*")&&++c;break;case"(":case")":s[s.length]={t:a===1?"t":u,v:u},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=u;c<e.length&&"0123456789".indexOf(e.charAt(++c))>-1;)l+=e.charAt(c);s[s.length]={t:"D",v:l};break;case" ":s[s.length]={t:u,v:u},++c;break;case"$":s[s.length]={t:"t",v:"$"},++c;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+e);s[s.length]={t:"t",v:u},++c;break}var S=0,k=0,R;for(c=s.length-1,h="t";c>=0;--c)switch(s[c].t){case"h":case"H":s[c].t=v,h="h",S<1&&(S=1);break;case"s":(R=s[c].v.match(/\.0+$/))&&(k=Math.max(k,R[0].length-1)),S<3&&(S=3);case"d":case"y":case"M":case"e":h=s[c].t;break;case"m":h==="s"&&(s[c].t="M",S<2&&(S=2));break;case"X":break;case"Z":S<1&&s[c].v.match(/[Hh]/)&&(S=1),S<2&&s[c].v.match(/[Mm]/)&&(S=2),S<3&&s[c].v.match(/[Ss]/)&&(S=3)}switch(S){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var T="",j;for(c=0;c<s.length;++c)switch(s[c].t){case"t":case"T":case" ":case"D":break;case"X":s[c].v="",s[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[c].v=Hk(s[c].t.charCodeAt(0),s[c].v,d,k),s[c].t="t";break;case"n":case"?":for(j=c+1;s[j]!=null&&((u=s[j].t)==="?"||u==="D"||(u===" "||u==="t")&&s[j+1]!=null&&(s[j+1].t==="?"||s[j+1].t==="t"&&s[j+1].v==="/")||s[c].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(s[j].v==="/"||s[j].v===" "&&s[j+1]!=null&&s[j+1].t=="?"));)s[c].v+=s[j].v,s[j]={v:"",t:";"},++j;T+=s[c].v,c=j-1;break;case"G":s[c].t="t",s[c].v=Hi(t,r);break}var X="",L,A;if(T.length>0){T.charCodeAt(0)==40?(L=t<0&&T.charCodeAt(0)===45?-t:t,A=hs("n",T,L)):(L=t<0&&a>1?-t:t,A=hs("n",T,L),L<0&&s[0]&&s[0].t=="t"&&(A=A.substr(1),s[0].v="-"+s[0].v)),j=A.length-1;var K=s.length;for(c=0;c<s.length;++c)if(s[c]!=null&&s[c].t!="t"&&s[c].v.indexOf(".")>-1){K=c;break}var q=s.length;if(K===s.length&&A.indexOf("E")===-1){for(c=s.length-1;c>=0;--c)s[c]==null||"n?".indexOf(s[c].t)===-1||(j>=s[c].v.length-1?(j-=s[c].v.length,s[c].v=A.substr(j+1,s[c].v.length)):j<0?s[c].v="":(s[c].v=A.substr(0,j+1),j=-1),s[c].t="t",q=c);j>=0&&q<s.length&&(s[q].v=A.substr(0,j+1)+s[q].v)}else if(K!==s.length&&A.indexOf("E")===-1){for(j=A.indexOf(".")-1,c=K;c>=0;--c)if(!(s[c]==null||"n?".indexOf(s[c].t)===-1)){for(g=s[c].v.indexOf(".")>-1&&c===K?s[c].v.indexOf(".")-1:s[c].v.length-1,X=s[c].v.substr(g+1);g>=0;--g)j>=0&&(s[c].v.charAt(g)==="0"||s[c].v.charAt(g)==="#")&&(X=A.charAt(j--)+X);s[c].v=X,s[c].t="t",q=c}for(j>=0&&q<s.length&&(s[q].v=A.substr(0,j+1)+s[q].v),j=A.indexOf(".")+1,c=K;c<s.length;++c)if(!(s[c]==null||"n?(".indexOf(s[c].t)===-1&&c!==K)){for(g=s[c].v.indexOf(".")>-1&&c===K?s[c].v.indexOf(".")+1:0,X=s[c].v.substr(0,g);g<s[c].v.length;++g)j<A.length&&(X+=A.charAt(j++));s[c].v=X,s[c].t="t",q=c}}}for(c=0;c<s.length;++c)s[c]!=null&&"n?".indexOf(s[c].t)>-1&&(L=a>1&&t<0&&c>0&&s[c-1].v==="-"?-t:t,s[c].v=hs(s[c].t,s[c].v,L),s[c].t="t");var ie="";for(c=0;c!==s.length;++c)s[c]!=null&&(ie+=s[c].v);return ie}var Fv=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Mv(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function Zk(e,t){var r=Jk(e),a=r.length,s=r[a-1].indexOf("@");if(a<4&&s>-1&&--a,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var l=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[a,l];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var c=r[0].match(Fv),u=r[1].match(Fv);return Mv(t,c)?[a,r[0]]:Mv(t,u)?[a,r[1]]:[a,r[c!=null&&u!=null?2:1]]}return[a,l]}function gn(e,t,r){r==null&&(r={});var a="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?a=r.dateNF:a=e;break;case"number":e==14&&r.dateNF?a=r.dateNF:a=(r.table!=null?r.table:ft)[e],a==null&&(a=r.table&&r.table[Ov[e]]||ft[Ov[e]]),a==null&&(a=Lk[e]||"General");break}if(Mu(a,0))return Hi(t,r);t instanceof Date&&(t=u_(t,r.date1904));var s=Zk(a,t);if(Mu(s[1]))return Hi(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return Qk(s[1],t,r,s[0])}function ds(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(ft[r]==null){t<0&&(t=r);continue}if(ft[r]==e){t=r;break}}t<0&&(t=391)}return ft[t]=e,t}function Yu(e){for(var t=0;t!=392;++t)e[t]!==void 0&&ds(e[t],t)}function mo(){ft=Mk()}var eA={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},y_=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function tA(e){var t=typeof e=="number"?ft[e]:e;return t=t.replace(y_,"(\\d+)"),new RegExp("^"+t+"$")}function rA(e,t,r){var a=-1,s=-1,l=-1,c=-1,u=-1,h=-1;(t.match(y_)||[]).forEach(function(x,v){var _=parseInt(r[v+1],10);switch(x.toLowerCase().charAt(0)){case"y":a=_;break;case"d":l=_;break;case"h":c=_;break;case"s":h=_;break;case"m":c>=0?u=_:s=_;break}}),h>=0&&u==-1&&s>=0&&(u=s,s=-1);var d=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(l>=1?l:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var g=("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(h>=0?h:0)).slice(-2);return c==-1&&u==-1&&h==-1?d:a==-1&&s==-1&&l==-1?g:d+"T"+g}var aA=(function(){var e={};e.version="1.2.0";function t(){for(var A=0,K=new Array(256),q=0;q!=256;++q)A=q,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,K[q]=A;return typeof Int32Array<"u"?new Int32Array(K):K}var r=t();function a(A){var K=0,q=0,ie=0,ne=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(ie=0;ie!=256;++ie)ne[ie]=A[ie];for(ie=0;ie!=256;++ie)for(q=A[ie],K=256+ie;K<4096;K+=256)q=ne[K]=q>>>8^A[q&255];var Z=[];for(ie=1;ie!=16;++ie)Z[ie-1]=typeof Int32Array<"u"?ne.subarray(ie*256,ie*256+256):ne.slice(ie*256,ie*256+256);return Z}var s=a(r),l=s[0],c=s[1],u=s[2],h=s[3],d=s[4],g=s[5],x=s[6],v=s[7],_=s[8],b=s[9],y=s[10],S=s[11],k=s[12],R=s[13],T=s[14];function j(A,K){for(var q=K^-1,ie=0,ne=A.length;ie<ne;)q=q>>>8^r[(q^A.charCodeAt(ie++))&255];return~q}function X(A,K){for(var q=K^-1,ie=A.length-15,ne=0;ne<ie;)q=T[A[ne++]^q&255]^R[A[ne++]^q>>8&255]^k[A[ne++]^q>>16&255]^S[A[ne++]^q>>>24]^y[A[ne++]]^b[A[ne++]]^_[A[ne++]]^v[A[ne++]]^x[A[ne++]]^g[A[ne++]]^d[A[ne++]]^h[A[ne++]]^u[A[ne++]]^c[A[ne++]]^l[A[ne++]]^r[A[ne++]];for(ie+=15;ne<ie;)q=q>>>8^r[(q^A[ne++])&255];return~q}function L(A,K){for(var q=K^-1,ie=0,ne=A.length,Z=0,me=0;ie<ne;)Z=A.charCodeAt(ie++),Z<128?q=q>>>8^r[(q^Z)&255]:Z<2048?(q=q>>>8^r[(q^(192|Z>>6&31))&255],q=q>>>8^r[(q^(128|Z&63))&255]):Z>=55296&&Z<57344?(Z=(Z&1023)+64,me=A.charCodeAt(ie++)&1023,q=q>>>8^r[(q^(240|Z>>8&7))&255],q=q>>>8^r[(q^(128|Z>>2&63))&255],q=q>>>8^r[(q^(128|me>>6&15|(Z&3)<<4))&255],q=q>>>8^r[(q^(128|me&63))&255]):(q=q>>>8^r[(q^(224|Z>>12&15))&255],q=q>>>8^r[(q^(128|Z>>6&63))&255],q=q>>>8^r[(q^(128|Z&63))&255]);return~q}return e.table=r,e.bstr=j,e.buf=X,e.str=L,e})(),it=(function(){var t={};t.version="1.2.1";function r(C,z){for(var D=C.split("/"),F=z.split("/"),B=0,H=0,fe=Math.min(D.length,F.length);B<fe;++B){if(H=D[B].length-F[B].length)return H;if(D[B]!=F[B])return D[B]<F[B]?-1:1}return D.length-F.length}function a(C){if(C.charAt(C.length-1)=="/")return C.slice(0,-1).indexOf("/")===-1?C:a(C.slice(0,-1));var z=C.lastIndexOf("/");return z===-1?C:C.slice(0,z+1)}function s(C){if(C.charAt(C.length-1)=="/")return s(C.slice(0,-1));var z=C.lastIndexOf("/");return z===-1?C:C.slice(z+1)}function l(C,z){typeof z=="string"&&(z=new Date(z));var D=z.getHours();D=D<<6|z.getMinutes(),D=D<<5|z.getSeconds()>>>1,C.write_shift(2,D);var F=z.getFullYear()-1980;F=F<<4|z.getMonth()+1,F=F<<5|z.getDate(),C.write_shift(2,F)}function c(C){var z=C.read_shift(2)&65535,D=C.read_shift(2)&65535,F=new Date,B=D&31;D>>>=5;var H=D&15;D>>>=4,F.setMilliseconds(0),F.setFullYear(D+1980),F.setMonth(H-1),F.setDate(B);var fe=z&31;z>>>=5;var _e=z&63;return z>>>=6,F.setHours(z),F.setMinutes(_e),F.setSeconds(fe<<1),F}function u(C){aa(C,0);for(var z={},D=0;C.l<=C.length-4;){var F=C.read_shift(2),B=C.read_shift(2),H=C.l+B,fe={};F===21589&&(D=C.read_shift(1),D&1&&(fe.mtime=C.read_shift(4)),B>5&&(D&2&&(fe.atime=C.read_shift(4)),D&4&&(fe.ctime=C.read_shift(4))),fe.mtime&&(fe.mt=new Date(fe.mtime*1e3))),C.l=H,z[F]=fe}return z}var h;function d(){return h||(h={})}function g(C,z){if(C[0]==80&&C[1]==75)return Hn(C,z);if((C[0]|32)==109&&(C[1]|32)==105)return Vn(C,z);if(C.length<512)throw new Error("CFB file size "+C.length+" < 512");var D=3,F=512,B=0,H=0,fe=0,_e=0,oe=0,le=[],he=C.slice(0,512);aa(he,0);var Ne=x(he);switch(D=Ne[0],D){case 3:F=512;break;case 4:F=4096;break;case 0:if(Ne[1]==0)return Hn(C,z);default:throw new Error("Major Version: Expected 3 or 4 saw "+D)}F!==512&&(he=C.slice(0,F),aa(he,28));var Le=C.slice(0,F);v(he,D);var He=he.read_shift(4,"i");if(D===3&&He!==0)throw new Error("# Directory Sectors: Expected 0 saw "+He);he.l+=4,fe=he.read_shift(4,"i"),he.l+=4,he.chk("00100000","Mini Stream Cutoff Size: "),_e=he.read_shift(4,"i"),B=he.read_shift(4,"i"),oe=he.read_shift(4,"i"),H=he.read_shift(4,"i");for(var De=-1,ze=0;ze<109&&(De=he.read_shift(4,"i"),!(De<0));++ze)le[ze]=De;var Qe=_(C,F);S(oe,H,Qe,F,le);var Gt=R(Qe,fe,le,F);Gt[fe].name="!Directory",B>0&&_e!==me&&(Gt[_e].name="!MiniFAT"),Gt[le[0]].name="!FAT",Gt.fat_addrs=le,Gt.ssz=F;var qt={},tr=[],Sa=[],Gn=[];T(fe,Gt,Qe,tr,B,qt,Sa,_e),b(Sa,Gn,tr),tr.shift();var Nn={FileIndex:Sa,FullPaths:Gn};return z&&z.raw&&(Nn.raw={header:Le,sectors:Qe}),Nn}function x(C){if(C[C.l]==80&&C[C.l+1]==75)return[0,0];C.chk(Re,"Header Signature: "),C.l+=16;var z=C.read_shift(2,"u");return[C.read_shift(2,"u"),z]}function v(C,z){var D=9;switch(C.l+=2,D=C.read_shift(2)){case 9:if(z!=3)throw new Error("Sector Shift: Expected 9 saw "+D);break;case 12:if(z!=4)throw new Error("Sector Shift: Expected 12 saw "+D);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+D)}C.chk("0600","Mini Sector Shift: "),C.chk("000000000000","Reserved: ")}function _(C,z){for(var D=Math.ceil(C.length/z)-1,F=[],B=1;B<D;++B)F[B-1]=C.slice(B*z,(B+1)*z);return F[D-1]=C.slice(D*z),F}function b(C,z,D){for(var F=0,B=0,H=0,fe=0,_e=0,oe=D.length,le=[],he=[];F<oe;++F)le[F]=he[F]=F,z[F]=D[F];for(;_e<he.length;++_e)F=he[_e],B=C[F].L,H=C[F].R,fe=C[F].C,le[F]===F&&(B!==-1&&le[B]!==B&&(le[F]=le[B]),H!==-1&&le[H]!==H&&(le[F]=le[H])),fe!==-1&&(le[fe]=F),B!==-1&&F!=le[F]&&(le[B]=le[F],he.lastIndexOf(B)<_e&&he.push(B)),H!==-1&&F!=le[F]&&(le[H]=le[F],he.lastIndexOf(H)<_e&&he.push(H));for(F=1;F<oe;++F)le[F]===F&&(H!==-1&&le[H]!==H?le[F]=le[H]:B!==-1&&le[B]!==B&&(le[F]=le[B]));for(F=1;F<oe;++F)if(C[F].type!==0){if(_e=F,_e!=le[_e])do _e=le[_e],z[F]=z[_e]+"/"+z[F];while(_e!==0&&le[_e]!==-1&&_e!=le[_e]);le[F]=-1}for(z[0]+="/",F=1;F<oe;++F)C[F].type!==2&&(z[F]+="/")}function y(C,z,D){for(var F=C.start,B=C.size,H=[],fe=F;D&&B>0&&fe>=0;)H.push(z.slice(fe*Z,fe*Z+Z)),B-=Z,fe=Li(D,fe*4);return H.length===0?ye(0):Xr(H).slice(0,C.size)}function S(C,z,D,F,B){var H=me;if(C===me){if(z!==0)throw new Error("DIFAT chain shorter than expected")}else if(C!==-1){var fe=D[C],_e=(F>>>2)-1;if(!fe)return;for(var oe=0;oe<_e&&(H=Li(fe,oe*4))!==me;++oe)B.push(H);S(Li(fe,F-4),z-1,D,F,B)}}function k(C,z,D,F,B){var H=[],fe=[];B||(B=[]);var _e=F-1,oe=0,le=0;for(oe=z;oe>=0;){B[oe]=!0,H[H.length]=oe,fe.push(C[oe]);var he=D[Math.floor(oe*4/F)];if(le=oe*4&_e,F<4+le)throw new Error("FAT boundary crossed: "+oe+" 4 "+F);if(!C[he])break;oe=Li(C[he],le)}return{nodes:H,data:qv([fe])}}function R(C,z,D,F){var B=C.length,H=[],fe=[],_e=[],oe=[],le=F-1,he=0,Ne=0,Le=0,He=0;for(he=0;he<B;++he)if(_e=[],Le=he+z,Le>=B&&(Le-=B),!fe[Le]){oe=[];var De=[];for(Ne=Le;Ne>=0;){De[Ne]=!0,fe[Ne]=!0,_e[_e.length]=Ne,oe.push(C[Ne]);var ze=D[Math.floor(Ne*4/F)];if(He=Ne*4&le,F<4+He)throw new Error("FAT boundary crossed: "+Ne+" 4 "+F);if(!C[ze]||(Ne=Li(C[ze],He),De[Ne]))break}H[Le]={nodes:_e,data:qv([oe])}}return H}function T(C,z,D,F,B,H,fe,_e){for(var oe=0,le=F.length?2:0,he=z[C].data,Ne=0,Le=0,He;Ne<he.length;Ne+=128){var De=he.slice(Ne,Ne+128);aa(De,64),Le=De.read_shift(2),He=Nm(De,0,Le-le),F.push(He);var ze={name:He,type:De.read_shift(1),color:De.read_shift(1),L:De.read_shift(4,"i"),R:De.read_shift(4,"i"),C:De.read_shift(4,"i"),clsid:De.read_shift(16),state:De.read_shift(4,"i"),start:0,size:0},Qe=De.read_shift(2)+De.read_shift(2)+De.read_shift(2)+De.read_shift(2);Qe!==0&&(ze.ct=j(De,De.l-8));var Gt=De.read_shift(2)+De.read_shift(2)+De.read_shift(2)+De.read_shift(2);Gt!==0&&(ze.mt=j(De,De.l-8)),ze.start=De.read_shift(4,"i"),ze.size=De.read_shift(4,"i"),ze.size<0&&ze.start<0&&(ze.size=ze.type=0,ze.start=me,ze.name=""),ze.type===5?(oe=ze.start,B>0&&oe!==me&&(z[oe].name="!StreamData")):ze.size>=4096?(ze.storage="fat",z[ze.start]===void 0&&(z[ze.start]=k(D,ze.start,z.fat_addrs,z.ssz)),z[ze.start].name=ze.name,ze.content=z[ze.start].data.slice(0,ze.size)):(ze.storage="minifat",ze.size<0?ze.size=0:oe!==me&&ze.start!==me&&z[oe]&&(ze.content=y(ze,z[oe].data,(z[_e]||{}).data))),ze.content&&aa(ze.content,0),H[He]=ze,fe.push(ze)}}function j(C,z){return new Date((Ga(C,z+4)/1e7*Math.pow(2,32)+Ga(C,z)/1e7-11644473600)*1e3)}function X(C,z){return d(),g(h.readFileSync(C),z)}function L(C,z){var D=z&&z.type;switch(D||wt&&Buffer.isBuffer(C)&&(D="buffer"),D||"base64"){case"file":return X(C,z);case"base64":return g(Wa(Ya(C)),z);case"binary":return g(Wa(C),z)}return g(C,z)}function A(C,z){var D=z||{},F=D.root||"Root Entry";if(C.FullPaths||(C.FullPaths=[]),C.FileIndex||(C.FileIndex=[]),C.FullPaths.length!==C.FileIndex.length)throw new Error("inconsistent CFB structure");C.FullPaths.length===0&&(C.FullPaths[0]=F+"/",C.FileIndex[0]={name:F,type:5}),D.CLSID&&(C.FileIndex[0].clsid=D.CLSID),K(C)}function K(C){var z="Sh33tJ5";if(!it.find(C,"/"+z)){var D=ye(4);D[0]=55,D[1]=D[3]=50,D[2]=54,C.FileIndex.push({name:z,type:2,content:D,size:4,L:69,R:69,C:69}),C.FullPaths.push(C.FullPaths[0]+z),q(C)}}function q(C,z){A(C);for(var D=!1,F=!1,B=C.FullPaths.length-1;B>=0;--B){var H=C.FileIndex[B];switch(H.type){case 0:F?D=!0:(C.FileIndex.pop(),C.FullPaths.pop());break;case 1:case 2:case 5:F=!0,isNaN(H.R*H.L*H.C)&&(D=!0),H.R>-1&&H.L>-1&&H.R==H.L&&(D=!0);break;default:D=!0;break}}if(!(!D&&!z)){var fe=new Date(1987,1,19),_e=0,oe=Object.create?Object.create(null):{},le=[];for(B=0;B<C.FullPaths.length;++B)oe[C.FullPaths[B]]=!0,C.FileIndex[B].type!==0&&le.push([C.FullPaths[B],C.FileIndex[B]]);for(B=0;B<le.length;++B){var he=a(le[B][0]);F=oe[he],F||(le.push([he,{name:s(he).replace("/",""),type:1,clsid:V,ct:fe,mt:fe,content:null}]),oe[he]=!0)}for(le.sort(function(He,De){return r(He[0],De[0])}),C.FullPaths=[],C.FileIndex=[],B=0;B<le.length;++B)C.FullPaths[B]=le[B][0],C.FileIndex[B]=le[B][1];for(B=0;B<le.length;++B){var Ne=C.FileIndex[B],Le=C.FullPaths[B];if(Ne.name=s(Le).replace("/",""),Ne.L=Ne.R=Ne.C=-(Ne.color=1),Ne.size=Ne.content?Ne.content.length:0,Ne.start=0,Ne.clsid=Ne.clsid||V,B===0)Ne.C=le.length>1?1:-1,Ne.size=0,Ne.type=5;else if(Le.slice(-1)=="/"){for(_e=B+1;_e<le.length&&a(C.FullPaths[_e])!=Le;++_e);for(Ne.C=_e>=le.length?-1:_e,_e=B+1;_e<le.length&&a(C.FullPaths[_e])!=a(Le);++_e);Ne.R=_e>=le.length?-1:_e,Ne.type=1}else a(C.FullPaths[B+1]||"")==a(Le)&&(Ne.R=B+1),Ne.type=2}}}function ie(C,z){var D=z||{};if(D.fileType=="mad")return vo(C,D);if(q(C),D.fileType==="zip")return ws(C,D);var F=(function(He){for(var De=0,ze=0,Qe=0;Qe<He.FileIndex.length;++Qe){var Gt=He.FileIndex[Qe];if(Gt.content){var qt=Gt.content.length;qt>0&&(qt<4096?De+=qt+63>>6:ze+=qt+511>>9)}}for(var tr=He.FullPaths.length+3>>2,Sa=De+7>>3,Gn=De+127>>7,Nn=Sa+ze+tr+Gn,Qa=Nn+127>>7,qn=Qa<=109?0:Math.ceil((Qa-109)/127);Nn+Qa+qn+127>>7>Qa;)qn=++Qa<=109?0:Math.ceil((Qa-109)/127);var Kr=[1,qn,Qa,Gn,tr,ze,De,0];return He.FileIndex[0].size=De<<6,Kr[7]=(He.FileIndex[0].start=Kr[0]+Kr[1]+Kr[2]+Kr[3]+Kr[4]+Kr[5])+(Kr[6]+7>>3),Kr})(C),B=ye(F[7]<<9),H=0,fe=0;{for(H=0;H<8;++H)B.write_shift(1,Ae[H]);for(H=0;H<8;++H)B.write_shift(2,0);for(B.write_shift(2,62),B.write_shift(2,3),B.write_shift(2,65534),B.write_shift(2,9),B.write_shift(2,6),H=0;H<3;++H)B.write_shift(2,0);for(B.write_shift(4,0),B.write_shift(4,F[2]),B.write_shift(4,F[0]+F[1]+F[2]+F[3]-1),B.write_shift(4,0),B.write_shift(4,4096),B.write_shift(4,F[3]?F[0]+F[1]+F[2]-1:me),B.write_shift(4,F[3]),B.write_shift(-4,F[1]?F[0]-1:me),B.write_shift(4,F[1]),H=0;H<109;++H)B.write_shift(-4,H<F[2]?F[1]+H:-1)}if(F[1])for(fe=0;fe<F[1];++fe){for(;H<236+fe*127;++H)B.write_shift(-4,H<F[2]?F[1]+H:-1);B.write_shift(-4,fe===F[1]-1?me:fe+1)}var _e=function(He){for(fe+=He;H<fe-1;++H)B.write_shift(-4,H+1);He&&(++H,B.write_shift(-4,me))};for(fe=H=0,fe+=F[1];H<fe;++H)B.write_shift(-4,ae.DIFSECT);for(fe+=F[2];H<fe;++H)B.write_shift(-4,ae.FATSECT);_e(F[3]),_e(F[4]);for(var oe=0,le=0,he=C.FileIndex[0];oe<C.FileIndex.length;++oe)he=C.FileIndex[oe],he.content&&(le=he.content.length,!(le<4096)&&(he.start=fe,_e(le+511>>9)));for(_e(F[6]+7>>3);B.l&511;)B.write_shift(-4,ae.ENDOFCHAIN);for(fe=H=0,oe=0;oe<C.FileIndex.length;++oe)he=C.FileIndex[oe],he.content&&(le=he.content.length,!(!le||le>=4096)&&(he.start=fe,_e(le+63>>6)));for(;B.l&511;)B.write_shift(-4,ae.ENDOFCHAIN);for(H=0;H<F[4]<<2;++H){var Ne=C.FullPaths[H];if(!Ne||Ne.length===0){for(oe=0;oe<17;++oe)B.write_shift(4,0);for(oe=0;oe<3;++oe)B.write_shift(4,-1);for(oe=0;oe<12;++oe)B.write_shift(4,0);continue}he=C.FileIndex[H],H===0&&(he.start=he.size?he.start-1:me);var Le=H===0&&D.root||he.name;if(le=2*(Le.length+1),B.write_shift(64,Le,"utf16le"),B.write_shift(2,le),B.write_shift(1,he.type),B.write_shift(1,he.color),B.write_shift(-4,he.L),B.write_shift(-4,he.R),B.write_shift(-4,he.C),he.clsid)B.write_shift(16,he.clsid,"hex");else for(oe=0;oe<4;++oe)B.write_shift(4,0);B.write_shift(4,he.state||0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,he.start),B.write_shift(4,he.size),B.write_shift(4,0)}for(H=1;H<C.FileIndex.length;++H)if(he=C.FileIndex[H],he.size>=4096)if(B.l=he.start+1<<9,wt&&Buffer.isBuffer(he.content))he.content.copy(B,B.l,0,he.size),B.l+=he.size+511&-512;else{for(oe=0;oe<he.size;++oe)B.write_shift(1,he.content[oe]);for(;oe&511;++oe)B.write_shift(1,0)}for(H=1;H<C.FileIndex.length;++H)if(he=C.FileIndex[H],he.size>0&&he.size<4096)if(wt&&Buffer.isBuffer(he.content))he.content.copy(B,B.l,0,he.size),B.l+=he.size+63&-64;else{for(oe=0;oe<he.size;++oe)B.write_shift(1,he.content[oe]);for(;oe&63;++oe)B.write_shift(1,0)}if(wt)B.l=B.length;else for(;B.l<B.length;)B.write_shift(1,0);return B}function ne(C,z){var D=C.FullPaths.map(function(oe){return oe.toUpperCase()}),F=D.map(function(oe){var le=oe.split("/");return le[le.length-(oe.slice(-1)=="/"?2:1)]}),B=!1;z.charCodeAt(0)===47?(B=!0,z=D[0].slice(0,-1)+z):B=z.indexOf("/")!==-1;var H=z.toUpperCase(),fe=B===!0?D.indexOf(H):F.indexOf(H);if(fe!==-1)return C.FileIndex[fe];var _e=!H.match(hc);for(H=H.replace(wa,""),_e&&(H=H.replace(hc,"!")),fe=0;fe<D.length;++fe)if((_e?D[fe].replace(hc,"!"):D[fe]).replace(wa,"")==H||(_e?F[fe].replace(hc,"!"):F[fe]).replace(wa,"")==H)return C.FileIndex[fe];return null}var Z=64,me=-2,Re="d0cf11e0a1b11ae1",Ae=[208,207,17,224,161,177,26,225],V="00000000000000000000000000000000",ae={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:me,FREESECT:-1,HEADER_SIGNATURE:Re,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:V,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function xe(C,z,D){d();var F=ie(C,D);h.writeFileSync(z,F)}function J(C){for(var z=new Array(C.length),D=0;D<C.length;++D)z[D]=String.fromCharCode(C[D]);return z.join("")}function be(C,z){var D=ie(C,z);switch(z&&z.type||"buffer"){case"file":return d(),h.writeFileSync(z.filename,D),D;case"binary":return typeof D=="string"?D:J(D);case"base64":return Rc(typeof D=="string"?D:J(D));case"buffer":if(wt)return Buffer.isBuffer(D)?D:xs(D);case"array":return typeof D=="string"?Wa(D):D}return D}var I;function N(C){try{var z=C.InflateRaw,D=new z;if(D._processChunk(new Uint8Array([3,0]),D._finishFlushFlag),D.bytesRead)I=C;else throw new Error("zlib does not expose bytesRead")}catch(F){console.error("cannot use native zlib: "+(F.message||F))}}function U(C,z){if(!I)return tl(C,z);var D=I.InflateRaw,F=new D,B=F._processChunk(C.slice(C.l),F._finishFlushFlag);return C.l+=F.bytesRead,B}function M(C){return I?I.deflateRawSync(C):mt(C)}var P=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],te=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],pe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ee(C){var z=(C<<1|C<<11)&139536|(C<<5|C<<15)&558144;return(z>>16|z>>8|z)&255}for(var ve=typeof Uint8Array<"u",Te=ve?new Uint8Array(256):[],tt=0;tt<256;++tt)Te[tt]=Ee(tt);function G(C,z){var D=Te[C&255];return z<=8?D>>>8-z:(D=D<<8|Te[C>>8&255],z<=16?D>>>16-z:(D=D<<8|Te[C>>16&255],D>>>24-z))}function Rt(C,z){var D=z&7,F=z>>>3;return(C[F]|(D<=6?0:C[F+1]<<8))>>>D&3}function We(C,z){var D=z&7,F=z>>>3;return(C[F]|(D<=5?0:C[F+1]<<8))>>>D&7}function bt(C,z){var D=z&7,F=z>>>3;return(C[F]|(D<=4?0:C[F+1]<<8))>>>D&15}function lt(C,z){var D=z&7,F=z>>>3;return(C[F]|(D<=3?0:C[F+1]<<8))>>>D&31}function Pe(C,z){var D=z&7,F=z>>>3;return(C[F]|(D<=1?0:C[F+1]<<8))>>>D&127}function Zt(C,z,D){var F=z&7,B=z>>>3,H=(1<<D)-1,fe=C[B]>>>F;return D<8-F||(fe|=C[B+1]<<8-F,D<16-F)||(fe|=C[B+2]<<16-F,D<24-F)||(fe|=C[B+3]<<24-F),fe&H}function Ar(C,z,D){var F=z&7,B=z>>>3;return F<=5?C[B]|=(D&7)<<F:(C[B]|=D<<F&255,C[B+1]=(D&7)>>8-F),z+3}function Hr(C,z,D){var F=z&7,B=z>>>3;return D=(D&1)<<F,C[B]|=D,z+1}function $r(C,z,D){var F=z&7,B=z>>>3;return D<<=F,C[B]|=D&255,D>>>=8,C[B+1]=D,z+8}function zn(C,z,D){var F=z&7,B=z>>>3;return D<<=F,C[B]|=D&255,D>>>=8,C[B+1]=D&255,C[B+2]=D>>>8,z+16}function Ja(C,z){var D=C.length,F=2*D>z?2*D:z+5,B=0;if(D>=z)return C;if(wt){var H=Av(F);if(C.copy)C.copy(H);else for(;B<C.length;++B)H[B]=C[B];return H}else if(ve){var fe=new Uint8Array(F);if(fe.set)fe.set(C);else for(;B<D;++B)fe[B]=C[B];return fe}return C.length=F,C}function Et(C){for(var z=new Array(C),D=0;D<C;++D)z[D]=0;return z}function xa(C,z,D){var F=1,B=0,H=0,fe=0,_e=0,oe=C.length,le=ve?new Uint16Array(32):Et(32);for(H=0;H<32;++H)le[H]=0;for(H=oe;H<D;++H)C[H]=0;oe=C.length;var he=ve?new Uint16Array(oe):Et(oe);for(H=0;H<oe;++H)le[B=C[H]]++,F<B&&(F=B),he[H]=0;for(le[0]=0,H=1;H<=F;++H)le[H+16]=_e=_e+le[H-1]<<1;for(H=0;H<oe;++H)_e=C[H],_e!=0&&(he[H]=le[_e+16]++);var Ne=0;for(H=0;H<oe;++H)if(Ne=C[H],Ne!=0)for(_e=G(he[H],F)>>F-Ne,fe=(1<<F+4-Ne)-1;fe>=0;--fe)z[_e|fe<<Ne]=Ne&15|H<<4;return F}var sa=ve?new Uint16Array(512):Et(512),Ma=ve?new Uint16Array(32):Et(32);if(!ve){for(var Jt=0;Jt<512;++Jt)sa[Jt]=0;for(Jt=0;Jt<32;++Jt)Ma[Jt]=0}(function(){for(var C=[],z=0;z<32;z++)C.push(5);xa(C,Ma,32);var D=[];for(z=0;z<=143;z++)D.push(8);for(;z<=255;z++)D.push(9);for(;z<=279;z++)D.push(7);for(;z<=287;z++)D.push(8);xa(D,sa,288)})();var ia=(function(){for(var z=ve?new Uint8Array(32768):[],D=0,F=0;D<pe.length-1;++D)for(;F<pe[D+1];++F)z[F]=D;for(;F<32768;++F)z[F]=29;var B=ve?new Uint8Array(259):[];for(D=0,F=0;D<te.length-1;++D)for(;F<te[D+1];++F)B[F]=D;function H(_e,oe){for(var le=0;le<_e.length;){var he=Math.min(65535,_e.length-le),Ne=le+he==_e.length;for(oe.write_shift(1,+Ne),oe.write_shift(2,he),oe.write_shift(2,~he&65535);he-- >0;)oe[oe.l++]=_e[le++]}return oe.l}function fe(_e,oe){for(var le=0,he=0,Ne=ve?new Uint16Array(32768):[];he<_e.length;){var Le=Math.min(65535,_e.length-he);if(Le<10){for(le=Ar(oe,le,+(he+Le==_e.length)),le&7&&(le+=8-(le&7)),oe.l=le/8|0,oe.write_shift(2,Le),oe.write_shift(2,~Le&65535);Le-- >0;)oe[oe.l++]=_e[he++];le=oe.l*8;continue}le=Ar(oe,le,+(he+Le==_e.length)+2);for(var He=0;Le-- >0;){var De=_e[he];He=(He<<5^De)&32767;var ze=-1,Qe=0;if((ze=Ne[He])&&(ze|=he&-32768,ze>he&&(ze-=32768),ze<he))for(;_e[ze+Qe]==_e[he+Qe]&&Qe<250;)++Qe;if(Qe>2){De=B[Qe],De<=22?le=$r(oe,le,Te[De+1]>>1)-1:($r(oe,le,3),le+=5,$r(oe,le,Te[De-23]>>5),le+=3);var Gt=De<8?0:De-4>>2;Gt>0&&(zn(oe,le,Qe-te[De]),le+=Gt),De=z[he-ze],le=$r(oe,le,Te[De]>>3),le-=3;var qt=De<4?0:De-2>>1;qt>0&&(zn(oe,le,he-ze-pe[De]),le+=qt);for(var tr=0;tr<Qe;++tr)Ne[He]=he&32767,He=(He<<5^_e[he])&32767,++he;Le-=Qe-1}else De<=143?De=De+48:le=Hr(oe,le,1),le=$r(oe,le,Te[De]),Ne[He]=he&32767,++he}le=$r(oe,le,0)-1}return oe.l=(le+7)/8|0,oe.l}return function(oe,le){return oe.length<8?H(oe,le):fe(oe,le)}})();function mt(C){var z=ye(50+Math.floor(C.length*1.1)),D=ia(C,z);return z.slice(0,D)}var Dt=ve?new Uint16Array(32768):Et(32768),Ir=ve?new Uint16Array(32768):Et(32768),Vt=ve?new Uint16Array(128):Et(128),er=1,La=1;function cr(C,z){var D=lt(C,z)+257;z+=5;var F=lt(C,z)+1;z+=5;var B=bt(C,z)+4;z+=4;for(var H=0,fe=ve?new Uint8Array(19):Et(19),_e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],oe=1,le=ve?new Uint8Array(8):Et(8),he=ve?new Uint8Array(8):Et(8),Ne=fe.length,Le=0;Le<B;++Le)fe[P[Le]]=H=We(C,z),oe<H&&(oe=H),le[H]++,z+=3;var He=0;for(le[0]=0,Le=1;Le<=oe;++Le)he[Le]=He=He+le[Le-1]<<1;for(Le=0;Le<Ne;++Le)(He=fe[Le])!=0&&(_e[Le]=he[He]++);var De=0;for(Le=0;Le<Ne;++Le)if(De=fe[Le],De!=0){He=Te[_e[Le]]>>8-De;for(var ze=(1<<7-De)-1;ze>=0;--ze)Vt[He|ze<<De]=De&7|Le<<3}var Qe=[];for(oe=1;Qe.length<D+F;)switch(He=Vt[Pe(C,z)],z+=He&7,He>>>=3){case 16:for(H=3+Rt(C,z),z+=2,He=Qe[Qe.length-1];H-- >0;)Qe.push(He);break;case 17:for(H=3+We(C,z),z+=3;H-- >0;)Qe.push(0);break;case 18:for(H=11+Pe(C,z),z+=7;H-- >0;)Qe.push(0);break;default:Qe.push(He),oe<He&&(oe=He);break}var Gt=Qe.slice(0,D),qt=Qe.slice(D);for(Le=D;Le<286;++Le)Gt[Le]=0;for(Le=F;Le<30;++Le)qt[Le]=0;return er=xa(Gt,Dt,286),La=xa(qt,Ir,30),z}function ui(C,z){if(C[0]==3&&!(C[1]&3))return[ri(z),2];for(var D=0,F=0,B=Av(z||1<<18),H=0,fe=B.length>>>0,_e=0,oe=0;(F&1)==0;){if(F=We(C,D),D+=3,F>>>1)F>>1==1?(_e=9,oe=5):(D=cr(C,D),_e=er,oe=La);else{D&7&&(D+=8-(D&7));var le=C[D>>>3]|C[(D>>>3)+1]<<8;if(D+=32,le>0)for(!z&&fe<H+le&&(B=Ja(B,H+le),fe=B.length);le-- >0;)B[H++]=C[D>>>3],D+=8;continue}for(;;){!z&&fe<H+32767&&(B=Ja(B,H+32767),fe=B.length);var he=Zt(C,D,_e),Ne=F>>>1==1?sa[he]:Dt[he];if(D+=Ne&15,Ne>>>=4,(Ne>>>8&255)===0)B[H++]=Ne;else{if(Ne==256)break;Ne-=257;var Le=Ne<8?0:Ne-4>>2;Le>5&&(Le=0);var He=H+te[Ne];Le>0&&(He+=Zt(C,D,Le),D+=Le),he=Zt(C,D,oe),Ne=F>>>1==1?Ma[he]:Ir[he],D+=Ne&15,Ne>>>=4;var De=Ne<4?0:Ne-2>>1,ze=pe[Ne];for(De>0&&(ze+=Zt(C,D,De),D+=De),!z&&fe<He&&(B=Ja(B,He+100),fe=B.length);H<He;)B[H]=B[H-ze],++H}}}return z?[B,D+7>>>3]:[B.slice(0,H),D+7>>>3]}function tl(C,z){var D=C.slice(C.l||0),F=ui(D,z);return C.l+=F[1],F[0]}function rl(C,z){if(C)typeof console<"u"&&console.error(z);else throw new Error(z)}function Hn(C,z){var D=C;aa(D,0);var F=[],B=[],H={FileIndex:F,FullPaths:B};A(H,{root:z.root});for(var fe=D.length-4;(D[fe]!=80||D[fe+1]!=75||D[fe+2]!=5||D[fe+3]!=6)&&fe>=0;)--fe;D.l=fe+4,D.l+=4;var _e=D.read_shift(2);D.l+=6;var oe=D.read_shift(4);for(D.l=oe,fe=0;fe<_e;++fe){D.l+=20;var le=D.read_shift(4),he=D.read_shift(4),Ne=D.read_shift(2),Le=D.read_shift(2),He=D.read_shift(2);D.l+=8;var De=D.read_shift(4),ze=u(D.slice(D.l+Ne,D.l+Ne+Le));D.l+=Ne+Le+He;var Qe=D.l;D.l=De+4,_s(D,le,he,H,ze),D.l=Qe}return H}function _s(C,z,D,F,B){C.l+=2;var H=C.read_shift(2),fe=C.read_shift(2),_e=c(C);if(H&8257)throw new Error("Unsupported ZIP encryption");for(var oe=C.read_shift(4),le=C.read_shift(4),he=C.read_shift(4),Ne=C.read_shift(2),Le=C.read_shift(2),He="",De=0;De<Ne;++De)He+=String.fromCharCode(C[C.l++]);if(Le){var ze=u(C.slice(C.l,C.l+Le));(ze[21589]||{}).mt&&(_e=ze[21589].mt),((B||{})[21589]||{}).mt&&(_e=B[21589].mt)}C.l+=Le;var Qe=C.slice(C.l,C.l+le);switch(fe){case 8:Qe=U(C,he);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+fe)}var Gt=!1;H&8&&(oe=C.read_shift(4),oe==134695760&&(oe=C.read_shift(4),Gt=!0),le=C.read_shift(4),he=C.read_shift(4)),le!=z&&rl(Gt,"Bad compressed size: "+z+" != "+le),he!=D&&rl(Gt,"Bad uncompressed size: "+D+" != "+he),Ss(F,He,Qe,{unsafe:!0,mt:_e})}function ws(C,z){var D=z||{},F=[],B=[],H=ye(1),fe=D.compression?8:0,_e=0,oe=0,le=0,he=0,Ne=0,Le=C.FullPaths[0],He=Le,De=C.FileIndex[0],ze=[],Qe=0;for(oe=1;oe<C.FullPaths.length;++oe)if(He=C.FullPaths[oe].slice(Le.length),De=C.FileIndex[oe],!(!De.size||!De.content||He=="Sh33tJ5")){var Gt=he,qt=ye(He.length);for(le=0;le<He.length;++le)qt.write_shift(1,He.charCodeAt(le)&127);qt=qt.slice(0,qt.l),ze[Ne]=aA.buf(De.content,0);var tr=De.content;fe==8&&(tr=M(tr)),H=ye(30),H.write_shift(4,67324752),H.write_shift(2,20),H.write_shift(2,_e),H.write_shift(2,fe),De.mt?l(H,De.mt):H.write_shift(4,0),H.write_shift(-4,ze[Ne]),H.write_shift(4,tr.length),H.write_shift(4,De.content.length),H.write_shift(2,qt.length),H.write_shift(2,0),he+=H.length,F.push(H),he+=qt.length,F.push(qt),he+=tr.length,F.push(tr),H=ye(46),H.write_shift(4,33639248),H.write_shift(2,0),H.write_shift(2,20),H.write_shift(2,_e),H.write_shift(2,fe),H.write_shift(4,0),H.write_shift(-4,ze[Ne]),H.write_shift(4,tr.length),H.write_shift(4,De.content.length),H.write_shift(2,qt.length),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(4,0),H.write_shift(4,Gt),Qe+=H.l,B.push(H),Qe+=qt.length,B.push(qt),++Ne}return H=ye(22),H.write_shift(4,101010256),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(2,Ne),H.write_shift(2,Ne),H.write_shift(4,Qe),H.write_shift(4,he),H.write_shift(2,0),Xr([Xr(F),Xr(B),H])}var ba={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function bs(C,z){if(C.ctype)return C.ctype;var D=C.name||"",F=D.match(/\.([^\.]+)$/);return F&&ba[F[1]]||z&&(F=(D=z).match(/[\.\\]([^\.\\])+$/),F&&ba[F[1]])?ba[F[1]]:"application/octet-stream"}function $n(C){for(var z=Rc(C),D=[],F=0;F<z.length;F+=76)D.push(z.slice(F,F+76));return D.join(`\r
`)+`\r
`}function xo(C){var z=C.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(le){var he=le.charCodeAt(0).toString(16).toUpperCase();return"="+(he.length==1?"0"+he:he)});z=z.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),z.charAt(0)==`
`&&(z="=0D"+z.slice(1)),z=z.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var D=[],F=z.split(`\r
`),B=0;B<F.length;++B){var H=F[B];if(H.length==0){D.push("");continue}for(var fe=0;fe<H.length;){var _e=76,oe=H.slice(fe,fe+_e);oe.charAt(_e-1)=="="?_e--:oe.charAt(_e-2)=="="?_e-=2:oe.charAt(_e-3)=="="&&(_e-=3),oe=H.slice(fe,fe+_e),fe+=_e,fe<H.length&&(oe+="="),D.push(oe)}}return D.join(`\r
`)}function al(C){for(var z=[],D=0;D<C.length;++D){for(var F=C[D];D<=C.length&&F.charAt(F.length-1)=="=";)F=F.slice(0,F.length-1)+C[++D];z.push(F)}for(var B=0;B<z.length;++B)z[B]=z[B].replace(/[=][0-9A-Fa-f]{2}/g,function(H){return String.fromCharCode(parseInt(H.slice(1),16))});return Wa(z.join(`\r
`))}function fi(C,z,D){for(var F="",B="",H="",fe,_e=0;_e<10;++_e){var oe=z[_e];if(!oe||oe.match(/^\s*$/))break;var le=oe.match(/^(.*?):\s*([^\s].*)$/);if(le)switch(le[1].toLowerCase()){case"content-location":F=le[2].trim();break;case"content-type":H=le[2].trim();break;case"content-transfer-encoding":B=le[2].trim();break}}switch(++_e,B.toLowerCase()){case"base64":fe=Wa(Ya(z.slice(_e).join("")));break;case"quoted-printable":fe=al(z.slice(_e));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+B)}var he=Ss(C,F.slice(D.length),fe,{unsafe:!0});H&&(he.ctype=H)}function Vn(C,z){if(J(C.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var D=z&&z.root||"",F=(wt&&Buffer.isBuffer(C)?C.toString("binary"):J(C)).split(`\r
`),B=0,H="";for(B=0;B<F.length;++B)if(H=F[B],!!/^Content-Location:/i.test(H)&&(H=H.slice(H.indexOf("file")),D||(D=H.slice(0,H.lastIndexOf("/")+1)),H.slice(0,D.length)!=D))for(;D.length>0&&(D=D.slice(0,D.length-1),D=D.slice(0,D.lastIndexOf("/")+1),H.slice(0,D.length)!=D););var fe=(F[1]||"").match(/boundary="(.*?)"/);if(!fe)throw new Error("MAD cannot find boundary");var _e="--"+(fe[1]||""),oe=[],le=[],he={FileIndex:oe,FullPaths:le};A(he);var Ne,Le=0;for(B=0;B<F.length;++B){var He=F[B];He!==_e&&He!==_e+"--"||(Le++&&fi(he,F.slice(Ne,B),D),Ne=B)}return he}function vo(C,z){var D=z||{},F=D.boundary||"SheetJS";F="------="+F;for(var B=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+F.slice(2)+'"',"","",""],H=C.FullPaths[0],fe=H,_e=C.FileIndex[0],oe=1;oe<C.FullPaths.length;++oe)if(fe=C.FullPaths[oe].slice(H.length),_e=C.FileIndex[oe],!(!_e.size||!_e.content||fe=="Sh33tJ5")){fe=fe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Qe){return"_x"+Qe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Qe){return"_u"+Qe.charCodeAt(0).toString(16)+"_"});for(var le=_e.content,he=wt&&Buffer.isBuffer(le)?le.toString("binary"):J(le),Ne=0,Le=Math.min(1024,he.length),He=0,De=0;De<=Le;++De)(He=he.charCodeAt(De))>=32&&He<128&&++Ne;var ze=Ne>=Le*4/5;B.push(F),B.push("Content-Location: "+(D.root||"file:///C:/SheetJS/")+fe),B.push("Content-Transfer-Encoding: "+(ze?"quoted-printable":"base64")),B.push("Content-Type: "+bs(_e,fe)),B.push(""),B.push(ze?xo(he):$n(he))}return B.push(F+`--\r
`),B.join(`\r
`)}function nl(C){var z={};return A(z,C),z}function Ss(C,z,D,F){var B=F&&F.unsafe;B||A(C);var H=!B&&it.find(C,z);if(!H){var fe=C.FullPaths[0];z.slice(0,fe.length)==fe?fe=z:(fe.slice(-1)!="/"&&(fe+="/"),fe=(fe+z).replace("//","/")),H={name:s(z),type:2},C.FileIndex.push(H),C.FullPaths.push(fe),B||it.utils.cfb_gc(C)}return H.content=D,H.size=D?D.length:0,F&&(F.CLSID&&(H.clsid=F.CLSID),F.mt&&(H.mt=F.mt),F.ct&&(H.ct=F.ct)),H}function sl(C,z){A(C);var D=it.find(C,z);if(D){for(var F=0;F<C.FileIndex.length;++F)if(C.FileIndex[F]==D)return C.FileIndex.splice(F,1),C.FullPaths.splice(F,1),!0}return!1}function xn(C,z,D){A(C);var F=it.find(C,z);if(F){for(var B=0;B<C.FileIndex.length;++B)if(C.FileIndex[B]==F)return C.FileIndex[B].name=s(D),C.FullPaths[B]=D,!0}return!1}function hi(C){q(C,!0)}return t.find=ne,t.read=L,t.parse=g,t.write=be,t.writeFile=xe,t.utils={cfb_new:nl,cfb_add:Ss,cfb_del:sl,cfb_mov:xn,cfb_gc:hi,ReadShift:pc,CheckField:z_,prep_blob:aa,bconcat:Xr,use_zlib:N,_deflateRaw:mt,_inflateRaw:tl,consts:ae},t})();function nA(e){return typeof e=="string"?Ku(e):Array.isArray(e)?Ok(e):e}function Xc(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Ku(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var a=r=="utf8"?jn(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(a,e);if(typeof Blob<"u"){var s=new Blob([nA(a)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var l=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(l)},6e4),chrome.downloads.download({url:l,filename:e,saveAs:!0});var c=document.createElement("a");if(c.download!=null)return c.download=e,c.href=l,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(l)},6e4),l}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var u=File(e);return u.open("w"),u.encoding="binary",Array.isArray(t)&&(t=li(t)),u.write(t),u.close(),t}catch(h){if(!h.message||!h.message.match(/onstruct/))throw h}throw new Error("cannot save file "+e)}function sA(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("Cannot access file "+e)}function wr(e){for(var t=Object.keys(e),r=[],a=0;a<t.length;++a)Object.prototype.hasOwnProperty.call(e,t[a])&&r.push(t[a]);return r}function Lv(e,t){for(var r=[],a=wr(e),s=0;s!==a.length;++s)r[e[a[s]][t]]==null&&(r[e[a[s]][t]]=a[s]);return r}function Ju(e){for(var t=[],r=wr(e),a=0;a!==r.length;++a)t[e[r[a]]]=r[a];return t}function Qu(e){for(var t=[],r=wr(e),a=0;a!==r.length;++a)t[e[r[a]]]=parseInt(r[a],10);return t}function iA(e){for(var t=[],r=wr(e),a=0;a!==r.length;++a)t[e[r[a]]]==null&&(t[e[r[a]]]=[]),t[e[r[a]]].push(r[a]);return t}var Bu=new Date(1899,11,30,0,0,0);function zr(e,t){var r=e.getTime(),a=Bu.getTime()+(e.getTimezoneOffset()-Bu.getTimezoneOffset())*6e4;return(r-a)/(1440*60*1e3)}var __=new Date,lA=Bu.getTime()+(__.getTimezoneOffset()-Bu.getTimezoneOffset())*6e4,Bv=__.getTimezoneOffset();function Zu(e){var t=new Date;return t.setTime(e*24*60*60*1e3+lA),t.getTimezoneOffset()!==Bv&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Bv)*6e4),t}function oA(e){var t=0,r=0,a=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var l=1;l!=s.length;++l)if(s[l]){switch(r=1,l>3&&(a=!0),s[l].slice(s[l].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[l].slice(s[l].length-1));case"D":r*=24;case"H":r*=60;case"M":if(a)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(s[l],10)}return t}var Iv=new Date("2017-02-19T19:06:09.000Z"),w_=isNaN(Iv.getFullYear())?new Date("2/19/17"):Iv,cA=w_.getFullYear()==2017;function ir(e,t){var r=new Date(e);if(cA)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(w_.getFullYear()==1917&&!isNaN(r.getFullYear())){var a=r.getFullYear();return e.indexOf(""+a)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],l=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(l=new Date(l.getTime()-l.getTimezoneOffset()*60*1e3)),l}function $i(e,t){if(wt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return jn(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return jn(o_(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return jn(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return jn(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(l){return r[l]||l})}catch{}for(var a=[],s=0;s!=e.length;++s)a.push(String.fromCharCode(e[s]));return a.join("")}function lr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=lr(e[r]));return t}function yr(e,t){for(var r="";r.length<t;)r+=e;return r}function An(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(a))||(a=a.replace(/[(](.*)[)]/,function(s,l){return r=-r,l}),!isNaN(t=Number(a)))?t/r:t}var uA=["january","february","march","april","may","june","july","august","september","october","november","december"];function oo(e){var t=new Date(e),r=new Date(NaN),a=t.getYear(),s=t.getMonth(),l=t.getDate();if(isNaN(l))return r;var c=e.toLowerCase();if(c.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(c=c.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),c.length>3&&uA.indexOf(c)==-1)return r}else if(c.match(/[a-z]/))return r;return a<0||a>8099?r:(s>0||l>1)&&a!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var fA=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,a,s){if(e||typeof a=="string")return r.split(a);for(var l=r.split(a),c=[l[0]],u=1;u<l.length;++u)c.push(s),c.push(l[u]);return c}})();function b_(e){return e?e.content&&e.type?$i(e.content,!0):e.data?fc(e.data):e.asNodeBuffer&&wt?fc(e.asNodeBuffer().toString("binary")):e.asBinary?fc(e.asBinary()):e._data&&e._data.getContent?fc($i(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function S_(e){if(!e)return null;if(e.data)return Tv(e.data);if(e.asNodeBuffer&&wt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?Tv(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function hA(e){return e&&e.name.slice(-4)===".bin"?S_(e):b_(e)}function hn(e,t){for(var r=e.FullPaths||wr(e.files),a=t.toLowerCase().replace(/[\/]/g,"\\"),s=a.replace(/\\/g,"/"),l=0;l<r.length;++l){var c=r[l].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==c||s==c)return e.files?e.files[r[l]]:e.FileIndex[l]}return null}function Sm(e,t){var r=hn(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Mr(e,t,r){if(!r)return hA(Sm(e,t));if(!t)return null;try{return Mr(e,t)}catch{return null}}function Ka(e,t,r){if(!r)return b_(Sm(e,t));if(!t)return null;try{return Ka(e,t)}catch{return null}}function dA(e,t,r){return S_(Sm(e,t))}function jv(e){for(var t=e.FullPaths||wr(e.files),r=[],a=0;a<t.length;++a)t[a].slice(-1)!="/"&&r.push(t[a].replace(/^Root Entry[\/]/,""));return r.sort()}function _t(e,t,r){if(e.FullPaths){if(typeof r=="string"){var a;return wt?a=xs(r):a=Rk(r),it.utils.cfb_add(e,t,a)}it.utils.cfb_add(e,t,r)}else e.file(t,r)}function Em(){return it.utils.cfb_new()}function E_(e,t){switch(t.type){case"base64":return it.read(e,{type:"base64"});case"binary":return it.read(e,{type:"binary"});case"buffer":case"array":return it.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function dc(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var a=e.split("/");a.length!==0;){var s=a.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var kr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,mA=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Uv=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,gA=/<[^>]*>/g,pa=kr.match(Uv)?Uv:gA,pA=/<\w*:/,xA=/<(\/?)\w+:/;function dt(e,t,r){for(var a={},s=0,l=0;s!==e.length&&!((l=e.charCodeAt(s))===32||l===10||l===13);++s);if(t||(a[0]=e.slice(0,s)),s===e.length)return a;var c=e.match(mA),u=0,h="",d=0,g="",x="",v=1;if(c)for(d=0;d!=c.length;++d){for(x=c[d],l=0;l!=x.length&&x.charCodeAt(l)!==61;++l);for(g=x.slice(0,l).trim();x.charCodeAt(l+1)==32;)++l;for(v=(s=x.charCodeAt(l+1))==34||s==39?1:0,h=x.slice(l+1+v,x.length-v),u=0;u!=g.length&&g.charCodeAt(u)!==58;++u);if(u===g.length)g.indexOf("_")>0&&(g=g.slice(0,g.indexOf("_"))),a[g]=h,a[g.toLowerCase()]=h;else{var _=(u===5&&g.slice(0,5)==="xmlns"?"xmlns":"")+g.slice(u+1);if(a[_]&&g.slice(u-3,u)=="ext")continue;a[_]=h,a[_.toLowerCase()]=h}}return a}function Un(e){return e.replace(xA,"<$1")}var T_={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Tm=Ju(T_),Ft=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(a){var s=a+"",l=s.indexOf("<![CDATA[");if(l==-1)return s.replace(e,function(u,h){return T_[u]||String.fromCharCode(parseInt(h,u.indexOf("x")>-1?16:10))||u}).replace(t,function(u,h){return String.fromCharCode(parseInt(h,16))});var c=s.indexOf("]]>");return r(s.slice(0,l))+s.slice(l+9,c)+r(s.slice(c+3))}})(),km=/[&<>'"]/g,vA=/[\u0000-\u0008\u000b-\u001f]/g;function $t(e){var t=e+"";return t.replace(km,function(r){return Tm[r]}).replace(vA,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Pv(e){return $t(e).replace(/ /g,"_x0020_")}var k_=/[\u0000-\u001f]/g;function Am(e){var t=e+"";return t.replace(km,function(r){return Tm[r]}).replace(/\n/g,"<br/>").replace(k_,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function yA(e){var t=e+"";return t.replace(km,function(r){return Tm[r]}).replace(k_,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var zv=(function(){var e=/&#(\d+);/g;function t(r,a){return String.fromCharCode(parseInt(a,10))}return function(a){return a.replace(e,t)}})();function _A(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function sr(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function kd(e){for(var t="",r=0,a=0,s=0,l=0,c=0,u=0;r<e.length;){if(a=e.charCodeAt(r++),a<128){t+=String.fromCharCode(a);continue}if(s=e.charCodeAt(r++),a>191&&a<224){c=(a&31)<<6,c|=s&63,t+=String.fromCharCode(c);continue}if(l=e.charCodeAt(r++),a<240){t+=String.fromCharCode((a&15)<<12|(s&63)<<6|l&63);continue}c=e.charCodeAt(r++),u=((a&7)<<18|(s&63)<<12|(l&63)<<6|c&63)-65536,t+=String.fromCharCode(55296+(u>>>10&1023)),t+=String.fromCharCode(56320+(u&1023))}return t}function Hv(e){var t=ri(2*e.length),r,a,s=1,l=0,c=0,u;for(a=0;a<e.length;a+=s)s=1,(u=e.charCodeAt(a))<128?r=u:u<224?(r=(u&31)*64+(e.charCodeAt(a+1)&63),s=2):u<240?(r=(u&15)*4096+(e.charCodeAt(a+1)&63)*64+(e.charCodeAt(a+2)&63),s=3):(s=4,r=(u&7)*262144+(e.charCodeAt(a+1)&63)*4096+(e.charCodeAt(a+2)&63)*64+(e.charCodeAt(a+3)&63),r-=65536,c=55296+(r>>>10&1023),r=56320+(r&1023)),c!==0&&(t[l++]=c&255,t[l++]=c>>>8,c=0),t[l++]=r%256,t[l++]=r>>>8;return t.slice(0,l).toString("ucs2")}function $v(e){return xs(e,"binary").toString("utf8")}var xu="foo bar baz",Yt=wt&&($v(xu)==kd(xu)&&$v||Hv(xu)==kd(xu)&&Hv)||kd,jn=wt?function(e){return xs(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,a=0,s=0;r<e.length;)switch(a=e.charCodeAt(r++),!0){case a<128:t.push(String.fromCharCode(a));break;case a<2048:t.push(String.fromCharCode(192+(a>>6))),t.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,s=e.charCodeAt(r++)-56320+(a<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(a>>12))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)))}return t.join("")},Fc=(function(){var e={};return function(r,a){var s=r+"|"+(a||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",a||"")}})(),A_=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var a=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)a=a.replace(e[s][0],e[s][1]);return a}})(),wA=(function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),bA=/<\/?(?:vt:)?variant>/g,SA=/<(?:vt:)([^>]*)>([\s\S]*)</;function Vv(e,t){var r=dt(e),a=e.match(wA(r.baseType))||[],s=[];if(a.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+a.length+" != "+r.size);return s}return a.forEach(function(l){var c=l.replace(bA,"").match(SA);c&&s.push({v:Yt(c[2]),t:c[1]})}),s}var C_=/(^\s|\s$|\n)/;function na(e,t){return"<"+e+(t.match(C_)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Mc(e){return wr(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Be(e,t,r){return"<"+e+(r!=null?Mc(r):"")+(t!=null?(t.match(C_)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Jd(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function EA(e,t){switch(typeof e){case"string":var r=Be("vt:lpwstr",$t(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Be((e|0)==e?"vt:i4":"vt:r8",$t(String(e)));case"boolean":return Be("vt:bool",e?"true":"false")}if(e instanceof Date)return Be("vt:filetime",Jd(e));throw new Error("Unable to serialize "+e)}function Cm(e){if(wt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Yt(li(_m(e)));throw new Error("Bad input format: expected Buffer or string")}var Lc=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Pr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Ki=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Va={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function TA(e,t){for(var r=1-2*(e[t+7]>>>7),a=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,l=5;l>=0;--l)s=s*256+e[t+l];return a==2047?s==0?r*(1/0):NaN:(a==0?a=-1022:(a-=1023,s+=Math.pow(2,52)),r*Math.pow(2,a-52)*s)}function kA(e,t,r){var a=(t<0||1/t==-1/0?1:0)<<7,s=0,l=0,c=a?-t:t;isFinite(c)?c==0?s=l=0:(s=Math.floor(Math.log(c)/Math.LN2),l=c*Math.pow(2,52-s),s<=-1023&&(!isFinite(l)||l<Math.pow(2,52))?s=-1022:(l-=Math.pow(2,52),s+=1023)):(s=2047,l=isNaN(t)?26985:0);for(var u=0;u<=5;++u,l/=256)e[r+u]=l&255;e[r+6]=(s&15)<<4|l&15,e[r+7]=s>>4|a}var Gv=function(e){for(var t=[],r=10240,a=0;a<e[0].length;++a)if(e[0][a])for(var s=0,l=e[0][a].length;s<l;s+=r)t.push.apply(t,e[0][a].slice(s,s+r));return t},qv=wt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:xs(t)})):Gv(e)}:Gv,Xv=function(e,t,r){for(var a=[],s=t;s<r;s+=2)a.push(String.fromCharCode(fs(e,s)));return a.join("").replace(wa,"")},Nm=wt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(wa,""):Xv(e,t,r)}:Xv,Wv=function(e,t,r){for(var a=[],s=t;s<t+r;++s)a.push(("0"+e[s].toString(16)).slice(-2));return a.join("")},N_=wt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Wv(e,t,r)}:Wv,Kv=function(e,t,r){for(var a=[],s=t;s<r;s++)a.push(String.fromCharCode(Ql(e,s)));return a.join("")},Wc=wt?function(t,r,a){return Buffer.isBuffer(t)?t.toString("utf8",r,a):Kv(t,r,a)}:Kv,O_=function(e,t){var r=Ga(e,t);return r>0?Wc(e,t+4,t+4+r-1):""},R_=O_,D_=function(e,t){var r=Ga(e,t);return r>0?Wc(e,t+4,t+4+r-1):""},F_=D_,M_=function(e,t){var r=2*Ga(e,t);return r>0?Wc(e,t+4,t+4+r-1):""},L_=M_,B_=function(t,r){var a=Ga(t,r);return a>0?Nm(t,r+4,r+4+a):""},I_=B_,j_=function(e,t){var r=Ga(e,t);return r>0?Wc(e,t+4,t+4+r):""},U_=j_,P_=function(e,t){return TA(e,t)},Iu=P_,Om=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};wt&&(R_=function(t,r){if(!Buffer.isBuffer(t))return O_(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},F_=function(t,r){if(!Buffer.isBuffer(t))return D_(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},L_=function(t,r){if(!Buffer.isBuffer(t))return M_(t,r);var a=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a-1)},I_=function(t,r){if(!Buffer.isBuffer(t))return B_(t,r);var a=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a)},U_=function(t,r){if(!Buffer.isBuffer(t))return j_(t,r);var a=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+a)},Iu=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):P_(t,r)},Om=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Ql=function(e,t){return e[t]},fs=function(e,t){return e[t+1]*256+e[t]},AA=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Ga=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Li=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},CA=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function pc(e,t){var r="",a,s,l=[],c,u,h,d;switch(t){case"dbcs":if(d=this.l,wt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(h=0;h<e;++h)r+=String.fromCharCode(fs(this,d)),d+=2;e*=2;break;case"utf8":r=Wc(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Nm(this,this.l,this.l+e);break;case"wstr":return pc.call(this,e,"dbcs");case"lpstr-ansi":r=R_(this,this.l),e=4+Ga(this,this.l);break;case"lpstr-cp":r=F_(this,this.l),e=4+Ga(this,this.l);break;case"lpwstr":r=L_(this,this.l),e=4+2*Ga(this,this.l);break;case"lpp4":e=4+Ga(this,this.l),r=I_(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Ga(this,this.l),r=U_(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(c=Ql(this,this.l+e++))!==0;)l.push(pu(c));r=l.join("");break;case"_wstr":for(e=0,r="";(c=fs(this,this.l+e))!==0;)l.push(pu(c)),e+=2;e+=2,r=l.join("");break;case"dbcs-cont":for(r="",d=this.l,h=0;h<e;++h){if(this.lens&&this.lens.indexOf(d)!==-1)return c=Ql(this,d),this.l=d+1,u=pc.call(this,e-h,c?"dbcs-cont":"sbcs-cont"),l.join("")+u;l.push(pu(fs(this,d))),d+=2}r=l.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",d=this.l,h=0;h!=e;++h){if(this.lens&&this.lens.indexOf(d)!==-1)return c=Ql(this,d),this.l=d+1,u=pc.call(this,e-h,c?"dbcs-cont":"sbcs-cont"),l.join("")+u;l.push(pu(Ql(this,d))),d+=1}r=l.join("");break;default:switch(e){case 1:return a=Ql(this,this.l),this.l++,a;case 2:return a=(t==="i"?AA:fs)(this,this.l),this.l+=2,a;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(a=(e>0?Li:CA)(this,this.l),this.l+=4,a):(s=Ga(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=Iu(this,this.l):s=Iu([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=N_(this,this.l,e);break}}return this.l+=e,r}var NA=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},OA=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},RA=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function DA(e,t,r){var a=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)RA(this,t.charCodeAt(s),this.l+2*s);a=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;a=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var l=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var c=t.charCodeAt(s);this[this.l++]=c&255,this[this.l++]=c>>8}for(;this.l<l;)this[this.l++]=0;return this}else switch(e){case 1:a=1,this[this.l]=t&255;break;case 2:a=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:a=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:a=4,NA(this,t,this.l);break;case 8:if(a=8,r==="f"){kA(this,t,this.l);break}case 16:break;case-4:a=4,OA(this,t,this.l);break}return this.l+=a,this}function z_(e,t){var r=N_(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function aa(e,t){e.l=t,e.read_shift=pc,e.chk=z_,e.write_shift=DA}function ga(e,t){e.l+=t}function ye(e){var t=ri(e);return aa(t,0),t}function vs(e,t,r){if(e){var a,s,l;aa(e,e.l||0);for(var c=e.length,u=0,h=0;e.l<c;){u=e.read_shift(1),u&128&&(u=(u&127)+((e.read_shift(1)&127)<<7));var d=zc[u]||zc[65535];for(a=e.read_shift(1),l=a&127,s=1;s<4&&a&128;++s)l+=((a=e.read_shift(1))&127)<<7*s;h=e.l+l;var g=d.f&&d.f(e,l,r);if(e.l=h,t(g,d,u))return}}}function Da(){var e=[],t=wt?256:2048,r=function(d){var g=ye(d);return aa(g,0),g},a=r(t),s=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&e.push(a),a=null)},l=function(d){return a&&d<a.length-a.l?a:(s(),a=r(Math.max(d+1,t)))},c=function(){return s(),Xr(e)},u=function(d){s(),a=d,a.l==null&&(a.l=a.length),l(t)};return{next:l,push:u,end:c,_bufs:e}}function Ce(e,t,r,a){var s=+t,l;if(!isNaN(s)){a||(a=zc[s].p||(r||[]).length||0),l=1+(s>=128?1:0)+1,a>=128&&++l,a>=16384&&++l,a>=2097152&&++l;var c=e.next(l);s<=127?c.write_shift(1,s):(c.write_shift(1,(s&127)+128),c.write_shift(1,s>>7));for(var u=0;u!=4;++u)if(a>=128)c.write_shift(1,(a&127)+128),a>>=7;else{c.write_shift(1,a);break}a>0&&Om(r)&&e.push(r)}}function xc(e,t,r){var a=lr(e);if(t.s?(a.cRel&&(a.c+=t.s.c),a.rRel&&(a.r+=t.s.r)):(a.cRel&&(a.c+=t.c),a.rRel&&(a.r+=t.r)),!r||r.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function Yv(e,t,r){var a=lr(e);return a.s=xc(a.s,t.s,r),a.e=xc(a.e,t.s,r),a}function vc(e,t){if(e.cRel&&e.c<0)for(e=lr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=lr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=ht(e);return!e.cRel&&e.cRel!=null&&(r=LA(r)),!e.rRel&&e.rRel!=null&&(r=FA(r)),r}function Ad(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+dr(e.s.c)+":"+(e.e.cRel?"":"$")+dr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Tr(e.s.r)+":"+(e.e.rRel?"":"$")+Tr(e.e.r):vc(e.s,t.biff)+":"+vc(e.e,t.biff)}function Rm(e){return parseInt(MA(e),10)-1}function Tr(e){return""+(e+1)}function FA(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function MA(e){return e.replace(/\$(\d+)$/,"$1")}function Dm(e){for(var t=BA(e),r=0,a=0;a!==t.length;++a)r=26*r+t.charCodeAt(a)-64;return r-1}function dr(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function LA(e){return e.replace(/^([A-Z])/,"$$$1")}function BA(e){return e.replace(/^\$([A-Z])/,"$1")}function IA(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function mr(e){for(var t=0,r=0,a=0;a<e.length;++a){var s=e.charCodeAt(a);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function ht(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Fa(e){var t=e.indexOf(":");return t==-1?{s:mr(e),e:mr(e)}:{s:mr(e.slice(0,t)),e:mr(e.slice(t+1))}}function vt(e,t){return typeof t>"u"||typeof t=="number"?vt(e.s,e.e):(typeof e!="string"&&(e=ht(e)),typeof t!="string"&&(t=ht(t)),e==t?e:e+":"+t)}function Mt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,a=0,s=0,l=e.length;for(r=0;a<l&&!((s=e.charCodeAt(a)-64)<1||s>26);++a)r=26*r+s;for(t.s.c=--r,r=0;a<l&&!((s=e.charCodeAt(a)-48)<0||s>9);++a)r=10*r+s;if(t.s.r=--r,a===l||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++a,r=0;a!=l&&!((s=e.charCodeAt(a)-64)<1||s>26);++a)r=26*r+s;for(t.e.c=--r,r=0;a!=l&&!((s=e.charCodeAt(a)-48)<0||s>9);++a)r=10*r+s;return t.e.r=--r,t}function Jv(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=gn(e.z,r?zr(t):t)}catch{}try{return e.w=gn((e.XF||{}).numFmtId||(r?14:0),r?zr(t):t)}catch{return""+t}}function gs(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?ys[e.v]||e.v:t==null?Jv(e,e.v):Jv(e,t))}function oi(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",a={};return a[r]=e,{SheetNames:[r],Sheets:a}}function H_(e,t,r){var a=r||{},s=e?Array.isArray(e):a.dense,l=e||(s?[]:{}),c=0,u=0;if(l&&a.origin!=null){if(typeof a.origin=="number")c=a.origin;else{var h=typeof a.origin=="string"?mr(a.origin):a.origin;c=h.r,u=h.c}l["!ref"]||(l["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(l["!ref"]){var g=Mt(l["!ref"]);d.s.c=g.s.c,d.s.r=g.s.r,d.e.c=Math.max(d.e.c,g.e.c),d.e.r=Math.max(d.e.r,g.e.r),c==-1&&(d.e.r=c=g.e.r+1)}for(var x=0;x!=t.length;++x)if(t[x]){if(!Array.isArray(t[x]))throw new Error("aoa_to_sheet expects an array of arrays");for(var v=0;v!=t[x].length;++v)if(!(typeof t[x][v]>"u")){var _={v:t[x][v]},b=c+x,y=u+v;if(d.s.r>b&&(d.s.r=b),d.s.c>y&&(d.s.c=y),d.e.r<b&&(d.e.r=b),d.e.c<y&&(d.e.c=y),t[x][v]&&typeof t[x][v]=="object"&&!Array.isArray(t[x][v])&&!(t[x][v]instanceof Date))_=t[x][v];else if(Array.isArray(_.v)&&(_.f=t[x][v][1],_.v=_.v[0]),_.v===null)if(_.f)_.t="n";else if(a.nullError)_.t="e",_.v=0;else if(a.sheetStubs)_.t="z";else continue;else typeof _.v=="number"?_.t="n":typeof _.v=="boolean"?_.t="b":_.v instanceof Date?(_.z=a.dateNF||ft[14],a.cellDates?(_.t="d",_.w=gn(_.z,zr(_.v))):(_.t="n",_.v=zr(_.v),_.w=gn(_.z,_.v))):_.t="s";if(s)l[b]||(l[b]=[]),l[b][y]&&l[b][y].z&&(_.z=l[b][y].z),l[b][y]=_;else{var S=ht({c:y,r:b});l[S]&&l[S].z&&(_.z=l[S].z),l[S]=_}}}return d.s.c<1e7&&(l["!ref"]=vt(d)),l}function go(e,t){return H_(null,e,t)}function jA(e){return e.read_shift(4,"i")}function Cn(e,t){return t||(t=ye(4)),t.write_shift(4,e),t}function ma(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Wr(e,t){var r=!1;return t==null&&(r=!0,t=ye(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function UA(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function PA(e,t){return t||(t=ye(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Fm(e,t){var r=e.l,a=e.read_shift(1),s=ma(e),l=[],c={t:s,h:s};if((a&1)!==0){for(var u=e.read_shift(4),h=0;h!=u;++h)l.push(UA(e));c.r=l}else c.r=[{ich:0,ifnt:0}];return e.l=r+t,c}function zA(e,t){var r=!1;return t==null&&(r=!0,t=ye(15+4*e.t.length)),t.write_shift(1,0),Wr(e.t,t),r?t.slice(0,t.l):t}var HA=Fm;function $A(e,t){var r=!1;return t==null&&(r=!0,t=ye(23+4*e.t.length)),t.write_shift(1,1),Wr(e.t,t),t.write_shift(4,1),PA({},t),r?t.slice(0,t.l):t}function pn(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Yi(e,t){return t==null&&(t=ye(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Ji(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Qi(e,t){return t==null&&(t=ye(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var VA=ma,$_=Wr;function Mm(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function ju(e,t){var r=!1;return t==null&&(r=!0,t=ye(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var GA=ma,Qd=Mm,Lm=ju;function Bm(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,a=t[0]&2;e.l+=4;var s=a===0?Iu([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Li(t,0)>>2;return r?s/100:s}function V_(e,t){t==null&&(t=ye(4));var r=0,a=0,s=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?a=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(a=1,r=1),a)t.write_shift(-4,((r?s:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function G_(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function qA(e,t){return t||(t=ye(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Zi=G_,po=qA;function da(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Vi(e,t){return(t||ye(8)).write_shift(8,e,"f")}function XA(e){var t={},r=e.read_shift(1),a=r>>>1,s=e.read_shift(1),l=e.read_shift(2,"i"),c=e.read_shift(1),u=e.read_shift(1),h=e.read_shift(1);switch(e.l++,a){case 0:t.auto=1;break;case 1:t.index=s;var d=ji[s];d&&(t.rgb=Ic(d));break;case 2:t.rgb=Ic([c,u,h]);break;case 3:t.theme=s;break}return l!=0&&(t.tint=l>0?l/32767:l/32768),t}function Uu(e,t){if(t||(t=ye(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var a=e.rgb||"FFFFFF";typeof a=="number"&&(a=("000000"+a.toString(16)).slice(-6)),t.write_shift(1,parseInt(a.slice(0,2),16)),t.write_shift(1,parseInt(a.slice(2,4),16)),t.write_shift(1,parseInt(a.slice(4,6),16)),t.write_shift(1,255)}return t}function WA(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function KA(e,t){t||(t=ye(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function q_(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},a=e.read_shift(4);switch(a){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(a>400)throw new Error("Unsupported Clipboard: "+a.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function YA(e){return q_(e,1)}function JA(e){return q_(e,2)}var Im=2,Ra=3,vu=11,Qv=12,Pu=19,yu=64,QA=65,ZA=71,e3=4108,t3=4126,qr=80,X_=81,r3=[qr,X_],Zd={1:{n:"CodePage",t:Im},2:{n:"Category",t:qr},3:{n:"PresentationFormat",t:qr},4:{n:"ByteCount",t:Ra},5:{n:"LineCount",t:Ra},6:{n:"ParagraphCount",t:Ra},7:{n:"SlideCount",t:Ra},8:{n:"NoteCount",t:Ra},9:{n:"HiddenCount",t:Ra},10:{n:"MultimediaClipCount",t:Ra},11:{n:"ScaleCrop",t:vu},12:{n:"HeadingPairs",t:e3},13:{n:"TitlesOfParts",t:t3},14:{n:"Manager",t:qr},15:{n:"Company",t:qr},16:{n:"LinksUpToDate",t:vu},17:{n:"CharacterCount",t:Ra},19:{n:"SharedDoc",t:vu},22:{n:"HyperlinksChanged",t:vu},23:{n:"AppVersion",t:Ra,p:"version"},24:{n:"DigSig",t:QA},26:{n:"ContentType",t:qr},27:{n:"ContentStatus",t:qr},28:{n:"Language",t:qr},29:{n:"Version",t:qr},255:{},2147483648:{n:"Locale",t:Pu},2147483651:{n:"Behavior",t:Pu},1919054434:{}},em={1:{n:"CodePage",t:Im},2:{n:"Title",t:qr},3:{n:"Subject",t:qr},4:{n:"Author",t:qr},5:{n:"Keywords",t:qr},6:{n:"Comments",t:qr},7:{n:"Template",t:qr},8:{n:"LastAuthor",t:qr},9:{n:"RevNumber",t:qr},10:{n:"EditTime",t:yu},11:{n:"LastPrinted",t:yu},12:{n:"CreatedDate",t:yu},13:{n:"ModifiedDate",t:yu},14:{n:"PageCount",t:Ra},15:{n:"WordCount",t:Ra},16:{n:"CharCount",t:Ra},17:{n:"Thumbnail",t:ZA},18:{n:"Application",t:qr},19:{n:"DocSecurity",t:Ra},255:{},2147483648:{n:"Locale",t:Pu},2147483651:{n:"Behavior",t:Pu},1919054434:{}},Zv={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},a3=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function n3(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var s3=n3([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),ji=lr(s3),ys={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},W_={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},tm={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},_u={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function jm(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function i3(e){var t=jm();if(!e||!e.match)return t;var r={};if((e.match(pa)||[]).forEach(function(a){var s=dt(a);switch(s[0].replace(pA,"<")){case"<?xml":break;case"<Types":t.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":t[tm[s.ContentType]]!==void 0&&t[tm[s.ContentType]].push(s.PartName);break}}),t.xmlns!==Pr.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function K_(e,t){var r=iA(tm),a=[],s;a[a.length]=kr,a[a.length]=Be("Types",null,{xmlns:Pr.CT,"xmlns:xsd":Pr.xsd,"xmlns:xsi":Pr.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(h){return Be("Default",null,{Extension:h[0],ContentType:h[1]})}));var l=function(h){e[h]&&e[h].length>0&&(s=e[h][0],a[a.length]=Be("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:_u[h][t.bookType]||_u[h].xlsx}))},c=function(h){(e[h]||[]).forEach(function(d){a[a.length]=Be("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:_u[h][t.bookType]||_u[h].xlsx})})},u=function(h){(e[h]||[]).forEach(function(d){a[a.length]=Be("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:r[h][0]})})};return l("workbooks"),c("sheets"),c("charts"),u("themes"),["strs","styles"].forEach(l),["coreprops","extprops","custprops"].forEach(u),u("vba"),u("comments"),u("threadedcomments"),u("drawings"),c("metadata"),u("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var St={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Bc(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function yc(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var a={};return(e.match(pa)||[]).forEach(function(s){var l=dt(s);if(l[0]==="<Relationship"){var c={};c.Type=l.Type,c.Target=l.Target,c.Id=l.Id,l.TargetMode&&(c.TargetMode=l.TargetMode);var u=l.TargetMode==="External"?l.Target:dc(l.Target,t);r[u]=c,a[l.Id]=c}}),r["!id"]=a,r}function ao(e){var t=[kr,Be("Relationships",null,{xmlns:Pr.RELS})];return wr(e["!id"]).forEach(function(r){t[t.length]=Be("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Ht(e,t,r,a,s,l){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,s.Id="rId"+t,s.Type=a,s.Target=r,[St.HLINK,St.XPATH,St.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,t}var l3="application/vnd.oasis.opendocument.spreadsheet";function o3(e,t){for(var r=Cm(e),a,s;a=Lc.exec(r);)switch(a[3]){case"manifest":break;case"file-entry":if(s=dt(a[0],!1),s.path=="/"&&s.type!==l3)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw a}}function c3(e){var t=[kr];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function ey(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function u3(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function f3(e){var t=[kr];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(ey(e[r][0],e[r][1])),t.push(u3("",e[r][0]));return t.push(ey("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function Y_(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Du.version+"</meta:generator></office:meta></office:document-meta>"}var mn=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],h3=(function(){for(var e=new Array(mn.length),t=0;t<mn.length;++t){var r=mn[t],a="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return e})();function J_(e){var t={};e=Yt(e);for(var r=0;r<mn.length;++r){var a=mn[r],s=e.match(h3[r]);s!=null&&s.length>0&&(t[a[1]]=Ft(s[1])),a[2]==="date"&&t[a[1]]&&(t[a[1]]=ir(t[a[1]]))}return t}function Cd(e,t,r,a,s){s[e]!=null||t==null||t===""||(s[e]=t,t=$t(t),a[a.length]=r?Be(e,t,r):na(e,t))}function Q_(e,t){var r=t||{},a=[kr,Be("cp:coreProperties",null,{"xmlns:cp":Pr.CORE_PROPS,"xmlns:dc":Pr.dc,"xmlns:dcterms":Pr.dcterms,"xmlns:dcmitype":Pr.dcmitype,"xmlns:xsi":Pr.xsi})],s={};if(!e&&!r.Props)return a.join("");e&&(e.CreatedDate!=null&&Cd("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Jd(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,s),e.ModifiedDate!=null&&Cd("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Jd(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,s));for(var l=0;l!=mn.length;++l){var c=mn[l],u=r.Props&&r.Props[c[1]]!=null?r.Props[c[1]]:e?e[c[1]]:null;u===!0?u="1":u===!1?u="0":typeof u=="number"&&(u=String(u)),u!=null&&Cd(c[0],u,null,a,s)}return a.length>2&&(a[a.length]="</cp:coreProperties>",a[1]=a[1].replace("/>",">")),a.join("")}var Ui=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Z_=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function e2(e,t,r,a){var s=[];if(typeof e=="string")s=Vv(e,a);else for(var l=0;l<e.length;++l)s=s.concat(e[l].map(function(g){return{v:g}}));var c=typeof t=="string"?Vv(t,a).map(function(g){return g.v}):t,u=0,h=0;if(c.length>0)for(var d=0;d!==s.length;d+=2){switch(h=+s[d+1].v,s[d].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=h,r.SheetNames=c.slice(u,u+h);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=h,r.DefinedNames=c.slice(u,u+h);break;case"Charts":case"Diagramme":r.Chartsheets=h,r.ChartNames=c.slice(u,u+h);break}u+=h}}function d3(e,t,r){var a={};return t||(t={}),e=Yt(e),Ui.forEach(function(s){var l=(e.match(Fc(s[0]))||[])[1];switch(s[2]){case"string":l&&(t[s[1]]=Ft(l));break;case"bool":t[s[1]]=l==="true";break;case"raw":var c=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));c&&c.length>0&&(a[s[1]]=c[1]);break}}),a.HeadingPairs&&a.TitlesOfParts&&e2(a.HeadingPairs,a.TitlesOfParts,t,r),t}function t2(e){var t=[],r=Be;return e||(e={}),e.Application="SheetJS",t[t.length]=kr,t[t.length]=Be("Properties",null,{xmlns:Pr.EXT_PROPS,"xmlns:vt":Pr.vt}),Ui.forEach(function(a){if(e[a[1]]!==void 0){var s;switch(a[2]){case"string":s=$t(String(e[a[1]]));break;case"bool":s=e[a[1]]?"true":"false";break}s!==void 0&&(t[t.length]=r(a[0],s))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(a){return"<vt:lpstr>"+$t(a)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var m3=/<[^>]+>[^<]*/g;function g3(e,t){var r={},a="",s=e.match(m3);if(s)for(var l=0;l!=s.length;++l){var c=s[l],u=dt(c);switch(u[0]){case"<?xml":break;case"<Properties":break;case"<property":a=Ft(u.name);break;case"</property>":a=null;break;default:if(c.indexOf("<vt:")===0){var h=c.split(">"),d=h[0].slice(4),g=h[1];switch(d){case"lpstr":case"bstr":case"lpwstr":r[a]=Ft(g);break;case"bool":r[a]=sr(g);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[a]=parseInt(g,10);break;case"r4":case"r8":case"decimal":r[a]=parseFloat(g);break;case"filetime":case"date":r[a]=ir(g);break;case"cy":case"error":r[a]=Ft(g);break;default:if(d.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",c,d,h)}}else if(c.slice(0,2)!=="</"){if(t.WTF)throw new Error(c)}}}return r}function r2(e){var t=[kr,Be("Properties",null,{xmlns:Pr.CUST_PROPS,"xmlns:vt":Pr.vt})];if(!e)return t.join("");var r=1;return wr(e).forEach(function(s){++r,t[t.length]=Be("property",EA(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:$t(s)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var rm={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Nd;function p3(e,t,r){Nd||(Nd=Ju(rm)),t=Nd[t]||t,e[t]=r}function x3(e,t){var r=[];return wr(rm).map(function(a){for(var s=0;s<mn.length;++s)if(mn[s][1]==a)return mn[s];for(s=0;s<Ui.length;++s)if(Ui[s][1]==a)return Ui[s];throw a}).forEach(function(a){if(e[a[1]]!=null){var s=t&&t.Props&&t.Props[a[1]]!=null?t.Props[a[1]]:e[a[1]];a[2]==="date"&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"Z")),typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(na(rm[a[1]]||a[1],s))}}),Be("DocumentProperties",r.join(""),{xmlns:Va.o})}function v3(e,t){var r=["Worksheets","SheetNames"],a="CustomDocumentProperties",s=[];return e&&wr(e).forEach(function(l){if(Object.prototype.hasOwnProperty.call(e,l)){for(var c=0;c<mn.length;++c)if(l==mn[c][1])return;for(c=0;c<Ui.length;++c)if(l==Ui[c][1])return;for(c=0;c<r.length;++c)if(l==r[c])return;var u=e[l],h="string";typeof u=="number"?(h="float",u=String(u)):u===!0||u===!1?(h="boolean",u=u?"1":"0"):u=String(u),s.push(Be(Pv(l),u,{"dt:dt":h}))}}),t&&wr(t).forEach(function(l){if(Object.prototype.hasOwnProperty.call(t,l)&&!(e&&Object.prototype.hasOwnProperty.call(e,l))){var c=t[l],u="string";typeof c=="number"?(u="float",c=String(c)):c===!0||c===!1?(u="boolean",c=c?"1":"0"):c instanceof Date?(u="dateTime.tz",c=c.toISOString()):c=String(c),s.push(Be(Pv(l),c,{"dt:dt":u}))}}),"<"+a+' xmlns="'+Va.o+'">'+s.join("")+"</"+a+">"}function Um(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function y3(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,a=r%Math.pow(2,32),s=(r-a)/Math.pow(2,32);a*=1e7,s*=1e7;var l=a/Math.pow(2,32)|0;l>0&&(a=a%Math.pow(2,32),s+=l);var c=ye(8);return c.write_shift(4,a),c.write_shift(4,s),c}function a2(e,t,r){var a=e.l,s=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-a&3;)++e.l;return s}function n2(e,t,r){var a=e.read_shift(0,"lpwstr");return a}function s2(e,t,r){return t===31?n2(e):a2(e,t,r)}function am(e,t,r){return s2(e,t,r===!1?0:4)}function _3(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return s2(e,t,0)}function w3(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a){var s=e.l;r[a]=e.read_shift(0,"lpwstr").replace(wa,""),e.l-s&2&&(e.l+=2)}return r}function b3(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a)r[a]=e.read_shift(0,"lpstr-cp").replace(wa,"");return r}function S3(e){var t=e.l,r=zu(e,X_);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var a=zu(e,Ra);return[r,a]}function E3(e){for(var t=e.read_shift(4),r=[],a=0;a<t/2;++a)r.push(S3(e));return r}function ty(e,t){for(var r=e.read_shift(4),a={},s=0;s!=r;++s){var l=e.read_shift(4),c=e.read_shift(4);a[l]=e.read_shift(c,t===1200?"utf16le":"utf8").replace(wa,"").replace(hc,"!"),t===1200&&c%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),a}function i2(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function T3(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function zu(e,t,r){var a=e.read_shift(2),s,l=r||{};if(e.l+=2,t!==Qv&&a!==t&&r3.indexOf(t)===-1&&!((t&65534)==4126&&(a&65534)==4126))throw new Error("Expected type "+t+" saw "+a);switch(t===Qv?a:t){case 2:return s=e.read_shift(2,"i"),l.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return a2(e,a,4).replace(wa,"");case 31:return n2(e);case 64:return Um(e);case 65:return i2(e);case 71:return T3(e);case 80:return am(e,a,!l.raw).replace(wa,"");case 81:return _3(e,a).replace(wa,"");case 4108:return E3(e);case 4126:case 4127:return a==4127?w3(e):b3(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+a)}}function ry(e,t){var r=ye(4),a=ye(4);switch(r.write_shift(4,e==80?31:e),e){case 3:a.write_shift(-4,t);break;case 5:a=ye(8),a.write_shift(8,t,"f");break;case 11:a.write_shift(4,t?1:0);break;case 64:a=y3(t);break;case 31:case 80:for(a=ye(4+2*(t.length+1)+(t.length%2?0:2)),a.write_shift(4,t.length+1),a.write_shift(0,t,"dbcs");a.l!=a.length;)a.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Xr([r,a])}function ay(e,t){var r=e.l,a=e.read_shift(4),s=e.read_shift(4),l=[],c=0,u=0,h=-1,d={};for(c=0;c!=s;++c){var g=e.read_shift(4),x=e.read_shift(4);l[c]=[g,x+r]}l.sort(function(R,T){return R[1]-T[1]});var v={};for(c=0;c!=s;++c){if(e.l!==l[c][1]){var _=!0;if(c>0&&t)switch(t[l[c-1][0]].t){case 2:e.l+2===l[c][1]&&(e.l+=2,_=!1);break;case 80:e.l<=l[c][1]&&(e.l=l[c][1],_=!1);break;case 4108:e.l<=l[c][1]&&(e.l=l[c][1],_=!1);break}if((!t||c==0)&&e.l<=l[c][1]&&(_=!1,e.l=l[c][1]),_)throw new Error("Read Error: Expected address "+l[c][1]+" at "+e.l+" :"+c)}if(t){var b=t[l[c][0]];if(v[b.n]=zu(e,b.t,{raw:!0}),b.p==="version"&&(v[b.n]=String(v[b.n]>>16)+"."+("0000"+String(v[b.n]&65535)).slice(-4)),b.n=="CodePage")switch(v[b.n]){case 0:v[b.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Tn(u=v[b.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+v[b.n])}}else if(l[c][0]===1){if(u=v.CodePage=zu(e,Im),Tn(u),h!==-1){var y=e.l;e.l=l[h][1],d=ty(e,u),e.l=y}}else if(l[c][0]===0){if(u===0){h=c,e.l=l[c+1][1];continue}d=ty(e,u)}else{var S=d[l[c][0]],k;switch(e[e.l]){case 65:e.l+=4,k=i2(e);break;case 30:e.l+=4,k=am(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,k=am(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,k=e.read_shift(4,"i");break;case 19:e.l+=4,k=e.read_shift(4);break;case 5:e.l+=4,k=e.read_shift(8,"f");break;case 11:e.l+=4,k=Er(e,4);break;case 64:e.l+=4,k=ir(Um(e));break;default:throw new Error("unparsed value: "+e[e.l])}v[S]=k}}return e.l=r+a,v}var l2=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function k3(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function ny(e,t,r){var a=ye(8),s=[],l=[],c=8,u=0,h=ye(8),d=ye(8);if(h.write_shift(4,2),h.write_shift(4,1200),d.write_shift(4,1),l.push(h),s.push(d),c+=8+h.length,!t){d=ye(8),d.write_shift(4,0),s.unshift(d);var g=[ye(4)];for(g[0].write_shift(4,e.length),u=0;u<e.length;++u){var x=e[u][0];for(h=ye(8+2*(x.length+1)+(x.length%2?0:2)),h.write_shift(4,u+2),h.write_shift(4,x.length+1),h.write_shift(0,x,"dbcs");h.l!=h.length;)h.write_shift(1,0);g.push(h)}h=Xr(g),l.unshift(h),c+=8+h.length}for(u=0;u<e.length;++u)if(!(t&&!t[e[u][0]])&&!(l2.indexOf(e[u][0])>-1||Z_.indexOf(e[u][0])>-1)&&e[u][1]!=null){var v=e[u][1],_=0;if(t){_=+t[e[u][0]];var b=r[_];if(b.p=="version"&&typeof v=="string"){var y=v.split(".");v=(+y[0]<<16)+(+y[1]||0)}h=ry(b.t,v)}else{var S=k3(v);S==-1&&(S=31,v=String(v)),h=ry(S,v)}l.push(h),d=ye(8),d.write_shift(4,t?_:2+u),s.push(d),c+=8+h.length}var k=8*(l.length+1);for(u=0;u<l.length;++u)s[u].write_shift(4,k),k+=l[u].length;return a.write_shift(4,c),a.write_shift(4,l.length),Xr([a].concat(s).concat(l))}function sy(e,t,r){var a=e.content;if(!a)return{};aa(a,0);var s,l,c,u,h=0;a.chk("feff","Byte Order: "),a.read_shift(2);var d=a.read_shift(4),g=a.read_shift(16);if(g!==it.utils.consts.HEADER_CLSID&&g!==r)throw new Error("Bad PropertySet CLSID "+g);if(s=a.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(l=a.read_shift(16),u=a.read_shift(4),s===1&&u!==a.l)throw new Error("Length mismatch: "+u+" !== "+a.l);s===2&&(c=a.read_shift(16),h=a.read_shift(4));var x=ay(a,t),v={SystemIdentifier:d};for(var _ in x)v[_]=x[_];if(v.FMTID=l,s===1)return v;if(h-a.l==2&&(a.l+=2),a.l!==h)throw new Error("Length mismatch 2: "+a.l+" !== "+h);var b;try{b=ay(a,null)}catch{}for(_ in b)v[_]=b[_];return v.FMTID=[l,c],v}function iy(e,t,r,a,s,l){var c=ye(s?68:48),u=[c];c.write_shift(2,65534),c.write_shift(2,0),c.write_shift(4,842412599),c.write_shift(16,it.utils.consts.HEADER_CLSID,"hex"),c.write_shift(4,s?2:1),c.write_shift(16,t,"hex"),c.write_shift(4,s?68:48);var h=ny(e,r,a);if(u.push(h),s){var d=ny(s,null,null);c.write_shift(16,l,"hex"),c.write_shift(4,68+h.length),u.push(d)}return Xr(u)}function Ws(e,t){return e.read_shift(t),null}function A3(e,t){t||(t=ye(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function C3(e,t,r){for(var a=[],s=e.l+t;e.l<s;)a.push(r(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return a}function Er(e,t){return e.read_shift(t)===1}function _a(e,t){return t||(t=ye(2)),t.write_shift(2,+!!e),t}function Lr(e){return e.read_shift(2,"u")}function dn(e,t){return t||(t=ye(2)),t.write_shift(2,e),t}function o2(e,t){return C3(e,t,Lr)}function N3(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function c2(e,t,r){return r||(r=ye(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function Kc(e,t,r){var a=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var l=e.read_shift(1);l&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var c=a?e.read_shift(a,s):"";return c}function O3(e){var t=e.read_shift(2),r=e.read_shift(1),a=r&4,s=r&8,l=1+(r&1),c=0,u,h={};s&&(c=e.read_shift(2)),a&&(u=e.read_shift(4));var d=l==2?"dbcs-cont":"sbcs-cont",g=t===0?"":e.read_shift(t,d);return s&&(e.l+=4*c),a&&(e.l+=u),h.t=g,s||(h.raw="<t>"+h.t+"</t>",h.r=h.t),h}function R3(e){var t=e.t||"",r=ye(3);r.write_shift(2,t.length),r.write_shift(1,1);var a=ye(2*t.length);a.write_shift(2*t.length,t,"utf16le");var s=[r,a];return Xr(s)}function Gi(e,t,r){var a;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?a=e.read_shift(t,"sbcs-cont"):a=e.read_shift(t,"dbcs-cont"),a}function Yc(e,t,r){var a=e.read_shift(r&&r.biff==2?1:2);return a===0?(e.l++,""):Gi(e,a,r)}function el(e,t,r){if(r.biff>5)return Yc(e,t,r);var a=e.read_shift(1);return a===0?(e.l++,""):e.read_shift(a,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function u2(e,t,r){return r||(r=ye(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function D3(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function F3(e){var t=e.read_shift(4),r=e.l,a=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(a=!0),e.l=r);var s=e.read_shift((a?t-24:t)>>1,"utf16le").replace(wa,"");return a&&(e.l+=24),s}function M3(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var a=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return r+a.replace(/\\/g,"/");var l=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var c=e.read_shift(l>>1,"utf16le").replace(wa,"");return r+c}function L3(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return F3(e);case"0303000000000000c000000000000046":return M3(e);default:throw new Error("Unsupported Moniker "+r)}}function wu(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(wa,""):"";return r}function ly(e,t){t||(t=ye(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function B3(e,t){var r=e.l+t,a=e.read_shift(4);if(a!==2)throw new Error("Unrecognized streamVersion: "+a);var s=e.read_shift(2);e.l+=2;var l,c,u,h,d="",g,x;s&16&&(l=wu(e,r-e.l)),s&128&&(c=wu(e,r-e.l)),(s&257)===257&&(u=wu(e,r-e.l)),(s&257)===1&&(h=L3(e,r-e.l)),s&8&&(d=wu(e,r-e.l)),s&32&&(g=e.read_shift(16)),s&64&&(x=Um(e)),e.l=r;var v=c||u||h||"";v&&d&&(v+="#"+d),v||(v="#"+d),s&2&&v.charAt(0)=="/"&&v.charAt(1)!="/"&&(v="file://"+v);var _={Target:v};return g&&(_.guid=g),x&&(_.time=x),l&&(_.Tooltip=l),_}function I3(e){var t=ye(512),r=0,a=e.Target;a.slice(0,7)=="file://"&&(a=a.slice(7));var s=a.indexOf("#"),l=s>-1?31:23;switch(a.charAt(0)){case"#":l=28;break;case".":l&=-3;break}t.write_shift(4,2),t.write_shift(4,l);var c=[8,6815827,6619237,4849780,83];for(r=0;r<c.length;++r)t.write_shift(4,c[r]);if(l==28)a=a.slice(1),ly(a,t);else if(l&2){for(c="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<c.length;++r)t.write_shift(1,parseInt(c[r],16));var u=s>-1?a.slice(0,s):a;for(t.write_shift(4,2*(u.length+1)),r=0;r<u.length;++r)t.write_shift(2,u.charCodeAt(r));t.write_shift(2,0),l&8&&ly(s>-1?a.slice(s+1):"",t)}else{for(c="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<c.length;++r)t.write_shift(1,parseInt(c[r],16));for(var h=0;a.slice(h*3,h*3+3)=="../"||a.slice(h*3,h*3+3)=="..\\";)++h;for(t.write_shift(2,h),t.write_shift(4,a.length-3*h+1),r=0;r<a.length-3*h;++r)t.write_shift(1,a.charCodeAt(r+3*h)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function f2(e){var t=e.read_shift(1),r=e.read_shift(1),a=e.read_shift(1),s=e.read_shift(1);return[t,r,a,s]}function h2(e,t){var r=f2(e);return r[3]=0,r}function Pn(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return{r:t,c:r,ixfe:a}}function qi(e,t,r,a){return a||(a=ye(6)),a.write_shift(2,e),a.write_shift(2,t),a.write_shift(2,r||0),a}function j3(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function U3(e,t,r){return t===0?"":el(e,t,r)}function P3(e,t,r){var a=r.biff>8?4:2,s=e.read_shift(a),l=e.read_shift(a,"i"),c=e.read_shift(a,"i");return[s,l,c]}function d2(e){var t=e.read_shift(2),r=Bm(e);return[t,r]}function z3(e,t,r){e.l+=4,t-=4;var a=e.l+t,s=Kc(e,t,r),l=e.read_shift(2);if(a-=e.l,l!==a)throw new Error("Malformed AddinUdf: padding = "+a+" != "+l);return e.l+=l,s}function ef(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);return{s:{c:a,r:t},e:{c:s,r}}}function m2(e,t){return t||(t=ye(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function g2(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(1),s=e.read_shift(1);return{s:{c:a,r:t},e:{c:s,r}}}var H3=g2;function p2(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return e.l+=12,[r,t,a]}function $3(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function V3(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function ca(e){e.l+=2,e.l+=e.read_shift(2)}var G3={0:ca,4:ca,5:ca,6:ca,7:V3,8:ca,9:ca,10:ca,11:ca,12:ca,13:$3,14:ca,15:ca,16:ca,17:ca,18:ca,19:ca,20:ca,21:p2};function q3(e,t){for(var r=e.l+t,a=[];e.l<r;){var s=e.read_shift(2);e.l-=2;try{a.push(G3[s](e,r-e.l))}catch{return e.l=r,a}}return e.l!=r&&(e.l=r),a}function bu(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function Pm(e,t,r){var a=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":a=1280,s=8;break;case"biff4":a=4,s=6;break;case"biff3":a=3,s=6;break;case"biff2":a=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var l=ye(s);return l.write_shift(2,a),l.write_shift(2,t),s>4&&l.write_shift(2,29282),s>6&&l.write_shift(2,1997),s>8&&(l.write_shift(2,49161),l.write_shift(2,1),l.write_shift(2,1798),l.write_shift(2,0)),l}function X3(e,t){return t===0||e.read_shift(2),1200}function W3(e,t,r){if(r.enc)return e.l+=t,"";var a=e.l,s=el(e,0,r);return e.read_shift(t+a-e.l),s}function K3(e,t){var r=!t||t.biff==8,a=ye(r?112:54);for(a.write_shift(t.biff==8?2:1,7),r&&a.write_shift(1,0),a.write_shift(4,859007059),a.write_shift(4,5458548|(r?0:536870912));a.l<a.length;)a.write_shift(1,r?0:32);return a}function Y3(e,t,r){var a=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:a&16,fBelow:a&64,fRight:a&128}}function J3(e,t,r){var a=e.read_shift(4),s=e.read_shift(1)&3,l=e.read_shift(1);switch(l){case 0:l="Worksheet";break;case 1:l="Macrosheet";break;case 2:l="Chartsheet";break;case 6:l="VBAModule";break}var c=Kc(e,0,r);return c.length===0&&(c="Sheet1"),{pos:a,hs:s,dt:l,name:c}}function Q3(e,t){var r=!t||t.biff>=8?2:1,a=ye(8+r*e.name.length);a.write_shift(4,e.pos),a.write_shift(1,e.hs||0),a.write_shift(1,e.dt),a.write_shift(1,e.name.length),t.biff>=8&&a.write_shift(1,1),a.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var s=a.slice(0,a.l);return s.l=a.l,s}function Z3(e,t){for(var r=e.l+t,a=e.read_shift(4),s=e.read_shift(4),l=[],c=0;c!=s&&e.l<r;++c)l.push(O3(e));return l.Count=a,l.Unique=s,l}function eC(e,t){var r=ye(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var a=[],s=0;s<e.length;++s)a[s]=R3(e[s]);var l=Xr([r].concat(a));return l.parts=[r.length].concat(a.map(function(c){return c.length})),l}function tC(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function rC(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var a=e.read_shift(1);return e.l+=3,a&7&&(t.level=a&7),a&32&&(t.hidden=!0),a&64&&(t.hpt=r/20),t}function aC(e){var t=j3(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function nC(e){return e.read_shift(2),e.read_shift(4)}function oy(e,t,r){var a=0;r&&r.biff==2||(a=e.read_shift(2));var s=e.read_shift(2);r&&r.biff==2&&(a=1-(s>>15),s&=32767);var l={Unsynced:a&1,DyZero:(a&2)>>1,ExAsc:(a&4)>>2,ExDsc:(a&8)>>3};return[l,s]}function sC(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),u=e.read_shift(2),h=e.read_shift(2),d=e.read_shift(2);return{Pos:[t,r],Dim:[a,s],Flags:l,CurTab:c,FirstTab:u,Selected:h,TabRatio:d}}function iC(){var e=ye(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function lC(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var a=e.read_shift(2);return{RTL:a&64}}function oC(e){var t=ye(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function cC(){}function uC(e,t,r){var a={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return a.name=Kc(e,0,r),a}function fC(e,t){var r=e.name||"Arial",a=t&&t.biff==5,s=a?15+r.length:16+2*r.length,l=ye(s);return l.write_shift(2,e.sz*20),l.write_shift(4,0),l.write_shift(2,400),l.write_shift(4,0),l.write_shift(2,0),l.write_shift(1,r.length),a||l.write_shift(1,1),l.write_shift((a?1:2)*r.length,r,a?"sbcs":"utf16le"),l}function hC(e){var t=Pn(e);return t.isst=e.read_shift(4),t}function dC(e,t,r,a){var s=ye(10);return qi(e,t,a,s),s.write_shift(4,r),s}function mC(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=e.l+t,s=Pn(e);r.biff==2&&e.l++;var l=Yc(e,a-e.l,r);return s.val=l,s}function gC(e,t,r,a,s){var l=!s||s.biff==8,c=ye(8+ +l+(1+l)*r.length);return qi(e,t,a,c),c.write_shift(2,r.length),l&&c.write_shift(1,1),c.write_shift((1+l)*r.length,r,l?"utf16le":"sbcs"),c}function pC(e,t,r){var a=e.read_shift(2),s=el(e,0,r);return[a,s]}function xC(e,t,r,a){var s=r&&r.biff==5;a||(a=ye(s?3+t.length:5+2*t.length)),a.write_shift(2,e),a.write_shift(s?1:2,t.length),s||a.write_shift(1,1),a.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le");var l=a.length>a.l?a.slice(0,a.l):a;return l.l==null&&(l.l=l.length),l}var vC=el;function cy(e,t,r){var a=e.l+t,s=r.biff==8||!r.biff?4:2,l=e.read_shift(s),c=e.read_shift(s),u=e.read_shift(2),h=e.read_shift(2);return e.l=a,{s:{r:l,c:u},e:{r:c,c:h}}}function yC(e,t){var r=t.biff==8||!t.biff?4:2,a=ye(2*r+6);return a.write_shift(r,e.s.r),a.write_shift(r,e.e.r+1),a.write_shift(2,e.s.c),a.write_shift(2,e.e.c+1),a.write_shift(2,0),a}function _C(e){var t=e.read_shift(2),r=e.read_shift(2),a=d2(e);return{r:t,c:r,ixfe:a[0],rknum:a[1]}}function wC(e,t){for(var r=e.l+t-2,a=e.read_shift(2),s=e.read_shift(2),l=[];e.l<r;)l.push(d2(e));if(e.l!==r)throw new Error("MulRK read error");var c=e.read_shift(2);if(l.length!=c-s+1)throw new Error("MulRK length mismatch");return{r:a,c:s,C:c,rkrec:l}}function bC(e,t){for(var r=e.l+t-2,a=e.read_shift(2),s=e.read_shift(2),l=[];e.l<r;)l.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var c=e.read_shift(2);if(l.length!=c-s+1)throw new Error("MulBlank length mismatch");return{r:a,c:s,C:c,ixfe:l}}function SC(e,t,r,a){var s={},l=e.read_shift(4),c=e.read_shift(4),u=e.read_shift(4),h=e.read_shift(2);return s.patternType=a3[u>>26],a.cellStyles&&(s.alc=l&7,s.fWrap=l>>3&1,s.alcV=l>>4&7,s.fJustLast=l>>7&1,s.trot=l>>8&255,s.cIndent=l>>16&15,s.fShrinkToFit=l>>20&1,s.iReadOrder=l>>22&2,s.fAtrNum=l>>26&1,s.fAtrFnt=l>>27&1,s.fAtrAlc=l>>28&1,s.fAtrBdr=l>>29&1,s.fAtrPat=l>>30&1,s.fAtrProt=l>>31&1,s.dgLeft=c&15,s.dgRight=c>>4&15,s.dgTop=c>>8&15,s.dgBottom=c>>12&15,s.icvLeft=c>>16&127,s.icvRight=c>>23&127,s.grbitDiag=c>>30&3,s.icvTop=u&127,s.icvBottom=u>>7&127,s.icvDiag=u>>14&127,s.dgDiag=u>>21&15,s.icvFore=h&127,s.icvBack=h>>7&127,s.fsxButton=h>>14&1),s}function EC(e,t,r){var a={};return a.ifnt=e.read_shift(2),a.numFmtId=e.read_shift(2),a.flags=e.read_shift(2),a.fStyle=a.flags>>2&1,t-=6,a.data=SC(e,t,a.fStyle,r),a}function uy(e,t,r,a){var s=r&&r.biff==5;a||(a=ye(s?16:20)),a.write_shift(2,0),e.style?(a.write_shift(2,e.numFmtId||0),a.write_shift(2,65524)):(a.write_shift(2,e.numFmtId||0),a.write_shift(2,t<<4));var l=0;return e.numFmtId>0&&s&&(l|=1024),a.write_shift(4,l),a.write_shift(4,0),s||a.write_shift(4,0),a.write_shift(2,0),a}function TC(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function kC(e){var t=ye(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function fy(e,t,r){var a=Pn(e);(r.biff==2||t==9)&&++e.l;var s=N3(e);return a.val=s,a.t=s===!0||s===!1?"b":"e",a}function AC(e,t,r,a,s,l){var c=ye(8);return qi(e,t,a,c),c2(r,l,c),c}function CC(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=Pn(e),s=da(e);return a.val=s,a}function NC(e,t,r,a){var s=ye(14);return qi(e,t,a,s),Vi(r,s),s}var hy=U3;function OC(e,t,r){var a=e.l+t,s=e.read_shift(2),l=e.read_shift(2);if(r.sbcch=l,l==1025||l==14849)return[l,s];if(l<1||l>255)throw new Error("Unexpected SupBook type: "+l);for(var c=Gi(e,l),u=[];a>e.l;)u.push(Yc(e));return[l,s,c,u]}function dy(e,t,r){var a=e.read_shift(2),s,l={fBuiltIn:a&1,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return r.sbcch===14849&&(s=z3(e,t-2,r)),l.body=s||e.read_shift(t-2),typeof s=="string"&&(l.Name=s),l}var RC=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function my(e,t,r){var a=e.l+t,s=e.read_shift(2),l=e.read_shift(1),c=e.read_shift(1),u=e.read_shift(r&&r.biff==2?1:2),h=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),h=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var d=Gi(e,c,r);s&32&&(d=RC[d.charCodeAt(0)]);var g=a-e.l;r&&r.biff==2&&--g;var x=a==e.l||u===0||!(g>0)?[]:qO(e,g,r,u);return{chKey:l,Name:d,itab:h,rgce:x}}function x2(e,t,r){if(r.biff<8)return DC(e,t,r);for(var a=[],s=e.l+t,l=e.read_shift(r.biff>8?4:2);l--!==0;)a.push(P3(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return a}function DC(e,t,r){e[e.l+1]==3&&e[e.l]++;var a=Kc(e,t,r);return a.charCodeAt(0)==3?a.slice(1):a}function FC(e,t,r){if(r.biff<8){e.l+=t;return}var a=e.read_shift(2),s=e.read_shift(2),l=Gi(e,a,r),c=Gi(e,s,r);return[l,c]}function MC(e,t,r){var a=g2(e);e.l++;var s=e.read_shift(1);return t-=8,[XO(e,t,r),s,a]}function gy(e,t,r){var a=H3(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[a,VO(e,t,r)]}function LC(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,a=e.read_shift(4);return[t,r,a]}function BC(e,t,r){if(!(r.biff<8)){var a=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),u=el(e,0,r);return r.biff<8&&e.read_shift(1),[{r:a,c:s},u,c,l]}}function IC(e,t,r){return BC(e,t,r)}function jC(e,t){for(var r=[],a=e.read_shift(2);a--;)r.push(ef(e));return r}function UC(e){var t=ye(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)m2(e[r],t);return t}function PC(e,t,r){if(r&&r.biff<8)return HC(e,t,r);var a=p2(e),s=q3(e,t-22,a[1]);return{cmo:a,ft:s}}var zC={8:function(e,t){var r=e.l+t;e.l+=10;var a=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=r,{fmt:a}}};function HC(e,t,r){e.l+=4;var a=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var c=[];return c.push((zC[a]||ga)(e,t,r)),{cmo:[s,a,l],ft:c}}function $C(e,t,r){var a=e.l,s="";try{e.l+=4;var l=(r.lastobj||{cmo:[0,0]}).cmo[1],c;[0,5,7,11,12,14].indexOf(l)==-1?e.l+=6:c=D3(e,6,r);var u=e.read_shift(2);e.read_shift(2),Lr(e,2);var h=e.read_shift(2);e.l+=h;for(var d=1;d<e.lens.length-1;++d){if(e.l-a!=e.lens[d])throw new Error("TxO: bad continue record");var g=e[e.l],x=Gi(e,e.lens[d+1]-e.lens[d]-1);if(s+=x,s.length>=(g?u:2*u))break}if(s.length!==u&&s.length!==u*2)throw new Error("cchText: "+u+" != "+s.length);return e.l=a+t,{t:s}}catch{return e.l=a+t,{t:s}}}function VC(e,t){var r=ef(e);e.l+=16;var a=B3(e,t-24);return[r,a]}function GC(e){var t=ye(24),r=mr(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var a="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)t.write_shift(1,parseInt(a[s],16));return Xr([t,I3(e[1])])}function qC(e,t){e.read_shift(2);var r=ef(e),a=e.read_shift((t-10)/2,"dbcs-cont");return a=a.replace(wa,""),[r,a]}function XC(e){var t=e[1].Tooltip,r=ye(10+2*(t.length+1));r.write_shift(2,2048);var a=mr(e[0]);r.write_shift(2,a.r),r.write_shift(2,a.r),r.write_shift(2,a.c),r.write_shift(2,a.c);for(var s=0;s<t.length;++s)r.write_shift(2,t.charCodeAt(s));return r.write_shift(2,0),r}function WC(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=Zv[r]||r,r=e.read_shift(2),t[1]=Zv[r]||r,t}function KC(e){return e||(e=ye(4)),e.write_shift(2,1),e.write_shift(2,1),e}function YC(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(h2(e));return r}function JC(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(h2(e));return r}function QC(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function v2(e,t,r){if(!r.cellStyles)return ga(e,t);var a=r&&r.biff>=12?4:2,s=e.read_shift(a),l=e.read_shift(a),c=e.read_shift(a),u=e.read_shift(a),h=e.read_shift(2);a==2&&(e.l+=2);var d={s,e:l,w:c,ixfe:u,flags:h};return(r.biff>=5||!r.biff)&&(d.level=h>>8&7),d}function ZC(e,t){var r=ye(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var a=0;return e.hidden&&(a|=1),r.write_shift(1,a),a=e.level||0,r.write_shift(1,a),r.write_shift(2,0),r}function eN(e,t){var r={};return t<32||(e.l+=16,r.header=da(e),r.footer=da(e),e.l+=2),r}function tN(e,t,r){var a={area:!1};if(r.biff!=5)return e.l+=t,a;var s=e.read_shift(1);return e.l+=3,s&16&&(a.area=!0),a}function rN(e){for(var t=ye(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var aN=Pn,nN=o2,sN=Yc;function iN(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),s={fmt:t,env:r,len:a,data:e.slice(e.l,e.l+a)};return e.l+=a,s}function lN(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var a=Pn(e);++e.l;var s=el(e,t-7,r);return a.t="str",a.val=s,a}function oN(e){var t=Pn(e);++e.l;var r=da(e);return t.t="n",t.val=r,t}function cN(e,t,r){var a=ye(15);return e0(a,e,t),a.write_shift(8,r,"f"),a}function uN(e){var t=Pn(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function fN(e,t,r){var a=ye(9);return e0(a,e,t),a.write_shift(2,r),a}function hN(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function dN(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function mN(e,t,r){var a=e.l+t,s=Pn(e),l=e.read_shift(2),c=Gi(e,l,r);return e.l=a,s.t="str",s.val=c,s}var gN=[2,3,48,49,131,139,140,245],nm=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Ju({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(u,h){var d=[],g=ri(1);switch(h.type){case"base64":g=Wa(Ya(u));break;case"binary":g=Wa(u);break;case"buffer":case"array":g=u;break}aa(g,0);var x=g.read_shift(1),v=!!(x&136),_=!1,b=!1;switch(x){case 2:break;case 3:break;case 48:_=!0,v=!0;break;case 49:_=!0,v=!0;break;case 131:break;case 139:break;case 140:b=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+x.toString(16))}var y=0,S=521;x==2&&(y=g.read_shift(2)),g.l+=3,x!=2&&(y=g.read_shift(4)),y>1048576&&(y=1e6),x!=2&&(S=g.read_shift(2));var k=g.read_shift(2),R=h.codepage||1252;x!=2&&(g.l+=16,g.read_shift(1),g[g.l]!==0&&(R=e[g[g.l]]),g.l+=1,g.l+=2),b&&(g.l+=36);for(var T=[],j={},X=Math.min(g.length,x==2?521:S-10-(_?264:0)),L=b?32:11;g.l<X&&g[g.l]!=13;)switch(j={},j.name=Oc.utils.decode(R,g.slice(g.l,g.l+L)).replace(/[\u0000\r\n].*$/g,""),g.l+=L,j.type=String.fromCharCode(g.read_shift(1)),x!=2&&!b&&(j.offset=g.read_shift(4)),j.len=g.read_shift(1),x==2&&(j.offset=g.read_shift(2)),j.dec=g.read_shift(1),j.name.length&&T.push(j),x!=2&&(g.l+=b?13:14),j.type){case"B":(!_||j.len!=8)&&h.WTF&&console.log("Skipping "+j.name+":"+j.type);break;case"G":case"P":h.WTF&&console.log("Skipping "+j.name+":"+j.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+j.type)}if(g[g.l]!==13&&(g.l=S-1),g.read_shift(1)!==13)throw new Error("DBF Terminator not found "+g.l+" "+g[g.l]);g.l=S;var A=0,K=0;for(d[0]=[],K=0;K!=T.length;++K)d[0][K]=T[K].name;for(;y-- >0;){if(g[g.l]===42){g.l+=k;continue}for(++g.l,d[++A]=[],K=0,K=0;K!=T.length;++K){var q=g.slice(g.l,g.l+T[K].len);g.l+=T[K].len,aa(q,0);var ie=Oc.utils.decode(R,q);switch(T[K].type){case"C":ie.trim().length&&(d[A][K]=ie.replace(/\s+$/,""));break;case"D":ie.length===8?d[A][K]=new Date(+ie.slice(0,4),+ie.slice(4,6)-1,+ie.slice(6,8)):d[A][K]=ie;break;case"F":d[A][K]=parseFloat(ie.trim());break;case"+":case"I":d[A][K]=b?q.read_shift(-4,"i")^2147483648:q.read_shift(4,"i");break;case"L":switch(ie.trim().toUpperCase()){case"Y":case"T":d[A][K]=!0;break;case"N":case"F":d[A][K]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+ie+"|")}break;case"M":if(!v)throw new Error("DBF Unexpected MEMO for type "+x.toString(16));d[A][K]="##MEMO##"+(b?parseInt(ie.trim(),10):q.read_shift(4));break;case"N":ie=ie.replace(/\u0000/g,"").trim(),ie&&ie!="."&&(d[A][K]=+ie||0);break;case"@":d[A][K]=new Date(q.read_shift(-8,"f")-621356832e5);break;case"T":d[A][K]=new Date((q.read_shift(4)-2440588)*864e5+q.read_shift(4));break;case"Y":d[A][K]=q.read_shift(4,"i")/1e4+q.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[A][K]=-q.read_shift(-8,"f");break;case"B":if(_&&T[K].len==8){d[A][K]=q.read_shift(8,"f");break}case"G":case"P":q.l+=T[K].len;break;case"0":if(T[K].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+T[K].type)}}}if(x!=2&&g.l<g.length&&g[g.l++]!=26)throw new Error("DBF EOF Marker missing "+(g.l-1)+" of "+g.length+" "+g[g.l-1].toString(16));return h&&h.sheetRows&&(d=d.slice(0,h.sheetRows)),h.DBF=T,d}function a(u,h){var d=h||{};d.dateNF||(d.dateNF="yyyymmdd");var g=go(r(u,d),d);return g["!cols"]=d.DBF.map(function(x){return{wch:x.len,DBF:x}}),delete d.DBF,g}function s(u,h){try{return oi(a(u,h),h)}catch(d){if(h&&h.WTF)throw d}return{SheetNames:[],Sheets:{}}}var l={B:8,C:250,L:1,D:8,"?":0,"":0};function c(u,h){var d=h||{};if(+d.codepage>=0&&Tn(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var g=Da(),x=Gu(u,{header:1,raw:!0,cellDates:!0}),v=x[0],_=x.slice(1),b=u["!cols"]||[],y=0,S=0,k=0,R=1;for(y=0;y<v.length;++y){if(((b[y]||{}).DBF||{}).name){v[y]=b[y].DBF.name,++k;continue}if(v[y]!=null){if(++k,typeof v[y]=="number"&&(v[y]=v[y].toString(10)),typeof v[y]!="string")throw new Error("DBF Invalid column name "+v[y]+" |"+typeof v[y]+"|");if(v.indexOf(v[y])!==y){for(S=0;S<1024;++S)if(v.indexOf(v[y]+"_"+S)==-1){v[y]+="_"+S;break}}}}var T=Mt(u["!ref"]),j=[],X=[],L=[];for(y=0;y<=T.e.c-T.s.c;++y){var A="",K="",q=0,ie=[];for(S=0;S<_.length;++S)_[S][y]!=null&&ie.push(_[S][y]);if(ie.length==0||v[y]==null){j[y]="?";continue}for(S=0;S<ie.length;++S){switch(typeof ie[S]){case"number":K="B";break;case"string":K="C";break;case"boolean":K="L";break;case"object":K=ie[S]instanceof Date?"D":"C";break;default:K="C"}q=Math.max(q,String(ie[S]).length),A=A&&A!=K?"C":K}q>250&&(q=250),K=((b[y]||{}).DBF||{}).type,K=="C"&&b[y].DBF.len>q&&(q=b[y].DBF.len),A=="B"&&K=="N"&&(A="N",L[y]=b[y].DBF.dec,q=b[y].DBF.len),X[y]=A=="C"||K=="N"?q:l[A]||0,R+=X[y],j[y]=A}var ne=g.next(32);for(ne.write_shift(4,318902576),ne.write_shift(4,_.length),ne.write_shift(2,296+32*k),ne.write_shift(2,R),y=0;y<4;++y)ne.write_shift(4,0);for(ne.write_shift(4,0|(+t[l_]||3)<<8),y=0,S=0;y<v.length;++y)if(v[y]!=null){var Z=g.next(32),me=(v[y].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);Z.write_shift(1,me,"sbcs"),Z.write_shift(1,j[y]=="?"?"C":j[y],"sbcs"),Z.write_shift(4,S),Z.write_shift(1,X[y]||l[j[y]]||0),Z.write_shift(1,L[y]||0),Z.write_shift(1,2),Z.write_shift(4,0),Z.write_shift(1,0),Z.write_shift(4,0),Z.write_shift(4,0),S+=X[y]||l[j[y]]||0}var Re=g.next(264);for(Re.write_shift(4,13),y=0;y<65;++y)Re.write_shift(4,0);for(y=0;y<_.length;++y){var Ae=g.next(R);for(Ae.write_shift(1,0),S=0;S<v.length;++S)if(v[S]!=null)switch(j[S]){case"L":Ae.write_shift(1,_[y][S]==null?63:_[y][S]?84:70);break;case"B":Ae.write_shift(8,_[y][S]||0,"f");break;case"N":var V="0";for(typeof _[y][S]=="number"&&(V=_[y][S].toFixed(L[S]||0)),k=0;k<X[S]-V.length;++k)Ae.write_shift(1,32);Ae.write_shift(1,V,"sbcs");break;case"D":_[y][S]?(Ae.write_shift(4,("0000"+_[y][S].getFullYear()).slice(-4),"sbcs"),Ae.write_shift(2,("00"+(_[y][S].getMonth()+1)).slice(-2),"sbcs"),Ae.write_shift(2,("00"+_[y][S].getDate()).slice(-2),"sbcs")):Ae.write_shift(8,"00000000","sbcs");break;case"C":var ae=String(_[y][S]!=null?_[y][S]:"").slice(0,X[S]);for(Ae.write_shift(1,ae,"sbcs"),k=0;k<X[S]-ae.length;++k)Ae.write_shift(1,32);break}}return g.next(1).write_shift(1,26),g.end()}return{to_workbook:s,to_sheet:a,from_sheet:c}})(),y2=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+wr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(v,_){var b=e[_];return typeof b=="number"?kv(b):b},a=function(v,_,b){var y=_.charCodeAt(0)-32<<4|b.charCodeAt(0)-48;return y==59?v:kv(y)};e["|"]=254;function s(v,_){switch(_.type){case"base64":return l(Ya(v),_);case"binary":return l(v,_);case"buffer":return l(wt&&Buffer.isBuffer(v)?v.toString("binary"):li(v),_);case"array":return l($i(v),_)}throw new Error("Unrecognized type "+_.type)}function l(v,_){var b=v.split(/[\n\r]+/),y=-1,S=-1,k=0,R=0,T=[],j=[],X=null,L={},A=[],K=[],q=[],ie=0,ne;for(+_.codepage>=0&&Tn(+_.codepage);k!==b.length;++k){ie=0;var Z=b[k].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(t,r),me=Z.replace(/;;/g,"\0").split(";").map(function(P){return P.replace(/\u0000/g,";")}),Re=me[0],Ae;if(Z.length>0)switch(Re){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":me[1].charAt(0)=="P"&&j.push(Z.slice(3).replace(/;;/g,";"));break;case"C":var V=!1,ae=!1,xe=!1,J=!1,be=-1,I=-1;for(R=1;R<me.length;++R)switch(me[R].charAt(0)){case"A":break;case"X":S=parseInt(me[R].slice(1))-1,ae=!0;break;case"Y":for(y=parseInt(me[R].slice(1))-1,ae||(S=0),ne=T.length;ne<=y;++ne)T[ne]=[];break;case"K":Ae=me[R].slice(1),Ae.charAt(0)==='"'?Ae=Ae.slice(1,Ae.length-1):Ae==="TRUE"?Ae=!0:Ae==="FALSE"?Ae=!1:isNaN(An(Ae))?isNaN(oo(Ae).getDate())||(Ae=ir(Ae)):(Ae=An(Ae),X!==null&&ho(X)&&(Ae=Zu(Ae))),V=!0;break;case"E":J=!0;var N=no(me[R].slice(1),{r:y,c:S});T[y][S]=[T[y][S],N];break;case"S":xe=!0,T[y][S]=[T[y][S],"S5S"];break;case"G":break;case"R":be=parseInt(me[R].slice(1))-1;break;case"C":I=parseInt(me[R].slice(1))-1;break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+Z)}if(V&&(T[y][S]&&T[y][S].length==2?T[y][S][0]=Ae:T[y][S]=Ae,X=null),xe){if(J)throw new Error("SYLK shared formula cannot have own formula");var U=be>-1&&T[be][I];if(!U||!U[1])throw new Error("SYLK shared formula cannot find base");T[y][S][1]=I2(U[1],{r:y-be,c:S-I})}break;case"F":var M=0;for(R=1;R<me.length;++R)switch(me[R].charAt(0)){case"X":S=parseInt(me[R].slice(1))-1,++M;break;case"Y":for(y=parseInt(me[R].slice(1))-1,ne=T.length;ne<=y;++ne)T[ne]=[];break;case"M":ie=parseInt(me[R].slice(1))/20;break;case"F":break;case"G":break;case"P":X=j[parseInt(me[R].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(q=me[R].slice(1).split(" "),ne=parseInt(q[0],10);ne<=parseInt(q[1],10);++ne)ie=parseInt(q[2],10),K[ne-1]=ie===0?{hidden:!0}:{wch:ie},ai(K[ne-1]);break;case"C":S=parseInt(me[R].slice(1))-1,K[S]||(K[S]={});break;case"R":y=parseInt(me[R].slice(1))-1,A[y]||(A[y]={}),ie>0?(A[y].hpt=ie,A[y].hpx=uo(ie)):ie===0&&(A[y].hidden=!0);break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+Z)}M<1&&(X=null);break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+Z)}}return A.length>0&&(L["!rows"]=A),K.length>0&&(L["!cols"]=K),_&&_.sheetRows&&(T=T.slice(0,_.sheetRows)),[T,L]}function c(v,_){var b=s(v,_),y=b[0],S=b[1],k=go(y,_);return wr(S).forEach(function(R){k[R]=S[R]}),k}function u(v,_){return oi(c(v,_),_)}function h(v,_,b,y){var S="C;Y"+(b+1)+";X"+(y+1)+";K";switch(v.t){case"n":S+=v.v||0,v.f&&!v.F&&(S+=";E"+qm(v.f,{r:b,c:y}));break;case"b":S+=v.v?"TRUE":"FALSE";break;case"e":S+=v.w||v.v;break;case"d":S+='"'+(v.w||v.v)+'"';break;case"s":S+='"'+v.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return S}function d(v,_){_.forEach(function(b,y){var S="F;W"+(y+1)+" "+(y+1)+" ";b.hidden?S+="0":(typeof b.width=="number"&&!b.wpx&&(b.wpx=jc(b.width)),typeof b.wpx=="number"&&!b.wch&&(b.wch=Uc(b.wpx)),typeof b.wch=="number"&&(S+=Math.round(b.wch))),S.charAt(S.length-1)!=" "&&v.push(S)})}function g(v,_){_.forEach(function(b,y){var S="F;";b.hidden?S+="M0;":b.hpt?S+="M"+20*b.hpt+";":b.hpx&&(S+="M"+20*Pc(b.hpx)+";"),S.length>2&&v.push(S+"R"+(y+1))})}function x(v,_){var b=["ID;PWXL;N;E"],y=[],S=Mt(v["!ref"]),k,R=Array.isArray(v),T=`\r
`;b.push("P;PGeneral"),b.push("F;P0;DG0G8;M255"),v["!cols"]&&d(b,v["!cols"]),v["!rows"]&&g(b,v["!rows"]),b.push("B;Y"+(S.e.r-S.s.r+1)+";X"+(S.e.c-S.s.c+1)+";D"+[S.s.c,S.s.r,S.e.c,S.e.r].join(" "));for(var j=S.s.r;j<=S.e.r;++j)for(var X=S.s.c;X<=S.e.c;++X){var L=ht({r:j,c:X});k=R?(v[j]||[])[X]:v[L],!(!k||k.v==null&&(!k.f||k.F))&&y.push(h(k,v,j,X))}return b.join(T)+T+y.join(T)+T+"E"+T}return{to_workbook:u,to_sheet:c,from_sheet:x}})(),_2=(function(){function e(l,c){switch(c.type){case"base64":return t(Ya(l),c);case"binary":return t(l,c);case"buffer":return t(wt&&Buffer.isBuffer(l)?l.toString("binary"):li(l),c);case"array":return t($i(l),c)}throw new Error("Unrecognized type "+c.type)}function t(l,c){for(var u=l.split(`
`),h=-1,d=-1,g=0,x=[];g!==u.length;++g){if(u[g].trim()==="BOT"){x[++h]=[],d=0;continue}if(!(h<0)){var v=u[g].trim().split(","),_=v[0],b=v[1];++g;for(var y=u[g]||"";(y.match(/["]/g)||[]).length&1&&g<u.length-1;)y+=`
`+u[++g];switch(y=y.trim(),+_){case-1:if(y==="BOT"){x[++h]=[],d=0;continue}else if(y!=="EOD")throw new Error("Unrecognized DIF special command "+y);break;case 0:y==="TRUE"?x[h][d]=!0:y==="FALSE"?x[h][d]=!1:isNaN(An(b))?isNaN(oo(b).getDate())?x[h][d]=b:x[h][d]=ir(b):x[h][d]=An(b),++d;break;case 1:y=y.slice(1,y.length-1),y=y.replace(/""/g,'"'),y&&y.match(/^=".*"$/)&&(y=y.slice(2,-1)),x[h][d++]=y!==""?y:null;break}if(y==="EOD")break}}return c&&c.sheetRows&&(x=x.slice(0,c.sheetRows)),x}function r(l,c){return go(e(l,c),c)}function a(l,c){return oi(r(l,c),c)}var s=(function(){var l=function(h,d,g,x,v){h.push(d),h.push(g+","+x),h.push('"'+v.replace(/"/g,'""')+'"')},c=function(h,d,g,x){h.push(d+","+g),h.push(d==1?'"'+x.replace(/"/g,'""')+'"':x)};return function(h){var d=[],g=Mt(h["!ref"]),x,v=Array.isArray(h);l(d,"TABLE",0,1,"sheetjs"),l(d,"VECTORS",0,g.e.r-g.s.r+1,""),l(d,"TUPLES",0,g.e.c-g.s.c+1,""),l(d,"DATA",0,0,"");for(var _=g.s.r;_<=g.e.r;++_){c(d,-1,0,"BOT");for(var b=g.s.c;b<=g.e.c;++b){var y=ht({r:_,c:b});if(x=v?(h[_]||[])[b]:h[y],!x){c(d,1,0,"");continue}switch(x.t){case"n":var S=x.w;!S&&x.v!=null&&(S=x.v),S==null?x.f&&!x.F?c(d,1,0,"="+x.f):c(d,1,0,""):c(d,0,S,"V");break;case"b":c(d,0,x.v?1:0,x.v?"TRUE":"FALSE");break;case"s":c(d,1,0,isNaN(x.v)?x.v:'="'+x.v+'"');break;case"d":x.w||(x.w=gn(x.z||ft[14],zr(ir(x.v)))),c(d,0,x.w,"V");break;default:c(d,1,0,"")}}}c(d,-1,0,"EOD");var k=`\r
`,R=d.join(k);return R}})();return{to_workbook:a,to_sheet:r,from_sheet:s}})(),w2=(function(){function e(x){return x.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(x){return x.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(x,v){for(var _=x.split(`
`),b=-1,y=-1,S=0,k=[];S!==_.length;++S){var R=_[S].trim().split(":");if(R[0]==="cell"){var T=mr(R[1]);if(k.length<=T.r)for(b=k.length;b<=T.r;++b)k[b]||(k[b]=[]);switch(b=T.r,y=T.c,R[2]){case"t":k[b][y]=e(R[3]);break;case"v":k[b][y]=+R[3];break;case"vtf":var j=R[R.length-1];case"vtc":R[3]==="nl"?k[b][y]=!!+R[4]:k[b][y]=+R[4],R[2]=="vtf"&&(k[b][y]=[k[b][y],j])}}}return v&&v.sheetRows&&(k=k.slice(0,v.sheetRows)),k}function a(x,v){return go(r(x,v),v)}function s(x,v){return oi(a(x,v),v)}var l=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),c=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),h="--SocialCalcSpreadsheetControlSave--";function d(x){if(!x||!x["!ref"])return"";for(var v=[],_=[],b,y="",S=Fa(x["!ref"]),k=Array.isArray(x),R=S.s.r;R<=S.e.r;++R)for(var T=S.s.c;T<=S.e.c;++T)if(y=ht({r:R,c:T}),b=k?(x[R]||[])[T]:x[y],!(!b||b.v==null||b.t==="z")){switch(_=["cell",y,"t"],b.t){case"s":case"str":_.push(t(b.v));break;case"n":b.f?(_[2]="vtf",_[3]="n",_[4]=b.v,_[5]=t(b.f)):(_[2]="v",_[3]=b.v);break;case"b":_[2]="vt"+(b.f?"f":"c"),_[3]="nl",_[4]=b.v?"1":"0",_[5]=t(b.f||(b.v?"TRUE":"FALSE"));break;case"d":var j=zr(ir(b.v));_[2]="vtc",_[3]="nd",_[4]=""+j,_[5]=b.w||gn(b.z||ft[14],j);break;case"e":continue}v.push(_.join(":"))}return v.push("sheet:c:"+(S.e.c-S.s.c+1)+":r:"+(S.e.r-S.s.r+1)+":tvf:1"),v.push("valueformat:1:text-wiki"),v.join(`
`)}function g(x){return[l,c,u,c,d(x),h].join(`
`)}return{to_workbook:s,to_sheet:a,from_sheet:g}})(),co=(function(){function e(g,x,v,_,b){b.raw?x[v][_]=g:g===""||(g==="TRUE"?x[v][_]=!0:g==="FALSE"?x[v][_]=!1:isNaN(An(g))?isNaN(oo(g).getDate())?x[v][_]=g:x[v][_]=ir(g):x[v][_]=An(g))}function t(g,x){var v=x||{},_=[];if(!g||g.length===0)return _;for(var b=g.split(/[\r\n]/),y=b.length-1;y>=0&&b[y].length===0;)--y;for(var S=10,k=0,R=0;R<=y;++R)k=b[R].indexOf(" "),k==-1?k=b[R].length:k++,S=Math.max(S,k);for(R=0;R<=y;++R){_[R]=[];var T=0;for(e(b[R].slice(0,S).trim(),_,R,T,v),T=1;T<=(b[R].length-S)/10+1;++T)e(b[R].slice(S+(T-1)*10,S+T*10).trim(),_,R,T,v)}return v.sheetRows&&(_=_.slice(0,v.sheetRows)),_}var r={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function s(g){for(var x={},v=!1,_=0,b=0;_<g.length;++_)(b=g.charCodeAt(_))==34?v=!v:!v&&b in r&&(x[b]=(x[b]||0)+1);b=[];for(_ in x)Object.prototype.hasOwnProperty.call(x,_)&&b.push([x[_],_]);if(!b.length){x=a;for(_ in x)Object.prototype.hasOwnProperty.call(x,_)&&b.push([x[_],_])}return b.sort(function(y,S){return y[0]-S[0]||a[y[1]]-a[S[1]]}),r[b.pop()[1]]||44}function l(g,x){var v=x||{},_="",b=v.dense?[]:{},y={s:{c:0,r:0},e:{c:0,r:0}};g.slice(0,4)=="sep="?g.charCodeAt(5)==13&&g.charCodeAt(6)==10?(_=g.charAt(4),g=g.slice(7)):g.charCodeAt(5)==13||g.charCodeAt(5)==10?(_=g.charAt(4),g=g.slice(6)):_=s(g.slice(0,1024)):v&&v.FS?_=v.FS:_=s(g.slice(0,1024));var S=0,k=0,R=0,T=0,j=0,X=_.charCodeAt(0),L=!1,A=0,K=g.charCodeAt(0);g=g.replace(/\r\n/mg,`
`);var q=v.dateNF!=null?tA(v.dateNF):null;function ie(){var ne=g.slice(T,j),Z={};if(ne.charAt(0)=='"'&&ne.charAt(ne.length-1)=='"'&&(ne=ne.slice(1,-1).replace(/""/g,'"')),ne.length===0)Z.t="z";else if(v.raw)Z.t="s",Z.v=ne;else if(ne.trim().length===0)Z.t="s",Z.v=ne;else if(ne.charCodeAt(0)==61)ne.charCodeAt(1)==34&&ne.charCodeAt(ne.length-1)==34?(Z.t="s",Z.v=ne.slice(2,-1).replace(/""/g,'"')):O8(ne)?(Z.t="n",Z.f=ne.slice(1)):(Z.t="s",Z.v=ne);else if(ne=="TRUE")Z.t="b",Z.v=!0;else if(ne=="FALSE")Z.t="b",Z.v=!1;else if(!isNaN(R=An(ne)))Z.t="n",v.cellText!==!1&&(Z.w=ne),Z.v=R;else if(!isNaN(oo(ne).getDate())||q&&ne.match(q)){Z.z=v.dateNF||ft[14];var me=0;q&&ne.match(q)&&(ne=rA(ne,v.dateNF,ne.match(q)||[]),me=1),v.cellDates?(Z.t="d",Z.v=ir(ne,me)):(Z.t="n",Z.v=zr(ir(ne,me))),v.cellText!==!1&&(Z.w=gn(Z.z,Z.v instanceof Date?zr(Z.v):Z.v)),v.cellNF||delete Z.z}else Z.t="s",Z.v=ne;if(Z.t=="z"||(v.dense?(b[S]||(b[S]=[]),b[S][k]=Z):b[ht({c:k,r:S})]=Z),T=j+1,K=g.charCodeAt(T),y.e.c<k&&(y.e.c=k),y.e.r<S&&(y.e.r=S),A==X)++k;else if(k=0,++S,v.sheetRows&&v.sheetRows<=S)return!0}e:for(;j<g.length;++j)switch(A=g.charCodeAt(j)){case 34:K===34&&(L=!L);break;case X:case 10:case 13:if(!L&&ie())break e;break}return j-T>0&&ie(),b["!ref"]=vt(y),b}function c(g,x){return!(x&&x.PRN)||x.FS||g.slice(0,4)=="sep="||g.indexOf("	")>=0||g.indexOf(",")>=0||g.indexOf(";")>=0?l(g,x):go(t(g,x),x)}function u(g,x){var v="",_=x.type=="string"?[0,0,0,0]:e1(g,x);switch(x.type){case"base64":v=Ya(g);break;case"binary":v=g;break;case"buffer":x.codepage==65001?v=g.toString("utf8"):x.codepage&&typeof Oc<"u"||(v=wt&&Buffer.isBuffer(g)?g.toString("binary"):li(g));break;case"array":v=$i(g);break;case"string":v=g;break;default:throw new Error("Unrecognized type "+x.type)}return _[0]==239&&_[1]==187&&_[2]==191?v=Yt(v.slice(3)):x.type!="string"&&x.type!="buffer"&&x.codepage==65001?v=Yt(v):x.type=="binary"&&typeof Oc<"u",v.slice(0,19)=="socialcalc:version:"?w2.to_sheet(x.type=="string"?v:Yt(v),x):c(v,x)}function h(g,x){return oi(u(g,x),x)}function d(g){for(var x=[],v=Mt(g["!ref"]),_,b=Array.isArray(g),y=v.s.r;y<=v.e.r;++y){for(var S=[],k=v.s.c;k<=v.e.c;++k){var R=ht({r:y,c:k});if(_=b?(g[y]||[])[k]:g[R],!_||_.v==null){S.push("          ");continue}for(var T=(_.w||(gs(_),_.w)||"").slice(0,10);T.length<10;)T+=" ";S.push(T+(k===0?" ":""))}x.push(S.join(""))}return x.join(`
`)}return{to_workbook:h,to_sheet:u,from_sheet:d}})();function pN(e,t){var r=t||{},a=!!r.WTF;r.WTF=!0;try{var s=y2.to_workbook(e,r);return r.WTF=a,s}catch(l){if(r.WTF=a,!l.message.match(/SYLK bad record ID/)&&a)throw l;return co.to_workbook(e,t)}}var Pi=(function(){function e(N,U,M){if(N){aa(N,N.l||0);for(var P=M.Enum||be;N.l<N.length;){var te=N.read_shift(2),pe=P[te]||P[65535],Ee=N.read_shift(2),ve=N.l+Ee,Te=pe.f&&pe.f(N,Ee,M);if(N.l=ve,U(Te,pe,te))return}}}function t(N,U){switch(U.type){case"base64":return r(Wa(Ya(N)),U);case"binary":return r(Wa(N),U);case"buffer":case"array":return r(N,U)}throw"Unsupported type "+U.type}function r(N,U){if(!N)return N;var M=U||{},P=M.dense?[]:{},te="Sheet1",pe="",Ee=0,ve={},Te=[],tt=[],G={s:{r:0,c:0},e:{r:0,c:0}},Rt=M.sheetRows||0;if(N[2]==0&&(N[3]==8||N[3]==9)&&N.length>=16&&N[14]==5&&N[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(N[2]==2)M.Enum=be,e(N,function(Pe,Zt,Ar){switch(Ar){case 0:M.vers=Pe,Pe>=4096&&(M.qpro=!0);break;case 6:G=Pe;break;case 204:Pe&&(pe=Pe);break;case 222:pe=Pe;break;case 15:case 51:M.qpro||(Pe[1].v=Pe[1].v.slice(1));case 13:case 14:case 16:Ar==14&&(Pe[2]&112)==112&&(Pe[2]&15)>1&&(Pe[2]&15)<15&&(Pe[1].z=M.dateNF||ft[14],M.cellDates&&(Pe[1].t="d",Pe[1].v=Zu(Pe[1].v))),M.qpro&&Pe[3]>Ee&&(P["!ref"]=vt(G),ve[te]=P,Te.push(te),P=M.dense?[]:{},G={s:{r:0,c:0},e:{r:0,c:0}},Ee=Pe[3],te=pe||"Sheet"+(Ee+1),pe="");var Hr=M.dense?(P[Pe[0].r]||[])[Pe[0].c]:P[ht(Pe[0])];if(Hr){Hr.t=Pe[1].t,Hr.v=Pe[1].v,Pe[1].z!=null&&(Hr.z=Pe[1].z),Pe[1].f!=null&&(Hr.f=Pe[1].f);break}M.dense?(P[Pe[0].r]||(P[Pe[0].r]=[]),P[Pe[0].r][Pe[0].c]=Pe[1]):P[ht(Pe[0])]=Pe[1];break}},M);else if(N[2]==26||N[2]==14)M.Enum=I,N[2]==14&&(M.qpro=!0,N.l=0),e(N,function(Pe,Zt,Ar){switch(Ar){case 204:te=Pe;break;case 22:Pe[1].v=Pe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Pe[3]>Ee&&(P["!ref"]=vt(G),ve[te]=P,Te.push(te),P=M.dense?[]:{},G={s:{r:0,c:0},e:{r:0,c:0}},Ee=Pe[3],te="Sheet"+(Ee+1)),Rt>0&&Pe[0].r>=Rt)break;M.dense?(P[Pe[0].r]||(P[Pe[0].r]=[]),P[Pe[0].r][Pe[0].c]=Pe[1]):P[ht(Pe[0])]=Pe[1],G.e.c<Pe[0].c&&(G.e.c=Pe[0].c),G.e.r<Pe[0].r&&(G.e.r=Pe[0].r);break;case 27:Pe[14e3]&&(tt[Pe[14e3][0]]=Pe[14e3][1]);break;case 1537:tt[Pe[0]]=Pe[1],Pe[0]==Ee&&(te=Pe[1]);break}},M);else throw new Error("Unrecognized LOTUS BOF "+N[2]);if(P["!ref"]=vt(G),ve[pe||te]=P,Te.push(pe||te),!tt.length)return{SheetNames:Te,Sheets:ve};for(var We={},bt=[],lt=0;lt<tt.length;++lt)ve[Te[lt]]?(bt.push(tt[lt]||Te[lt]),We[tt[lt]]=ve[tt[lt]]||ve[Te[lt]]):(bt.push(tt[lt]),We[tt[lt]]={"!ref":"A1"});return{SheetNames:bt,Sheets:We}}function a(N,U){var M=U||{};if(+M.codepage>=0&&Tn(+M.codepage),M.type=="string")throw new Error("Cannot write WK1 to JS string");var P=Da(),te=Mt(N["!ref"]),pe=Array.isArray(N),Ee=[];je(P,0,l(1030)),je(P,6,h(te));for(var ve=Math.min(te.e.r,8191),Te=te.s.r;Te<=ve;++Te)for(var tt=Tr(Te),G=te.s.c;G<=te.e.c;++G){Te===te.s.r&&(Ee[G]=dr(G));var Rt=Ee[G]+tt,We=pe?(N[Te]||[])[G]:N[Rt];if(!(!We||We.t=="z"))if(We.t=="n")(We.v|0)==We.v&&We.v>=-32768&&We.v<=32767?je(P,13,_(Te,G,We.v)):je(P,14,y(Te,G,We.v));else{var bt=gs(We);je(P,15,x(Te,G,bt.slice(0,239)))}}return je(P,1),P.end()}function s(N,U){var M=U||{};if(+M.codepage>=0&&Tn(+M.codepage),M.type=="string")throw new Error("Cannot write WK3 to JS string");var P=Da();je(P,0,c(N));for(var te=0,pe=0;te<N.SheetNames.length;++te)(N.Sheets[N.SheetNames[te]]||{})["!ref"]&&je(P,27,J(N.SheetNames[te],pe++));var Ee=0;for(te=0;te<N.SheetNames.length;++te){var ve=N.Sheets[N.SheetNames[te]];if(!(!ve||!ve["!ref"])){for(var Te=Mt(ve["!ref"]),tt=Array.isArray(ve),G=[],Rt=Math.min(Te.e.r,8191),We=Te.s.r;We<=Rt;++We)for(var bt=Tr(We),lt=Te.s.c;lt<=Te.e.c;++lt){We===Te.s.r&&(G[lt]=dr(lt));var Pe=G[lt]+bt,Zt=tt?(ve[We]||[])[lt]:ve[Pe];if(!(!Zt||Zt.t=="z"))if(Zt.t=="n")je(P,23,ie(We,lt,Ee,Zt.v));else{var Ar=gs(Zt);je(P,22,A(We,lt,Ee,Ar.slice(0,239)))}}++Ee}}return je(P,1),P.end()}function l(N){var U=ye(2);return U.write_shift(2,N),U}function c(N){var U=ye(26);U.write_shift(2,4096),U.write_shift(2,4),U.write_shift(4,0);for(var M=0,P=0,te=0,pe=0;pe<N.SheetNames.length;++pe){var Ee=N.SheetNames[pe],ve=N.Sheets[Ee];if(!(!ve||!ve["!ref"])){++te;var Te=Fa(ve["!ref"]);M<Te.e.r&&(M=Te.e.r),P<Te.e.c&&(P=Te.e.c)}}return M>8191&&(M=8191),U.write_shift(2,M),U.write_shift(1,te),U.write_shift(1,P),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(1,1),U.write_shift(1,2),U.write_shift(4,0),U.write_shift(4,0),U}function u(N,U,M){var P={s:{c:0,r:0},e:{c:0,r:0}};return U==8&&M.qpro?(P.s.c=N.read_shift(1),N.l++,P.s.r=N.read_shift(2),P.e.c=N.read_shift(1),N.l++,P.e.r=N.read_shift(2),P):(P.s.c=N.read_shift(2),P.s.r=N.read_shift(2),U==12&&M.qpro&&(N.l+=2),P.e.c=N.read_shift(2),P.e.r=N.read_shift(2),U==12&&M.qpro&&(N.l+=2),P.s.c==65535&&(P.s.c=P.e.c=P.s.r=P.e.r=0),P)}function h(N){var U=ye(8);return U.write_shift(2,N.s.c),U.write_shift(2,N.s.r),U.write_shift(2,N.e.c),U.write_shift(2,N.e.r),U}function d(N,U,M){var P=[{c:0,r:0},{t:"n",v:0},0,0];return M.qpro&&M.vers!=20768?(P[0].c=N.read_shift(1),P[3]=N.read_shift(1),P[0].r=N.read_shift(2),N.l+=2):(P[2]=N.read_shift(1),P[0].c=N.read_shift(2),P[0].r=N.read_shift(2)),P}function g(N,U,M){var P=N.l+U,te=d(N,U,M);if(te[1].t="s",M.vers==20768){N.l++;var pe=N.read_shift(1);return te[1].v=N.read_shift(pe,"utf8"),te}return M.qpro&&N.l++,te[1].v=N.read_shift(P-N.l,"cstr"),te}function x(N,U,M){var P=ye(7+M.length);P.write_shift(1,255),P.write_shift(2,U),P.write_shift(2,N),P.write_shift(1,39);for(var te=0;te<P.length;++te){var pe=M.charCodeAt(te);P.write_shift(1,pe>=128?95:pe)}return P.write_shift(1,0),P}function v(N,U,M){var P=d(N,U,M);return P[1].v=N.read_shift(2,"i"),P}function _(N,U,M){var P=ye(7);return P.write_shift(1,255),P.write_shift(2,U),P.write_shift(2,N),P.write_shift(2,M,"i"),P}function b(N,U,M){var P=d(N,U,M);return P[1].v=N.read_shift(8,"f"),P}function y(N,U,M){var P=ye(13);return P.write_shift(1,255),P.write_shift(2,U),P.write_shift(2,N),P.write_shift(8,M,"f"),P}function S(N,U,M){var P=N.l+U,te=d(N,U,M);if(te[1].v=N.read_shift(8,"f"),M.qpro)N.l=P;else{var pe=N.read_shift(2);j(N.slice(N.l,N.l+pe),te),N.l+=pe}return te}function k(N,U,M){var P=U&32768;return U&=-32769,U=(P?N:0)+(U>=8192?U-16384:U),(P?"":"$")+(M?dr(U):Tr(U))}var R={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},T=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function j(N,U){aa(N,0);for(var M=[],P=0,te="",pe="",Ee="",ve="";N.l<N.length;){var Te=N[N.l++];switch(Te){case 0:M.push(N.read_shift(8,"f"));break;case 1:pe=k(U[0].c,N.read_shift(2),!0),te=k(U[0].r,N.read_shift(2),!1),M.push(pe+te);break;case 2:{var tt=k(U[0].c,N.read_shift(2),!0),G=k(U[0].r,N.read_shift(2),!1);pe=k(U[0].c,N.read_shift(2),!0),te=k(U[0].r,N.read_shift(2),!1),M.push(tt+G+":"+pe+te)}break;case 3:if(N.l<N.length){console.error("WK1 premature formula end");return}break;case 4:M.push("("+M.pop()+")");break;case 5:M.push(N.read_shift(2));break;case 6:{for(var Rt="";Te=N[N.l++];)Rt+=String.fromCharCode(Te);M.push('"'+Rt.replace(/"/g,'""')+'"')}break;case 8:M.push("-"+M.pop());break;case 23:M.push("+"+M.pop());break;case 22:M.push("NOT("+M.pop()+")");break;case 20:case 21:ve=M.pop(),Ee=M.pop(),M.push(["AND","OR"][Te-20]+"("+Ee+","+ve+")");break;default:if(Te<32&&T[Te])ve=M.pop(),Ee=M.pop(),M.push(Ee+T[Te]+ve);else if(R[Te]){if(P=R[Te][1],P==69&&(P=N[N.l++]),P>M.length){console.error("WK1 bad formula parse 0x"+Te.toString(16)+":|"+M.join("|")+"|");return}var We=M.slice(-P);M.length-=P,M.push(R[Te][0]+"("+We.join(",")+")")}else return Te<=7?console.error("WK1 invalid opcode "+Te.toString(16)):Te<=24?console.error("WK1 unsupported op "+Te.toString(16)):Te<=30?console.error("WK1 invalid opcode "+Te.toString(16)):Te<=115?console.error("WK1 unsupported function opcode "+Te.toString(16)):console.error("WK1 unrecognized opcode "+Te.toString(16))}}M.length==1?U[1].f=""+M[0]:console.error("WK1 bad formula parse |"+M.join("|")+"|")}function X(N){var U=[{c:0,r:0},{t:"n",v:0},0];return U[0].r=N.read_shift(2),U[3]=N[N.l++],U[0].c=N[N.l++],U}function L(N,U){var M=X(N);return M[1].t="s",M[1].v=N.read_shift(U-4,"cstr"),M}function A(N,U,M,P){var te=ye(6+P.length);te.write_shift(2,N),te.write_shift(1,M),te.write_shift(1,U),te.write_shift(1,39);for(var pe=0;pe<P.length;++pe){var Ee=P.charCodeAt(pe);te.write_shift(1,Ee>=128?95:Ee)}return te.write_shift(1,0),te}function K(N,U){var M=X(N);M[1].v=N.read_shift(2);var P=M[1].v>>1;if(M[1].v&1)switch(P&7){case 0:P=(P>>3)*5e3;break;case 1:P=(P>>3)*500;break;case 2:P=(P>>3)/20;break;case 3:P=(P>>3)/200;break;case 4:P=(P>>3)/2e3;break;case 5:P=(P>>3)/2e4;break;case 6:P=(P>>3)/16;break;case 7:P=(P>>3)/64;break}return M[1].v=P,M}function q(N,U){var M=X(N),P=N.read_shift(4),te=N.read_shift(4),pe=N.read_shift(2);if(pe==65535)return P===0&&te===3221225472?(M[1].t="e",M[1].v=15):P===0&&te===3489660928?(M[1].t="e",M[1].v=42):M[1].v=0,M;var Ee=pe&32768;return pe=(pe&32767)-16446,M[1].v=(1-Ee*2)*(te*Math.pow(2,pe+32)+P*Math.pow(2,pe)),M}function ie(N,U,M,P){var te=ye(14);if(te.write_shift(2,N),te.write_shift(1,M),te.write_shift(1,U),P==0)return te.write_shift(4,0),te.write_shift(4,0),te.write_shift(2,65535),te;var pe=0,Ee=0,ve=0,Te=0;return P<0&&(pe=1,P=-P),Ee=Math.log2(P)|0,P/=Math.pow(2,Ee-31),Te=P>>>0,(Te&2147483648)==0&&(P/=2,++Ee,Te=P>>>0),P-=Te,Te|=2147483648,Te>>>=0,P*=Math.pow(2,32),ve=P>>>0,te.write_shift(4,ve),te.write_shift(4,Te),Ee+=16383+(pe?32768:0),te.write_shift(2,Ee),te}function ne(N,U){var M=q(N);return N.l+=U-14,M}function Z(N,U){var M=X(N),P=N.read_shift(4);return M[1].v=P>>6,M}function me(N,U){var M=X(N),P=N.read_shift(8,"f");return M[1].v=P,M}function Re(N,U){var M=me(N);return N.l+=U-10,M}function Ae(N,U){return N[N.l+U-1]==0?N.read_shift(U,"cstr"):""}function V(N,U){var M=N[N.l++];M>U-1&&(M=U-1);for(var P="";P.length<M;)P+=String.fromCharCode(N[N.l++]);return P}function ae(N,U,M){if(!(!M.qpro||U<21)){var P=N.read_shift(1);N.l+=17,N.l+=1,N.l+=2;var te=N.read_shift(U-21,"cstr");return[P,te]}}function xe(N,U){for(var M={},P=N.l+U;N.l<P;){var te=N.read_shift(2);if(te==14e3){for(M[te]=[0,""],M[te][0]=N.read_shift(2);N[N.l];)M[te][1]+=String.fromCharCode(N[N.l]),N.l++;N.l++}}return M}function J(N,U){var M=ye(5+N.length);M.write_shift(2,14e3),M.write_shift(2,U);for(var P=0;P<N.length;++P){var te=N.charCodeAt(P);M[M.l++]=te>127?95:te}return M[M.l++]=0,M}var be={0:{n:"BOF",f:Lr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:v},14:{n:"NUMBER",f:b},15:{n:"LABEL",f:g},16:{n:"FORMULA",f:S},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:g},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Ae},222:{n:"SHEETNAMELP",f:V},65535:{n:""}},I={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:L},23:{n:"NUMBER17",f:q},24:{n:"NUMBER18",f:K},25:{n:"FORMULA19",f:ne},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:xe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:Z},38:{n:"??"},39:{n:"NUMBER27",f:me},40:{n:"FORMULA28",f:Re},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Ae},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ae},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:s,to_workbook:t}})();function xN(e){var t={},r=e.match(pa),a=0,s=!1;if(r)for(;a!=r.length;++a){var l=dt(r[a]);switch(l[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!l.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(l.val=="1")break;t.cp=xm[parseInt(l.val,10)];break;case"<outline":if(!l.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=l.val;break;case"<sz":t.sz=l.val;break;case"<strike":if(!l.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!l.val)break;switch(l.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(l.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(l.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":l.rgb&&(t.color=l.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=l.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=l.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(l[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+l[0])}}return t}var vN=(function(){var e=Fc("t"),t=Fc("rPr");function r(l){var c=l.match(e);if(!c)return{t:"s",v:""};var u={t:"s",v:Ft(c[1])},h=l.match(t);return h&&(u.s=xN(h[1])),u}var a=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(c){return c.replace(a,"").split(s).map(r).filter(function(u){return u.v})}})(),yN=(function(){var t=/(\r\n|\n)/g;function r(s,l,c){var u=[];s.u&&u.push("text-decoration: underline;"),s.uval&&u.push("text-underline-style:"+s.uval+";"),s.sz&&u.push("font-size:"+s.sz+"pt;"),s.outline&&u.push("text-effect: outline;"),s.shadow&&u.push("text-shadow: auto;"),l.push('<span style="'+u.join("")+'">'),s.b&&(l.push("<b>"),c.push("</b>")),s.i&&(l.push("<i>"),c.push("</i>")),s.strike&&(l.push("<s>"),c.push("</s>"));var h=s.valign||"";return h=="superscript"||h=="super"?h="sup":h=="subscript"&&(h="sub"),h!=""&&(l.push("<"+h+">"),c.push("</"+h+">")),c.push("</span>"),s}function a(s){var l=[[],s.v,[]];return s.v?(s.s&&r(s.s,l[0],l[2]),l[0].join("")+l[1].replace(t,"<br/>")+l[2].join("")):""}return function(l){return l.map(a).join("")}})(),_N=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,wN=/<(?:\w+:)?r>/,bN=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function zm(e,t){var r=t?t.cellHTML:!0,a={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=Ft(Yt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=Yt(e),r&&(a.h=Am(a.t))):e.match(wN)&&(a.r=Yt(e),a.t=Ft(Yt((e.replace(bN,"").match(_N)||[]).join("").replace(pa,""))),r&&(a.h=yN(vN(a.r)))),a):{t:""}}var SN=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,EN=/<(?:\w+:)?(?:si|sstItem)>/g,TN=/<\/(?:\w+:)?(?:si|sstItem)>/;function kN(e,t){var r=[],a="";if(!e)return r;var s=e.match(SN);if(s){a=s[2].replace(EN,"").split(TN);for(var l=0;l!=a.length;++l){var c=zm(a[l].trim(),t);c!=null&&(r[r.length]=c)}s=dt(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}var AN=/^\s|\s$|[\t\n\r]/;function b2(e,t){if(!t.bookSST)return"";var r=[kr];r[r.length]=Be("sst",null,{xmlns:Ki[0],count:e.Count,uniqueCount:e.Unique});for(var a=0;a!=e.length;++a)if(e[a]!=null){var s=e[a],l="<si>";s.r?l+=s.r:(l+="<t",s.t||(s.t=""),s.t.match(AN)&&(l+=' xml:space="preserve"'),l+=">"+$t(s.t)+"</t>"),l+="</si>",r[r.length]=l}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function CN(e){return[e.read_shift(4),e.read_shift(4)]}function NN(e,t){var r=[],a=!1;return vs(e,function(l,c,u){switch(u){case 159:r.Count=l[0],r.Unique=l[1];break;case 19:r.push(l);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(c.T,!a||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}),r}function ON(e,t){return t||(t=ye(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var RN=zA;function DN(e){var t=Da();Ce(t,159,ON(e));for(var r=0;r<e.length;++r)Ce(t,19,RN(e[r]));return Ce(t,160),t.end()}function S2(e){for(var t=[],r=e.split(""),a=0;a<r.length;++a)t[a]=r[a].charCodeAt(0);return t}function ms(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function FN(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=ms(e,4),t.U=ms(e,4),t.W=ms(e,4),t}function MN(e){for(var t=e.read_shift(4),r=e.l+t-4,a={},s=e.read_shift(4),l=[];s-- >0;)l.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(a.name=e.read_shift(0,"lpp4"),a.comps=l,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return a}function LN(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(MN(e));return t}function BN(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function IN(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=ms(e,4),t.U=ms(e,4),t.W=ms(e,4),t}function jN(e){var t=IN(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function E2(e,t){var r=e.l+t,a={};a.Flags=e.read_shift(4)&63,e.l+=4,a.AlgID=e.read_shift(4);var s=!1;switch(a.AlgID){case 26126:case 26127:case 26128:s=a.Flags==36;break;case 26625:s=a.Flags==4;break;case 0:s=a.Flags==16||a.Flags==4||a.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=e.read_shift(4),a.KeySize=e.read_shift(4),a.ProviderType=e.read_shift(4),e.l+=8,a.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,a}function T2(e,t){var r={},a=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,a),e.l=a,r}function UN(e){var t=ms(e);switch(t.Minor){case 2:return[t.Minor,PN(e)];case 3:return[t.Minor,zN()];case 4:return[t.Minor,HN(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function PN(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),a=E2(e,r),s=T2(e,e.length-e.l);return{t:"Std",h:a,v:s}}function zN(){throw new Error("File is password-protected: ECMA-376 Extensible")}function HN(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),a={};return r.replace(pa,function(l){var c=dt(l);switch(Un(c[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(u){a[u]=c[u]});break;case"<dataIntegrity":a.encryptedHmacKey=c.encryptedHmacKey,a.encryptedHmacValue=c.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":a.uri=c.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":a.encs.push(c);break;default:throw c[0]}}),a}function $N(e,t){var r={},a=r.EncryptionVersionInfo=ms(e,4);if(t-=4,a.Minor!=2)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);r.Flags=e.read_shift(4),t-=4;var s=e.read_shift(4);return t-=4,r.EncryptionHeader=E2(e,s),t-=s,r.EncryptionVerifier=T2(e,t),r}function VN(e){var t={},r=t.EncryptionVersionInfo=ms(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function Hm(e){var t=0,r,a=S2(e),s=a.length+1,l,c,u,h,d;for(r=ri(s),r[0]=a.length,l=1;l!=s;++l)r[l]=a[l-1];for(l=s-1;l>=0;--l)c=r[l],u=(t&16384)===0?0:1,h=t<<1&32767,d=u|h,t=d^c;return t^52811}var k2=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(c){return(c/2|c*128)&255},s=function(c,u){return a(c^u)},l=function(c){for(var u=t[c.length-1],h=104,d=c.length-1;d>=0;--d)for(var g=c[d],x=0;x!=7;++x)g&64&&(u^=r[h]),g*=2,--h;return u};return function(c){for(var u=S2(c),h=l(u),d=u.length,g=ri(16),x=0;x!=16;++x)g[x]=0;var v,_,b;for((d&1)===1&&(v=h>>8,g[d]=s(e[0],v),--d,v=h&255,_=u[u.length-1],g[d]=s(_,v));d>0;)--d,v=h>>8,g[d]=s(u[d],v),--d,v=h&255,g[d]=s(u[d],v);for(d=15,b=15-u.length;b>0;)v=h>>8,g[d]=s(e[b],v),--d,--b,v=h&255,g[d]=s(u[d],v),--d,--b;return g}})(),GN=function(e,t,r,a,s){s||(s=t),a||(a=k2(e));var l,c;for(l=0;l!=t.length;++l)c=t[l],c^=a[r],c=(c>>5|c<<3)&255,s[l]=c,++r;return[s,r,a]},qN=function(e){var t=0,r=k2(e);return function(a){var s=GN("",a,t,r);return t=s[1],s[0]}};function XN(e,t,r,a){var s={key:Lr(e),verificationBytes:Lr(e)};return r.password&&(s.verifier=Hm(r.password)),a.valid=s.verificationBytes===s.verifier,a.valid&&(a.insitu=qN(r.password)),s}function WN(e,t,r){var a=r||{};return a.Info=e.read_shift(2),e.l-=2,a.Info===1?a.Data=VN(e):a.Data=$N(e,t),a}function KN(e,t,r){var a={Type:r.biff>=8?e.read_shift(2):0};return a.Type?WN(e,t-2,a):XN(e,r.biff>=8?t:t-2,r,a),a}var A2=(function(){function e(s,l){switch(l.type){case"base64":return t(Ya(s),l);case"binary":return t(s,l);case"buffer":return t(wt&&Buffer.isBuffer(s)?s.toString("binary"):li(s),l);case"array":return t($i(s),l)}throw new Error("Unrecognized type "+l.type)}function t(s,l){var c=l||{},u=c.dense?[]:{},h=s.match(/\\trowd.*?\\row\b/g);if(!h.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:h.length-1}};return h.forEach(function(g,x){Array.isArray(u)&&(u[x]=[]);for(var v=/\\\w+\b/g,_=0,b,y=-1;b=v.exec(g);){switch(b[0]){case"\\cell":var S=g.slice(_,v.lastIndex-b[0].length);if(S[0]==" "&&(S=S.slice(1)),++y,S.length){var k={v:S,t:"s"};Array.isArray(u)?u[x][y]=k:u[ht({r:x,c:y})]=k}break}_=v.lastIndex}y>d.e.c&&(d.e.c=y)}),u["!ref"]=vt(d),u}function r(s,l){return oi(e(s,l),l)}function a(s){for(var l=["{\\rtf1\\ansi"],c=Mt(s["!ref"]),u,h=Array.isArray(s),d=c.s.r;d<=c.e.r;++d){l.push("\\trowd\\trautofit1");for(var g=c.s.c;g<=c.e.c;++g)l.push("\\cellx"+(g+1));for(l.push("\\pard\\intbl"),g=c.s.c;g<=c.e.c;++g){var x=ht({r:d,c:g});u=h?(s[d]||[])[g]:s[x],!(!u||u.v==null&&(!u.f||u.F))&&(l.push(" "+(u.w||(gs(u),u.w))),l.push("\\cell"))}l.push("\\pard\\intbl\\row")}return l.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:a}})();function YN(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Ic(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function JN(e){var t=e[0]/255,r=e[1]/255,a=e[2]/255,s=Math.max(t,r,a),l=Math.min(t,r,a),c=s-l;if(c===0)return[0,0,t];var u=0,h=0,d=s+l;switch(h=c/(d>1?2-d:d),s){case t:u=((r-a)/c+6)%6;break;case r:u=(a-t)/c+2;break;case a:u=(t-r)/c+4;break}return[u/6,h,d/2]}function QN(e){var t=e[0],r=e[1],a=e[2],s=r*2*(a<.5?a:1-a),l=a-s/2,c=[l,l,l],u=6*t,h;if(r!==0)switch(u|0){case 0:case 6:h=s*u,c[0]+=s,c[1]+=h;break;case 1:h=s*(2-u),c[0]+=h,c[1]+=s;break;case 2:h=s*(u-2),c[1]+=s,c[2]+=h;break;case 3:h=s*(4-u),c[1]+=h,c[2]+=s;break;case 4:h=s*(u-4),c[2]+=s,c[0]+=h;break;case 5:h=s*(6-u),c[2]+=h,c[0]+=s;break}for(var d=0;d!=3;++d)c[d]=Math.round(c[d]*255);return c}function Hu(e,t){if(t===0)return e;var r=JN(YN(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Ic(QN(r))}var C2=6,ZN=15,e6=1,ha=C2;function jc(e){return Math.floor((e+Math.round(128/ha)/256)*ha)}function Uc(e){return Math.floor((e-5)/ha*100+.5)/100}function $u(e){return Math.round((e*ha+5)/ha*256)/256}function Od(e){return $u(Uc(jc(e)))}function $m(e){var t=Math.abs(e-Od(e)),r=ha;if(t>.005)for(ha=e6;ha<ZN;++ha)Math.abs(e-Od(e))<=t&&(t=Math.abs(e-Od(e)),r=ha);ha=r}function ai(e){e.width?(e.wpx=jc(e.width),e.wch=Uc(e.wpx),e.MDW=ha):e.wpx?(e.wch=Uc(e.wpx),e.width=$u(e.wch),e.MDW=ha):typeof e.wch=="number"&&(e.width=$u(e.wch),e.wpx=jc(e.width),e.MDW=ha),e.customWidth&&delete e.customWidth}var t6=96,N2=t6;function Pc(e){return e*96/N2}function uo(e){return e*N2/96}var r6={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function a6(e,t,r,a){t.Borders=[];var s={},l=!1;(e[0].match(pa)||[]).forEach(function(c){var u=dt(c);switch(Un(u[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},u.diagonalUp&&(s.diagonalUp=sr(u.diagonalUp)),u.diagonalDown&&(s.diagonalDown=sr(u.diagonalDown)),t.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(a&&a.WTF&&!l)throw new Error("unrecognized "+u[0]+" in borders")}})}function n6(e,t,r,a){t.Fills=[];var s={},l=!1;(e[0].match(pa)||[]).forEach(function(c){var u=dt(c);switch(Un(u[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},t.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":u.patternType&&(s.patternType=u.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),u.indexed&&(s.bgColor.indexed=parseInt(u.indexed,10)),u.theme&&(s.bgColor.theme=parseInt(u.theme,10)),u.tint&&(s.bgColor.tint=parseFloat(u.tint)),u.rgb&&(s.bgColor.rgb=u.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),u.theme&&(s.fgColor.theme=parseInt(u.theme,10)),u.tint&&(s.fgColor.tint=parseFloat(u.tint)),u.rgb!=null&&(s.fgColor.rgb=u.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(a&&a.WTF&&!l)throw new Error("unrecognized "+u[0]+" in fills")}})}function s6(e,t,r,a){t.Fonts=[];var s={},l=!1;(e[0].match(pa)||[]).forEach(function(c){var u=dt(c);switch(Un(u[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(s),s={};break;case"<name":u.val&&(s.name=Yt(u.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=u.val?sr(u.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=u.val?sr(u.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(u.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=u.val?sr(u.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=u.val?sr(u.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=u.val?sr(u.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=u.val?sr(u.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=u.val?sr(u.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":u.val&&(s.sz=+u.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":u.val&&(s.vertAlign=u.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":u.val&&(s.family=parseInt(u.val,10));break;case"<family/>":case"</family>":break;case"<scheme":u.val&&(s.scheme=u.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(u.val=="1")break;u.codepage=xm[parseInt(u.val,10)];break;case"<color":if(s.color||(s.color={}),u.auto&&(s.color.auto=sr(u.auto)),u.rgb)s.color.rgb=u.rgb.slice(-6);else if(u.indexed){s.color.index=parseInt(u.indexed,10);var h=ji[s.color.index];s.color.index==81&&(h=ji[1]),h||(h=ji[1]),s.color.rgb=h[0].toString(16)+h[1].toString(16)+h[2].toString(16)}else u.theme&&(s.color.theme=parseInt(u.theme,10),u.tint&&(s.color.tint=parseFloat(u.tint)),u.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=Hu(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":l=!0;break;case"</AlternateContent>":l=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(a&&a.WTF&&!l)throw new Error("unrecognized "+u[0]+" in fonts")}})}function i6(e,t,r){t.NumberFmt=[];for(var a=wr(ft),s=0;s<a.length;++s)t.NumberFmt[a[s]]=ft[a[s]];var l=e[0].match(pa);if(l)for(s=0;s<l.length;++s){var c=dt(l[s]);switch(Un(c[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var u=Ft(Yt(c.formatCode)),h=parseInt(c.numFmtId,10);if(t.NumberFmt[h]=u,h>0){if(h>392){for(h=392;h>60&&t.NumberFmt[h]!=null;--h);t.NumberFmt[h]=u}ds(u,h)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+c[0]+" in numFmts")}}}function l6(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)e[a]!=null&&(t[t.length]=Be("numFmt",null,{numFmtId:a,formatCode:$t(e[a])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Be("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Su=["numFmtId","fillId","fontId","borderId","xfId"],Eu=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function o6(e,t,r){t.CellXf=[];var a,s=!1;(e[0].match(pa)||[]).forEach(function(l){var c=dt(l),u=0;switch(Un(c[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(a=c,delete a[0],u=0;u<Su.length;++u)a[Su[u]]&&(a[Su[u]]=parseInt(a[Su[u]],10));for(u=0;u<Eu.length;++u)a[Eu[u]]&&(a[Eu[u]]=sr(a[Eu[u]]));if(t.NumberFmt&&a.numFmtId>392){for(u=392;u>60;--u)if(t.NumberFmt[a.numFmtId]==t.NumberFmt[u]){a.numFmtId=u;break}}t.CellXf.push(a);break;case"</xf>":break;case"<alignment":case"<alignment/>":var h={};c.vertical&&(h.vertical=c.vertical),c.horizontal&&(h.horizontal=c.horizontal),c.textRotation!=null&&(h.textRotation=c.textRotation),c.indent&&(h.indent=c.indent),c.wrapText&&(h.wrapText=sr(c.wrapText)),a.alignment=h;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+c[0]+" in cellXfs")}})}function c6(e){var t=[];return t[t.length]=Be("cellXfs",null),e.forEach(function(r){t[t.length]=Be("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Be("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var u6=(function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,a=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,l=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(u,h,d){var g={};if(!u)return g;u=u.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var x;return(x=u.match(t))&&i6(x,g,d),(x=u.match(s))&&s6(x,g,h,d),(x=u.match(a))&&n6(x,g,h,d),(x=u.match(l))&&a6(x,g,h,d),(x=u.match(r))&&o6(x,g,d),g}})();function O2(e,t){var r=[kr,Be("styleSheet",null,{xmlns:Ki[0],"xmlns:vt":Pr.vt})],a;return e.SSF&&(a=l6(e.SSF))!=null&&(r[r.length]=a),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(a=c6(t.cellXfs))&&(r[r.length]=a),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function f6(e,t){var r=e.read_shift(2),a=ma(e);return[r,a]}function h6(e,t,r){r||(r=ye(6+4*t.length)),r.write_shift(2,e),Wr(t,r);var a=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),a}function d6(e,t,r){var a={};a.sz=e.read_shift(2)/20;var s=WA(e);s.fItalic&&(a.italic=1),s.fCondense&&(a.condense=1),s.fExtend&&(a.extend=1),s.fShadow&&(a.shadow=1),s.fOutline&&(a.outline=1),s.fStrikeout&&(a.strike=1);var l=e.read_shift(2);switch(l===700&&(a.bold=1),e.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var c=e.read_shift(1);c!=0&&(a.underline=c);var u=e.read_shift(1);u>0&&(a.family=u);var h=e.read_shift(1);switch(h>0&&(a.charset=h),e.l++,a.color=XA(e),e.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=ma(e),a}function m6(e,t){t||(t=ye(153)),t.write_shift(2,e.sz*20),KA(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Uu(e.color,t);var a=0;return a=2,t.write_shift(1,a),Wr(e.name,t),t.length>t.l?t.slice(0,t.l):t}var g6=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Rd,p6=ga;function py(e,t){t||(t=ye(84)),Rd||(Rd=Ju(g6));var r=Rd[e.patternType];r==null&&(r=40),t.write_shift(4,r);var a=0;if(r!=40)for(Uu({auto:1},t),Uu({auto:1},t);a<12;++a)t.write_shift(4,0);else{for(;a<4;++a)t.write_shift(4,0);for(;a<12;++a)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function x6(e,t){var r=e.l+t,a=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:a,numFmtId:s}}function R2(e,t,r){r||(r=ye(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var a=0;return r.write_shift(1,a),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function cc(e,t){return t||(t=ye(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var v6=ga;function y6(e,t){return t||(t=ye(51)),t.write_shift(1,0),cc(null,t),cc(null,t),cc(null,t),cc(null,t),cc(null,t),t.length>t.l?t.slice(0,t.l):t}function _6(e,t){return t||(t=ye(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),ju(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function w6(e,t,r){var a=ye(2052);return a.write_shift(4,e),ju(t,a),ju(r,a),a.length>a.l?a.slice(0,a.l):a}function b6(e,t,r){var a={};a.NumberFmt=[];for(var s in ft)a.NumberFmt[s]=ft[s];a.CellXf=[],a.Fonts=[];var l=[],c=!1;return vs(e,function(h,d,g){switch(g){case 44:a.NumberFmt[h[0]]=h[1],ds(h[1],h[0]);break;case 43:a.Fonts.push(h),h.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(h.color.rgb=Hu(t.themeElements.clrScheme[h.color.theme].rgb,h.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:l[l.length-1]==617&&a.CellXf.push(h);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:c=!0;break;case 36:c=!1;break;case 37:l.push(g),c=!0;break;case 38:l.pop(),c=!1;break;default:if(d.T>0)l.push(g);else if(d.T<0)l.pop();else if(!c||r.WTF&&l[l.length-1]!=37)throw new Error("Unexpected record 0x"+g.toString(16))}}),a}function S6(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var s=a[0];s<=a[1];++s)t[s]!=null&&++r}),r!=0&&(Ce(e,615,Cn(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var s=a[0];s<=a[1];++s)t[s]!=null&&Ce(e,44,h6(s,t[s]))}),Ce(e,616))}}function E6(e){var t=1;Ce(e,611,Cn(t)),Ce(e,43,m6({sz:12,color:{theme:1},name:"Calibri",family:2})),Ce(e,612)}function T6(e){var t=2;Ce(e,603,Cn(t)),Ce(e,45,py({patternType:"none"})),Ce(e,45,py({patternType:"gray125"})),Ce(e,604)}function k6(e){var t=1;Ce(e,613,Cn(t)),Ce(e,46,y6()),Ce(e,614)}function A6(e){var t=1;Ce(e,626,Cn(t)),Ce(e,47,R2({numFmtId:0},65535)),Ce(e,627)}function C6(e,t){Ce(e,617,Cn(t.length)),t.forEach(function(r){Ce(e,47,R2(r,0))}),Ce(e,618)}function N6(e){var t=1;Ce(e,619,Cn(t)),Ce(e,48,_6({xfId:0,name:"Normal"})),Ce(e,620)}function O6(e){var t=0;Ce(e,505,Cn(t)),Ce(e,506)}function R6(e){var t=0;Ce(e,508,w6(t,"TableStyleMedium9","PivotStyleMedium4")),Ce(e,509)}function D6(e,t){var r=Da();return Ce(r,278),S6(r,e.SSF),E6(r),T6(r),k6(r),A6(r),C6(r,t.cellXfs),N6(r),O6(r),R6(r),Ce(r,279),r.end()}var F6=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function M6(e,t,r){t.themeElements.clrScheme=[];var a={};(e[0].match(pa)||[]).forEach(function(s){var l=dt(s);switch(l[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=l.val;break;case"<a:sysClr":a.rgb=l.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":l[0].charAt(1)==="/"?(t.themeElements.clrScheme[F6.indexOf(l[0])]=a,a={}):a.name=l[0].slice(3,l[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+l[0]+" in clrScheme")}})}function L6(){}function B6(){}var I6=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,j6=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,U6=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function P6(e,t,r){t.themeElements={};var a;[["clrScheme",I6,M6],["fontScheme",j6,L6],["fmtScheme",U6,B6]].forEach(function(s){if(!(a=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](a,t,r)})}var z6=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function D2(e,t){(!e||e.length===0)&&(e=Vm());var r,a={};if(!(r=e.match(z6)))throw new Error("themeElements not found in theme");return P6(r[0],a,t),a.raw=e,a}function Vm(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[kr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function H6(e,t,r){var a=e.l+t,s=e.read_shift(4);if(s!==124226){if(!r.cellStyles){e.l=a;return}var l=e.slice(e.l);e.l=a;var c;try{c=E_(l,{type:"array"})}catch{return}var u=Ka(c,"theme/theme/theme1.xml",!0);if(u)return D2(u,r)}}function $6(e){return e.read_shift(4)}function V6(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=G6(e,4);break;case 2:t.xclrValue=f2(e);break;case 3:t.xclrValue=$6(e);break;case 4:e.l+=4;break}return e.l+=8,t}function G6(e,t){return ga(e,t)}function q6(e,t){return ga(e,t)}function X6(e){var t=e.read_shift(2),r=e.read_shift(2)-4,a=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=V6(e);break;case 6:a[1]=q6(e,r);break;case 14:case 15:a[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return a}function W6(e,t){var r=e.l+t;e.l+=2;var a=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),l=[];s-- >0;)l.push(X6(e,r-e.l));return{ixfe:a,ext:l}}function K6(e,t){t.forEach(function(r){r[0]})}function Y6(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:ma(e)}}function J6(e){var t=ye(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Wr(e.name,t),t.slice(0,t.l)}function Q6(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function Z6(e){var t=ye(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function e8(e,t){var r=ye(8+2*t.length);return r.write_shift(4,e),Wr(t,r),r.slice(0,r.l)}function t8(e){return e.l+=4,e.read_shift(4)!=0}function r8(e,t){var r=ye(8);return r.write_shift(4,e),r.write_shift(4,1),r}function a8(e,t,r){var a={Types:[],Cell:[],Value:[]},s=r||{},l=[],c=!1,u=2;return vs(e,function(h,d,g){switch(g){case 335:a.Types.push({name:h.name});break;case 51:h.forEach(function(x){u==1?a.Cell.push({type:a.Types[x[0]-1].name,index:x[1]}):u==0&&a.Value.push({type:a.Types[x[0]-1].name,index:x[1]})});break;case 337:u=h?1:0;break;case 338:u=2;break;case 35:l.push(g),c=!0;break;case 36:l.pop(),c=!1;break;default:if(!d.T){if(!c||s.WTF&&l[l.length-1]!=35)throw new Error("Unexpected record 0x"+g.toString(16))}}}),a}function n8(){var e=Da();return Ce(e,332),Ce(e,334,Cn(1)),Ce(e,335,J6({name:"XLDAPR",version:12e4,flags:3496657072})),Ce(e,336),Ce(e,339,e8(1,"XLDAPR")),Ce(e,52),Ce(e,35,Cn(514)),Ce(e,4096,Cn(0)),Ce(e,4097,dn(1)),Ce(e,36),Ce(e,53),Ce(e,340),Ce(e,337,r8(1)),Ce(e,51,Z6([[1,0]])),Ce(e,338),Ce(e,333),e.end()}function s8(e,t,r){var a={Types:[],Cell:[],Value:[]};if(!e)return a;var s=!1,l=2,c;return e.replace(pa,function(u){var h=dt(u);switch(Un(h[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":a.Types.push({name:h.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<a.Types.length;++d)a.Types[d].name==h.name&&(c=a.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":l==1?a.Cell.push({type:a.Types[h.t-1].name,index:+h.v}):l==0&&a.Value.push({type:a.Types[h.t-1].name,index:+h.v});break;case"</rc>":break;case"<cellMetadata":l=1;break;case"</cellMetadata>":l=2;break;case"<valueMetadata":l=0;break;case"</valueMetadata>":l=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!c)break;c.offsets||(c.offsets=[]),c.offsets.push(+h.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+h[0]+" in metadata")}return u}),a}function F2(){var e=[kr];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function i8(e){var t=[];if(!e)return t;var r=1;return(e.match(pa)||[]).forEach(function(a){var s=dt(a);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,t.push(s);break}}),t}function l8(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=ht(r);var a=e.read_shift(1);return a&2&&(t.l="1"),a&8&&(t.a="1"),t}function o8(e,t,r){var a=[];return vs(e,function(l,c,u){switch(u){case 63:a.push(l);break;default:if(!c.T)throw new Error("Unexpected record 0x"+u.toString(16))}}),a}function c8(e,t,r,a){if(!e)return e;var s=a||{},l=!1;vs(e,function(u,h,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:l=!0;break;case 36:l=!1;break;default:if(!h.T){if(!l||s.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},s)}function u8(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var eo=1024;function M2(e,t){for(var r=[21600,21600],a=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[Be("xml",null,{"xmlns:v":Va.v,"xmlns:o":Va.o,"xmlns:x":Va.x,"xmlns:mv":Va.mv}).replace(/\/>/,">"),Be("o:shapelayout",Be("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Be("v:shapetype",[Be("v:stroke",null,{joinstyle:"miter"}),Be("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:a})];eo<e*1e3;)eo+=1e3;return t.forEach(function(l){var c=mr(l[0]),u={color2:"#BEFF82",type:"gradient"};u.type=="gradient"&&(u.angle="-180");var h=u.type=="gradient"?Be("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=Be("v:fill",h,u),g={on:"t",obscured:"t"};++eo,s=s.concat(["<v:shape"+Mc({id:"_x0000_s"+eo,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(l[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,Be("v:shadow",null,g),Be("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",na("x:Anchor",[c.c+1,0,c.r+1,0,c.c+3,20,c.r+5,20].join(",")),na("x:AutoFill","False"),na("x:Row",String(c.r)),na("x:Column",String(c.c)),l[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function xy(e,t,r,a){var s=Array.isArray(e),l;t.forEach(function(c){var u=mr(c.ref);if(s?(e[u.r]||(e[u.r]=[]),l=e[u.r][u.c]):l=e[c.ref],!l){l={t:"z"},s?e[u.r][u.c]=l:e[c.ref]=l;var h=Mt(e["!ref"]||"BDWGO1000001:A1");h.s.r>u.r&&(h.s.r=u.r),h.e.r<u.r&&(h.e.r=u.r),h.s.c>u.c&&(h.s.c=u.c),h.e.c<u.c&&(h.e.c=u.c);var d=vt(h);d!==e["!ref"]&&(e["!ref"]=d)}l.c||(l.c=[]);var g={a:c.author,t:c.t,r:c.r,T:r};c.h&&(g.h=c.h);for(var x=l.c.length-1;x>=0;--x){if(!r&&l.c[x].T)return;r&&!l.c[x].T&&l.c.splice(x,1)}if(r&&a){for(x=0;x<a.length;++x)if(g.a==a[x].id){g.a=a[x].name||g.a;break}}l.c.push(g)})}function f8(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],a=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(c){if(!(c===""||c.trim()==="")){var u=c.match(/<(?:\w+:)?author[^>]*>(.*)/);u&&r.push(u[1])}});var l=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return l&&l[1]&&l[1].split(/<\/\w*:?comment>/).forEach(function(c){if(!(c===""||c.trim()==="")){var u=c.match(/<(?:\w+:)?comment[^>]*>/);if(u){var h=dt(u[0]),d={author:h.authorId&&r[h.authorId]||"sheetjsghost",ref:h.ref,guid:h.guid},g=mr(h.ref);if(!(t.sheetRows&&t.sheetRows<=g.r)){var x=c.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),v=!!x&&!!x[1]&&zm(x[1])||{r:"",t:"",h:""};d.r=v.r,v.r=="<t></t>"&&(v.t=v.h=""),d.t=(v.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(d.h=v.h),a.push(d)}}}}),a}function L2(e){var t=[kr,Be("comments",null,{xmlns:Ki[0]})],r=[];return t.push("<authors>"),e.forEach(function(a){a[1].forEach(function(s){var l=$t(s.a);r.indexOf(l)==-1&&(r.push(l),t.push("<author>"+l+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),t.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(a){var s=0,l=[];if(a[1][0]&&a[1][0].T&&a[1][0].ID?s=r.indexOf("tc="+a[1][0].ID):a[1].forEach(function(h){h.a&&(s=r.indexOf($t(h.a))),l.push(h.t||"")}),t.push('<comment ref="'+a[0]+'" authorId="'+s+'"><text>'),l.length<=1)t.push(na("t",$t(l[0]||"")));else{for(var c=`Comment:
    `+l[0]+`
`,u=1;u<l.length;++u)c+=`Reply:
    `+l[u]+`
`;t.push(na("t",$t(c)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function h8(e,t){var r=[],a=!1,s={},l=0;return e.replace(pa,function(u,h){var d=dt(u);switch(Un(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":l=h+u.length;break;case"</text>":s.t=e.slice(l,h).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":a=!0;break;case"</mentions>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return u}),r}function d8(e,t,r){var a=[kr,Be("ThreadedComments",null,{xmlns:Pr.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var l="";(s[1]||[]).forEach(function(c,u){if(!c.T){delete c.ID;return}c.a&&t.indexOf(c.a)==-1&&t.push(c.a);var h={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};u==0?l=h.id:h.parentId=l,c.ID=h.id,c.a&&(h.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(c.a)).slice(-12)+"}"),a.push(Be("threadedComment",na("text",c.t||""),h))})}),a.push("</ThreadedComments>"),a.join("")}function m8(e,t){var r=[],a=!1;return e.replace(pa,function(l){var c=dt(l);switch(Un(c[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:c.displayname,id:c.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return l}),r}function g8(e){var t=[kr,Be("personList",null,{xmlns:Pr.TCMNT,"xmlns:x":Ki[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,a){t.push(Be("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+a).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function p8(e){var t={};t.iauthor=e.read_shift(4);var r=Zi(e);return t.rfx=r.s,t.ref=ht(r.s),e.l+=16,t}function x8(e,t){return t==null&&(t=ye(36)),t.write_shift(4,e[1].iauthor),po(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var v8=ma;function y8(e){return Wr(e.slice(0,54))}function _8(e,t){var r=[],a=[],s={},l=!1;return vs(e,function(u,h,d){switch(d){case 632:a.push(u);break;case 635:s=u;break;case 637:s.t=u.t,s.h=u.h,s.r=u.r;break;case 636:if(s.author=a[s.iauthor],delete s.iauthor,t.sheetRows&&s.rfx&&t.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!h.T){if(!l||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),r}function w8(e){var t=Da(),r=[];return Ce(t,628),Ce(t,630),e.forEach(function(a){a[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),Ce(t,632,y8(s.a)))})}),Ce(t,631),Ce(t,633),e.forEach(function(a){a[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var l={s:mr(a[0]),e:mr(a[0])};Ce(t,635,x8([l,s])),s.t&&s.t.length>0&&Ce(t,637,$A(s)),Ce(t,636),delete s.iauthor})}),Ce(t,634),Ce(t,629),t.end()}var b8="application/vnd.ms-office.vbaProject";function S8(e){var t=it.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,a){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");it.utils.cfb_add(t,s,e.FileIndex[a].content)}}),it.write(t)}function E8(e,t){t.FullPaths.forEach(function(r,a){if(a!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&it.utils.cfb_add(e,s,t.FileIndex[a].content)}})}var B2=["xlsb","xlsm","xlam","biff8","xla"];function T8(){return{"!type":"dialog"}}function k8(){return{"!type":"dialog"}}function A8(){return{"!type":"macro"}}function C8(){return{"!type":"macro"}}var no=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(a,s,l,c){var u=!1,h=!1;l.length==0?h=!0:l.charAt(0)=="["&&(h=!0,l=l.slice(1,-1)),c.length==0?u=!0:c.charAt(0)=="["&&(u=!0,c=c.slice(1,-1));var d=l.length>0?parseInt(l,10)|0:0,g=c.length>0?parseInt(c,10)|0:0;return u?g+=t.c:--g,h?d+=t.r:--d,s+(u?"":"$")+dr(g)+(h?"":"$")+Tr(d)}return function(s,l){return t=l,s.replace(e,r)}})(),Gm=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,qm=(function(){return function(t,r){return t.replace(Gm,function(a,s,l,c,u,h){var d=Dm(c)-(l?0:r.c),g=Rm(h)-(u?0:r.r),x=g==0?"":u?g+1:"["+g+"]",v=d==0?"":l?d+1:"["+d+"]";return s+"R"+x+"C"+v})}})();function I2(e,t){return e.replace(Gm,function(r,a,s,l,c,u){return a+(s=="$"?s+l:dr(Dm(l)+t.c))+(c=="$"?c+u:Tr(Rm(u)+t.r))})}function N8(e,t,r){var a=Fa(t),s=a.s,l=mr(r),c={r:l.r-s.r,c:l.c-s.c};return I2(e,c)}function O8(e){return e.length!=1}function vy(e){return e.replace(/_xlfn\./g,"")}function Fr(e){e.l+=1}function ni(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function j2(e,t,r){var a=2;if(r){if(r.biff>=2&&r.biff<=5)return U2(e);r.biff==12&&(a=4)}var s=e.read_shift(a),l=e.read_shift(a),c=ni(e),u=ni(e);return{s:{r:s,c:c[0],cRel:c[1],rRel:c[2]},e:{r:l,c:u[0],cRel:u[1],rRel:u[2]}}}function U2(e){var t=ni(e),r=ni(e),a=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:a,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function R8(e,t,r){if(r.biff<8)return U2(e);var a=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),l=ni(e),c=ni(e);return{s:{r:a,c:l[0],cRel:l[1],rRel:l[2]},e:{r:s,c:c[0],cRel:c[1],rRel:c[2]}}}function P2(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return D8(e);var a=e.read_shift(r&&r.biff==12?4:2),s=ni(e);return{r:a,c:s[0],cRel:s[1],rRel:s[2]}}function D8(e){var t=ni(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function F8(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function M8(e,t,r){var a=r&&r.biff?r.biff:8;if(a>=2&&a<=5)return L8(e);var s=e.read_shift(a>=12?4:2),l=e.read_shift(2),c=(l&16384)>>14,u=(l&32768)>>15;if(l&=16383,u==1)for(;s>524287;)s-=1048576;if(c==1)for(;l>8191;)l=l-16384;return{r:s,c:l,cRel:c,rRel:u}}function L8(e){var t=e.read_shift(2),r=e.read_shift(1),a=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,a==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:a}}function B8(e,t,r){var a=(e[e.l++]&96)>>5,s=j2(e,r.biff>=2&&r.biff<=5?6:8,r);return[a,s]}function I8(e,t,r){var a=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),l=8;if(r)switch(r.biff){case 5:e.l+=12,l=6;break;case 12:l=12;break}var c=j2(e,l,r);return[a,s,c]}function j8(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[a]}function U8(e,t,r){var a=(e[e.l++]&96)>>5,s=e.read_shift(2),l=8;if(r)switch(r.biff){case 5:e.l+=12,l=6;break;case 12:l=12;break}return e.l+=l,[a,s]}function P8(e,t,r){var a=(e[e.l++]&96)>>5,s=R8(e,t-1,r);return[a,s]}function z8(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[a]}function yy(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function H8(e,t,r){e.l+=2;for(var a=e.read_shift(r&&r.biff==2?1:2),s=[],l=0;l<=a;++l)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function $8(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function V8(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function G8(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function q8(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[a]}function z2(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function X8(e){return e.read_shift(2),z2(e)}function W8(e){return e.read_shift(2),z2(e)}function K8(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=P2(e,0,r);return[a,s]}function Y8(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=M8(e,0,r);return[a,s]}function J8(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var l=P2(e,0,r);return[a,s,l]}function Q8(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[t5[s],V2[s],a]}function Z8(e,t,r){var a=e[e.l++],s=e.read_shift(1),l=r&&r.biff<=3?[a==88?-1:0,e.read_shift(1)]:eO(e);return[s,(l[0]===0?V2:e5)[l[1]]]}function eO(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function tO(e,t,r){e.l+=r&&r.biff==2?3:4}function rO(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var a=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[a,s]}function aO(e){return e.l++,ys[e.read_shift(1)]}function nO(e){return e.l++,e.read_shift(2)}function sO(e){return e.l++,e.read_shift(1)!==0}function iO(e){return e.l++,da(e)}function lO(e,t,r){return e.l++,Kc(e,t-1,r)}function oO(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Er(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=ys[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=da(e);break;case 2:r[1]=el(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function cO(e,t,r){for(var a=e.read_shift(r.biff==12?4:2),s=[],l=0;l!=a;++l)s.push((r.biff==12?Zi:ef)(e));return s}function uO(e,t,r){var a=0,s=0;r.biff==12?(a=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),a=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--a,--s==0&&(s=256));for(var l=0,c=[];l!=a&&(c[l]=[]);++l)for(var u=0;u!=s;++u)c[l][u]=oO(e,r.biff);return c}function fO(e,t,r){var a=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,l=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[a,0,l]}function hO(e,t,r){if(r.biff==5)return dO(e);var a=e.read_shift(1)>>>5&3,s=e.read_shift(2),l=e.read_shift(4);return[a,s,l]}function dO(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var a=e.read_shift(2);return e.l+=12,[t,r,a]}function mO(e,t,r){var a=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[a,s]}function gO(e,t,r){var a=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[a,s]}function pO(e,t,r){var a=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[a]}function xO(e,t,r){var a=(e[e.l++]&96)>>5,s=e.read_shift(2),l=4;if(r)switch(r.biff){case 5:l=15;break;case 12:l=6;break}return e.l+=l,[a,s]}var vO=ga,yO=ga,_O=ga;function Jc(e,t,r){return e.l+=2,[F8(e)]}function Xm(e){return e.l+=6,[]}var wO=Jc,bO=Xm,SO=Xm,EO=Jc;function H2(e){return e.l+=2,[Lr(e),e.read_shift(2)&1]}var TO=Jc,kO=H2,AO=Xm,CO=Jc,NO=Jc,OO=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function RO(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),s=e.read_shift(2),l=e.read_shift(2),c=OO[r>>2&31];return{ixti:t,coltype:r&3,rt:c,idx:a,c:s,C:l}}function DO(e){return e.l+=2,[e.read_shift(4)]}function FO(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function MO(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function LO(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function BO(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function IO(e){return e.l+=4,[0,0]}var _y={1:{n:"PtgExp",f:rO},2:{n:"PtgTbl",f:_O},3:{n:"PtgAdd",f:Fr},4:{n:"PtgSub",f:Fr},5:{n:"PtgMul",f:Fr},6:{n:"PtgDiv",f:Fr},7:{n:"PtgPower",f:Fr},8:{n:"PtgConcat",f:Fr},9:{n:"PtgLt",f:Fr},10:{n:"PtgLe",f:Fr},11:{n:"PtgEq",f:Fr},12:{n:"PtgGe",f:Fr},13:{n:"PtgGt",f:Fr},14:{n:"PtgNe",f:Fr},15:{n:"PtgIsect",f:Fr},16:{n:"PtgUnion",f:Fr},17:{n:"PtgRange",f:Fr},18:{n:"PtgUplus",f:Fr},19:{n:"PtgUminus",f:Fr},20:{n:"PtgPercent",f:Fr},21:{n:"PtgParen",f:Fr},22:{n:"PtgMissArg",f:Fr},23:{n:"PtgStr",f:lO},26:{n:"PtgSheet",f:FO},27:{n:"PtgEndSheet",f:MO},28:{n:"PtgErr",f:aO},29:{n:"PtgBool",f:sO},30:{n:"PtgInt",f:nO},31:{n:"PtgNum",f:iO},32:{n:"PtgArray",f:z8},33:{n:"PtgFunc",f:Q8},34:{n:"PtgFuncVar",f:Z8},35:{n:"PtgName",f:fO},36:{n:"PtgRef",f:K8},37:{n:"PtgArea",f:B8},38:{n:"PtgMemArea",f:mO},39:{n:"PtgMemErr",f:vO},40:{n:"PtgMemNoMem",f:yO},41:{n:"PtgMemFunc",f:gO},42:{n:"PtgRefErr",f:pO},43:{n:"PtgAreaErr",f:j8},44:{n:"PtgRefN",f:Y8},45:{n:"PtgAreaN",f:P8},46:{n:"PtgMemAreaN",f:LO},47:{n:"PtgMemNoMemN",f:BO},57:{n:"PtgNameX",f:hO},58:{n:"PtgRef3d",f:J8},59:{n:"PtgArea3d",f:I8},60:{n:"PtgRefErr3d",f:xO},61:{n:"PtgAreaErr3d",f:U8},255:{}},jO={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},UO={1:{n:"PtgElfLel",f:H2},2:{n:"PtgElfRw",f:CO},3:{n:"PtgElfCol",f:wO},6:{n:"PtgElfRwV",f:NO},7:{n:"PtgElfColV",f:EO},10:{n:"PtgElfRadical",f:TO},11:{n:"PtgElfRadicalS",f:AO},13:{n:"PtgElfColS",f:bO},15:{n:"PtgElfColSV",f:SO},16:{n:"PtgElfRadicalLel",f:kO},25:{n:"PtgList",f:RO},29:{n:"PtgSxName",f:DO},255:{}},PO={0:{n:"PtgAttrNoop",f:IO},1:{n:"PtgAttrSemi",f:q8},2:{n:"PtgAttrIf",f:V8},4:{n:"PtgAttrChoose",f:H8},8:{n:"PtgAttrGoto",f:$8},16:{n:"PtgAttrSum",f:tO},32:{n:"PtgAttrBaxcel",f:yy},33:{n:"PtgAttrBaxcel",f:yy},64:{n:"PtgAttrSpace",f:X8},65:{n:"PtgAttrSpaceSemi",f:W8},128:{n:"PtgAttrIfError",f:G8},255:{}};function Qc(e,t,r,a){if(a.biff<8)return ga(e,t);for(var s=e.l+t,l=[],c=0;c!==r.length;++c)switch(r[c][0]){case"PtgArray":r[c][1]=uO(e,0,a),l.push(r[c][1]);break;case"PtgMemArea":r[c][2]=cO(e,r[c][1],a),l.push(r[c][2]);break;case"PtgExp":a&&a.biff==12&&(r[c][1][1]=e.read_shift(4),l.push(r[c][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[c][0]}return t=s-e.l,t!==0&&l.push(ga(e,t)),l}function Zc(e,t,r){for(var a=e.l+t,s,l,c=[];a!=e.l;)t=a-e.l,l=e[e.l],s=_y[l]||_y[jO[l]],(l===24||l===25)&&(s=(l===24?UO:PO)[e[e.l+1]]),!s||!s.f?ga(e,t):c.push([s.n,s.f(e,t,r)]);return c}function zO(e){for(var t=[],r=0;r<e.length;++r){for(var a=e[r],s=[],l=0;l<a.length;++l){var c=a[l];c?c[0]===2?s.push('"'+c[1].replace(/"/g,'""')+'"'):s.push(c[1]):s.push("")}t.push(s.join(","))}return t.join(";")}var HO={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function $O(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function $2(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var a=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!a)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[a[0]][0]){case 357:return s=a[1]==-1?"#REF":e.SheetNames[a[1]],a[1]==a[2]?s:s+":"+e.SheetNames[a[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[a[0]][0];default:return"SH33TJSSRC"+e[a[0]][0]}switch(e[a[0]][0][0]){case 1025:return s=a[1]==-1?"#REF":e.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?s:s+":"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map(function(l){return l.Name}).join(";;");default:return e[a[0]][0][3]?(s=a[1]==-1?"#REF":e[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?s:s+":"+e[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function wy(e,t,r){var a=$2(e,t,r);return a=="#REF"?a:$O(a,r)}function fa(e,t,r,a,s){var l=s&&s.biff||8,c={s:{c:0,r:0}},u=[],h,d,g,x=0,v=0,_,b="";if(!e[0]||!e[0][0])return"";for(var y=-1,S="",k=0,R=e[0].length;k<R;++k){var T=e[0][k];switch(T[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(h=u.pop(),d=u.pop(),y>=0){switch(e[0][y][1][0]){case 0:S=yr(" ",e[0][y][1][1]);break;case 1:S=yr("\r",e[0][y][1][1]);break;default:if(S="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][y][1][0])}d=d+S,y=-1}u.push(d+HO[T[0]]+h);break;case"PtgIsect":h=u.pop(),d=u.pop(),u.push(d+" "+h);break;case"PtgUnion":h=u.pop(),d=u.pop(),u.push(d+","+h);break;case"PtgRange":h=u.pop(),d=u.pop(),u.push(d+":"+h);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":g=xc(T[1][1],c,s),u.push(vc(g,l));break;case"PtgRefN":g=r?xc(T[1][1],r,s):T[1][1],u.push(vc(g,l));break;case"PtgRef3d":x=T[1][1],g=xc(T[1][2],c,s),b=wy(a,x,s),u.push(b+"!"+vc(g,l));break;case"PtgFunc":case"PtgFuncVar":var j=T[1][0],X=T[1][1];j||(j=0),j&=127;var L=j==0?[]:u.slice(-j);u.length-=j,X==="User"&&(X=L.shift()),u.push(X+"("+L.join(",")+")");break;case"PtgBool":u.push(T[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(T[1]);break;case"PtgNum":u.push(String(T[1]));break;case"PtgStr":u.push('"'+T[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(T[1]);break;case"PtgAreaN":_=Yv(T[1][1],r?{s:r}:c,s),u.push(Ad(_,s));break;case"PtgArea":_=Yv(T[1][1],c,s),u.push(Ad(_,s));break;case"PtgArea3d":x=T[1][1],_=T[1][2],b=wy(a,x,s),u.push(b+"!"+Ad(_,s));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":v=T[1][2];var A=(a.names||[])[v-1]||(a[0]||[])[v],K=A?A.Name:"SH33TJSNAME"+String(v);K&&K.slice(0,6)=="_xlfn."&&!s.xlfn&&(K=K.slice(6)),u.push(K);break;case"PtgNameX":var q=T[1][1];v=T[1][2];var ie;if(s.biff<=5)q<0&&(q=-q),a[q]&&(ie=a[q][v]);else{var ne="";if(((a[q]||[])[0]||[])[0]==14849||(((a[q]||[])[0]||[])[0]==1025?a[q][v]&&a[q][v].itab>0&&(ne=a.SheetNames[a[q][v].itab-1]+"!"):ne=a.SheetNames[v-1]+"!"),a[q]&&a[q][v])ne+=a[q][v].Name;else if(a[0]&&a[0][v])ne+=a[0][v].Name;else{var Z=($2(a,q,s)||"").split(";;");Z[v-1]?ne=Z[v-1]:ne+="SH33TJSERRX"}u.push(ne);break}ie||(ie={Name:"SH33TJSERRY"}),u.push(ie.Name);break;case"PtgParen":var me="(",Re=")";if(y>=0){switch(S="",e[0][y][1][0]){case 2:me=yr(" ",e[0][y][1][1])+me;break;case 3:me=yr("\r",e[0][y][1][1])+me;break;case 4:Re=yr(" ",e[0][y][1][1])+Re;break;case 5:Re=yr("\r",e[0][y][1][1])+Re;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][y][1][0])}y=-1}u.push(me+u.pop()+Re);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":g={c:T[1][1],r:T[1][0]};var Ae={c:r.c,r:r.r};if(a.sharedf[ht(g)]){var V=a.sharedf[ht(g)];u.push(fa(V,c,Ae,a,s))}else{var ae=!1;for(h=0;h!=a.arrayf.length;++h)if(d=a.arrayf[h],!(g.c<d[0].s.c||g.c>d[0].e.c)&&!(g.r<d[0].s.r||g.r>d[0].e.r)){u.push(fa(d[1],c,Ae,a,s)),ae=!0;break}ae||u.push(T[1])}break;case"PtgArray":u.push("{"+zO(T[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":y=k;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+T[1].idx+"[#"+T[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(T));default:throw new Error("Unrecognized Formula Token: "+String(T))}var xe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&y>=0&&xe.indexOf(e[0][k][0])==-1){T=e[0][y];var J=!0;switch(T[1][0]){case 4:J=!1;case 0:S=yr(" ",T[1][1]);break;case 5:J=!1;case 1:S=yr("\r",T[1][1]);break;default:if(S="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+T[1][0])}u.push((J?S:"")+u.pop()+(J?"":S)),y=-1}}if(u.length>1&&s.WTF)throw new Error("bad formula stack");return u[0]}function VO(e,t,r){var a=e.l+t,s=r.biff==2?1:2,l,c=e.read_shift(s);if(c==65535)return[[],ga(e,t-2)];var u=Zc(e,c,r);return t!==c+s&&(l=Qc(e,t-c-s,u,r)),e.l=a,[u,l]}function GO(e,t,r){var a=e.l+t,s=r.biff==2?1:2,l,c=e.read_shift(s);if(c==65535)return[[],ga(e,t-2)];var u=Zc(e,c,r);return t!==c+s&&(l=Qc(e,t-c-s,u,r)),e.l=a,[u,l]}function qO(e,t,r,a){var s=e.l+t,l=Zc(e,a,r),c;return s!==e.l&&(c=Qc(e,s-e.l,l,r)),[l,c]}function XO(e,t,r){var a=e.l+t,s,l=e.read_shift(2),c=Zc(e,l,r);return l==65535?[[],ga(e,t-2)]:(t!==l+2&&(s=Qc(e,a-l-2,c,r)),[c,s])}function WO(e){var t;if(fs(e,e.l+6)!==65535)return[da(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function KO(e){if(e==null){var t=ye(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Vi(e);return Vi(0)}function Dd(e,t,r){var a=e.l+t,s=Pn(e);r.biff==2&&++e.l;var l=WO(e),c=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var u=GO(e,a-e.l,r);return{cell:s,val:l[0],formula:u,shared:c>>3&1,tt:l[1]}}function YO(e,t,r,a,s){var l=qi(t,r,s),c=KO(e.v),u=ye(6),h=33;u.write_shift(2,h),u.write_shift(4,0);for(var d=ye(e.bf.length),g=0;g<e.bf.length;++g)d[g]=e.bf[g];var x=Xr([l,c,u,d]);return x}function tf(e,t,r){var a=e.read_shift(4),s=Zc(e,a,r),l=e.read_shift(4),c=l>0?Qc(e,l,s,r):null;return[s,c]}var JO=tf,rf=tf,QO=tf,ZO=tf,e5={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},V2={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},t5={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function by(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function r5(e){var t="of:="+e.replace(Gm,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Fd(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function a5(e){return e.replace(/\./,"!")}var _c={},so={},wc=typeof Map<"u";function Wm(e,t,r){var a=0,s=e.length;if(r){if(wc?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var l=wc?r.get(t):r[t];a<l.length;++a)if(e[l[a]].t===t)return e.Count++,l[a]}}else for(;a<s;++a)if(e[a].t===t)return e.Count++,a;return e[s]={t},e.Count++,e.Unique++,r&&(wc?(r.has(t)||r.set(t,[]),r.get(t).push(s)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(s))),s}function af(e,t){var r={min:e+1,max:e+1},a=-1;return t.MDW&&(ha=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?a=Uc(t.wpx):t.wch!=null&&(a=t.wch),a>-1?(r.width=$u(a),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function zi(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function ci(e,t,r){var a=r.revssf[t.z!=null?t.z:"General"],s=60,l=e.length;if(a==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){ds(t.z,s),r.ssf[s]=t.z,r.revssf[t.z]=a=s;break}}for(s=0;s!=l;++s)if(e[s].numFmtId===a)return s;return e[l]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},l}function G2(e,t,r,a,s,l){try{a.cellNF&&(e.z=ft[t])}catch(u){if(a.WTF)throw u}if(!(e.t==="z"&&!a.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=ir(e.v)),(!a||a.cellText!==!1)&&e.t!=="z")try{if(ft[t]==null&&ds(eA[t]||"General",t),e.t==="e")e.w=e.w||ys[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Dc(e.v);else if(e.t==="d"){var c=zr(e.v);(c|0)===c?e.w=c.toString(10):e.w=Dc(c)}else{if(e.v===void 0)return"";e.w=Hi(e.v,so)}else e.t==="d"?e.w=gn(t,zr(e.v),so):e.w=gn(t,e.v,so)}catch(u){if(a.WTF)throw u}if(a.cellStyles&&r!=null)try{e.s=l.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Hu(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),a.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Hu(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),a.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(u){if(a.WTF&&l.Fills)throw u}}}function n5(e,t,r){if(e&&e["!ref"]){var a=Mt(e["!ref"]);if(a.e.c<a.s.c||a.e.r<a.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function s5(e,t){var r=Mt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=vt(r))}var i5=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,l5=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,o5=/<(?:\w:)?hyperlink [^>]*>/mg,c5=/"(\w*:\w*)"/,u5=/<(?:\w:)?col\b[^>]*[\/]?>/g,f5=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,h5=/<(?:\w:)?pageMargins[^>]*\/>/g,q2=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,d5=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,m5=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function g5(e,t,r,a,s,l,c){if(!e)return e;a||(a={"!id":{}});var u=t.dense?[]:{},h={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",g="",x=e.match(l5);x?(d=e.slice(0,x.index),g=e.slice(x.index+x[0].length)):d=g=e;var v=d.match(q2);v?Km(v[0],u,s,r):(v=d.match(d5))&&x5(v[0],v[1]||"",u,s,r);var _=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(_>0){var b=d.slice(_,_+50).match(c5);b&&s5(u,b[1])}var y=d.match(m5);y&&y[1]&&O5(y[1],s);var S=[];if(t.cellStyles){var k=d.match(u5);k&&T5(S,k)}x&&F5(x[1],u,t,h,l,c);var R=g.match(f5);R&&(u["!autofilter"]=A5(R[0]));var T=[],j=g.match(i5);if(j)for(_=0;_!=j.length;++_)T[_]=Mt(j[_].slice(j[_].indexOf('"')+1));var X=g.match(o5);X&&b5(u,X,a);var L=g.match(h5);if(L&&(u["!margins"]=S5(dt(L[0]))),!u["!ref"]&&h.e.c>=h.s.c&&h.e.r>=h.s.r&&(u["!ref"]=vt(h)),t.sheetRows>0&&u["!ref"]){var A=Mt(u["!ref"]);t.sheetRows<=+A.e.r&&(A.e.r=t.sheetRows-1,A.e.r>h.e.r&&(A.e.r=h.e.r),A.e.r<A.s.r&&(A.s.r=A.e.r),A.e.c>h.e.c&&(A.e.c=h.e.c),A.e.c<A.s.c&&(A.s.c=A.e.c),u["!fullref"]=u["!ref"],u["!ref"]=vt(A))}return S.length>0&&(u["!cols"]=S),T.length>0&&(u["!merges"]=T),u}function p5(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+vt(e[r])+'"/>';return t+"</mergeCells>"}function Km(e,t,r,a){var s=dt(e);r.Sheets[a]||(r.Sheets[a]={}),s.codeName&&(r.Sheets[a].CodeName=Ft(Yt(s.codeName)))}function x5(e,t,r,a,s){Km(e.slice(0,e.indexOf(">")),r,a,s)}function v5(e,t,r,a,s){var l=!1,c={},u=null;if(a.bookType!=="xlsx"&&t.vbaraw){var h=t.SheetNames[r];try{t.Workbook&&(h=t.Workbook.Sheets[r].CodeName||h)}catch{}l=!0,c.codeName=jn($t(h))}if(e&&e["!outline"]){var d={summaryBelow:1,summaryRight:1};e["!outline"].above&&(d.summaryBelow=0),e["!outline"].left&&(d.summaryRight=0),u=(u||"")+Be("outlinePr",null,d)}!l&&!u||(s[s.length]=Be("sheetPr",u,c))}var y5=["objects","scenarios","selectLockedCells","selectUnlockedCells"],_5=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function w5(e){var t={sheet:1};return y5.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),_5.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=Hm(e.password).toString(16).toUpperCase()),Be("sheetProtection",null,t)}function b5(e,t,r){for(var a=Array.isArray(e),s=0;s!=t.length;++s){var l=dt(Yt(t[s]),!0);if(!l.ref)return;var c=((r||{})["!id"]||[])[l.id];c?(l.Target=c.Target,l.location&&(l.Target+="#"+Ft(l.location))):(l.Target="#"+Ft(l.location),c={Target:l.Target,TargetMode:"Internal"}),l.Rel=c,l.tooltip&&(l.Tooltip=l.tooltip,delete l.tooltip);for(var u=Mt(l.ref),h=u.s.r;h<=u.e.r;++h)for(var d=u.s.c;d<=u.e.c;++d){var g=ht({c:d,r:h});a?(e[h]||(e[h]=[]),e[h][d]||(e[h][d]={t:"z",v:void 0}),e[h][d].l=l):(e[g]||(e[g]={t:"z",v:void 0}),e[g].l=l)}}}function S5(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function E5(e){return zi(e),Be("pageMargins",null,e)}function T5(e,t){for(var r=!1,a=0;a!=t.length;++a){var s=dt(t[a],!0);s.hidden&&(s.hidden=sr(s.hidden));var l=parseInt(s.min,10)-1,c=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,$m(s.width)),ai(s);l<=c;)e[l++]=lr(s)}}function k5(e,t){for(var r=["<cols>"],a,s=0;s!=t.length;++s)(a=t[s])&&(r[r.length]=Be("col",null,af(s,a)));return r[r.length]="</cols>",r.join("")}function A5(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function C5(e,t,r,a){var s=typeof e.ref=="string"?e.ref:vt(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var l=r.Workbook.Names,c=Fa(s);c.s.r==c.e.r&&(c.e.r=Fa(t["!ref"]).e.r,s=vt(c));for(var u=0;u<l.length;++u){var h=l[u];if(h.Name=="_xlnm._FilterDatabase"&&h.Sheet==a){h.Ref="'"+r.SheetNames[a]+"'!"+s;break}}return u==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+s}),Be("autoFilter",null,{ref:s})}var N5=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function O5(e,t){t.Views||(t.Views=[{}]),(e.match(N5)||[]).forEach(function(r,a){var s=dt(r);t.Views[a]||(t.Views[a]={}),+s.zoomScale&&(t.Views[a].zoom=+s.zoomScale),sr(s.rightToLeft)&&(t.Views[a].RTL=!0)})}function R5(e,t,r,a){var s={workbookViewId:"0"};return(((a||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=a.Workbook.Views[0].RTL?"1":"0"),Be("sheetViews",Be("sheetView",null,s),{})}function D5(e,t,r,a){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",l=e.t,c=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=ys[e.v];break;case"d":a&&a.cellDates?s=ir(e.v,-1).toISOString():(e=lr(e),e.t="n",s=""+(e.v=zr(ir(e.v)))),typeof e.z>"u"&&(e.z=ft[14]);break;default:s=e.v;break}var u=na("v",$t(s)),h={r:t},d=ci(a.cellXfs,e,a);switch(d!==0&&(h.s=d),e.t){case"n":break;case"d":h.t="d";break;case"b":h.t="b";break;case"e":h.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(a&&a.bookSST){u=na("v",""+Wm(a.Strings,e.v,a.revStrings)),h.t="s";break}h.t="str";break}if(e.t!=l&&(e.t=l,e.v=c),typeof e.f=="string"&&e.f){var g=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;u=Be("f",$t(e.f),g)+(e.v!=null?u:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(h.cm=1),Be("c",u,h)}var F5=(function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,l=Fc("v"),c=Fc("f");return function(h,d,g,x,v,_){for(var b=0,y="",S=[],k=[],R=0,T=0,j=0,X="",L,A,K=0,q=0,ie,ne,Z=0,me=0,Re=Array.isArray(_.CellXf),Ae,V=[],ae=[],xe=Array.isArray(d),J=[],be={},I=!1,N=!!g.sheetStubs,U=h.split(t),M=0,P=U.length;M!=P;++M){y=U[M].trim();var te=y.length;if(te!==0){var pe=0;e:for(b=0;b<te;++b)switch(y[b]){case">":if(y[b-1]!="/"){++b;break e}if(g&&g.cellStyles){if(A=dt(y.slice(pe,b),!0),K=A.r!=null?parseInt(A.r,10):K+1,q=-1,g.sheetRows&&g.sheetRows<K)continue;be={},I=!1,A.ht&&(I=!0,be.hpt=parseFloat(A.ht),be.hpx=uo(be.hpt)),A.hidden=="1"&&(I=!0,be.hidden=!0),A.outlineLevel!=null&&(I=!0,be.level=+A.outlineLevel),I&&(J[K-1]=be)}break;case"<":pe=b;break}if(pe>=b)break;if(A=dt(y.slice(pe,b),!0),K=A.r!=null?parseInt(A.r,10):K+1,q=-1,!(g.sheetRows&&g.sheetRows<K)){x.s.r>K-1&&(x.s.r=K-1),x.e.r<K-1&&(x.e.r=K-1),g&&g.cellStyles&&(be={},I=!1,A.ht&&(I=!0,be.hpt=parseFloat(A.ht),be.hpx=uo(be.hpt)),A.hidden=="1"&&(I=!0,be.hidden=!0),A.outlineLevel!=null&&(I=!0,be.level=+A.outlineLevel),I&&(J[K-1]=be)),S=y.slice(b).split(e);for(var Ee=0;Ee!=S.length&&S[Ee].trim().charAt(0)=="<";++Ee);for(S=S.slice(Ee),b=0;b!=S.length;++b)if(y=S[b].trim(),y.length!==0){if(k=y.match(r),R=b,T=0,j=0,y="<c "+(y.slice(0,1)=="<"?">":"")+y,k!=null&&k.length===2){for(R=0,X=k[1],T=0;T!=X.length&&!((j=X.charCodeAt(T)-64)<1||j>26);++T)R=26*R+j;--R,q=R}else++q;for(T=0;T!=y.length&&y.charCodeAt(T)!==62;++T);if(++T,A=dt(y.slice(0,T),!0),A.r||(A.r=ht({r:K-1,c:q})),X=y.slice(T),L={t:""},(k=X.match(l))!=null&&k[1]!==""&&(L.v=Ft(k[1])),g.cellFormula){if((k=X.match(c))!=null&&k[1]!==""){if(L.f=Ft(Yt(k[1])).replace(/\r\n/g,`
`),g.xlfn||(L.f=vy(L.f)),k[0].indexOf('t="array"')>-1)L.F=(X.match(s)||[])[1],L.F.indexOf(":")>-1&&V.push([Mt(L.F),L.F]);else if(k[0].indexOf('t="shared"')>-1){ne=dt(k[0]);var ve=Ft(Yt(k[1]));g.xlfn||(ve=vy(ve)),ae[parseInt(ne.si,10)]=[ne,ve,A.r]}}else(k=X.match(/<f[^>]*\/>/))&&(ne=dt(k[0]),ae[ne.si]&&(L.f=N8(ae[ne.si][1],ae[ne.si][2],A.r)));var Te=mr(A.r);for(T=0;T<V.length;++T)Te.r>=V[T][0].s.r&&Te.r<=V[T][0].e.r&&Te.c>=V[T][0].s.c&&Te.c<=V[T][0].e.c&&(L.F=V[T][1])}if(A.t==null&&L.v===void 0)if(L.f||L.F)L.v=0,L.t="n";else if(N)L.t="z";else continue;else L.t=A.t||"n";switch(x.s.c>q&&(x.s.c=q),x.e.c<q&&(x.e.c=q),L.t){case"n":if(L.v==""||L.v==null){if(!N)continue;L.t="z"}else L.v=parseFloat(L.v);break;case"s":if(typeof L.v>"u"){if(!N)continue;L.t="z"}else ie=_c[parseInt(L.v,10)],L.v=ie.t,L.r=ie.r,g.cellHTML&&(L.h=ie.h);break;case"str":L.t="s",L.v=L.v!=null?Yt(L.v):"",g.cellHTML&&(L.h=Am(L.v));break;case"inlineStr":k=X.match(a),L.t="s",k!=null&&(ie=zm(k[1]))?(L.v=ie.t,g.cellHTML&&(L.h=ie.h)):L.v="";break;case"b":L.v=sr(L.v);break;case"d":g.cellDates?L.v=ir(L.v,1):(L.v=zr(ir(L.v,1)),L.t="n");break;case"e":(!g||g.cellText!==!1)&&(L.w=L.v),L.v=W_[L.v];break}if(Z=me=0,Ae=null,Re&&A.s!==void 0&&(Ae=_.CellXf[A.s],Ae!=null&&(Ae.numFmtId!=null&&(Z=Ae.numFmtId),g.cellStyles&&Ae.fillId!=null&&(me=Ae.fillId))),G2(L,Z,me,g,v,_),g.cellDates&&Re&&L.t=="n"&&ho(ft[Z])&&(L.t="d",L.v=Zu(L.v)),A.cm&&g.xlmeta){var tt=(g.xlmeta.Cell||[])[+A.cm-1];tt&&tt.type=="XLDAPR"&&(L.D=!0)}if(xe){var G=mr(A.r);d[G.r]||(d[G.r]=[]),d[G.r][G.c]=L}else d[A.r]=L}}}}J.length>0&&(d["!rows"]=J)}})();function M5(e,t,r,a){var s=[],l=[],c=Mt(e["!ref"]),u="",h,d="",g=[],x=0,v=0,_=e["!rows"],b=Array.isArray(e),y={r:d},S,k=-1;for(v=c.s.c;v<=c.e.c;++v)g[v]=dr(v);for(x=c.s.r;x<=c.e.r;++x){for(l=[],d=Tr(x),v=c.s.c;v<=c.e.c;++v){h=g[v]+d;var R=b?(e[x]||[])[v]:e[h];R!==void 0&&(u=D5(R,h,e,t))!=null&&l.push(u)}(l.length>0||_&&_[x])&&(y={r:d},_&&_[x]&&(S=_[x],S.hidden&&(y.hidden=1),k=-1,S.hpx?k=Pc(S.hpx):S.hpt&&(k=S.hpt),k>-1&&(y.ht=k,y.customHeight=1),S.level&&(y.outlineLevel=S.level)),s[s.length]=Be("row",l.join(""),y))}if(_)for(;x<_.length;++x)_&&_[x]&&(y={r:x+1},S=_[x],S.hidden&&(y.hidden=1),k=-1,S.hpx?k=Pc(S.hpx):S.hpt&&(k=S.hpt),k>-1&&(y.ht=k,y.customHeight=1),S.level&&(y.outlineLevel=S.level),s[s.length]=Be("row","",y));return s.join("")}function X2(e,t,r,a){var s=[kr,Be("worksheet",null,{xmlns:Ki[0],"xmlns:r":Pr.r})],l=r.SheetNames[e],c=0,u="",h=r.Sheets[l];h==null&&(h={});var d=h["!ref"]||"A1",g=Mt(d);if(g.e.c>16383||g.e.r>1048575){if(t.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");g.e.c=Math.min(g.e.c,16383),g.e.r=Math.min(g.e.c,1048575),d=vt(g)}a||(a={}),h["!comments"]=[];var x=[];v5(h,r,e,t,s),s[s.length]=Be("dimension",null,{ref:d}),s[s.length]=R5(h,t,e,r),t.sheetFormat&&(s[s.length]=Be("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),h["!cols"]!=null&&h["!cols"].length>0&&(s[s.length]=k5(h,h["!cols"])),s[c=s.length]="<sheetData/>",h["!links"]=[],h["!ref"]!=null&&(u=M5(h,t),u.length>0&&(s[s.length]=u)),s.length>c+1&&(s[s.length]="</sheetData>",s[c]=s[c].replace("/>",">")),h["!protect"]&&(s[s.length]=w5(h["!protect"])),h["!autofilter"]!=null&&(s[s.length]=C5(h["!autofilter"],h,r,e)),h["!merges"]!=null&&h["!merges"].length>0&&(s[s.length]=p5(h["!merges"]));var v=-1,_,b=-1;return h["!links"].length>0&&(s[s.length]="<hyperlinks>",h["!links"].forEach(function(y){y[1].Target&&(_={ref:y[0]},y[1].Target.charAt(0)!="#"&&(b=Ht(a,-1,$t(y[1].Target).replace(/#.*$/,""),St.HLINK),_["r:id"]="rId"+b),(v=y[1].Target.indexOf("#"))>-1&&(_.location=$t(y[1].Target.slice(v+1))),y[1].Tooltip&&(_.tooltip=$t(y[1].Tooltip)),s[s.length]=Be("hyperlink",null,_))}),s[s.length]="</hyperlinks>"),delete h["!links"],h["!margins"]!=null&&(s[s.length]=E5(h["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(s[s.length]=na("ignoredErrors",Be("ignoredError",null,{numberStoredAsText:1,sqref:d}))),x.length>0&&(b=Ht(a,-1,"../drawings/drawing"+(e+1)+".xml",St.DRAW),s[s.length]=Be("drawing",null,{"r:id":"rId"+b}),h["!drawing"]=x),h["!comments"].length>0&&(b=Ht(a,-1,"../drawings/vmlDrawing"+(e+1)+".vml",St.VML),s[s.length]=Be("legacyDrawing",null,{"r:id":"rId"+b}),h["!legacy"]=b),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function L5(e,t){var r={},a=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var l=e.read_shift(1);return e.l=a,l&7&&(r.level=l&7),l&16&&(r.hidden=!0),l&32&&(r.hpt=s/20),r}function B5(e,t,r){var a=ye(145),s=(r["!rows"]||[])[e]||{};a.write_shift(4,e),a.write_shift(4,0);var l=320;s.hpx?l=Pc(s.hpx)*20:s.hpt&&(l=s.hpt*20),a.write_shift(2,l),a.write_shift(1,0);var c=0;s.level&&(c|=s.level),s.hidden&&(c|=16),(s.hpx||s.hpt)&&(c|=32),a.write_shift(1,c),a.write_shift(1,0);var u=0,h=a.l;a.l+=4;for(var d={r:e,c:0},g=0;g<16;++g)if(!(t.s.c>g+1<<10||t.e.c<g<<10)){for(var x=-1,v=-1,_=g<<10;_<g+1<<10;++_){d.c=_;var b=Array.isArray(r)?(r[d.r]||[])[d.c]:r[ht(d)];b&&(x<0&&(x=_),v=_)}x<0||(++u,a.write_shift(4,x),a.write_shift(4,v))}var y=a.l;return a.l=h,a.write_shift(4,u),a.l=y,a.length>a.l?a.slice(0,a.l):a}function I5(e,t,r,a){var s=B5(a,r,t);(s.length>17||(t["!rows"]||[])[a])&&Ce(e,0,s)}var j5=Zi,U5=po;function P5(){}function z5(e,t){var r={},a=e[e.l];return++e.l,r.above=!(a&64),r.left=!(a&128),e.l+=18,r.name=VA(e),r}function H5(e,t,r){r==null&&(r=ye(84+4*e.length));var a=192;t&&(t.above&&(a&=-65),t.left&&(a&=-129)),r.write_shift(1,a);for(var s=1;s<3;++s)r.write_shift(1,0);return Uu({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),$_(e,r),r.slice(0,r.l)}function $5(e){var t=pn(e);return[t]}function V5(e,t,r){return r==null&&(r=ye(8)),Yi(t,r)}function G5(e){var t=Ji(e);return[t]}function q5(e,t,r){return r==null&&(r=ye(4)),Qi(t,r)}function X5(e){var t=pn(e),r=e.read_shift(1);return[t,r,"b"]}function W5(e,t,r){return r==null&&(r=ye(9)),Yi(t,r),r.write_shift(1,e.v?1:0),r}function K5(e){var t=Ji(e),r=e.read_shift(1);return[t,r,"b"]}function Y5(e,t,r){return r==null&&(r=ye(5)),Qi(t,r),r.write_shift(1,e.v?1:0),r}function J5(e){var t=pn(e),r=e.read_shift(1);return[t,r,"e"]}function Q5(e,t,r){return r==null&&(r=ye(9)),Yi(t,r),r.write_shift(1,e.v),r}function Z5(e){var t=Ji(e),r=e.read_shift(1);return[t,r,"e"]}function eR(e,t,r){return r==null&&(r=ye(8)),Qi(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function tR(e){var t=pn(e),r=e.read_shift(4);return[t,r,"s"]}function rR(e,t,r){return r==null&&(r=ye(12)),Yi(t,r),r.write_shift(4,t.v),r}function aR(e){var t=Ji(e),r=e.read_shift(4);return[t,r,"s"]}function nR(e,t,r){return r==null&&(r=ye(8)),Qi(t,r),r.write_shift(4,t.v),r}function sR(e){var t=pn(e),r=da(e);return[t,r,"n"]}function iR(e,t,r){return r==null&&(r=ye(16)),Yi(t,r),Vi(e.v,r),r}function W2(e){var t=Ji(e),r=da(e);return[t,r,"n"]}function lR(e,t,r){return r==null&&(r=ye(12)),Qi(t,r),Vi(e.v,r),r}function oR(e){var t=pn(e),r=Bm(e);return[t,r,"n"]}function cR(e,t,r){return r==null&&(r=ye(12)),Yi(t,r),V_(e.v,r),r}function uR(e){var t=Ji(e),r=Bm(e);return[t,r,"n"]}function fR(e,t,r){return r==null&&(r=ye(8)),Qi(t,r),V_(e.v,r),r}function hR(e){var t=pn(e),r=Fm(e);return[t,r,"is"]}function dR(e){var t=pn(e),r=ma(e);return[t,r,"str"]}function mR(e,t,r){return r==null&&(r=ye(12+4*e.v.length)),Yi(t,r),Wr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function gR(e){var t=Ji(e),r=ma(e);return[t,r,"str"]}function pR(e,t,r){return r==null&&(r=ye(8+4*e.v.length)),Qi(t,r),Wr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function xR(e,t,r){var a=e.l+t,s=pn(e);s.r=r["!row"];var l=e.read_shift(1),c=[s,l,"b"];if(r.cellFormula){e.l+=2;var u=rf(e,a-e.l,r);c[3]=fa(u,null,s,r.supbooks,r)}else e.l=a;return c}function vR(e,t,r){var a=e.l+t,s=pn(e);s.r=r["!row"];var l=e.read_shift(1),c=[s,l,"e"];if(r.cellFormula){e.l+=2;var u=rf(e,a-e.l,r);c[3]=fa(u,null,s,r.supbooks,r)}else e.l=a;return c}function yR(e,t,r){var a=e.l+t,s=pn(e);s.r=r["!row"];var l=da(e),c=[s,l,"n"];if(r.cellFormula){e.l+=2;var u=rf(e,a-e.l,r);c[3]=fa(u,null,s,r.supbooks,r)}else e.l=a;return c}function _R(e,t,r){var a=e.l+t,s=pn(e);s.r=r["!row"];var l=ma(e),c=[s,l,"str"];if(r.cellFormula){e.l+=2;var u=rf(e,a-e.l,r);c[3]=fa(u,null,s,r.supbooks,r)}else e.l=a;return c}var wR=Zi,bR=po;function SR(e,t){return t==null&&(t=ye(4)),t.write_shift(4,e),t}function ER(e,t){var r=e.l+t,a=Zi(e),s=Mm(e),l=ma(e),c=ma(e),u=ma(e);e.l=r;var h={rfx:a,relId:s,loc:l,display:u};return c&&(h.Tooltip=c),h}function TR(e,t){var r=ye(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));po({s:mr(e[0]),e:mr(e[0])},r),Lm("rId"+t,r);var a=e[1].Target.indexOf("#"),s=a==-1?"":e[1].Target.slice(a+1);return Wr(s||"",r),Wr(e[1].Tooltip||"",r),Wr("",r),r.slice(0,r.l)}function kR(){}function AR(e,t,r){var a=e.l+t,s=G_(e),l=e.read_shift(1),c=[s];if(c[2]=l,r.cellFormula){var u=JO(e,a-e.l,r);c[1]=u}else e.l=a;return c}function CR(e,t,r){var a=e.l+t,s=Zi(e),l=[s];if(r.cellFormula){var c=ZO(e,a-e.l,r);l[1]=c,e.l=a}else e.l=a;return l}function NR(e,t,r){r==null&&(r=ye(18));var a=af(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(a.width||10)*256),r.write_shift(4,0);var s=0;return t.hidden&&(s|=1),typeof a.width=="number"&&(s|=2),t.level&&(s|=t.level<<8),r.write_shift(2,s),r}var K2=["left","right","top","bottom","header","footer"];function OR(e){var t={};return K2.forEach(function(r){t[r]=da(e)}),t}function RR(e,t){return t==null&&(t=ye(48)),zi(e),K2.forEach(function(r){Vi(e[r],t)}),t}function DR(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function FR(e,t,r){r==null&&(r=ye(30));var a=924;return(((t||{}).Views||[])[0]||{}).RTL&&(a|=32),r.write_shift(2,a),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function MR(e){var t=ye(24);return t.write_shift(4,4),t.write_shift(4,1),po(e,t),t}function LR(e,t){return t==null&&(t=ye(66)),t.write_shift(2,e.password?Hm(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function BR(){}function IR(){}function jR(e,t,r,a,s,l,c){if(!e)return e;var u=t||{};a||(a={"!id":{}});var h=u.dense?[]:{},d,g={s:{r:2e6,c:2e6},e:{r:0,c:0}},x=!1,v=!1,_,b,y,S,k,R,T,j,X,L=[];u.biff=12,u["!row"]=0;var A=0,K=!1,q=[],ie={},ne=u.supbooks||s.supbooks||[[]];if(ne.sharedf=ie,ne.arrayf=q,ne.SheetNames=s.SheetNames||s.Sheets.map(function(xe){return xe.name}),!u.supbooks&&(u.supbooks=ne,s.Names))for(var Z=0;Z<s.Names.length;++Z)ne[0][Z+1]=s.Names[Z];var me=[],Re=[],Ae=!1;zc[16]={n:"BrtShortReal",f:W2};var V;if(vs(e,function(J,be,I){if(!v)switch(I){case 148:d=J;break;case 0:_=J,u.sheetRows&&u.sheetRows<=_.r&&(v=!0),j=Tr(S=_.r),u["!row"]=_.r,(J.hidden||J.hpt||J.level!=null)&&(J.hpt&&(J.hpx=uo(J.hpt)),Re[J.r]=J);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(b={t:J[2]},J[2]){case"n":b.v=J[1];break;case"s":T=_c[J[1]],b.v=T.t,b.r=T.r;break;case"b":b.v=!!J[1];break;case"e":b.v=J[1],u.cellText!==!1&&(b.w=ys[b.v]);break;case"str":b.t="s",b.v=J[1];break;case"is":b.t="s",b.v=J[1].t;break}if((y=c.CellXf[J[0].iStyleRef])&&G2(b,y.numFmtId,null,u,l,c),k=J[0].c==-1?k+1:J[0].c,u.dense?(h[S]||(h[S]=[]),h[S][k]=b):h[dr(k)+j]=b,u.cellFormula){for(K=!1,A=0;A<q.length;++A){var N=q[A];_.r>=N[0].s.r&&_.r<=N[0].e.r&&k>=N[0].s.c&&k<=N[0].e.c&&(b.F=vt(N[0]),K=!0)}!K&&J.length>3&&(b.f=J[3])}if(g.s.r>_.r&&(g.s.r=_.r),g.s.c>k&&(g.s.c=k),g.e.r<_.r&&(g.e.r=_.r),g.e.c<k&&(g.e.c=k),u.cellDates&&y&&b.t=="n"&&ho(ft[y.numFmtId])){var U=Ii(b.v);U&&(b.t="d",b.v=new Date(U.y,U.m-1,U.d,U.H,U.M,U.S,U.u))}V&&(V.type=="XLDAPR"&&(b.D=!0),V=void 0);break;case 1:case 12:if(!u.sheetStubs||x)break;b={t:"z",v:void 0},k=J[0].c==-1?k+1:J[0].c,u.dense?(h[S]||(h[S]=[]),h[S][k]=b):h[dr(k)+j]=b,g.s.r>_.r&&(g.s.r=_.r),g.s.c>k&&(g.s.c=k),g.e.r<_.r&&(g.e.r=_.r),g.e.c<k&&(g.e.c=k),V&&(V.type=="XLDAPR"&&(b.D=!0),V=void 0);break;case 176:L.push(J);break;case 49:V=((u.xlmeta||{}).Cell||[])[J-1];break;case 494:var M=a["!id"][J.relId];for(M?(J.Target=M.Target,J.loc&&(J.Target+="#"+J.loc),J.Rel=M):J.relId==""&&(J.Target="#"+J.loc),S=J.rfx.s.r;S<=J.rfx.e.r;++S)for(k=J.rfx.s.c;k<=J.rfx.e.c;++k)u.dense?(h[S]||(h[S]=[]),h[S][k]||(h[S][k]={t:"z",v:void 0}),h[S][k].l=J):(R=ht({c:k,r:S}),h[R]||(h[R]={t:"z",v:void 0}),h[R].l=J);break;case 426:if(!u.cellFormula)break;q.push(J),X=u.dense?h[S][k]:h[dr(k)+j],X.f=fa(J[1],g,{r:_.r,c:k},ne,u),X.F=vt(J[0]);break;case 427:if(!u.cellFormula)break;ie[ht(J[0].s)]=J[1],X=u.dense?h[S][k]:h[dr(k)+j],X.f=fa(J[1],g,{r:_.r,c:k},ne,u);break;case 60:if(!u.cellStyles)break;for(;J.e>=J.s;)me[J.e--]={width:J.w/256,hidden:!!(J.flags&1),level:J.level},Ae||(Ae=!0,$m(J.w/256)),ai(me[J.e+1]);break;case 161:h["!autofilter"]={ref:vt(J)};break;case 476:h["!margins"]=J;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),J.name&&(s.Sheets[r].CodeName=J.name),(J.above||J.left)&&(h["!outline"]={above:J.above,left:J.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),J.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:x=!0;break;case 36:x=!1;break;case 37:x=!0;break;case 38:x=!1;break;default:if(!be.T){if(!x||u.WTF)throw new Error("Unexpected record 0x"+I.toString(16))}}},u),delete u.supbooks,delete u["!row"],!h["!ref"]&&(g.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(h["!ref"]=vt(d||g)),u.sheetRows&&h["!ref"]){var ae=Mt(h["!ref"]);u.sheetRows<=+ae.e.r&&(ae.e.r=u.sheetRows-1,ae.e.r>g.e.r&&(ae.e.r=g.e.r),ae.e.r<ae.s.r&&(ae.s.r=ae.e.r),ae.e.c>g.e.c&&(ae.e.c=g.e.c),ae.e.c<ae.s.c&&(ae.s.c=ae.e.c),h["!fullref"]=h["!ref"],h["!ref"]=vt(ae))}return L.length>0&&(h["!merges"]=L),me.length>0&&(h["!cols"]=me),Re.length>0&&(h["!rows"]=Re),h}function UR(e,t,r,a,s,l,c){if(t.v===void 0)return!1;var u="";switch(t.t){case"b":u=t.v?"1":"0";break;case"d":t=lr(t),t.z=t.z||ft[14],t.v=zr(ir(t.v)),t.t="n";break;case"n":case"e":u=""+t.v;break;default:u=t.v;break}var h={r,c:a};switch(h.s=ci(s.cellXfs,t,s),t.l&&l["!links"].push([ht(h),t.l]),t.c&&l["!comments"].push([ht(h),t.c]),t.t){case"s":case"str":return s.bookSST?(u=Wm(s.Strings,t.v,s.revStrings),h.t="s",h.v=u,c?Ce(e,18,nR(t,h)):Ce(e,7,rR(t,h))):(h.t="str",c?Ce(e,17,pR(t,h)):Ce(e,6,mR(t,h))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?c?Ce(e,13,fR(t,h)):Ce(e,2,cR(t,h)):c?Ce(e,16,lR(t,h)):Ce(e,5,iR(t,h)),!0;case"b":return h.t="b",c?Ce(e,15,Y5(t,h)):Ce(e,4,W5(t,h)),!0;case"e":return h.t="e",c?Ce(e,14,eR(t,h)):Ce(e,3,Q5(t,h)),!0}return c?Ce(e,12,q5(t,h)):Ce(e,1,V5(t,h)),!0}function PR(e,t,r,a){var s=Mt(t["!ref"]||"A1"),l,c="",u=[];Ce(e,145);var h=Array.isArray(t),d=s.e.r;t["!rows"]&&(d=Math.max(s.e.r,t["!rows"].length-1));for(var g=s.s.r;g<=d;++g){c=Tr(g),I5(e,t,s,g);var x=!1;if(g<=s.e.r)for(var v=s.s.c;v<=s.e.c;++v){g===s.s.r&&(u[v]=dr(v)),l=u[v]+c;var _=h?(t[g]||[])[v]:t[l];if(!_){x=!1;continue}x=UR(e,_,g,v,a,t,x)}}Ce(e,146)}function zR(e,t){!t||!t["!merges"]||(Ce(e,177,SR(t["!merges"].length)),t["!merges"].forEach(function(r){Ce(e,176,bR(r))}),Ce(e,178))}function HR(e,t){!t||!t["!cols"]||(Ce(e,390),t["!cols"].forEach(function(r,a){r&&Ce(e,60,NR(a,r))}),Ce(e,391))}function $R(e,t){!t||!t["!ref"]||(Ce(e,648),Ce(e,649,MR(Mt(t["!ref"]))),Ce(e,650))}function VR(e,t,r){t["!links"].forEach(function(a){if(a[1].Target){var s=Ht(r,-1,a[1].Target.replace(/#.*$/,""),St.HLINK);Ce(e,494,TR(a,s))}}),delete t["!links"]}function GR(e,t,r,a){if(t["!comments"].length>0){var s=Ht(a,-1,"../drawings/vmlDrawing"+(r+1)+".vml",St.VML);Ce(e,551,Lm("rId"+s)),t["!legacy"]=s}}function qR(e,t,r,a){if(t["!autofilter"]){var s=t["!autofilter"],l=typeof s.ref=="string"?s.ref:vt(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var c=r.Workbook.Names,u=Fa(l);u.s.r==u.e.r&&(u.e.r=Fa(t["!ref"]).e.r,l=vt(u));for(var h=0;h<c.length;++h){var d=c[h];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==a){d.Ref="'"+r.SheetNames[a]+"'!"+l;break}}h==c.length&&c.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+l}),Ce(e,161,po(Mt(l))),Ce(e,162)}}function XR(e,t,r){Ce(e,133),Ce(e,137,FR(t,r)),Ce(e,138),Ce(e,134)}function WR(e,t){t["!protect"]&&Ce(e,535,LR(t["!protect"]))}function KR(e,t,r,a){var s=Da(),l=r.SheetNames[e],c=r.Sheets[l]||{},u=l;try{r&&r.Workbook&&(u=r.Workbook.Sheets[e].CodeName||u)}catch{}var h=Mt(c["!ref"]||"A1");if(h.e.c>16383||h.e.r>1048575){if(t.WTF)throw new Error("Range "+(c["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575)}return c["!links"]=[],c["!comments"]=[],Ce(s,129),(r.vbaraw||c["!outline"])&&Ce(s,147,H5(u,c["!outline"])),Ce(s,148,U5(h)),XR(s,c,r.Workbook),HR(s,c),PR(s,c,e,t),WR(s,c),qR(s,c,r,e),zR(s,c),VR(s,c,a),c["!margins"]&&Ce(s,476,RR(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&$R(s,c),GR(s,c,e,a),Ce(s,130),s.end()}function YR(e){var t=[],r=e.match(/^<c:numCache>/),a;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(l){var c=l.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);c&&(t[+c[1]]=r?+c[2]:c[2])});var s=Ft((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(l){a=l.replace(/<.*?>/g,"")}),[t,s,a]}function JR(e,t,r,a,s,l){var c=l||{"!type":"chart"};if(!e)return l;var u=0,h=0,d="A",g={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(x){var v=YR(x);g.s.r=g.s.c=0,g.e.c=u,d=dr(u),v[0].forEach(function(_,b){c[d+Tr(b)]={t:"n",v:_,z:v[1]},h=b}),g.e.r<h&&(g.e.r=h),++u}),u>0&&(c["!ref"]=vt(g)),c}function QR(e,t,r,a,s){if(!e)return e;a||(a={"!id":{}});var l={"!type":"chart","!drawel":null,"!rel":""},c,u=e.match(q2);return u&&Km(u[0],l,s,r),(c=e.match(/drawing r:id="(.*?)"/))&&(l["!rel"]=c[1]),a["!id"][l["!rel"]]&&(l["!drawel"]=a["!id"][l["!rel"]]),l}function ZR(e,t){e.l+=10;var r=ma(e);return{name:r}}function eD(e,t,r,a,s){if(!e)return e;a||(a={"!id":{}});var l={"!type":"chart","!drawel":null,"!rel":""},c=!1;return vs(e,function(h,d,g){switch(g){case 550:l["!rel"]=h;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),h.name&&(s.Sheets[r].CodeName=h.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:c=!0;break;case 36:c=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!c||t.WTF)throw new Error("Unexpected record 0x"+g.toString(16))}}}},t),a["!id"][l["!rel"]]&&(l["!drawel"]=a["!id"][l["!rel"]]),l}var Ym=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],tD=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],rD=[],aD=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Sy(e,t){for(var r=0;r!=e.length;++r)for(var a=e[r],s=0;s!=t.length;++s){var l=t[s];if(a[l[0]]==null)a[l[0]]=l[1];else switch(l[2]){case"bool":typeof a[l[0]]=="string"&&(a[l[0]]=sr(a[l[0]]));break;case"int":typeof a[l[0]]=="string"&&(a[l[0]]=parseInt(a[l[0]],10));break}}}function Ey(e,t){for(var r=0;r!=t.length;++r){var a=t[r];if(e[a[0]]==null)e[a[0]]=a[1];else switch(a[2]){case"bool":typeof e[a[0]]=="string"&&(e[a[0]]=sr(e[a[0]]));break;case"int":typeof e[a[0]]=="string"&&(e[a[0]]=parseInt(e[a[0]],10));break}}}function Y2(e){Ey(e.WBProps,Ym),Ey(e.CalcPr,aD),Sy(e.WBView,tD),Sy(e.Sheets,rD),so.date1904=sr(e.WBProps.date1904)}function nD(e){return!e.Workbook||!e.Workbook.WBProps?"false":sr(e.Workbook.WBProps.date1904)?"true":"false"}var sD="][*?/\\".split("");function J2(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return sD.forEach(function(a){if(e.indexOf(a)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function iD(e,t,r){e.forEach(function(a,s){J2(a);for(var l=0;l<s;++l)if(a==e[l])throw new Error("Duplicate Sheet Name: "+a);if(r){var c=t&&t[s]&&t[s].CodeName||a;if(c.charCodeAt(0)==95&&c.length>22)throw new Error("Bad Code Name: Worksheet"+c)}})}function lD(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];iD(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)n5(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var oD=/<\w+:workbook/;function cD(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,s="xmlns",l={},c=0;if(e.replace(pa,function(h,d){var g=dt(h);switch(Un(g[0])){case"<?xml":break;case"<workbook":h.match(oD)&&(s="xmlns"+h.match(/<(\w+):/)[1]),r.xmlns=g[s];break;case"</workbook>":break;case"<fileVersion":delete g[0],r.AppVersion=g;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Ym.forEach(function(x){if(g[x[0]]!=null)switch(x[2]){case"bool":r.WBProps[x[0]]=sr(g[x[0]]);break;case"int":r.WBProps[x[0]]=parseInt(g[x[0]],10);break;default:r.WBProps[x[0]]=g[x[0]]}}),g.codeName&&(r.WBProps.CodeName=Yt(g.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete g[0],r.WBView.push(g);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(g.state){case"hidden":g.Hidden=1;break;case"veryHidden":g.Hidden=2;break;default:g.Hidden=0}delete g.state,g.name=Ft(Yt(g.name)),delete g[0],r.Sheets.push(g);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":a=!0;break;case"</definedNames>":a=!1;break;case"<definedName":l={},l.Name=Yt(g.name),g.comment&&(l.Comment=g.comment),g.localSheetId&&(l.Sheet=+g.localSheetId),sr(g.hidden||"0")&&(l.Hidden=!0),c=d+h.length;break;case"</definedName>":l.Ref=Ft(Yt(e.slice(c,d))),r.Names.push(l);break;case"<definedName/>":break;case"<calcPr":delete g[0],r.CalcPr=g;break;case"<calcPr/>":delete g[0],r.CalcPr=g;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</AlternateContent>":a=!1;break;case"<revisionPtr":break;default:if(!a&&t.WTF)throw new Error("unrecognized "+g[0]+" in workbook")}return h}),Ki.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return Y2(r),r}function Q2(e){var t=[kr];t[t.length]=Be("workbook",null,{xmlns:Ki[0],"xmlns:r":Pr.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,a={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Ym.forEach(function(u){e.Workbook.WBProps[u[0]]!=null&&e.Workbook.WBProps[u[0]]!=u[1]&&(a[u[0]]=e.Workbook.WBProps[u[0]])}),e.Workbook.WBProps.CodeName&&(a.codeName=e.Workbook.WBProps.CodeName,delete a.CodeName)),t[t.length]=Be("workbookPr",null,a);var s=e.Workbook&&e.Workbook.Sheets||[],l=0;if(s&&s[0]&&s[0].Hidden){for(t[t.length]="<bookViews>",l=0;l!=e.SheetNames.length&&!(!s[l]||!s[l].Hidden);++l);l==e.SheetNames.length&&(l=0),t[t.length]='<workbookView firstSheet="'+l+'" activeTab="'+l+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",l=0;l!=e.SheetNames.length;++l){var c={name:$t(e.SheetNames[l].slice(0,31))};if(c.sheetId=""+(l+1),c["r:id"]="rId"+(l+1),s[l])switch(s[l].Hidden){case 1:c.state="hidden";break;case 2:c.state="veryHidden";break}t[t.length]=Be("sheet",null,c)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(u){var h={name:u.Name};u.Comment&&(h.comment=u.Comment),u.Sheet!=null&&(h.localSheetId=""+u.Sheet),u.Hidden&&(h.hidden="1"),u.Ref&&(t[t.length]=Be("definedName",$t(u.Ref),h))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function uD(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Qd(e),r.name=ma(e),r}function fD(e,t){return t||(t=ye(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Lm(e.strRelID,t),Wr(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function hD(e,t){var r={},a=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?ma(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(a&65536),r.backupFile=!!(a&64),r.checkCompatibility=!!(a&4096),r.date1904=!!(a&1),r.filterPrivacy=!!(a&8),r.hidePivotFieldList=!!(a&1024),r.promptedSolutions=!!(a&16),r.publishItems=!!(a&2048),r.refreshAllConnections=!!(a&262144),r.saveExternalLinkValues=!!(a&128),r.showBorderUnselectedTables=!!(a&4),r.showInkAnnotation=!!(a&32),r.showObjects=["all","placeholders","none"][a>>13&3],r.showPivotChartFilter=!!(a&32768),r.updateLinks=["userSet","never","always"][a>>8&3],r}function dD(e,t){t||(t=ye(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),$_(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function mD(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function gD(e,t,r){var a=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),l=GA(e),c=QO(e,0,r),u=Mm(e);e.l=a;var h={Name:l,Ptg:c};return s<268435455&&(h.Sheet=s),u&&(h.Comment=u),h}function pD(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],s=!1;t||(t={}),t.biff=12;var l=[],c=[[]];return c.SheetNames=[],c.XTI=[],zc[16]={n:"BrtFRTArchID$",f:mD},vs(e,function(h,d,g){switch(g){case 156:c.SheetNames.push(h.name),r.Sheets.push(h);break;case 153:r.WBProps=h;break;case 39:h.Sheet!=null&&(t.SID=h.Sheet),h.Ref=fa(h.Ptg,null,null,c,t),delete t.SID,delete h.Ptg,l.push(h);break;case 1036:break;case 357:case 358:case 355:case 667:c[0].length?c.push([g,h]):c[0]=[g,h],c[c.length-1].XTI=[];break;case 362:c.length===0&&(c[0]=[],c[0].XTI=[]),c[c.length-1].XTI=c[c.length-1].XTI.concat(h),c.XTI=c.XTI.concat(h);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:a.push(g),s=!0;break;case 36:a.pop(),s=!1;break;case 37:a.push(g),s=!0;break;case 38:a.pop(),s=!1;break;case 16:break;default:if(!d.T){if(!s||t.WTF&&a[a.length-1]!=37&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+g.toString(16))}}},t),Y2(r),r.Names=l,r.supbooks=c,r}function xD(e,t){Ce(e,143);for(var r=0;r!=t.SheetNames.length;++r){var a=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,s={Hidden:a,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};Ce(e,156,fD(s))}Ce(e,144)}function vD(e,t){t||(t=ye(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Wr("SheetJS",t),Wr(Du.version,t),Wr(Du.version,t),Wr("7262",t),t.length>t.l?t.slice(0,t.l):t}function yD(e,t){t||(t=ye(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function _D(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,a=0,s=-1,l=-1;a<r.length;++a)!r[a]||!r[a].Hidden&&s==-1?s=a:r[a].Hidden==1&&l==-1&&(l=a);l>s||(Ce(e,135),Ce(e,158,yD(s)),Ce(e,136))}}function wD(e,t){var r=Da();return Ce(r,131),Ce(r,128,vD()),Ce(r,153,dD(e.Workbook&&e.Workbook.WBProps||null)),_D(r,e),xD(r,e),Ce(r,132),r.end()}function bD(e,t,r){return t.slice(-4)===".bin"?pD(e,r):cD(e,r)}function SD(e,t,r,a,s,l,c,u){return t.slice(-4)===".bin"?jR(e,a,r,s,l,c,u):g5(e,a,r,s,l,c,u)}function ED(e,t,r,a,s,l,c,u){return t.slice(-4)===".bin"?eD(e,a,r,s,l):QR(e,a,r,s,l)}function TD(e,t,r,a,s,l,c,u){return t.slice(-4)===".bin"?A8():C8()}function kD(e,t,r,a,s,l,c,u){return t.slice(-4)===".bin"?T8():k8()}function AD(e,t,r,a){return t.slice(-4)===".bin"?b6(e,r,a):u6(e,r,a)}function CD(e,t,r){return D2(e,r)}function ND(e,t,r){return t.slice(-4)===".bin"?NN(e,r):kN(e,r)}function OD(e,t,r){return t.slice(-4)===".bin"?_8(e,r):f8(e,r)}function RD(e,t,r){return t.slice(-4)===".bin"?o8(e):i8(e)}function DD(e,t,r,a){return r.slice(-4)===".bin"?c8(e,t,r,a):void 0}function FD(e,t,r){return t.slice(-4)===".bin"?a8(e,t,r):s8(e,t,r)}function MD(e,t,r){return(t.slice(-4)===".bin"?wD:Q2)(e)}function LD(e,t,r,a,s){return(t.slice(-4)===".bin"?KR:X2)(e,r,a,s)}function BD(e,t,r){return(t.slice(-4)===".bin"?D6:O2)(e,r)}function ID(e,t,r){return(t.slice(-4)===".bin"?DN:b2)(e,r)}function jD(e,t,r){return(t.slice(-4)===".bin"?w8:L2)(e)}function UD(e){return(e.slice(-4)===".bin"?n8:F2)()}var Z2=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,ew=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function wn(e,t){var r=e.split(/\s+/),a=[];if(a[0]=r[0],r.length===1)return a;var s=e.match(Z2),l,c,u,h;if(s)for(h=0;h!=s.length;++h)l=s[h].match(ew),(c=l[1].indexOf(":"))===-1?a[l[1]]=l[2].slice(1,l[2].length-1):(l[1].slice(0,6)==="xmlns:"?u="xmlns"+l[1].slice(6):u=l[1].slice(c+1),a[u]=l[2].slice(1,l[2].length-1));return a}function PD(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var a=e.match(Z2),s,l,c,u;if(a)for(u=0;u!=a.length;++u)s=a[u].match(ew),(l=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?c="xmlns"+s[1].slice(6):c=s[1].slice(l+1),r[c]=s[2].slice(1,s[2].length-1));return r}var bc;function zD(e,t){var r=bc[e]||Ft(e);return r==="General"?Hi(t):gn(r,t)}function HD(e,t,r,a){var s=a;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=sr(a);break;case"i2":case"int":s=parseInt(a,10);break;case"r4":case"float":s=parseFloat(a);break;case"date":case"dateTime.tz":s=ir(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Ft(t)]=s}function $D(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||ys[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Dc(e.v):e.w=Hi(e.v):e.w=zD(t||"General",e.v)}catch(l){if(r.WTF)throw l}try{var a=bc[t]||t||"General";if(r.cellNF&&(e.z=a),r.cellDates&&e.t=="n"&&ho(a)){var s=Ii(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(l){if(r.WTF)throw l}}}function VD(e,t,r){if(r.cellStyles&&t.Interior){var a=t.Interior;a.Pattern&&(a.patternType=r6[a.Pattern]||a.Pattern)}e[t.ID]=t}function GD(e,t,r,a,s,l,c,u,h,d){var g="General",x=a.StyleID,v={};d=d||{};var _=[],b=0;for(x===void 0&&u&&(x=u.StyleID),x===void 0&&c&&(x=c.StyleID);l[x]!==void 0&&(l[x].nf&&(g=l[x].nf),l[x].Interior&&_.push(l[x].Interior),!!l[x].Parent);)x=l[x].Parent;switch(r.Type){case"Boolean":a.t="b",a.v=sr(e);break;case"String":a.t="s",a.r=zv(Ft(e)),a.v=e.indexOf("<")>-1?Ft(t||e).replace(/<.*?>/g,""):a.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),a.v=(ir(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),a.v!==a.v?a.v=Ft(e):a.v<60&&(a.v=a.v-1),(!g||g=="General")&&(g="yyyy-mm-dd");case"Number":a.v===void 0&&(a.v=+e),a.t||(a.t="n");break;case"Error":a.t="e",a.v=W_[e],d.cellText!==!1&&(a.w=e);break;default:e==""&&t==""?a.t="z":(a.t="s",a.v=zv(t||e));break}if($D(a,g,d),d.cellFormula!==!1)if(a.Formula){var y=Ft(a.Formula);y.charCodeAt(0)==61&&(y=y.slice(1)),a.f=no(y,s),delete a.Formula,a.ArrayRange=="RC"?a.F=no("RC:RC",s):a.ArrayRange&&(a.F=no(a.ArrayRange,s),h.push([Mt(a.F),a.F]))}else for(b=0;b<h.length;++b)s.r>=h[b][0].s.r&&s.r<=h[b][0].e.r&&s.c>=h[b][0].s.c&&s.c<=h[b][0].e.c&&(a.F=h[b][1]);d.cellStyles&&(_.forEach(function(S){!v.patternType&&S.patternType&&(v.patternType=S.patternType)}),a.s=v),a.StyleID!==void 0&&(a.ixfe=a.StyleID)}function qD(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Md(e,t){var r=t||{};mo();var a=fc(Cm(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(a=Yt(a));var s=a.slice(0,1024).toLowerCase(),l=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var c=lr(r);return c.type="string",co.to_workbook(a,c)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Zt){s.indexOf("<"+Zt)>=0&&(l=!0)}),l)return RF(a,r);bc={"General Number":"General","General Date":ft[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ft[15],"Short Date":ft[14],"Long Time":ft[19],"Medium Time":ft[18],"Short Time":ft[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ft[2],Standard:ft[4],Percent:ft[10],Scientific:ft[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var u,h=[],d,g={},x=[],v=r.dense?[]:{},_="",b={},y={},S=wn('<Data ss:Type="String">'),k=0,R=0,T=0,j={s:{r:2e6,c:2e6},e:{r:0,c:0}},X={},L={},A="",K=0,q=[],ie={},ne={},Z=0,me=[],Re=[],Ae={},V=[],ae,xe=!1,J=[],be=[],I={},N=0,U=0,M={Sheets:[],WBProps:{date1904:!1}},P={};Lc.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"");for(var te="";u=Lc.exec(a);)switch(u[3]=(te=u[3]).toLowerCase()){case"data":if(te=="data"){if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break}if(h[h.length-1][1])break;u[1]==="/"?GD(a.slice(k,u.index),A,S,h[h.length-1][0]=="comment"?Ae:b,{c:R,r:T},X,V[R],y,J,r):(A="",S=wn(u[0]),k=u.index+u[0].length);break;case"cell":if(u[1]==="/")if(Re.length>0&&(b.c=Re),(!r.sheetRows||r.sheetRows>T)&&b.v!==void 0&&(r.dense?(v[T]||(v[T]=[]),v[T][R]=b):v[dr(R)+Tr(T)]=b),b.HRef&&(b.l={Target:Ft(b.HRef)},b.HRefScreenTip&&(b.l.Tooltip=b.HRefScreenTip),delete b.HRef,delete b.HRefScreenTip),(b.MergeAcross||b.MergeDown)&&(N=R+(parseInt(b.MergeAcross,10)|0),U=T+(parseInt(b.MergeDown,10)|0),q.push({s:{c:R,r:T},e:{c:N,r:U}})),!r.sheetStubs)b.MergeAcross?R=N+1:++R;else if(b.MergeAcross||b.MergeDown){for(var pe=R;pe<=N;++pe)for(var Ee=T;Ee<=U;++Ee)(pe>R||Ee>T)&&(r.dense?(v[Ee]||(v[Ee]=[]),v[Ee][pe]={t:"z"}):v[dr(pe)+Tr(Ee)]={t:"z"});R=N+1}else++R;else b=PD(u[0]),b.Index&&(R=+b.Index-1),R<j.s.c&&(j.s.c=R),R>j.e.c&&(j.e.c=R),u[0].slice(-2)==="/>"&&++R,Re=[];break;case"row":u[1]==="/"||u[0].slice(-2)==="/>"?(T<j.s.r&&(j.s.r=T),T>j.e.r&&(j.e.r=T),u[0].slice(-2)==="/>"&&(y=wn(u[0]),y.Index&&(T=+y.Index-1)),R=0,++T):(y=wn(u[0]),y.Index&&(T=+y.Index-1),I={},(y.AutoFitHeight=="0"||y.Height)&&(I.hpx=parseInt(y.Height,10),I.hpt=Pc(I.hpx),be[T]=I),y.Hidden=="1"&&(I.hidden=!0,be[T]=I));break;case"worksheet":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"));x.push(_),j.s.r<=j.e.r&&j.s.c<=j.e.c&&(v["!ref"]=vt(j),r.sheetRows&&r.sheetRows<=j.e.r&&(v["!fullref"]=v["!ref"],j.e.r=r.sheetRows-1,v["!ref"]=vt(j))),q.length&&(v["!merges"]=q),V.length>0&&(v["!cols"]=V),be.length>0&&(v["!rows"]=be),g[_]=v}else j={s:{r:2e6,c:2e6},e:{r:0,c:0}},T=R=0,h.push([u[3],!1]),d=wn(u[0]),_=Ft(d.Name),v=r.dense?[]:{},q=[],J=[],be=[],P={name:_,Hidden:0},M.Sheets.push(P);break;case"table":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else{if(u[0].slice(-2)=="/>")break;h.push([u[3],!1]),V=[],xe=!1}break;case"style":u[1]==="/"?VD(X,L,r):L=wn(u[0]);break;case"numberformat":L.nf=Ft(wn(u[0]).Format||"General"),bc[L.nf]&&(L.nf=bc[L.nf]);for(var ve=0;ve!=392&&ft[ve]!=L.nf;++ve);if(ve==392){for(ve=57;ve!=392;++ve)if(ft[ve]==null){ds(L.nf,ve);break}}break;case"column":if(h[h.length-1][0]!=="table")break;if(ae=wn(u[0]),ae.Hidden&&(ae.hidden=!0,delete ae.Hidden),ae.Width&&(ae.wpx=parseInt(ae.Width,10)),!xe&&ae.wpx>10){xe=!0,ha=C2;for(var Te=0;Te<V.length;++Te)V[Te]&&ai(V[Te])}xe&&ai(ae),V[ae.Index-1||V.length]=ae;for(var tt=0;tt<+ae.Span;++tt)V[V.length]=lr(ae);break;case"namedrange":if(u[1]==="/")break;M.Names||(M.Names=[]);var G=dt(u[0]),Rt={Name:G.Name,Ref:no(G.RefersTo.slice(1),{r:0,c:0})};M.Sheets.length>0&&(Rt.Sheet=M.Sheets.length-1),M.Names.push(Rt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(u[0].slice(-2)==="/>")break;u[1]==="/"?A+=a.slice(K,u.index):K=u.index+u[0].length;break;case"interior":if(!r.cellStyles)break;L.Interior=wn(u[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(u[0].slice(-2)==="/>")break;u[1]==="/"?p3(ie,te,a.slice(Z,u.index)):Z=u.index+u[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else h.push([u[3],!1]);break;case"comment":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"));qD(Ae),Re.push(Ae)}else h.push([u[3],!1]),d=wn(u[0]),Ae={a:d.Author};break;case"autofilter":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else if(u[0].charAt(u[0].length-2)!=="/"){var We=wn(u[0]);v["!autofilter"]={ref:no(We.Range).replace(/\$/g,"")},h.push([u[3],!0])}break;case"name":break;case"datavalidation":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break;case"null":break;default:if(h.length==0&&u[3]=="document"||h.length==0&&u[3]=="uof")return Ny(a,r);var bt=!0;switch(h[h.length-1][0]){case"officedocumentsettings":switch(u[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:bt=!1}break;case"componentoptions":switch(u[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:bt=!1}break;case"excelworkbook":switch(u[3]){case"date1904":M.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:bt=!1}break;case"workbookoptions":switch(u[3]){case"owcversion":break;case"height":break;case"width":break;default:bt=!1}break;case"worksheetoptions":switch(u[3]){case"visible":if(u[0].slice(-2)!=="/>")if(u[1]==="/")switch(a.slice(Z,u.index)){case"SheetHidden":P.Hidden=1;break;case"SheetVeryHidden":P.Hidden=2;break}else Z=u.index+u[0].length;break;case"header":v["!margins"]||zi(v["!margins"]={},"xlml"),isNaN(+dt(u[0]).Margin)||(v["!margins"].header=+dt(u[0]).Margin);break;case"footer":v["!margins"]||zi(v["!margins"]={},"xlml"),isNaN(+dt(u[0]).Margin)||(v["!margins"].footer=+dt(u[0]).Margin);break;case"pagemargins":var lt=dt(u[0]);v["!margins"]||zi(v["!margins"]={},"xlml"),isNaN(+lt.Top)||(v["!margins"].top=+lt.Top),isNaN(+lt.Left)||(v["!margins"].left=+lt.Left),isNaN(+lt.Right)||(v["!margins"].right=+lt.Right),isNaN(+lt.Bottom)||(v["!margins"].bottom=+lt.Bottom);break;case"displayrighttoleft":M.Views||(M.Views=[]),M.Views[0]||(M.Views[0]={}),M.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":v["!outline"]||(v["!outline"]={}),v["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":v["!outline"]||(v["!outline"]={}),v["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:bt=!1}break;case"pivottable":case"pivotcache":switch(u[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:bt=!1}break;case"pagebreaks":switch(u[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:bt=!1}break;case"autofilter":switch(u[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:bt=!1}break;case"querytable":switch(u[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:bt=!1}break;case"datavalidation":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:bt=!1}break;case"sorting":case"conditionalformatting":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:bt=!1}break;case"mapinfo":case"schema":case"data":switch(u[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:bt=!1}break;case"smarttags":break;default:bt=!1;break}if(bt||u[3].match(/!\[CDATA/))break;if(!h[h.length-1][1])throw"Unrecognized tag: "+u[3]+"|"+h.join("|");if(h[h.length-1][0]==="customdocumentproperties"){if(u[0].slice(-2)==="/>")break;u[1]==="/"?HD(ne,te,me,a.slice(Z,u.index)):(me=u,Z=u.index+u[0].length);break}if(r.WTF)throw"Unrecognized tag: "+u[3]+"|"+h.join("|")}var Pe={};return!r.bookSheets&&!r.bookProps&&(Pe.Sheets=g),Pe.SheetNames=x,Pe.Workbook=M,Pe.SSF=lr(ft),Pe.Props=ie,Pe.Custprops=ne,Pe}function sm(e,t){switch(Qm(t=t||{}),t.type||"base64"){case"base64":return Md(Ya(e),t);case"binary":case"buffer":case"file":return Md(e,t);case"array":return Md(li(e),t)}}function XD(e,t){var r=[];return e.Props&&r.push(x3(e.Props,t)),e.Custprops&&r.push(v3(e.Props,e.Custprops)),r.join("")}function WD(){return""}function KD(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(a,s){var l=[];l.push(Be("NumberFormat",null,{"ss:Format":$t(ft[a.numFmtId])}));var c={"ss:ID":"s"+(21+s)};r.push(Be("Style",l.join(""),c))}),Be("Styles",r.join(""))}function tw(e){return Be("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+qm(e.Ref,{r:0,c:0})})}function YD(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],a=0;a<t.length;++a){var s=t[a];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(tw(s)))}return Be("Names",r.join(""))}function JD(e,t,r,a){if(!e||!((a||{}).Workbook||{}).Names)return"";for(var s=a.Workbook.Names,l=[],c=0;c<s.length;++c){var u=s[c];u.Sheet==r&&(u.Name.match(/^_xlfn\./)||l.push(tw(u)))}return l.join("")}function QD(e,t,r,a){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(Be("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(Be("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(Be("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),a&&a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[r])if(a.Workbook.Sheets[r].Hidden)s.push(Be("Visible",a.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var l=0;l<r&&!(a.Workbook.Sheets[l]&&!a.Workbook.Sheets[l].Hidden);++l);l==r&&s.push("<Selected/>")}return((((a||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(na("ProtectContents","True")),e["!protect"].objects&&s.push(na("ProtectObjects","True")),e["!protect"].scenarios&&s.push(na("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(na("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(na("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(c){e["!protect"][c[0]]&&s.push("<"+c[1]+"/>")})),s.length==0?"":Be("WorksheetOptions",s.join(""),{xmlns:Va.x})}function ZD(e){return e.map(function(t){var r=_A(t.t||""),a=Be("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Be("Comment",a,{"ss:Author":t.a})}).join("")}function eF(e,t,r,a,s,l,c){if(!e||e.v==null&&e.f==null)return"";var u={};if(e.f&&(u["ss:Formula"]="="+$t(qm(e.f,c))),e.F&&e.F.slice(0,t.length)==t){var h=mr(e.F.slice(t.length+1));u["ss:ArrayRange"]="RC:R"+(h.r==c.r?"":"["+(h.r-c.r)+"]")+"C"+(h.c==c.c?"":"["+(h.c-c.c)+"]")}if(e.l&&e.l.Target&&(u["ss:HRef"]=$t(e.l.Target),e.l.Tooltip&&(u["x:HRefScreenTip"]=$t(e.l.Tooltip))),r["!merges"])for(var d=r["!merges"],g=0;g!=d.length;++g)d[g].s.c!=c.c||d[g].s.r!=c.r||(d[g].e.c>d[g].s.c&&(u["ss:MergeAcross"]=d[g].e.c-d[g].s.c),d[g].e.r>d[g].s.r&&(u["ss:MergeDown"]=d[g].e.r-d[g].s.r));var x="",v="";switch(e.t){case"z":if(!a.sheetStubs)return"";break;case"n":x="Number",v=String(e.v);break;case"b":x="Boolean",v=e.v?"1":"0";break;case"e":x="Error",v=ys[e.v];break;case"d":x="DateTime",v=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||ft[14]);break;case"s":x="String",v=yA(e.v||"");break}var _=ci(a.cellXfs,e,a);u["ss:StyleID"]="s"+(21+_),u["ss:Index"]=c.c+1;var b=e.v!=null?v:"",y=e.t=="z"?"":'<Data ss:Type="'+x+'">'+b+"</Data>";return(e.c||[]).length>0&&(y+=ZD(e.c)),Be("Cell",y,u)}function tF(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=uo(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function rF(e,t,r,a){if(!e["!ref"])return"";var s=Mt(e["!ref"]),l=e["!merges"]||[],c=0,u=[];e["!cols"]&&e["!cols"].forEach(function(S,k){ai(S);var R=!!S.width,T=af(k,S),j={"ss:Index":k+1};R&&(j["ss:Width"]=jc(T.width)),S.hidden&&(j["ss:Hidden"]="1"),u.push(Be("Column",null,j))});for(var h=Array.isArray(e),d=s.s.r;d<=s.e.r;++d){for(var g=[tF(d,(e["!rows"]||[])[d])],x=s.s.c;x<=s.e.c;++x){var v=!1;for(c=0;c!=l.length;++c)if(!(l[c].s.c>x)&&!(l[c].s.r>d)&&!(l[c].e.c<x)&&!(l[c].e.r<d)){(l[c].s.c!=x||l[c].s.r!=d)&&(v=!0);break}if(!v){var _={r:d,c:x},b=ht(_),y=h?(e[d]||[])[x]:e[b];g.push(eF(y,b,e,t,r,a,_))}}g.push("</Row>"),g.length>2&&u.push(g.join(""))}return u.join("")}function aF(e,t,r){var a=[],s=r.SheetNames[e],l=r.Sheets[s],c=l?JD(l,t,e,r):"";return c.length>0&&a.push("<Names>"+c+"</Names>"),c=l?rF(l,t,e,r):"",c.length>0&&a.push("<Table>"+c+"</Table>"),a.push(QD(l,t,e,r)),a.join("")}function nF(e,t){t||(t={}),e.SSF||(e.SSF=lr(ft)),e.SSF&&(mo(),Yu(e.SSF),t.revssf=Qu(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],ci(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(XD(e,t)),r.push(WD()),r.push(""),r.push("");for(var a=0;a<e.SheetNames.length;++a)r.push(Be("Worksheet",aF(a,t,e),{"ss:Name":$t(e.SheetNames[a])}));return r[2]=KD(e,t),r[3]=YD(e),kr+Be("Workbook",r.join(""),{xmlns:Va.ss,"xmlns:o":Va.o,"xmlns:x":Va.x,"xmlns:ss":Va.ss,"xmlns:dt":Va.dt,"xmlns:html":Va.html})}function sF(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=YA(r),r.length-r.l<=4)return t;var a=r.read_shift(4);if(a==0||a>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(a=r.read_shift(4),a!==1907505652)||(t.UnicodeClipboardFormat=JA(r),a=r.read_shift(4),a==0||a>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var iF=[60,1084,2066,2165,2175];function lF(e,t,r,a,s){var l=a,c=[],u=r.slice(r.l,r.l+l);if(s&&s.enc&&s.enc.insitu&&u.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(u)}c.push(u),r.l+=l;for(var h=fs(r,r.l),d=im[h],g=0;d!=null&&iF.indexOf(h)>-1;)l=fs(r,r.l+2),g=r.l+4,h==2066?g+=4:(h==2165||h==2175)&&(g+=12),u=r.slice(g,r.l+4+l),c.push(u),r.l+=4+l,d=im[h=fs(r,r.l)];var x=Xr(c);aa(x,0);var v=0;x.lens=[];for(var _=0;_<c.length;++_)x.lens.push(v),v+=c[_].length;if(x.length<a)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+x.length+" < "+a;return t.f(x,x.length,s)}function Ln(e,t,r){if(e.t!=="z"&&e.XF){var a=0;try{a=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=ft[a])}catch(l){if(t.WTF)throw l}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||ys[e.v]:a===0||a=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Dc(e.v):e.w=Hi(e.v):e.w=gn(a,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(l){if(t.WTF)throw l}if(t.cellDates&&a&&e.t=="n"&&ho(ft[a]||String(a))){var s=Ii(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function Tu(e,t,r){return{v:e,ixfe:t,t:r}}function oF(e,t){var r={opts:{}},a={},s=t.dense?[]:{},l={},c={},u=null,h=[],d="",g={},x,v="",_,b,y,S,k={},R=[],T,j,X=[],L=[],A={Sheets:[],WBProps:{date1904:!1},Views:[{}]},K={},q=function(mt){return mt<8?ji[mt]:mt<64&&L[mt-8]||ji[mt]},ie=function(mt,Dt,Ir){var Vt=Dt.XF.data;if(!(!Vt||!Vt.patternType||!Ir||!Ir.cellStyles)){Dt.s={},Dt.s.patternType=Vt.patternType;var er;(er=Ic(q(Vt.icvFore)))&&(Dt.s.fgColor={rgb:er}),(er=Ic(q(Vt.icvBack)))&&(Dt.s.bgColor={rgb:er})}},ne=function(mt,Dt,Ir){if(!(I>1)&&!(Ir.sheetRows&&mt.r>=Ir.sheetRows)){if(Ir.cellStyles&&Dt.XF&&Dt.XF.data&&ie(mt,Dt,Ir),delete Dt.ixfe,delete Dt.XF,x=mt,v=ht(mt),(!c||!c.s||!c.e)&&(c={s:{r:0,c:0},e:{r:0,c:0}}),mt.r<c.s.r&&(c.s.r=mt.r),mt.c<c.s.c&&(c.s.c=mt.c),mt.r+1>c.e.r&&(c.e.r=mt.r+1),mt.c+1>c.e.c&&(c.e.c=mt.c+1),Ir.cellFormula&&Dt.f){for(var Vt=0;Vt<R.length;++Vt)if(!(R[Vt][0].s.c>mt.c||R[Vt][0].s.r>mt.r)&&!(R[Vt][0].e.c<mt.c||R[Vt][0].e.r<mt.r)){Dt.F=vt(R[Vt][0]),(R[Vt][0].s.c!=mt.c||R[Vt][0].s.r!=mt.r)&&delete Dt.f,Dt.f&&(Dt.f=""+fa(R[Vt][1],c,mt,J,Z));break}}Ir.dense?(s[mt.r]||(s[mt.r]=[]),s[mt.r][mt.c]=Dt):s[v]=Dt}},Z={enc:!1,sbcch:0,snames:[],sharedf:k,arrayf:R,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(Z.password=t.password);var me,Re=[],Ae=[],V=[],ae=[],xe=!1,J=[];J.SheetNames=Z.snames,J.sharedf=Z.sharedf,J.arrayf=Z.arrayf,J.names=[],J.XTI=[];var be=0,I=0,N=0,U=[],M=[],P;Z.codepage=1200,Tn(1200);for(var te=!1;e.l<e.length-1;){var pe=e.l,Ee=e.read_shift(2);if(Ee===0&&be===10)break;var ve=e.l===e.length?0:e.read_shift(2),Te=im[Ee];if(Te&&Te.f){if(t.bookSheets&&be===133&&Ee!==133)break;if(be=Ee,Te.r===2||Te.r==12){var tt=e.read_shift(2);if(ve-=2,!Z.enc&&tt!==Ee&&((tt&255)<<8|tt>>8)!==Ee)throw new Error("rt mismatch: "+tt+"!="+Ee);Te.r==12&&(e.l+=10,ve-=10)}var G={};if(Ee===10?G=Te.f(e,ve,Z):G=lF(Ee,Te,e,ve,Z),I==0&&[9,521,1033,2057].indexOf(be)===-1)continue;switch(Ee){case 34:r.opts.Date1904=A.WBProps.date1904=G;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(Z.enc||(e.l=0),Z.enc=G,!t.password)throw new Error("File is password-protected");if(G.valid==null)throw new Error("Encryption scheme unsupported");if(!G.valid)throw new Error("Password is incorrect");break;case 92:Z.lastuser=G;break;case 66:var Rt=Number(G);switch(Rt){case 21010:Rt=1200;break;case 32768:Rt=1e4;break;case 32769:Rt=1252;break}Tn(Z.codepage=Rt),te=!0;break;case 317:Z.rrtabid=G;break;case 25:Z.winlocked=G;break;case 439:r.opts.RefreshAll=G;break;case 12:r.opts.CalcCount=G;break;case 16:r.opts.CalcDelta=G;break;case 17:r.opts.CalcIter=G;break;case 13:r.opts.CalcMode=G;break;case 14:r.opts.CalcPrecision=G;break;case 95:r.opts.CalcSaveRecalc=G;break;case 15:Z.CalcRefMode=G;break;case 2211:r.opts.FullCalc=G;break;case 129:G.fDialog&&(s["!type"]="dialog"),G.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),G.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:X.push(G);break;case 430:J.push([G]),J[J.length-1].XTI=[];break;case 35:case 547:J[J.length-1].push(G);break;case 24:case 536:P={Name:G.Name,Ref:fa(G.rgce,c,null,J,Z)},G.itab>0&&(P.Sheet=G.itab-1),J.names.push(P),J[0]||(J[0]=[],J[0].XTI=[]),J[J.length-1].push(G),G.Name=="_xlnm._FilterDatabase"&&G.itab>0&&G.rgce&&G.rgce[0]&&G.rgce[0][0]&&G.rgce[0][0][0]=="PtgArea3d"&&(M[G.itab-1]={ref:vt(G.rgce[0][0][1][2])});break;case 22:Z.ExternCount=G;break;case 23:J.length==0&&(J[0]=[],J[0].XTI=[]),J[J.length-1].XTI=J[J.length-1].XTI.concat(G),J.XTI=J.XTI.concat(G);break;case 2196:if(Z.biff<8)break;P!=null&&(P.Comment=G[1]);break;case 18:s["!protect"]=G;break;case 19:G!==0&&Z.WTF&&console.error("Password verifier: "+G);break;case 133:l[G.pos]=G,Z.snames.push(G.name);break;case 10:{if(--I)break;if(c.e){if(c.e.r>0&&c.e.c>0){if(c.e.r--,c.e.c--,s["!ref"]=vt(c),t.sheetRows&&t.sheetRows<=c.e.r){var We=c.e.r;c.e.r=t.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=vt(c),c.e.r=We}c.e.r++,c.e.c++}Re.length>0&&(s["!merges"]=Re),Ae.length>0&&(s["!objects"]=Ae),V.length>0&&(s["!cols"]=V),ae.length>0&&(s["!rows"]=ae),A.Sheets.push(K)}d===""?g=s:a[d]=s,s=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(Z.biff===8&&(Z.biff={9:2,521:3,1033:4}[Ee]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[G.BIFFVer]||8),Z.biffguess=G.BIFFVer==0,G.BIFFVer==0&&G.dt==4096&&(Z.biff=5,te=!0,Tn(Z.codepage=28591)),Z.biff==8&&G.BIFFVer==0&&G.dt==16&&(Z.biff=2),I++)break;if(s=t.dense?[]:{},Z.biff<8&&!te&&(te=!0,Tn(Z.codepage=t.codepage||1252)),Z.biff<5||G.BIFFVer==0&&G.dt==4096){d===""&&(d="Sheet1"),c={s:{r:0,c:0},e:{r:0,c:0}};var bt={pos:e.l-ve,name:d};l[bt.pos]=bt,Z.snames.push(d)}else d=(l[pe]||{name:""}).name;G.dt==32&&(s["!type"]="chart"),G.dt==64&&(s["!type"]="macro"),Re=[],Ae=[],Z.arrayf=R=[],V=[],ae=[],xe=!1,K={Hidden:(l[pe]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(t.dense?(s[G.r]||[])[G.c]:s[ht({c:G.c,r:G.r})])&&++G.c,T={ixfe:G.ixfe,XF:X[G.ixfe]||{},v:G.val,t:"n"},N>0&&(T.z=U[T.ixfe>>8&63]),Ln(T,t,r.opts.Date1904),ne({c:G.c,r:G.r},T,t);break;case 5:case 517:T={ixfe:G.ixfe,XF:X[G.ixfe],v:G.val,t:G.t},N>0&&(T.z=U[T.ixfe>>8&63]),Ln(T,t,r.opts.Date1904),ne({c:G.c,r:G.r},T,t);break;case 638:T={ixfe:G.ixfe,XF:X[G.ixfe],v:G.rknum,t:"n"},N>0&&(T.z=U[T.ixfe>>8&63]),Ln(T,t,r.opts.Date1904),ne({c:G.c,r:G.r},T,t);break;case 189:for(var lt=G.c;lt<=G.C;++lt){var Pe=G.rkrec[lt-G.c][0];T={ixfe:Pe,XF:X[Pe],v:G.rkrec[lt-G.c][1],t:"n"},N>0&&(T.z=U[T.ixfe>>8&63]),Ln(T,t,r.opts.Date1904),ne({c:lt,r:G.r},T,t)}break;case 6:case 518:case 1030:{if(G.val=="String"){u=G;break}if(T=Tu(G.val,G.cell.ixfe,G.tt),T.XF=X[T.ixfe],t.cellFormula){var Zt=G.formula;if(Zt&&Zt[0]&&Zt[0][0]&&Zt[0][0][0]=="PtgExp"){var Ar=Zt[0][0][1][0],Hr=Zt[0][0][1][1],$r=ht({r:Ar,c:Hr});k[$r]?T.f=""+fa(G.formula,c,G.cell,J,Z):T.F=((t.dense?(s[Ar]||[])[Hr]:s[$r])||{}).F}else T.f=""+fa(G.formula,c,G.cell,J,Z)}N>0&&(T.z=U[T.ixfe>>8&63]),Ln(T,t,r.opts.Date1904),ne(G.cell,T,t),u=G}break;case 7:case 519:if(u)u.val=G,T=Tu(G,u.cell.ixfe,"s"),T.XF=X[T.ixfe],t.cellFormula&&(T.f=""+fa(u.formula,c,u.cell,J,Z)),N>0&&(T.z=U[T.ixfe>>8&63]),Ln(T,t,r.opts.Date1904),ne(u.cell,T,t),u=null;else throw new Error("String record expects Formula");break;case 33:case 545:{R.push(G);var zn=ht(G[0].s);if(_=t.dense?(s[G[0].s.r]||[])[G[0].s.c]:s[zn],t.cellFormula&&_){if(!u||!zn||!_)break;_.f=""+fa(G[1],c,G[0],J,Z),_.F=vt(G[0])}}break;case 1212:{if(!t.cellFormula)break;if(v){if(!u)break;k[ht(u.cell)]=G[0],_=t.dense?(s[u.cell.r]||[])[u.cell.c]:s[ht(u.cell)],(_||{}).f=""+fa(G[0],c,x,J,Z)}}break;case 253:T=Tu(h[G.isst].t,G.ixfe,"s"),h[G.isst].h&&(T.h=h[G.isst].h),T.XF=X[T.ixfe],N>0&&(T.z=U[T.ixfe>>8&63]),Ln(T,t,r.opts.Date1904),ne({c:G.c,r:G.r},T,t);break;case 513:t.sheetStubs&&(T={ixfe:G.ixfe,XF:X[G.ixfe],t:"z"},N>0&&(T.z=U[T.ixfe>>8&63]),Ln(T,t,r.opts.Date1904),ne({c:G.c,r:G.r},T,t));break;case 190:if(t.sheetStubs)for(var Ja=G.c;Ja<=G.C;++Ja){var Et=G.ixfe[Ja-G.c];T={ixfe:Et,XF:X[Et],t:"z"},N>0&&(T.z=U[T.ixfe>>8&63]),Ln(T,t,r.opts.Date1904),ne({c:Ja,r:G.r},T,t)}break;case 214:case 516:case 4:T=Tu(G.val,G.ixfe,"s"),T.XF=X[T.ixfe],N>0&&(T.z=U[T.ixfe>>8&63]),Ln(T,t,r.opts.Date1904),ne({c:G.c,r:G.r},T,t);break;case 0:case 512:I===1&&(c=G);break;case 252:h=G;break;case 1054:if(Z.biff==4){U[N++]=G[1];for(var xa=0;xa<N+163&&ft[xa]!=G[1];++xa);xa>=163&&ds(G[1],N+163)}else ds(G[1],G[0]);break;case 30:{U[N++]=G;for(var sa=0;sa<N+163&&ft[sa]!=G;++sa);sa>=163&&ds(G,N+163)}break;case 229:Re=Re.concat(G);break;case 93:Ae[G.cmo[0]]=Z.lastobj=G;break;case 438:Z.lastobj.TxO=G;break;case 127:Z.lastobj.ImData=G;break;case 440:for(S=G[0].s.r;S<=G[0].e.r;++S)for(y=G[0].s.c;y<=G[0].e.c;++y)_=t.dense?(s[S]||[])[y]:s[ht({c:y,r:S})],_&&(_.l=G[1]);break;case 2048:for(S=G[0].s.r;S<=G[0].e.r;++S)for(y=G[0].s.c;y<=G[0].e.c;++y)_=t.dense?(s[S]||[])[y]:s[ht({c:y,r:S})],_&&_.l&&(_.l.Tooltip=G[1]);break;case 28:{if(Z.biff<=5&&Z.biff>=2)break;_=t.dense?(s[G[0].r]||[])[G[0].c]:s[ht(G[0])];var Ma=Ae[G[2]];_||(t.dense?(s[G[0].r]||(s[G[0].r]=[]),_=s[G[0].r][G[0].c]={t:"z"}):_=s[ht(G[0])]={t:"z"},c.e.r=Math.max(c.e.r,G[0].r),c.s.r=Math.min(c.s.r,G[0].r),c.e.c=Math.max(c.e.c,G[0].c),c.s.c=Math.min(c.s.c,G[0].c)),_.c||(_.c=[]),b={a:G[1],t:Ma.TxO.t},_.c.push(b)}break;case 2173:K6(X[G.ixfe],G.ext);break;case 125:{if(!Z.cellStyles)break;for(;G.e>=G.s;)V[G.e--]={width:G.w/256,level:G.level||0,hidden:!!(G.flags&1)},xe||(xe=!0,$m(G.w/256)),ai(V[G.e+1])}break;case 520:{var Jt={};G.level!=null&&(ae[G.r]=Jt,Jt.level=G.level),G.hidden&&(ae[G.r]=Jt,Jt.hidden=!0),G.hpt&&(ae[G.r]=Jt,Jt.hpt=G.hpt,Jt.hpx=uo(G.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||zi(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Ee]]=G;break;case 161:s["!margins"]||zi(s["!margins"]={}),s["!margins"].header=G.header,s["!margins"].footer=G.footer;break;case 574:G.RTL&&(A.Views[0].RTL=!0);break;case 146:L=G;break;case 2198:me=G;break;case 140:j=G;break;case 442:d?K.CodeName=G||K.name:A.WBProps.CodeName=G||"ThisWorkbook";break}}else Te||console.error("Missing Info for XLS Record 0x"+Ee.toString(16)),e.l+=ve}return r.SheetNames=wr(l).sort(function(ia,mt){return Number(ia)-Number(mt)}).map(function(ia){return l[ia].name}),t.bookSheets||(r.Sheets=a),!r.SheetNames.length&&g["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=g)):r.Preamble=g,r.Sheets&&M.forEach(function(ia,mt){r.Sheets[r.SheetNames[mt]]["!autofilter"]=ia}),r.Strings=h,r.SSF=lr(ft),Z.enc&&(r.Encryption=Z.enc),me&&(r.Themes=me),r.Metadata={},j!==void 0&&(r.Metadata.Country=j),J.names.length>0&&(A.Names=J.names),r.Workbook=A,r}var Sc={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function cF(e,t,r){var a=it.find(e,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var s=sy(a,Zd,Sc.DSI);for(var l in s)t[l]=s[l]}catch(d){if(r.WTF)throw d}var c=it.find(e,"/!SummaryInformation");if(c&&c.size>0)try{var u=sy(c,em,Sc.SI);for(var h in u)t[h]==null&&(t[h]=u[h])}catch(d){if(r.WTF)throw d}t.HeadingPairs&&t.TitlesOfParts&&(e2(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function uF(e,t){var r=[],a=[],s=[],l=0,c,u=Lv(Zd,"n"),h=Lv(em,"n");if(e.Props)for(c=wr(e.Props),l=0;l<c.length;++l)(Object.prototype.hasOwnProperty.call(u,c[l])?r:Object.prototype.hasOwnProperty.call(h,c[l])?a:s).push([c[l],e.Props[c[l]]]);if(e.Custprops)for(c=wr(e.Custprops),l=0;l<c.length;++l)Object.prototype.hasOwnProperty.call(e.Props||{},c[l])||(Object.prototype.hasOwnProperty.call(u,c[l])?r:Object.prototype.hasOwnProperty.call(h,c[l])?a:s).push([c[l],e.Custprops[c[l]]]);var d=[];for(l=0;l<s.length;++l)l2.indexOf(s[l][0])>-1||Z_.indexOf(s[l][0])>-1||s[l][1]!=null&&d.push(s[l]);a.length&&it.utils.cfb_add(t,"/SummaryInformation",iy(a,Sc.SI,h,em)),(r.length||d.length)&&it.utils.cfb_add(t,"/DocumentSummaryInformation",iy(r,Sc.DSI,u,Zd,d.length?d:null,Sc.UDI))}function rw(e,t){t||(t={}),Qm(t),ym(),t.codepage&&vm(t.codepage);var r,a;if(e.FullPaths){if(it.find(e,"/encryption"))throw new Error("File is password-protected");r=it.find(e,"!CompObj"),a=it.find(e,"/Workbook")||it.find(e,"/Book")}else{switch(t.type){case"base64":e=Wa(Ya(e));break;case"binary":e=Wa(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}aa(e,0),a={content:e}}var s,l;if(r&&sF(r),t.bookProps&&!t.bookSheets)s={};else{var c=wt?"buffer":"array";if(a&&a.content)s=oF(a.content,t);else if((l=it.find(e,"PerfectOffice_MAIN"))&&l.content)s=Pi.to_workbook(l.content,(t.type=c,t));else if((l=it.find(e,"NativeContent_MAIN"))&&l.content)s=Pi.to_workbook(l.content,(t.type=c,t));else throw(l=it.find(e,"MN0"))&&l.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&it.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=S8(e))}var u={};return e.FullPaths&&cF(e,u,t),s.Props=s.Custprops=u,t.bookFiles&&(s.cfb=e),s}function fF(e,t){var r=t||{},a=it.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return it.utils.cfb_add(a,s,aw(e,r)),r.biff==8&&(e.Props||e.Custprops)&&uF(e,a),r.biff==8&&e.vbaraw&&E8(a,it.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),a}var zc={0:{f:L5},1:{f:$5},2:{f:oR},3:{f:J5},4:{f:X5},5:{f:sR},6:{f:dR},7:{f:tR},8:{f:_R},9:{f:yR},10:{f:xR},11:{f:vR},12:{f:G5},13:{f:uR},14:{f:Z5},15:{f:K5},16:{f:W2},17:{f:gR},18:{f:aR},19:{f:Fm},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:gD},40:{},42:{},43:{f:d6},44:{f:f6},45:{f:p6},46:{f:v6},47:{f:x6},48:{},49:{f:jA},50:{},51:{f:Q6},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:v2},62:{f:hR},63:{f:l8},64:{f:BR},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:ga,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:DR},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:z5},148:{f:j5,p:16},151:{f:kR},152:{},153:{f:hD},154:{},155:{},156:{f:uD},157:{},158:{},159:{T:1,f:CN},160:{T:-1},161:{T:1,f:Zi},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:wR},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Y6},336:{T:-1},337:{f:t8,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Qd},357:{},358:{},359:{},360:{T:1},361:{},362:{f:x2},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:AR},427:{f:CR},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:OR},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:P5},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:ER},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Qd},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:v8},633:{T:1},634:{T:-1},635:{T:1,f:p8},636:{T:-1},637:{f:HA},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:ZR},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:IR},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},im={6:{f:Dd},10:{f:Ws},12:{f:Lr},13:{f:Lr},14:{f:Er},15:{f:Er},16:{f:da},17:{f:Er},18:{f:Er},19:{f:Lr},20:{f:hy},21:{f:hy},23:{f:x2},24:{f:my},25:{f:Er},26:{},27:{},28:{f:IC},29:{},34:{f:Er},35:{f:dy},38:{f:da},39:{f:da},40:{f:da},41:{f:da},42:{f:Er},43:{f:Er},47:{f:KN},49:{f:uC},51:{f:Lr},60:{},61:{f:sC},64:{f:Er},65:{f:cC},66:{f:Lr},77:{},80:{},81:{},82:{},85:{f:Lr},89:{},90:{},91:{},92:{f:W3},93:{f:PC},94:{},95:{f:Er},96:{},97:{},99:{f:Er},125:{f:v2},128:{f:TC},129:{f:Y3},130:{f:Lr},131:{f:Er},132:{f:Er},133:{f:J3},134:{},140:{f:WC},141:{f:Lr},144:{},146:{f:JC},151:{},152:{},153:{},154:{},155:{},156:{f:Lr},157:{},158:{},160:{f:nN},161:{f:eN},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:wC},190:{f:bC},193:{f:Ws},197:{},198:{},199:{},200:{},201:{},202:{f:Er},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Lr},220:{},221:{f:Er},222:{},224:{f:EC},225:{f:X3},226:{f:Ws},227:{},229:{f:jC},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:Z3},253:{f:hC},255:{f:tC},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:o2},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Er},353:{f:Ws},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:OC},431:{f:Er},432:{},433:{},434:{},437:{},438:{f:$C},439:{f:Er},440:{f:VC},441:{},442:{f:Yc},443:{},444:{f:Lr},445:{},446:{},448:{f:Ws},449:{f:nC,r:2},450:{f:Ws},512:{f:cy},513:{f:aN},515:{f:CC},516:{f:mC},517:{f:fy},519:{f:sN},520:{f:rC},523:{},545:{f:gy},549:{f:oy},566:{},574:{f:lC},638:{f:_C},659:{},1048:{},1054:{f:pC},1084:{},1212:{f:MC},2048:{f:qC},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:bu},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ws},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:QC,r:12},2173:{f:W6,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Er,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:FC,r:12},2197:{},2198:{f:H6,r:12},2199:{},2200:{},2201:{},2202:{f:LC,r:12},2203:{f:Ws},2204:{},2205:{},2206:{},2207:{},2211:{f:aC},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Lr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:tN},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:YC},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:cy},1:{},2:{f:uN},3:{f:oN},4:{f:lN},5:{f:fy},7:{f:hN},8:{},9:{f:bu},11:{},22:{f:Lr},30:{f:vC},31:{},32:{},33:{f:gy},36:{},37:{f:oy},50:{f:dN},62:{},52:{},67:{},68:{f:Lr},69:{},86:{},126:{},127:{f:iN},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:mN},223:{},234:{},354:{},421:{},518:{f:Dd},521:{f:bu},536:{f:my},547:{f:dy},561:{},579:{},1030:{f:Dd},1033:{f:bu},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function je(e,t,r,a){var s=t;if(!isNaN(s)){var l=a||(r||[]).length||0,c=e.next(4);c.write_shift(2,s),c.write_shift(2,l),l>0&&Om(r)&&e.push(r)}}function hF(e,t,r,a){var s=(r||[]).length||0;if(s<=8224)return je(e,t,r,s);var l=t;if(!isNaN(l)){for(var c=r.parts||[],u=0,h=0,d=0;d+(c[u]||8224)<=8224;)d+=c[u]||8224,u++;var g=e.next(4);for(g.write_shift(2,l),g.write_shift(2,d),e.push(r.slice(h,h+d)),h+=d;h<s;){for(g=e.next(4),g.write_shift(2,60),d=0;d+(c[u]||8224)<=8224;)d+=c[u]||8224,u++;g.write_shift(2,d),e.push(r.slice(h,h+d)),h+=d}}}function e0(e,t,r){return e||(e=ye(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function dF(e,t,r,a){var s=ye(9);return e0(s,e,t),c2(r,a||"b",s),s}function mF(e,t,r){var a=ye(8+2*r.length);return e0(a,e,t),a.write_shift(1,r.length),a.write_shift(r.length,r,"sbcs"),a.l<a.length?a.slice(0,a.l):a}function gF(e,t,r,a){if(t.v!=null)switch(t.t){case"d":case"n":var s=t.t=="d"?zr(ir(t.v)):t.v;s==(s|0)&&s>=0&&s<65536?je(e,2,fN(r,a,s)):je(e,3,cN(r,a,s));return;case"b":case"e":je(e,5,dF(r,a,t.v,t.t));return;case"s":case"str":je(e,4,mF(r,a,(t.v||"").slice(0,255)));return}je(e,1,e0(null,r,a))}function pF(e,t,r,a){var s=Array.isArray(t),l=Mt(t["!ref"]||"A1"),c,u="",h=[];if(l.e.c>255||l.e.r>16383){if(a.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");l.e.c=Math.min(l.e.c,255),l.e.r=Math.min(l.e.c,16383),c=vt(l)}for(var d=l.s.r;d<=l.e.r;++d){u=Tr(d);for(var g=l.s.c;g<=l.e.c;++g){d===l.s.r&&(h[g]=dr(g)),c=h[g]+u;var x=s?(t[d]||[])[g]:t[c];x&&gF(e,x,d,g)}}}function xF(e,t){for(var r=t||{},a=Da(),s=0,l=0;l<e.SheetNames.length;++l)e.SheetNames[l]==r.sheet&&(s=l);if(s==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return je(a,r.biff==4?1033:r.biff==3?521:9,Pm(e,16,r)),pF(a,e.Sheets[e.SheetNames[s]],s,r),je(a,10),a.end()}function vF(e,t,r){je(e,49,fC({sz:12,name:"Arial"},r))}function yF(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var s=a[0];s<=a[1];++s)t[s]!=null&&je(e,1054,xC(s,t[s],r))})}function _F(e,t){var r=ye(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),je(e,2151,r),r=ye(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),m2(Mt(t["!ref"]||"A1"),r),r.write_shift(4,4),je(e,2152,r)}function wF(e,t){for(var r=0;r<16;++r)je(e,224,uy({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(a){je(e,224,uy(a,0,t))})}function bF(e,t){for(var r=0;r<t["!links"].length;++r){var a=t["!links"][r];je(e,440,GC(a)),a[1].Tooltip&&je(e,2048,XC(a))}delete t["!links"]}function SF(e,t){if(t){var r=0;t.forEach(function(a,s){++r<=256&&a&&je(e,125,ZC(af(s,a),s))})}}function EF(e,t,r,a,s){var l=16+ci(s.cellXfs,t,s);if(t.v==null&&!t.bf){je(e,513,qi(r,a,l));return}if(t.bf)je(e,6,YO(t,r,a,s,l));else switch(t.t){case"d":case"n":var c=t.t=="d"?zr(ir(t.v)):t.v;je(e,515,NC(r,a,c,l));break;case"b":case"e":je(e,517,AC(r,a,t.v,l,s,t.t));break;case"s":case"str":if(s.bookSST){var u=Wm(s.Strings,t.v,s.revStrings);je(e,253,dC(r,a,u,l))}else je(e,516,gC(r,a,(t.v||"").slice(0,255),l,s));break;default:je(e,513,qi(r,a,l))}}function TF(e,t,r){var a=Da(),s=r.SheetNames[e],l=r.Sheets[s]||{},c=(r||{}).Workbook||{},u=(c.Sheets||[])[e]||{},h=Array.isArray(l),d=t.biff==8,g,x="",v=[],_=Mt(l["!ref"]||"A1"),b=d?65536:16384;if(_.e.c>255||_.e.r>=b){if(t.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:IV16384");_.e.c=Math.min(_.e.c,255),_.e.r=Math.min(_.e.c,b-1)}je(a,2057,Pm(r,16,t)),je(a,13,dn(1)),je(a,12,dn(100)),je(a,15,_a(!0)),je(a,17,_a(!1)),je(a,16,Vi(.001)),je(a,95,_a(!0)),je(a,42,_a(!1)),je(a,43,_a(!1)),je(a,130,dn(1)),je(a,128,kC()),je(a,131,_a(!1)),je(a,132,_a(!1)),d&&SF(a,l["!cols"]),je(a,512,yC(_,t)),d&&(l["!links"]=[]);for(var y=_.s.r;y<=_.e.r;++y){x=Tr(y);for(var S=_.s.c;S<=_.e.c;++S){y===_.s.r&&(v[S]=dr(S)),g=v[S]+x;var k=h?(l[y]||[])[S]:l[g];k&&(EF(a,k,y,S,t),d&&k.l&&l["!links"].push([g,k.l]))}}var R=u.CodeName||u.name||s;return d&&je(a,574,oC((c.Views||[])[0])),d&&(l["!merges"]||[]).length&&je(a,229,UC(l["!merges"])),d&&bF(a,l),je(a,442,u2(R)),d&&_F(a,l),je(a,10),a.end()}function kF(e,t,r){var a=Da(),s=(e||{}).Workbook||{},l=s.Sheets||[],c=s.WBProps||{},u=r.biff==8,h=r.biff==5;if(je(a,2057,Pm(e,5,r)),r.bookType=="xla"&&je(a,135),je(a,225,u?dn(1200):null),je(a,193,A3(2)),h&&je(a,191),h&&je(a,192),je(a,226),je(a,92,K3("SheetJS",r)),je(a,66,dn(u?1200:1252)),u&&je(a,353,dn(0)),u&&je(a,448),je(a,317,rN(e.SheetNames.length)),u&&e.vbaraw&&je(a,211),u&&e.vbaraw){var d=c.CodeName||"ThisWorkbook";je(a,442,u2(d))}je(a,156,dn(17)),je(a,25,_a(!1)),je(a,18,_a(!1)),je(a,19,dn(0)),u&&je(a,431,_a(!1)),u&&je(a,444,dn(0)),je(a,61,iC()),je(a,64,_a(!1)),je(a,141,dn(0)),je(a,34,_a(nD(e)=="true")),je(a,14,_a(!0)),u&&je(a,439,_a(!1)),je(a,218,dn(0)),vF(a,e,r),yF(a,e.SSF,r),wF(a,r),u&&je(a,352,_a(!1));var g=a.end(),x=Da();u&&je(x,140,KC()),u&&r.Strings&&hF(x,252,eC(r.Strings)),je(x,10);var v=x.end(),_=Da(),b=0,y=0;for(y=0;y<e.SheetNames.length;++y)b+=(u?12:11)+(u?2:1)*e.SheetNames[y].length;var S=g.length+b+v.length;for(y=0;y<e.SheetNames.length;++y){var k=l[y]||{};je(_,133,Q3({pos:S,hs:k.Hidden||0,dt:0,name:e.SheetNames[y]},r)),S+=t[y].length}var R=_.end();if(b!=R.length)throw new Error("BS8 "+b+" != "+R.length);var T=[];return g.length&&T.push(g),R.length&&T.push(R),v.length&&T.push(v),Xr(T)}function AF(e,t){var r=t||{},a=[];e&&!e.SSF&&(e.SSF=lr(ft)),e&&e.SSF&&(mo(),Yu(e.SSF),r.revssf=Qu(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Zm(r),r.cellXfs=[],ci(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)a[a.length]=TF(s,r,e);return a.unshift(kF(e,a,r)),Xr(a)}function aw(e,t){for(var r=0;r<=e.SheetNames.length;++r){var a=e.Sheets[e.SheetNames[r]];if(!(!a||!a["!ref"])){var s=Fa(a["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var l=t||{};switch(l.biff||2){case 8:case 5:return AF(e,t);case 4:case 3:case 2:return xF(e,t)}throw new Error("invalid type "+l.bookType+" for BIFF")}function Ty(e,t){var r=t||{},a=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var l=e.match(/<\/table/i),c=s.index,u=l&&l.index||e.length,h=fA(e.slice(c,u),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,g=0,x=0,v=0,_={s:{r:1e7,c:1e7},e:{r:0,c:0}},b=[];for(c=0;c<h.length;++c){var y=h[c].trim(),S=y.slice(0,3).toLowerCase();if(S=="<tr"){if(++d,r.sheetRows&&r.sheetRows<=d){--d;break}g=0;continue}if(!(S!="<td"&&S!="<th")){var k=y.split(/<\/t[dh]>/i);for(u=0;u<k.length;++u){var R=k[u].trim();if(R.match(/<t[dh]/i)){for(var T=R,j=0;T.charAt(0)=="<"&&(j=T.indexOf(">"))>-1;)T=T.slice(j+1);for(var X=0;X<b.length;++X){var L=b[X];L.s.c==g&&L.s.r<d&&d<=L.e.r&&(g=L.e.c+1,X=-1)}var A=dt(R.slice(0,R.indexOf(">")));v=A.colspan?+A.colspan:1,((x=+A.rowspan)>1||v>1)&&b.push({s:{r:d,c:g},e:{r:d+(x||1)-1,c:g+v-1}});var K=A.t||A["data-t"]||"";if(!T.length){g+=v;continue}if(T=A_(T),_.s.r>d&&(_.s.r=d),_.e.r<d&&(_.e.r=d),_.s.c>g&&(_.s.c=g),_.e.c<g&&(_.e.c=g),!T.length){g+=v;continue}var q={t:"s",v:T};r.raw||!T.trim().length||K=="s"||(T==="TRUE"?q={t:"b",v:!0}:T==="FALSE"?q={t:"b",v:!1}:isNaN(An(T))?isNaN(oo(T).getDate())||(q={t:"d",v:ir(T)},r.cellDates||(q={t:"n",v:zr(q.v)}),q.z=r.dateNF||ft[14]):q={t:"n",v:An(T)}),r.dense?(a[d]||(a[d]=[]),a[d][g]=q):a[ht({r:d,c:g})]=q,g+=v}}}}return a["!ref"]=vt(_),b.length&&(a["!merges"]=b),a}function CF(e,t,r,a){for(var s=e["!merges"]||[],l=[],c=t.s.c;c<=t.e.c;++c){for(var u=0,h=0,d=0;d<s.length;++d)if(!(s[d].s.r>r||s[d].s.c>c)&&!(s[d].e.r<r||s[d].e.c<c)){if(s[d].s.r<r||s[d].s.c<c){u=-1;break}u=s[d].e.r-s[d].s.r+1,h=s[d].e.c-s[d].s.c+1;break}if(!(u<0)){var g=ht({r,c}),x=a.dense?(e[r]||[])[c]:e[g],v=x&&x.v!=null&&(x.h||Am(x.w||(gs(x),x.w)||""))||"",_={};u>1&&(_.rowspan=u),h>1&&(_.colspan=h),a.editable?v='<span contenteditable="true">'+v+"</span>":x&&(_["data-t"]=x&&x.t||"z",x.v!=null&&(_["data-v"]=x.v),x.z!=null&&(_["data-z"]=x.z),x.l&&(x.l.Target||"#").charAt(0)!="#"&&(v='<a href="'+x.l.Target+'">'+v+"</a>")),_.id=(a.id||"sjs")+"-"+g,l.push(Be("td",v,_))}}var b="<tr>";return b+l.join("")+"</tr>"}var NF='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',OF="</body></html>";function RF(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return oi(Ty(r[0],t),t);var a=r1();return r.forEach(function(s,l){a1(a,Ty(s,t),"Sheet"+(l+1))}),a}function DF(e,t,r){var a=[];return a.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function nw(e,t){var r=t||{},a=r.header!=null?r.header:NF,s=r.footer!=null?r.footer:OF,l=[a],c=Fa(e["!ref"]);r.dense=Array.isArray(e),l.push(DF(e,c,r));for(var u=c.s.r;u<=c.e.r;++u)l.push(CF(e,c,u,r));return l.push("</table>"+s),l.join("")}function sw(e,t,r){var a=r||{},s=0,l=0;if(a.origin!=null)if(typeof a.origin=="number")s=a.origin;else{var c=typeof a.origin=="string"?mr(a.origin):a.origin;s=c.r,l=c.c}var u=t.getElementsByTagName("tr"),h=Math.min(a.sheetRows||1e7,u.length),d={s:{r:0,c:0},e:{r:s,c:l}};if(e["!ref"]){var g=Fa(e["!ref"]);d.s.r=Math.min(d.s.r,g.s.r),d.s.c=Math.min(d.s.c,g.s.c),d.e.r=Math.max(d.e.r,g.e.r),d.e.c=Math.max(d.e.c,g.e.c),s==-1&&(d.e.r=s=g.e.r+1)}var x=[],v=0,_=e["!rows"]||(e["!rows"]=[]),b=0,y=0,S=0,k=0,R=0,T=0;for(e["!cols"]||(e["!cols"]=[]);b<u.length&&y<h;++b){var j=u[b];if(ky(j)){if(a.display)continue;_[y]={hidden:!0}}var X=j.children;for(S=k=0;S<X.length;++S){var L=X[S];if(!(a.display&&ky(L))){var A=L.hasAttribute("data-v")?L.getAttribute("data-v"):L.hasAttribute("v")?L.getAttribute("v"):A_(L.innerHTML),K=L.getAttribute("data-z")||L.getAttribute("z");for(v=0;v<x.length;++v){var q=x[v];q.s.c==k+l&&q.s.r<y+s&&y+s<=q.e.r&&(k=q.e.c+1-l,v=-1)}T=+L.getAttribute("colspan")||1,((R=+L.getAttribute("rowspan")||1)>1||T>1)&&x.push({s:{r:y+s,c:k+l},e:{r:y+s+(R||1)-1,c:k+l+(T||1)-1}});var ie={t:"s",v:A},ne=L.getAttribute("data-t")||L.getAttribute("t")||"";A!=null&&(A.length==0?ie.t=ne||"z":a.raw||A.trim().length==0||ne=="s"||(A==="TRUE"?ie={t:"b",v:!0}:A==="FALSE"?ie={t:"b",v:!1}:isNaN(An(A))?isNaN(oo(A).getDate())||(ie={t:"d",v:ir(A)},a.cellDates||(ie={t:"n",v:zr(ie.v)}),ie.z=a.dateNF||ft[14]):ie={t:"n",v:An(A)})),ie.z===void 0&&K!=null&&(ie.z=K);var Z="",me=L.getElementsByTagName("A");if(me&&me.length)for(var Re=0;Re<me.length&&!(me[Re].hasAttribute("href")&&(Z=me[Re].getAttribute("href"),Z.charAt(0)!="#"));++Re);Z&&Z.charAt(0)!="#"&&(ie.l={Target:Z}),a.dense?(e[y+s]||(e[y+s]=[]),e[y+s][k+l]=ie):e[ht({c:k+l,r:y+s})]=ie,d.e.c<k+l&&(d.e.c=k+l),k+=T}}++y}return x.length&&(e["!merges"]=(e["!merges"]||[]).concat(x)),d.e.r=Math.max(d.e.r,y-1+s),e["!ref"]=vt(d),y>=h&&(e["!fullref"]=vt((d.e.r=u.length-b+y-1+s,d))),e}function iw(e,t){var r=t||{},a=r.dense?[]:{};return sw(a,e,t)}function FF(e,t){return oi(iw(e,t),t)}function ky(e){var t="",r=MF(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function MF(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function LF(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(a,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Ft(t.replace(/<[^>]*>/g,""));return[r]}var Ay={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function lw(e,t){var r=t||{},a=Cm(e),s=[],l,c,u={name:""},h="",d=0,g,x,v={},_=[],b=r.dense?[]:{},y,S,k={value:""},R="",T=0,j=[],X=-1,L=-1,A={s:{r:1e6,c:1e7},e:{r:0,c:0}},K=0,q={},ie=[],ne={},Z=0,me=0,Re=[],Ae=1,V=1,ae=[],xe={Names:[]},J={},be=["",""],I=[],N={},U="",M=0,P=!1,te=!1,pe=0;for(Lc.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");y=Lc.exec(a);)switch(y[3]=y[3].replace(/_.*$/,"")){case"table":case"":y[1]==="/"?(A.e.c>=A.s.c&&A.e.r>=A.s.r?b["!ref"]=vt(A):b["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=A.e.r&&(b["!fullref"]=b["!ref"],A.e.r=r.sheetRows-1,b["!ref"]=vt(A)),ie.length&&(b["!merges"]=ie),Re.length&&(b["!rows"]=Re),g.name=g.||g.name,typeof JSON<"u"&&JSON.stringify(g),_.push(g.name),v[g.name]=b,te=!1):y[0].charAt(y[0].length-2)!=="/"&&(g=dt(y[0],!1),X=L=-1,A.s.r=A.s.c=1e7,A.e.r=A.e.c=0,b=r.dense?[]:{},ie=[],Re=[],te=!0);break;case"table-row-group":y[1]==="/"?--K:++K;break;case"table-row":case"":if(y[1]==="/"){X+=Ae,Ae=1;break}if(x=dt(y[0],!1),x.?X=x.-1:X==-1&&(X=0),Ae=+x["number-rows-repeated"]||1,Ae<10)for(pe=0;pe<Ae;++pe)K>0&&(Re[X+pe]={level:K});L=-1;break;case"covered-table-cell":y[1]!=="/"&&++L,r.sheetStubs&&(r.dense?(b[X]||(b[X]=[]),b[X][L]={t:"z"}):b[ht({r:X,c:L})]={t:"z"}),R="",j=[];break;case"table-cell":case"":if(y[0].charAt(y[0].length-2)==="/")++L,k=dt(y[0],!1),V=parseInt(k["number-columns-repeated"]||"1",10),S={t:"z",v:null},k.formula&&r.cellFormula!=!1&&(S.f=by(Ft(k.formula))),(k.||k["value-type"])=="string"&&(S.t="s",S.v=Ft(k["string-value"]||""),r.dense?(b[X]||(b[X]=[]),b[X][L]=S):b[ht({r:X,c:L})]=S),L+=V-1;else if(y[1]!=="/"){++L,R="",T=0,j=[],V=1;var Ee=Ae?X+Ae-1:X;if(L>A.e.c&&(A.e.c=L),L<A.s.c&&(A.s.c=L),X<A.s.r&&(A.s.r=X),Ee>A.e.r&&(A.e.r=Ee),k=dt(y[0],!1),I=[],N={},S={t:k.||k["value-type"],v:null},r.cellFormula)if(k.formula&&(k.formula=Ft(k.formula)),k["number-matrix-columns-spanned"]&&k["number-matrix-rows-spanned"]&&(Z=parseInt(k["number-matrix-rows-spanned"],10)||0,me=parseInt(k["number-matrix-columns-spanned"],10)||0,ne={s:{r:X,c:L},e:{r:X+Z-1,c:L+me-1}},S.F=vt(ne),ae.push([ne,S.F])),k.formula)S.f=by(k.formula);else for(pe=0;pe<ae.length;++pe)X>=ae[pe][0].s.r&&X<=ae[pe][0].e.r&&L>=ae[pe][0].s.c&&L<=ae[pe][0].e.c&&(S.F=ae[pe][1]);switch((k["number-columns-spanned"]||k["number-rows-spanned"])&&(Z=parseInt(k["number-rows-spanned"],10)||0,me=parseInt(k["number-columns-spanned"],10)||0,ne={s:{r:X,c:L},e:{r:X+Z-1,c:L+me-1}},ie.push(ne)),k["number-columns-repeated"]&&(V=parseInt(k["number-columns-repeated"],10)),S.t){case"boolean":S.t="b",S.v=sr(k["boolean-value"]);break;case"float":S.t="n",S.v=parseFloat(k.value);break;case"percentage":S.t="n",S.v=parseFloat(k.value);break;case"currency":S.t="n",S.v=parseFloat(k.value);break;case"date":S.t="d",S.v=ir(k["date-value"]),r.cellDates||(S.t="n",S.v=zr(S.v)),S.z="m/d/yy";break;case"time":S.t="n",S.v=oA(k["time-value"])/86400,r.cellDates&&(S.t="d",S.v=Zu(S.v)),S.z="HH:MM:SS";break;case"number":S.t="n",S.v=parseFloat(k.);break;default:if(S.t==="string"||S.t==="text"||!S.t)S.t="s",k["string-value"]!=null&&(R=Ft(k["string-value"]),j=[]);else throw new Error("Unsupported value type "+S.t)}}else{if(P=!1,S.t==="s"&&(S.v=R||"",j.length&&(S.R=j),P=T==0),J.Target&&(S.l=J),I.length>0&&(S.c=I,I=[]),R&&r.cellText!==!1&&(S.w=R),P&&(S.t="z",delete S.v),(!P||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=X))for(var ve=0;ve<Ae;++ve){if(V=parseInt(k["number-columns-repeated"]||"1",10),r.dense)for(b[X+ve]||(b[X+ve]=[]),b[X+ve][L]=ve==0?S:lr(S);--V>0;)b[X+ve][L+V]=lr(S);else for(b[ht({r:X+ve,c:L})]=S;--V>0;)b[ht({r:X+ve,c:L+V})]=lr(S);A.e.c<=L&&(A.e.c=L)}V=parseInt(k["number-columns-repeated"]||"1",10),L+=V-1,V=0,S={},R="",j=[]}J={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(y[1]==="/"){if((l=s.pop())[0]!==y[3])throw"Bad state: "+l}else y[0].charAt(y[0].length-2)!=="/"&&s.push([y[3],!0]);break;case"annotation":if(y[1]==="/"){if((l=s.pop())[0]!==y[3])throw"Bad state: "+l;N.t=R,j.length&&(N.R=j),N.a=U,I.push(N)}else y[0].charAt(y[0].length-2)!=="/"&&s.push([y[3],!1]);U="",M=0,R="",T=0,j=[];break;case"creator":y[1]==="/"?U=a.slice(M,y.index):M=y.index+y[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(y[1]==="/"){if((l=s.pop())[0]!==y[3])throw"Bad state: "+l}else y[0].charAt(y[0].length-2)!=="/"&&s.push([y[3],!1]);R="",T=0,j=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(y[1]==="/"){if(q[u.name]=h,(l=s.pop())[0]!==y[3])throw"Bad state: "+l}else y[0].charAt(y[0].length-2)!=="/"&&(h="",u=dt(y[0],!1),s.push([y[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":c=dt(y[0],!1),h+=Ay[y[3]][c.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":c=dt(y[0],!1),h+=Ay[y[3]][c.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(y[0].slice(-2)==="/>")break;if(y[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":h+=a.slice(d,y.index);break}else d=y.index+y[0].length;break;case"named-range":c=dt(y[0],!1),be=Fd(c["cell-range-address"]);var Te={Name:c.name,Ref:be[0]+"!"+be[1]};te&&(Te.Sheet=_.length),xe.Names.push(Te);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(y[1]==="/"&&(!k||!k["string-value"])){var tt=LF(a.slice(T,y.index));R=(R.length>0?R+`
`:"")+tt[0]}else dt(y[0],!1),T=y.index+y[0].length;break;case"s":break;case"database-range":if(y[1]==="/")break;try{be=Fd(dt(y[0])["target-range-address"]),v[be[0]]["!autofilter"]={ref:be[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(y[1]!=="/"){if(J=dt(y[0],!1),!J.href)break;J.Target=Ft(J.href),delete J.href,J.Target.charAt(0)=="#"&&J.Target.indexOf(".")>-1?(be=Fd(J.Target.slice(1)),J.Target="#"+be[0]+"!"+be[1]):J.Target.match(/^\.\.[\\\/]/)&&(J.Target=J.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(y[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(y)}}var G={Sheets:v,SheetNames:_,Workbook:xe};return r.bookSheets&&delete G.Sheets,G}function Cy(e,t){t=t||{},hn(e,"META-INF/manifest.xml")&&o3(Mr(e,"META-INF/manifest.xml"),t);var r=Ka(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var a=lw(Yt(r),t);return hn(e,"meta.xml")&&(a.Props=J_(Mr(e,"meta.xml"))),a}function Ny(e,t){return lw(e,t)}var BF=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Mc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return kr+t}})(),Oy=(function(){var e=function(l){return $t(l).replace(/  +/g,function(c){return'<text:s text:c="'+c.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,a=function(l,c,u){var h=[];h.push('      <table:table table:name="'+$t(c.SheetNames[u])+`" table:style-name="ta1">
`);var d=0,g=0,x=Fa(l["!ref"]||"A1"),v=l["!merges"]||[],_=0,b=Array.isArray(l);if(l["!cols"])for(g=0;g<=x.e.c;++g)h.push("        <table:table-column"+(l["!cols"][g]?' table:style-name="co'+l["!cols"][g].ods+'"':"")+`></table:table-column>
`);var y="",S=l["!rows"]||[];for(d=0;d<x.s.r;++d)y=S[d]?' table:style-name="ro'+S[d].ods+'"':"",h.push("        <table:table-row"+y+`></table:table-row>
`);for(;d<=x.e.r;++d){for(y=S[d]?' table:style-name="ro'+S[d].ods+'"':"",h.push("        <table:table-row"+y+`>
`),g=0;g<x.s.c;++g)h.push(t);for(;g<=x.e.c;++g){var k=!1,R={},T="";for(_=0;_!=v.length;++_)if(!(v[_].s.c>g)&&!(v[_].s.r>d)&&!(v[_].e.c<g)&&!(v[_].e.r<d)){(v[_].s.c!=g||v[_].s.r!=d)&&(k=!0),R["table:number-columns-spanned"]=v[_].e.c-v[_].s.c+1,R["table:number-rows-spanned"]=v[_].e.r-v[_].s.r+1;break}if(k){h.push(r);continue}var j=ht({r:d,c:g}),X=b?(l[d]||[])[g]:l[j];if(X&&X.f&&(R["table:formula"]=$t(r5(X.f)),X.F&&X.F.slice(0,j.length)==j)){var L=Fa(X.F);R["table:number-matrix-columns-spanned"]=L.e.c-L.s.c+1,R["table:number-matrix-rows-spanned"]=L.e.r-L.s.r+1}if(!X){h.push(t);continue}switch(X.t){case"b":T=X.v?"TRUE":"FALSE",R["office:value-type"]="boolean",R["office:boolean-value"]=X.v?"true":"false";break;case"n":T=X.w||String(X.v||0),R["office:value-type"]="float",R["office:value"]=X.v||0;break;case"s":case"str":T=X.v==null?"":X.v,R["office:value-type"]="string";break;case"d":T=X.w||ir(X.v).toISOString(),R["office:value-type"]="date",R["office:date-value"]=ir(X.v).toISOString(),R["table:style-name"]="ce1";break;default:h.push(t);continue}var A=e(T);if(X.l&&X.l.Target){var K=X.l.Target;K=K.charAt(0)=="#"?"#"+a5(K.slice(1)):K,K.charAt(0)!="#"&&!K.match(/^\w+:/)&&(K="../"+K),A=Be("text:a",A,{"xlink:href":K.replace(/&/g,"&amp;")})}h.push("          "+Be("table:table-cell",Be("text:p",A,{}),R)+`
`)}h.push(`        </table:table-row>
`)}return h.push(`      </table:table>
`),h.join("")},s=function(l,c){l.push(` <office:automatic-styles>
`),l.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),l.push(`   <number:month number:style="long"/>
`),l.push(`   <number:text>/</number:text>
`),l.push(`   <number:day number:style="long"/>
`),l.push(`   <number:text>/</number:text>
`),l.push(`   <number:year/>
`),l.push(`  </number:date-style>
`);var u=0;c.SheetNames.map(function(d){return c.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var g=0;g<d["!cols"].length;++g)if(d["!cols"][g]){var x=d["!cols"][g];if(x.width==null&&x.wpx==null&&x.wch==null)continue;ai(x),x.ods=u;var v=d["!cols"][g].wpx+"px";l.push('  <style:style style:name="co'+u+`" style:family="table-column">
`),l.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+v+`"/>
`),l.push(`  </style:style>
`),++u}}});var h=0;c.SheetNames.map(function(d){return c.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var g=0;g<d["!rows"].length;++g)if(d["!rows"][g]){d["!rows"][g].ods=h;var x=d["!rows"][g].hpx+"px";l.push('  <style:style style:name="ro'+h+`" style:family="table-row">
`),l.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+x+`"/>
`),l.push(`  </style:style>
`),++h}}}),l.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),l.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),l.push(`  </style:style>
`),l.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),l.push(` </office:automatic-styles>
`)};return function(c,u){var h=[kr],d=Mc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),g=Mc({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});u.bookType=="fods"?(h.push("<office:document"+d+g+`>
`),h.push(Y_().replace(/office:document-meta/g,"office:meta"))):h.push("<office:document-content"+d+`>
`),s(h,c),h.push(`  <office:body>
`),h.push(`    <office:spreadsheet>
`);for(var x=0;x!=c.SheetNames.length;++x)h.push(a(c.Sheets[c.SheetNames[x]],c,x));return h.push(`    </office:spreadsheet>
`),h.push(`  </office:body>
`),u.bookType=="fods"?h.push("</office:document>"):h.push("</office:document-content>"),h.join("")}})();function ow(e,t){if(t.bookType=="fods")return Oy(e,t);var r=Em(),a="",s=[],l=[];return a="mimetype",_t(r,a,"application/vnd.oasis.opendocument.spreadsheet"),a="content.xml",_t(r,a,Oy(e,t)),s.push([a,"text/xml"]),l.push([a,"ContentFile"]),a="styles.xml",_t(r,a,BF(e,t)),s.push([a,"text/xml"]),l.push([a,"StylesFile"]),a="meta.xml",_t(r,a,kr+Y_()),s.push([a,"text/xml"]),l.push([a,"MetadataFile"]),a="manifest.rdf",_t(r,a,f3(l)),s.push([a,"application/rdf+xml"]),a="META-INF/manifest.xml",_t(r,a,c3(s)),r}function Xi(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function lm(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Yt(li(e))}function IF(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Wa(jn(e))}function jF(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var a=0;a<t.length;++a)if(e[r+a]!=t[a])continue e;return!0}return!1}function si(e){var t=e.reduce(function(s,l){return s+l.length},0),r=new Uint8Array(t),a=0;return e.forEach(function(s){r.set(s,a),a+=s.length}),r}function Ry(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function UF(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,a=e[t+14]&1,s=t+13;s>=t;--s)a=a*256+e[s];return(e[t+15]&128?-a:a)*Math.pow(10,r-6176)}function PF(e,t,r){var a=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,a-6176);e[t+15]|=a>>7,e[t+14]|=(a&127)<<1;for(var l=0;s>=1;++l,s/=256)e[t+l]=s&255;e[t+15]|=r>=0?0:128}function Hc(e,t){var r=t?t[0]:0,a=e[r]&127;e:if(e[r++]>=128&&(a|=(e[r]&127)<<7,e[r++]<128||(a|=(e[r]&127)<<14,e[r++]<128)||(a|=(e[r]&127)<<21,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),a}function zt(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function _r(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function It(e){for(var t=[],r=[0];r[0]<e.length;){var a=r[0],s=Hc(e,r),l=s&7;s=Math.floor(s/8);var c=0,u;if(s==0)break;switch(l){case 0:{for(var h=r[0];e[r[0]++]>=128;);u=e.slice(h,r[0])}break;case 5:c=4,u=e.slice(r[0],r[0]+c),r[0]+=c;break;case 1:c=8,u=e.slice(r[0],r[0]+c),r[0]+=c;break;case 2:c=Hc(e,r),u=e.slice(r[0],r[0]+c),r[0]+=c;break;default:throw new Error("PB Type ".concat(l," for Field ").concat(s," at offset ").concat(a))}var d={data:u,type:l};t[s]==null?t[s]=[d]:t[s].push(d)}return t}function ra(e){var t=[];return e.forEach(function(r,a){r.forEach(function(s){s.data&&(t.push(zt(a*8+s.type)),s.type==2&&t.push(zt(s.data.length)),t.push(s.data))})}),si(t)}function Jm(e,t){return e?.map(function(r){return t(r.data)})||[]}function un(e){for(var t,r=[],a=[0];a[0]<e.length;){var s=Hc(e,a),l=It(e.slice(a[0],a[0]+s));a[0]+=s;var c={id:_r(l[1][0].data),messages:[]};l[2].forEach(function(u){var h=It(u.data),d=_r(h[3][0].data);c.messages.push({meta:h,data:e.slice(a[0],a[0]+d)}),a[0]+=d}),(t=l[3])!=null&&t[0]&&(c.merge=_r(l[3][0].data)>>>0>0),r.push(c)}return r}function Xl(e){var t=[];return e.forEach(function(r){var a=[];a[1]=[{data:zt(r.id),type:0}],a[2]=[],r.merge!=null&&(a[3]=[{data:zt(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(c){s.push(c.data),c.meta[3]=[{type:0,data:zt(c.data.length)}],a[2].push({data:ra(c.meta),type:2})});var l=ra(a);t.push(zt(l.length)),t.push(l),s.forEach(function(c){return t.push(c)})}),si(t)}function zF(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],a=Hc(t,r),s=[];r[0]<t.length;){var l=t[r[0]]&3;if(l==0){var c=t[r[0]++]>>2;if(c<60)++c;else{var u=c-59;c=t[r[0]],u>1&&(c|=t[r[0]+1]<<8),u>2&&(c|=t[r[0]+2]<<16),u>3&&(c|=t[r[0]+3]<<24),c>>>=0,c++,r[0]+=u}s.push(t.slice(r[0],r[0]+c)),r[0]+=c;continue}else{var h=0,d=0;if(l==1?(d=(t[r[0]]>>2&7)+4,h=(t[r[0]++]&224)<<3,h|=t[r[0]++]):(d=(t[r[0]++]>>2)+1,l==2?(h=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(h=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[si(s)],h==0)throw new Error("Invalid offset 0");if(h>s[0].length)throw new Error("Invalid offset beyond length");if(d>=h)for(s.push(s[0].slice(-h)),d-=h;d>=s[s.length-1].length;)s.push(s[s.length-1]),d-=s[s.length-1].length;s.push(s[0].slice(-h,-h+d))}}var g=si(s);if(g.length!=a)throw new Error("Unexpected length: ".concat(g.length," != ").concat(a));return g}function fn(e){for(var t=[],r=0;r<e.length;){var a=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(zF(a,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return si(t)}function Wl(e){for(var t=[],r=0;r<e.length;){var a=Math.min(e.length-r,268435455),s=new Uint8Array(4);t.push(s);var l=zt(a),c=l.length;t.push(l),a<=60?(c++,t.push(new Uint8Array([a-1<<2]))):a<=256?(c+=2,t.push(new Uint8Array([240,a-1&255]))):a<=65536?(c+=3,t.push(new Uint8Array([244,a-1&255,a-1>>8&255]))):a<=16777216?(c+=4,t.push(new Uint8Array([248,a-1&255,a-1>>8&255,a-1>>16&255]))):a<=4294967296&&(c+=5,t.push(new Uint8Array([252,a-1&255,a-1>>8&255,a-1>>16&255,a-1>>>24&255]))),t.push(e.slice(r,r+a)),c+=a,s[0]=0,s[1]=c&255,s[2]=c>>8&255,s[3]=c>>16&255,r+=a}return si(t)}function HF(e,t,r,a){var s=Xi(e),l=s.getUint32(4,!0),c=(a>1?12:8)+Ry(l&(a>1?3470:398))*4,u=-1,h=-1,d=NaN,g=new Date(2001,0,1);l&512&&(u=s.getUint32(c,!0),c+=4),c+=Ry(l&(a>1?12288:4096))*4,l&16&&(h=s.getUint32(c,!0),c+=4),l&32&&(d=s.getFloat64(c,!0),c+=8),l&64&&(g.setTime(g.getTime()+s.getFloat64(c,!0)*1e3),c+=8);var x;switch(e[2]){case 0:break;case 2:x={t:"n",v:d};break;case 3:x={t:"s",v:t[h]};break;case 5:x={t:"d",v:g};break;case 6:x={t:"b",v:d>0};break;case 7:x={t:"n",v:d/86400};break;case 8:x={t:"e",v:0};break;case 9:if(u>-1)x={t:"s",v:r[u]};else if(h>-1)x={t:"s",v:t[h]};else if(!isNaN(d))x={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return x}function $F(e,t,r){var a=Xi(e),s=a.getUint32(8,!0),l=12,c=-1,u=-1,h=NaN,d=NaN,g=new Date(2001,0,1);s&1&&(h=UF(e,l),l+=16),s&2&&(d=a.getFloat64(l,!0),l+=8),s&4&&(g.setTime(g.getTime()+a.getFloat64(l,!0)*1e3),l+=8),s&8&&(u=a.getUint32(l,!0),l+=4),s&16&&(c=a.getUint32(l,!0),l+=4);var x;switch(e[1]){case 0:break;case 2:x={t:"n",v:h};break;case 3:x={t:"s",v:t[u]};break;case 5:x={t:"d",v:g};break;case 6:x={t:"b",v:d>0};break;case 7:x={t:"n",v:d/86400};break;case 8:x={t:"e",v:0};break;case 9:if(c>-1)x={t:"s",v:r[c]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:x={t:"n",v:h};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return x}function Ld(e,t){var r=new Uint8Array(32),a=Xi(r),s=12,l=0;switch(r[0]=5,e.t){case"n":r[1]=2,PF(r,s,e.v),l|=1,s+=16;break;case"b":r[1]=6,a.setFloat64(s,e.v?1:0,!0),l|=2,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,a.setUint32(s,t.indexOf(e.v),!0),l|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(8,l,!0),r.slice(0,s)}function Bd(e,t){var r=new Uint8Array(32),a=Xi(r),s=12,l=0;switch(r[0]=3,e.t){case"n":r[2]=2,a.setFloat64(s,e.v,!0),l|=32,s+=8;break;case"b":r[2]=6,a.setFloat64(s,e.v?1:0,!0),l|=32,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,a.setUint32(s,t.indexOf(e.v),!0),l|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(4,l,!0),r.slice(0,s)}function VF(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return HF(e,t,r,e[0]);case 5:return $F(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function ua(e){var t=It(e);return Hc(t[1][0].data)}function Dy(e,t){var r=It(t.data),a=_r(r[1][0].data),s=r[3],l=[];return(s||[]).forEach(function(c){var u=It(c.data),h=_r(u[1][0].data)>>>0;switch(a){case 1:l[h]=lm(u[3][0].data);break;case 8:{var d=e[ua(u[9][0].data)][0],g=It(d.data),x=e[ua(g[1][0].data)][0],v=_r(x.meta[1][0].data);if(v!=2001)throw new Error("2000 unexpected reference to ".concat(v));var _=It(x.data);l[h]=_[3].map(function(b){return lm(b.data)}).join("")}break}}),l}function GF(e,t){var r,a,s,l,c,u,h,d,g,x,v,_,b,y,S=It(e),k=_r(S[1][0].data)>>>0,R=_r(S[2][0].data)>>>0,T=((a=(r=S[8])==null?void 0:r[0])==null?void 0:a.data)&&_r(S[8][0].data)>0||!1,j,X;if((l=(s=S[7])==null?void 0:s[0])!=null&&l.data&&t!=0)j=(u=(c=S[7])==null?void 0:c[0])==null?void 0:u.data,X=(d=(h=S[6])==null?void 0:h[0])==null?void 0:d.data;else if((x=(g=S[4])==null?void 0:g[0])!=null&&x.data&&t!=1)j=(_=(v=S[4])==null?void 0:v[0])==null?void 0:_.data,X=(y=(b=S[3])==null?void 0:b[0])==null?void 0:y.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var L=T?4:1,A=Xi(j),K=[],q=0;q<j.length/2;++q){var ie=A.getUint16(q*2,!0);ie<65535&&K.push([q,ie])}if(K.length!=R)throw"Expected ".concat(R," cells, found ").concat(K.length);var ne=[];for(q=0;q<K.length-1;++q)ne[K[q][0]]=X.subarray(K[q][1]*L,K[q+1][1]*L);return K.length>=1&&(ne[K[K.length-1][0]]=X.subarray(K[K.length-1][1]*L)),{R:k,cells:ne}}function qF(e,t){var r,a=It(t.data),s=(r=a?.[7])!=null&&r[0]?_r(a[7][0].data)>>>0>0?1:0:-1,l=Jm(a[5],function(c){return GF(c,s)});return{nrows:_r(a[4][0].data)>>>0,data:l.reduce(function(c,u){return c[u.R]||(c[u.R]=[]),u.cells.forEach(function(h,d){if(c[u.R][d])throw new Error("Duplicate cell r=".concat(u.R," c=").concat(d));c[u.R][d]=h}),c},[])}}function XF(e,t,r){var a,s=It(t.data),l={s:{r:0,c:0},e:{r:0,c:0}};if(l.e.r=(_r(s[6][0].data)>>>0)-1,l.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(l.e.c=(_r(s[7][0].data)>>>0)-1,l.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=vt(l);var c=It(s[4][0].data),u=Dy(e,e[ua(c[4][0].data)][0]),h=(a=c[17])!=null&&a[0]?Dy(e,e[ua(c[17][0].data)][0]):[],d=It(c[3][0].data),g=0;d[1].forEach(function(x){var v=It(x.data),_=e[ua(v[2][0].data)][0],b=_r(_.meta[1][0].data);if(b!=6002)throw new Error("6001 unexpected reference to ".concat(b));var y=qF(e,_);y.data.forEach(function(S,k){S.forEach(function(R,T){var j=ht({r:g+k,c:T}),X=VF(R,u,h);X&&(r[j]=X)})}),g+=y.nrows})}function WF(e,t){var r=It(t.data),a={"!ref":"A1"},s=e[ua(r[2][0].data)],l=_r(s[0].meta[1][0].data);if(l!=6001)throw new Error("6000 unexpected reference to ".concat(l));return XF(e,s[0],a),a}function KF(e,t){var r,a=It(t.data),s={name:(r=a[1])!=null&&r[0]?lm(a[1][0].data):"",sheets:[]},l=Jm(a[2],ua);return l.forEach(function(c){e[c].forEach(function(u){var h=_r(u.meta[1][0].data);h==6e3&&s.sheets.push(WF(e,u))})}),s}function YF(e,t){var r=r1(),a=It(t.data),s=Jm(a[1],ua);if(s.forEach(function(l){e[l].forEach(function(c){var u=_r(c.meta[1][0].data);if(u==2){var h=KF(e,c);h.sheets.forEach(function(d,g){a1(r,d,g==0?h.name:h.name+"_"+g,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Id(e){var t,r,a,s,l={},c=[];if(e.FullPaths.forEach(function(h){if(h.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(h){if(h.name.match(/\.iwa$/)){var d;try{d=fn(h.content)}catch(x){return console.log("?? "+h.content.length+" "+(x.message||x))}var g;try{g=un(d)}catch(x){return console.log("## "+(x.message||x))}g.forEach(function(x){l[x.id]=x.messages,c.push(x.id)})}}),!c.length)throw new Error("File has no messages");var u=((s=(a=(r=(t=l?.[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:a[1])==null?void 0:s[0].data)&&_r(l[1][0].meta[1][0].data)==1&&l[1][0];if(u||c.forEach(function(h){l[h].forEach(function(d){var g=_r(d.meta[1][0].data)>>>0;if(g==1)if(!u)u=d;else throw new Error("Document has multiple roots")})}),!u)throw new Error("Cannot find Document root");return YF(l,u)}function JF(e,t,r){var a,s,l,c;if(!((a=e[6])!=null&&a[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var u=((c=(l=e[8])==null?void 0:l[0])==null?void 0:c.data)&&_r(e[8][0].data)>0||!1;if(u)throw"Math only works with normal offsets";for(var h=0,d=Xi(e[7][0].data),g=0,x=[],v=Xi(e[4][0].data),_=0,b=[],y=0;y<t.length;++y){if(t[y]==null){d.setUint16(y*2,65535,!0),v.setUint16(y*2,65535);continue}d.setUint16(y*2,g,!0),v.setUint16(y*2,_,!0);var S,k;switch(typeof t[y]){case"string":S=Ld({t:"s",v:t[y]},r),k=Bd({t:"s",v:t[y]},r);break;case"number":S=Ld({t:"n",v:t[y]},r),k=Bd({t:"n",v:t[y]},r);break;case"boolean":S=Ld({t:"b",v:t[y]},r),k=Bd({t:"b",v:t[y]},r);break;default:throw new Error("Unsupported value "+t[y])}x.push(S),g+=S.length,b.push(k),_+=k.length,++h}for(e[2][0].data=zt(h);y<e[7][0].data.length/2;++y)d.setUint16(y*2,65535,!0),v.setUint16(y*2,65535,!0);return e[6][0].data=si(x),e[3][0].data=si(b),h}function QF(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var a=Fa(r["!ref"]);a.s.r=a.s.c=0;var s=!1;a.e.c>9&&(s=!0,a.e.c=9),a.e.r>49&&(s=!0,a.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(vt(a)));var l=Gu(r,{range:a,header:1}),c=["~Sh33tJ5~"];l.forEach(function(U){return U.forEach(function(M){typeof M=="string"&&c.push(M)})});var u={},h=[],d=it.read(t.numbers,{type:"base64"});d.FileIndex.map(function(U,M){return[U,d.FullPaths[M]]}).forEach(function(U){var M=U[0],P=U[1];if(M.type==2&&M.name.match(/\.iwa/)){var te=M.content,pe=fn(te),Ee=un(pe);Ee.forEach(function(ve){h.push(ve.id),u[ve.id]={deps:[],location:P,type:_r(ve.messages[0].meta[1][0].data)}})}}),h.sort(function(U,M){return U-M});var g=h.filter(function(U){return U>1}).map(function(U){return[U,zt(U)]});d.FileIndex.map(function(U,M){return[U,d.FullPaths[M]]}).forEach(function(U){var M=U[0];if(U[1],!!M.name.match(/\.iwa/)){var P=un(fn(M.content));P.forEach(function(te){te.messages.forEach(function(pe){g.forEach(function(Ee){te.messages.some(function(ve){return _r(ve.meta[1][0].data)!=11006&&jF(ve.data,Ee[1])})&&u[Ee[0]].deps.push(te.id)})})})}});for(var x=it.find(d,u[1].location),v=un(fn(x.content)),_,b=0;b<v.length;++b){var y=v[b];y.id==1&&(_=y)}var S=ua(It(_.messages[0].data)[1][0].data);for(x=it.find(d,u[S].location),v=un(fn(x.content)),b=0;b<v.length;++b)y=v[b],y.id==S&&(_=y);for(S=ua(It(_.messages[0].data)[2][0].data),x=it.find(d,u[S].location),v=un(fn(x.content)),b=0;b<v.length;++b)y=v[b],y.id==S&&(_=y);for(S=ua(It(_.messages[0].data)[2][0].data),x=it.find(d,u[S].location),v=un(fn(x.content)),b=0;b<v.length;++b)y=v[b],y.id==S&&(_=y);var k=It(_.messages[0].data);{k[6][0].data=zt(a.e.r+1),k[7][0].data=zt(a.e.c+1);var R=ua(k[46][0].data),T=it.find(d,u[R].location),j=un(fn(T.content));{for(var X=0;X<j.length&&j[X].id!=R;++X);if(j[X].id!=R)throw"Bad ColumnRowUIDMapArchive";var L=It(j[X].messages[0].data);L[1]=[],L[2]=[],L[3]=[];for(var A=0;A<=a.e.c;++A){var K=[];K[1]=K[2]=[{type:0,data:zt(A+420690)}],L[1].push({type:2,data:ra(K)}),L[2].push({type:0,data:zt(A)}),L[3].push({type:0,data:zt(A)})}L[4]=[],L[5]=[],L[6]=[];for(var q=0;q<=a.e.r;++q)K=[],K[1]=K[2]=[{type:0,data:zt(q+726270)}],L[4].push({type:2,data:ra(K)}),L[5].push({type:0,data:zt(q)}),L[6].push({type:0,data:zt(q)});j[X].messages[0].data=ra(L)}T.content=Wl(Xl(j)),T.size=T.content.length,delete k[46];var ie=It(k[4][0].data);{ie[7][0].data=zt(a.e.r+1);var ne=It(ie[1][0].data),Z=ua(ne[2][0].data);T=it.find(d,u[Z].location),j=un(fn(T.content));{if(j[0].id!=Z)throw"Bad HeaderStorageBucket";var me=It(j[0].messages[0].data);for(q=0;q<l.length;++q){var Re=It(me[2][0].data);Re[1][0].data=zt(q),Re[4][0].data=zt(l[q].length),me[2][q]={type:me[2][0].type,data:ra(Re)}}j[0].messages[0].data=ra(me)}T.content=Wl(Xl(j)),T.size=T.content.length;var Ae=ua(ie[2][0].data);T=it.find(d,u[Ae].location),j=un(fn(T.content));{if(j[0].id!=Ae)throw"Bad HeaderStorageBucket";for(me=It(j[0].messages[0].data),A=0;A<=a.e.c;++A)Re=It(me[2][0].data),Re[1][0].data=zt(A),Re[4][0].data=zt(a.e.r+1),me[2][A]={type:me[2][0].type,data:ra(Re)};j[0].messages[0].data=ra(me)}T.content=Wl(Xl(j)),T.size=T.content.length;var V=ua(ie[4][0].data);(function(){for(var U=it.find(d,u[V].location),M=un(fn(U.content)),P,te=0;te<M.length;++te){var pe=M[te];pe.id==V&&(P=pe)}var Ee=It(P.messages[0].data);{Ee[3]=[];var ve=[];c.forEach(function(G,Rt){ve[1]=[{type:0,data:zt(Rt)}],ve[2]=[{type:0,data:zt(1)}],ve[3]=[{type:2,data:IF(G)}],Ee[3].push({type:2,data:ra(ve)})})}P.messages[0].data=ra(Ee);var Te=Xl(M),tt=Wl(Te);U.content=tt,U.size=U.content.length})();var ae=It(ie[3][0].data);{var xe=ae[1][0];delete ae[2];var J=It(xe.data);{var be=ua(J[2][0].data);(function(){for(var U=it.find(d,u[be].location),M=un(fn(U.content)),P,te=0;te<M.length;++te){var pe=M[te];pe.id==be&&(P=pe)}var Ee=It(P.messages[0].data);{delete Ee[6],delete ae[7];var ve=new Uint8Array(Ee[5][0].data);Ee[5]=[];for(var Te=0,tt=0;tt<=a.e.r;++tt){var G=It(ve);Te+=JF(G,l[tt],c),G[1][0].data=zt(tt),Ee[5].push({data:ra(G),type:2})}Ee[1]=[{type:0,data:zt(a.e.c+1)}],Ee[2]=[{type:0,data:zt(a.e.r+1)}],Ee[3]=[{type:0,data:zt(Te)}],Ee[4]=[{type:0,data:zt(a.e.r+1)}]}P.messages[0].data=ra(Ee);var Rt=Xl(M),We=Wl(Rt);U.content=We,U.size=U.content.length})()}xe.data=ra(J)}ie[3][0].data=ra(ae)}k[4][0].data=ra(ie)}_.messages[0].data=ra(k);var I=Xl(v),N=Wl(I);return x.content=N,x.size=x.content.length,d}function cw(e){return function(r){for(var a=0;a!=e.length;++a){var s=e[a];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function Qm(e){cw([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Zm(e){cw([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function ZF(e){return St.WS.indexOf(e)>-1?"sheet":e==St.CS?"chart":e==St.DS?"dialog":e==St.MS?"macro":e&&e.length?e:"sheet"}function eM(e,t){if(!e)return 0;try{e=t.map(function(a){return a.id||(a.id=a.strRelID),[a.name,e["!id"][a.id].Target,ZF(e["!id"][a.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function tM(e,t,r,a,s,l,c,u,h,d,g,x){try{l[a]=yc(Ka(e,r,!0),t);var v=Mr(e,t),_;switch(u){case"sheet":_=SD(v,t,s,h,l[a],d,g,x);break;case"chart":if(_=ED(v,t,s,h,l[a],d,g,x),!_||!_["!drawel"])break;var b=dc(_["!drawel"].Target,t),y=Bc(b),S=u8(Ka(e,b,!0),yc(Ka(e,y,!0),b)),k=dc(S,b),R=Bc(k);_=JR(Ka(e,k,!0),k,h,yc(Ka(e,R,!0),k),d,_);break;case"macro":_=TD(v,t,s,h,l[a],d,g,x);break;case"dialog":_=kD(v,t,s,h,l[a],d,g,x);break;default:throw new Error("Unrecognized sheet type "+u)}c[a]=_;var T=[];l&&l[a]&&wr(l[a]).forEach(function(j){var X="";if(l[a][j].Type==St.CMNT){X=dc(l[a][j].Target,t);var L=OD(Mr(e,X,!0),X,h);if(!L||!L.length)return;xy(_,L,!1)}l[a][j].Type==St.TCMNT&&(X=dc(l[a][j].Target,t),T=T.concat(h8(Mr(e,X,!0),h)))}),T&&T.length&&xy(_,T,!0,h.people||[])}catch(j){if(h.WTF)throw j}}function on(e){return e.charAt(0)=="/"?e.slice(1):e}function rM(e,t){if(mo(),t=t||{},Qm(t),hn(e,"META-INF/manifest.xml")||hn(e,"objectdata.xml"))return Cy(e,t);if(hn(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Id<"u"){if(e.FileIndex)return Id(e);var r=it.utils.cfb_new();return jv(e).forEach(function(Re){_t(r,Re,dA(e,Re))}),Id(r)}throw new Error("Unsupported NUMBERS file")}if(!hn(e,"[Content_Types].xml"))throw hn(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):hn(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var a=jv(e),s=i3(Ka(e,"[Content_Types].xml")),l=!1,c,u;if(s.workbooks.length===0&&(u="xl/workbook.xml",Mr(e,u,!0)&&s.workbooks.push(u)),s.workbooks.length===0){if(u="xl/workbook.bin",!Mr(e,u,!0))throw new Error("Could not find workbook");s.workbooks.push(u),l=!0}s.workbooks[0].slice(-3)=="bin"&&(l=!0);var h={},d={};if(!t.bookSheets&&!t.bookProps){if(_c=[],s.sst)try{_c=ND(Mr(e,on(s.sst)),s.sst,t)}catch(Re){if(t.WTF)throw Re}t.cellStyles&&s.themes.length&&(h=CD(Ka(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(d=AD(Mr(e,on(s.style)),s.style,h,t))}s.links.map(function(Re){try{var Ae=yc(Ka(e,Bc(on(Re))),Re);return DD(Mr(e,on(Re)),Ae,Re,t)}catch{}});var g=bD(Mr(e,on(s.workbooks[0])),s.workbooks[0],t),x={},v="";s.coreprops.length&&(v=Mr(e,on(s.coreprops[0]),!0),v&&(x=J_(v)),s.extprops.length!==0&&(v=Mr(e,on(s.extprops[0]),!0),v&&d3(v,x,t)));var _={};(!t.bookSheets||t.bookProps)&&s.custprops.length!==0&&(v=Ka(e,on(s.custprops[0]),!0),v&&(_=g3(v,t)));var b={};if((t.bookSheets||t.bookProps)&&(g.Sheets?c=g.Sheets.map(function(Ae){return Ae.name}):x.Worksheets&&x.SheetNames.length>0&&(c=x.SheetNames),t.bookProps&&(b.Props=x,b.Custprops=_),t.bookSheets&&typeof c<"u"&&(b.SheetNames=c),t.bookSheets?b.SheetNames:t.bookProps))return b;c={};var y={};t.bookDeps&&s.calcchain&&(y=RD(Mr(e,on(s.calcchain)),s.calcchain));var S=0,k={},R,T;{var j=g.Sheets;x.Worksheets=j.length,x.SheetNames=[];for(var X=0;X!=j.length;++X)x.SheetNames[X]=j[X].name}var L=l?"bin":"xml",A=s.workbooks[0].lastIndexOf("/"),K=(s.workbooks[0].slice(0,A+1)+"_rels/"+s.workbooks[0].slice(A+1)+".rels").replace(/^\//,"");hn(e,K)||(K="xl/_rels/workbook."+L+".rels");var q=yc(Ka(e,K,!0),K.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=FD(Mr(e,on(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=m8(Mr(e,on(s.people[0])),t)),q&&(q=eM(q,g.Sheets));var ie=Mr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(S=0;S!=x.Worksheets;++S){var ne="sheet";if(q&&q[S]?(R="xl/"+q[S][1].replace(/[\/]?xl\//,""),hn(e,R)||(R=q[S][1]),hn(e,R)||(R=K.replace(/_rels\/.*$/,"")+q[S][1]),ne=q[S][2]):(R="xl/worksheets/sheet"+(S+1-ie)+"."+L,R=R.replace(/sheet0\./,"sheet.")),T=R.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(S!=t.sheets)continue e;break;case"string":if(x.SheetNames[S].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var Z=!1,me=0;me!=t.sheets.length;++me)typeof t.sheets[me]=="number"&&t.sheets[me]==S&&(Z=1),typeof t.sheets[me]=="string"&&t.sheets[me].toLowerCase()==x.SheetNames[S].toLowerCase()&&(Z=1);if(!Z)continue e}}tM(e,R,T,x.SheetNames[S],S,k,c,ne,t,g,h,d)}return b={Directory:s,Workbook:g,Props:x,Custprops:_,Deps:y,Sheets:c,SheetNames:x.SheetNames,Strings:_c,Styles:d,Themes:h,SSF:lr(ft)},t&&t.bookFiles&&(e.files?(b.keys=a,b.files=e.files):(b.keys=[],b.files={},e.FullPaths.forEach(function(Re,Ae){Re=Re.replace(/^Root Entry[\/]/,""),b.keys.push(Re),b.files[Re]=e.FileIndex[Ae]}))),t&&t.bookVBA&&(s.vba.length>0?b.vbaraw=Mr(e,on(s.vba[0]),!0):s.defaults&&s.defaults.bin===b8&&(b.vbaraw=Mr(e,"xl/vbaProject.bin",!0))),b}function aM(e,t){var r=t||{},a="Workbook",s=it.find(e,a);try{if(a="/!DataSpaces/Version",s=it.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(FN(s.content),a="/!DataSpaces/DataSpaceMap",s=it.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);var l=LN(s.content);if(l.length!==1||l[0].comps.length!==1||l[0].comps[0].t!==0||l[0].name!=="StrongEncryptionDataSpace"||l[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=it.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);var c=BN(s.content);if(c.length!=1||c[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=it.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);jN(s.content)}catch{}if(a="/EncryptionInfo",s=it.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);var u=UN(s.content);if(a="/EncryptedPackage",s=it.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(u[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(u[1],s.content,r.password||"",r);if(u[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(u[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function nM(e,t){return t.bookType=="ods"?ow(e,t):t.bookType=="numbers"?QF(e,t):t.bookType=="xlsb"?sM(e,t):iM(e,t)}function sM(e,t){eo=1024,e&&!e.SSF&&(e.SSF=lr(ft)),e&&e.SSF&&(mo(),Yu(e.SSF),t.revssf=Qu(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,wc?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",a=B2.indexOf(t.bookType)>-1,s=jm();Zm(t=t||{});var l=Em(),c="",u=0;if(t.cellXfs=[],ci(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),c="docProps/core.xml",_t(l,c,Q_(e.Props,t)),s.coreprops.push(c),Ht(t.rels,2,c,St.CORE_PROPS),c="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var h=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&h.push(e.SheetNames[d]);e.Props.SheetNames=h}for(e.Props.Worksheets=e.Props.SheetNames.length,_t(l,c,t2(e.Props)),s.extprops.push(c),Ht(t.rels,3,c,St.EXT_PROPS),e.Custprops!==e.Props&&wr(e.Custprops||{}).length>0&&(c="docProps/custom.xml",_t(l,c,r2(e.Custprops)),s.custprops.push(c),Ht(t.rels,4,c,St.CUST_PROPS)),u=1;u<=e.SheetNames.length;++u){var g={"!id":{}},x=e.Sheets[e.SheetNames[u-1]],v=(x||{})["!type"]||"sheet";if(c="xl/worksheets/sheet"+u+"."+r,_t(l,c,LD(u-1,c,t,e,g)),s.sheets.push(c),Ht(t.wbrels,-1,"worksheets/sheet"+u+"."+r,St.WS[0]),x){var _=x["!comments"],b=!1,y="";_&&_.length>0&&(y="xl/comments"+u+"."+r,_t(l,y,jD(_,y)),s.comments.push(y),Ht(g,-1,"../comments"+u+"."+r,St.CMNT),b=!0),x["!legacy"]&&b&&_t(l,"xl/drawings/vmlDrawing"+u+".vml",M2(u,x["!comments"])),delete x["!comments"],delete x["!legacy"]}g["!id"].rId1&&_t(l,Bc(c),ao(g))}return t.Strings!=null&&t.Strings.length>0&&(c="xl/sharedStrings."+r,_t(l,c,ID(t.Strings,c,t)),s.strs.push(c),Ht(t.wbrels,-1,"sharedStrings."+r,St.SST)),c="xl/workbook."+r,_t(l,c,MD(e,c)),s.workbooks.push(c),Ht(t.rels,1,c,St.WB),c="xl/theme/theme1.xml",_t(l,c,Vm(e.Themes,t)),s.themes.push(c),Ht(t.wbrels,-1,"theme/theme1.xml",St.THEME),c="xl/styles."+r,_t(l,c,BD(e,c,t)),s.styles.push(c),Ht(t.wbrels,-1,"styles."+r,St.STY),e.vbaraw&&a&&(c="xl/vbaProject.bin",_t(l,c,e.vbaraw),s.vba.push(c),Ht(t.wbrels,-1,"vbaProject.bin",St.VBA)),c="xl/metadata."+r,_t(l,c,UD(c)),s.metadata.push(c),Ht(t.wbrels,-1,"metadata."+r,St.XLMETA),_t(l,"[Content_Types].xml",K_(s,t)),_t(l,"_rels/.rels",ao(t.rels)),_t(l,"xl/_rels/workbook."+r+".rels",ao(t.wbrels)),delete t.revssf,delete t.ssf,l}function iM(e,t){eo=1024,e&&!e.SSF&&(e.SSF=lr(ft)),e&&e.SSF&&(mo(),Yu(e.SSF),t.revssf=Qu(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,wc?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",a=B2.indexOf(t.bookType)>-1,s=jm();Zm(t=t||{});var l=Em(),c="",u=0;if(t.cellXfs=[],ci(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),c="docProps/core.xml",_t(l,c,Q_(e.Props,t)),s.coreprops.push(c),Ht(t.rels,2,c,St.CORE_PROPS),c="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var h=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&h.push(e.SheetNames[d]);e.Props.SheetNames=h}e.Props.Worksheets=e.Props.SheetNames.length,_t(l,c,t2(e.Props)),s.extprops.push(c),Ht(t.rels,3,c,St.EXT_PROPS),e.Custprops!==e.Props&&wr(e.Custprops||{}).length>0&&(c="docProps/custom.xml",_t(l,c,r2(e.Custprops)),s.custprops.push(c),Ht(t.rels,4,c,St.CUST_PROPS));var g=["SheetJ5"];for(t.tcid=0,u=1;u<=e.SheetNames.length;++u){var x={"!id":{}},v=e.Sheets[e.SheetNames[u-1]],_=(v||{})["!type"]||"sheet";if(c="xl/worksheets/sheet"+u+"."+r,_t(l,c,X2(u-1,t,e,x)),s.sheets.push(c),Ht(t.wbrels,-1,"worksheets/sheet"+u+"."+r,St.WS[0]),v){var b=v["!comments"],y=!1,S="";if(b&&b.length>0){var k=!1;b.forEach(function(R){R[1].forEach(function(T){T.T==!0&&(k=!0)})}),k&&(S="xl/threadedComments/threadedComment"+u+"."+r,_t(l,S,d8(b,g,t)),s.threadedcomments.push(S),Ht(x,-1,"../threadedComments/threadedComment"+u+"."+r,St.TCMNT)),S="xl/comments"+u+"."+r,_t(l,S,L2(b)),s.comments.push(S),Ht(x,-1,"../comments"+u+"."+r,St.CMNT),y=!0}v["!legacy"]&&y&&_t(l,"xl/drawings/vmlDrawing"+u+".vml",M2(u,v["!comments"])),delete v["!comments"],delete v["!legacy"]}x["!id"].rId1&&_t(l,Bc(c),ao(x))}return t.Strings!=null&&t.Strings.length>0&&(c="xl/sharedStrings."+r,_t(l,c,b2(t.Strings,t)),s.strs.push(c),Ht(t.wbrels,-1,"sharedStrings."+r,St.SST)),c="xl/workbook."+r,_t(l,c,Q2(e)),s.workbooks.push(c),Ht(t.rels,1,c,St.WB),c="xl/theme/theme1.xml",_t(l,c,Vm(e.Themes,t)),s.themes.push(c),Ht(t.wbrels,-1,"theme/theme1.xml",St.THEME),c="xl/styles."+r,_t(l,c,O2(e,t)),s.styles.push(c),Ht(t.wbrels,-1,"styles."+r,St.STY),e.vbaraw&&a&&(c="xl/vbaProject.bin",_t(l,c,e.vbaraw),s.vba.push(c),Ht(t.wbrels,-1,"vbaProject.bin",St.VBA)),c="xl/metadata."+r,_t(l,c,F2()),s.metadata.push(c),Ht(t.wbrels,-1,"metadata."+r,St.XLMETA),g.length>1&&(c="xl/persons/person.xml",_t(l,c,g8(g)),s.people.push(c),Ht(t.wbrels,-1,"persons/person.xml",St.PEOPLE)),_t(l,"[Content_Types].xml",K_(s,t)),_t(l,"_rels/.rels",ao(t.rels)),_t(l,"xl/_rels/workbook."+r+".rels",ao(t.wbrels)),delete t.revssf,delete t.ssf,l}function e1(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Ya(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function lM(e,t){return it.find(e,"EncryptedPackage")?aM(e,t):rw(e,t)}function oM(e,t){var r,a=e,s=t||{};return s.type||(s.type=wt&&Buffer.isBuffer(e)?"buffer":"base64"),r=E_(a,s),rM(r,s)}function uw(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return sm(e.slice(r),t);default:break e}return co.to_workbook(e,t)}function cM(e,t){var r="",a=e1(e,t);switch(t.type){case"base64":r=Ya(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=$i(e);break;default:throw new Error("Unrecognized type "+t.type)}return a[0]==239&&a[1]==187&&a[2]==191&&(r=Yt(r)),t.type="binary",uw(r,t)}function uM(e,t){var r=e;return t.type=="base64"&&(r=Ya(r)),r=Oc.utils.decode(1200,r.slice(2),"str"),t.type="binary",uw(r,t)}function fM(e){return e.match(/[^\x00-\x7F]/)?jn(e):e}function jd(e,t,r,a){return a?(r.type="string",co.to_workbook(e,r)):co.to_workbook(t,r)}function Vu(e,t){ym();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Vu(new Uint8Array(e),(r=lr(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var a=e,s=[0,0,0,0],l=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),so={},r.dateNF&&(so.dateNF=r.dateNF),r.type||(r.type=wt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=wt?"buffer":"binary",a=sA(e),typeof Uint8Array<"u"&&!wt&&(r.type="array")),r.type=="string"&&(l=!0,r.type="binary",r.codepage=65001,a=fM(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var c=new ArrayBuffer(3),u=new Uint8Array(c);if(u.foo="bar",!u.foo)return r=lr(r),r.type="array",Vu(_m(a),r)}switch((s=e1(a,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return lM(it.read(a,r),r);break;case 9:if(s[1]<=8)return rw(a,r);break;case 60:return sm(a,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return pN(a,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return _2.to_workbook(a,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?oM(a,r):jd(e,a,r,l);case 239:return s[3]===60?sm(a,r):jd(e,a,r,l);case 255:if(s[1]===254)return uM(a,r);if(s[1]===0&&s[2]===2&&s[3]===0)return Pi.to_workbook(a,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return Pi.to_workbook(a,r);break;case 3:case 131:case 139:case 140:return nm.to_workbook(a,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return A2.to_workbook(a,r);break;case 10:case 13:case 32:return cM(a,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return gN.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?nm.to_workbook(a,r):jd(e,a,r,l)}function fw(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Xc(t.file,it.write(e,{type:wt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return it.write(e,t)}function hM(e,t){var r=lr(t||{}),a=nM(e,r);return dM(a,r)}function dM(e,t){var r={},a=wt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=a;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=a;break;default:throw new Error("Unrecognized type "+t.type)}var s=e.FullPaths?it.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(t.type=="binary"||t.type=="base64")return s;s=new Uint8Array(Ku(s))}return t.password&&typeof encrypt_agile<"u"?fw(encrypt_agile(s,t.password),t):t.type==="file"?Xc(t.file,s):t.type=="string"?Yt(s):s}function mM(e,t){var r=t||{},a=fF(e,r);return fw(a,r)}function In(e,t,r){r||(r="");var a=r+e;switch(t.type){case"base64":return Rc(jn(a));case"binary":return jn(a);case"string":return e;case"file":return Xc(t.file,a,"utf8");case"buffer":return wt?xs(a,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(a):In(a,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function gM(e,t){switch(t.type){case"base64":return Rc(e);case"binary":return e;case"string":return e;case"file":return Xc(t.file,e,"binary");case"buffer":return wt?xs(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function ku(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",a=0;a<e.length;++a)r+=String.fromCharCode(e[a]);return t.type=="base64"?Rc(r):t.type=="string"?Yt(r):r;case"file":return Xc(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function hw(e,t){ym(),lD(e);var r=lr(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var a=hw(e,r);return r.type="array",Ku(a)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=e.SheetNames.indexOf(r.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return In(nF(e,r),r);case"slk":case"sylk":return In(y2.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"htm":case"html":return In(nw(e.Sheets[e.SheetNames[s]],r),r);case"txt":return gM(dw(e.Sheets[e.SheetNames[s]],r),r);case"csv":return In(t1(e.Sheets[e.SheetNames[s]],r),r,"\uFEFF");case"dif":return In(_2.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"dbf":return ku(nm.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"prn":return In(co.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"rtf":return In(A2.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"eth":return In(w2.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"fods":return In(ow(e,r),r);case"wk1":return ku(Pi.sheet_to_wk1(e.Sheets[e.SheetNames[s]],r),r);case"wk3":return ku(Pi.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),ku(aw(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),mM(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return hM(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function pM(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function Fy(e,t,r){var a={};return a.type="file",a.file=t,pM(a),hw(e,a)}function xM(e,t,r,a,s,l,c,u){var h=Tr(r),d=u.defval,g=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),x=!0,v=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(v,"__rowNum__",{value:r,enumerable:!1})}catch{v.__rowNum__=r}else v.__rowNum__=r;if(!c||e[r])for(var _=t.s.c;_<=t.e.c;++_){var b=c?e[r][_]:e[a[_]+h];if(b===void 0||b.t===void 0){if(d===void 0)continue;l[_]!=null&&(v[l[_]]=d);continue}var y=b.v;switch(b.t){case"z":if(y==null)break;continue;case"e":y=y==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+b.t)}if(l[_]!=null){if(y==null)if(b.t=="e"&&y===null)v[l[_]]=null;else if(d!==void 0)v[l[_]]=d;else if(g&&y===null)v[l[_]]=null;else continue;else v[l[_]]=g&&(b.t!=="n"||b.t==="n"&&u.rawNumbers!==!1)?y:gs(b,y,u);y!=null&&(x=!1)}}return{row:v,isempty:x}}function Gu(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},a=0,s=1,l=[],c=0,u="",h={s:{r:0,c:0},e:{r:0,c:0}},d=t||{},g=d.range!=null?d.range:e["!ref"];switch(d.header===1?a=1:d.header==="A"?a=2:Array.isArray(d.header)?a=3:d.header==null&&(a=0),typeof g){case"string":h=Mt(g);break;case"number":h=Mt(e["!ref"]),h.s.r=g;break;default:h=g}a>0&&(s=0);var x=Tr(h.s.r),v=[],_=[],b=0,y=0,S=Array.isArray(e),k=h.s.r,R=0,T={};S&&!e[k]&&(e[k]=[]);var j=d.skipHidden&&e["!cols"]||[],X=d.skipHidden&&e["!rows"]||[];for(R=h.s.c;R<=h.e.c;++R)if(!(j[R]||{}).hidden)switch(v[R]=dr(R),r=S?e[k][R]:e[v[R]+x],a){case 1:l[R]=R-h.s.c;break;case 2:l[R]=v[R];break;case 3:l[R]=d.header[R-h.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),u=c=gs(r,null,d),y=T[c]||0,!y)T[c]=1;else{do u=c+"_"+y++;while(T[u]);T[c]=y,T[u]=1}l[R]=u}for(k=h.s.r+s;k<=h.e.r;++k)if(!(X[k]||{}).hidden){var L=xM(e,h,k,v,a,l,S,d);(L.isempty===!1||(a===1?d.blankrows!==!1:d.blankrows))&&(_[b++]=L.row)}return _.length=b,_}var My=/"/g;function vM(e,t,r,a,s,l,c,u){for(var h=!0,d=[],g="",x=Tr(r),v=t.s.c;v<=t.e.c;++v)if(a[v]){var _=u.dense?(e[r]||[])[v]:e[a[v]+x];if(_==null)g="";else if(_.v!=null){h=!1,g=""+(u.rawNumbers&&_.t=="n"?_.v:gs(_,null,u));for(var b=0,y=0;b!==g.length;++b)if((y=g.charCodeAt(b))===s||y===l||y===34||u.forceQuotes){g='"'+g.replace(My,'""')+'"';break}g=="ID"&&(g='"ID"')}else _.f!=null&&!_.F?(h=!1,g="="+_.f,g.indexOf(",")>=0&&(g='"'+g.replace(My,'""')+'"')):g="";d.push(g)}return u.blankrows===!1&&h?null:d.join(c)}function t1(e,t){var r=[],a=t??{};if(e==null||e["!ref"]==null)return"";var s=Mt(e["!ref"]),l=a.FS!==void 0?a.FS:",",c=l.charCodeAt(0),u=a.RS!==void 0?a.RS:`
`,h=u.charCodeAt(0),d=new RegExp((l=="|"?"\\|":l)+"+$"),g="",x=[];a.dense=Array.isArray(e);for(var v=a.skipHidden&&e["!cols"]||[],_=a.skipHidden&&e["!rows"]||[],b=s.s.c;b<=s.e.c;++b)(v[b]||{}).hidden||(x[b]=dr(b));for(var y=0,S=s.s.r;S<=s.e.r;++S)(_[S]||{}).hidden||(g=vM(e,s,S,x,c,h,l,a),g!=null&&(a.strip&&(g=g.replace(d,"")),(g||a.blankrows!==!1)&&r.push((y++?u:"")+g)));return delete a.dense,r.join("")}function dw(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=t1(e,t);return r}function yM(e){var t="",r,a="";if(e==null||e["!ref"]==null)return[];var s=Mt(e["!ref"]),l="",c=[],u,h=[],d=Array.isArray(e);for(u=s.s.c;u<=s.e.c;++u)c[u]=dr(u);for(var g=s.s.r;g<=s.e.r;++g)for(l=Tr(g),u=s.s.c;u<=s.e.c;++u)if(t=c[u]+l,r=d?(e[g]||[])[u]:e[t],a="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;a=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)a=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)a=""+r.v;else if(r.t=="b")a=r.v?"TRUE":"FALSE";else if(r.w!==void 0)a="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?a="'"+r.v:a=""+r.v}}h[h.length]=t+"="+a}return h}function mw(e,t,r){var a=r||{},s=+!a.skipHeader,l=e||{},c=0,u=0;if(l&&a.origin!=null)if(typeof a.origin=="number")c=a.origin;else{var h=typeof a.origin=="string"?mr(a.origin):a.origin;c=h.r,u=h.c}var d,g={s:{c:0,r:0},e:{c:u,r:c+t.length-1+s}};if(l["!ref"]){var x=Mt(l["!ref"]);g.e.c=Math.max(g.e.c,x.e.c),g.e.r=Math.max(g.e.r,x.e.r),c==-1&&(c=x.e.r+1,g.e.r=c+t.length-1+s)}else c==-1&&(c=0,g.e.r=t.length-1+s);var v=a.header||[],_=0;t.forEach(function(y,S){wr(y).forEach(function(k){(_=v.indexOf(k))==-1&&(v[_=v.length]=k);var R=y[k],T="z",j="",X=ht({c:u+_,r:c+S+s});d=$c(l,X),R&&typeof R=="object"&&!(R instanceof Date)?l[X]=R:(typeof R=="number"?T="n":typeof R=="boolean"?T="b":typeof R=="string"?T="s":R instanceof Date?(T="d",a.cellDates||(T="n",R=zr(R)),j=a.dateNF||ft[14]):R===null&&a.nullError&&(T="e",R=0),d?(d.t=T,d.v=R,delete d.w,delete d.R,j&&(d.z=j)):l[X]=d={t:T,v:R},j&&(d.z=j))})}),g.e.c=Math.max(g.e.c,u+v.length-1);var b=Tr(c);if(s)for(_=0;_<v.length;++_)l[dr(_+u)+b]={t:"s",v:v[_]};return l["!ref"]=vt(g),l}function _M(e,t){return mw(null,e,t)}function $c(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var a=mr(t);return e[a.r]||(e[a.r]=[]),e[a.r][a.c]||(e[a.r][a.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?$c(e,ht(t)):$c(e,ht({r:t,c:r||0}))}function wM(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function r1(){return{SheetNames:[],Sheets:{}}}function a1(e,t,r,a){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&e.SheetNames.indexOf(r)>=0){var l=r.match(/(^.*?)(\d+)$/);s=l&&+l[2]||0;var c=l&&l[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=c+s)!=-1;++s);}if(J2(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function bM(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var a=wM(e,t);switch(e.Workbook.Sheets[a]||(e.Workbook.Sheets[a]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[a].Hidden=r}function SM(e,t){return e.z=t,e}function gw(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function EM(e,t,r){return gw(e,"#"+t,r)}function TM(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function kM(e,t,r,a){for(var s=typeof t!="string"?t:Mt(t),l=typeof t=="string"?t:vt(t),c=s.s.r;c<=s.e.r;++c)for(var u=s.s.c;u<=s.e.c;++u){var h=$c(e,c,u);h.t="n",h.F=l,delete h.v,c==s.s.r&&u==s.s.c&&(h.f=r,a&&(h.D=!0))}return e}var Ks={encode_col:dr,encode_row:Tr,encode_cell:ht,encode_range:vt,decode_col:Dm,decode_row:Rm,split_cell:IA,decode_cell:mr,decode_range:Fa,format_cell:gs,sheet_add_aoa:H_,sheet_add_json:mw,sheet_add_dom:sw,aoa_to_sheet:go,json_to_sheet:_M,table_to_sheet:iw,table_to_book:FF,sheet_to_csv:t1,sheet_to_txt:dw,sheet_to_json:Gu,sheet_to_html:nw,sheet_to_formulae:yM,sheet_to_row_object_array:Gu,sheet_get_cell:$c,book_new:r1,book_append_sheet:a1,book_set_sheet_visibility:bM,cell_set_number_format:SM,cell_set_hyperlink:gw,cell_set_internal_link:EM,cell_add_comment:TM,sheet_set_array_formula:kM,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function Ly(e){const t=String(e??"").trim();if(!t)return 0;const r=t.replace(/\s/g,""),a=r.includes(","),s=r.includes(".");let l=r;a&&s?l=r.replace(/,/g,""):a&&!s&&(l=r.replace(/,/g,"."));const c=Number.parseFloat(l);return Number.isFinite(c)?c:0}function AM(e,t){if(!e||!t)return null;const r=t.getTime()-e.getTime();return Math.ceil(r/(1440*60*1e3))}function CM(e,t){const r=new Date(`${t}T00:00:00`);return(e??[]).map(s=>{const l=s?.scheduled_receipt_date?String(s.scheduled_receipt_date):"",c=l?new Date(`${l.slice(0,10)}T00:00:00`):null;return c&&Number.isFinite(c.getTime())?c:null}).filter(Boolean).filter(s=>s.getTime()>=r.getTime()).sort((s,l)=>s.getTime()-l.getTime())[0]??null}function NM(){const[e,t]=Ie.useState(()=>new Date().toISOString().slice(0,10)),[r,a]=Ie.useState("dashboard"),[s,l]=Ie.useState(!0),[c,u]=Ie.useState([]),[h,d]=Ie.useState(""),[g,x]=Ie.useState("772"),[v,_]=Ie.useState(!1),[b,y]=Ie.useState(50),[S,k]=Ie.useState({771:1,772:1}),[R,T]=Ie.useState(!1),[j,X]=Ie.useState(null),[L,A]=Ie.useState({loading:!0,message:"",type:""}),K=Ie.useRef(null),[q,ie]=Ie.useState({loading:!1,message:"",type:""}),ne=Ie.useRef(null),[Z,me]=Ie.useState({loading:!1,message:"",type:""}),Re=Ie.useRef(null),[Ae,V]=Ie.useState({loading:!1,message:"",type:""}),[ae,xe]=Ie.useState([]),[J,be]=Ie.useState(null),I=Ie.useRef(null),[N,U]=Ie.useState({loading:!1,message:"",type:""}),[M,P]=Ie.useState([]),[te,pe]=Ie.useState(""),[Ee,ve]=Ie.useState(1),[Te,tt]=Ie.useState(50),G=Ie.useRef(null),[Rt,We]=Ie.useState({loading:!1,message:"",type:""}),[bt,lt]=Ie.useState([]),[Pe,Zt]=Ie.useState(""),[Ar,Hr]=Ie.useState(1),[$r,zn]=Ie.useState(50),[Ja,Et]=Ie.useState({loading:!1,message:"",type:""}),[xa,sa]=Ie.useState([]),Ma=Y=>{const ee=Y?.message?String(Y.message):"";return ee.toLowerCase().includes("schema cache")||ee.toLowerCase().includes("could not find the table")?"Parece que en Supabase an no existe (o no se ha refrescado) la tabla `public.tertiary_packaging`. Ejecuta `supabase/schema.sql` en Supabase (SQL Editor) y luego recarga el schema con: NOTIFY pgrst, 'reload schema';":""},Jt=Y=>{const ee=Y?.message?String(Y.message):"";return ee.toLowerCase().includes("schema cache")||ee.toLowerCase().includes("could not find the table")?"Parece que en Supabase an no existe (o no se ha refrescado) la tabla `public.medication_categories`. Ejecuta `supabase/schema.sql` en Supabase (SQL Editor) y luego recarga el schema con: NOTIFY pgrst, 'reload schema';":""},ia=Y=>{const ee=Y?.message?String(Y.message):"";return ee.toLowerCase().includes("schema cache")||ee.toLowerCase().includes("could not find the table")?"Parece que en Supabase an no existe (o no se ha refrescado) la tabla `public.order_calendar`. Ejecuta `supabase/schema.sql` en Supabase (SQL Editor) y luego recarga el schema con: NOTIFY pgrst, 'reload schema';":""};Ie.useEffect(()=>{let Y=!1;async function ee(){A({loading:!0,message:Qs?"Conectando a Supabase...":"Cargando datos locales...",type:"info"});try{const[se,Oe,Ue]=await Promise.all([At.getMedications(),At.getMonthlyBatches(),At.getSelectedMonthlyBatchId?.()]);if(Y)return;u(se??[]);const Fe=(Oe??[]).map(Ke=>({...Ke,id:Ke?.id!=null?String(Ke.id):Ke.id}));xe(Fe);try{const Ke=await At.getTertiaryPackaging?.()??[];Y||P(Ke??[])}catch(Ke){const nt=Ma(Ke);Y||(P([]),U({loading:!1,message:nt?`${String(Ke?.message||Ke||"Error al cargar Empaque Terciario.")}. ${nt}`:String(Ke?.message||Ke||"Error al cargar Empaque Terciario."),type:"error"}))}try{const Ke=await At.getMedicationCategories?.()??[];Y||lt(Ke??[])}catch(Ke){const nt=Jt(Ke);Y||(lt([]),We({loading:!1,message:nt?`${String(Ke?.message||Ke||"Error al cargar Categoras.")}. ${nt}`:String(Ke?.message||Ke||"Error al cargar Categoras."),type:"error"}))}try{const Ke=await At.getOrderCalendar?.()??[];Y||sa(Ke??[])}catch(Ke){const nt=ia(Ke);Y||(sa([]),Et({loading:!1,message:nt?`${String(Ke?.message||Ke||"Error al cargar Calendario.")}. ${nt}`:String(Ke?.message||Ke||"Error al cargar Calendario."),type:"error"}))}const Me=Ue!=null?String(Ue):null,$e=Fe?.[0]?.id??null,Ve=Me&&Fe.some(Ke=>Ke.id===Me)?Me:$e;be(Ve),await At.setSelectedMonthlyBatchId?.(Ve),A({loading:!1,message:"",type:""})}catch(se){if(Y)return;A({loading:!1,message:se?.message?String(se.message):"No se pudieron cargar los datos.",type:"error"})}}return ee(),()=>{Y=!0}},[]);const mt=Y=>{const ee=Y==null?null:String(Y);be(ee),At.setSelectedMonthlyBatchId?.(ee)},Dt=Y=>{const ee=String(Y??"").trim();if(!ee)return"";const se=ee.replace(/\D/g,"");return se.length===9?`${se.slice(0,3)}-${se.slice(3,5)}-${se.slice(5,9)}`:ee.replace(/\s+/g," ")};Ie.useEffect(()=>{const Y=new Date,ee=new Date(Y.getFullYear(),Y.getMonth(),Y.getDate()+1,0,0,0,50),se=Math.max(1e3,ee.getTime()-Y.getTime()),Oe=window.setTimeout(()=>t(new Date().toISOString().slice(0,10)),se);return()=>window.clearTimeout(Oe)},[e]);const Ir=Ie.useMemo(()=>CM(xa,e),[xa,e]),Vt=Ie.useMemo(()=>{const Y=(ae??[]).filter(se=>(se?.items??[]).length>0).slice(0,3),ee=new Map;for(const se of Y){const Oe=new Map;for(const Ue of se?.items??[]){const Fe=String(Ue?.siges_code||"").trim();Fe&&Oe.set(Fe,(Oe.get(Fe)||0)+Ly(Ue?.quantity))}for(const[Ue,Fe]of Oe.entries()){const Me=ee.get(Ue)||[];Me.push(Fe),ee.set(Ue,Me)}}for(const[se,Oe]of ee.entries()){for(;Oe.length<3;)Oe.push(0);const Ue=(Oe[0]+Oe[1]+Oe[2])/3;ee.set(se,Ue)}return ee},[ae]),er=Ie.useMemo(()=>{const Y=new Date(`${e}T00:00:00`),ee=Ir?AM(Y,Ir):null,se=Math.max(0,Number(ee)||0)+4,Oe=new Map;for(const Fe of c??[]){const Me=String(Fe?.siges_code||"").trim();if(!Me)continue;const $e=Oe.get(Me),Ye=Number(Fe?.stock)||0,Ve=Number(Fe?.min_stock)||0,Ke=String(Fe?.name||"").trim(),nt=!$e||String($e?.inventory_type||"772")!=="772"&&String(Fe?.inventory_type||"772")==="772";$e?Oe.set(Me,{...nt?{...$e,...Fe}:$e,siges_code:Me,name:nt&&Ke||$e.name,min_stock:Math.max($e.min_stock||0,Ve),_sumStock:($e._sumStock||0)+Ye}):Oe.set(Me,{...Fe,siges_code:Me,name:Ke,stock:Ye,min_stock:Ve,_sumStock:Ye})}const Ue=[];for(const Fe of Oe.values()){const Me=String(Fe.siges_code||"").trim(),$e=Number(Fe._sumStock)||0,Ve=(Vt.get(Me)||0)/30,Ke=Number(Fe.min_stock)||0,nt=Ir?Ve*se:Ke,qe=Number.isFinite(nt)?nt:Ke;$e<=qe&&Ue.push({...Fe,stock:$e,computed_min_stock:qe,_daysToReceipt:ee})}return Ue.sort((Fe,Me)=>(Number(Me.computed_min_stock)||0)-(Number(Me.stock)||0)-((Number(Fe.computed_min_stock)||0)-(Number(Fe.stock)||0))),Ue},[Vt,c,Ir,e]),La=Ie.useMemo(()=>({totalItems:c.length,lowStockCount:er.length,totalStockValue:c.reduce((Y,ee)=>Y+ee.stock,0),recentConsumptions:ae[0]?.items?.length||0}),[c,er,ae]),cr=Ie.useMemo(()=>{const Y=String(g||"772"),ee=h.trim().toLowerCase(),se=({siges_code:Me,name:$e})=>{const Ye=String(Me||"").trim();if(Ye)return`code:${Ye.toLowerCase()}`;const Ve=String($e||"").trim().toLowerCase();return Ve?`name:${Ve}`:""},Oe=Me=>{Me.sort(($e,Ye)=>{const Ve=String($e.batch).localeCompare(String(Ye.batch));return Ve!==0?Ve:String($e.expiry_date).localeCompare(String(Ye.expiry_date))})},Ue=Me=>{const $e=[],Ye=new Map;for(const Ve of Me){const Ke=String(Ve.siges_code||"").trim(),nt=String(Ve.name||"").trim(),qe=`${Ke}||${nt}`.toLowerCase(),Ge=Ye.get(qe),Xe={id:Ve.id,batch:String(Ve.batch||"").trim()||"S/N",expiry_date:Ve.expiry_date?String(Ve.expiry_date).trim():"",stock:Number(Ve.stock)||0};if(Ge)Ge.lots.push(Xe),Ge.stock+=Xe.stock;else{const Ze={id:`group:${qe}`,inventory_type:"771",siges_code:Ke,name:nt,lots:[Xe],stock:Xe.stock};Ye.set(qe,Ze),$e.push(Ze)}}for(const Ve of $e)Oe(Ve.lots);return $e};if(Y==="771"){const Me=c.filter(Ye=>String(Ye.inventory_type||"772")==="771"),$e=Ue(Me);return ee?$e.filter(Ye=>{const Ve=Ye.lots.map(nt=>`${nt.batch} ${nt.expiry_date} ${nt.stock}`).join(" ");return`${Ye.siges_code} ${Ye.name} ${Ve}`.toLowerCase().includes(ee)}):$e}if(Y==="total"){const Me=(()=>{const Ge=(ae??[]).slice().sort((Ze,pt)=>{const rt=new Date(Ze?.created_at||Ze?.updated_at||0).getTime();return new Date(pt?.created_at||pt?.updated_at||0).getTime()-rt}).slice(0,4),Xe=new Map;for(const Ze of Ge)for(const pt of Ze?.items??[]){const rt=Dt(pt?.siges_code);if(!rt)continue;const gr=Number(pt?.quantity)||0;Xe.set(rt,(Xe.get(rt)||0)+gr)}return Xe})(),$e=new Map,Ye=({siges_code:qe,name:Ge})=>{const Xe=se({siges_code:qe,name:Ge});if(!Xe)return null;const Ze=$e.get(Xe);if(Ze)return Ze;const pt={id:`total:${Xe}`,inventory_type:"total",siges_code:String(qe||"").trim(),name:String(Ge||"").trim(),lots:[],stock772:0,stock771:0,stock:0};return $e.set(Xe,pt),pt};for(const qe of c){const Ge=String(qe.inventory_type||"772");if(Ge!=="771"&&Ge!=="772")continue;const Xe=Ye({siges_code:qe.siges_code,name:qe.name});if(Xe)if(Xe.siges_code||(Xe.siges_code=String(qe.siges_code||"").trim()),Xe.name||(Xe.name=String(qe.name||"").trim()),Ge==="772")Xe.stock772+=Number(qe.stock)||0;else{const Ze={id:qe.id,batch:String(qe.batch||"").trim()||"S/N",expiry_date:qe.expiry_date?String(qe.expiry_date).trim():"",stock:Number(qe.stock)||0};Xe.lots.push(Ze),Xe.stock771+=Ze.stock}}const Ve=Array.from($e.values()).map(qe=>(Oe(qe.lots),qe.stock=qe.stock772+qe.stock771,qe)),Ke=(ae??[]).some(qe=>(qe?.items??[]).length>0),nt=v&&Ke?Ve.filter(qe=>{const Ge=String(qe.siges_code||"").trim();return Ge?(Me.get(Ge)||0)>0:!1}):Ve;return ee?nt.filter(qe=>{const Ge=qe.lots.map(Ze=>`${Ze.batch} ${Ze.expiry_date} ${Ze.stock}`).join(" ");return`${qe.siges_code} ${qe.name} ${qe.stock772} ${qe.stock771} ${qe.stock} ${Ge}`.toLowerCase().includes(ee)}):nt}const Fe=c.filter(Me=>String(Me.inventory_type||"772")===Y);return ee?Fe.filter(Me=>`${Me.siges_code} ${Me.name} ${Me.category} ${Me.batch} ${Me.expiry_date} ${Me.unit}`.toLowerCase().includes(ee)):Fe},[v,h,c,g,ae]),ui=S?.[String(g||"772")]??1,tl=Ie.useMemo(()=>{const Y=b||50,ee=Math.max(1,Math.ceil(cr.length/Y)),Oe=(Math.min(Math.max(ui,1),ee)-1)*Y;return cr.slice(Oe,Oe+Y)},[cr,ui,b]),rl=Ie.useMemo(()=>{const Y=String(g||"772");return Y==="total"?cr.length:Y!=="771"?c.filter(ee=>String(ee.inventory_type||"772")===Y).length:cr.length},[cr,g,c]),Hn=Ie.useMemo(()=>(ae??[]).some(Y=>(Y?.items??[]).length>0),[ae]),_s=async()=>{try{U({loading:!0,message:"Sincronizando...",type:"info"});const Y=await At.getTertiaryPackaging?.()??[];P(Y),U({loading:!1,message:`Sincronizado: ${Y.length} registros.`,type:"success"}),window.setTimeout(()=>U({loading:!1,message:"",type:""}),4e3)}catch(Y){const ee=Ma(Y);U({loading:!1,message:ee?`${String(Y?.message||"No se pudo sincronizar.")}. ${ee}`:Y?.message?String(Y.message):"No se pudo sincronizar.",type:"error"})}},ws=async()=>{try{We({loading:!0,message:"Sincronizando...",type:"info"});const Y=await At.getMedicationCategories?.()??[];lt(Y),We({loading:!1,message:`Sincronizado: ${Y.length} registros.`,type:"success"}),window.setTimeout(()=>We({loading:!1,message:"",type:""}),4e3)}catch(Y){const ee=Jt(Y);We({loading:!1,message:ee?`${String(Y?.message||"No se pudo sincronizar.")}. ${ee}`:Y?.message?String(Y.message):"No se pudo sincronizar.",type:"error"})}},ba=async()=>{try{Et({loading:!0,message:"Sincronizando...",type:"info"});const Y=await At.getOrderCalendar?.()??[];sa(Y),Et({loading:!1,message:`Sincronizado: ${Y.length} registros.`,type:"success"}),window.setTimeout(()=>Et({loading:!1,message:"",type:""}),4e3)}catch(Y){const ee=ia(Y);Et({loading:!1,message:ee?`${String(Y?.message||"No se pudo sincronizar.")}. ${ee}`:Y?.message?String(Y.message):"No se pudo sincronizar.",type:"error"})}},bs=async Y=>{try{Et({loading:!0,message:"Guardando...",type:"info"}),await At.upsertOrderCalendarEntries?.(Y);const ee=await At.getOrderCalendar?.()??[];sa(ee),Et({loading:!1,message:"Calendario actualizado.",type:"success"}),window.setTimeout(()=>Et({loading:!1,message:"",type:""}),2500)}catch(ee){const se=ia(ee);Et({loading:!1,message:se?`${String(ee?.message||"No se pudo guardar.")}. ${se}`:ee?.message?String(ee.message):"No se pudo guardar.",type:"error"})}},$n=async Y=>{try{We({loading:!0,message:"Guardando...",type:"info"}),await At.upsertMedicationCategories?.([Y]);const ee=await At.getMedicationCategories?.()??[];lt(ee),We({loading:!1,message:"Categora actualizada.",type:"success"}),window.setTimeout(()=>We({loading:!1,message:"",type:""}),2500)}catch(ee){const se=Jt(ee);We({loading:!1,message:se?`${String(ee?.message||"No se pudo guardar.")}. ${se}`:ee?.message?String(ee.message):"No se pudo guardar.",type:"error"})}},xo=async Y=>{if(!(!Y?.id||!window.confirm("Desea eliminar esta categora?")))try{We({loading:!0,message:"Eliminando...",type:"info"}),await At.deleteMedicationCategory?.(Y.id);const se=await At.getMedicationCategories?.()??[];lt(se),We({loading:!1,message:"Categora eliminada.",type:"success"}),window.setTimeout(()=>We({loading:!1,message:"",type:""}),2500)}catch(se){const Oe=Jt(se);We({loading:!1,message:Oe?`${String(se?.message||"No se pudo eliminar.")}. ${Oe}`:se?.message?String(se.message):"No se pudo eliminar.",type:"error"})}},al=()=>{const Y=[["CODIGO","MEDICAMENTO","EMPAQUE TERCIARIO"],["110-16-0010","PARACETAMOL 500 MG., TABLETAS",200]],ee=Ks.aoa_to_sheet(Y),se=Ks.book_new();Ks.book_append_sheet(se,ee,"Empaque"),Fy(se,"empaque_terciario.xlsx")},fi=async()=>{if(window.confirm("Desea eliminar toda la carga de Empaque Terciario? Esta accin no se puede deshacer."))try{U({loading:!0,message:"Eliminando...",type:"info"}),await At.clearTertiaryPackaging?.(),P([]),U({loading:!1,message:"Carga eliminada.",type:"success"}),window.setTimeout(()=>U({loading:!1,message:"",type:""}),4e3)}catch(ee){const se=Ma(ee);U({loading:!1,message:se?`${String(ee?.message||"No se pudo eliminar la carga.")}. ${se}`:ee?.message?String(ee.message):"No se pudo eliminar la carga.",type:"error"})}},Vn=Y=>{const ee=Y.target.files?.[0];if(!ee)return;U({loading:!0,message:`Procesando: ${ee.name}`,type:"info"});const se=new FileReader;se.onerror=()=>{U({loading:!1,message:"No se pudo leer el archivo.",type:"error"})},se.onload=async Oe=>{try{const Ue=Oe.target?.result,Fe=Vu(Ue,{type:"array"}),Me=Fe.SheetNames?.[0];if(!Me)throw new Error("El XLSX no tiene hojas.");const $e=Fe.Sheets[Me],Ye=Ks.sheet_to_json($e,{header:1,raw:!1,blankrows:!1}),Ve=Array.isArray(Ye)?Ye:[],nt=(Ze=>{const pt=la=>String(la??"").trim().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]/g,""),rt=pt(Ze?.[0]),gr=pt(Ze?.[1]),fr=pt(Ze?.[2]);return rt.includes("siges")||rt.includes("codigo")||gr.includes("medicamento")||fr.includes("cantidad")})(Ve?.[0])?Ve.slice(1):Ve,qe=new Map((c??[]).map(Ze=>[Dt(Ze.siges_code),String(Ze.name||"").trim()]).filter(([Ze])=>!!Ze)),Ge=nt.map((Ze,pt)=>{const rt=Dt(Ze?.[0]),fr=String(Ze?.[1]??"").trim()||qe.get(rt)||"",la=Ly(Ze?.[2]);return rt?{id:globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():String(Date.now())+pt,siges_code:rt,medication_name:fr,tertiary_quantity:la}:null}).filter(Boolean),Xe=await At.upsertTertiaryPackaging?.(Ge)??Ge;P(Xe),U({loading:!1,message:`Empaque Terciario: ${Ge.length} registros importados/actualizados.`,type:"success"}),window.setTimeout(()=>U({loading:!1,message:"",type:""}),4e3)}catch(Ue){const Fe=Ma(Ue);U({loading:!1,message:Fe?`${String(Ue?.message||"Error al procesar/guardar el XLSX.")}. ${Fe}`:Ue?.message?String(Ue.message):"Error al procesar/guardar el XLSX.",type:"error"})}},se.readAsArrayBuffer(ee),Y.target.value=null},vo=Y=>{const ee=String(Y??"").trim();if(!ee)return"";const se=ee.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s+/g," ").trim();return se==="ordinario"?"Ordinario":se==="frio"?"Fro":se==="estupefaciente"?"Estupefaciente":se==="psicotropico"?"Psicotrpico":se==="alcohol"?"Alcohol":se==="suero"?"Suero":se==="compra local"||se==="compralocal"?"Compra Local":""},nl=()=>{const Y=[["CODIGO","MEDICAMENTO","CATEGORIA"],["110-16-0010","PARACETAMOL 500 MG., TABLETAS","Ordinario"]],ee=Ks.aoa_to_sheet(Y),se=Ks.book_new();Ks.book_append_sheet(se,ee,"Categorias"),Fy(se,"categorias.xlsx")},Ss=async()=>{if(window.confirm("Desea eliminar toda la carga de Categoras? Esta accin no se puede deshacer."))try{We({loading:!0,message:"Eliminando...",type:"info"}),await At.clearMedicationCategories?.(),lt([]),We({loading:!1,message:"Carga eliminada.",type:"success"}),window.setTimeout(()=>We({loading:!1,message:"",type:""}),4e3)}catch(ee){const se=Jt(ee);We({loading:!1,message:se?`${String(ee?.message||"No se pudo eliminar la carga.")}. ${se}`:ee?.message?String(ee.message):"No se pudo eliminar la carga.",type:"error"})}},sl=Y=>{const ee=Y.target.files?.[0];if(!ee)return;We({loading:!0,message:`Procesando: ${ee.name}`,type:"info"});const se=new FileReader;se.onerror=()=>{We({loading:!1,message:"No se pudo leer el archivo.",type:"error"})},se.onload=async Oe=>{try{const Ue=Oe.target?.result,Fe=Vu(Ue,{type:"array"}),Me=Fe.SheetNames?.[0];if(!Me)throw new Error("El XLSX no tiene hojas.");const $e=Fe.Sheets[Me],Ye=Ks.sheet_to_json($e,{header:1,raw:!1,blankrows:!1}),Ve=Array.isArray(Ye)?Ye:[],nt=(Ze=>{const pt=la=>String(la??"").trim().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]/g,""),rt=pt(Ze?.[0]),gr=pt(Ze?.[1]),fr=pt(Ze?.[2]);return rt.includes("codigo")||rt.includes("siges")||gr.includes("medicamento")||fr.includes("categoria")})(Ve?.[0])?Ve.slice(1):Ve,qe=[];let Ge=0;for(let Ze=0;Ze<nt.length;Ze+=1){const pt=nt[Ze],rt=Dt(pt?.[0]),gr=String(pt?.[1]??"").trim(),fr=vo(pt?.[2]);if(rt){if(!fr){Ge+=1;continue}qe.push({id:globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():String(Date.now())+Ze,siges_code:rt,medication_name:gr,category:fr})}}const Xe=await At.upsertMedicationCategories?.(qe)??qe;lt(Xe),We({loading:!1,message:`Categoras: ${qe.length} registros importados/actualizados.${Ge?` (${Ge} filas con categora invlida omitidas)`:""}`,type:"success"}),window.setTimeout(()=>We({loading:!1,message:"",type:""}),4e3)}catch(Ue){const Fe=Jt(Ue);We({loading:!1,message:Fe?`${String(Ue?.message||"Error al procesar/guardar el XLSX.")}. ${Fe}`:Ue?.message?String(Ue.message):"Error al procesar/guardar el XLSX.",type:"error"})}},se.readAsArrayBuffer(ee),Y.target.value=null},xn=Ie.useMemo(()=>{const Y=Pe.trim().toLowerCase(),ee=(bt??[]).map(se=>({...se,siges_code:Dt(se?.siges_code),medication_name:String(se?.medication_name||"").trim(),category:String(se?.category||"").trim()}));return Y?ee.filter(se=>`${se.siges_code} ${se.medication_name} ${se.category}`.toLowerCase().includes(Y)):ee},[Pe,bt]),hi=Ie.useMemo(()=>{const Y=$r||50,ee=Math.max(1,Math.ceil(xn.length/Y)),Oe=(Math.min(Math.max(Ar,1),ee)-1)*Y;return xn.slice(Oe,Oe+Y)},[Ar,$r,xn]),C=Ie.useMemo(()=>{const Y=te.trim().toLowerCase(),ee=(M??[]).map(se=>{const Oe=Dt(se?.siges_code),Ue=(c??[]).find(Fe=>Dt(Fe.siges_code)===Oe)?.name;return{...se,siges_code:Oe,medication_name:String(se?.medication_name||Ue||"").trim(),tertiary_quantity:Number(se?.tertiary_quantity)||0}});return Y?ee.filter(se=>`${se.siges_code} ${se.medication_name}`.toLowerCase().includes(Y)):ee},[c,M,te]),z=Ie.useMemo(()=>{const Y=Te||50,ee=Math.max(1,Math.ceil(C.length/Y)),Oe=(Math.min(Math.max(Ee,1),ee)-1)*Y;return C.slice(Oe,Oe+Y)},[C,Ee,Te]),D=()=>{X(null),T(!0)},F=Y=>{X(Y),T(!0)},B=async()=>{const Y=await At.getMedications();u(Y??[])},H=async Y=>{Y.preventDefault();const ee=new FormData(Y.target),se={id:j?j.id:globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():Date.now(),inventory_type:j?.inventory_type??String(g||"772"),siges_code:j?.siges_code??"",sicop_classifier:j?.sicop_classifier??"",sicop_identifier:j?.sicop_identifier??"",name:String(ee.get("name")||"").trim(),category:String(ee.get("category")||"").trim(),batch:String(ee.get("batch")||"").trim(),expiry_date:String(ee.get("expiry_date")||"").trim(),stock:Number.parseFloat(String(ee.get("stock")||"0"))||0,min_stock:Number.parseFloat(String(ee.get("min_stock")||"0"))||0,unit:String(ee.get("unit")||"").trim()};try{A({loading:!0,message:"Guardando...",type:"info"}),await At.upsertMedication(se),await B(),X(null),T(!1),A({loading:!1,message:"",type:""})}catch(Oe){A({loading:!1,message:Oe?.message?String(Oe.message):"No se pudo guardar el medicamento.",type:"error"})}},fe=async Y=>{try{A({loading:!0,message:"Eliminando...",type:"info"}),await At.deleteMedication(Y),await B(),A({loading:!1,message:"",type:""})}catch(ee){A({loading:!1,message:ee?.message?String(ee.message):"No se pudo eliminar el medicamento.",type:"error"})}},_e=async()=>{try{A({loading:!0,message:"Eliminando catlogo...",type:"info"}),await At.clearMedications(),await B(),A({loading:!1,message:"",type:""})}catch(Y){A({loading:!1,message:Y?.message?String(Y.message):"No se pudo limpiar el catlogo.",type:"error"})}},oe=({siges_code:Y,name:ee})=>{const se=String(Y||"").trim();if(se)return`code:${se}`;const Oe=String(ee||"").trim().toLowerCase();return Oe?`name:${Oe}`:""},le=Y=>{const ee=String(Y??"").trim();if(!ee)return 0;const se=ee.replace(/\s/g,""),Oe=se.includes(","),Ue=se.includes(".");let Fe=se;Oe&&Ue?Fe=se.replace(/,/g,""):Oe&&!Ue&&(Fe=se.replace(/,/g,"."));const Me=Number.parseFloat(Fe);return Number.isFinite(Me)?Me:0},he=Y=>{const ee=String(Y??"").trim();if(!ee)return null;const se=ee.slice(0,10);if(/^\d{4}-\d{2}-\d{2}$/.test(se))return se;const Oe=ee.replace(/\D/g,"");if(Oe.length===8){const Me=Oe.slice(0,4),$e=Oe.slice(4,6),Ye=Oe.slice(6,8);return`${Me}-${$e}-${Ye}`}const Ue=ee.match(/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/);if(Ue){const Me=Ue[1].padStart(2,"0"),$e=Ue[2].padStart(2,"0");return`${Ue[3]}-${$e}-${Me}`}const Fe=new Date(ee);return Number.isNaN(Fe.getTime())?null:Fe.toISOString().slice(0,10)},Ne=(Y,ee,se=[])=>{if(!Y)return"";for(const Oe of ee){const Ue=Y.getElementsByTagName(Oe)?.[0],Fe=Ue?.textContent!=null?String(Ue.textContent).trim():"";if(Fe)return Fe}for(const Oe of se){const Ue=Y.getAttribute?.(Oe);if(Ue!=null&&String(Ue).trim())return String(Ue).trim()}return""},Le=Y=>{const se=Array.from(Y.getElementsByTagNameNS("*","FormattedAreaPair")).filter(Me=>Me.getAttribute("Level")==="4"&&Me.getAttribute("Type")==="Group");if(!se.length)return null;const Oe=(Me,$e)=>{const Ye=Array.from(Me.getElementsByTagNameNS("*","FormattedReportObject"));for(const Ve of Ye){const Ke=Ve.getAttribute?.("FieldName");if(!Ke||!$e(Ke))continue;const nt=Ve.getElementsByTagNameNS("*","Value")?.[0],qe=Ve.getElementsByTagNameNS("*","FormattedValue")?.[0],Xe=((nt?.textContent!=null?String(nt.textContent):"")||(qe?.textContent!=null?String(qe.textContent):"")).trim();if(Xe)return Xe}return""},Ue=Me=>$e=>String($e).includes(Me),Fe=[];for(const Me of se){const $e=Oe(Me,Ue(".PRODUCTO}")),Ye=Oe(Me,Ue(".DSC_PRODUCTO}")),Ve=Dt($e),Ke=String(Ye||"").trim();if(!Ve||!Ke)continue;const nt=Array.from(Me.getElementsByTagNameNS("*","FormattedAreaPair")).filter(qe=>qe.getAttribute("Level")==="5"&&qe.getAttribute("Type")==="Details");for(const qe of nt){const Ge=Oe(qe,Ue(".IDE_LOTE}"))||"S/N",Xe=Oe(qe,Ue(".CAN_LOTE}"))||"0",Ze=Oe(qe,Ue(".FEC_VENCIMIENTO}")),pt=le(Xe),rt=he(Ze);Fe.push({siges_code:Ve,name:Ke,batch:String(Ge).trim()||"S/N",expiry_date:rt,stock:pt})}}return Fe},He=Y=>{const se=new DOMParser().parseFromString(String(Y||""),"application/xml");if(se.querySelector("parsererror"))throw new Error("XML invlido o mal formado.");const Oe=Le(se);if(Array.isArray(Oe))return Oe;const Ue=["CodigoSIGES","CodigoSiges","codigoSIGES","codigoSiges","Codigo","codigo","SIGES","Siges","siges_code"],Fe=["Medicamento","medicamento","Nombre","nombre","Descripcion","descripcion","Medication"],Me=["Lote","lote","Batch","batch","LoteMedicamento","loteMedicamento"],$e=["Vencimiento","vencimiento","FechaVencimiento","fechaVencimiento","FechaCaducidad","fechaCaducidad","expiry_date","ExpiryDate"],Ye=["Inventario","inventario","Stock","stock","Existencia","existencia","Cantidad","cantidad"],Ve=new Set;for(const nt of Ue){const qe=se.getElementsByTagName(nt);for(const Ge of qe){let Xe=Ge.parentElement,Ze=0;for(;Xe&&Xe!==se.documentElement&&Ze<6;){const pt=!!Ne(Xe,Me,["lote","Lote","batch","Batch"]),rt=!!Ne(Xe,$e,["vencimiento","Vencimiento","expiry","Expiry"]),gr=!!Ne(Xe,Ye,["inventario","Inventario","stock","Stock"]);if(pt||rt||gr)break;Xe=Xe.parentElement,Ze+=1}Xe&&Ve.add(Xe)}}const Ke=[];for(const nt of Ve){const qe=Ne(nt,Ue,["CodigoSIGES","codigoSIGES","siges_code","Codigo","codigo"]),Ge=Ne(nt,Fe,["Medicamento","medicamento","Nombre","nombre"]).trim(),Xe=Ne(nt,Me,["Lote","lote","Batch","batch"]).trim(),Ze=Ne(nt,$e,["Vencimiento","vencimiento","ExpiryDate","expiry_date"]).trim(),pt=Ne(nt,Ye,["Inventario","inventario","Stock","stock"]).trim();!qe||!Ge||Ke.push({siges_code:Dt(qe),name:Ge||"Sin nombre",batch:Xe||"S/N",expiry_date:he(Ze),stock:le(pt)})}return Ke},De=({siges_code:Y,name:ee,batch:se,expiry_date:Oe})=>{const Ue=String(Y||"").trim(),Fe=String(ee||"").trim().toLowerCase(),Me=String(se||"").trim().toLowerCase(),$e=Oe?String(Oe).trim():"";return Ue?`code:${Ue}|lot:${Me}|exp:${$e}`:`name:${Fe}|lot:${Me}|exp:${$e}`},ze=async({text:Y})=>{const se=He(Y),Oe=[],Ue=new Set;for(const Ge of se){const Xe=De(Ge);!Xe||Ue.has(Xe)||(Ue.add(Xe),Oe.push(Ge))}const Me=(await At.getMedications()??[]).filter(Ge=>String(Ge.inventory_type||"772")==="771"),$e=new Map(Me.map(Ge=>[De(Ge),Ge.id]).filter(([Ge])=>!!Ge)),Ye=Date.now(),Ve=Oe.map((Ge,Xe)=>{const Ze=De(Ge);return{id:$e.get(Ze)??(globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():Ye+Xe),inventory_type:"771",siges_code:Ge.siges_code,sicop_classifier:"",sicop_identifier:"",name:Ge.name,category:"General",batch:Ge.batch||"S/N",expiry_date:Ge.expiry_date,stock:Ge.stock,min_stock:0,unit:"Unidad"}});await At.upsertMedications(Ve);const Ke=await At.getMedications()??[],nt=Ke.filter(Ge=>String(Ge.inventory_type||"772")==="771").length,qe=Ke.reduce((Ge,Xe)=>{const Ze=String(Xe.inventory_type||"772");return Ge[Ze]=(Ge[Ze]||0)+1,Ge},{});return await B(),{importedCount:Ve.length,visibleCountForType:nt,totalCountByType:qe}},Qe=Y=>{const ee=Fe=>String(Fe??"").trim().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]/g,""),se=ee(Y?.[0]),Oe=ee(Y?.[1]),Ue=ee(Y?.[2]);return se.includes("siges")||se.includes("codigosiges")||Oe.includes("medicamento")||Oe.includes("nombre")||Ue.includes("inventario")||Ue.includes("stock")},Gt=async({text:Y,type:ee})=>{const se=String(ee||"772").trim()||"772",Oe=Qx(Y),Ue=Qe(Oe?.[0])?Oe.slice(1):Oe,Fe=Ue.some(rt=>{const gr=String(rt?.[0]??"").trim(),fr=String(rt?.[1]??"").trim();return!!(gr&&fr)}),Me=Fe?null:Zx(Y),Ye=(await At.getMedications()??[]).filter(rt=>String(rt.inventory_type||"772")===se),Ve=new Map(Ye.map(rt=>[oe(rt),rt.id]).filter(([rt])=>!!rt)),Ke=Date.now(),nt=(Ue??[]).map((rt,gr)=>{if(!Fe)return null;const fr=String(rt?.[0]??"").trim(),la=String(rt?.[1]??"").trim();if(!fr||!la)return null;const di=oe({siges_code:fr,name:la});return di?{id:Ve.get(di)??(globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():Ke+gr),inventory_type:se,siges_code:fr,sicop_classifier:"",sicop_identifier:"",name:la,category:"General",batch:"S/N",expiry_date:gd(""),stock:le(rt?.[2]),min_stock:0,unit:"Unidad"}:null}).filter(Boolean),qe=(Me??[]).map((rt,gr)=>{if(Fe)return null;const fr=String(rt.CodigoSIGES||"").trim(),la=String(rt.Medicamento||rt.Nombre||"").trim(),di=oe({siges_code:fr,name:la});return di?{id:Ve.get(di)??(globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():Ke+gr),inventory_type:se,siges_code:fr,sicop_classifier:String(rt.ClasificadorSICOP||"").trim(),sicop_identifier:String(rt.IdentificadorSICOP||"").trim(),name:la||"Sin nombre",category:String(rt.Categoria||"General").trim()||"General",batch:String(rt.Lote||"S/N").trim()||"S/N",expiry_date:gd(rt.Vencimiento),stock:le(rt.Stock),min_stock:le(rt.StockMinimo||0),unit:String(rt.Unidad||"Unidad").trim()||"Unidad"}:null}).filter(Boolean),Ge=Fe?nt:qe;await At.upsertMedications(Ge);const Xe=await At.getMedications()??[],Ze=Xe.filter(rt=>String(rt.inventory_type||"772")===se).length,pt=Xe.reduce((rt,gr)=>{const fr=String(gr.inventory_type||"772");return rt[fr]=(rt[fr]||0)+1,rt},{});return await B(),{importedCount:Ge.length,visibleCountForType:Ze,totalCountByType:pt}},qt=Y=>{const ee=Y.target.files?.[0];if(!ee)return;ie({loading:!0,message:"Procesando archivo...",type:"info"});const se=new FileReader;se.onerror=()=>{ie({loading:!1,message:"No se pudo leer el archivo.",type:"error"})},se.onload=async Oe=>{try{const Ue=String(Oe.target?.result||""),Fe=Zx(Ue),Me=Date.now(),$e=Fe.map((Ye,Ve)=>({id:globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():Me+Ve,inventory_type:"772",siges_code:String(Ye.CodigoSIGES||"").trim(),sicop_classifier:String(Ye.ClasificadorSICOP||"").trim(),sicop_identifier:String(Ye.IdentificadorSICOP||"").trim(),name:Ye.Medicamento||Ye.Nombre||"Sin nombre",category:Ye.Categoria||"General",batch:Ye.Lote||"S/N",expiry_date:gd(Ye.Vencimiento),stock:le(Ye.Stock),min_stock:le(Ye.StockMinimo||10),unit:Ye.Unidad||"Unidad"}));await At.upsertMedications($e),await B(),ie({loading:!1,message:`Se han importado ${$e.length} medicamentos con xito.`,type:"success"}),window.setTimeout(()=>ie({loading:!1,message:"",type:""}),4e3)}catch(Ue){const Fe=Ue?.message?String(Ue.message):"",$e=Fe.includes("invalid input syntax for type integer")?"Tu base de datos en Supabase tiene `stock`/`min_stock` como INTEGER. Ejecuta `supabase/schema.sql` (ALTER COLUMN a NUMERIC) o usa valores enteros.":"";ie({loading:!1,message:$e?`${Fe}. ${$e}`:Fe||"Error al procesar/guardar el CSV.",type:"error"})}},se.readAsText(ee),Y.target.value=null},tr=Y=>{const ee=String(Y||g||"772");if(ee!=="total")return ee==="771"?VE(ee):$E(ee)},Sa=Y=>{const ee=Y.target.files?.[0];if(!ee)return;const se=String(g||"772");if(se==="total"){me({loading:!1,message:"Inventario total no admite carga de archivos.",type:"error"}),Y.target.value=null;return}const Oe=String(ee.name||"").toLowerCase(),Ue=Oe.endsWith(".xml"),Fe=Oe.endsWith(".csv");if(se==="771"&&!Ue){me({loading:!1,message:"Para inventario 771, selecciona un archivo .xml.",type:"error"}),Y.target.value=null;return}if(se!=="771"&&!Fe){me({loading:!1,message:"Para inventario 772, selecciona un archivo .csv.",type:"error"}),Y.target.value=null;return}me({loading:!0,message:`Procesando inventario ${se}: ${ee.name}`,type:"info"});const Me=new FileReader;Me.onerror=()=>{me({loading:!1,message:"No se pudo leer el archivo.",type:"error"})},Me.onload=async $e=>{try{const Ye=String($e.target?.result||""),Ve=se==="771"?await ze({text:Ye}):await Gt({text:Ye,type:se}),Ke=Ve?.importedCount??0,nt=Ve?.visibleCountForType??0,qe=Ke>0&&nt===0&&gu==="supabase"&&Qs?"Import datos pero no se pueden listar. Revisa RLS/policies en Supabase para `medications` (SELECT/ALL para `anon`).":"";me({loading:!1,message:`Inventario ${se}: ${Ke} medicamentos importados/actualizados.${qe?` ${qe}`:""}`,type:"success"}),window.setTimeout(()=>me({loading:!1,message:"",type:""}),4e3)}catch(Ye){const Ve=Ye?.message?String(Ye.message):"",nt=Ve.includes("invalid input syntax for type integer")?"Tu base de datos en Supabase tiene `stock`/`min_stock` como INTEGER. Ejecuta `supabase/schema.sql` (ALTER COLUMN a NUMERIC) y vuelve a intentar.":"";me({loading:!1,message:nt?`${Ve}. ${nt}`:Ve||`Error al procesar/guardar el ${se==="771"?"XML":"CSV"}.`,type:"error"})}},Me.readAsText(ee),Y.target.value=null},Gn=async Y=>{const ee=String(Y||g||"772");if(!(ee==="total"||!window.confirm(`Desea eliminar toda la carga del inventario ${ee}? Esta accin no se puede deshacer.`)))try{me({loading:!0,message:`Eliminando inventario ${ee}...`,type:"info"}),await At.clearMedicationsByInventoryType?.(ee),await B(),me({loading:!1,message:`Inventario ${ee} eliminado.`,type:"success"}),window.setTimeout(()=>me({loading:!1,message:"",type:""}),4e3)}catch(Oe){me({loading:!1,message:Oe?.message?String(Oe.message):"No se pudo eliminar el inventario.",type:"error"})}},Nn=Y=>String(Y||"").replace(/\.[^/.]+$/,"").trim()||"Mes sin nombre",Qa=Y=>{const ee=Y.target.files?.[0];if(!ee)return;const se=Nn(ee.name);V({loading:!0,message:`Procesando: ${ee.name}`,type:"info"});const Oe=new FileReader;Oe.onerror=()=>{V({loading:!1,message:"No se pudo leer el archivo.",type:"error"})},Oe.onload=async Ue=>{try{const Fe=String(Ue.target?.result||""),Me=Qx(Fe),$e=Ge=>(Ge||[]).some(Xe=>/codigo|siges|medicamento|consumo|costo/i.test(String(Xe||""))),Ye=Ge=>{const Xe=String(Ge??"").trim();if(!Xe)return 0;const Ze=Xe.includes(",")&&Xe.includes(".")?Xe.replace(/,/g,""):Xe.includes(",")&&!Xe.includes(".")?Xe.replace(/,/g,"."):Xe,pt=Number.parseFloat(Ze.replace(/\s+/g,""));return Number.isFinite(pt)?pt:0},Ke=($e(Me[0])?Me.slice(1):Me).map(Ge=>{const Xe=String(Ge?.[0]??"").trim(),Ze=String(Ge?.[1]??"").trim(),pt=Ye(Ge?.[2]),rt=Ye(Ge?.[3]);return!Xe||!Ze?null:{id:globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():String(Date.now())+Math.random(),siges_code:Xe,medication_name:Ze,quantity:pt,cost:rt}}).filter(Boolean),nt=await At.saveMonthlyBatch({id:globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():String(Date.now()),label:se,items:Ke}),qe=await At.getMonthlyBatches();xe(qe??[]),mt(nt?.id??null),V({loading:!1,message:`Mes "${se}": ${Ke.length} registros importados.`,type:"success"}),window.setTimeout(()=>V({loading:!1,message:"",type:""}),4e3)}catch(Fe){V({loading:!1,message:Fe?.message?String(Fe.message):"Error al procesar/guardar el CSV.",type:"error"})}},Oe.readAsText(ee),Y.target.value=null},qn=async()=>{try{V({loading:!0,message:"Sincronizando consumos...",type:"info"});const ee=(await At.getMonthlyBatches()??[]).map($e=>({...$e,id:$e?.id!=null?String($e.id):$e.id}));xe(ee);const se=J!=null?String(J):null,Ue=se&&ee.some($e=>$e.id===se)?se:ee?.[0]?.id??null;mt(Ue);const Fe=gu==="supabase"&&Qs?`supabase${mu?` (${mu})`:""}`:`local${Qs?" (Supabase disponible pero no seleccionado)":" (Supabase no configurado)"}`,Me=ee.length===0&&gu==="supabase"&&Qs?"Si en Supabase ves meses cargados, revisa RLS/policies para `anon` (SELECT en `monthly_batches`).":ee.length===0?"Si tus consumos estn en Supabase, configura `VITE_SUPABASE_URL` y `VITE_SUPABASE_ANON_KEY` y usa `VITE_DATA_PROVIDER=supabase`.":"";V({loading:!1,message:`Sincronizado (${Fe}): ${ee.length} meses encontrados.${Me?` ${Me}`:""}`,type:"success"}),window.setTimeout(()=>V({loading:!1,message:"",type:""}),4e3)}catch(Y){V({loading:!1,message:Y?.message?String(Y.message):"No se pudieron sincronizar los consumos.",type:"error"})}},Kr=async()=>{try{me({loading:!0,message:"Sincronizando inventarios...",type:"info"});const Y=await At.getMedications()??[];u(Y);const ee=Y.reduce((Oe,Ue)=>{const Fe=String(Ue.inventory_type||"772");return Oe[Fe]=(Oe[Fe]||0)+1,Oe},{771:0,772:0}),se=gu==="supabase"&&Qs?`supabase${mu?` (${mu})`:""}`:"local";me({loading:!1,message:`Sincronizado (${se}): 771=${ee[771]||0}, 772=${ee[772]||0}.`,type:"success"}),window.setTimeout(()=>me({loading:!1,message:"",type:""}),4e3)}catch(Y){me({loading:!1,message:Y?.message?String(Y.message):"No se pudieron sincronizar los inventarios.",type:"error"})}};return w.jsxs("div",{className:"flex h-screen bg-slate-50 font-sans text-slate-900 overflow-hidden",children:[w.jsx(vE,{activeTab:r,isSidebarOpen:s,onSelectTab:a,onToggleSidebar:()=>l(Y=>!Y)}),w.jsxs("main",{className:"flex-1 overflow-y-auto p-8",children:[w.jsx(xE,{activeTab:r,onNewMedication:D}),L.message&&w.jsxs("div",{className:`mb-6 p-3 rounded-lg text-xs flex items-center justify-between gap-3 ${L.type==="error"?"bg-red-50 text-red-700 border border-red-100":"bg-blue-50 text-blue-700 border border-blue-100"}`,children:[w.jsx("span",{children:L.message}),w.jsx("button",{type:"button",onClick:()=>A({loading:!1,message:"",type:""}),className:"text-[11px] font-bold hover:underline",children:"Cerrar"})]}),r==="catalog"&&w.jsx(_E,{medications:c,excelStatus:q,fileInputRef:K,onChooseFile:()=>K.current?.click(),onDownloadTemplate:zE,onFileChange:qt,onEditMedication:F,onDeleteMedication:fe,onClearCatalog:_e}),r==="dashboard"&&w.jsx(TE,{stats:La,consumptions:ae[0]?.items||[],lowStockItems:er,onViewAllConsumptions:()=>a("consumption-monthly"),onEditMedication:F}),r==="inventory"&&w.jsx(kE,{inventoryType:g,onInventoryTypeChange:Y=>{x(Y),d(""),k(ee=>({...ee,[String(Y||"772")]:1})),me({loading:!1,message:"",type:""})},inventoryStatus:Z,fileInputRef:ne,onChooseFile:()=>ne.current?.click(),onFileChange:Sa,onDownloadTemplate:tr,onRefresh:Kr,canClear:String(g||"772")!=="total"&&rl>0,onClearInventory:Gn,hideNoMovement:v,canToggleHideNoMovement:Hn,onToggleHideNoMovement:()=>{_(Y=>!Y),k(Y=>({...Y,total:1}))},search:h,onSearchChange:Y=>{d(Y),k(ee=>({...ee,[String(g||"772")]:1}))},items:tl,totalItems:cr.length,page:ui,pageSize:b,onPageChange:Y=>{const ee=Math.max(1,Math.ceil(cr.length/(b||1))),se=Math.min(Math.max(Number(Y)||1,1),ee);k(Oe=>({...Oe,[String(g||"772")]:se}))},onPageSizeChange:Y=>{y(Y),k(ee=>({...ee,[String(g||"772")]:1}))}}),r==="consumption-monthly"&&w.jsx(CE,{months:ae,selectedMonthId:J,onSelectMonth:mt,monthlyStatus:Ae,fileInputRef:Re,onChooseFile:()=>Re.current?.click(),onFileChange:Qa,onDownloadTemplate:HE,onRefresh:qn}),r==="consumption-summary"&&w.jsx(EE,{months:ae,onRefresh:qn,status:Ae}),r==="order-request"&&w.jsx(RE,{medications:c,months:ae,tertiaryPackaging:M,medicationCategories:bt,inventoryStatus:Z,monthlyStatus:Ae,onRefreshInventories:Kr,onRefreshConsumptions:qn}),r==="calendar"&&w.jsx(BE,{status:Ja,entries:xa,onRefresh:ba,onSave:bs}),r==="tertiary-packaging"&&w.jsx(DE,{status:N,fileInputRef:I,onChooseFile:()=>I.current?.click(),onFileChange:Vn,onDownloadTemplate:al,onRefresh:_s,canClear:(M??[]).length>0,onClear:fi,search:te,onSearchChange:Y=>{pe(Y),ve(1)},items:z,totalItems:C.length,page:Ee,pageSize:Te,onPageChange:Y=>{const ee=Math.max(1,Math.ceil(C.length/(Te||1))),se=Math.min(Math.max(Number(Y)||1,1),ee);ve(se)},onPageSizeChange:Y=>{tt(Y),ve(1)}}),r==="categories"&&w.jsx(FE,{status:Rt,fileInputRef:G,onChooseFile:()=>G.current?.click(),onFileChange:sl,onDownloadTemplate:nl,onRefresh:ws,canClear:(bt??[]).length>0,onClear:Ss,onEdit:$n,onDelete:xo,search:Pe,onSearchChange:Y=>{Zt(Y),Hr(1)},items:hi,totalItems:xn.length,page:Ar,pageSize:$r,onPageChange:Y=>{const ee=Math.max(1,Math.ceil(xn.length/($r||1))),se=Math.min(Math.max(Number(Y)||1,1),ee);Hr(se)},onPageSizeChange:Y=>{zn(Y),Hr(1)}}),r==="alerts"&&w.jsx(yE,{lowStockItems:er,onEditMedication:F})]}),R&&w.jsx(pE,{editingMed:j,onClose:()=>T(!1),onSubmit:H})]})}function OM(){return w.jsx(NM,{})}AS.createRoot(document.getElementById("root")).render(w.jsx(Ie.StrictMode,{children:w.jsx(OM,{})}));
