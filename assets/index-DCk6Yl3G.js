(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function r(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(s){if(s.ep)return;s.ep=!0;const l=r(s);fetch(s.href,l)}})();var ld={exports:{}},ac={};var Mx;function xS(){if(Mx)return ac;Mx=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function r(a,s,l){var c=null;if(l!==void 0&&(c=""+l),s.key!==void 0&&(c=""+s.key),"key"in s){l={};for(var u in s)u!=="key"&&(l[u]=s[u])}else l=s;return s=l.ref,{$$typeof:e,type:a,key:c,ref:s!==void 0?s:null,props:l}}return ac.Fragment=t,ac.jsx=r,ac.jsxs=r,ac}var Lx;function vS(){return Lx||(Lx=1,ld.exports=xS()),ld.exports}var w=vS(),od={exports:{}},mt={};var Ix;function yS(){if(Ix)return mt;Ix=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),c=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),x=Symbol.for("react.activity"),v=Symbol.iterator;function _(L){return L===null||typeof L!="object"?null:(L=v&&L[v]||L["@@iterator"],typeof L=="function"?L:null)}var b={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,S={};function k(L,N,V){this.props=L,this.context=N,this.refs=S,this.updater=V||b}k.prototype.isReactComponent={},k.prototype.setState=function(L,N){if(typeof L!="object"&&typeof L!="function"&&L!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,L,N,"setState")},k.prototype.forceUpdate=function(L){this.updater.enqueueForceUpdate(this,L,"forceUpdate")};function O(){}O.prototype=k.prototype;function T(L,N,V){this.props=L,this.context=N,this.refs=S,this.updater=V||b}var j=T.prototype=new O;j.constructor=T,y(j,k.prototype),j.isPureReactComponent=!0;var X=Array.isArray;function I(){}var C={H:null,A:null,T:null,S:null},K=Object.prototype.hasOwnProperty;function q(L,N,V){var M=V.ref;return{$$typeof:e,type:L,key:N,ref:M!==void 0?M:null,props:V}}function oe(L,N){return q(L.type,N,L.props)}function ee(L){return typeof L=="object"&&L!==null&&L.$$typeof===e}function Z(L){var N={"=":"=0",":":"=2"};return"$"+L.replace(/[=:]/g,function(V){return N[V]})}var xe=/\/+/g;function Ce(L,N){return typeof L=="object"&&L!==null&&L.key!=null?Z(""+L.key):N.toString(36)}function Se(L){switch(L.status){case"fulfilled":return L.value;case"rejected":throw L.reason;default:switch(typeof L.status=="string"?L.then(I,I):(L.status="pending",L.then(function(N){L.status==="pending"&&(L.status="fulfilled",L.value=N)},function(N){L.status==="pending"&&(L.status="rejected",L.reason=N)})),L.status){case"fulfilled":return L.value;case"rejected":throw L.reason}}throw L}function G(L,N,V,M,z){var te=typeof L;(te==="undefined"||te==="boolean")&&(L=null);var ge=!1;if(L===null)ge=!0;else switch(te){case"bigint":case"string":case"number":ge=!0;break;case"object":switch(L.$$typeof){case e:case t:ge=!0;break;case g:return ge=L._init,G(ge(L._payload),N,V,M,z)}}if(ge)return z=z(L),ge=M===""?"."+Ce(L,0):M,X(z)?(V="",ge!=null&&(V=ge.replace(xe,"$&/")+"/"),G(z,N,V,"",function(Ae){return Ae})):z!=null&&(ee(z)&&(z=oe(z,V+(z.key==null||L&&L.key===z.key?"":(""+z.key).replace(xe,"$&/")+"/")+ge)),N.push(z)),1;ge=0;var Ee=M===""?".":M+":";if(X(L))for(var ye=0;ye<L.length;ye++)M=L[ye],te=Ee+Ce(M,ye),ge+=G(M,N,V,te,z);else if(ye=_(L),typeof ye=="function")for(L=ye.call(L),ye=0;!(M=L.next()).done;)M=M.value,te=Ee+Ce(M,ye++),ge+=G(M,N,V,te,z);else if(te==="object"){if(typeof L.then=="function")return G(Se(L),N,V,M,z);throw N=String(L),Error("Objects are not valid as a React child (found: "+(N==="[object Object]"?"object with keys {"+Object.keys(L).join(", ")+"}":N)+"). If you meant to render a collection of children, use an array instead.")}return ge}function ne(L,N,V){if(L==null)return L;var M=[],z=0;return G(L,M,"","",function(te){return N.call(V,te,z++)}),M}function pe(L){if(L._status===-1){var N=L._result;N=N(),N.then(function(V){(L._status===0||L._status===-1)&&(L._status=1,L._result=V)},function(V){(L._status===0||L._status===-1)&&(L._status=2,L._result=V)}),L._status===-1&&(L._status=0,L._result=N)}if(L._status===1)return L._result.default;throw L._result}var J=typeof reportError=="function"?reportError:function(L){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var N=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof L=="object"&&L!==null&&typeof L.message=="string"?String(L.message):String(L),error:L});if(!window.dispatchEvent(N))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",L);return}console.error(L)},be={map:ne,forEach:function(L,N,V){ne(L,function(){N.apply(this,arguments)},V)},count:function(L){var N=0;return ne(L,function(){N++}),N},toArray:function(L){return ne(L,function(N){return N})||[]},only:function(L){if(!ee(L))throw Error("React.Children.only expected to receive a single React element child.");return L}};return mt.Activity=x,mt.Children=be,mt.Component=k,mt.Fragment=r,mt.Profiler=s,mt.PureComponent=T,mt.StrictMode=a,mt.Suspense=h,mt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=C,mt.__COMPILER_RUNTIME={__proto__:null,c:function(L){return C.H.useMemoCache(L)}},mt.cache=function(L){return function(){return L.apply(null,arguments)}},mt.cacheSignal=function(){return null},mt.cloneElement=function(L,N,V){if(L==null)throw Error("The argument must be a React element, but you passed "+L+".");var M=y({},L.props),z=L.key;if(N!=null)for(te in N.key!==void 0&&(z=""+N.key),N)!K.call(N,te)||te==="key"||te==="__self"||te==="__source"||te==="ref"&&N.ref===void 0||(M[te]=N[te]);var te=arguments.length-2;if(te===1)M.children=V;else if(1<te){for(var ge=Array(te),Ee=0;Ee<te;Ee++)ge[Ee]=arguments[Ee+2];M.children=ge}return q(L.type,z,M)},mt.createContext=function(L){return L={$$typeof:c,_currentValue:L,_currentValue2:L,_threadCount:0,Provider:null,Consumer:null},L.Provider=L,L.Consumer={$$typeof:l,_context:L},L},mt.createElement=function(L,N,V){var M,z={},te=null;if(N!=null)for(M in N.key!==void 0&&(te=""+N.key),N)K.call(N,M)&&M!=="key"&&M!=="__self"&&M!=="__source"&&(z[M]=N[M]);var ge=arguments.length-2;if(ge===1)z.children=V;else if(1<ge){for(var Ee=Array(ge),ye=0;ye<ge;ye++)Ee[ye]=arguments[ye+2];z.children=Ee}if(L&&L.defaultProps)for(M in ge=L.defaultProps,ge)z[M]===void 0&&(z[M]=ge[M]);return q(L,te,z)},mt.createRef=function(){return{current:null}},mt.forwardRef=function(L){return{$$typeof:u,render:L}},mt.isValidElement=ee,mt.lazy=function(L){return{$$typeof:g,_payload:{_status:-1,_result:L},_init:pe}},mt.memo=function(L,N){return{$$typeof:d,type:L,compare:N===void 0?null:N}},mt.startTransition=function(L){var N=C.T,V={};C.T=V;try{var M=L(),z=C.S;z!==null&&z(V,M),typeof M=="object"&&M!==null&&typeof M.then=="function"&&M.then(I,J)}catch(te){J(te)}finally{N!==null&&V.types!==null&&(N.types=V.types),C.T=N}},mt.unstable_useCacheRefresh=function(){return C.H.useCacheRefresh()},mt.use=function(L){return C.H.use(L)},mt.useActionState=function(L,N,V){return C.H.useActionState(L,N,V)},mt.useCallback=function(L,N){return C.H.useCallback(L,N)},mt.useContext=function(L){return C.H.useContext(L)},mt.useDebugValue=function(){},mt.useDeferredValue=function(L,N){return C.H.useDeferredValue(L,N)},mt.useEffect=function(L,N){return C.H.useEffect(L,N)},mt.useEffectEvent=function(L){return C.H.useEffectEvent(L)},mt.useId=function(){return C.H.useId()},mt.useImperativeHandle=function(L,N,V){return C.H.useImperativeHandle(L,N,V)},mt.useInsertionEffect=function(L,N){return C.H.useInsertionEffect(L,N)},mt.useLayoutEffect=function(L,N){return C.H.useLayoutEffect(L,N)},mt.useMemo=function(L,N){return C.H.useMemo(L,N)},mt.useOptimistic=function(L,N){return C.H.useOptimistic(L,N)},mt.useReducer=function(L,N,V){return C.H.useReducer(L,N,V)},mt.useRef=function(L){return C.H.useRef(L)},mt.useState=function(L){return C.H.useState(L)},mt.useSyncExternalStore=function(L,N,V){return C.H.useSyncExternalStore(L,N,V)},mt.useTransition=function(){return C.H.useTransition()},mt.version="19.2.3",mt}var Bx;function im(){return Bx||(Bx=1,od.exports=yS()),od.exports}var ze=im(),cd={exports:{}},nc={},ud={exports:{}},fd={};var jx;function _S(){return jx||(jx=1,(function(e){function t(G,ne){var pe=G.length;G.push(ne);e:for(;0<pe;){var J=pe-1>>>1,be=G[J];if(0<s(be,ne))G[J]=ne,G[pe]=be,pe=J;else break e}}function r(G){return G.length===0?null:G[0]}function a(G){if(G.length===0)return null;var ne=G[0],pe=G.pop();if(pe!==ne){G[0]=pe;e:for(var J=0,be=G.length,L=be>>>1;J<L;){var N=2*(J+1)-1,V=G[N],M=N+1,z=G[M];if(0>s(V,pe))M<be&&0>s(z,V)?(G[J]=z,G[M]=pe,J=M):(G[J]=V,G[N]=pe,J=N);else if(M<be&&0>s(z,pe))G[J]=z,G[M]=pe,J=M;else break e}}return ne}function s(G,ne){var pe=G.sortIndex-ne.sortIndex;return pe!==0?pe:G.id-ne.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var c=Date,u=c.now();e.unstable_now=function(){return c.now()-u}}var h=[],d=[],g=1,x=null,v=3,_=!1,b=!1,y=!1,S=!1,k=typeof setTimeout=="function"?setTimeout:null,O=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;function j(G){for(var ne=r(d);ne!==null;){if(ne.callback===null)a(d);else if(ne.startTime<=G)a(d),ne.sortIndex=ne.expirationTime,t(h,ne);else break;ne=r(d)}}function X(G){if(y=!1,j(G),!b)if(r(h)!==null)b=!0,I||(I=!0,Z());else{var ne=r(d);ne!==null&&Se(X,ne.startTime-G)}}var I=!1,C=-1,K=5,q=-1;function oe(){return S?!0:!(e.unstable_now()-q<K)}function ee(){if(S=!1,I){var G=e.unstable_now();q=G;var ne=!0;try{e:{b=!1,y&&(y=!1,O(C),C=-1),_=!0;var pe=v;try{t:{for(j(G),x=r(h);x!==null&&!(x.expirationTime>G&&oe());){var J=x.callback;if(typeof J=="function"){x.callback=null,v=x.priorityLevel;var be=J(x.expirationTime<=G);if(G=e.unstable_now(),typeof be=="function"){x.callback=be,j(G),ne=!0;break t}x===r(h)&&a(h),j(G)}else a(h);x=r(h)}if(x!==null)ne=!0;else{var L=r(d);L!==null&&Se(X,L.startTime-G),ne=!1}}break e}finally{x=null,v=pe,_=!1}ne=void 0}}finally{ne?Z():I=!1}}}var Z;if(typeof T=="function")Z=function(){T(ee)};else if(typeof MessageChannel<"u"){var xe=new MessageChannel,Ce=xe.port2;xe.port1.onmessage=ee,Z=function(){Ce.postMessage(null)}}else Z=function(){k(ee,0)};function Se(G,ne){C=k(function(){G(e.unstable_now())},ne)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(G){G.callback=null},e.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):K=0<G?Math.floor(1e3/G):5},e.unstable_getCurrentPriorityLevel=function(){return v},e.unstable_next=function(G){switch(v){case 1:case 2:case 3:var ne=3;break;default:ne=v}var pe=v;v=ne;try{return G()}finally{v=pe}},e.unstable_requestPaint=function(){S=!0},e.unstable_runWithPriority=function(G,ne){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var pe=v;v=G;try{return ne()}finally{v=pe}},e.unstable_scheduleCallback=function(G,ne,pe){var J=e.unstable_now();switch(typeof pe=="object"&&pe!==null?(pe=pe.delay,pe=typeof pe=="number"&&0<pe?J+pe:J):pe=J,G){case 1:var be=-1;break;case 2:be=250;break;case 5:be=1073741823;break;case 4:be=1e4;break;default:be=5e3}return be=pe+be,G={id:g++,callback:ne,priorityLevel:G,startTime:pe,expirationTime:be,sortIndex:-1},pe>J?(G.sortIndex=pe,t(d,G),r(h)===null&&G===r(d)&&(y?(O(C),C=-1):y=!0,Se(X,pe-J))):(G.sortIndex=be,t(h,G),b||_||(b=!0,I||(I=!0,Z()))),G},e.unstable_shouldYield=oe,e.unstable_wrapCallback=function(G){var ne=v;return function(){var pe=v;v=ne;try{return G.apply(this,arguments)}finally{v=pe}}}})(fd)),fd}var Ux;function wS(){return Ux||(Ux=1,ud.exports=_S()),ud.exports}var hd={exports:{}},la={};var Px;function bS(){if(Px)return la;Px=1;var e=im();function t(h){var d="https://react.dev/errors/"+h;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)d+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+h+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var a={d:{f:r,r:function(){throw Error(t(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},s=Symbol.for("react.portal");function l(h,d,g){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:x==null?null:""+x,children:h,containerInfo:d,implementation:g}}var c=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(h,d){if(h==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return la.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,la.createPortal=function(h,d){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(t(299));return l(h,d,null,g)},la.flushSync=function(h){var d=c.T,g=a.p;try{if(c.T=null,a.p=2,h)return h()}finally{c.T=d,a.p=g,a.d.f()}},la.preconnect=function(h,d){typeof h=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,a.d.C(h,d))},la.prefetchDNS=function(h){typeof h=="string"&&a.d.D(h)},la.preinit=function(h,d){if(typeof h=="string"&&d&&typeof d.as=="string"){var g=d.as,x=u(g,d.crossOrigin),v=typeof d.integrity=="string"?d.integrity:void 0,_=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;g==="style"?a.d.S(h,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:x,integrity:v,fetchPriority:_}):g==="script"&&a.d.X(h,{crossOrigin:x,integrity:v,fetchPriority:_,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},la.preinitModule=function(h,d){if(typeof h=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var g=u(d.as,d.crossOrigin);a.d.M(h,{crossOrigin:g,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&a.d.M(h)},la.preload=function(h,d){if(typeof h=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var g=d.as,x=u(g,d.crossOrigin);a.d.L(h,g,{crossOrigin:x,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},la.preloadModule=function(h,d){if(typeof h=="string")if(d){var g=u(d.as,d.crossOrigin);a.d.m(h,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:g,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else a.d.m(h)},la.requestFormReset=function(h){a.d.r(h)},la.unstable_batchedUpdates=function(h,d){return h(d)},la.useFormState=function(h,d,g){return c.H.useFormState(h,d,g)},la.useFormStatus=function(){return c.H.useHostTransitionStatus()},la.version="19.2.3",la}var zx;function SS(){if(zx)return hd.exports;zx=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),hd.exports=bS(),hd.exports}var Hx;function ES(){if(Hx)return nc;Hx=1;var e=wS(),t=im(),r=SS();function a(n){var i="https://react.dev/errors/"+n;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)i+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+n+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function l(n){var i=n,o=n;if(n.alternate)for(;i.return;)i=i.return;else{n=i;do i=n,(i.flags&4098)!==0&&(o=i.return),n=i.return;while(n)}return i.tag===3?o:null}function c(n){if(n.tag===13){var i=n.memoizedState;if(i===null&&(n=n.alternate,n!==null&&(i=n.memoizedState)),i!==null)return i.dehydrated}return null}function u(n){if(n.tag===31){var i=n.memoizedState;if(i===null&&(n=n.alternate,n!==null&&(i=n.memoizedState)),i!==null)return i.dehydrated}return null}function h(n){if(l(n)!==n)throw Error(a(188))}function d(n){var i=n.alternate;if(!i){if(i=l(n),i===null)throw Error(a(188));return i!==n?null:n}for(var o=n,f=i;;){var m=o.return;if(m===null)break;var p=m.alternate;if(p===null){if(f=m.return,f!==null){o=f;continue}break}if(m.child===p.child){for(p=m.child;p;){if(p===o)return h(m),n;if(p===f)return h(m),i;p=p.sibling}throw Error(a(188))}if(o.return!==f.return)o=m,f=p;else{for(var E=!1,R=m.child;R;){if(R===o){E=!0,o=m,f=p;break}if(R===f){E=!0,f=m,o=p;break}R=R.sibling}if(!E){for(R=p.child;R;){if(R===o){E=!0,o=p,f=m;break}if(R===f){E=!0,f=p,o=m;break}R=R.sibling}if(!E)throw Error(a(189))}}if(o.alternate!==f)throw Error(a(190))}if(o.tag!==3)throw Error(a(188));return o.stateNode.current===o?n:i}function g(n){var i=n.tag;if(i===5||i===26||i===27||i===6)return n;for(n=n.child;n!==null;){if(i=g(n),i!==null)return i;n=n.sibling}return null}var x=Object.assign,v=Symbol.for("react.element"),_=Symbol.for("react.transitional.element"),b=Symbol.for("react.portal"),y=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),k=Symbol.for("react.profiler"),O=Symbol.for("react.consumer"),T=Symbol.for("react.context"),j=Symbol.for("react.forward_ref"),X=Symbol.for("react.suspense"),I=Symbol.for("react.suspense_list"),C=Symbol.for("react.memo"),K=Symbol.for("react.lazy"),q=Symbol.for("react.activity"),oe=Symbol.for("react.memo_cache_sentinel"),ee=Symbol.iterator;function Z(n){return n===null||typeof n!="object"?null:(n=ee&&n[ee]||n["@@iterator"],typeof n=="function"?n:null)}var xe=Symbol.for("react.client.reference");function Ce(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===xe?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case y:return"Fragment";case k:return"Profiler";case S:return"StrictMode";case X:return"Suspense";case I:return"SuspenseList";case q:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case b:return"Portal";case T:return n.displayName||"Context";case O:return(n._context.displayName||"Context")+".Consumer";case j:var i=n.render;return n=n.displayName,n||(n=i.displayName||i.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case C:return i=n.displayName||null,i!==null?i:Ce(n.type)||"Memo";case K:i=n._payload,n=n._init;try{return Ce(n(i))}catch{}}return null}var Se=Array.isArray,G=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ne=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,pe={pending:!1,data:null,method:null,action:null},J=[],be=-1;function L(n){return{current:n}}function N(n){0>be||(n.current=J[be],J[be]=null,be--)}function V(n,i){be++,J[be]=n.current,n.current=i}var M=L(null),z=L(null),te=L(null),ge=L(null);function Ee(n,i){switch(V(te,i),V(z,n),V(M,null),i.nodeType){case 9:case 11:n=(n=i.documentElement)&&(n=n.namespaceURI)?ax(n):0;break;default:if(n=i.tagName,i=i.namespaceURI)i=ax(i),n=nx(i,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}N(M),V(M,n)}function ye(){N(M),N(z),N(te)}function Ae(n){n.memoizedState!==null&&V(ge,n);var i=M.current,o=nx(i,n.type);i!==o&&(V(z,n),V(M,o))}function tt(n){z.current===n&&(N(M),N(z)),ge.current===n&&(N(ge),Zo._currentValue=pe)}var P,St;function at(n){if(P===void 0)try{throw Error()}catch(o){var i=o.stack.trim().match(/\n( *(at )?)/);P=i&&i[1]||"",St=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+P+n+St}var Et=!1;function dt(n,i){if(!n||Et)return"";Et=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var f={DetermineComponentFrameRoot:function(){try{if(i){var ke=function(){throw Error()};if(Object.defineProperty(ke.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ke,[])}catch(me){var de=me}Reflect.construct(n,[],ke)}else{try{ke.call()}catch(me){de=me}n.call(ke.prototype)}}else{try{throw Error()}catch(me){de=me}(ke=n())&&typeof ke.catch=="function"&&ke.catch(function(){})}}catch(me){if(me&&de&&typeof me.stack=="string")return[me.stack,de.stack]}return[null,null]}};f.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(f.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(f.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var p=f.DetermineComponentFrameRoot(),E=p[0],R=p[1];if(E&&R){var W=E.split(`
`),ue=R.split(`
`);for(m=f=0;f<W.length&&!W[f].includes("DetermineComponentFrameRoot");)f++;for(;m<ue.length&&!ue[m].includes("DetermineComponentFrameRoot");)m++;if(f===W.length||m===ue.length)for(f=W.length-1,m=ue.length-1;1<=f&&0<=m&&W[f]!==ue[m];)m--;for(;1<=f&&0<=m;f--,m--)if(W[f]!==ue[m]){if(f!==1||m!==1)do if(f--,m--,0>m||W[f]!==ue[m]){var we=`
`+W[f].replace(" at new "," at ");return n.displayName&&we.includes("<anonymous>")&&(we=we.replace("<anonymous>",n.displayName)),we}while(1<=f&&0<=m);break}}}finally{Et=!1,Error.prepareStackTrace=o}return(o=n?n.displayName||n.name:"")?at(o):""}function Be(n,i){switch(n.tag){case 26:case 27:case 5:return at(n.type);case 16:return at("Lazy");case 13:return n.child!==i&&i!==null?at("Suspense Fallback"):at("Suspense");case 19:return at("SuspenseList");case 0:case 15:return dt(n.type,!1);case 11:return dt(n.type.render,!1);case 1:return dt(n.type,!0);case 31:return at("Activity");default:return""}}function Vt(n){try{var i="",o=null;do i+=Be(n,o),o=n,n=n.return;while(n);return i}catch(f){return`
Error generating stack: `+f.message+`
`+f.stack}}var br=Object.prototype.hasOwnProperty,na=e.unstable_scheduleCallback,pa=e.unstable_cancelCallback,Xr=e.unstable_shouldYield,Ya=e.unstable_requestPaint,Mt=e.unstable_now,sa=e.unstable_getCurrentPriorityLevel,zr=e.unstable_ImmediatePriority,Ja=e.unstable_UserBlockingPriority,cr=e.unstable_NormalPriority,mr=e.unstable_LowPriority,gt=e.unstable_IdlePriority,Gt=e.log,ia=e.unstable_setDisableYieldValue,Rt=null,rr=null;function Ma(n){if(typeof Gt=="function"&&ia(n),rr&&typeof rr.setStrictMode=="function")try{rr.setStrictMode(Rt,n)}catch{}}var Wr=Math.clz32?Math.clz32:el,fo=Math.log,Zi=Math.LN2;function el(n){return n>>>=0,n===0?32:31-(fo(n)/Zi|0)|0}var Hn=256,vs=262144,ys=4194304;function wa(n){var i=n&42;if(i!==0)return i;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return n&261888;case 262144:case 524288:case 1048576:case 2097152:return n&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function _s(n,i,o){var f=n.pendingLanes;if(f===0)return 0;var m=0,p=n.suspendedLanes,E=n.pingedLanes;n=n.warmLanes;var R=f&134217727;return R!==0?(f=R&~p,f!==0?m=wa(f):(E&=R,E!==0?m=wa(E):o||(o=R&~n,o!==0&&(m=wa(o))))):(R=f&~p,R!==0?m=wa(R):E!==0?m=wa(E):o||(o=f&~n,o!==0&&(m=wa(o)))),m===0?0:i!==0&&i!==m&&(i&p)===0&&(p=m&-m,o=i&-i,p>=o||p===32&&(o&4194048)!==0)?i:m}function $n(n,i){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&i)===0}function ho(n,i){switch(n){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function tl(){var n=ys;return ys<<=1,(ys&62914560)===0&&(ys=4194304),n}function ci(n){for(var i=[],o=0;31>o;o++)i.push(n);return i}function Vn(n,i){n.pendingLanes|=i,i!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function mo(n,i,o,f,m,p){var E=n.pendingLanes;n.pendingLanes=o,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=o,n.entangledLanes&=o,n.errorRecoveryDisabledLanes&=o,n.shellSuspendCounter=0;var R=n.entanglements,W=n.expirationTimes,ue=n.hiddenUpdates;for(o=E&~o;0<o;){var we=31-Wr(o),ke=1<<we;R[we]=0,W[we]=-1;var de=ue[we];if(de!==null)for(ue[we]=null,we=0;we<de.length;we++){var me=de[we];me!==null&&(me.lane&=-536870913)}o&=~ke}f!==0&&Nn(n,f,0),p!==0&&m===0&&n.tag!==0&&(n.suspendedLanes|=p&~(E&~i))}function Nn(n,i,o){n.pendingLanes|=i,n.suspendedLanes&=~i;var f=31-Wr(i);n.entangledLanes|=i,n.entanglements[f]=n.entanglements[f]|1073741824|o&261930}function ws(n,i){var o=n.entangledLanes|=i;for(n=n.entanglements;o;){var f=31-Wr(o),m=1<<f;m&i|n[f]&i&&(n[f]|=i),o&=~m}}function On(n,i){var o=i&-i;return o=(o&42)!==0?1:ui(o),(o&(n.suspendedLanes|i))!==0?0:o}function ui(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function fi(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function A(){var n=ne.p;return n!==0?n:(n=window.event,n===void 0?32:Ax(n.type))}function U(n,i){var o=ne.p;try{return ne.p=n,i()}finally{ne.p=o}}var D=Math.random().toString(36).slice(2),F="__reactFiber$"+D,B="__reactProps$"+D,H="__reactContainer$"+D,ie="__reactEvents$"+D,_e="__reactListeners$"+D,se="__reactHandles$"+D,fe="__reactResources$"+D,he="__reactMarker$"+D;function Oe(n){delete n[F],delete n[B],delete n[ie],delete n[_e],delete n[se]}function Fe(n){var i=n[F];if(i)return i;for(var o=n.parentNode;o;){if(i=o[H]||o[F]){if(o=i.alternate,i.child!==null||o!==null&&o.child!==null)for(n=fx(n);n!==null;){if(o=n[F])return o;n=fx(n)}return i}n=o,o=n.parentNode}return null}function He(n){if(n=n[F]||n[H]){var i=n.tag;if(i===5||i===6||i===13||i===31||i===26||i===27||i===3)return n}return null}function Re(n){var i=n.tag;if(i===5||i===26||i===27||i===6)return n.stateNode;throw Error(a(33))}function je(n){var i=n[fe];return i||(i=n[fe]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function We(n){n[he]=!0}var qt=new Set,Xt={};function er(n,i){ba(n,i),ba(n+"Capture",i)}function ba(n,i){for(Xt[n]=i,n=0;n<i.length;n++)qt.add(i[n])}var pn=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),xn={},Y={};function re(n){return br.call(Y,n)?!0:br.call(xn,n)?!1:pn.test(n)?Y[n]=!0:(xn[n]=!0,!1)}function le(n,i,o){if(re(i))if(o===null)n.removeAttribute(i);else{switch(typeof o){case"undefined":case"function":case"symbol":n.removeAttribute(i);return;case"boolean":var f=i.toLowerCase().slice(0,5);if(f!=="data-"&&f!=="aria-"){n.removeAttribute(i);return}}n.setAttribute(i,""+o)}}function De(n,i,o){if(o===null)n.removeAttribute(i);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(i);return}n.setAttribute(i,""+o)}}function Ie(n,i,o,f){if(f===null)n.removeAttribute(o);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(o);return}n.setAttributeNS(i,o,""+f)}}function Ue(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function $e(n){var i=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function Qe(n,i,o){var f=Object.getOwnPropertyDescriptor(n.constructor.prototype,i);if(!n.hasOwnProperty(i)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var m=f.get,p=f.set;return Object.defineProperty(n,i,{configurable:!0,get:function(){return m.call(this)},set:function(E){o=""+E,p.call(this,E)}}),Object.defineProperty(n,i,{enumerable:f.enumerable}),{getValue:function(){return o},setValue:function(E){o=""+E},stopTracking:function(){n._valueTracker=null,delete n[i]}}}}function Ke(n){if(!n._valueTracker){var i=$e(n)?"checked":"value";n._valueTracker=Qe(n,i,""+n[i])}}function Ze(n){if(!n)return!1;var i=n._valueTracker;if(!i)return!0;var o=i.getValue(),f="";return n&&(f=$e(n)?n.checked?"true":"false":n.value),n=f,n!==o?(i.setValue(n),!0):!1}function qe(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var ut=/[\n"\\]/g;function Pe(n){return n.replace(ut,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function Ve(n,i,o,f,m,p,E,R){n.name="",E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"?n.type=E:n.removeAttribute("type"),i!=null?E==="number"?(i===0&&n.value===""||n.value!=i)&&(n.value=""+Ue(i)):n.value!==""+Ue(i)&&(n.value=""+Ue(i)):E!=="submit"&&E!=="reset"||n.removeAttribute("value"),i!=null?Ye(n,E,Ue(i)):o!=null?Ye(n,E,Ue(o)):f!=null&&n.removeAttribute("value"),m==null&&p!=null&&(n.defaultChecked=!!p),m!=null&&(n.checked=m&&typeof m!="function"&&typeof m!="symbol"),R!=null&&typeof R!="function"&&typeof R!="symbol"&&typeof R!="boolean"?n.name=""+Ue(R):n.removeAttribute("name")}function Ge(n,i,o,f,m,p,E,R){if(p!=null&&typeof p!="function"&&typeof p!="symbol"&&typeof p!="boolean"&&(n.type=p),i!=null||o!=null){if(!(p!=="submit"&&p!=="reset"||i!=null)){Ke(n);return}o=o!=null?""+Ue(o):"",i=i!=null?""+Ue(i):o,R||i===n.value||(n.value=i),n.defaultValue=i}f=f??m,f=typeof f!="function"&&typeof f!="symbol"&&!!f,n.checked=R?n.checked:!!f,n.defaultChecked=!!f,E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"&&(n.name=E),Ke(n)}function Ye(n,i,o){i==="number"&&qe(n.ownerDocument)===n||n.defaultValue===""+o||(n.defaultValue=""+o)}function pt(n,i,o,f){if(n=n.options,i){i={};for(var m=0;m<o.length;m++)i["$"+o[m]]=!0;for(o=0;o<n.length;o++)m=i.hasOwnProperty("$"+n[o].value),n[o].selected!==m&&(n[o].selected=m),m&&f&&(n[o].defaultSelected=!0)}else{for(o=""+Ue(o),i=null,m=0;m<n.length;m++){if(n[m].value===o){n[m].selected=!0,f&&(n[m].defaultSelected=!0);return}i!==null||n[m].disabled||(i=n[m])}i!==null&&(i.selected=!0)}}function et(n,i,o){if(i!=null&&(i=""+Ue(i),i!==n.value&&(n.value=i),o==null)){n.defaultValue!==i&&(n.defaultValue=i);return}n.defaultValue=o!=null?""+Ue(o):""}function gr(n,i,o,f){if(i==null){if(f!=null){if(o!=null)throw Error(a(92));if(Se(f)){if(1<f.length)throw Error(a(93));f=f[0]}o=f}o==null&&(o=""),i=o}o=Ue(i),n.defaultValue=o,f=n.textContent,f===o&&f!==""&&f!==null&&(n.value=f),Ke(n)}function Qt(n,i){if(i){var o=n.firstChild;if(o&&o===n.lastChild&&o.nodeType===3){o.nodeValue=i;return}}n.textContent=i}var Sa=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function bs(n,i,o){var f=i.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?f?n.setProperty(i,""):i==="float"?n.cssFloat="":n[i]="":f?n.setProperty(i,o):typeof o!="number"||o===0||Sa.has(i)?i==="float"?n.cssFloat=o:n[i]=(""+o).trim():n[i]=o+"px"}function Qc(n,i,o){if(i!=null&&typeof i!="object")throw Error(a(62));if(n=n.style,o!=null){for(var f in o)!o.hasOwnProperty(f)||i!=null&&i.hasOwnProperty(f)||(f.indexOf("--")===0?n.setProperty(f,""):f==="float"?n.cssFloat="":n[f]="");for(var m in i)f=i[m],i.hasOwnProperty(m)&&o[m]!==f&&bs(n,m,f)}else for(var p in i)i.hasOwnProperty(p)&&bs(n,p,i[p])}function go(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var dw=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),mw=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Zc(n){return mw.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}function Gn(){}var af=null;function nf(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var rl=null,al=null;function r1(n){var i=He(n);if(i&&(n=i.stateNode)){var o=n[B]||null;e:switch(n=i.stateNode,i.type){case"input":if(Ve(n,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),i=o.name,o.type==="radio"&&i!=null){for(o=n;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+Pe(""+i)+'"][type="radio"]'),i=0;i<o.length;i++){var f=o[i];if(f!==n&&f.form===n.form){var m=f[B]||null;if(!m)throw Error(a(90));Ve(f,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(i=0;i<o.length;i++)f=o[i],f.form===n.form&&Ze(f)}break e;case"textarea":et(n,o.value,o.defaultValue);break e;case"select":i=o.value,i!=null&&pt(n,!!o.multiple,i,!1)}}}var sf=!1;function a1(n,i,o){if(sf)return n(i,o);sf=!0;try{var f=n(i);return f}finally{if(sf=!1,(rl!==null||al!==null)&&(P0(),rl&&(i=rl,n=al,al=rl=null,r1(i),n)))for(i=0;i<n.length;i++)r1(n[i])}}function po(n,i){var o=n.stateNode;if(o===null)return null;var f=o[B]||null;if(f===null)return null;o=f[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(n=n.type,f=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!f;break e;default:n=!1}if(n)return null;if(o&&typeof o!="function")throw Error(a(231,i,typeof o));return o}var qn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),lf=!1;if(qn)try{var xo={};Object.defineProperty(xo,"passive",{get:function(){lf=!0}}),window.addEventListener("test",xo,xo),window.removeEventListener("test",xo,xo)}catch{lf=!1}var Ss=null,of=null,e0=null;function n1(){if(e0)return e0;var n,i=of,o=i.length,f,m="value"in Ss?Ss.value:Ss.textContent,p=m.length;for(n=0;n<o&&i[n]===m[n];n++);var E=o-n;for(f=1;f<=E&&i[o-f]===m[p-f];f++);return e0=m.slice(n,1<f?1-f:void 0)}function t0(n){var i=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&i===13&&(n=13)):n=i,n===10&&(n=13),32<=n||n===13?n:0}function r0(){return!0}function s1(){return!1}function Ea(n){function i(o,f,m,p,E){this._reactName=o,this._targetInst=m,this.type=f,this.nativeEvent=p,this.target=E,this.currentTarget=null;for(var R in n)n.hasOwnProperty(R)&&(o=n[R],this[R]=o?o(p):p[R]);return this.isDefaultPrevented=(p.defaultPrevented!=null?p.defaultPrevented:p.returnValue===!1)?r0:s1,this.isPropagationStopped=s1,this}return x(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=r0)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=r0)},persist:function(){},isPersistent:r0}),i}var hi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},a0=Ea(hi),vo=x({},hi,{view:0,detail:0}),gw=Ea(vo),cf,uf,yo,n0=x({},vo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:hf,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==yo&&(yo&&n.type==="mousemove"?(cf=n.screenX-yo.screenX,uf=n.screenY-yo.screenY):uf=cf=0,yo=n),cf)},movementY:function(n){return"movementY"in n?n.movementY:uf}}),i1=Ea(n0),pw=x({},n0,{dataTransfer:0}),xw=Ea(pw),vw=x({},vo,{relatedTarget:0}),ff=Ea(vw),yw=x({},hi,{animationName:0,elapsedTime:0,pseudoElement:0}),_w=Ea(yw),ww=x({},hi,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),bw=Ea(ww),Sw=x({},hi,{data:0}),l1=Ea(Sw),Ew={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Tw={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},kw={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Aw(n){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(n):(n=kw[n])?!!i[n]:!1}function hf(){return Aw}var Cw=x({},vo,{key:function(n){if(n.key){var i=Ew[n.key]||n.key;if(i!=="Unidentified")return i}return n.type==="keypress"?(n=t0(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?Tw[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:hf,charCode:function(n){return n.type==="keypress"?t0(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?t0(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),Nw=Ea(Cw),Ow=x({},n0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),o1=Ea(Ow),Rw=x({},vo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:hf}),Dw=Ea(Rw),Fw=x({},hi,{propertyName:0,elapsedTime:0,pseudoElement:0}),Mw=Ea(Fw),Lw=x({},n0,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),Iw=Ea(Lw),Bw=x({},hi,{newState:0,oldState:0}),jw=Ea(Bw),Uw=[9,13,27,32],df=qn&&"CompositionEvent"in window,_o=null;qn&&"documentMode"in document&&(_o=document.documentMode);var Pw=qn&&"TextEvent"in window&&!_o,c1=qn&&(!df||_o&&8<_o&&11>=_o),u1=" ",f1=!1;function h1(n,i){switch(n){case"keyup":return Uw.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function d1(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var nl=!1;function zw(n,i){switch(n){case"compositionend":return d1(i);case"keypress":return i.which!==32?null:(f1=!0,u1);case"textInput":return n=i.data,n===u1&&f1?null:n;default:return null}}function Hw(n,i){if(nl)return n==="compositionend"||!df&&h1(n,i)?(n=n1(),e0=of=Ss=null,nl=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return c1&&i.locale!=="ko"?null:i.data;default:return null}}var $w={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function m1(n){var i=n&&n.nodeName&&n.nodeName.toLowerCase();return i==="input"?!!$w[n.type]:i==="textarea"}function g1(n,i,o,f){rl?al?al.push(f):al=[f]:rl=f,i=X0(i,"onChange"),0<i.length&&(o=new a0("onChange","change",null,o,f),n.push({event:o,listeners:i}))}var wo=null,bo=null;function Vw(n){Jp(n,0)}function s0(n){var i=Re(n);if(Ze(i))return n}function p1(n,i){if(n==="change")return i}var x1=!1;if(qn){var mf;if(qn){var gf="oninput"in document;if(!gf){var v1=document.createElement("div");v1.setAttribute("oninput","return;"),gf=typeof v1.oninput=="function"}mf=gf}else mf=!1;x1=mf&&(!document.documentMode||9<document.documentMode)}function y1(){wo&&(wo.detachEvent("onpropertychange",_1),bo=wo=null)}function _1(n){if(n.propertyName==="value"&&s0(bo)){var i=[];g1(i,bo,n,nf(n)),a1(Vw,i)}}function Gw(n,i,o){n==="focusin"?(y1(),wo=i,bo=o,wo.attachEvent("onpropertychange",_1)):n==="focusout"&&y1()}function qw(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return s0(bo)}function Xw(n,i){if(n==="click")return s0(i)}function Ww(n,i){if(n==="input"||n==="change")return s0(i)}function Kw(n,i){return n===i&&(n!==0||1/n===1/i)||n!==n&&i!==i}var La=typeof Object.is=="function"?Object.is:Kw;function So(n,i){if(La(n,i))return!0;if(typeof n!="object"||n===null||typeof i!="object"||i===null)return!1;var o=Object.keys(n),f=Object.keys(i);if(o.length!==f.length)return!1;for(f=0;f<o.length;f++){var m=o[f];if(!br.call(i,m)||!La(n[m],i[m]))return!1}return!0}function w1(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function b1(n,i){var o=w1(n);n=0;for(var f;o;){if(o.nodeType===3){if(f=n+o.textContent.length,n<=i&&f>=i)return{node:o,offset:i-n};n=f}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=w1(o)}}function S1(n,i){return n&&i?n===i?!0:n&&n.nodeType===3?!1:i&&i.nodeType===3?S1(n,i.parentNode):"contains"in n?n.contains(i):n.compareDocumentPosition?!!(n.compareDocumentPosition(i)&16):!1:!1}function E1(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var i=qe(n.document);i instanceof n.HTMLIFrameElement;){try{var o=typeof i.contentWindow.location.href=="string"}catch{o=!1}if(o)n=i.contentWindow;else break;i=qe(n.document)}return i}function pf(n){var i=n&&n.nodeName&&n.nodeName.toLowerCase();return i&&(i==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||i==="textarea"||n.contentEditable==="true")}var Yw=qn&&"documentMode"in document&&11>=document.documentMode,sl=null,xf=null,Eo=null,vf=!1;function T1(n,i,o){var f=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;vf||sl==null||sl!==qe(f)||(f=sl,"selectionStart"in f&&pf(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),Eo&&So(Eo,f)||(Eo=f,f=X0(xf,"onSelect"),0<f.length&&(i=new a0("onSelect","select",null,i,o),n.push({event:i,listeners:f}),i.target=sl)))}function di(n,i){var o={};return o[n.toLowerCase()]=i.toLowerCase(),o["Webkit"+n]="webkit"+i,o["Moz"+n]="moz"+i,o}var il={animationend:di("Animation","AnimationEnd"),animationiteration:di("Animation","AnimationIteration"),animationstart:di("Animation","AnimationStart"),transitionrun:di("Transition","TransitionRun"),transitionstart:di("Transition","TransitionStart"),transitioncancel:di("Transition","TransitionCancel"),transitionend:di("Transition","TransitionEnd")},yf={},k1={};qn&&(k1=document.createElement("div").style,"AnimationEvent"in window||(delete il.animationend.animation,delete il.animationiteration.animation,delete il.animationstart.animation),"TransitionEvent"in window||delete il.transitionend.transition);function mi(n){if(yf[n])return yf[n];if(!il[n])return n;var i=il[n],o;for(o in i)if(i.hasOwnProperty(o)&&o in k1)return yf[n]=i[o];return n}var A1=mi("animationend"),C1=mi("animationiteration"),N1=mi("animationstart"),Jw=mi("transitionrun"),Qw=mi("transitionstart"),Zw=mi("transitioncancel"),O1=mi("transitionend"),R1=new Map,_f="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");_f.push("scrollEnd");function vn(n,i){R1.set(n,i),er(i,[n])}var i0=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)},Qa=[],ll=0,wf=0;function l0(){for(var n=ll,i=wf=ll=0;i<n;){var o=Qa[i];Qa[i++]=null;var f=Qa[i];Qa[i++]=null;var m=Qa[i];Qa[i++]=null;var p=Qa[i];if(Qa[i++]=null,f!==null&&m!==null){var E=f.pending;E===null?m.next=m:(m.next=E.next,E.next=m),f.pending=m}p!==0&&D1(o,m,p)}}function o0(n,i,o,f){Qa[ll++]=n,Qa[ll++]=i,Qa[ll++]=o,Qa[ll++]=f,wf|=f,n.lanes|=f,n=n.alternate,n!==null&&(n.lanes|=f)}function bf(n,i,o,f){return o0(n,i,o,f),c0(n)}function gi(n,i){return o0(n,null,null,i),c0(n)}function D1(n,i,o){n.lanes|=o;var f=n.alternate;f!==null&&(f.lanes|=o);for(var m=!1,p=n.return;p!==null;)p.childLanes|=o,f=p.alternate,f!==null&&(f.childLanes|=o),p.tag===22&&(n=p.stateNode,n===null||n._visibility&1||(m=!0)),n=p,p=p.return;return n.tag===3?(p=n.stateNode,m&&i!==null&&(m=31-Wr(o),n=p.hiddenUpdates,f=n[m],f===null?n[m]=[i]:f.push(i),i.lane=o|536870912),p):null}function c0(n){if(50<qo)throw qo=0,Rh=null,Error(a(185));for(var i=n.return;i!==null;)n=i,i=n.return;return n.tag===3?n.stateNode:null}var ol={};function eb(n,i,o,f){this.tag=n,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ia(n,i,o,f){return new eb(n,i,o,f)}function Sf(n){return n=n.prototype,!(!n||!n.isReactComponent)}function Xn(n,i){var o=n.alternate;return o===null?(o=Ia(n.tag,i,n.key,n.mode),o.elementType=n.elementType,o.type=n.type,o.stateNode=n.stateNode,o.alternate=n,n.alternate=o):(o.pendingProps=i,o.type=n.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=n.flags&65011712,o.childLanes=n.childLanes,o.lanes=n.lanes,o.child=n.child,o.memoizedProps=n.memoizedProps,o.memoizedState=n.memoizedState,o.updateQueue=n.updateQueue,i=n.dependencies,o.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},o.sibling=n.sibling,o.index=n.index,o.ref=n.ref,o.refCleanup=n.refCleanup,o}function F1(n,i){n.flags&=65011714;var o=n.alternate;return o===null?(n.childLanes=0,n.lanes=i,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=o.childLanes,n.lanes=o.lanes,n.child=o.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=o.memoizedProps,n.memoizedState=o.memoizedState,n.updateQueue=o.updateQueue,n.type=o.type,i=o.dependencies,n.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),n}function u0(n,i,o,f,m,p){var E=0;if(f=n,typeof n=="function")Sf(n)&&(E=1);else if(typeof n=="string")E=sS(n,o,M.current)?26:n==="html"||n==="head"||n==="body"?27:5;else e:switch(n){case q:return n=Ia(31,o,i,m),n.elementType=q,n.lanes=p,n;case y:return pi(o.children,m,p,i);case S:E=8,m|=24;break;case k:return n=Ia(12,o,i,m|2),n.elementType=k,n.lanes=p,n;case X:return n=Ia(13,o,i,m),n.elementType=X,n.lanes=p,n;case I:return n=Ia(19,o,i,m),n.elementType=I,n.lanes=p,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case T:E=10;break e;case O:E=9;break e;case j:E=11;break e;case C:E=14;break e;case K:E=16,f=null;break e}E=29,o=Error(a(130,n===null?"null":typeof n,"")),f=null}return i=Ia(E,o,i,m),i.elementType=n,i.type=f,i.lanes=p,i}function pi(n,i,o,f){return n=Ia(7,n,f,i),n.lanes=o,n}function Ef(n,i,o){return n=Ia(6,n,null,i),n.lanes=o,n}function M1(n){var i=Ia(18,null,null,0);return i.stateNode=n,i}function Tf(n,i,o){return i=Ia(4,n.children!==null?n.children:[],n.key,i),i.lanes=o,i.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},i}var L1=new WeakMap;function Za(n,i){if(typeof n=="object"&&n!==null){var o=L1.get(n);return o!==void 0?o:(i={value:n,source:i,stack:Vt(i)},L1.set(n,i),i)}return{value:n,source:i,stack:Vt(i)}}var cl=[],ul=0,f0=null,To=0,en=[],tn=0,Es=null,Rn=1,Dn="";function Wn(n,i){cl[ul++]=To,cl[ul++]=f0,f0=n,To=i}function I1(n,i,o){en[tn++]=Rn,en[tn++]=Dn,en[tn++]=Es,Es=n;var f=Rn;n=Dn;var m=32-Wr(f)-1;f&=~(1<<m),o+=1;var p=32-Wr(i)+m;if(30<p){var E=m-m%5;p=(f&(1<<E)-1).toString(32),f>>=E,m-=E,Rn=1<<32-Wr(i)+m|o<<m|f,Dn=p+n}else Rn=1<<p|o<<m|f,Dn=n}function kf(n){n.return!==null&&(Wn(n,1),I1(n,1,0))}function Af(n){for(;n===f0;)f0=cl[--ul],cl[ul]=null,To=cl[--ul],cl[ul]=null;for(;n===Es;)Es=en[--tn],en[tn]=null,Dn=en[--tn],en[tn]=null,Rn=en[--tn],en[tn]=null}function B1(n,i){en[tn++]=Rn,en[tn++]=Dn,en[tn++]=Es,Rn=i.id,Dn=i.overflow,Es=n}var Kr=null,ar=null,Ot=!1,Ts=null,rn=!1,Cf=Error(a(519));function ks(n){var i=Error(a(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw ko(Za(i,n)),Cf}function j1(n){var i=n.stateNode,o=n.type,f=n.memoizedProps;switch(i[F]=n,i[B]=f,o){case"dialog":kt("cancel",i),kt("close",i);break;case"iframe":case"object":case"embed":kt("load",i);break;case"video":case"audio":for(o=0;o<Wo.length;o++)kt(Wo[o],i);break;case"source":kt("error",i);break;case"img":case"image":case"link":kt("error",i),kt("load",i);break;case"details":kt("toggle",i);break;case"input":kt("invalid",i),Ge(i,f.value,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name,!0);break;case"select":kt("invalid",i);break;case"textarea":kt("invalid",i),gr(i,f.value,f.defaultValue,f.children)}o=f.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||i.textContent===""+o||f.suppressHydrationWarning===!0||tx(i.textContent,o)?(f.popover!=null&&(kt("beforetoggle",i),kt("toggle",i)),f.onScroll!=null&&kt("scroll",i),f.onScrollEnd!=null&&kt("scrollend",i),f.onClick!=null&&(i.onclick=Gn),i=!0):i=!1,i||ks(n,!0)}function U1(n){for(Kr=n.return;Kr;)switch(Kr.tag){case 5:case 31:case 13:rn=!1;return;case 27:case 3:rn=!0;return;default:Kr=Kr.return}}function fl(n){if(n!==Kr)return!1;if(!Ot)return U1(n),Ot=!0,!1;var i=n.tag,o;if((o=i!==3&&i!==27)&&((o=i===5)&&(o=n.type,o=!(o!=="form"&&o!=="button")||qh(n.type,n.memoizedProps)),o=!o),o&&ar&&ks(n),U1(n),i===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(a(317));ar=ux(n)}else if(i===31){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(a(317));ar=ux(n)}else i===27?(i=ar,Ps(n.type)?(n=Jh,Jh=null,ar=n):ar=i):ar=Kr?nn(n.stateNode.nextSibling):null;return!0}function xi(){ar=Kr=null,Ot=!1}function Nf(){var n=Ts;return n!==null&&(Ca===null?Ca=n:Ca.push.apply(Ca,n),Ts=null),n}function ko(n){Ts===null?Ts=[n]:Ts.push(n)}var Of=L(null),vi=null,Kn=null;function As(n,i,o){V(Of,i._currentValue),i._currentValue=o}function Yn(n){n._currentValue=Of.current,N(Of)}function Rf(n,i,o){for(;n!==null;){var f=n.alternate;if((n.childLanes&i)!==i?(n.childLanes|=i,f!==null&&(f.childLanes|=i)):f!==null&&(f.childLanes&i)!==i&&(f.childLanes|=i),n===o)break;n=n.return}}function Df(n,i,o,f){var m=n.child;for(m!==null&&(m.return=n);m!==null;){var p=m.dependencies;if(p!==null){var E=m.child;p=p.firstContext;e:for(;p!==null;){var R=p;p=m;for(var W=0;W<i.length;W++)if(R.context===i[W]){p.lanes|=o,R=p.alternate,R!==null&&(R.lanes|=o),Rf(p.return,o,n),f||(E=null);break e}p=R.next}}else if(m.tag===18){if(E=m.return,E===null)throw Error(a(341));E.lanes|=o,p=E.alternate,p!==null&&(p.lanes|=o),Rf(E,o,n),E=null}else E=m.child;if(E!==null)E.return=m;else for(E=m;E!==null;){if(E===n){E=null;break}if(m=E.sibling,m!==null){m.return=E.return,E=m;break}E=E.return}m=E}}function hl(n,i,o,f){n=null;for(var m=i,p=!1;m!==null;){if(!p){if((m.flags&524288)!==0)p=!0;else if((m.flags&262144)!==0)break}if(m.tag===10){var E=m.alternate;if(E===null)throw Error(a(387));if(E=E.memoizedProps,E!==null){var R=m.type;La(m.pendingProps.value,E.value)||(n!==null?n.push(R):n=[R])}}else if(m===ge.current){if(E=m.alternate,E===null)throw Error(a(387));E.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(n!==null?n.push(Zo):n=[Zo])}m=m.return}n!==null&&Df(i,n,o,f),i.flags|=262144}function h0(n){for(n=n.firstContext;n!==null;){if(!La(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function yi(n){vi=n,Kn=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function Yr(n){return P1(vi,n)}function d0(n,i){return vi===null&&yi(n),P1(n,i)}function P1(n,i){var o=i._currentValue;if(i={context:i,memoizedValue:o,next:null},Kn===null){if(n===null)throw Error(a(308));Kn=i,n.dependencies={lanes:0,firstContext:i},n.flags|=524288}else Kn=Kn.next=i;return o}var tb=typeof AbortController<"u"?AbortController:function(){var n=[],i=this.signal={aborted:!1,addEventListener:function(o,f){n.push(f)}};this.abort=function(){i.aborted=!0,n.forEach(function(o){return o()})}},rb=e.unstable_scheduleCallback,ab=e.unstable_NormalPriority,Cr={$$typeof:T,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Ff(){return{controller:new tb,data:new Map,refCount:0}}function Ao(n){n.refCount--,n.refCount===0&&rb(ab,function(){n.controller.abort()})}var Co=null,Mf=0,dl=0,ml=null;function nb(n,i){if(Co===null){var o=Co=[];Mf=0,dl=Bh(),ml={status:"pending",value:void 0,then:function(f){o.push(f)}}}return Mf++,i.then(z1,z1),i}function z1(){if(--Mf===0&&Co!==null){ml!==null&&(ml.status="fulfilled");var n=Co;Co=null,dl=0,ml=null;for(var i=0;i<n.length;i++)(0,n[i])()}}function sb(n,i){var o=[],f={status:"pending",value:null,reason:null,then:function(m){o.push(m)}};return n.then(function(){f.status="fulfilled",f.value=i;for(var m=0;m<o.length;m++)(0,o[m])(i)},function(m){for(f.status="rejected",f.reason=m,m=0;m<o.length;m++)(0,o[m])(void 0)}),f}var H1=G.S;G.S=function(n,i){Tp=Mt(),typeof i=="object"&&i!==null&&typeof i.then=="function"&&nb(n,i),H1!==null&&H1(n,i)};var _i=L(null);function Lf(){var n=_i.current;return n!==null?n:Zt.pooledCache}function m0(n,i){i===null?V(_i,_i.current):V(_i,i.pool)}function $1(){var n=Lf();return n===null?null:{parent:Cr._currentValue,pool:n}}var gl=Error(a(460)),If=Error(a(474)),g0=Error(a(542)),p0={then:function(){}};function V1(n){return n=n.status,n==="fulfilled"||n==="rejected"}function G1(n,i,o){switch(o=n[o],o===void 0?n.push(i):o!==i&&(i.then(Gn,Gn),i=o),i.status){case"fulfilled":return i.value;case"rejected":throw n=i.reason,X1(n),n;default:if(typeof i.status=="string")i.then(Gn,Gn);else{if(n=Zt,n!==null&&100<n.shellSuspendCounter)throw Error(a(482));n=i,n.status="pending",n.then(function(f){if(i.status==="pending"){var m=i;m.status="fulfilled",m.value=f}},function(f){if(i.status==="pending"){var m=i;m.status="rejected",m.reason=f}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw n=i.reason,X1(n),n}throw bi=i,gl}}function wi(n){try{var i=n._init;return i(n._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(bi=o,gl):o}}var bi=null;function q1(){if(bi===null)throw Error(a(459));var n=bi;return bi=null,n}function X1(n){if(n===gl||n===g0)throw Error(a(483))}var pl=null,No=0;function x0(n){var i=No;return No+=1,pl===null&&(pl=[]),G1(pl,n,i)}function Oo(n,i){i=i.props.ref,n.ref=i!==void 0?i:null}function v0(n,i){throw i.$$typeof===v?Error(a(525)):(n=Object.prototype.toString.call(i),Error(a(31,n==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":n)))}function W1(n){function i(ae,Q){if(n){var ce=ae.deletions;ce===null?(ae.deletions=[Q],ae.flags|=16):ce.push(Q)}}function o(ae,Q){if(!n)return null;for(;Q!==null;)i(ae,Q),Q=Q.sibling;return null}function f(ae){for(var Q=new Map;ae!==null;)ae.key!==null?Q.set(ae.key,ae):Q.set(ae.index,ae),ae=ae.sibling;return Q}function m(ae,Q){return ae=Xn(ae,Q),ae.index=0,ae.sibling=null,ae}function p(ae,Q,ce){return ae.index=ce,n?(ce=ae.alternate,ce!==null?(ce=ce.index,ce<Q?(ae.flags|=67108866,Q):ce):(ae.flags|=67108866,Q)):(ae.flags|=1048576,Q)}function E(ae){return n&&ae.alternate===null&&(ae.flags|=67108866),ae}function R(ae,Q,ce,Te){return Q===null||Q.tag!==6?(Q=Ef(ce,ae.mode,Te),Q.return=ae,Q):(Q=m(Q,ce),Q.return=ae,Q)}function W(ae,Q,ce,Te){var nt=ce.type;return nt===y?we(ae,Q,ce.props.children,Te,ce.key):Q!==null&&(Q.elementType===nt||typeof nt=="object"&&nt!==null&&nt.$$typeof===K&&wi(nt)===Q.type)?(Q=m(Q,ce.props),Oo(Q,ce),Q.return=ae,Q):(Q=u0(ce.type,ce.key,ce.props,null,ae.mode,Te),Oo(Q,ce),Q.return=ae,Q)}function ue(ae,Q,ce,Te){return Q===null||Q.tag!==4||Q.stateNode.containerInfo!==ce.containerInfo||Q.stateNode.implementation!==ce.implementation?(Q=Tf(ce,ae.mode,Te),Q.return=ae,Q):(Q=m(Q,ce.children||[]),Q.return=ae,Q)}function we(ae,Q,ce,Te,nt){return Q===null||Q.tag!==7?(Q=pi(ce,ae.mode,Te,nt),Q.return=ae,Q):(Q=m(Q,ce),Q.return=ae,Q)}function ke(ae,Q,ce){if(typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint")return Q=Ef(""+Q,ae.mode,ce),Q.return=ae,Q;if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case _:return ce=u0(Q.type,Q.key,Q.props,null,ae.mode,ce),Oo(ce,Q),ce.return=ae,ce;case b:return Q=Tf(Q,ae.mode,ce),Q.return=ae,Q;case K:return Q=wi(Q),ke(ae,Q,ce)}if(Se(Q)||Z(Q))return Q=pi(Q,ae.mode,ce,null),Q.return=ae,Q;if(typeof Q.then=="function")return ke(ae,x0(Q),ce);if(Q.$$typeof===T)return ke(ae,d0(ae,Q),ce);v0(ae,Q)}return null}function de(ae,Q,ce,Te){var nt=Q!==null?Q.key:null;if(typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint")return nt!==null?null:R(ae,Q,""+ce,Te);if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case _:return ce.key===nt?W(ae,Q,ce,Te):null;case b:return ce.key===nt?ue(ae,Q,ce,Te):null;case K:return ce=wi(ce),de(ae,Q,ce,Te)}if(Se(ce)||Z(ce))return nt!==null?null:we(ae,Q,ce,Te,null);if(typeof ce.then=="function")return de(ae,Q,x0(ce),Te);if(ce.$$typeof===T)return de(ae,Q,d0(ae,ce),Te);v0(ae,ce)}return null}function me(ae,Q,ce,Te,nt){if(typeof Te=="string"&&Te!==""||typeof Te=="number"||typeof Te=="bigint")return ae=ae.get(ce)||null,R(Q,ae,""+Te,nt);if(typeof Te=="object"&&Te!==null){switch(Te.$$typeof){case _:return ae=ae.get(Te.key===null?ce:Te.key)||null,W(Q,ae,Te,nt);case b:return ae=ae.get(Te.key===null?ce:Te.key)||null,ue(Q,ae,Te,nt);case K:return Te=wi(Te),me(ae,Q,ce,Te,nt)}if(Se(Te)||Z(Te))return ae=ae.get(ce)||null,we(Q,ae,Te,nt,null);if(typeof Te.then=="function")return me(ae,Q,ce,x0(Te),nt);if(Te.$$typeof===T)return me(ae,Q,ce,d0(Q,Te),nt);v0(Q,Te)}return null}function Xe(ae,Q,ce,Te){for(var nt=null,Lt=null,Je=Q,yt=Q=0,Nt=null;Je!==null&&yt<ce.length;yt++){Je.index>yt?(Nt=Je,Je=null):Nt=Je.sibling;var It=de(ae,Je,ce[yt],Te);if(It===null){Je===null&&(Je=Nt);break}n&&Je&&It.alternate===null&&i(ae,Je),Q=p(It,Q,yt),Lt===null?nt=It:Lt.sibling=It,Lt=It,Je=Nt}if(yt===ce.length)return o(ae,Je),Ot&&Wn(ae,yt),nt;if(Je===null){for(;yt<ce.length;yt++)Je=ke(ae,ce[yt],Te),Je!==null&&(Q=p(Je,Q,yt),Lt===null?nt=Je:Lt.sibling=Je,Lt=Je);return Ot&&Wn(ae,yt),nt}for(Je=f(Je);yt<ce.length;yt++)Nt=me(Je,ae,yt,ce[yt],Te),Nt!==null&&(n&&Nt.alternate!==null&&Je.delete(Nt.key===null?yt:Nt.key),Q=p(Nt,Q,yt),Lt===null?nt=Nt:Lt.sibling=Nt,Lt=Nt);return n&&Je.forEach(function(Gs){return i(ae,Gs)}),Ot&&Wn(ae,yt),nt}function it(ae,Q,ce,Te){if(ce==null)throw Error(a(151));for(var nt=null,Lt=null,Je=Q,yt=Q=0,Nt=null,It=ce.next();Je!==null&&!It.done;yt++,It=ce.next()){Je.index>yt?(Nt=Je,Je=null):Nt=Je.sibling;var Gs=de(ae,Je,It.value,Te);if(Gs===null){Je===null&&(Je=Nt);break}n&&Je&&Gs.alternate===null&&i(ae,Je),Q=p(Gs,Q,yt),Lt===null?nt=Gs:Lt.sibling=Gs,Lt=Gs,Je=Nt}if(It.done)return o(ae,Je),Ot&&Wn(ae,yt),nt;if(Je===null){for(;!It.done;yt++,It=ce.next())It=ke(ae,It.value,Te),It!==null&&(Q=p(It,Q,yt),Lt===null?nt=It:Lt.sibling=It,Lt=It);return Ot&&Wn(ae,yt),nt}for(Je=f(Je);!It.done;yt++,It=ce.next())It=me(Je,ae,yt,It.value,Te),It!==null&&(n&&It.alternate!==null&&Je.delete(It.key===null?yt:It.key),Q=p(It,Q,yt),Lt===null?nt=It:Lt.sibling=It,Lt=It);return n&&Je.forEach(function(pS){return i(ae,pS)}),Ot&&Wn(ae,yt),nt}function Yt(ae,Q,ce,Te){if(typeof ce=="object"&&ce!==null&&ce.type===y&&ce.key===null&&(ce=ce.props.children),typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case _:e:{for(var nt=ce.key;Q!==null;){if(Q.key===nt){if(nt=ce.type,nt===y){if(Q.tag===7){o(ae,Q.sibling),Te=m(Q,ce.props.children),Te.return=ae,ae=Te;break e}}else if(Q.elementType===nt||typeof nt=="object"&&nt!==null&&nt.$$typeof===K&&wi(nt)===Q.type){o(ae,Q.sibling),Te=m(Q,ce.props),Oo(Te,ce),Te.return=ae,ae=Te;break e}o(ae,Q);break}else i(ae,Q);Q=Q.sibling}ce.type===y?(Te=pi(ce.props.children,ae.mode,Te,ce.key),Te.return=ae,ae=Te):(Te=u0(ce.type,ce.key,ce.props,null,ae.mode,Te),Oo(Te,ce),Te.return=ae,ae=Te)}return E(ae);case b:e:{for(nt=ce.key;Q!==null;){if(Q.key===nt)if(Q.tag===4&&Q.stateNode.containerInfo===ce.containerInfo&&Q.stateNode.implementation===ce.implementation){o(ae,Q.sibling),Te=m(Q,ce.children||[]),Te.return=ae,ae=Te;break e}else{o(ae,Q);break}else i(ae,Q);Q=Q.sibling}Te=Tf(ce,ae.mode,Te),Te.return=ae,ae=Te}return E(ae);case K:return ce=wi(ce),Yt(ae,Q,ce,Te)}if(Se(ce))return Xe(ae,Q,ce,Te);if(Z(ce)){if(nt=Z(ce),typeof nt!="function")throw Error(a(150));return ce=nt.call(ce),it(ae,Q,ce,Te)}if(typeof ce.then=="function")return Yt(ae,Q,x0(ce),Te);if(ce.$$typeof===T)return Yt(ae,Q,d0(ae,ce),Te);v0(ae,ce)}return typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint"?(ce=""+ce,Q!==null&&Q.tag===6?(o(ae,Q.sibling),Te=m(Q,ce),Te.return=ae,ae=Te):(o(ae,Q),Te=Ef(ce,ae.mode,Te),Te.return=ae,ae=Te),E(ae)):o(ae,Q)}return function(ae,Q,ce,Te){try{No=0;var nt=Yt(ae,Q,ce,Te);return pl=null,nt}catch(Je){if(Je===gl||Je===g0)throw Je;var Lt=Ia(29,Je,null,ae.mode);return Lt.lanes=Te,Lt.return=ae,Lt}}}var Si=W1(!0),K1=W1(!1),Cs=!1;function Bf(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function jf(n,i){n=n.updateQueue,i.updateQueue===n&&(i.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function Ns(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function Os(n,i,o){var f=n.updateQueue;if(f===null)return null;if(f=f.shared,(jt&2)!==0){var m=f.pending;return m===null?i.next=i:(i.next=m.next,m.next=i),f.pending=i,i=c0(n),D1(n,null,o),i}return o0(n,f,i,o),c0(n)}function Ro(n,i,o){if(i=i.updateQueue,i!==null&&(i=i.shared,(o&4194048)!==0)){var f=i.lanes;f&=n.pendingLanes,o|=f,i.lanes=o,ws(n,o)}}function Uf(n,i){var o=n.updateQueue,f=n.alternate;if(f!==null&&(f=f.updateQueue,o===f)){var m=null,p=null;if(o=o.firstBaseUpdate,o!==null){do{var E={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};p===null?m=p=E:p=p.next=E,o=o.next}while(o!==null);p===null?m=p=i:p=p.next=i}else m=p=i;o={baseState:f.baseState,firstBaseUpdate:m,lastBaseUpdate:p,shared:f.shared,callbacks:f.callbacks},n.updateQueue=o;return}n=o.lastBaseUpdate,n===null?o.firstBaseUpdate=i:n.next=i,o.lastBaseUpdate=i}var Pf=!1;function Do(){if(Pf){var n=ml;if(n!==null)throw n}}function Fo(n,i,o,f){Pf=!1;var m=n.updateQueue;Cs=!1;var p=m.firstBaseUpdate,E=m.lastBaseUpdate,R=m.shared.pending;if(R!==null){m.shared.pending=null;var W=R,ue=W.next;W.next=null,E===null?p=ue:E.next=ue,E=W;var we=n.alternate;we!==null&&(we=we.updateQueue,R=we.lastBaseUpdate,R!==E&&(R===null?we.firstBaseUpdate=ue:R.next=ue,we.lastBaseUpdate=W))}if(p!==null){var ke=m.baseState;E=0,we=ue=W=null,R=p;do{var de=R.lane&-536870913,me=de!==R.lane;if(me?(Ct&de)===de:(f&de)===de){de!==0&&de===dl&&(Pf=!0),we!==null&&(we=we.next={lane:0,tag:R.tag,payload:R.payload,callback:null,next:null});e:{var Xe=n,it=R;de=i;var Yt=o;switch(it.tag){case 1:if(Xe=it.payload,typeof Xe=="function"){ke=Xe.call(Yt,ke,de);break e}ke=Xe;break e;case 3:Xe.flags=Xe.flags&-65537|128;case 0:if(Xe=it.payload,de=typeof Xe=="function"?Xe.call(Yt,ke,de):Xe,de==null)break e;ke=x({},ke,de);break e;case 2:Cs=!0}}de=R.callback,de!==null&&(n.flags|=64,me&&(n.flags|=8192),me=m.callbacks,me===null?m.callbacks=[de]:me.push(de))}else me={lane:de,tag:R.tag,payload:R.payload,callback:R.callback,next:null},we===null?(ue=we=me,W=ke):we=we.next=me,E|=de;if(R=R.next,R===null){if(R=m.shared.pending,R===null)break;me=R,R=me.next,me.next=null,m.lastBaseUpdate=me,m.shared.pending=null}}while(!0);we===null&&(W=ke),m.baseState=W,m.firstBaseUpdate=ue,m.lastBaseUpdate=we,p===null&&(m.shared.lanes=0),Ls|=E,n.lanes=E,n.memoizedState=ke}}function Y1(n,i){if(typeof n!="function")throw Error(a(191,n));n.call(i)}function J1(n,i){var o=n.callbacks;if(o!==null)for(n.callbacks=null,n=0;n<o.length;n++)Y1(o[n],i)}var xl=L(null),y0=L(0);function Q1(n,i){n=ss,V(y0,n),V(xl,i),ss=n|i.baseLanes}function zf(){V(y0,ss),V(xl,xl.current)}function Hf(){ss=y0.current,N(xl),N(y0)}var Ba=L(null),an=null;function Rs(n){var i=n.alternate;V(Sr,Sr.current&1),V(Ba,n),an===null&&(i===null||xl.current!==null||i.memoizedState!==null)&&(an=n)}function $f(n){V(Sr,Sr.current),V(Ba,n),an===null&&(an=n)}function Z1(n){n.tag===22?(V(Sr,Sr.current),V(Ba,n),an===null&&(an=n)):Ds()}function Ds(){V(Sr,Sr.current),V(Ba,Ba.current)}function ja(n){N(Ba),an===n&&(an=null),N(Sr)}var Sr=L(0);function _0(n){for(var i=n;i!==null;){if(i.tag===13){var o=i.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||Kh(o)||Yh(o)))return i}else if(i.tag===19&&(i.memoizedProps.revealOrder==="forwards"||i.memoizedProps.revealOrder==="backwards"||i.memoizedProps.revealOrder==="unstable_legacy-backwards"||i.memoizedProps.revealOrder==="together")){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===n)break;for(;i.sibling===null;){if(i.return===null||i.return===n)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var Jn=0,xt=null,Wt=null,Nr=null,w0=!1,vl=!1,Ei=!1,b0=0,Mo=0,yl=null,ib=0;function pr(){throw Error(a(321))}function Vf(n,i){if(i===null)return!1;for(var o=0;o<i.length&&o<n.length;o++)if(!La(n[o],i[o]))return!1;return!0}function Gf(n,i,o,f,m,p){return Jn=p,xt=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,G.H=n===null||n.memoizedState===null?Ig:ih,Ei=!1,p=o(f,m),Ei=!1,vl&&(p=tg(i,o,f,m)),eg(n),p}function eg(n){G.H=Bo;var i=Wt!==null&&Wt.next!==null;if(Jn=0,Nr=Wt=xt=null,w0=!1,Mo=0,yl=null,i)throw Error(a(300));n===null||Or||(n=n.dependencies,n!==null&&h0(n)&&(Or=!0))}function tg(n,i,o,f){xt=n;var m=0;do{if(vl&&(yl=null),Mo=0,vl=!1,25<=m)throw Error(a(301));if(m+=1,Nr=Wt=null,n.updateQueue!=null){var p=n.updateQueue;p.lastEffect=null,p.events=null,p.stores=null,p.memoCache!=null&&(p.memoCache.index=0)}G.H=Bg,p=i(o,f)}while(vl);return p}function lb(){var n=G.H,i=n.useState()[0];return i=typeof i.then=="function"?Lo(i):i,n=n.useState()[0],(Wt!==null?Wt.memoizedState:null)!==n&&(xt.flags|=1024),i}function qf(){var n=b0!==0;return b0=0,n}function Xf(n,i,o){i.updateQueue=n.updateQueue,i.flags&=-2053,n.lanes&=~o}function Wf(n){if(w0){for(n=n.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}w0=!1}Jn=0,Nr=Wt=xt=null,vl=!1,Mo=b0=0,yl=null}function xa(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Nr===null?xt.memoizedState=Nr=n:Nr=Nr.next=n,Nr}function Er(){if(Wt===null){var n=xt.alternate;n=n!==null?n.memoizedState:null}else n=Wt.next;var i=Nr===null?xt.memoizedState:Nr.next;if(i!==null)Nr=i,Wt=n;else{if(n===null)throw xt.alternate===null?Error(a(467)):Error(a(310));Wt=n,n={memoizedState:Wt.memoizedState,baseState:Wt.baseState,baseQueue:Wt.baseQueue,queue:Wt.queue,next:null},Nr===null?xt.memoizedState=Nr=n:Nr=Nr.next=n}return Nr}function S0(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Lo(n){var i=Mo;return Mo+=1,yl===null&&(yl=[]),n=G1(yl,n,i),i=xt,(Nr===null?i.memoizedState:Nr.next)===null&&(i=i.alternate,G.H=i===null||i.memoizedState===null?Ig:ih),n}function E0(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return Lo(n);if(n.$$typeof===T)return Yr(n)}throw Error(a(438,String(n)))}function Kf(n){var i=null,o=xt.updateQueue;if(o!==null&&(i=o.memoCache),i==null){var f=xt.alternate;f!==null&&(f=f.updateQueue,f!==null&&(f=f.memoCache,f!=null&&(i={data:f.data.map(function(m){return m.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),o===null&&(o=S0(),xt.updateQueue=o),o.memoCache=i,o=i.data[i.index],o===void 0)for(o=i.data[i.index]=Array(n),f=0;f<n;f++)o[f]=oe;return i.index++,o}function Qn(n,i){return typeof i=="function"?i(n):i}function T0(n){var i=Er();return Yf(i,Wt,n)}function Yf(n,i,o){var f=n.queue;if(f===null)throw Error(a(311));f.lastRenderedReducer=o;var m=n.baseQueue,p=f.pending;if(p!==null){if(m!==null){var E=m.next;m.next=p.next,p.next=E}i.baseQueue=m=p,f.pending=null}if(p=n.baseState,m===null)n.memoizedState=p;else{i=m.next;var R=E=null,W=null,ue=i,we=!1;do{var ke=ue.lane&-536870913;if(ke!==ue.lane?(Ct&ke)===ke:(Jn&ke)===ke){var de=ue.revertLane;if(de===0)W!==null&&(W=W.next={lane:0,revertLane:0,gesture:null,action:ue.action,hasEagerState:ue.hasEagerState,eagerState:ue.eagerState,next:null}),ke===dl&&(we=!0);else if((Jn&de)===de){ue=ue.next,de===dl&&(we=!0);continue}else ke={lane:0,revertLane:ue.revertLane,gesture:null,action:ue.action,hasEagerState:ue.hasEagerState,eagerState:ue.eagerState,next:null},W===null?(R=W=ke,E=p):W=W.next=ke,xt.lanes|=de,Ls|=de;ke=ue.action,Ei&&o(p,ke),p=ue.hasEagerState?ue.eagerState:o(p,ke)}else de={lane:ke,revertLane:ue.revertLane,gesture:ue.gesture,action:ue.action,hasEagerState:ue.hasEagerState,eagerState:ue.eagerState,next:null},W===null?(R=W=de,E=p):W=W.next=de,xt.lanes|=ke,Ls|=ke;ue=ue.next}while(ue!==null&&ue!==i);if(W===null?E=p:W.next=R,!La(p,n.memoizedState)&&(Or=!0,we&&(o=ml,o!==null)))throw o;n.memoizedState=p,n.baseState=E,n.baseQueue=W,f.lastRenderedState=p}return m===null&&(f.lanes=0),[n.memoizedState,f.dispatch]}function Jf(n){var i=Er(),o=i.queue;if(o===null)throw Error(a(311));o.lastRenderedReducer=n;var f=o.dispatch,m=o.pending,p=i.memoizedState;if(m!==null){o.pending=null;var E=m=m.next;do p=n(p,E.action),E=E.next;while(E!==m);La(p,i.memoizedState)||(Or=!0),i.memoizedState=p,i.baseQueue===null&&(i.baseState=p),o.lastRenderedState=p}return[p,f]}function rg(n,i,o){var f=xt,m=Er(),p=Ot;if(p){if(o===void 0)throw Error(a(407));o=o()}else o=i();var E=!La((Wt||m).memoizedState,o);if(E&&(m.memoizedState=o,Or=!0),m=m.queue,eh(sg.bind(null,f,m,n),[n]),m.getSnapshot!==i||E||Nr!==null&&Nr.memoizedState.tag&1){if(f.flags|=2048,_l(9,{destroy:void 0},ng.bind(null,f,m,o,i),null),Zt===null)throw Error(a(349));p||(Jn&127)!==0||ag(f,i,o)}return o}function ag(n,i,o){n.flags|=16384,n={getSnapshot:i,value:o},i=xt.updateQueue,i===null?(i=S0(),xt.updateQueue=i,i.stores=[n]):(o=i.stores,o===null?i.stores=[n]:o.push(n))}function ng(n,i,o,f){i.value=o,i.getSnapshot=f,ig(i)&&lg(n)}function sg(n,i,o){return o(function(){ig(i)&&lg(n)})}function ig(n){var i=n.getSnapshot;n=n.value;try{var o=i();return!La(n,o)}catch{return!0}}function lg(n){var i=gi(n,2);i!==null&&Na(i,n,2)}function Qf(n){var i=xa();if(typeof n=="function"){var o=n;if(n=o(),Ei){Ma(!0);try{o()}finally{Ma(!1)}}}return i.memoizedState=i.baseState=n,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Qn,lastRenderedState:n},i}function og(n,i,o,f){return n.baseState=o,Yf(n,Wt,typeof f=="function"?f:Qn)}function ob(n,i,o,f,m){if(C0(n))throw Error(a(485));if(n=i.action,n!==null){var p={payload:m,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(E){p.listeners.push(E)}};G.T!==null?o(!0):p.isTransition=!1,f(p),o=i.pending,o===null?(p.next=i.pending=p,cg(i,p)):(p.next=o.next,i.pending=o.next=p)}}function cg(n,i){var o=i.action,f=i.payload,m=n.state;if(i.isTransition){var p=G.T,E={};G.T=E;try{var R=o(m,f),W=G.S;W!==null&&W(E,R),ug(n,i,R)}catch(ue){Zf(n,i,ue)}finally{p!==null&&E.types!==null&&(p.types=E.types),G.T=p}}else try{p=o(m,f),ug(n,i,p)}catch(ue){Zf(n,i,ue)}}function ug(n,i,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(f){fg(n,i,f)},function(f){return Zf(n,i,f)}):fg(n,i,o)}function fg(n,i,o){i.status="fulfilled",i.value=o,hg(i),n.state=o,i=n.pending,i!==null&&(o=i.next,o===i?n.pending=null:(o=o.next,i.next=o,cg(n,o)))}function Zf(n,i,o){var f=n.pending;if(n.pending=null,f!==null){f=f.next;do i.status="rejected",i.reason=o,hg(i),i=i.next;while(i!==f)}n.action=null}function hg(n){n=n.listeners;for(var i=0;i<n.length;i++)(0,n[i])()}function dg(n,i){return i}function mg(n,i){if(Ot){var o=Zt.formState;if(o!==null){e:{var f=xt;if(Ot){if(ar){t:{for(var m=ar,p=rn;m.nodeType!==8;){if(!p){m=null;break t}if(m=nn(m.nextSibling),m===null){m=null;break t}}p=m.data,m=p==="F!"||p==="F"?m:null}if(m){ar=nn(m.nextSibling),f=m.data==="F!";break e}}ks(f)}f=!1}f&&(i=o[0])}}return o=xa(),o.memoizedState=o.baseState=i,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:dg,lastRenderedState:i},o.queue=f,o=Fg.bind(null,xt,f),f.dispatch=o,f=Qf(!1),p=sh.bind(null,xt,!1,f.queue),f=xa(),m={state:i,dispatch:null,action:n,pending:null},f.queue=m,o=ob.bind(null,xt,m,p,o),m.dispatch=o,f.memoizedState=n,[i,o,!1]}function gg(n){var i=Er();return pg(i,Wt,n)}function pg(n,i,o){if(i=Yf(n,i,dg)[0],n=T0(Qn)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var f=Lo(i)}catch(E){throw E===gl?g0:E}else f=i;i=Er();var m=i.queue,p=m.dispatch;return o!==i.memoizedState&&(xt.flags|=2048,_l(9,{destroy:void 0},cb.bind(null,m,o),null)),[f,p,n]}function cb(n,i){n.action=i}function xg(n){var i=Er(),o=Wt;if(o!==null)return pg(i,o,n);Er(),i=i.memoizedState,o=Er();var f=o.queue.dispatch;return o.memoizedState=n,[i,f,!1]}function _l(n,i,o,f){return n={tag:n,create:o,deps:f,inst:i,next:null},i=xt.updateQueue,i===null&&(i=S0(),xt.updateQueue=i),o=i.lastEffect,o===null?i.lastEffect=n.next=n:(f=o.next,o.next=n,n.next=f,i.lastEffect=n),n}function vg(){return Er().memoizedState}function k0(n,i,o,f){var m=xa();xt.flags|=n,m.memoizedState=_l(1|i,{destroy:void 0},o,f===void 0?null:f)}function A0(n,i,o,f){var m=Er();f=f===void 0?null:f;var p=m.memoizedState.inst;Wt!==null&&f!==null&&Vf(f,Wt.memoizedState.deps)?m.memoizedState=_l(i,p,o,f):(xt.flags|=n,m.memoizedState=_l(1|i,p,o,f))}function yg(n,i){k0(8390656,8,n,i)}function eh(n,i){A0(2048,8,n,i)}function ub(n){xt.flags|=4;var i=xt.updateQueue;if(i===null)i=S0(),xt.updateQueue=i,i.events=[n];else{var o=i.events;o===null?i.events=[n]:o.push(n)}}function _g(n){var i=Er().memoizedState;return ub({ref:i,nextImpl:n}),function(){if((jt&2)!==0)throw Error(a(440));return i.impl.apply(void 0,arguments)}}function wg(n,i){return A0(4,2,n,i)}function bg(n,i){return A0(4,4,n,i)}function Sg(n,i){if(typeof i=="function"){n=n();var o=i(n);return function(){typeof o=="function"?o():i(null)}}if(i!=null)return n=n(),i.current=n,function(){i.current=null}}function Eg(n,i,o){o=o!=null?o.concat([n]):null,A0(4,4,Sg.bind(null,i,n),o)}function th(){}function Tg(n,i){var o=Er();i=i===void 0?null:i;var f=o.memoizedState;return i!==null&&Vf(i,f[1])?f[0]:(o.memoizedState=[n,i],n)}function kg(n,i){var o=Er();i=i===void 0?null:i;var f=o.memoizedState;if(i!==null&&Vf(i,f[1]))return f[0];if(f=n(),Ei){Ma(!0);try{n()}finally{Ma(!1)}}return o.memoizedState=[f,i],f}function rh(n,i,o){return o===void 0||(Jn&1073741824)!==0&&(Ct&261930)===0?n.memoizedState=i:(n.memoizedState=o,n=Ap(),xt.lanes|=n,Ls|=n,o)}function Ag(n,i,o,f){return La(o,i)?o:xl.current!==null?(n=rh(n,o,f),La(n,i)||(Or=!0),n):(Jn&42)===0||(Jn&1073741824)!==0&&(Ct&261930)===0?(Or=!0,n.memoizedState=o):(n=Ap(),xt.lanes|=n,Ls|=n,i)}function Cg(n,i,o,f,m){var p=ne.p;ne.p=p!==0&&8>p?p:8;var E=G.T,R={};G.T=R,sh(n,!1,i,o);try{var W=m(),ue=G.S;if(ue!==null&&ue(R,W),W!==null&&typeof W=="object"&&typeof W.then=="function"){var we=sb(W,f);Io(n,i,we,za(n))}else Io(n,i,f,za(n))}catch(ke){Io(n,i,{then:function(){},status:"rejected",reason:ke},za())}finally{ne.p=p,E!==null&&R.types!==null&&(E.types=R.types),G.T=E}}function fb(){}function ah(n,i,o,f){if(n.tag!==5)throw Error(a(476));var m=Ng(n).queue;Cg(n,m,i,pe,o===null?fb:function(){return Og(n),o(f)})}function Ng(n){var i=n.memoizedState;if(i!==null)return i;i={memoizedState:pe,baseState:pe,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Qn,lastRenderedState:pe},next:null};var o={};return i.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Qn,lastRenderedState:o},next:null},n.memoizedState=i,n=n.alternate,n!==null&&(n.memoizedState=i),i}function Og(n){var i=Ng(n);i.next===null&&(i=n.alternate.memoizedState),Io(n,i.next.queue,{},za())}function nh(){return Yr(Zo)}function Rg(){return Er().memoizedState}function Dg(){return Er().memoizedState}function hb(n){for(var i=n.return;i!==null;){switch(i.tag){case 24:case 3:var o=za();n=Ns(o);var f=Os(i,n,o);f!==null&&(Na(f,i,o),Ro(f,i,o)),i={cache:Ff()},n.payload=i;return}i=i.return}}function db(n,i,o){var f=za();o={lane:f,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},C0(n)?Mg(i,o):(o=bf(n,i,o,f),o!==null&&(Na(o,n,f),Lg(o,i,f)))}function Fg(n,i,o){var f=za();Io(n,i,o,f)}function Io(n,i,o,f){var m={lane:f,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(C0(n))Mg(i,m);else{var p=n.alternate;if(n.lanes===0&&(p===null||p.lanes===0)&&(p=i.lastRenderedReducer,p!==null))try{var E=i.lastRenderedState,R=p(E,o);if(m.hasEagerState=!0,m.eagerState=R,La(R,E))return o0(n,i,m,0),Zt===null&&l0(),!1}catch{}if(o=bf(n,i,m,f),o!==null)return Na(o,n,f),Lg(o,i,f),!0}return!1}function sh(n,i,o,f){if(f={lane:2,revertLane:Bh(),gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},C0(n)){if(i)throw Error(a(479))}else i=bf(n,o,f,2),i!==null&&Na(i,n,2)}function C0(n){var i=n.alternate;return n===xt||i!==null&&i===xt}function Mg(n,i){vl=w0=!0;var o=n.pending;o===null?i.next=i:(i.next=o.next,o.next=i),n.pending=i}function Lg(n,i,o){if((o&4194048)!==0){var f=i.lanes;f&=n.pendingLanes,o|=f,i.lanes=o,ws(n,o)}}var Bo={readContext:Yr,use:E0,useCallback:pr,useContext:pr,useEffect:pr,useImperativeHandle:pr,useLayoutEffect:pr,useInsertionEffect:pr,useMemo:pr,useReducer:pr,useRef:pr,useState:pr,useDebugValue:pr,useDeferredValue:pr,useTransition:pr,useSyncExternalStore:pr,useId:pr,useHostTransitionStatus:pr,useFormState:pr,useActionState:pr,useOptimistic:pr,useMemoCache:pr,useCacheRefresh:pr};Bo.useEffectEvent=pr;var Ig={readContext:Yr,use:E0,useCallback:function(n,i){return xa().memoizedState=[n,i===void 0?null:i],n},useContext:Yr,useEffect:yg,useImperativeHandle:function(n,i,o){o=o!=null?o.concat([n]):null,k0(4194308,4,Sg.bind(null,i,n),o)},useLayoutEffect:function(n,i){return k0(4194308,4,n,i)},useInsertionEffect:function(n,i){k0(4,2,n,i)},useMemo:function(n,i){var o=xa();i=i===void 0?null:i;var f=n();if(Ei){Ma(!0);try{n()}finally{Ma(!1)}}return o.memoizedState=[f,i],f},useReducer:function(n,i,o){var f=xa();if(o!==void 0){var m=o(i);if(Ei){Ma(!0);try{o(i)}finally{Ma(!1)}}}else m=i;return f.memoizedState=f.baseState=m,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:m},f.queue=n,n=n.dispatch=db.bind(null,xt,n),[f.memoizedState,n]},useRef:function(n){var i=xa();return n={current:n},i.memoizedState=n},useState:function(n){n=Qf(n);var i=n.queue,o=Fg.bind(null,xt,i);return i.dispatch=o,[n.memoizedState,o]},useDebugValue:th,useDeferredValue:function(n,i){var o=xa();return rh(o,n,i)},useTransition:function(){var n=Qf(!1);return n=Cg.bind(null,xt,n.queue,!0,!1),xa().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,i,o){var f=xt,m=xa();if(Ot){if(o===void 0)throw Error(a(407));o=o()}else{if(o=i(),Zt===null)throw Error(a(349));(Ct&127)!==0||ag(f,i,o)}m.memoizedState=o;var p={value:o,getSnapshot:i};return m.queue=p,yg(sg.bind(null,f,p,n),[n]),f.flags|=2048,_l(9,{destroy:void 0},ng.bind(null,f,p,o,i),null),o},useId:function(){var n=xa(),i=Zt.identifierPrefix;if(Ot){var o=Dn,f=Rn;o=(f&~(1<<32-Wr(f)-1)).toString(32)+o,i="_"+i+"R_"+o,o=b0++,0<o&&(i+="H"+o.toString(32)),i+="_"}else o=ib++,i="_"+i+"r_"+o.toString(32)+"_";return n.memoizedState=i},useHostTransitionStatus:nh,useFormState:mg,useActionState:mg,useOptimistic:function(n){var i=xa();i.memoizedState=i.baseState=n;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=o,i=sh.bind(null,xt,!0,o),o.dispatch=i,[n,i]},useMemoCache:Kf,useCacheRefresh:function(){return xa().memoizedState=hb.bind(null,xt)},useEffectEvent:function(n){var i=xa(),o={impl:n};return i.memoizedState=o,function(){if((jt&2)!==0)throw Error(a(440));return o.impl.apply(void 0,arguments)}}},ih={readContext:Yr,use:E0,useCallback:Tg,useContext:Yr,useEffect:eh,useImperativeHandle:Eg,useInsertionEffect:wg,useLayoutEffect:bg,useMemo:kg,useReducer:T0,useRef:vg,useState:function(){return T0(Qn)},useDebugValue:th,useDeferredValue:function(n,i){var o=Er();return Ag(o,Wt.memoizedState,n,i)},useTransition:function(){var n=T0(Qn)[0],i=Er().memoizedState;return[typeof n=="boolean"?n:Lo(n),i]},useSyncExternalStore:rg,useId:Rg,useHostTransitionStatus:nh,useFormState:gg,useActionState:gg,useOptimistic:function(n,i){var o=Er();return og(o,Wt,n,i)},useMemoCache:Kf,useCacheRefresh:Dg};ih.useEffectEvent=_g;var Bg={readContext:Yr,use:E0,useCallback:Tg,useContext:Yr,useEffect:eh,useImperativeHandle:Eg,useInsertionEffect:wg,useLayoutEffect:bg,useMemo:kg,useReducer:Jf,useRef:vg,useState:function(){return Jf(Qn)},useDebugValue:th,useDeferredValue:function(n,i){var o=Er();return Wt===null?rh(o,n,i):Ag(o,Wt.memoizedState,n,i)},useTransition:function(){var n=Jf(Qn)[0],i=Er().memoizedState;return[typeof n=="boolean"?n:Lo(n),i]},useSyncExternalStore:rg,useId:Rg,useHostTransitionStatus:nh,useFormState:xg,useActionState:xg,useOptimistic:function(n,i){var o=Er();return Wt!==null?og(o,Wt,n,i):(o.baseState=n,[n,o.queue.dispatch])},useMemoCache:Kf,useCacheRefresh:Dg};Bg.useEffectEvent=_g;function lh(n,i,o,f){i=n.memoizedState,o=o(f,i),o=o==null?i:x({},i,o),n.memoizedState=o,n.lanes===0&&(n.updateQueue.baseState=o)}var oh={enqueueSetState:function(n,i,o){n=n._reactInternals;var f=za(),m=Ns(f);m.payload=i,o!=null&&(m.callback=o),i=Os(n,m,f),i!==null&&(Na(i,n,f),Ro(i,n,f))},enqueueReplaceState:function(n,i,o){n=n._reactInternals;var f=za(),m=Ns(f);m.tag=1,m.payload=i,o!=null&&(m.callback=o),i=Os(n,m,f),i!==null&&(Na(i,n,f),Ro(i,n,f))},enqueueForceUpdate:function(n,i){n=n._reactInternals;var o=za(),f=Ns(o);f.tag=2,i!=null&&(f.callback=i),i=Os(n,f,o),i!==null&&(Na(i,n,o),Ro(i,n,o))}};function jg(n,i,o,f,m,p,E){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(f,p,E):i.prototype&&i.prototype.isPureReactComponent?!So(o,f)||!So(m,p):!0}function Ug(n,i,o,f){n=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(o,f),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(o,f),i.state!==n&&oh.enqueueReplaceState(i,i.state,null)}function Ti(n,i){var o=i;if("ref"in i){o={};for(var f in i)f!=="ref"&&(o[f]=i[f])}if(n=n.defaultProps){o===i&&(o=x({},o));for(var m in n)o[m]===void 0&&(o[m]=n[m])}return o}function Pg(n){i0(n)}function zg(n){console.error(n)}function Hg(n){i0(n)}function N0(n,i){try{var o=n.onUncaughtError;o(i.value,{componentStack:i.stack})}catch(f){setTimeout(function(){throw f})}}function $g(n,i,o){try{var f=n.onCaughtError;f(o.value,{componentStack:o.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function ch(n,i,o){return o=Ns(o),o.tag=3,o.payload={element:null},o.callback=function(){N0(n,i)},o}function Vg(n){return n=Ns(n),n.tag=3,n}function Gg(n,i,o,f){var m=o.type.getDerivedStateFromError;if(typeof m=="function"){var p=f.value;n.payload=function(){return m(p)},n.callback=function(){$g(i,o,f)}}var E=o.stateNode;E!==null&&typeof E.componentDidCatch=="function"&&(n.callback=function(){$g(i,o,f),typeof m!="function"&&(Is===null?Is=new Set([this]):Is.add(this));var R=f.stack;this.componentDidCatch(f.value,{componentStack:R!==null?R:""})})}function mb(n,i,o,f,m){if(o.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){if(i=o.alternate,i!==null&&hl(i,o,m,!0),o=Ba.current,o!==null){switch(o.tag){case 31:case 13:return an===null?z0():o.alternate===null&&xr===0&&(xr=3),o.flags&=-257,o.flags|=65536,o.lanes=m,f===p0?o.flags|=16384:(i=o.updateQueue,i===null?o.updateQueue=new Set([f]):i.add(f),Mh(n,f,m)),!1;case 22:return o.flags|=65536,f===p0?o.flags|=16384:(i=o.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([f])},o.updateQueue=i):(o=i.retryQueue,o===null?i.retryQueue=new Set([f]):o.add(f)),Mh(n,f,m)),!1}throw Error(a(435,o.tag))}return Mh(n,f,m),z0(),!1}if(Ot)return i=Ba.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=m,f!==Cf&&(n=Error(a(422),{cause:f}),ko(Za(n,o)))):(f!==Cf&&(i=Error(a(423),{cause:f}),ko(Za(i,o))),n=n.current.alternate,n.flags|=65536,m&=-m,n.lanes|=m,f=Za(f,o),m=ch(n.stateNode,f,m),Uf(n,m),xr!==4&&(xr=2)),!1;var p=Error(a(520),{cause:f});if(p=Za(p,o),Go===null?Go=[p]:Go.push(p),xr!==4&&(xr=2),i===null)return!0;f=Za(f,o),o=i;do{switch(o.tag){case 3:return o.flags|=65536,n=m&-m,o.lanes|=n,n=ch(o.stateNode,f,n),Uf(o,n),!1;case 1:if(i=o.type,p=o.stateNode,(o.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||p!==null&&typeof p.componentDidCatch=="function"&&(Is===null||!Is.has(p))))return o.flags|=65536,m&=-m,o.lanes|=m,m=Vg(m),Gg(m,n,o,f),Uf(o,m),!1}o=o.return}while(o!==null);return!1}var uh=Error(a(461)),Or=!1;function Jr(n,i,o,f){i.child=n===null?K1(i,null,o,f):Si(i,n.child,o,f)}function qg(n,i,o,f,m){o=o.render;var p=i.ref;if("ref"in f){var E={};for(var R in f)R!=="ref"&&(E[R]=f[R])}else E=f;return yi(i),f=Gf(n,i,o,E,p,m),R=qf(),n!==null&&!Or?(Xf(n,i,m),Zn(n,i,m)):(Ot&&R&&kf(i),i.flags|=1,Jr(n,i,f,m),i.child)}function Xg(n,i,o,f,m){if(n===null){var p=o.type;return typeof p=="function"&&!Sf(p)&&p.defaultProps===void 0&&o.compare===null?(i.tag=15,i.type=p,Wg(n,i,p,f,m)):(n=u0(o.type,null,f,i,i.mode,m),n.ref=i.ref,n.return=i,i.child=n)}if(p=n.child,!vh(n,m)){var E=p.memoizedProps;if(o=o.compare,o=o!==null?o:So,o(E,f)&&n.ref===i.ref)return Zn(n,i,m)}return i.flags|=1,n=Xn(p,f),n.ref=i.ref,n.return=i,i.child=n}function Wg(n,i,o,f,m){if(n!==null){var p=n.memoizedProps;if(So(p,f)&&n.ref===i.ref)if(Or=!1,i.pendingProps=f=p,vh(n,m))(n.flags&131072)!==0&&(Or=!0);else return i.lanes=n.lanes,Zn(n,i,m)}return fh(n,i,o,f,m)}function Kg(n,i,o,f){var m=f.children,p=n!==null?n.memoizedState:null;if(n===null&&i.stateNode===null&&(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),f.mode==="hidden"){if((i.flags&128)!==0){if(p=p!==null?p.baseLanes|o:o,n!==null){for(f=i.child=n.child,m=0;f!==null;)m=m|f.lanes|f.childLanes,f=f.sibling;f=m&~p}else f=0,i.child=null;return Yg(n,i,p,o,f)}if((o&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},n!==null&&m0(i,p!==null?p.cachePool:null),p!==null?Q1(i,p):zf(),Z1(i);else return f=i.lanes=536870912,Yg(n,i,p!==null?p.baseLanes|o:o,o,f)}else p!==null?(m0(i,p.cachePool),Q1(i,p),Ds(),i.memoizedState=null):(n!==null&&m0(i,null),zf(),Ds());return Jr(n,i,m,o),i.child}function jo(n,i){return n!==null&&n.tag===22||i.stateNode!==null||(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.sibling}function Yg(n,i,o,f,m){var p=Lf();return p=p===null?null:{parent:Cr._currentValue,pool:p},i.memoizedState={baseLanes:o,cachePool:p},n!==null&&m0(i,null),zf(),Z1(i),n!==null&&hl(n,i,f,!0),i.childLanes=m,null}function O0(n,i){return i=D0({mode:i.mode,children:i.children},n.mode),i.ref=n.ref,n.child=i,i.return=n,i}function Jg(n,i,o){return Si(i,n.child,null,o),n=O0(i,i.pendingProps),n.flags|=2,ja(i),i.memoizedState=null,n}function gb(n,i,o){var f=i.pendingProps,m=(i.flags&128)!==0;if(i.flags&=-129,n===null){if(Ot){if(f.mode==="hidden")return n=O0(i,f),i.lanes=536870912,jo(null,n);if($f(i),(n=ar)?(n=cx(n,rn),n=n!==null&&n.data==="&"?n:null,n!==null&&(i.memoizedState={dehydrated:n,treeContext:Es!==null?{id:Rn,overflow:Dn}:null,retryLane:536870912,hydrationErrors:null},o=M1(n),o.return=i,i.child=o,Kr=i,ar=null)):n=null,n===null)throw ks(i);return i.lanes=536870912,null}return O0(i,f)}var p=n.memoizedState;if(p!==null){var E=p.dehydrated;if($f(i),m)if(i.flags&256)i.flags&=-257,i=Jg(n,i,o);else if(i.memoizedState!==null)i.child=n.child,i.flags|=128,i=null;else throw Error(a(558));else if(Or||hl(n,i,o,!1),m=(o&n.childLanes)!==0,Or||m){if(f=Zt,f!==null&&(E=On(f,o),E!==0&&E!==p.retryLane))throw p.retryLane=E,gi(n,E),Na(f,n,E),uh;z0(),i=Jg(n,i,o)}else n=p.treeContext,ar=nn(E.nextSibling),Kr=i,Ot=!0,Ts=null,rn=!1,n!==null&&B1(i,n),i=O0(i,f),i.flags|=4096;return i}return n=Xn(n.child,{mode:f.mode,children:f.children}),n.ref=i.ref,i.child=n,n.return=i,n}function R0(n,i){var o=i.ref;if(o===null)n!==null&&n.ref!==null&&(i.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(a(284));(n===null||n.ref!==o)&&(i.flags|=4194816)}}function fh(n,i,o,f,m){return yi(i),o=Gf(n,i,o,f,void 0,m),f=qf(),n!==null&&!Or?(Xf(n,i,m),Zn(n,i,m)):(Ot&&f&&kf(i),i.flags|=1,Jr(n,i,o,m),i.child)}function Qg(n,i,o,f,m,p){return yi(i),i.updateQueue=null,o=tg(i,f,o,m),eg(n),f=qf(),n!==null&&!Or?(Xf(n,i,p),Zn(n,i,p)):(Ot&&f&&kf(i),i.flags|=1,Jr(n,i,o,p),i.child)}function Zg(n,i,o,f,m){if(yi(i),i.stateNode===null){var p=ol,E=o.contextType;typeof E=="object"&&E!==null&&(p=Yr(E)),p=new o(f,p),i.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,p.updater=oh,i.stateNode=p,p._reactInternals=i,p=i.stateNode,p.props=f,p.state=i.memoizedState,p.refs={},Bf(i),E=o.contextType,p.context=typeof E=="object"&&E!==null?Yr(E):ol,p.state=i.memoizedState,E=o.getDerivedStateFromProps,typeof E=="function"&&(lh(i,o,E,f),p.state=i.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof p.getSnapshotBeforeUpdate=="function"||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(E=p.state,typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount(),E!==p.state&&oh.enqueueReplaceState(p,p.state,null),Fo(i,f,p,m),Do(),p.state=i.memoizedState),typeof p.componentDidMount=="function"&&(i.flags|=4194308),f=!0}else if(n===null){p=i.stateNode;var R=i.memoizedProps,W=Ti(o,R);p.props=W;var ue=p.context,we=o.contextType;E=ol,typeof we=="object"&&we!==null&&(E=Yr(we));var ke=o.getDerivedStateFromProps;we=typeof ke=="function"||typeof p.getSnapshotBeforeUpdate=="function",R=i.pendingProps!==R,we||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(R||ue!==E)&&Ug(i,p,f,E),Cs=!1;var de=i.memoizedState;p.state=de,Fo(i,f,p,m),Do(),ue=i.memoizedState,R||de!==ue||Cs?(typeof ke=="function"&&(lh(i,o,ke,f),ue=i.memoizedState),(W=Cs||jg(i,o,W,f,de,ue,E))?(we||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount()),typeof p.componentDidMount=="function"&&(i.flags|=4194308)):(typeof p.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=f,i.memoizedState=ue),p.props=f,p.state=ue,p.context=E,f=W):(typeof p.componentDidMount=="function"&&(i.flags|=4194308),f=!1)}else{p=i.stateNode,jf(n,i),E=i.memoizedProps,we=Ti(o,E),p.props=we,ke=i.pendingProps,de=p.context,ue=o.contextType,W=ol,typeof ue=="object"&&ue!==null&&(W=Yr(ue)),R=o.getDerivedStateFromProps,(ue=typeof R=="function"||typeof p.getSnapshotBeforeUpdate=="function")||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(E!==ke||de!==W)&&Ug(i,p,f,W),Cs=!1,de=i.memoizedState,p.state=de,Fo(i,f,p,m),Do();var me=i.memoizedState;E!==ke||de!==me||Cs||n!==null&&n.dependencies!==null&&h0(n.dependencies)?(typeof R=="function"&&(lh(i,o,R,f),me=i.memoizedState),(we=Cs||jg(i,o,we,f,de,me,W)||n!==null&&n.dependencies!==null&&h0(n.dependencies))?(ue||typeof p.UNSAFE_componentWillUpdate!="function"&&typeof p.componentWillUpdate!="function"||(typeof p.componentWillUpdate=="function"&&p.componentWillUpdate(f,me,W),typeof p.UNSAFE_componentWillUpdate=="function"&&p.UNSAFE_componentWillUpdate(f,me,W)),typeof p.componentDidUpdate=="function"&&(i.flags|=4),typeof p.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof p.componentDidUpdate!="function"||E===n.memoizedProps&&de===n.memoizedState||(i.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||E===n.memoizedProps&&de===n.memoizedState||(i.flags|=1024),i.memoizedProps=f,i.memoizedState=me),p.props=f,p.state=me,p.context=W,f=we):(typeof p.componentDidUpdate!="function"||E===n.memoizedProps&&de===n.memoizedState||(i.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||E===n.memoizedProps&&de===n.memoizedState||(i.flags|=1024),f=!1)}return p=f,R0(n,i),f=(i.flags&128)!==0,p||f?(p=i.stateNode,o=f&&typeof o.getDerivedStateFromError!="function"?null:p.render(),i.flags|=1,n!==null&&f?(i.child=Si(i,n.child,null,m),i.child=Si(i,null,o,m)):Jr(n,i,o,m),i.memoizedState=p.state,n=i.child):n=Zn(n,i,m),n}function ep(n,i,o,f){return xi(),i.flags|=256,Jr(n,i,o,f),i.child}var hh={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function dh(n){return{baseLanes:n,cachePool:$1()}}function mh(n,i,o){return n=n!==null?n.childLanes&~o:0,i&&(n|=Pa),n}function tp(n,i,o){var f=i.pendingProps,m=!1,p=(i.flags&128)!==0,E;if((E=p)||(E=n!==null&&n.memoizedState===null?!1:(Sr.current&2)!==0),E&&(m=!0,i.flags&=-129),E=(i.flags&32)!==0,i.flags&=-33,n===null){if(Ot){if(m?Rs(i):Ds(),(n=ar)?(n=cx(n,rn),n=n!==null&&n.data!=="&"?n:null,n!==null&&(i.memoizedState={dehydrated:n,treeContext:Es!==null?{id:Rn,overflow:Dn}:null,retryLane:536870912,hydrationErrors:null},o=M1(n),o.return=i,i.child=o,Kr=i,ar=null)):n=null,n===null)throw ks(i);return Yh(n)?i.lanes=32:i.lanes=536870912,null}var R=f.children;return f=f.fallback,m?(Ds(),m=i.mode,R=D0({mode:"hidden",children:R},m),f=pi(f,m,o,null),R.return=i,f.return=i,R.sibling=f,i.child=R,f=i.child,f.memoizedState=dh(o),f.childLanes=mh(n,E,o),i.memoizedState=hh,jo(null,f)):(Rs(i),gh(i,R))}var W=n.memoizedState;if(W!==null&&(R=W.dehydrated,R!==null)){if(p)i.flags&256?(Rs(i),i.flags&=-257,i=ph(n,i,o)):i.memoizedState!==null?(Ds(),i.child=n.child,i.flags|=128,i=null):(Ds(),R=f.fallback,m=i.mode,f=D0({mode:"visible",children:f.children},m),R=pi(R,m,o,null),R.flags|=2,f.return=i,R.return=i,f.sibling=R,i.child=f,Si(i,n.child,null,o),f=i.child,f.memoizedState=dh(o),f.childLanes=mh(n,E,o),i.memoizedState=hh,i=jo(null,f));else if(Rs(i),Yh(R)){if(E=R.nextSibling&&R.nextSibling.dataset,E)var ue=E.dgst;E=ue,f=Error(a(419)),f.stack="",f.digest=E,ko({value:f,source:null,stack:null}),i=ph(n,i,o)}else if(Or||hl(n,i,o,!1),E=(o&n.childLanes)!==0,Or||E){if(E=Zt,E!==null&&(f=On(E,o),f!==0&&f!==W.retryLane))throw W.retryLane=f,gi(n,f),Na(E,n,f),uh;Kh(R)||z0(),i=ph(n,i,o)}else Kh(R)?(i.flags|=192,i.child=n.child,i=null):(n=W.treeContext,ar=nn(R.nextSibling),Kr=i,Ot=!0,Ts=null,rn=!1,n!==null&&B1(i,n),i=gh(i,f.children),i.flags|=4096);return i}return m?(Ds(),R=f.fallback,m=i.mode,W=n.child,ue=W.sibling,f=Xn(W,{mode:"hidden",children:f.children}),f.subtreeFlags=W.subtreeFlags&65011712,ue!==null?R=Xn(ue,R):(R=pi(R,m,o,null),R.flags|=2),R.return=i,f.return=i,f.sibling=R,i.child=f,jo(null,f),f=i.child,R=n.child.memoizedState,R===null?R=dh(o):(m=R.cachePool,m!==null?(W=Cr._currentValue,m=m.parent!==W?{parent:W,pool:W}:m):m=$1(),R={baseLanes:R.baseLanes|o,cachePool:m}),f.memoizedState=R,f.childLanes=mh(n,E,o),i.memoizedState=hh,jo(n.child,f)):(Rs(i),o=n.child,n=o.sibling,o=Xn(o,{mode:"visible",children:f.children}),o.return=i,o.sibling=null,n!==null&&(E=i.deletions,E===null?(i.deletions=[n],i.flags|=16):E.push(n)),i.child=o,i.memoizedState=null,o)}function gh(n,i){return i=D0({mode:"visible",children:i},n.mode),i.return=n,n.child=i}function D0(n,i){return n=Ia(22,n,null,i),n.lanes=0,n}function ph(n,i,o){return Si(i,n.child,null,o),n=gh(i,i.pendingProps.children),n.flags|=2,i.memoizedState=null,n}function rp(n,i,o){n.lanes|=i;var f=n.alternate;f!==null&&(f.lanes|=i),Rf(n.return,i,o)}function xh(n,i,o,f,m,p){var E=n.memoizedState;E===null?n.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:f,tail:o,tailMode:m,treeForkCount:p}:(E.isBackwards=i,E.rendering=null,E.renderingStartTime=0,E.last=f,E.tail=o,E.tailMode=m,E.treeForkCount=p)}function ap(n,i,o){var f=i.pendingProps,m=f.revealOrder,p=f.tail;f=f.children;var E=Sr.current,R=(E&2)!==0;if(R?(E=E&1|2,i.flags|=128):E&=1,V(Sr,E),Jr(n,i,f,o),f=Ot?To:0,!R&&n!==null&&(n.flags&128)!==0)e:for(n=i.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&rp(n,o,i);else if(n.tag===19)rp(n,o,i);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===i)break e;for(;n.sibling===null;){if(n.return===null||n.return===i)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}switch(m){case"forwards":for(o=i.child,m=null;o!==null;)n=o.alternate,n!==null&&_0(n)===null&&(m=o),o=o.sibling;o=m,o===null?(m=i.child,i.child=null):(m=o.sibling,o.sibling=null),xh(i,!1,m,o,p,f);break;case"backwards":case"unstable_legacy-backwards":for(o=null,m=i.child,i.child=null;m!==null;){if(n=m.alternate,n!==null&&_0(n)===null){i.child=m;break}n=m.sibling,m.sibling=o,o=m,m=n}xh(i,!0,o,null,p,f);break;case"together":xh(i,!1,null,null,void 0,f);break;default:i.memoizedState=null}return i.child}function Zn(n,i,o){if(n!==null&&(i.dependencies=n.dependencies),Ls|=i.lanes,(o&i.childLanes)===0)if(n!==null){if(hl(n,i,o,!1),(o&i.childLanes)===0)return null}else return null;if(n!==null&&i.child!==n.child)throw Error(a(153));if(i.child!==null){for(n=i.child,o=Xn(n,n.pendingProps),i.child=o,o.return=i;n.sibling!==null;)n=n.sibling,o=o.sibling=Xn(n,n.pendingProps),o.return=i;o.sibling=null}return i.child}function vh(n,i){return(n.lanes&i)!==0?!0:(n=n.dependencies,!!(n!==null&&h0(n)))}function pb(n,i,o){switch(i.tag){case 3:Ee(i,i.stateNode.containerInfo),As(i,Cr,n.memoizedState.cache),xi();break;case 27:case 5:Ae(i);break;case 4:Ee(i,i.stateNode.containerInfo);break;case 10:As(i,i.type,i.memoizedProps.value);break;case 31:if(i.memoizedState!==null)return i.flags|=128,$f(i),null;break;case 13:var f=i.memoizedState;if(f!==null)return f.dehydrated!==null?(Rs(i),i.flags|=128,null):(o&i.child.childLanes)!==0?tp(n,i,o):(Rs(i),n=Zn(n,i,o),n!==null?n.sibling:null);Rs(i);break;case 19:var m=(n.flags&128)!==0;if(f=(o&i.childLanes)!==0,f||(hl(n,i,o,!1),f=(o&i.childLanes)!==0),m){if(f)return ap(n,i,o);i.flags|=128}if(m=i.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),V(Sr,Sr.current),f)break;return null;case 22:return i.lanes=0,Kg(n,i,o,i.pendingProps);case 24:As(i,Cr,n.memoizedState.cache)}return Zn(n,i,o)}function np(n,i,o){if(n!==null)if(n.memoizedProps!==i.pendingProps)Or=!0;else{if(!vh(n,o)&&(i.flags&128)===0)return Or=!1,pb(n,i,o);Or=(n.flags&131072)!==0}else Or=!1,Ot&&(i.flags&1048576)!==0&&I1(i,To,i.index);switch(i.lanes=0,i.tag){case 16:e:{var f=i.pendingProps;if(n=wi(i.elementType),i.type=n,typeof n=="function")Sf(n)?(f=Ti(n,f),i.tag=1,i=Zg(null,i,n,f,o)):(i.tag=0,i=fh(null,i,n,f,o));else{if(n!=null){var m=n.$$typeof;if(m===j){i.tag=11,i=qg(null,i,n,f,o);break e}else if(m===C){i.tag=14,i=Xg(null,i,n,f,o);break e}}throw i=Ce(n)||n,Error(a(306,i,""))}}return i;case 0:return fh(n,i,i.type,i.pendingProps,o);case 1:return f=i.type,m=Ti(f,i.pendingProps),Zg(n,i,f,m,o);case 3:e:{if(Ee(i,i.stateNode.containerInfo),n===null)throw Error(a(387));f=i.pendingProps;var p=i.memoizedState;m=p.element,jf(n,i),Fo(i,f,null,o);var E=i.memoizedState;if(f=E.cache,As(i,Cr,f),f!==p.cache&&Df(i,[Cr],o,!0),Do(),f=E.element,p.isDehydrated)if(p={element:f,isDehydrated:!1,cache:E.cache},i.updateQueue.baseState=p,i.memoizedState=p,i.flags&256){i=ep(n,i,f,o);break e}else if(f!==m){m=Za(Error(a(424)),i),ko(m),i=ep(n,i,f,o);break e}else for(n=i.stateNode.containerInfo,n.nodeType===9?n=n.body:n=n.nodeName==="HTML"?n.ownerDocument.body:n,ar=nn(n.firstChild),Kr=i,Ot=!0,Ts=null,rn=!0,o=K1(i,null,f,o),i.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(xi(),f===m){i=Zn(n,i,o);break e}Jr(n,i,f,o)}i=i.child}return i;case 26:return R0(n,i),n===null?(o=gx(i.type,null,i.pendingProps,null))?i.memoizedState=o:Ot||(o=i.type,n=i.pendingProps,f=W0(te.current).createElement(o),f[F]=i,f[B]=n,Qr(f,o,n),We(f),i.stateNode=f):i.memoizedState=gx(i.type,n.memoizedProps,i.pendingProps,n.memoizedState),null;case 27:return Ae(i),n===null&&Ot&&(f=i.stateNode=hx(i.type,i.pendingProps,te.current),Kr=i,rn=!0,m=ar,Ps(i.type)?(Jh=m,ar=nn(f.firstChild)):ar=m),Jr(n,i,i.pendingProps.children,o),R0(n,i),n===null&&(i.flags|=4194304),i.child;case 5:return n===null&&Ot&&((m=f=ar)&&(f=qb(f,i.type,i.pendingProps,rn),f!==null?(i.stateNode=f,Kr=i,ar=nn(f.firstChild),rn=!1,m=!0):m=!1),m||ks(i)),Ae(i),m=i.type,p=i.pendingProps,E=n!==null?n.memoizedProps:null,f=p.children,qh(m,p)?f=null:E!==null&&qh(m,E)&&(i.flags|=32),i.memoizedState!==null&&(m=Gf(n,i,lb,null,null,o),Zo._currentValue=m),R0(n,i),Jr(n,i,f,o),i.child;case 6:return n===null&&Ot&&((n=o=ar)&&(o=Xb(o,i.pendingProps,rn),o!==null?(i.stateNode=o,Kr=i,ar=null,n=!0):n=!1),n||ks(i)),null;case 13:return tp(n,i,o);case 4:return Ee(i,i.stateNode.containerInfo),f=i.pendingProps,n===null?i.child=Si(i,null,f,o):Jr(n,i,f,o),i.child;case 11:return qg(n,i,i.type,i.pendingProps,o);case 7:return Jr(n,i,i.pendingProps,o),i.child;case 8:return Jr(n,i,i.pendingProps.children,o),i.child;case 12:return Jr(n,i,i.pendingProps.children,o),i.child;case 10:return f=i.pendingProps,As(i,i.type,f.value),Jr(n,i,f.children,o),i.child;case 9:return m=i.type._context,f=i.pendingProps.children,yi(i),m=Yr(m),f=f(m),i.flags|=1,Jr(n,i,f,o),i.child;case 14:return Xg(n,i,i.type,i.pendingProps,o);case 15:return Wg(n,i,i.type,i.pendingProps,o);case 19:return ap(n,i,o);case 31:return gb(n,i,o);case 22:return Kg(n,i,o,i.pendingProps);case 24:return yi(i),f=Yr(Cr),n===null?(m=Lf(),m===null&&(m=Zt,p=Ff(),m.pooledCache=p,p.refCount++,p!==null&&(m.pooledCacheLanes|=o),m=p),i.memoizedState={parent:f,cache:m},Bf(i),As(i,Cr,m)):((n.lanes&o)!==0&&(jf(n,i),Fo(i,null,null,o),Do()),m=n.memoizedState,p=i.memoizedState,m.parent!==f?(m={parent:f,cache:f},i.memoizedState=m,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=m),As(i,Cr,f)):(f=p.cache,As(i,Cr,f),f!==m.cache&&Df(i,[Cr],o,!0))),Jr(n,i,i.pendingProps.children,o),i.child;case 29:throw i.pendingProps}throw Error(a(156,i.tag))}function es(n){n.flags|=4}function yh(n,i,o,f,m){if((i=(n.mode&32)!==0)&&(i=!1),i){if(n.flags|=16777216,(m&335544128)===m)if(n.stateNode.complete)n.flags|=8192;else if(Rp())n.flags|=8192;else throw bi=p0,If}else n.flags&=-16777217}function sp(n,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!_x(i))if(Rp())n.flags|=8192;else throw bi=p0,If}function F0(n,i){i!==null&&(n.flags|=4),n.flags&16384&&(i=n.tag!==22?tl():536870912,n.lanes|=i,El|=i)}function Uo(n,i){if(!Ot)switch(n.tailMode){case"hidden":i=n.tail;for(var o=null;i!==null;)i.alternate!==null&&(o=i),i=i.sibling;o===null?n.tail=null:o.sibling=null;break;case"collapsed":o=n.tail;for(var f=null;o!==null;)o.alternate!==null&&(f=o),o=o.sibling;f===null?i||n.tail===null?n.tail=null:n.tail.sibling=null:f.sibling=null}}function nr(n){var i=n.alternate!==null&&n.alternate.child===n.child,o=0,f=0;if(i)for(var m=n.child;m!==null;)o|=m.lanes|m.childLanes,f|=m.subtreeFlags&65011712,f|=m.flags&65011712,m.return=n,m=m.sibling;else for(m=n.child;m!==null;)o|=m.lanes|m.childLanes,f|=m.subtreeFlags,f|=m.flags,m.return=n,m=m.sibling;return n.subtreeFlags|=f,n.childLanes=o,i}function xb(n,i,o){var f=i.pendingProps;switch(Af(i),i.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return nr(i),null;case 1:return nr(i),null;case 3:return o=i.stateNode,f=null,n!==null&&(f=n.memoizedState.cache),i.memoizedState.cache!==f&&(i.flags|=2048),Yn(Cr),ye(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(n===null||n.child===null)&&(fl(i)?es(i):n===null||n.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,Nf())),nr(i),null;case 26:var m=i.type,p=i.memoizedState;return n===null?(es(i),p!==null?(nr(i),sp(i,p)):(nr(i),yh(i,m,null,f,o))):p?p!==n.memoizedState?(es(i),nr(i),sp(i,p)):(nr(i),i.flags&=-16777217):(n=n.memoizedProps,n!==f&&es(i),nr(i),yh(i,m,n,f,o)),null;case 27:if(tt(i),o=te.current,m=i.type,n!==null&&i.stateNode!=null)n.memoizedProps!==f&&es(i);else{if(!f){if(i.stateNode===null)throw Error(a(166));return nr(i),null}n=M.current,fl(i)?j1(i):(n=hx(m,f,o),i.stateNode=n,es(i))}return nr(i),null;case 5:if(tt(i),m=i.type,n!==null&&i.stateNode!=null)n.memoizedProps!==f&&es(i);else{if(!f){if(i.stateNode===null)throw Error(a(166));return nr(i),null}if(p=M.current,fl(i))j1(i);else{var E=W0(te.current);switch(p){case 1:p=E.createElementNS("http://www.w3.org/2000/svg",m);break;case 2:p=E.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;default:switch(m){case"svg":p=E.createElementNS("http://www.w3.org/2000/svg",m);break;case"math":p=E.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;case"script":p=E.createElement("div"),p.innerHTML="<script><\/script>",p=p.removeChild(p.firstChild);break;case"select":p=typeof f.is=="string"?E.createElement("select",{is:f.is}):E.createElement("select"),f.multiple?p.multiple=!0:f.size&&(p.size=f.size);break;default:p=typeof f.is=="string"?E.createElement(m,{is:f.is}):E.createElement(m)}}p[F]=i,p[B]=f;e:for(E=i.child;E!==null;){if(E.tag===5||E.tag===6)p.appendChild(E.stateNode);else if(E.tag!==4&&E.tag!==27&&E.child!==null){E.child.return=E,E=E.child;continue}if(E===i)break e;for(;E.sibling===null;){if(E.return===null||E.return===i)break e;E=E.return}E.sibling.return=E.return,E=E.sibling}i.stateNode=p;e:switch(Qr(p,m,f),m){case"button":case"input":case"select":case"textarea":f=!!f.autoFocus;break e;case"img":f=!0;break e;default:f=!1}f&&es(i)}}return nr(i),yh(i,i.type,n===null?null:n.memoizedProps,i.pendingProps,o),null;case 6:if(n&&i.stateNode!=null)n.memoizedProps!==f&&es(i);else{if(typeof f!="string"&&i.stateNode===null)throw Error(a(166));if(n=te.current,fl(i)){if(n=i.stateNode,o=i.memoizedProps,f=null,m=Kr,m!==null)switch(m.tag){case 27:case 5:f=m.memoizedProps}n[F]=i,n=!!(n.nodeValue===o||f!==null&&f.suppressHydrationWarning===!0||tx(n.nodeValue,o)),n||ks(i,!0)}else n=W0(n).createTextNode(f),n[F]=i,i.stateNode=n}return nr(i),null;case 31:if(o=i.memoizedState,n===null||n.memoizedState!==null){if(f=fl(i),o!==null){if(n===null){if(!f)throw Error(a(318));if(n=i.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(a(557));n[F]=i}else xi(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;nr(i),n=!1}else o=Nf(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=o),n=!0;if(!n)return i.flags&256?(ja(i),i):(ja(i),null);if((i.flags&128)!==0)throw Error(a(558))}return nr(i),null;case 13:if(f=i.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(m=fl(i),f!==null&&f.dehydrated!==null){if(n===null){if(!m)throw Error(a(318));if(m=i.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(a(317));m[F]=i}else xi(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;nr(i),m=!1}else m=Nf(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=m),m=!0;if(!m)return i.flags&256?(ja(i),i):(ja(i),null)}return ja(i),(i.flags&128)!==0?(i.lanes=o,i):(o=f!==null,n=n!==null&&n.memoizedState!==null,o&&(f=i.child,m=null,f.alternate!==null&&f.alternate.memoizedState!==null&&f.alternate.memoizedState.cachePool!==null&&(m=f.alternate.memoizedState.cachePool.pool),p=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(p=f.memoizedState.cachePool.pool),p!==m&&(f.flags|=2048)),o!==n&&o&&(i.child.flags|=8192),F0(i,i.updateQueue),nr(i),null);case 4:return ye(),n===null&&zh(i.stateNode.containerInfo),nr(i),null;case 10:return Yn(i.type),nr(i),null;case 19:if(N(Sr),f=i.memoizedState,f===null)return nr(i),null;if(m=(i.flags&128)!==0,p=f.rendering,p===null)if(m)Uo(f,!1);else{if(xr!==0||n!==null&&(n.flags&128)!==0)for(n=i.child;n!==null;){if(p=_0(n),p!==null){for(i.flags|=128,Uo(f,!1),n=p.updateQueue,i.updateQueue=n,F0(i,n),i.subtreeFlags=0,n=o,o=i.child;o!==null;)F1(o,n),o=o.sibling;return V(Sr,Sr.current&1|2),Ot&&Wn(i,f.treeForkCount),i.child}n=n.sibling}f.tail!==null&&Mt()>j0&&(i.flags|=128,m=!0,Uo(f,!1),i.lanes=4194304)}else{if(!m)if(n=_0(p),n!==null){if(i.flags|=128,m=!0,n=n.updateQueue,i.updateQueue=n,F0(i,n),Uo(f,!0),f.tail===null&&f.tailMode==="hidden"&&!p.alternate&&!Ot)return nr(i),null}else 2*Mt()-f.renderingStartTime>j0&&o!==536870912&&(i.flags|=128,m=!0,Uo(f,!1),i.lanes=4194304);f.isBackwards?(p.sibling=i.child,i.child=p):(n=f.last,n!==null?n.sibling=p:i.child=p,f.last=p)}return f.tail!==null?(n=f.tail,f.rendering=n,f.tail=n.sibling,f.renderingStartTime=Mt(),n.sibling=null,o=Sr.current,V(Sr,m?o&1|2:o&1),Ot&&Wn(i,f.treeForkCount),n):(nr(i),null);case 22:case 23:return ja(i),Hf(),f=i.memoizedState!==null,n!==null?n.memoizedState!==null!==f&&(i.flags|=8192):f&&(i.flags|=8192),f?(o&536870912)!==0&&(i.flags&128)===0&&(nr(i),i.subtreeFlags&6&&(i.flags|=8192)):nr(i),o=i.updateQueue,o!==null&&F0(i,o.retryQueue),o=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),f=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(f=i.memoizedState.cachePool.pool),f!==o&&(i.flags|=2048),n!==null&&N(_i),null;case 24:return o=null,n!==null&&(o=n.memoizedState.cache),i.memoizedState.cache!==o&&(i.flags|=2048),Yn(Cr),nr(i),null;case 25:return null;case 30:return null}throw Error(a(156,i.tag))}function vb(n,i){switch(Af(i),i.tag){case 1:return n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 3:return Yn(Cr),ye(),n=i.flags,(n&65536)!==0&&(n&128)===0?(i.flags=n&-65537|128,i):null;case 26:case 27:case 5:return tt(i),null;case 31:if(i.memoizedState!==null){if(ja(i),i.alternate===null)throw Error(a(340));xi()}return n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 13:if(ja(i),n=i.memoizedState,n!==null&&n.dehydrated!==null){if(i.alternate===null)throw Error(a(340));xi()}return n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 19:return N(Sr),null;case 4:return ye(),null;case 10:return Yn(i.type),null;case 22:case 23:return ja(i),Hf(),n!==null&&N(_i),n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 24:return Yn(Cr),null;case 25:return null;default:return null}}function ip(n,i){switch(Af(i),i.tag){case 3:Yn(Cr),ye();break;case 26:case 27:case 5:tt(i);break;case 4:ye();break;case 31:i.memoizedState!==null&&ja(i);break;case 13:ja(i);break;case 19:N(Sr);break;case 10:Yn(i.type);break;case 22:case 23:ja(i),Hf(),n!==null&&N(_i);break;case 24:Yn(Cr)}}function Po(n,i){try{var o=i.updateQueue,f=o!==null?o.lastEffect:null;if(f!==null){var m=f.next;o=m;do{if((o.tag&n)===n){f=void 0;var p=o.create,E=o.inst;f=p(),E.destroy=f}o=o.next}while(o!==m)}}catch(R){Pt(i,i.return,R)}}function Fs(n,i,o){try{var f=i.updateQueue,m=f!==null?f.lastEffect:null;if(m!==null){var p=m.next;f=p;do{if((f.tag&n)===n){var E=f.inst,R=E.destroy;if(R!==void 0){E.destroy=void 0,m=i;var W=o,ue=R;try{ue()}catch(we){Pt(m,W,we)}}}f=f.next}while(f!==p)}}catch(we){Pt(i,i.return,we)}}function lp(n){var i=n.updateQueue;if(i!==null){var o=n.stateNode;try{J1(i,o)}catch(f){Pt(n,n.return,f)}}}function op(n,i,o){o.props=Ti(n.type,n.memoizedProps),o.state=n.memoizedState;try{o.componentWillUnmount()}catch(f){Pt(n,i,f)}}function zo(n,i){try{var o=n.ref;if(o!==null){switch(n.tag){case 26:case 27:case 5:var f=n.stateNode;break;case 30:f=n.stateNode;break;default:f=n.stateNode}typeof o=="function"?n.refCleanup=o(f):o.current=f}}catch(m){Pt(n,i,m)}}function Fn(n,i){var o=n.ref,f=n.refCleanup;if(o!==null)if(typeof f=="function")try{f()}catch(m){Pt(n,i,m)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(m){Pt(n,i,m)}else o.current=null}function cp(n){var i=n.type,o=n.memoizedProps,f=n.stateNode;try{e:switch(i){case"button":case"input":case"select":case"textarea":o.autoFocus&&f.focus();break e;case"img":o.src?f.src=o.src:o.srcSet&&(f.srcset=o.srcSet)}}catch(m){Pt(n,n.return,m)}}function _h(n,i,o){try{var f=n.stateNode;Pb(f,n.type,o,i),f[B]=i}catch(m){Pt(n,n.return,m)}}function up(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&Ps(n.type)||n.tag===4}function wh(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||up(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&Ps(n.type)||n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function bh(n,i,o){var f=n.tag;if(f===5||f===6)n=n.stateNode,i?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(n,i):(i=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,i.appendChild(n),o=o._reactRootContainer,o!=null||i.onclick!==null||(i.onclick=Gn));else if(f!==4&&(f===27&&Ps(n.type)&&(o=n.stateNode,i=null),n=n.child,n!==null))for(bh(n,i,o),n=n.sibling;n!==null;)bh(n,i,o),n=n.sibling}function M0(n,i,o){var f=n.tag;if(f===5||f===6)n=n.stateNode,i?o.insertBefore(n,i):o.appendChild(n);else if(f!==4&&(f===27&&Ps(n.type)&&(o=n.stateNode),n=n.child,n!==null))for(M0(n,i,o),n=n.sibling;n!==null;)M0(n,i,o),n=n.sibling}function fp(n){var i=n.stateNode,o=n.memoizedProps;try{for(var f=n.type,m=i.attributes;m.length;)i.removeAttributeNode(m[0]);Qr(i,f,o),i[F]=n,i[B]=o}catch(p){Pt(n,n.return,p)}}var ts=!1,Rr=!1,Sh=!1,hp=typeof WeakSet=="function"?WeakSet:Set,Hr=null;function yb(n,i){if(n=n.containerInfo,Vh=tu,n=E1(n),pf(n)){if("selectionStart"in n)var o={start:n.selectionStart,end:n.selectionEnd};else e:{o=(o=n.ownerDocument)&&o.defaultView||window;var f=o.getSelection&&o.getSelection();if(f&&f.rangeCount!==0){o=f.anchorNode;var m=f.anchorOffset,p=f.focusNode;f=f.focusOffset;try{o.nodeType,p.nodeType}catch{o=null;break e}var E=0,R=-1,W=-1,ue=0,we=0,ke=n,de=null;t:for(;;){for(var me;ke!==o||m!==0&&ke.nodeType!==3||(R=E+m),ke!==p||f!==0&&ke.nodeType!==3||(W=E+f),ke.nodeType===3&&(E+=ke.nodeValue.length),(me=ke.firstChild)!==null;)de=ke,ke=me;for(;;){if(ke===n)break t;if(de===o&&++ue===m&&(R=E),de===p&&++we===f&&(W=E),(me=ke.nextSibling)!==null)break;ke=de,de=ke.parentNode}ke=me}o=R===-1||W===-1?null:{start:R,end:W}}else o=null}o=o||{start:0,end:0}}else o=null;for(Gh={focusedElem:n,selectionRange:o},tu=!1,Hr=i;Hr!==null;)if(i=Hr,n=i.child,(i.subtreeFlags&1028)!==0&&n!==null)n.return=i,Hr=n;else for(;Hr!==null;){switch(i=Hr,p=i.alternate,n=i.flags,i.tag){case 0:if((n&4)!==0&&(n=i.updateQueue,n=n!==null?n.events:null,n!==null))for(o=0;o<n.length;o++)m=n[o],m.ref.impl=m.nextImpl;break;case 11:case 15:break;case 1:if((n&1024)!==0&&p!==null){n=void 0,o=i,m=p.memoizedProps,p=p.memoizedState,f=o.stateNode;try{var Xe=Ti(o.type,m);n=f.getSnapshotBeforeUpdate(Xe,p),f.__reactInternalSnapshotBeforeUpdate=n}catch(it){Pt(o,o.return,it)}}break;case 3:if((n&1024)!==0){if(n=i.stateNode.containerInfo,o=n.nodeType,o===9)Wh(n);else if(o===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":Wh(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(a(163))}if(n=i.sibling,n!==null){n.return=i.return,Hr=n;break}Hr=i.return}}function dp(n,i,o){var f=o.flags;switch(o.tag){case 0:case 11:case 15:as(n,o),f&4&&Po(5,o);break;case 1:if(as(n,o),f&4)if(n=o.stateNode,i===null)try{n.componentDidMount()}catch(E){Pt(o,o.return,E)}else{var m=Ti(o.type,i.memoizedProps);i=i.memoizedState;try{n.componentDidUpdate(m,i,n.__reactInternalSnapshotBeforeUpdate)}catch(E){Pt(o,o.return,E)}}f&64&&lp(o),f&512&&zo(o,o.return);break;case 3:if(as(n,o),f&64&&(n=o.updateQueue,n!==null)){if(i=null,o.child!==null)switch(o.child.tag){case 27:case 5:i=o.child.stateNode;break;case 1:i=o.child.stateNode}try{J1(n,i)}catch(E){Pt(o,o.return,E)}}break;case 27:i===null&&f&4&&fp(o);case 26:case 5:as(n,o),i===null&&f&4&&cp(o),f&512&&zo(o,o.return);break;case 12:as(n,o);break;case 31:as(n,o),f&4&&pp(n,o);break;case 13:as(n,o),f&4&&xp(n,o),f&64&&(n=o.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(o=Cb.bind(null,o),Wb(n,o))));break;case 22:if(f=o.memoizedState!==null||ts,!f){i=i!==null&&i.memoizedState!==null||Rr,m=ts;var p=Rr;ts=f,(Rr=i)&&!p?ns(n,o,(o.subtreeFlags&8772)!==0):as(n,o),ts=m,Rr=p}break;case 30:break;default:as(n,o)}}function mp(n){var i=n.alternate;i!==null&&(n.alternate=null,mp(i)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(i=n.stateNode,i!==null&&Oe(i)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var ur=null,Ta=!1;function rs(n,i,o){for(o=o.child;o!==null;)gp(n,i,o),o=o.sibling}function gp(n,i,o){if(rr&&typeof rr.onCommitFiberUnmount=="function")try{rr.onCommitFiberUnmount(Rt,o)}catch{}switch(o.tag){case 26:Rr||Fn(o,i),rs(n,i,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:Rr||Fn(o,i);var f=ur,m=Ta;Ps(o.type)&&(ur=o.stateNode,Ta=!1),rs(n,i,o),Yo(o.stateNode),ur=f,Ta=m;break;case 5:Rr||Fn(o,i);case 6:if(f=ur,m=Ta,ur=null,rs(n,i,o),ur=f,Ta=m,ur!==null)if(Ta)try{(ur.nodeType===9?ur.body:ur.nodeName==="HTML"?ur.ownerDocument.body:ur).removeChild(o.stateNode)}catch(p){Pt(o,i,p)}else try{ur.removeChild(o.stateNode)}catch(p){Pt(o,i,p)}break;case 18:ur!==null&&(Ta?(n=ur,lx(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,o.stateNode),Dl(n)):lx(ur,o.stateNode));break;case 4:f=ur,m=Ta,ur=o.stateNode.containerInfo,Ta=!0,rs(n,i,o),ur=f,Ta=m;break;case 0:case 11:case 14:case 15:Fs(2,o,i),Rr||Fs(4,o,i),rs(n,i,o);break;case 1:Rr||(Fn(o,i),f=o.stateNode,typeof f.componentWillUnmount=="function"&&op(o,i,f)),rs(n,i,o);break;case 21:rs(n,i,o);break;case 22:Rr=(f=Rr)||o.memoizedState!==null,rs(n,i,o),Rr=f;break;default:rs(n,i,o)}}function pp(n,i){if(i.memoizedState===null&&(n=i.alternate,n!==null&&(n=n.memoizedState,n!==null))){n=n.dehydrated;try{Dl(n)}catch(o){Pt(i,i.return,o)}}}function xp(n,i){if(i.memoizedState===null&&(n=i.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{Dl(n)}catch(o){Pt(i,i.return,o)}}function _b(n){switch(n.tag){case 31:case 13:case 19:var i=n.stateNode;return i===null&&(i=n.stateNode=new hp),i;case 22:return n=n.stateNode,i=n._retryCache,i===null&&(i=n._retryCache=new hp),i;default:throw Error(a(435,n.tag))}}function L0(n,i){var o=_b(n);i.forEach(function(f){if(!o.has(f)){o.add(f);var m=Nb.bind(null,n,f);f.then(m,m)}})}function ka(n,i){var o=i.deletions;if(o!==null)for(var f=0;f<o.length;f++){var m=o[f],p=n,E=i,R=E;e:for(;R!==null;){switch(R.tag){case 27:if(Ps(R.type)){ur=R.stateNode,Ta=!1;break e}break;case 5:ur=R.stateNode,Ta=!1;break e;case 3:case 4:ur=R.stateNode.containerInfo,Ta=!0;break e}R=R.return}if(ur===null)throw Error(a(160));gp(p,E,m),ur=null,Ta=!1,p=m.alternate,p!==null&&(p.return=null),m.return=null}if(i.subtreeFlags&13886)for(i=i.child;i!==null;)vp(i,n),i=i.sibling}var yn=null;function vp(n,i){var o=n.alternate,f=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:ka(i,n),Aa(n),f&4&&(Fs(3,n,n.return),Po(3,n),Fs(5,n,n.return));break;case 1:ka(i,n),Aa(n),f&512&&(Rr||o===null||Fn(o,o.return)),f&64&&ts&&(n=n.updateQueue,n!==null&&(f=n.callbacks,f!==null&&(o=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=o===null?f:o.concat(f))));break;case 26:var m=yn;if(ka(i,n),Aa(n),f&512&&(Rr||o===null||Fn(o,o.return)),f&4){var p=o!==null?o.memoizedState:null;if(f=n.memoizedState,o===null)if(f===null)if(n.stateNode===null){e:{f=n.type,o=n.memoizedProps,m=m.ownerDocument||m;t:switch(f){case"title":p=m.getElementsByTagName("title")[0],(!p||p[he]||p[F]||p.namespaceURI==="http://www.w3.org/2000/svg"||p.hasAttribute("itemprop"))&&(p=m.createElement(f),m.head.insertBefore(p,m.querySelector("head > title"))),Qr(p,f,o),p[F]=n,We(p),f=p;break e;case"link":var E=vx("link","href",m).get(f+(o.href||""));if(E){for(var R=0;R<E.length;R++)if(p=E[R],p.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&p.getAttribute("rel")===(o.rel==null?null:o.rel)&&p.getAttribute("title")===(o.title==null?null:o.title)&&p.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){E.splice(R,1);break t}}p=m.createElement(f),Qr(p,f,o),m.head.appendChild(p);break;case"meta":if(E=vx("meta","content",m).get(f+(o.content||""))){for(R=0;R<E.length;R++)if(p=E[R],p.getAttribute("content")===(o.content==null?null:""+o.content)&&p.getAttribute("name")===(o.name==null?null:o.name)&&p.getAttribute("property")===(o.property==null?null:o.property)&&p.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&p.getAttribute("charset")===(o.charSet==null?null:o.charSet)){E.splice(R,1);break t}}p=m.createElement(f),Qr(p,f,o),m.head.appendChild(p);break;default:throw Error(a(468,f))}p[F]=n,We(p),f=p}n.stateNode=f}else yx(m,n.type,n.stateNode);else n.stateNode=xx(m,f,n.memoizedProps);else p!==f?(p===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):p.count--,f===null?yx(m,n.type,n.stateNode):xx(m,f,n.memoizedProps)):f===null&&n.stateNode!==null&&_h(n,n.memoizedProps,o.memoizedProps)}break;case 27:ka(i,n),Aa(n),f&512&&(Rr||o===null||Fn(o,o.return)),o!==null&&f&4&&_h(n,n.memoizedProps,o.memoizedProps);break;case 5:if(ka(i,n),Aa(n),f&512&&(Rr||o===null||Fn(o,o.return)),n.flags&32){m=n.stateNode;try{Qt(m,"")}catch(Xe){Pt(n,n.return,Xe)}}f&4&&n.stateNode!=null&&(m=n.memoizedProps,_h(n,m,o!==null?o.memoizedProps:m)),f&1024&&(Sh=!0);break;case 6:if(ka(i,n),Aa(n),f&4){if(n.stateNode===null)throw Error(a(162));f=n.memoizedProps,o=n.stateNode;try{o.nodeValue=f}catch(Xe){Pt(n,n.return,Xe)}}break;case 3:if(J0=null,m=yn,yn=K0(i.containerInfo),ka(i,n),yn=m,Aa(n),f&4&&o!==null&&o.memoizedState.isDehydrated)try{Dl(i.containerInfo)}catch(Xe){Pt(n,n.return,Xe)}Sh&&(Sh=!1,yp(n));break;case 4:f=yn,yn=K0(n.stateNode.containerInfo),ka(i,n),Aa(n),yn=f;break;case 12:ka(i,n),Aa(n);break;case 31:ka(i,n),Aa(n),f&4&&(f=n.updateQueue,f!==null&&(n.updateQueue=null,L0(n,f)));break;case 13:ka(i,n),Aa(n),n.child.flags&8192&&n.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(B0=Mt()),f&4&&(f=n.updateQueue,f!==null&&(n.updateQueue=null,L0(n,f)));break;case 22:m=n.memoizedState!==null;var W=o!==null&&o.memoizedState!==null,ue=ts,we=Rr;if(ts=ue||m,Rr=we||W,ka(i,n),Rr=we,ts=ue,Aa(n),f&8192)e:for(i=n.stateNode,i._visibility=m?i._visibility&-2:i._visibility|1,m&&(o===null||W||ts||Rr||ki(n)),o=null,i=n;;){if(i.tag===5||i.tag===26){if(o===null){W=o=i;try{if(p=W.stateNode,m)E=p.style,typeof E.setProperty=="function"?E.setProperty("display","none","important"):E.display="none";else{R=W.stateNode;var ke=W.memoizedProps.style,de=ke!=null&&ke.hasOwnProperty("display")?ke.display:null;R.style.display=de==null||typeof de=="boolean"?"":(""+de).trim()}}catch(Xe){Pt(W,W.return,Xe)}}}else if(i.tag===6){if(o===null){W=i;try{W.stateNode.nodeValue=m?"":W.memoizedProps}catch(Xe){Pt(W,W.return,Xe)}}}else if(i.tag===18){if(o===null){W=i;try{var me=W.stateNode;m?ox(me,!0):ox(W.stateNode,!1)}catch(Xe){Pt(W,W.return,Xe)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===n)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===n)break e;for(;i.sibling===null;){if(i.return===null||i.return===n)break e;o===i&&(o=null),i=i.return}o===i&&(o=null),i.sibling.return=i.return,i=i.sibling}f&4&&(f=n.updateQueue,f!==null&&(o=f.retryQueue,o!==null&&(f.retryQueue=null,L0(n,o))));break;case 19:ka(i,n),Aa(n),f&4&&(f=n.updateQueue,f!==null&&(n.updateQueue=null,L0(n,f)));break;case 30:break;case 21:break;default:ka(i,n),Aa(n)}}function Aa(n){var i=n.flags;if(i&2){try{for(var o,f=n.return;f!==null;){if(up(f)){o=f;break}f=f.return}if(o==null)throw Error(a(160));switch(o.tag){case 27:var m=o.stateNode,p=wh(n);M0(n,p,m);break;case 5:var E=o.stateNode;o.flags&32&&(Qt(E,""),o.flags&=-33);var R=wh(n);M0(n,R,E);break;case 3:case 4:var W=o.stateNode.containerInfo,ue=wh(n);bh(n,ue,W);break;default:throw Error(a(161))}}catch(we){Pt(n,n.return,we)}n.flags&=-3}i&4096&&(n.flags&=-4097)}function yp(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var i=n;yp(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),n=n.sibling}}function as(n,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)dp(n,i.alternate,i),i=i.sibling}function ki(n){for(n=n.child;n!==null;){var i=n;switch(i.tag){case 0:case 11:case 14:case 15:Fs(4,i,i.return),ki(i);break;case 1:Fn(i,i.return);var o=i.stateNode;typeof o.componentWillUnmount=="function"&&op(i,i.return,o),ki(i);break;case 27:Yo(i.stateNode);case 26:case 5:Fn(i,i.return),ki(i);break;case 22:i.memoizedState===null&&ki(i);break;case 30:ki(i);break;default:ki(i)}n=n.sibling}}function ns(n,i,o){for(o=o&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var f=i.alternate,m=n,p=i,E=p.flags;switch(p.tag){case 0:case 11:case 15:ns(m,p,o),Po(4,p);break;case 1:if(ns(m,p,o),f=p,m=f.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch(ue){Pt(f,f.return,ue)}if(f=p,m=f.updateQueue,m!==null){var R=f.stateNode;try{var W=m.shared.hiddenCallbacks;if(W!==null)for(m.shared.hiddenCallbacks=null,m=0;m<W.length;m++)Y1(W[m],R)}catch(ue){Pt(f,f.return,ue)}}o&&E&64&&lp(p),zo(p,p.return);break;case 27:fp(p);case 26:case 5:ns(m,p,o),o&&f===null&&E&4&&cp(p),zo(p,p.return);break;case 12:ns(m,p,o);break;case 31:ns(m,p,o),o&&E&4&&pp(m,p);break;case 13:ns(m,p,o),o&&E&4&&xp(m,p);break;case 22:p.memoizedState===null&&ns(m,p,o),zo(p,p.return);break;case 30:break;default:ns(m,p,o)}i=i.sibling}}function Eh(n,i){var o=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),n=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(n=i.memoizedState.cachePool.pool),n!==o&&(n!=null&&n.refCount++,o!=null&&Ao(o))}function Th(n,i){n=null,i.alternate!==null&&(n=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==n&&(i.refCount++,n!=null&&Ao(n))}function _n(n,i,o,f){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)_p(n,i,o,f),i=i.sibling}function _p(n,i,o,f){var m=i.flags;switch(i.tag){case 0:case 11:case 15:_n(n,i,o,f),m&2048&&Po(9,i);break;case 1:_n(n,i,o,f);break;case 3:_n(n,i,o,f),m&2048&&(n=null,i.alternate!==null&&(n=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==n&&(i.refCount++,n!=null&&Ao(n)));break;case 12:if(m&2048){_n(n,i,o,f),n=i.stateNode;try{var p=i.memoizedProps,E=p.id,R=p.onPostCommit;typeof R=="function"&&R(E,i.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(W){Pt(i,i.return,W)}}else _n(n,i,o,f);break;case 31:_n(n,i,o,f);break;case 13:_n(n,i,o,f);break;case 23:break;case 22:p=i.stateNode,E=i.alternate,i.memoizedState!==null?p._visibility&2?_n(n,i,o,f):Ho(n,i):p._visibility&2?_n(n,i,o,f):(p._visibility|=2,wl(n,i,o,f,(i.subtreeFlags&10256)!==0||!1)),m&2048&&Eh(E,i);break;case 24:_n(n,i,o,f),m&2048&&Th(i.alternate,i);break;default:_n(n,i,o,f)}}function wl(n,i,o,f,m){for(m=m&&((i.subtreeFlags&10256)!==0||!1),i=i.child;i!==null;){var p=n,E=i,R=o,W=f,ue=E.flags;switch(E.tag){case 0:case 11:case 15:wl(p,E,R,W,m),Po(8,E);break;case 23:break;case 22:var we=E.stateNode;E.memoizedState!==null?we._visibility&2?wl(p,E,R,W,m):Ho(p,E):(we._visibility|=2,wl(p,E,R,W,m)),m&&ue&2048&&Eh(E.alternate,E);break;case 24:wl(p,E,R,W,m),m&&ue&2048&&Th(E.alternate,E);break;default:wl(p,E,R,W,m)}i=i.sibling}}function Ho(n,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var o=n,f=i,m=f.flags;switch(f.tag){case 22:Ho(o,f),m&2048&&Eh(f.alternate,f);break;case 24:Ho(o,f),m&2048&&Th(f.alternate,f);break;default:Ho(o,f)}i=i.sibling}}var $o=8192;function bl(n,i,o){if(n.subtreeFlags&$o)for(n=n.child;n!==null;)wp(n,i,o),n=n.sibling}function wp(n,i,o){switch(n.tag){case 26:bl(n,i,o),n.flags&$o&&n.memoizedState!==null&&iS(o,yn,n.memoizedState,n.memoizedProps);break;case 5:bl(n,i,o);break;case 3:case 4:var f=yn;yn=K0(n.stateNode.containerInfo),bl(n,i,o),yn=f;break;case 22:n.memoizedState===null&&(f=n.alternate,f!==null&&f.memoizedState!==null?(f=$o,$o=16777216,bl(n,i,o),$o=f):bl(n,i,o));break;default:bl(n,i,o)}}function bp(n){var i=n.alternate;if(i!==null&&(n=i.child,n!==null)){i.child=null;do i=n.sibling,n.sibling=null,n=i;while(n!==null)}}function Vo(n){var i=n.deletions;if((n.flags&16)!==0){if(i!==null)for(var o=0;o<i.length;o++){var f=i[o];Hr=f,Ep(f,n)}bp(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)Sp(n),n=n.sibling}function Sp(n){switch(n.tag){case 0:case 11:case 15:Vo(n),n.flags&2048&&Fs(9,n,n.return);break;case 3:Vo(n);break;case 12:Vo(n);break;case 22:var i=n.stateNode;n.memoizedState!==null&&i._visibility&2&&(n.return===null||n.return.tag!==13)?(i._visibility&=-3,I0(n)):Vo(n);break;default:Vo(n)}}function I0(n){var i=n.deletions;if((n.flags&16)!==0){if(i!==null)for(var o=0;o<i.length;o++){var f=i[o];Hr=f,Ep(f,n)}bp(n)}for(n=n.child;n!==null;){switch(i=n,i.tag){case 0:case 11:case 15:Fs(8,i,i.return),I0(i);break;case 22:o=i.stateNode,o._visibility&2&&(o._visibility&=-3,I0(i));break;default:I0(i)}n=n.sibling}}function Ep(n,i){for(;Hr!==null;){var o=Hr;switch(o.tag){case 0:case 11:case 15:Fs(8,o,i);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var f=o.memoizedState.cachePool.pool;f!=null&&f.refCount++}break;case 24:Ao(o.memoizedState.cache)}if(f=o.child,f!==null)f.return=o,Hr=f;else e:for(o=n;Hr!==null;){f=Hr;var m=f.sibling,p=f.return;if(mp(f),f===o){Hr=null;break e}if(m!==null){m.return=p,Hr=m;break e}Hr=p}}}var wb={getCacheForType:function(n){var i=Yr(Cr),o=i.data.get(n);return o===void 0&&(o=n(),i.data.set(n,o)),o},cacheSignal:function(){return Yr(Cr).controller.signal}},bb=typeof WeakMap=="function"?WeakMap:Map,jt=0,Zt=null,Tt=null,Ct=0,Ut=0,Ua=null,Ms=!1,Sl=!1,kh=!1,ss=0,xr=0,Ls=0,Ai=0,Ah=0,Pa=0,El=0,Go=null,Ca=null,Ch=!1,B0=0,Tp=0,j0=1/0,U0=null,Is=null,Br=0,Bs=null,Tl=null,is=0,Nh=0,Oh=null,kp=null,qo=0,Rh=null;function za(){return(jt&2)!==0&&Ct!==0?Ct&-Ct:G.T!==null?Bh():A()}function Ap(){if(Pa===0)if((Ct&536870912)===0||Ot){var n=vs;vs<<=1,(vs&3932160)===0&&(vs=262144),Pa=n}else Pa=536870912;return n=Ba.current,n!==null&&(n.flags|=32),Pa}function Na(n,i,o){(n===Zt&&(Ut===2||Ut===9)||n.cancelPendingCommit!==null)&&(kl(n,0),js(n,Ct,Pa,!1)),Vn(n,o),((jt&2)===0||n!==Zt)&&(n===Zt&&((jt&2)===0&&(Ai|=o),xr===4&&js(n,Ct,Pa,!1)),Mn(n))}function Cp(n,i,o){if((jt&6)!==0)throw Error(a(327));var f=!o&&(i&127)===0&&(i&n.expiredLanes)===0||$n(n,i),m=f?Tb(n,i):Fh(n,i,!0),p=f;do{if(m===0){Sl&&!f&&js(n,i,0,!1);break}else{if(o=n.current.alternate,p&&!Sb(o)){m=Fh(n,i,!1),p=!1;continue}if(m===2){if(p=i,n.errorRecoveryDisabledLanes&p)var E=0;else E=n.pendingLanes&-536870913,E=E!==0?E:E&536870912?536870912:0;if(E!==0){i=E;e:{var R=n;m=Go;var W=R.current.memoizedState.isDehydrated;if(W&&(kl(R,E).flags|=256),E=Fh(R,E,!1),E!==2){if(kh&&!W){R.errorRecoveryDisabledLanes|=p,Ai|=p,m=4;break e}p=Ca,Ca=m,p!==null&&(Ca===null?Ca=p:Ca.push.apply(Ca,p))}m=E}if(p=!1,m!==2)continue}}if(m===1){kl(n,0),js(n,i,0,!0);break}e:{switch(f=n,p=m,p){case 0:case 1:throw Error(a(345));case 4:if((i&4194048)!==i)break;case 6:js(f,i,Pa,!Ms);break e;case 2:Ca=null;break;case 3:case 5:break;default:throw Error(a(329))}if((i&62914560)===i&&(m=B0+300-Mt(),10<m)){if(js(f,i,Pa,!Ms),_s(f,0,!0)!==0)break e;is=i,f.timeoutHandle=sx(Np.bind(null,f,o,Ca,U0,Ch,i,Pa,Ai,El,Ms,p,"Throttled",-0,0),m);break e}Np(f,o,Ca,U0,Ch,i,Pa,Ai,El,Ms,p,null,-0,0)}}break}while(!0);Mn(n)}function Np(n,i,o,f,m,p,E,R,W,ue,we,ke,de,me){if(n.timeoutHandle=-1,ke=i.subtreeFlags,ke&8192||(ke&16785408)===16785408){ke={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Gn},wp(i,p,ke);var Xe=(p&62914560)===p?B0-Mt():(p&4194048)===p?Tp-Mt():0;if(Xe=lS(ke,Xe),Xe!==null){is=p,n.cancelPendingCommit=Xe(Bp.bind(null,n,i,p,o,f,m,E,R,W,we,ke,null,de,me)),js(n,p,E,!ue);return}}Bp(n,i,p,o,f,m,E,R,W)}function Sb(n){for(var i=n;;){var o=i.tag;if((o===0||o===11||o===15)&&i.flags&16384&&(o=i.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var f=0;f<o.length;f++){var m=o[f],p=m.getSnapshot;m=m.value;try{if(!La(p(),m))return!1}catch{return!1}}if(o=i.child,i.subtreeFlags&16384&&o!==null)o.return=i,i=o;else{if(i===n)break;for(;i.sibling===null;){if(i.return===null||i.return===n)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function js(n,i,o,f){i&=~Ah,i&=~Ai,n.suspendedLanes|=i,n.pingedLanes&=~i,f&&(n.warmLanes|=i),f=n.expirationTimes;for(var m=i;0<m;){var p=31-Wr(m),E=1<<p;f[p]=-1,m&=~E}o!==0&&Nn(n,o,i)}function P0(){return(jt&6)===0?(Xo(0),!1):!0}function Dh(){if(Tt!==null){if(Ut===0)var n=Tt.return;else n=Tt,Kn=vi=null,Wf(n),pl=null,No=0,n=Tt;for(;n!==null;)ip(n.alternate,n),n=n.return;Tt=null}}function kl(n,i){var o=n.timeoutHandle;o!==-1&&(n.timeoutHandle=-1,$b(o)),o=n.cancelPendingCommit,o!==null&&(n.cancelPendingCommit=null,o()),is=0,Dh(),Zt=n,Tt=o=Xn(n.current,null),Ct=i,Ut=0,Ua=null,Ms=!1,Sl=$n(n,i),kh=!1,El=Pa=Ah=Ai=Ls=xr=0,Ca=Go=null,Ch=!1,(i&8)!==0&&(i|=i&32);var f=n.entangledLanes;if(f!==0)for(n=n.entanglements,f&=i;0<f;){var m=31-Wr(f),p=1<<m;i|=n[m],f&=~p}return ss=i,l0(),o}function Op(n,i){xt=null,G.H=Bo,i===gl||i===g0?(i=q1(),Ut=3):i===If?(i=q1(),Ut=4):Ut=i===uh?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,Ua=i,Tt===null&&(xr=1,N0(n,Za(i,n.current)))}function Rp(){var n=Ba.current;return n===null?!0:(Ct&4194048)===Ct?an===null:(Ct&62914560)===Ct||(Ct&536870912)!==0?n===an:!1}function Dp(){var n=G.H;return G.H=Bo,n===null?Bo:n}function Fp(){var n=G.A;return G.A=wb,n}function z0(){xr=4,Ms||(Ct&4194048)!==Ct&&Ba.current!==null||(Sl=!0),(Ls&134217727)===0&&(Ai&134217727)===0||Zt===null||js(Zt,Ct,Pa,!1)}function Fh(n,i,o){var f=jt;jt|=2;var m=Dp(),p=Fp();(Zt!==n||Ct!==i)&&(U0=null,kl(n,i)),i=!1;var E=xr;e:do try{if(Ut!==0&&Tt!==null){var R=Tt,W=Ua;switch(Ut){case 8:Dh(),E=6;break e;case 3:case 2:case 9:case 6:Ba.current===null&&(i=!0);var ue=Ut;if(Ut=0,Ua=null,Al(n,R,W,ue),o&&Sl){E=0;break e}break;default:ue=Ut,Ut=0,Ua=null,Al(n,R,W,ue)}}Eb(),E=xr;break}catch(we){Op(n,we)}while(!0);return i&&n.shellSuspendCounter++,Kn=vi=null,jt=f,G.H=m,G.A=p,Tt===null&&(Zt=null,Ct=0,l0()),E}function Eb(){for(;Tt!==null;)Mp(Tt)}function Tb(n,i){var o=jt;jt|=2;var f=Dp(),m=Fp();Zt!==n||Ct!==i?(U0=null,j0=Mt()+500,kl(n,i)):Sl=$n(n,i);e:do try{if(Ut!==0&&Tt!==null){i=Tt;var p=Ua;t:switch(Ut){case 1:Ut=0,Ua=null,Al(n,i,p,1);break;case 2:case 9:if(V1(p)){Ut=0,Ua=null,Lp(i);break}i=function(){Ut!==2&&Ut!==9||Zt!==n||(Ut=7),Mn(n)},p.then(i,i);break e;case 3:Ut=7;break e;case 4:Ut=5;break e;case 7:V1(p)?(Ut=0,Ua=null,Lp(i)):(Ut=0,Ua=null,Al(n,i,p,7));break;case 5:var E=null;switch(Tt.tag){case 26:E=Tt.memoizedState;case 5:case 27:var R=Tt;if(E?_x(E):R.stateNode.complete){Ut=0,Ua=null;var W=R.sibling;if(W!==null)Tt=W;else{var ue=R.return;ue!==null?(Tt=ue,H0(ue)):Tt=null}break t}}Ut=0,Ua=null,Al(n,i,p,5);break;case 6:Ut=0,Ua=null,Al(n,i,p,6);break;case 8:Dh(),xr=6;break e;default:throw Error(a(462))}}kb();break}catch(we){Op(n,we)}while(!0);return Kn=vi=null,G.H=f,G.A=m,jt=o,Tt!==null?0:(Zt=null,Ct=0,l0(),xr)}function kb(){for(;Tt!==null&&!Xr();)Mp(Tt)}function Mp(n){var i=np(n.alternate,n,ss);n.memoizedProps=n.pendingProps,i===null?H0(n):Tt=i}function Lp(n){var i=n,o=i.alternate;switch(i.tag){case 15:case 0:i=Qg(o,i,i.pendingProps,i.type,void 0,Ct);break;case 11:i=Qg(o,i,i.pendingProps,i.type.render,i.ref,Ct);break;case 5:Wf(i);default:ip(o,i),i=Tt=F1(i,ss),i=np(o,i,ss)}n.memoizedProps=n.pendingProps,i===null?H0(n):Tt=i}function Al(n,i,o,f){Kn=vi=null,Wf(i),pl=null,No=0;var m=i.return;try{if(mb(n,m,i,o,Ct)){xr=1,N0(n,Za(o,n.current)),Tt=null;return}}catch(p){if(m!==null)throw Tt=m,p;xr=1,N0(n,Za(o,n.current)),Tt=null;return}i.flags&32768?(Ot||f===1?n=!0:Sl||(Ct&536870912)!==0?n=!1:(Ms=n=!0,(f===2||f===9||f===3||f===6)&&(f=Ba.current,f!==null&&f.tag===13&&(f.flags|=16384))),Ip(i,n)):H0(i)}function H0(n){var i=n;do{if((i.flags&32768)!==0){Ip(i,Ms);return}n=i.return;var o=xb(i.alternate,i,ss);if(o!==null){Tt=o;return}if(i=i.sibling,i!==null){Tt=i;return}Tt=i=n}while(i!==null);xr===0&&(xr=5)}function Ip(n,i){do{var o=vb(n.alternate,n);if(o!==null){o.flags&=32767,Tt=o;return}if(o=n.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!i&&(n=n.sibling,n!==null)){Tt=n;return}Tt=n=o}while(n!==null);xr=6,Tt=null}function Bp(n,i,o,f,m,p,E,R,W){n.cancelPendingCommit=null;do $0();while(Br!==0);if((jt&6)!==0)throw Error(a(327));if(i!==null){if(i===n.current)throw Error(a(177));if(p=i.lanes|i.childLanes,p|=wf,mo(n,o,p,E,R,W),n===Zt&&(Tt=Zt=null,Ct=0),Tl=i,Bs=n,is=o,Nh=p,Oh=m,kp=f,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,Ob(cr,function(){return Hp(),null})):(n.callbackNode=null,n.callbackPriority=0),f=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||f){f=G.T,G.T=null,m=ne.p,ne.p=2,E=jt,jt|=4;try{yb(n,i,o)}finally{jt=E,ne.p=m,G.T=f}}Br=1,jp(),Up(),Pp()}}function jp(){if(Br===1){Br=0;var n=Bs,i=Tl,o=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||o){o=G.T,G.T=null;var f=ne.p;ne.p=2;var m=jt;jt|=4;try{vp(i,n);var p=Gh,E=E1(n.containerInfo),R=p.focusedElem,W=p.selectionRange;if(E!==R&&R&&R.ownerDocument&&S1(R.ownerDocument.documentElement,R)){if(W!==null&&pf(R)){var ue=W.start,we=W.end;if(we===void 0&&(we=ue),"selectionStart"in R)R.selectionStart=ue,R.selectionEnd=Math.min(we,R.value.length);else{var ke=R.ownerDocument||document,de=ke&&ke.defaultView||window;if(de.getSelection){var me=de.getSelection(),Xe=R.textContent.length,it=Math.min(W.start,Xe),Yt=W.end===void 0?it:Math.min(W.end,Xe);!me.extend&&it>Yt&&(E=Yt,Yt=it,it=E);var ae=b1(R,it),Q=b1(R,Yt);if(ae&&Q&&(me.rangeCount!==1||me.anchorNode!==ae.node||me.anchorOffset!==ae.offset||me.focusNode!==Q.node||me.focusOffset!==Q.offset)){var ce=ke.createRange();ce.setStart(ae.node,ae.offset),me.removeAllRanges(),it>Yt?(me.addRange(ce),me.extend(Q.node,Q.offset)):(ce.setEnd(Q.node,Q.offset),me.addRange(ce))}}}}for(ke=[],me=R;me=me.parentNode;)me.nodeType===1&&ke.push({element:me,left:me.scrollLeft,top:me.scrollTop});for(typeof R.focus=="function"&&R.focus(),R=0;R<ke.length;R++){var Te=ke[R];Te.element.scrollLeft=Te.left,Te.element.scrollTop=Te.top}}tu=!!Vh,Gh=Vh=null}finally{jt=m,ne.p=f,G.T=o}}n.current=i,Br=2}}function Up(){if(Br===2){Br=0;var n=Bs,i=Tl,o=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||o){o=G.T,G.T=null;var f=ne.p;ne.p=2;var m=jt;jt|=4;try{dp(n,i.alternate,i)}finally{jt=m,ne.p=f,G.T=o}}Br=3}}function Pp(){if(Br===4||Br===3){Br=0,Ya();var n=Bs,i=Tl,o=is,f=kp;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?Br=5:(Br=0,Tl=Bs=null,zp(n,n.pendingLanes));var m=n.pendingLanes;if(m===0&&(Is=null),fi(o),i=i.stateNode,rr&&typeof rr.onCommitFiberRoot=="function")try{rr.onCommitFiberRoot(Rt,i,void 0,(i.current.flags&128)===128)}catch{}if(f!==null){i=G.T,m=ne.p,ne.p=2,G.T=null;try{for(var p=n.onRecoverableError,E=0;E<f.length;E++){var R=f[E];p(R.value,{componentStack:R.stack})}}finally{G.T=i,ne.p=m}}(is&3)!==0&&$0(),Mn(n),m=n.pendingLanes,(o&261930)!==0&&(m&42)!==0?n===Rh?qo++:(qo=0,Rh=n):qo=0,Xo(0)}}function zp(n,i){(n.pooledCacheLanes&=i)===0&&(i=n.pooledCache,i!=null&&(n.pooledCache=null,Ao(i)))}function $0(){return jp(),Up(),Pp(),Hp()}function Hp(){if(Br!==5)return!1;var n=Bs,i=Nh;Nh=0;var o=fi(is),f=G.T,m=ne.p;try{ne.p=32>o?32:o,G.T=null,o=Oh,Oh=null;var p=Bs,E=is;if(Br=0,Tl=Bs=null,is=0,(jt&6)!==0)throw Error(a(331));var R=jt;if(jt|=4,Sp(p.current),_p(p,p.current,E,o),jt=R,Xo(0,!1),rr&&typeof rr.onPostCommitFiberRoot=="function")try{rr.onPostCommitFiberRoot(Rt,p)}catch{}return!0}finally{ne.p=m,G.T=f,zp(n,i)}}function $p(n,i,o){i=Za(o,i),i=ch(n.stateNode,i,2),n=Os(n,i,2),n!==null&&(Vn(n,2),Mn(n))}function Pt(n,i,o){if(n.tag===3)$p(n,n,o);else for(;i!==null;){if(i.tag===3){$p(i,n,o);break}else if(i.tag===1){var f=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(Is===null||!Is.has(f))){n=Za(o,n),o=Vg(2),f=Os(i,o,2),f!==null&&(Gg(o,f,i,n),Vn(f,2),Mn(f));break}}i=i.return}}function Mh(n,i,o){var f=n.pingCache;if(f===null){f=n.pingCache=new bb;var m=new Set;f.set(i,m)}else m=f.get(i),m===void 0&&(m=new Set,f.set(i,m));m.has(o)||(kh=!0,m.add(o),n=Ab.bind(null,n,i,o),i.then(n,n))}function Ab(n,i,o){var f=n.pingCache;f!==null&&f.delete(i),n.pingedLanes|=n.suspendedLanes&o,n.warmLanes&=~o,Zt===n&&(Ct&o)===o&&(xr===4||xr===3&&(Ct&62914560)===Ct&&300>Mt()-B0?(jt&2)===0&&kl(n,0):Ah|=o,El===Ct&&(El=0)),Mn(n)}function Vp(n,i){i===0&&(i=tl()),n=gi(n,i),n!==null&&(Vn(n,i),Mn(n))}function Cb(n){var i=n.memoizedState,o=0;i!==null&&(o=i.retryLane),Vp(n,o)}function Nb(n,i){var o=0;switch(n.tag){case 31:case 13:var f=n.stateNode,m=n.memoizedState;m!==null&&(o=m.retryLane);break;case 19:f=n.stateNode;break;case 22:f=n.stateNode._retryCache;break;default:throw Error(a(314))}f!==null&&f.delete(i),Vp(n,o)}function Ob(n,i){return na(n,i)}var V0=null,Cl=null,Lh=!1,G0=!1,Ih=!1,Us=0;function Mn(n){n!==Cl&&n.next===null&&(Cl===null?V0=Cl=n:Cl=Cl.next=n),G0=!0,Lh||(Lh=!0,Db())}function Xo(n,i){if(!Ih&&G0){Ih=!0;do for(var o=!1,f=V0;f!==null;){if(n!==0){var m=f.pendingLanes;if(m===0)var p=0;else{var E=f.suspendedLanes,R=f.pingedLanes;p=(1<<31-Wr(42|n)+1)-1,p&=m&~(E&~R),p=p&201326741?p&201326741|1:p?p|2:0}p!==0&&(o=!0,Wp(f,p))}else p=Ct,p=_s(f,f===Zt?p:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),(p&3)===0||$n(f,p)||(o=!0,Wp(f,p));f=f.next}while(o);Ih=!1}}function Rb(){Gp()}function Gp(){G0=Lh=!1;var n=0;Us!==0&&Hb()&&(n=Us);for(var i=Mt(),o=null,f=V0;f!==null;){var m=f.next,p=qp(f,i);p===0?(f.next=null,o===null?V0=m:o.next=m,m===null&&(Cl=o)):(o=f,(n!==0||(p&3)!==0)&&(G0=!0)),f=m}Br!==0&&Br!==5||Xo(n),Us!==0&&(Us=0)}function qp(n,i){for(var o=n.suspendedLanes,f=n.pingedLanes,m=n.expirationTimes,p=n.pendingLanes&-62914561;0<p;){var E=31-Wr(p),R=1<<E,W=m[E];W===-1?((R&o)===0||(R&f)!==0)&&(m[E]=ho(R,i)):W<=i&&(n.expiredLanes|=R),p&=~R}if(i=Zt,o=Ct,o=_s(n,n===i?o:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),f=n.callbackNode,o===0||n===i&&(Ut===2||Ut===9)||n.cancelPendingCommit!==null)return f!==null&&f!==null&&pa(f),n.callbackNode=null,n.callbackPriority=0;if((o&3)===0||$n(n,o)){if(i=o&-o,i===n.callbackPriority)return i;switch(f!==null&&pa(f),fi(o)){case 2:case 8:o=Ja;break;case 32:o=cr;break;case 268435456:o=gt;break;default:o=cr}return f=Xp.bind(null,n),o=na(o,f),n.callbackPriority=i,n.callbackNode=o,i}return f!==null&&f!==null&&pa(f),n.callbackPriority=2,n.callbackNode=null,2}function Xp(n,i){if(Br!==0&&Br!==5)return n.callbackNode=null,n.callbackPriority=0,null;var o=n.callbackNode;if($0()&&n.callbackNode!==o)return null;var f=Ct;return f=_s(n,n===Zt?f:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),f===0?null:(Cp(n,f,i),qp(n,Mt()),n.callbackNode!=null&&n.callbackNode===o?Xp.bind(null,n):null)}function Wp(n,i){if($0())return null;Cp(n,i,!0)}function Db(){Vb(function(){(jt&6)!==0?na(zr,Rb):Gp()})}function Bh(){if(Us===0){var n=dl;n===0&&(n=Hn,Hn<<=1,(Hn&261888)===0&&(Hn=256)),Us=n}return Us}function Kp(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:Zc(""+n)}function Yp(n,i){var o=i.ownerDocument.createElement("input");return o.name=i.name,o.value=i.value,n.id&&o.setAttribute("form",n.id),i.parentNode.insertBefore(o,i),n=new FormData(n),o.parentNode.removeChild(o),n}function Fb(n,i,o,f,m){if(i==="submit"&&o&&o.stateNode===m){var p=Kp((m[B]||null).action),E=f.submitter;E&&(i=(i=E[B]||null)?Kp(i.formAction):E.getAttribute("formAction"),i!==null&&(p=i,E=null));var R=new a0("action","action",null,f,m);n.push({event:R,listeners:[{instance:null,listener:function(){if(f.defaultPrevented){if(Us!==0){var W=E?Yp(m,E):new FormData(m);ah(o,{pending:!0,data:W,method:m.method,action:p},null,W)}}else typeof p=="function"&&(R.preventDefault(),W=E?Yp(m,E):new FormData(m),ah(o,{pending:!0,data:W,method:m.method,action:p},p,W))},currentTarget:m}]})}}for(var jh=0;jh<_f.length;jh++){var Uh=_f[jh],Mb=Uh.toLowerCase(),Lb=Uh[0].toUpperCase()+Uh.slice(1);vn(Mb,"on"+Lb)}vn(A1,"onAnimationEnd"),vn(C1,"onAnimationIteration"),vn(N1,"onAnimationStart"),vn("dblclick","onDoubleClick"),vn("focusin","onFocus"),vn("focusout","onBlur"),vn(Jw,"onTransitionRun"),vn(Qw,"onTransitionStart"),vn(Zw,"onTransitionCancel"),vn(O1,"onTransitionEnd"),ba("onMouseEnter",["mouseout","mouseover"]),ba("onMouseLeave",["mouseout","mouseover"]),ba("onPointerEnter",["pointerout","pointerover"]),ba("onPointerLeave",["pointerout","pointerover"]),er("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),er("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),er("onBeforeInput",["compositionend","keypress","textInput","paste"]),er("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),er("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),er("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Wo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ib=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Wo));function Jp(n,i){i=(i&4)!==0;for(var o=0;o<n.length;o++){var f=n[o],m=f.event;f=f.listeners;e:{var p=void 0;if(i)for(var E=f.length-1;0<=E;E--){var R=f[E],W=R.instance,ue=R.currentTarget;if(R=R.listener,W!==p&&m.isPropagationStopped())break e;p=R,m.currentTarget=ue;try{p(m)}catch(we){i0(we)}m.currentTarget=null,p=W}else for(E=0;E<f.length;E++){if(R=f[E],W=R.instance,ue=R.currentTarget,R=R.listener,W!==p&&m.isPropagationStopped())break e;p=R,m.currentTarget=ue;try{p(m)}catch(we){i0(we)}m.currentTarget=null,p=W}}}}function kt(n,i){var o=i[ie];o===void 0&&(o=i[ie]=new Set);var f=n+"__bubble";o.has(f)||(Qp(i,n,2,!1),o.add(f))}function Ph(n,i,o){var f=0;i&&(f|=4),Qp(o,n,f,i)}var q0="_reactListening"+Math.random().toString(36).slice(2);function zh(n){if(!n[q0]){n[q0]=!0,qt.forEach(function(o){o!=="selectionchange"&&(Ib.has(o)||Ph(o,!1,n),Ph(o,!0,n))});var i=n.nodeType===9?n:n.ownerDocument;i===null||i[q0]||(i[q0]=!0,Ph("selectionchange",!1,i))}}function Qp(n,i,o,f){switch(Ax(i)){case 2:var m=uS;break;case 8:m=fS;break;default:m=rd}o=m.bind(null,i,o,n),m=void 0,!lf||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(m=!0),f?m!==void 0?n.addEventListener(i,o,{capture:!0,passive:m}):n.addEventListener(i,o,!0):m!==void 0?n.addEventListener(i,o,{passive:m}):n.addEventListener(i,o,!1)}function Hh(n,i,o,f,m){var p=f;if((i&1)===0&&(i&2)===0&&f!==null)e:for(;;){if(f===null)return;var E=f.tag;if(E===3||E===4){var R=f.stateNode.containerInfo;if(R===m)break;if(E===4)for(E=f.return;E!==null;){var W=E.tag;if((W===3||W===4)&&E.stateNode.containerInfo===m)return;E=E.return}for(;R!==null;){if(E=Fe(R),E===null)return;if(W=E.tag,W===5||W===6||W===26||W===27){f=p=E;continue e}R=R.parentNode}}f=f.return}a1(function(){var ue=p,we=nf(o),ke=[];e:{var de=R1.get(n);if(de!==void 0){var me=a0,Xe=n;switch(n){case"keypress":if(t0(o)===0)break e;case"keydown":case"keyup":me=Nw;break;case"focusin":Xe="focus",me=ff;break;case"focusout":Xe="blur",me=ff;break;case"beforeblur":case"afterblur":me=ff;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":me=i1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":me=xw;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":me=Dw;break;case A1:case C1:case N1:me=_w;break;case O1:me=Mw;break;case"scroll":case"scrollend":me=gw;break;case"wheel":me=Iw;break;case"copy":case"cut":case"paste":me=bw;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":me=o1;break;case"toggle":case"beforetoggle":me=jw}var it=(i&4)!==0,Yt=!it&&(n==="scroll"||n==="scrollend"),ae=it?de!==null?de+"Capture":null:de;it=[];for(var Q=ue,ce;Q!==null;){var Te=Q;if(ce=Te.stateNode,Te=Te.tag,Te!==5&&Te!==26&&Te!==27||ce===null||ae===null||(Te=po(Q,ae),Te!=null&&it.push(Ko(Q,Te,ce))),Yt)break;Q=Q.return}0<it.length&&(de=new me(de,Xe,null,o,we),ke.push({event:de,listeners:it}))}}if((i&7)===0){e:{if(de=n==="mouseover"||n==="pointerover",me=n==="mouseout"||n==="pointerout",de&&o!==af&&(Xe=o.relatedTarget||o.fromElement)&&(Fe(Xe)||Xe[H]))break e;if((me||de)&&(de=we.window===we?we:(de=we.ownerDocument)?de.defaultView||de.parentWindow:window,me?(Xe=o.relatedTarget||o.toElement,me=ue,Xe=Xe?Fe(Xe):null,Xe!==null&&(Yt=l(Xe),it=Xe.tag,Xe!==Yt||it!==5&&it!==27&&it!==6)&&(Xe=null)):(me=null,Xe=ue),me!==Xe)){if(it=i1,Te="onMouseLeave",ae="onMouseEnter",Q="mouse",(n==="pointerout"||n==="pointerover")&&(it=o1,Te="onPointerLeave",ae="onPointerEnter",Q="pointer"),Yt=me==null?de:Re(me),ce=Xe==null?de:Re(Xe),de=new it(Te,Q+"leave",me,o,we),de.target=Yt,de.relatedTarget=ce,Te=null,Fe(we)===ue&&(it=new it(ae,Q+"enter",Xe,o,we),it.target=ce,it.relatedTarget=Yt,Te=it),Yt=Te,me&&Xe)t:{for(it=Bb,ae=me,Q=Xe,ce=0,Te=ae;Te;Te=it(Te))ce++;Te=0;for(var nt=Q;nt;nt=it(nt))Te++;for(;0<ce-Te;)ae=it(ae),ce--;for(;0<Te-ce;)Q=it(Q),Te--;for(;ce--;){if(ae===Q||Q!==null&&ae===Q.alternate){it=ae;break t}ae=it(ae),Q=it(Q)}it=null}else it=null;me!==null&&Zp(ke,de,me,it,!1),Xe!==null&&Yt!==null&&Zp(ke,Yt,Xe,it,!0)}}e:{if(de=ue?Re(ue):window,me=de.nodeName&&de.nodeName.toLowerCase(),me==="select"||me==="input"&&de.type==="file")var Lt=p1;else if(m1(de))if(x1)Lt=Ww;else{Lt=qw;var Je=Gw}else me=de.nodeName,!me||me.toLowerCase()!=="input"||de.type!=="checkbox"&&de.type!=="radio"?ue&&go(ue.elementType)&&(Lt=p1):Lt=Xw;if(Lt&&(Lt=Lt(n,ue))){g1(ke,Lt,o,we);break e}Je&&Je(n,de,ue),n==="focusout"&&ue&&de.type==="number"&&ue.memoizedProps.value!=null&&Ye(de,"number",de.value)}switch(Je=ue?Re(ue):window,n){case"focusin":(m1(Je)||Je.contentEditable==="true")&&(sl=Je,xf=ue,Eo=null);break;case"focusout":Eo=xf=sl=null;break;case"mousedown":vf=!0;break;case"contextmenu":case"mouseup":case"dragend":vf=!1,T1(ke,o,we);break;case"selectionchange":if(Yw)break;case"keydown":case"keyup":T1(ke,o,we)}var yt;if(df)e:{switch(n){case"compositionstart":var Nt="onCompositionStart";break e;case"compositionend":Nt="onCompositionEnd";break e;case"compositionupdate":Nt="onCompositionUpdate";break e}Nt=void 0}else nl?h1(n,o)&&(Nt="onCompositionEnd"):n==="keydown"&&o.keyCode===229&&(Nt="onCompositionStart");Nt&&(c1&&o.locale!=="ko"&&(nl||Nt!=="onCompositionStart"?Nt==="onCompositionEnd"&&nl&&(yt=n1()):(Ss=we,of="value"in Ss?Ss.value:Ss.textContent,nl=!0)),Je=X0(ue,Nt),0<Je.length&&(Nt=new l1(Nt,n,null,o,we),ke.push({event:Nt,listeners:Je}),yt?Nt.data=yt:(yt=d1(o),yt!==null&&(Nt.data=yt)))),(yt=Pw?zw(n,o):Hw(n,o))&&(Nt=X0(ue,"onBeforeInput"),0<Nt.length&&(Je=new l1("onBeforeInput","beforeinput",null,o,we),ke.push({event:Je,listeners:Nt}),Je.data=yt)),Fb(ke,n,ue,o,we)}Jp(ke,i)})}function Ko(n,i,o){return{instance:n,listener:i,currentTarget:o}}function X0(n,i){for(var o=i+"Capture",f=[];n!==null;){var m=n,p=m.stateNode;if(m=m.tag,m!==5&&m!==26&&m!==27||p===null||(m=po(n,o),m!=null&&f.unshift(Ko(n,m,p)),m=po(n,i),m!=null&&f.push(Ko(n,m,p))),n.tag===3)return f;n=n.return}return[]}function Bb(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function Zp(n,i,o,f,m){for(var p=i._reactName,E=[];o!==null&&o!==f;){var R=o,W=R.alternate,ue=R.stateNode;if(R=R.tag,W!==null&&W===f)break;R!==5&&R!==26&&R!==27||ue===null||(W=ue,m?(ue=po(o,p),ue!=null&&E.unshift(Ko(o,ue,W))):m||(ue=po(o,p),ue!=null&&E.push(Ko(o,ue,W)))),o=o.return}E.length!==0&&n.push({event:i,listeners:E})}var jb=/\r\n?/g,Ub=/\u0000|\uFFFD/g;function ex(n){return(typeof n=="string"?n:""+n).replace(jb,`
`).replace(Ub,"")}function tx(n,i){return i=ex(i),ex(n)===i}function Kt(n,i,o,f,m,p){switch(o){case"children":typeof f=="string"?i==="body"||i==="textarea"&&f===""||Qt(n,f):(typeof f=="number"||typeof f=="bigint")&&i!=="body"&&Qt(n,""+f);break;case"className":De(n,"class",f);break;case"tabIndex":De(n,"tabindex",f);break;case"dir":case"role":case"viewBox":case"width":case"height":De(n,o,f);break;case"style":Qc(n,f,p);break;case"data":if(i!=="object"){De(n,"data",f);break}case"src":case"href":if(f===""&&(i!=="a"||o!=="href")){n.removeAttribute(o);break}if(f==null||typeof f=="function"||typeof f=="symbol"||typeof f=="boolean"){n.removeAttribute(o);break}f=Zc(""+f),n.setAttribute(o,f);break;case"action":case"formAction":if(typeof f=="function"){n.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof p=="function"&&(o==="formAction"?(i!=="input"&&Kt(n,i,"name",m.name,m,null),Kt(n,i,"formEncType",m.formEncType,m,null),Kt(n,i,"formMethod",m.formMethod,m,null),Kt(n,i,"formTarget",m.formTarget,m,null)):(Kt(n,i,"encType",m.encType,m,null),Kt(n,i,"method",m.method,m,null),Kt(n,i,"target",m.target,m,null)));if(f==null||typeof f=="symbol"||typeof f=="boolean"){n.removeAttribute(o);break}f=Zc(""+f),n.setAttribute(o,f);break;case"onClick":f!=null&&(n.onclick=Gn);break;case"onScroll":f!=null&&kt("scroll",n);break;case"onScrollEnd":f!=null&&kt("scrollend",n);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(a(61));if(o=f.__html,o!=null){if(m.children!=null)throw Error(a(60));n.innerHTML=o}}break;case"multiple":n.multiple=f&&typeof f!="function"&&typeof f!="symbol";break;case"muted":n.muted=f&&typeof f!="function"&&typeof f!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(f==null||typeof f=="function"||typeof f=="boolean"||typeof f=="symbol"){n.removeAttribute("xlink:href");break}o=Zc(""+f),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":f!=null&&typeof f!="function"&&typeof f!="symbol"?n.setAttribute(o,""+f):n.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":f&&typeof f!="function"&&typeof f!="symbol"?n.setAttribute(o,""):n.removeAttribute(o);break;case"capture":case"download":f===!0?n.setAttribute(o,""):f!==!1&&f!=null&&typeof f!="function"&&typeof f!="symbol"?n.setAttribute(o,f):n.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":f!=null&&typeof f!="function"&&typeof f!="symbol"&&!isNaN(f)&&1<=f?n.setAttribute(o,f):n.removeAttribute(o);break;case"rowSpan":case"start":f==null||typeof f=="function"||typeof f=="symbol"||isNaN(f)?n.removeAttribute(o):n.setAttribute(o,f);break;case"popover":kt("beforetoggle",n),kt("toggle",n),le(n,"popover",f);break;case"xlinkActuate":Ie(n,"http://www.w3.org/1999/xlink","xlink:actuate",f);break;case"xlinkArcrole":Ie(n,"http://www.w3.org/1999/xlink","xlink:arcrole",f);break;case"xlinkRole":Ie(n,"http://www.w3.org/1999/xlink","xlink:role",f);break;case"xlinkShow":Ie(n,"http://www.w3.org/1999/xlink","xlink:show",f);break;case"xlinkTitle":Ie(n,"http://www.w3.org/1999/xlink","xlink:title",f);break;case"xlinkType":Ie(n,"http://www.w3.org/1999/xlink","xlink:type",f);break;case"xmlBase":Ie(n,"http://www.w3.org/XML/1998/namespace","xml:base",f);break;case"xmlLang":Ie(n,"http://www.w3.org/XML/1998/namespace","xml:lang",f);break;case"xmlSpace":Ie(n,"http://www.w3.org/XML/1998/namespace","xml:space",f);break;case"is":le(n,"is",f);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=dw.get(o)||o,le(n,o,f))}}function $h(n,i,o,f,m,p){switch(o){case"style":Qc(n,f,p);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(a(61));if(o=f.__html,o!=null){if(m.children!=null)throw Error(a(60));n.innerHTML=o}}break;case"children":typeof f=="string"?Qt(n,f):(typeof f=="number"||typeof f=="bigint")&&Qt(n,""+f);break;case"onScroll":f!=null&&kt("scroll",n);break;case"onScrollEnd":f!=null&&kt("scrollend",n);break;case"onClick":f!=null&&(n.onclick=Gn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Xt.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(m=o.endsWith("Capture"),i=o.slice(2,m?o.length-7:void 0),p=n[B]||null,p=p!=null?p[o]:null,typeof p=="function"&&n.removeEventListener(i,p,m),typeof f=="function")){typeof p!="function"&&p!==null&&(o in n?n[o]=null:n.hasAttribute(o)&&n.removeAttribute(o)),n.addEventListener(i,f,m);break e}o in n?n[o]=f:f===!0?n.setAttribute(o,""):le(n,o,f)}}}function Qr(n,i,o){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":kt("error",n),kt("load",n);var f=!1,m=!1,p;for(p in o)if(o.hasOwnProperty(p)){var E=o[p];if(E!=null)switch(p){case"src":f=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,i));default:Kt(n,i,p,E,o,null)}}m&&Kt(n,i,"srcSet",o.srcSet,o,null),f&&Kt(n,i,"src",o.src,o,null);return;case"input":kt("invalid",n);var R=p=E=m=null,W=null,ue=null;for(f in o)if(o.hasOwnProperty(f)){var we=o[f];if(we!=null)switch(f){case"name":m=we;break;case"type":E=we;break;case"checked":W=we;break;case"defaultChecked":ue=we;break;case"value":p=we;break;case"defaultValue":R=we;break;case"children":case"dangerouslySetInnerHTML":if(we!=null)throw Error(a(137,i));break;default:Kt(n,i,f,we,o,null)}}Ge(n,p,R,W,ue,E,m,!1);return;case"select":kt("invalid",n),f=E=p=null;for(m in o)if(o.hasOwnProperty(m)&&(R=o[m],R!=null))switch(m){case"value":p=R;break;case"defaultValue":E=R;break;case"multiple":f=R;default:Kt(n,i,m,R,o,null)}i=p,o=E,n.multiple=!!f,i!=null?pt(n,!!f,i,!1):o!=null&&pt(n,!!f,o,!0);return;case"textarea":kt("invalid",n),p=m=f=null;for(E in o)if(o.hasOwnProperty(E)&&(R=o[E],R!=null))switch(E){case"value":f=R;break;case"defaultValue":m=R;break;case"children":p=R;break;case"dangerouslySetInnerHTML":if(R!=null)throw Error(a(91));break;default:Kt(n,i,E,R,o,null)}gr(n,f,m,p);return;case"option":for(W in o)o.hasOwnProperty(W)&&(f=o[W],f!=null)&&(W==="selected"?n.selected=f&&typeof f!="function"&&typeof f!="symbol":Kt(n,i,W,f,o,null));return;case"dialog":kt("beforetoggle",n),kt("toggle",n),kt("cancel",n),kt("close",n);break;case"iframe":case"object":kt("load",n);break;case"video":case"audio":for(f=0;f<Wo.length;f++)kt(Wo[f],n);break;case"image":kt("error",n),kt("load",n);break;case"details":kt("toggle",n);break;case"embed":case"source":case"link":kt("error",n),kt("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ue in o)if(o.hasOwnProperty(ue)&&(f=o[ue],f!=null))switch(ue){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,i));default:Kt(n,i,ue,f,o,null)}return;default:if(go(i)){for(we in o)o.hasOwnProperty(we)&&(f=o[we],f!==void 0&&$h(n,i,we,f,o,void 0));return}}for(R in o)o.hasOwnProperty(R)&&(f=o[R],f!=null&&Kt(n,i,R,f,o,null))}function Pb(n,i,o,f){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,p=null,E=null,R=null,W=null,ue=null,we=null;for(me in o){var ke=o[me];if(o.hasOwnProperty(me)&&ke!=null)switch(me){case"checked":break;case"value":break;case"defaultValue":W=ke;default:f.hasOwnProperty(me)||Kt(n,i,me,null,f,ke)}}for(var de in f){var me=f[de];if(ke=o[de],f.hasOwnProperty(de)&&(me!=null||ke!=null))switch(de){case"type":p=me;break;case"name":m=me;break;case"checked":ue=me;break;case"defaultChecked":we=me;break;case"value":E=me;break;case"defaultValue":R=me;break;case"children":case"dangerouslySetInnerHTML":if(me!=null)throw Error(a(137,i));break;default:me!==ke&&Kt(n,i,de,me,f,ke)}}Ve(n,E,R,W,ue,we,p,m);return;case"select":me=E=R=de=null;for(p in o)if(W=o[p],o.hasOwnProperty(p)&&W!=null)switch(p){case"value":break;case"multiple":me=W;default:f.hasOwnProperty(p)||Kt(n,i,p,null,f,W)}for(m in f)if(p=f[m],W=o[m],f.hasOwnProperty(m)&&(p!=null||W!=null))switch(m){case"value":de=p;break;case"defaultValue":R=p;break;case"multiple":E=p;default:p!==W&&Kt(n,i,m,p,f,W)}i=R,o=E,f=me,de!=null?pt(n,!!o,de,!1):!!f!=!!o&&(i!=null?pt(n,!!o,i,!0):pt(n,!!o,o?[]:"",!1));return;case"textarea":me=de=null;for(R in o)if(m=o[R],o.hasOwnProperty(R)&&m!=null&&!f.hasOwnProperty(R))switch(R){case"value":break;case"children":break;default:Kt(n,i,R,null,f,m)}for(E in f)if(m=f[E],p=o[E],f.hasOwnProperty(E)&&(m!=null||p!=null))switch(E){case"value":de=m;break;case"defaultValue":me=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(a(91));break;default:m!==p&&Kt(n,i,E,m,f,p)}et(n,de,me);return;case"option":for(var Xe in o)de=o[Xe],o.hasOwnProperty(Xe)&&de!=null&&!f.hasOwnProperty(Xe)&&(Xe==="selected"?n.selected=!1:Kt(n,i,Xe,null,f,de));for(W in f)de=f[W],me=o[W],f.hasOwnProperty(W)&&de!==me&&(de!=null||me!=null)&&(W==="selected"?n.selected=de&&typeof de!="function"&&typeof de!="symbol":Kt(n,i,W,de,f,me));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var it in o)de=o[it],o.hasOwnProperty(it)&&de!=null&&!f.hasOwnProperty(it)&&Kt(n,i,it,null,f,de);for(ue in f)if(de=f[ue],me=o[ue],f.hasOwnProperty(ue)&&de!==me&&(de!=null||me!=null))switch(ue){case"children":case"dangerouslySetInnerHTML":if(de!=null)throw Error(a(137,i));break;default:Kt(n,i,ue,de,f,me)}return;default:if(go(i)){for(var Yt in o)de=o[Yt],o.hasOwnProperty(Yt)&&de!==void 0&&!f.hasOwnProperty(Yt)&&$h(n,i,Yt,void 0,f,de);for(we in f)de=f[we],me=o[we],!f.hasOwnProperty(we)||de===me||de===void 0&&me===void 0||$h(n,i,we,de,f,me);return}}for(var ae in o)de=o[ae],o.hasOwnProperty(ae)&&de!=null&&!f.hasOwnProperty(ae)&&Kt(n,i,ae,null,f,de);for(ke in f)de=f[ke],me=o[ke],!f.hasOwnProperty(ke)||de===me||de==null&&me==null||Kt(n,i,ke,de,f,me)}function rx(n){switch(n){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function zb(){if(typeof performance.getEntriesByType=="function"){for(var n=0,i=0,o=performance.getEntriesByType("resource"),f=0;f<o.length;f++){var m=o[f],p=m.transferSize,E=m.initiatorType,R=m.duration;if(p&&R&&rx(E)){for(E=0,R=m.responseEnd,f+=1;f<o.length;f++){var W=o[f],ue=W.startTime;if(ue>R)break;var we=W.transferSize,ke=W.initiatorType;we&&rx(ke)&&(W=W.responseEnd,E+=we*(W<R?1:(R-ue)/(W-ue)))}if(--f,i+=8*(p+E)/(m.duration/1e3),n++,10<n)break}}if(0<n)return i/n/1e6}return navigator.connection&&(n=navigator.connection.downlink,typeof n=="number")?n:5}var Vh=null,Gh=null;function W0(n){return n.nodeType===9?n:n.ownerDocument}function ax(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function nx(n,i){if(n===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&i==="foreignObject"?0:n}function qh(n,i){return n==="textarea"||n==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Xh=null;function Hb(){var n=window.event;return n&&n.type==="popstate"?n===Xh?!1:(Xh=n,!0):(Xh=null,!1)}var sx=typeof setTimeout=="function"?setTimeout:void 0,$b=typeof clearTimeout=="function"?clearTimeout:void 0,ix=typeof Promise=="function"?Promise:void 0,Vb=typeof queueMicrotask=="function"?queueMicrotask:typeof ix<"u"?function(n){return ix.resolve(null).then(n).catch(Gb)}:sx;function Gb(n){setTimeout(function(){throw n})}function Ps(n){return n==="head"}function lx(n,i){var o=i,f=0;do{var m=o.nextSibling;if(n.removeChild(o),m&&m.nodeType===8)if(o=m.data,o==="/$"||o==="/&"){if(f===0){n.removeChild(m),Dl(i);return}f--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")f++;else if(o==="html")Yo(n.ownerDocument.documentElement);else if(o==="head"){o=n.ownerDocument.head,Yo(o);for(var p=o.firstChild;p;){var E=p.nextSibling,R=p.nodeName;p[he]||R==="SCRIPT"||R==="STYLE"||R==="LINK"&&p.rel.toLowerCase()==="stylesheet"||o.removeChild(p),p=E}}else o==="body"&&Yo(n.ownerDocument.body);o=m}while(o);Dl(i)}function ox(n,i){var o=n;n=0;do{var f=o.nextSibling;if(o.nodeType===1?i?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(i?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),f&&f.nodeType===8)if(o=f.data,o==="/$"){if(n===0)break;n--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||n++;o=f}while(o)}function Wh(n){var i=n.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var o=i;switch(i=i.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":Wh(o),Oe(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}n.removeChild(o)}}function qb(n,i,o,f){for(;n.nodeType===1;){var m=o;if(n.nodeName.toLowerCase()!==i.toLowerCase()){if(!f&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(f){if(!n[he])switch(i){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(p=n.getAttribute("rel"),p==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(p!==m.rel||n.getAttribute("href")!==(m.href==null||m.href===""?null:m.href)||n.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||n.getAttribute("title")!==(m.title==null?null:m.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(p=n.getAttribute("src"),(p!==(m.src==null?null:m.src)||n.getAttribute("type")!==(m.type==null?null:m.type)||n.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&p&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(i==="input"&&n.type==="hidden"){var p=m.name==null?null:""+m.name;if(m.type==="hidden"&&n.getAttribute("name")===p)return n}else return n;if(n=nn(n.nextSibling),n===null)break}return null}function Xb(n,i,o){if(i==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!o||(n=nn(n.nextSibling),n===null))return null;return n}function cx(n,i){for(;n.nodeType!==8;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!i||(n=nn(n.nextSibling),n===null))return null;return n}function Kh(n){return n.data==="$?"||n.data==="$~"}function Yh(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState!=="loading"}function Wb(n,i){var o=n.ownerDocument;if(n.data==="$~")n._reactRetry=i;else if(n.data!=="$?"||o.readyState!=="loading")i();else{var f=function(){i(),o.removeEventListener("DOMContentLoaded",f)};o.addEventListener("DOMContentLoaded",f),n._reactRetry=f}}function nn(n){for(;n!=null;n=n.nextSibling){var i=n.nodeType;if(i===1||i===3)break;if(i===8){if(i=n.data,i==="$"||i==="$!"||i==="$?"||i==="$~"||i==="&"||i==="F!"||i==="F")break;if(i==="/$"||i==="/&")return null}}return n}var Jh=null;function ux(n){n=n.nextSibling;for(var i=0;n;){if(n.nodeType===8){var o=n.data;if(o==="/$"||o==="/&"){if(i===0)return nn(n.nextSibling);i--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||i++}n=n.nextSibling}return null}function fx(n){n=n.previousSibling;for(var i=0;n;){if(n.nodeType===8){var o=n.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(i===0)return n;i--}else o!=="/$"&&o!=="/&"||i++}n=n.previousSibling}return null}function hx(n,i,o){switch(i=W0(o),n){case"html":if(n=i.documentElement,!n)throw Error(a(452));return n;case"head":if(n=i.head,!n)throw Error(a(453));return n;case"body":if(n=i.body,!n)throw Error(a(454));return n;default:throw Error(a(451))}}function Yo(n){for(var i=n.attributes;i.length;)n.removeAttributeNode(i[0]);Oe(n)}var sn=new Map,dx=new Set;function K0(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var ls=ne.d;ne.d={f:Kb,r:Yb,D:Jb,C:Qb,L:Zb,m:eS,X:rS,S:tS,M:aS};function Kb(){var n=ls.f(),i=P0();return n||i}function Yb(n){var i=He(n);i!==null&&i.tag===5&&i.type==="form"?Og(i):ls.r(n)}var Nl=typeof document>"u"?null:document;function mx(n,i,o){var f=Nl;if(f&&typeof i=="string"&&i){var m=Pe(i);m='link[rel="'+n+'"][href="'+m+'"]',typeof o=="string"&&(m+='[crossorigin="'+o+'"]'),dx.has(m)||(dx.add(m),n={rel:n,crossOrigin:o,href:i},f.querySelector(m)===null&&(i=f.createElement("link"),Qr(i,"link",n),We(i),f.head.appendChild(i)))}}function Jb(n){ls.D(n),mx("dns-prefetch",n,null)}function Qb(n,i){ls.C(n,i),mx("preconnect",n,i)}function Zb(n,i,o){ls.L(n,i,o);var f=Nl;if(f&&n&&i){var m='link[rel="preload"][as="'+Pe(i)+'"]';i==="image"&&o&&o.imageSrcSet?(m+='[imagesrcset="'+Pe(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(m+='[imagesizes="'+Pe(o.imageSizes)+'"]')):m+='[href="'+Pe(n)+'"]';var p=m;switch(i){case"style":p=Ol(n);break;case"script":p=Rl(n)}sn.has(p)||(n=x({rel:"preload",href:i==="image"&&o&&o.imageSrcSet?void 0:n,as:i},o),sn.set(p,n),f.querySelector(m)!==null||i==="style"&&f.querySelector(Jo(p))||i==="script"&&f.querySelector(Qo(p))||(i=f.createElement("link"),Qr(i,"link",n),We(i),f.head.appendChild(i)))}}function eS(n,i){ls.m(n,i);var o=Nl;if(o&&n){var f=i&&typeof i.as=="string"?i.as:"script",m='link[rel="modulepreload"][as="'+Pe(f)+'"][href="'+Pe(n)+'"]',p=m;switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":p=Rl(n)}if(!sn.has(p)&&(n=x({rel:"modulepreload",href:n},i),sn.set(p,n),o.querySelector(m)===null)){switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(Qo(p)))return}f=o.createElement("link"),Qr(f,"link",n),We(f),o.head.appendChild(f)}}}function tS(n,i,o){ls.S(n,i,o);var f=Nl;if(f&&n){var m=je(f).hoistableStyles,p=Ol(n);i=i||"default";var E=m.get(p);if(!E){var R={loading:0,preload:null};if(E=f.querySelector(Jo(p)))R.loading=5;else{n=x({rel:"stylesheet",href:n,"data-precedence":i},o),(o=sn.get(p))&&Qh(n,o);var W=E=f.createElement("link");We(W),Qr(W,"link",n),W._p=new Promise(function(ue,we){W.onload=ue,W.onerror=we}),W.addEventListener("load",function(){R.loading|=1}),W.addEventListener("error",function(){R.loading|=2}),R.loading|=4,Y0(E,i,f)}E={type:"stylesheet",instance:E,count:1,state:R},m.set(p,E)}}}function rS(n,i){ls.X(n,i);var o=Nl;if(o&&n){var f=je(o).hoistableScripts,m=Rl(n),p=f.get(m);p||(p=o.querySelector(Qo(m)),p||(n=x({src:n,async:!0},i),(i=sn.get(m))&&Zh(n,i),p=o.createElement("script"),We(p),Qr(p,"link",n),o.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},f.set(m,p))}}function aS(n,i){ls.M(n,i);var o=Nl;if(o&&n){var f=je(o).hoistableScripts,m=Rl(n),p=f.get(m);p||(p=o.querySelector(Qo(m)),p||(n=x({src:n,async:!0,type:"module"},i),(i=sn.get(m))&&Zh(n,i),p=o.createElement("script"),We(p),Qr(p,"link",n),o.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},f.set(m,p))}}function gx(n,i,o,f){var m=(m=te.current)?K0(m):null;if(!m)throw Error(a(446));switch(n){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(i=Ol(o.href),o=je(m).hoistableStyles,f=o.get(i),f||(f={type:"style",instance:null,count:0,state:null},o.set(i,f)),f):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){n=Ol(o.href);var p=je(m).hoistableStyles,E=p.get(n);if(E||(m=m.ownerDocument||m,E={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},p.set(n,E),(p=m.querySelector(Jo(n)))&&!p._p&&(E.instance=p,E.state.loading=5),sn.has(n)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},sn.set(n,o),p||nS(m,n,o,E.state))),i&&f===null)throw Error(a(528,""));return E}if(i&&f!==null)throw Error(a(529,""));return null;case"script":return i=o.async,o=o.src,typeof o=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=Rl(o),o=je(m).hoistableScripts,f=o.get(i),f||(f={type:"script",instance:null,count:0,state:null},o.set(i,f)),f):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,n))}}function Ol(n){return'href="'+Pe(n)+'"'}function Jo(n){return'link[rel="stylesheet"]['+n+"]"}function px(n){return x({},n,{"data-precedence":n.precedence,precedence:null})}function nS(n,i,o,f){n.querySelector('link[rel="preload"][as="style"]['+i+"]")?f.loading=1:(i=n.createElement("link"),f.preload=i,i.addEventListener("load",function(){return f.loading|=1}),i.addEventListener("error",function(){return f.loading|=2}),Qr(i,"link",o),We(i),n.head.appendChild(i))}function Rl(n){return'[src="'+Pe(n)+'"]'}function Qo(n){return"script[async]"+n}function xx(n,i,o){if(i.count++,i.instance===null)switch(i.type){case"style":var f=n.querySelector('style[data-href~="'+Pe(o.href)+'"]');if(f)return i.instance=f,We(f),f;var m=x({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return f=(n.ownerDocument||n).createElement("style"),We(f),Qr(f,"style",m),Y0(f,o.precedence,n),i.instance=f;case"stylesheet":m=Ol(o.href);var p=n.querySelector(Jo(m));if(p)return i.state.loading|=4,i.instance=p,We(p),p;f=px(o),(m=sn.get(m))&&Qh(f,m),p=(n.ownerDocument||n).createElement("link"),We(p);var E=p;return E._p=new Promise(function(R,W){E.onload=R,E.onerror=W}),Qr(p,"link",f),i.state.loading|=4,Y0(p,o.precedence,n),i.instance=p;case"script":return p=Rl(o.src),(m=n.querySelector(Qo(p)))?(i.instance=m,We(m),m):(f=o,(m=sn.get(p))&&(f=x({},o),Zh(f,m)),n=n.ownerDocument||n,m=n.createElement("script"),We(m),Qr(m,"link",f),n.head.appendChild(m),i.instance=m);case"void":return null;default:throw Error(a(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(f=i.instance,i.state.loading|=4,Y0(f,o.precedence,n));return i.instance}function Y0(n,i,o){for(var f=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=f.length?f[f.length-1]:null,p=m,E=0;E<f.length;E++){var R=f[E];if(R.dataset.precedence===i)p=R;else if(p!==m)break}p?p.parentNode.insertBefore(n,p.nextSibling):(i=o.nodeType===9?o.head:o,i.insertBefore(n,i.firstChild))}function Qh(n,i){n.crossOrigin==null&&(n.crossOrigin=i.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=i.referrerPolicy),n.title==null&&(n.title=i.title)}function Zh(n,i){n.crossOrigin==null&&(n.crossOrigin=i.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=i.referrerPolicy),n.integrity==null&&(n.integrity=i.integrity)}var J0=null;function vx(n,i,o){if(J0===null){var f=new Map,m=J0=new Map;m.set(o,f)}else m=J0,f=m.get(o),f||(f=new Map,m.set(o,f));if(f.has(n))return f;for(f.set(n,null),o=o.getElementsByTagName(n),m=0;m<o.length;m++){var p=o[m];if(!(p[he]||p[F]||n==="link"&&p.getAttribute("rel")==="stylesheet")&&p.namespaceURI!=="http://www.w3.org/2000/svg"){var E=p.getAttribute(i)||"";E=n+E;var R=f.get(E);R?R.push(p):f.set(E,[p])}}return f}function yx(n,i,o){n=n.ownerDocument||n,n.head.insertBefore(o,i==="title"?n.querySelector("head > title"):null)}function sS(n,i,o){if(o===1||i.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;return i.rel==="stylesheet"?(n=i.disabled,typeof i.precedence=="string"&&n==null):!0;case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function _x(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}function iS(n,i,o,f){if(o.type==="stylesheet"&&(typeof f.media!="string"||matchMedia(f.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var m=Ol(f.href),p=i.querySelector(Jo(m));if(p){i=p._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(n.count++,n=Q0.bind(n),i.then(n,n)),o.state.loading|=4,o.instance=p,We(p);return}p=i.ownerDocument||i,f=px(f),(m=sn.get(m))&&Qh(f,m),p=p.createElement("link"),We(p);var E=p;E._p=new Promise(function(R,W){E.onload=R,E.onerror=W}),Qr(p,"link",f),o.instance=p}n.stylesheets===null&&(n.stylesheets=new Map),n.stylesheets.set(o,i),(i=o.state.preload)&&(o.state.loading&3)===0&&(n.count++,o=Q0.bind(n),i.addEventListener("load",o),i.addEventListener("error",o))}}var ed=0;function lS(n,i){return n.stylesheets&&n.count===0&&eu(n,n.stylesheets),0<n.count||0<n.imgCount?function(o){var f=setTimeout(function(){if(n.stylesheets&&eu(n,n.stylesheets),n.unsuspend){var p=n.unsuspend;n.unsuspend=null,p()}},6e4+i);0<n.imgBytes&&ed===0&&(ed=62500*zb());var m=setTimeout(function(){if(n.waitingForImages=!1,n.count===0&&(n.stylesheets&&eu(n,n.stylesheets),n.unsuspend)){var p=n.unsuspend;n.unsuspend=null,p()}},(n.imgBytes>ed?50:800)+i);return n.unsuspend=o,function(){n.unsuspend=null,clearTimeout(f),clearTimeout(m)}}:null}function Q0(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)eu(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var Z0=null;function eu(n,i){n.stylesheets=null,n.unsuspend!==null&&(n.count++,Z0=new Map,i.forEach(oS,n),Z0=null,Q0.call(n))}function oS(n,i){if(!(i.state.loading&4)){var o=Z0.get(n);if(o)var f=o.get(null);else{o=new Map,Z0.set(n,o);for(var m=n.querySelectorAll("link[data-precedence],style[data-precedence]"),p=0;p<m.length;p++){var E=m[p];(E.nodeName==="LINK"||E.getAttribute("media")!=="not all")&&(o.set(E.dataset.precedence,E),f=E)}f&&o.set(null,f)}m=i.instance,E=m.getAttribute("data-precedence"),p=o.get(E)||f,p===f&&o.set(null,m),o.set(E,m),this.count++,f=Q0.bind(this),m.addEventListener("load",f),m.addEventListener("error",f),p?p.parentNode.insertBefore(m,p.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(m,n.firstChild)),i.state.loading|=4}}var Zo={$$typeof:T,Provider:null,Consumer:null,_currentValue:pe,_currentValue2:pe,_threadCount:0};function cS(n,i,o,f,m,p,E,R,W){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ci(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ci(0),this.hiddenUpdates=ci(null),this.identifierPrefix=f,this.onUncaughtError=m,this.onCaughtError=p,this.onRecoverableError=E,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=W,this.incompleteTransitions=new Map}function wx(n,i,o,f,m,p,E,R,W,ue,we,ke){return n=new cS(n,i,o,E,W,ue,we,ke,R),i=1,p===!0&&(i|=24),p=Ia(3,null,null,i),n.current=p,p.stateNode=n,i=Ff(),i.refCount++,n.pooledCache=i,i.refCount++,p.memoizedState={element:f,isDehydrated:o,cache:i},Bf(p),n}function bx(n){return n?(n=ol,n):ol}function Sx(n,i,o,f,m,p){m=bx(m),f.context===null?f.context=m:f.pendingContext=m,f=Ns(i),f.payload={element:o},p=p===void 0?null:p,p!==null&&(f.callback=p),o=Os(n,f,i),o!==null&&(Na(o,n,i),Ro(o,n,i))}function Ex(n,i){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var o=n.retryLane;n.retryLane=o!==0&&o<i?o:i}}function td(n,i){Ex(n,i),(n=n.alternate)&&Ex(n,i)}function Tx(n){if(n.tag===13||n.tag===31){var i=gi(n,67108864);i!==null&&Na(i,n,67108864),td(n,67108864)}}function kx(n){if(n.tag===13||n.tag===31){var i=za();i=ui(i);var o=gi(n,i);o!==null&&Na(o,n,i),td(n,i)}}var tu=!0;function uS(n,i,o,f){var m=G.T;G.T=null;var p=ne.p;try{ne.p=2,rd(n,i,o,f)}finally{ne.p=p,G.T=m}}function fS(n,i,o,f){var m=G.T;G.T=null;var p=ne.p;try{ne.p=8,rd(n,i,o,f)}finally{ne.p=p,G.T=m}}function rd(n,i,o,f){if(tu){var m=ad(f);if(m===null)Hh(n,i,f,ru,o),Cx(n,f);else if(dS(m,n,i,o,f))f.stopPropagation();else if(Cx(n,f),i&4&&-1<hS.indexOf(n)){for(;m!==null;){var p=He(m);if(p!==null)switch(p.tag){case 3:if(p=p.stateNode,p.current.memoizedState.isDehydrated){var E=wa(p.pendingLanes);if(E!==0){var R=p;for(R.pendingLanes|=2,R.entangledLanes|=2;E;){var W=1<<31-Wr(E);R.entanglements[1]|=W,E&=~W}Mn(p),(jt&6)===0&&(j0=Mt()+500,Xo(0))}}break;case 31:case 13:R=gi(p,2),R!==null&&Na(R,p,2),P0(),td(p,2)}if(p=ad(f),p===null&&Hh(n,i,f,ru,o),p===m)break;m=p}m!==null&&f.stopPropagation()}else Hh(n,i,f,null,o)}}function ad(n){return n=nf(n),nd(n)}var ru=null;function nd(n){if(ru=null,n=Fe(n),n!==null){var i=l(n);if(i===null)n=null;else{var o=i.tag;if(o===13){if(n=c(i),n!==null)return n;n=null}else if(o===31){if(n=u(i),n!==null)return n;n=null}else if(o===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;n=null}else i!==n&&(n=null)}}return ru=n,null}function Ax(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(sa()){case zr:return 2;case Ja:return 8;case cr:case mr:return 32;case gt:return 268435456;default:return 32}default:return 32}}var sd=!1,zs=null,Hs=null,$s=null,ec=new Map,tc=new Map,Vs=[],hS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Cx(n,i){switch(n){case"focusin":case"focusout":zs=null;break;case"dragenter":case"dragleave":Hs=null;break;case"mouseover":case"mouseout":$s=null;break;case"pointerover":case"pointerout":ec.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":tc.delete(i.pointerId)}}function rc(n,i,o,f,m,p){return n===null||n.nativeEvent!==p?(n={blockedOn:i,domEventName:o,eventSystemFlags:f,nativeEvent:p,targetContainers:[m]},i!==null&&(i=He(i),i!==null&&Tx(i)),n):(n.eventSystemFlags|=f,i=n.targetContainers,m!==null&&i.indexOf(m)===-1&&i.push(m),n)}function dS(n,i,o,f,m){switch(i){case"focusin":return zs=rc(zs,n,i,o,f,m),!0;case"dragenter":return Hs=rc(Hs,n,i,o,f,m),!0;case"mouseover":return $s=rc($s,n,i,o,f,m),!0;case"pointerover":var p=m.pointerId;return ec.set(p,rc(ec.get(p)||null,n,i,o,f,m)),!0;case"gotpointercapture":return p=m.pointerId,tc.set(p,rc(tc.get(p)||null,n,i,o,f,m)),!0}return!1}function Nx(n){var i=Fe(n.target);if(i!==null){var o=l(i);if(o!==null){if(i=o.tag,i===13){if(i=c(o),i!==null){n.blockedOn=i,U(n.priority,function(){kx(o)});return}}else if(i===31){if(i=u(o),i!==null){n.blockedOn=i,U(n.priority,function(){kx(o)});return}}else if(i===3&&o.stateNode.current.memoizedState.isDehydrated){n.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}n.blockedOn=null}function au(n){if(n.blockedOn!==null)return!1;for(var i=n.targetContainers;0<i.length;){var o=ad(n.nativeEvent);if(o===null){o=n.nativeEvent;var f=new o.constructor(o.type,o);af=f,o.target.dispatchEvent(f),af=null}else return i=He(o),i!==null&&Tx(i),n.blockedOn=o,!1;i.shift()}return!0}function Ox(n,i,o){au(n)&&o.delete(i)}function mS(){sd=!1,zs!==null&&au(zs)&&(zs=null),Hs!==null&&au(Hs)&&(Hs=null),$s!==null&&au($s)&&($s=null),ec.forEach(Ox),tc.forEach(Ox)}function nu(n,i){n.blockedOn===i&&(n.blockedOn=null,sd||(sd=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,mS)))}var su=null;function Rx(n){su!==n&&(su=n,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){su===n&&(su=null);for(var i=0;i<n.length;i+=3){var o=n[i],f=n[i+1],m=n[i+2];if(typeof f!="function"){if(nd(f||o)===null)continue;break}var p=He(o);p!==null&&(n.splice(i,3),i-=3,ah(p,{pending:!0,data:m,method:o.method,action:f},f,m))}}))}function Dl(n){function i(W){return nu(W,n)}zs!==null&&nu(zs,n),Hs!==null&&nu(Hs,n),$s!==null&&nu($s,n),ec.forEach(i),tc.forEach(i);for(var o=0;o<Vs.length;o++){var f=Vs[o];f.blockedOn===n&&(f.blockedOn=null)}for(;0<Vs.length&&(o=Vs[0],o.blockedOn===null);)Nx(o),o.blockedOn===null&&Vs.shift();if(o=(n.ownerDocument||n).$$reactFormReplay,o!=null)for(f=0;f<o.length;f+=3){var m=o[f],p=o[f+1],E=m[B]||null;if(typeof p=="function")E||Rx(o);else if(E){var R=null;if(p&&p.hasAttribute("formAction")){if(m=p,E=p[B]||null)R=E.formAction;else if(nd(m)!==null)continue}else R=E.action;typeof R=="function"?o[f+1]=R:(o.splice(f,3),f-=3),Rx(o)}}}function Dx(){function n(p){p.canIntercept&&p.info==="react-transition"&&p.intercept({handler:function(){return new Promise(function(E){return m=E})},focusReset:"manual",scroll:"manual"})}function i(){m!==null&&(m(),m=null),f||setTimeout(o,20)}function o(){if(!f&&!navigation.transition){var p=navigation.currentEntry;p&&p.url!=null&&navigation.navigate(p.url,{state:p.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var f=!1,m=null;return navigation.addEventListener("navigate",n),navigation.addEventListener("navigatesuccess",i),navigation.addEventListener("navigateerror",i),setTimeout(o,100),function(){f=!0,navigation.removeEventListener("navigate",n),navigation.removeEventListener("navigatesuccess",i),navigation.removeEventListener("navigateerror",i),m!==null&&(m(),m=null)}}}function id(n){this._internalRoot=n}iu.prototype.render=id.prototype.render=function(n){var i=this._internalRoot;if(i===null)throw Error(a(409));var o=i.current,f=za();Sx(o,f,n,i,null,null)},iu.prototype.unmount=id.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var i=n.containerInfo;Sx(n.current,2,null,n,null,null),P0(),i[H]=null}};function iu(n){this._internalRoot=n}iu.prototype.unstable_scheduleHydration=function(n){if(n){var i=A();n={blockedOn:null,target:n,priority:i};for(var o=0;o<Vs.length&&i!==0&&i<Vs[o].priority;o++);Vs.splice(o,0,n),o===0&&Nx(n)}};var Fx=t.version;if(Fx!=="19.2.3")throw Error(a(527,Fx,"19.2.3"));ne.findDOMNode=function(n){var i=n._reactInternals;if(i===void 0)throw typeof n.render=="function"?Error(a(188)):(n=Object.keys(n).join(","),Error(a(268,n)));return n=d(i),n=n!==null?g(n):null,n=n===null?null:n.stateNode,n};var gS={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:G,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var lu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!lu.isDisabled&&lu.supportsFiber)try{Rt=lu.inject(gS),rr=lu}catch{}}return nc.createRoot=function(n,i){if(!s(n))throw Error(a(299));var o=!1,f="",m=Pg,p=zg,E=Hg;return i!=null&&(i.unstable_strictMode===!0&&(o=!0),i.identifierPrefix!==void 0&&(f=i.identifierPrefix),i.onUncaughtError!==void 0&&(m=i.onUncaughtError),i.onCaughtError!==void 0&&(p=i.onCaughtError),i.onRecoverableError!==void 0&&(E=i.onRecoverableError)),i=wx(n,1,!1,null,null,o,f,null,m,p,E,Dx),n[H]=i.current,zh(n),new id(i)},nc.hydrateRoot=function(n,i,o){if(!s(n))throw Error(a(299));var f=!1,m="",p=Pg,E=zg,R=Hg,W=null;return o!=null&&(o.unstable_strictMode===!0&&(f=!0),o.identifierPrefix!==void 0&&(m=o.identifierPrefix),o.onUncaughtError!==void 0&&(p=o.onUncaughtError),o.onCaughtError!==void 0&&(E=o.onCaughtError),o.onRecoverableError!==void 0&&(R=o.onRecoverableError),o.formState!==void 0&&(W=o.formState)),i=wx(n,1,!0,i,o??null,f,m,W,p,E,R,Dx),i.context=bx(null),o=i.current,f=za(),f=ui(f),m=Ns(f),m.callback=null,Os(o,m,f),o=f,i.current.lanes=o,Vn(i,o),Mn(i),n[H]=i.current,zh(n),new iu(i)},nc.version="19.2.3",nc}var $x;function TS(){if($x)return cd.exports;$x=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),cd.exports=ES(),cd.exports}var kS=TS();const AS=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),CS=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,a)=>a?a.toUpperCase():r.toLowerCase()),Vx=e=>{const t=CS(e);return t.charAt(0).toUpperCase()+t.slice(1)},Fy=(...e)=>e.filter((t,r,a)=>!!t&&t.trim()!==""&&a.indexOf(t)===r).join(" ").trim(),NS=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};var OS={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const RS=ze.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:a,className:s="",children:l,iconNode:c,...u},h)=>ze.createElement("svg",{ref:h,...OS,width:t,height:t,stroke:e,strokeWidth:a?Number(r)*24/Number(t):r,className:Fy("lucide",s),...!l&&!NS(u)&&{"aria-hidden":"true"},...u},[...c.map(([d,g])=>ze.createElement(d,g)),...Array.isArray(l)?l:[l]]));const or=(e,t)=>{const r=ze.forwardRef(({className:a,...s},l)=>ze.createElement(RS,{ref:l,iconNode:t,className:Fy(`lucide-${AS(Vx(e))}`,`lucide-${e}`,a),...s}));return r.displayName=Vx(e),r};const DS=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],FS=or("calendar-days",DS);const MS=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],My=or("chart-column",MS);const LS=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],IS=or("chevron-right",LS);const BS=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],zc=or("circle-check",BS);const jS=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],lm=or("clipboard-list",jS);const US=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Hc=or("download",US);const PS=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],zS=or("eye-off",PS);const HS=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],$S=or("eye",HS);const VS=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],GS=or("file-down",VS);const qS=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],Ly=or("file-spreadsheet",qS);const XS=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],WS=or("layout-dashboard",XS);const KS=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],YS=or("menu",KS);const JS=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],ku=or("package",JS);const QS=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],ZS=or("pen",QS);const eE=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],tE=or("pencil",eE);const rE=[["path",{d:"m10.5 20.5 10-10a4.95 4.95 0 1 0-7-7l-10 10a4.95 4.95 0 1 0 7 7Z",key:"wa1lgi"}],["path",{d:"m8.5 8.5 7 7",key:"rvfmvr"}]],Iy=or("pill",rE);const aE=[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]],qi=or("refresh-ccw",aE);const nE=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],sE=or("save",nE);const iE=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],om=or("search",iE);const lE=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],oE=or("tag",lE);const cE=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],to=or("trash-2",cE);const uE=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],fE=or("trending-down",uE);const hE=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],si=or("triangle-alert",hE);const dE=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],io=or("upload",dE);const mE=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],cm=or("x",mE);function gE({editingMed:e,onClose:t,onSubmit:r}){return w.jsx("div",{className:"fixed inset-0 bg-slate-900/60 backdrop-blur-sm flex items-center justify-center z-50 p-4 font-sans",children:w.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-lg overflow-hidden",children:[w.jsxs("div",{className:"p-6 border-b border-slate-100 flex justify-between items-center bg-slate-50",children:[w.jsx("h3",{className:"text-lg font-bold text-slate-800",children:e?"Editar Medicamento":"Nuevo Medicamento"}),w.jsx("button",{type:"button",onClick:t,className:"text-slate-400 hover:text-slate-600 transition-colors",children:w.jsx(cm,{size:24})})]}),w.jsxs("form",{onSubmit:r,className:"p-6 grid grid-cols-2 gap-4",children:[w.jsxs("div",{className:"col-span-2",children:[w.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase mb-1",children:"Nombre Comercial"}),w.jsx("input",{required:!0,name:"name",defaultValue:e?.name,className:"w-full border p-2.5 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm transition-all",placeholder:"Ej. Amoxicilina 500mg"})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase mb-1",children:"Categora"}),w.jsxs("select",{name:"category",defaultValue:e?.category,className:"w-full border p-2.5 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm bg-white",children:[w.jsx("option",{children:"Analgsico"}),w.jsx("option",{children:"Antibitico"}),w.jsx("option",{children:"Antiinflamatorio"}),w.jsx("option",{children:"Insumo Mdico"}),w.jsx("option",{children:"Protector Gstrico"})]})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase mb-1",children:"Unidad"}),w.jsx("input",{name:"unit",defaultValue:e?.unit||"Tabletas",className:"w-full border p-2.5 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm",placeholder:"Cajas, Tabletas..."})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase mb-1",children:"Lote"}),w.jsx("input",{name:"batch",defaultValue:e?.batch,className:"w-full border p-2.5 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm font-mono",placeholder:"LOT-000"})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase mb-1",children:"Vencimiento"}),w.jsx("input",{type:"date",name:"expiry_date",defaultValue:e?.expiry_date,className:"w-full border p-2.5 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm font-mono"})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase mb-1",children:"Stock Inicial"}),w.jsx("input",{type:"number",name:"stock",defaultValue:e?.stock||0,className:"w-full border p-2.5 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm font-mono"})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase mb-1",children:"Stock Mnimo"}),w.jsx("input",{type:"number",name:"min_stock",defaultValue:e?.min_stock||10,className:"w-full border p-2.5 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm font-mono"})]}),w.jsxs("div",{className:"col-span-2 pt-4 flex space-x-3",children:[w.jsx("button",{type:"button",onClick:t,className:"flex-1 border border-slate-200 py-3 rounded-xl hover:bg-slate-50 font-semibold transition-colors text-sm",children:"Cancelar"}),w.jsx("button",{type:"submit",className:"flex-1 bg-blue-600 text-white py-3 rounded-xl hover:bg-blue-700 font-semibold shadow-lg shadow-blue-200 transition-all text-sm",children:e?"Guardar Cambios":"Registrar"})]})]})]})})}function pE({activeTab:e}){const t=e==="dashboard"?"Resumen General":e==="inventory"?"Gestin de Inventario":e==="catalog"?"Catlogo de Productos":e==="consumption-monthly"?"Consumo Mensual":e==="consumption-summary"?"Resumen de Consumo":e==="order-request"?"Solicitud Pedido":e==="calendar"?"Calendario":e==="tertiary-packaging"?"Empaque Terciario":e==="categories"?"Categoras":"Alertas de Stock";return w.jsx("header",{className:"flex justify-between items-center mb-8",children:w.jsxs("div",{children:[w.jsx("h2",{className:"text-2xl font-bold text-slate-800 capitalize",children:t}),w.jsx("p",{className:"text-slate-500",children:"Sistema central de suministros mdicos."})]})})}function Ln({id:e,icon:t,label:r,activeTab:a,isSidebarOpen:s,onSelect:l}){return w.jsxs("button",{onClick:()=>l(e),className:`w-full flex items-center space-x-3 p-3 rounded-lg transition-colors ${a===e?"bg-blue-600 text-white shadow-md":"text-slate-600 hover:bg-blue-50"}`,children:[w.jsx(t,{size:20}),s&&w.jsx("span",{className:"font-medium",children:r})]})}function xE({activeTab:e,isSidebarOpen:t,onSelectTab:r,onToggleSidebar:a}){return w.jsxs("aside",{className:`bg-white border-r border-slate-200 transition-all duration-300 flex flex-col ${t?"w-64":"w-20"}`,children:[w.jsxs("div",{className:"p-6 flex items-center space-x-3 border-b border-slate-100",children:[w.jsx("div",{className:"bg-blue-600 p-2 rounded-lg text-white",children:w.jsx(ku,{size:24})}),t&&w.jsxs("h1",{className:"text-xl font-bold tracking-tight text-blue-900 leading-none",children:["BODEGA",w.jsx("br",{}),w.jsx("span",{className:"text-sm font-normal text-slate-500 tracking-normal",children:"PharmaStock v1.1"})]})]}),w.jsxs("nav",{className:"flex-1 p-4 space-y-2 mt-4",children:[w.jsx(Ln,{id:"dashboard",icon:WS,label:"Panel de Control",activeTab:e,isSidebarOpen:t,onSelect:r}),w.jsx(Ln,{id:"inventory",icon:Iy,label:"Inventario",activeTab:e,isSidebarOpen:t,onSelect:r}),w.jsx(Ln,{id:"catalog",icon:Ly,label:"Catlogo",activeTab:e,isSidebarOpen:t,onSelect:r}),w.jsx(Ln,{id:"consumption-monthly",icon:io,label:"Consumo mensual",activeTab:e,isSidebarOpen:t,onSelect:r}),w.jsx(Ln,{id:"consumption-summary",icon:My,label:"Resumen consumo",activeTab:e,isSidebarOpen:t,onSelect:r}),w.jsx(Ln,{id:"order-request",icon:lm,label:"Solicitud Pedido",activeTab:e,isSidebarOpen:t,onSelect:r}),w.jsx(Ln,{id:"calendar",icon:FS,label:"Calendario",activeTab:e,isSidebarOpen:t,onSelect:r}),w.jsx(Ln,{id:"tertiary-packaging",icon:ku,label:"Empaque Terciario",activeTab:e,isSidebarOpen:t,onSelect:r}),w.jsx(Ln,{id:"categories",icon:oE,label:"Categoras",activeTab:e,isSidebarOpen:t,onSelect:r}),w.jsx(Ln,{id:"alerts",icon:si,label:"Alertas de Stock",activeTab:e,isSidebarOpen:t,onSelect:r})]}),w.jsx("div",{className:"p-4 border-t border-slate-100",children:w.jsx("button",{onClick:a,className:"p-2 hover:bg-slate-100 rounded-lg text-slate-400 w-full flex justify-center",children:t?w.jsx(cm,{size:20}):w.jsx(YS,{size:20})})})]})}function vE({lowStockItems:e,onEditMedication:t}){return w.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.map(r=>w.jsxs("div",{className:"bg-white p-6 rounded-xl border-l-4 border-red-500 shadow-sm flex flex-col justify-between",children:[w.jsxs("div",{children:[w.jsxs("div",{className:"flex justify-between items-start mb-4",children:[w.jsx("h3",{className:"text-lg font-bold text-slate-800",children:r.name}),w.jsx("div",{className:"bg-red-100 p-2 rounded-full text-red-600",children:w.jsx(si,{size:20})})]}),w.jsxs("div",{className:"space-y-2 mb-6 text-sm text-slate-600",children:[w.jsxs("p",{className:"flex justify-between",children:[w.jsx("span",{children:"Categora:"})," ",w.jsx("span",{className:"font-semibold",children:r.category})]}),w.jsxs("p",{className:"flex justify-between",children:[w.jsx("span",{children:"Stock Mnimo:"})," ",w.jsx("span",{className:"font-semibold",children:r.min_stock})]}),w.jsxs("p",{className:"flex justify-between",children:[w.jsx("span",{children:"Stock Actual:"})," ",w.jsx("span",{className:"font-bold text-red-600 text-base",children:r.stock})]})]})]}),w.jsx("button",{type:"button",onClick:()=>t(r),className:"w-full bg-blue-600 hover:bg-blue-700 text-white py-2 rounded-lg font-medium transition-colors",children:"Generar Orden de Compra"})]},r.id)),e.length===0&&w.jsxs("div",{className:"col-span-full py-20 text-center bg-white border border-dashed border-slate-300 rounded-2xl",children:[w.jsx("div",{className:"bg-green-100 text-green-600 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4",children:w.jsx(ku,{size:32})}),w.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"Todo en Orden!"}),w.jsx("p",{className:"text-slate-500 max-w-sm mx-auto",children:"No hay medicamentos que requieran atencin inmediata por falta de inventario."})]})]})}function yE({medications:e,excelStatus:t,fileInputRef:r,onChooseFile:a,onDownloadTemplate:s,onFileChange:l,onEditMedication:c,onDeleteMedication:u,onClearCatalog:h}){const d=x=>{const v=String(x??"").trim();return v.length<=50?{display:v,full:v}:{display:`${v.slice(0,50)}`,full:v}},g=ze.useMemo(()=>{const x=_=>{const b=String(_||"").replace(/\D/g,"");return b.length<4?Number.POSITIVE_INFINITY:Number.parseInt(b.slice(-4),10)},v=_=>String(_||"").trim().startsWith("1-10");return[...e||[]].sort((_,b)=>{const y=_?.siges_code||"",S=b?.siges_code||"",k=v(y),O=v(S);if(k!==O)return k?-1:1;const T=x(y),j=x(S);return T!==j?T-j:String(y).localeCompare(String(S),"es",{numeric:!0,sensitivity:"base"})})},[e]);return w.jsx("div",{className:"space-y-6",children:w.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[w.jsxs("div",{className:"lg:col-span-1 bg-white p-6 rounded-2xl border border-slate-200 shadow-sm",children:[w.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[w.jsx("div",{className:"bg-green-100 text-green-600 p-2 rounded-lg",children:w.jsx(io,{size:20})}),w.jsx("h3",{className:"font-bold text-slate-800",children:"Importar CSV"})]}),w.jsxs("p",{className:"text-sm text-slate-500 mb-6 leading-relaxed",children:["Cargue su catlogo masivamente. El archivo debe contener las columnas: ",w.jsx("br",{}),w.jsx("code",{className:"bg-slate-100 px-1 rounded text-blue-600 font-mono text-xs",children:"CodigoSIGES, ClasificadorSICOP, IdentificadorSICOP, Medicamento, Categoria, Lote, Vencimiento, Stock, StockMinimo, Unidad"})]}),w.jsx("input",{type:"file",ref:r,onChange:l,accept:".csv",className:"hidden"}),w.jsxs("button",{type:"button",onClick:a,className:"w-full flex flex-col items-center justify-center border-2 border-dashed border-slate-300 rounded-xl py-10 hover:border-blue-400 hover:bg-blue-50 transition-all group",children:[w.jsx(Ly,{size:40,className:"text-slate-300 group-hover:text-blue-500 mb-2 transition-colors"}),w.jsx("span",{className:"text-sm font-semibold text-slate-600 group-hover:text-blue-700",children:"Seleccionar archivo CSV"}),w.jsx("span",{className:"text-xs text-slate-400 mt-1",children:"Soporta .csv"})]}),t.message&&w.jsxs("div",{className:`mt-4 p-3 rounded-lg text-xs flex items-center space-x-2 ${t.type==="success"?"bg-green-50 text-green-700 border border-green-100":t.type==="error"?"bg-red-50 text-red-700 border border-red-100":"bg-blue-50 text-blue-700 border border-blue-100"}`,children:[t.type==="success"?w.jsx(zc,{size:16}):w.jsx(si,{size:16}),w.jsx("span",{children:t.message})]})]}),w.jsxs("div",{className:"lg:col-span-2 bg-white rounded-2xl border border-slate-200 shadow-sm overflow-hidden",children:[w.jsxs("div",{className:"p-4 border-b border-slate-100 bg-slate-50 flex justify-between items-center",children:[w.jsx("h3",{className:"font-bold text-slate-800",children:"Vista Previa del Catlogo"}),w.jsxs("div",{className:"flex items-center gap-3",children:[w.jsxs("button",{type:"button",onClick:()=>{!e?.length||!window.confirm("Desea eliminar todo el catlogo? Esta accin no se puede deshacer.")||h?.()},disabled:!e?.length,className:"text-xs text-red-600 font-bold flex items-center space-x-1 hover:underline disabled:opacity-40 disabled:hover:no-underline",children:[w.jsx(to,{size:14}),w.jsx("span",{children:"Eliminar Catlogo"})]}),w.jsxs("button",{type:"button",onClick:s,className:"text-xs text-blue-600 font-bold flex items-center space-x-1 hover:underline",children:[w.jsx(Hc,{size:14}),w.jsx("span",{children:"Descargar Plantilla"})]})]})]}),w.jsx("div",{className:"max-h-[400px] overflow-y-auto",children:w.jsxs("table",{className:"w-full text-left",children:[w.jsx("thead",{className:"sticky top-0 bg-white shadow-sm text-slate-500 text-[10px] uppercase font-bold",children:w.jsxs("tr",{children:[w.jsx("th",{className:"px-6 py-3",children:"Cdigo SIGES"}),w.jsx("th",{className:"px-6 py-3",children:"Clasificador SICOP"}),w.jsx("th",{className:"px-6 py-3",children:"Identificador SICOP"}),w.jsx("th",{className:"px-6 py-3",children:"Medicamento"}),w.jsx("th",{className:"px-6 py-3 text-center",children:"Acciones"})]})}),w.jsx("tbody",{className:"divide-y divide-slate-100",children:g.map(x=>w.jsxs("tr",{className:"hover:bg-slate-50 transition-colors group",children:[w.jsx("td",{className:"px-6 py-3 text-sm text-slate-700 font-mono",children:x.siges_code||""}),w.jsx("td",{className:"px-6 py-3 text-sm text-slate-700 font-mono",children:x.sicop_classifier||""}),w.jsx("td",{className:"px-6 py-3 text-sm text-slate-700 font-mono",children:x.sicop_identifier||""}),w.jsx("td",{className:"px-6 py-3 text-sm font-medium text-slate-700",title:d(x.name).full,children:d(x.name).display}),w.jsx("td",{className:"px-6 py-3",children:w.jsxs("div",{className:"flex justify-center space-x-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[w.jsx("button",{type:"button",onClick:()=>c?.(x),className:"p-1.5 text-slate-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg","aria-label":"Editar",title:"Editar",children:w.jsx(ZS,{size:14})}),w.jsx("button",{type:"button",onClick:()=>u?.(x.id),className:"p-1.5 text-slate-400 hover:text-red-600 hover:bg-red-50 rounded-lg","aria-label":"Eliminar",title:"Eliminar",children:w.jsx(to,{size:14})})]})})]},x.id))})]})})]})]})})}function Bd(e){const t=typeof e=="number"?e:Number(String(e??"").replace(/,/g,""));return Number.isFinite(t)?t:0}function Fl(e){const t=Bd(e);return new Intl.NumberFormat("es-CR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(t)}function By(e){return e.length?e.reduce((t,r)=>t+r,0)/e.length:0}function _E(e){if(e.length<=1)return 0;const t=By(e),r=e.reduce((a,s)=>a+(s-t)**2,0)/e.length;return Math.sqrt(r)}function wE({siges_code:e,medication_name:t}){const r=String(e??"").trim();if(r)return`code:${r}`;const a=String(t??"").trim().toLowerCase();return a?`name:${a}`:""}function Gx(e){const t=String(e||"").replace(/\D/g,"");return t.length<4?Number.POSITIVE_INFINITY:Number.parseInt(t.slice(-4),10)}function qx(e){return String(e||"").trim().startsWith("110")}function bE({status:e}){if(!e?.message)return null;const t=e.type==="success"?"bg-emerald-50 border-emerald-200 text-emerald-800":e.type==="error"?"bg-rose-50 border-rose-200 text-rose-800":"bg-blue-50 border-blue-200 text-blue-800";return w.jsx("div",{className:`border rounded-lg px-4 py-3 text-sm ${t}`,children:w.jsx("span",{children:e.message})})}function SE({months:e,onRefresh:t,status:r}){const a=(e??[]).slice(0,3),s=a.map(I=>String(I?.label??"").trim()).filter(Boolean),[l,c]=ze.useState(""),[u,h]=ze.useState(!0),[d,g]=ze.useState(50),[x,v]=ze.useState(1),_=ze.useMemo(()=>{const I=new Map;return a.forEach((C,K)=>{const q=C?.items??[];for(const oe of q){const ee=String(oe?.siges_code??"").trim(),Z=String(oe?.medication_name??"").trim(),xe=wE({siges_code:ee,medication_name:Z});if(!xe)continue;const Ce=I.get(xe)??{siges_code:ee,medication_name:Z,perMonth:[0,0,0]};Ce.siges_code=Ce.siges_code||ee,Ce.medication_name=Ce.medication_name||Z,Ce.perMonth[K]+=Bd(oe?.quantity),I.set(xe,Ce)}}),Array.from(I.values()).map(C=>{const K=C.perMonth.slice(0,3),q=By(K),oe=_E(K);return{...C,avg:q,sd:oe,total:q+oe}})},[a]),b=ze.useMemo(()=>{const I=l.trim().toLowerCase(),C=u?_.filter(q=>Bd(q.total)>0):_;return(I?C.filter(q=>`${q.siges_code} ${q.medication_name}`.toLowerCase().includes(I)):C).sort((q,oe)=>{const ee=q?.siges_code||"",Z=oe?.siges_code||"",xe=qx(ee),Ce=qx(Z);if(xe!==Ce)return xe?-1:1;const Se=Gx(ee),G=Gx(Z);return Se!==G?Se-G:String(ee).localeCompare(String(Z),"es",{numeric:!0,sensitivity:"base"})})},[u,_,l]),y=b.length,S=Math.max(1,Number(d)||50),k=Math.max(1,Math.ceil(y/S)),O=Math.min(Math.max(x,1),k),T=ze.useMemo(()=>{const I=(O-1)*S;return b.slice(I,I+S)},[b,O,S]),j=y===0?0:(O-1)*S+1,X=Math.min(O*S,y);return w.jsxs("div",{className:"space-y-6",children:[w.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-5",children:[w.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[w.jsxs("div",{className:"space-y-1",children:[w.jsx("h3",{className:"font-semibold text-slate-800",children:"Resumen de consumo"}),w.jsx("p",{className:"text-xs text-slate-500",children:"Muestra por medicamento: cdigo, consumos de los ltimos 3 meses, promedio, desviacin estndar y total (promedio + desviacin)."})]}),w.jsx("div",{className:"flex flex-wrap items-center gap-2",children:w.jsxs("button",{type:"button",onClick:t,className:"px-3 py-2 rounded-lg border border-slate-200 text-slate-700 hover:bg-slate-50 text-sm flex items-center gap-2",children:[w.jsx(qi,{size:16}),"Sincronizar"]})})]}),w.jsx("div",{className:"mt-4",children:w.jsx(bE,{status:r})})]}),w.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm overflow-hidden",children:[w.jsxs("div",{className:"p-4 border-b border-slate-100 bg-slate-50 flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("div",{className:"bg-blue-50 text-blue-600 p-2 rounded-lg",children:w.jsx(My,{size:18})}),w.jsx("h3",{className:"font-bold text-slate-800",children:"Consumo por medicamento (ltimos 3 meses)"})]}),w.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[w.jsx("button",{type:"button",onClick:()=>{h(I=>!I),v(1)},className:"px-3 py-2 rounded-lg border border-slate-200 text-slate-700 hover:bg-slate-50 text-sm",title:"Oculta medicamentos con consumo 0 en los ltimos 3 meses",children:u?"Mostrar sin consumo":"Ocultar sin consumo"}),w.jsx("input",{value:l,onChange:I=>{c(I.target.value),v(1)},placeholder:"Buscar por cdigo o medicamento...",className:"w-72 border border-slate-200 rounded-lg px-3 py-2 text-sm bg-white"})]})]}),a.length===0?w.jsx("div",{className:"p-8 text-center text-slate-500 text-sm",children:"No hay consumos cargados."}):w.jsxs(w.Fragment,{children:[w.jsx("div",{className:"overflow-x-auto",children:w.jsxs("table",{className:"w-full min-w-[1100px] text-left",children:[w.jsx("thead",{className:"sticky top-0 z-10 bg-slate-50 text-slate-500 text-[10px] uppercase font-bold shadow-sm",children:w.jsxs("tr",{children:[w.jsx("th",{className:"px-4 py-4 whitespace-nowrap w-36 text-center",children:"Cdigo SIGES"}),w.jsx("th",{className:"px-4 py-4 whitespace-nowrap text-center",children:"Medicamento"}),w.jsx("th",{className:"px-3 py-4 text-center whitespace-nowrap w-32",children:s[2]??"Mes 3"}),w.jsx("th",{className:"px-3 py-4 text-center whitespace-nowrap w-32",children:s[1]??"Mes 2"}),w.jsx("th",{className:"px-3 py-4 text-center whitespace-nowrap w-32",children:s[0]??"Mes 1"}),w.jsx("th",{className:"px-3 py-4 text-center whitespace-nowrap w-28",children:"Promedio"}),w.jsx("th",{className:"px-3 py-4 text-center whitespace-nowrap w-28",children:"Desv. Est."}),w.jsx("th",{className:"px-3 py-4 text-center whitespace-nowrap w-36",children:"Total (Prom.+Desv.)"})]})}),w.jsxs("tbody",{className:"divide-y divide-slate-100",children:[T.map((I,C)=>w.jsxs("tr",{className:"hover:bg-slate-50",children:[w.jsx("td",{className:"px-4 py-4 text-xs text-slate-600 font-mono whitespace-nowrap text-center",children:I.siges_code||""}),w.jsx("td",{className:"px-4 py-4 text-sm font-medium text-slate-700 whitespace-normal break-words",children:I.medication_name}),w.jsx("td",{className:"px-3 py-4 text-center font-mono text-sm tabular-nums",children:Fl(I.perMonth[2]??0)}),w.jsx("td",{className:"px-3 py-4 text-center font-mono text-sm tabular-nums",children:Fl(I.perMonth[1]??0)}),w.jsx("td",{className:"px-3 py-4 text-center font-mono text-sm tabular-nums",children:Fl(I.perMonth[0]??0)}),w.jsx("td",{className:"px-3 py-4 text-center font-mono text-sm tabular-nums",children:Fl(I.avg)}),w.jsx("td",{className:"px-3 py-4 text-center font-mono text-sm tabular-nums",children:Fl(I.sd)}),w.jsx("td",{className:"px-3 py-4 text-center font-mono text-sm font-bold text-blue-700 tabular-nums",children:Fl(I.total)})]},`${I.siges_code||I.medication_name}-${C}`)),T.length===0&&w.jsx("tr",{children:w.jsx("td",{colSpan:8,className:"px-6 py-10 text-center text-sm text-slate-400",children:"No hay resultados."})})]})]})}),w.jsxs("div",{className:"p-4 border-t border-slate-100 bg-slate-50 flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[w.jsx("div",{className:"text-xs text-slate-500",children:y===0?"0 resultados":`Mostrando ${j}-${X} de ${y}`}),w.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[w.jsx("label",{className:"text-xs text-slate-500",children:"Filas"}),w.jsx("select",{value:S,onChange:I=>{g(Number(I.target.value)||50),v(1)},className:"border border-slate-200 rounded-lg px-2 py-1 text-xs bg-white",children:[25,50,100,200].map(I=>w.jsx("option",{value:I,children:I},I))}),w.jsx("button",{type:"button",onClick:()=>v(I=>Math.max(1,I-1)),disabled:O<=1,className:"px-3 py-1.5 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 disabled:opacity-40 disabled:hover:bg-white",children:"Anterior"}),w.jsxs("span",{className:"text-xs text-slate-600",children:["Pgina ",O," de ",k]}),w.jsx("button",{type:"button",onClick:()=>v(I=>Math.min(k,I+1)),disabled:O>=k,className:"px-3 py-1.5 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 disabled:opacity-40 disabled:hover:bg-white",children:"Siguiente"})]})]})]})]})]})}function ou({title:e,value:t,icon:r,color:a}){const s={blue:"bg-blue-50 text-blue-600 border-blue-100",red:"bg-red-50 text-red-600 border-red-100",green:"bg-green-50 text-green-600 border-green-100",purple:"bg-purple-50 text-purple-600 border-purple-100"},l=typeof t=="number"?new Intl.NumberFormat("en-US",{minimumFractionDigits:0,maximumFractionDigits:e==="Total Unidades"?2:0}).format(t):t;return w.jsxs("div",{className:"p-6 rounded-2xl border bg-white shadow-sm flex items-center space-x-4",children:[w.jsx("div",{className:`p-4 rounded-xl ${s[a]||s.blue}`,children:w.jsx(r,{size:24})}),w.jsxs("div",{children:[w.jsx("p",{className:"text-sm font-medium text-slate-500",children:e}),w.jsx("p",{className:"text-2xl font-bold text-slate-800",children:l})]})]})}function EE({stats:e,consumptions:t,lowStockItems:r,onViewAllConsumptions:a,onEditMedication:s}){return w.jsxs("div",{className:"space-y-8",children:[w.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[w.jsx(ou,{title:"Total Medicamentos",value:e.totalItems,icon:Iy,color:"blue"}),w.jsx(ou,{title:"Stock Crtico",value:e.lowStockCount,icon:si,color:"red"}),w.jsx(ou,{title:"Total Unidades",value:e.totalStockValue,icon:ku,color:"green"}),w.jsx(ou,{title:"Consumos Recientes",value:e.recentConsumptions,icon:lm,color:"purple"})]}),w.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[w.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[w.jsxs("div",{className:"flex justify-between items-center mb-4",children:[w.jsx("h3",{className:"font-bold text-slate-800",children:"ltimos Consumos"}),w.jsxs("button",{type:"button",onClick:a,className:"text-blue-600 text-sm flex items-center hover:underline",children:["Ver todo ",w.jsx(IS,{size:14})]})]}),w.jsx("div",{className:"space-y-4",children:t.slice(0,5).map(l=>w.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-lg",children:[w.jsxs("div",{className:"flex items-center space-x-3",children:[w.jsx("div",{className:"bg-white p-2 rounded-md shadow-sm border border-slate-100 text-slate-400",children:w.jsx(fE,{size:16})}),w.jsxs("div",{children:[w.jsx("p",{className:"font-semibold text-sm",children:l.medication_name}),w.jsx("p",{className:"text-xs text-slate-500",children:l.siges_code||l.date||""})]})]}),w.jsxs("div",{className:"text-right",children:[w.jsx("p",{className:"text-sm font-bold text-slate-800",children:l.quantity}),w.jsx("p",{className:"text-xs text-slate-500 font-mono",children:l.cost??l.user??""})]})]},l.id))})]}),w.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[w.jsxs("div",{className:"flex justify-between items-center mb-4",children:[w.jsx("h3",{className:"font-bold text-slate-800",children:"Medicamentos Agotndose"}),w.jsxs("span",{className:"bg-red-100 text-red-700 text-xs px-2 py-1 rounded-full font-bold",children:[r.length," Alertas"]})]}),w.jsx("div",{className:"space-y-4",children:r.length>0?r.map(l=>w.jsxs("div",{className:"flex items-center justify-between p-3 border-l-4 border-red-500 bg-red-50 rounded-r-lg",children:[w.jsxs("div",{children:[w.jsx("p",{className:"font-semibold text-sm text-slate-800",children:l.name}),w.jsxs("p",{className:"text-xs text-slate-500",children:["Mnimo: ",l.min_stock," | Actual: ",l.stock]})]}),w.jsx("button",{type:"button",onClick:()=>s(l),className:"text-xs bg-white border border-red-200 text-red-600 px-3 py-1 rounded hover:bg-red-100 transition-colors",children:"Reponer"})]},l.id)):w.jsx("div",{className:"text-center py-8",children:w.jsx("p",{className:"text-slate-400 text-sm italic",children:"No hay alertas activas de inventario."})})})]})]})]})}function TE({inventoryType:e,onInventoryTypeChange:t,inventoryStatus:r,fileInputRef:a,onChooseFile:s,onFileChange:l,onDownloadTemplate:c,onRefresh:u,canClear:h,onClearInventory:d,hideNoMovement:g,canToggleHideNoMovement:x,onToggleHideNoMovement:v,search:_,onSearchChange:b,items:y,totalItems:S,page:k,pageSize:O,onPageChange:T,onPageSizeChange:j}){const X=String(e||"772"),I=X==="771",C=X==="total",K=C?"w-[260px] max-w-[260px]":"max-w-[620px]",q=pe=>{const J=Number(pe);return Number.isFinite(J)?J.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):String(pe??"0")},oe=pe=>{const J=String(pe??"").trim();if(!J)return"S/N";const be=J.match(/^(\d{4})-(\d{2})-(\d{2})/);if(be)return`${be[3]}/${be[2]}/${be[1]}`;const L=new Date(J);if(!Number.isNaN(L.getTime())){const N=String(L.getDate()).padStart(2,"0"),V=String(L.getMonth()+1).padStart(2,"0"),M=String(L.getFullYear());return`${N}/${V}/${M}`}return J},ee=pe=>{if(!pe)return"";const J=String(pe.batch||"").trim()||"S/N",be=oe(pe.expiry_date),L=q(pe.stock);return`${J} (${be}): ${L}`},Z=Number(S)||0,xe=Number(O)||50,Ce=Math.max(1,Math.ceil(Z/xe)),Se=Math.min(Math.max(Number(k)||1,1),Ce),G=Z===0?0:(Se-1)*xe+1,ne=Math.min(Se*xe,Z);return w.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden",children:[w.jsxs("div",{className:"p-4 border-b border-slate-100 bg-slate-50 flex flex-col gap-3",children:[w.jsxs("div",{className:"flex flex-wrap gap-3 items-center justify-between",children:[w.jsx("div",{className:"flex items-center gap-2",children:[{key:"772",label:"Inventario 772"},{key:"771",label:"Inventario 771"},{key:"total",label:"Inventario total"}].map(pe=>w.jsx("button",{type:"button",onClick:()=>t?.(pe.key),className:`px-3 py-1.5 rounded-lg text-xs font-bold border transition-colors ${X===pe.key?"bg-blue-600 text-white border-blue-600":"bg-white text-slate-600 border-slate-200 hover:bg-blue-50 hover:text-blue-700"}`,children:pe.label},pe.key))}),w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsxs("button",{type:"button",onClick:u,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 flex items-center gap-2",title:"Sincronizar inventarios",children:[w.jsx(qi,{size:14}),"Sincronizar"]}),C&&w.jsxs("button",{type:"button",onClick:()=>v?.(),disabled:!x,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 flex items-center gap-2 disabled:opacity-40 disabled:hover:bg-white",title:x?"Oculta medicamentos sin consumo en los ltimos 4 meses.":"No hay consumos cargados para filtrar.",children:[g?w.jsx($S,{size:14}):w.jsx(zS,{size:14}),g?"Mostrar sin movimiento":"Ocultar sin movimiento (4 meses)"]}),!C&&w.jsxs(w.Fragment,{children:[w.jsx("input",{type:"file",ref:a,onChange:l,accept:I?".xml":".csv",className:"hidden"}),w.jsxs("button",{type:"button",onClick:s,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-blue-50 hover:text-blue-700 flex items-center gap-2",children:[w.jsx(io,{size:14}),I?"Cargar XML":"Cargar CSV"]}),w.jsxs("button",{type:"button",onClick:()=>c?.(e),className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 flex items-center gap-2",children:[w.jsx(Hc,{size:14}),"Plantilla"]}),w.jsxs("button",{type:"button",onClick:()=>d?.(e),disabled:!h,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-red-200 text-red-600 hover:bg-red-50 flex items-center gap-2 disabled:opacity-40 disabled:hover:bg-white",title:"Eliminar toda la carga de este inventario",children:[w.jsx(to,{size:14}),"Eliminar carga"]})]})]})]}),r?.message&&w.jsxs("div",{className:`p-3 rounded-lg text-xs flex items-center gap-2 ${r.type==="success"?"bg-green-50 text-green-700 border border-green-100":r.type==="error"?"bg-red-50 text-red-700 border border-red-100":"bg-blue-50 text-blue-700 border border-blue-100"}`,children:[r.type==="success"?w.jsx(zc,{size:16}):w.jsx(si,{size:16}),w.jsx("span",{children:r.message})]}),w.jsxs("div",{className:"relative w-72",children:[w.jsx(om,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:18}),w.jsx("input",{type:"text",value:_,onChange:pe=>b(pe.target.value),placeholder:"Buscar medicamento...",className:"w-full pl-10 pr-4 py-2 border border-slate-200 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 outline-none"})]})]}),w.jsx("div",{className:"overflow-x-auto",children:w.jsxs("table",{className:"min-w-max w-full text-left",children:[w.jsx("thead",{className:"bg-slate-50 text-slate-500 text-[10px] uppercase font-bold",children:w.jsxs("tr",{children:[w.jsx("th",{className:"px-6 py-4 text-center whitespace-nowrap",children:"Cdigo SIGES"}),w.jsx("th",{className:`px-6 py-4 whitespace-nowrap ${K}`,children:"Medicamento"}),C&&w.jsx("th",{className:"px-6 py-4 text-center whitespace-nowrap",children:"Inv. 772"}),(I||C)&&w.jsx("th",{className:"px-6 py-4 whitespace-nowrap",children:"Lotes 771 (venc. / cant.)"}),C&&w.jsx("th",{className:"px-6 py-4 text-center whitespace-nowrap",children:"Inv. 771"}),w.jsx("th",{className:"px-6 py-4 text-center whitespace-nowrap",children:C?"Inventario total":"Inventario"})]})}),w.jsxs("tbody",{className:"divide-y divide-slate-100",children:[y.map(pe=>w.jsxs("tr",{className:"hover:bg-slate-50 transition-colors group text-sm",children:[w.jsx("td",{className:"px-6 py-4 text-slate-700 font-mono text-center whitespace-nowrap",children:pe.siges_code||""}),w.jsx("td",{className:`px-6 py-4 ${K} text-slate-700`,children:w.jsx("span",{className:"block truncate",children:pe.name})}),C&&w.jsx("td",{className:"px-6 py-4 text-center whitespace-nowrap text-slate-700 font-mono",children:q(pe.stock772)}),(I||C)&&w.jsx("td",{className:`px-6 py-4 text-slate-600 font-mono ${C?"text-center":""}`,children:w.jsx("div",{className:`flex flex-col gap-1 ${C?"items-center":""}`,children:Array.isArray(pe.lots)&&pe.lots.length>0?pe.lots.map(J=>w.jsx("div",{className:"whitespace-nowrap",children:ee(J)},J.id||`${J.batch}-${J.expiry_date}`)):w.jsx("div",{className:"whitespace-nowrap",children:C?"":ee(pe)})})}),C&&w.jsx("td",{className:"px-6 py-4 text-center whitespace-nowrap text-slate-700 font-mono",children:q(pe.stock771)}),w.jsx("td",{className:"px-6 py-4 text-center whitespace-nowrap text-slate-800",children:w.jsx("span",{className:"font-bold",children:q(pe.stock)})})]},pe.id)),y.length===0&&w.jsx("tr",{children:w.jsxs("td",{colSpan:C?6:I?4:3,className:"px-6 py-10 text-center text-sm text-slate-400",children:['No hay resultados para "',_,'".']})})]})]})}),w.jsxs("div",{className:"p-4 border-t border-slate-100 bg-slate-50 flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[w.jsx("div",{className:"text-xs text-slate-500",children:Z===0?"0 resultados":`Mostrando ${G}-${ne} de ${Z}`}),w.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[w.jsx("label",{className:"text-xs text-slate-500",children:"Filas"}),w.jsx("select",{value:xe,onChange:pe=>j?.(Number(pe.target.value)||50),className:"border border-slate-200 rounded-lg px-2 py-1 text-xs bg-white",children:[25,50,100,200].map(pe=>w.jsx("option",{value:pe,children:pe},pe))}),w.jsx("button",{type:"button",onClick:()=>T?.(Se-1),disabled:Se<=1,className:"px-3 py-1.5 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 disabled:opacity-40 disabled:hover:bg-white",children:"Anterior"}),w.jsxs("span",{className:"text-xs text-slate-600",children:["Pgina ",Se," de ",Ce]}),w.jsx("button",{type:"button",onClick:()=>T?.(Se+1),disabled:Se>=Ce,className:"px-3 py-1.5 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 disabled:opacity-40 disabled:hover:bg-white",children:"Siguiente"})]})]})]})}function kE({status:e}){if(!e?.message)return null;const t=e.type==="success"?"bg-emerald-50 border-emerald-200 text-emerald-800":e.type==="error"?"bg-rose-50 border-rose-200 text-rose-800":"bg-blue-50 border-blue-200 text-blue-800";return w.jsx("div",{className:`border rounded-lg px-4 py-3 text-sm ${t}`,children:w.jsx("span",{children:e.message})})}function AE({months:e,selectedMonthId:t,onSelectMonth:r,monthlyStatus:a,fileInputRef:s,onChooseFile:l,onFileChange:c,onDownloadTemplate:u,onRefresh:h}){const d=e.find(v=>v.id===t)||null,g=v=>{const _=typeof v=="number"?v:Number(v);return Number.isFinite(_)?new Intl.NumberFormat("es-CR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(_):""},x=v=>{const _=typeof v=="number"?v:Number(v);return Number.isFinite(_)?new Intl.NumberFormat("es-CR",{style:"currency",currency:"CRC",minimumFractionDigits:2,maximumFractionDigits:2}).format(_):""};return w.jsxs("div",{className:"space-y-4",children:[w.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-5",children:[w.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[w.jsxs("div",{className:"space-y-1",children:[w.jsx("h3",{className:"font-semibold text-slate-800",children:"Importar consumo mensual"}),w.jsxs("p",{className:"text-xs text-slate-500",children:["Recomendado: nombre del archivo ",w.jsx("span",{className:"font-mono",children:"Enero 2025.csv"})," (se usa como nombre del mes)."]})]}),w.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[w.jsx("input",{type:"file",ref:s,onChange:c,accept:".csv",className:"hidden"}),w.jsxs("button",{type:"button",onClick:u,className:"px-3 py-2 rounded-lg border border-slate-200 text-slate-700 hover:bg-slate-50 text-sm flex items-center gap-2",children:[w.jsx(GS,{size:16}),"Descargar plantilla"]}),w.jsxs("button",{type:"button",onClick:h,className:"px-3 py-2 rounded-lg border border-slate-200 text-slate-700 hover:bg-slate-50 text-sm flex items-center gap-2",children:[w.jsx(qi,{size:16}),"Sincronizar"]}),w.jsxs("button",{type:"button",onClick:l,className:"px-3 py-2 rounded-lg bg-blue-600 hover:bg-blue-700 text-white text-sm flex items-center gap-2",children:[w.jsx(io,{size:16}),"Importar CSV"]})]})]}),w.jsx("div",{className:"mt-4",children:w.jsx(kE,{status:a})}),w.jsxs("div",{className:"mt-4 flex flex-col gap-2 md:flex-row md:items-center",children:[w.jsx("label",{className:"text-xs font-semibold text-slate-600",children:"Mes cargado"}),w.jsxs("select",{className:"border border-slate-200 rounded-lg px-3 py-2 text-sm bg-white",value:t??"",onChange:v=>r(v.target.value||null),children:[w.jsx("option",{value:"",children:"Seleccione un mes..."}),e.map(v=>w.jsx("option",{value:v.id,children:v.label},v.id))]})]})]}),w.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden",children:[w.jsxs("div",{className:"px-6 py-4 border-b border-slate-100 flex items-center justify-between",children:[w.jsx("h4",{className:"font-semibold text-slate-800",children:d?`Detalle: ${d.label}`:"Detalle del mes"}),d&&w.jsxs("span",{className:"text-xs text-slate-500",children:[d.items.length," registros"]})]}),d?d.items.length===0?w.jsx("div",{className:"p-8 text-center text-slate-500 text-sm",children:"No hay consumos en este mes."}):w.jsxs("table",{className:"w-full text-left",children:[w.jsx("thead",{className:"bg-slate-50 text-slate-500 text-[10px] uppercase font-bold",children:w.jsxs("tr",{children:[w.jsx("th",{className:"px-6 py-4 whitespace-nowrap w-32 text-center",children:"Cdigo SIGES"}),w.jsx("th",{className:"px-6 py-4",children:"Medicamento"}),w.jsx("th",{className:"px-6 py-4 text-center whitespace-nowrap",children:"Consumo"}),w.jsx("th",{className:"px-6 py-4 text-center whitespace-nowrap",children:"Costo"})]})}),w.jsx("tbody",{className:"divide-y divide-slate-100",children:d.items.map(v=>w.jsxs("tr",{className:"hover:bg-slate-50",children:[w.jsx("td",{className:"px-6 py-4 text-xs text-slate-500 font-mono whitespace-nowrap w-32 text-center",children:v.siges_code||""}),w.jsx("td",{className:"px-6 py-4 text-sm font-medium",children:v.medication_name}),w.jsx("td",{className:"px-6 py-4 text-center text-slate-800 font-semibold text-sm tabular-nums",children:g(v.quantity)}),w.jsx("td",{className:"px-6 py-4 text-center text-slate-700 text-sm font-mono tabular-nums",children:x(v.cost)})]},v.id))})]}):w.jsx("div",{className:"p-8 text-center text-slate-500 text-sm",children:"Importa un CSV y selecciona un mes para ver el detalle."})]})]})}function Ks(e){const t=typeof e=="number"?e:Number(String(e??"").trim().replace(/\s/g,"").replace(/,/g,""));return Number.isFinite(t)?t:0}function qs(e){const t=Ks(e);return new Intl.NumberFormat("es-CR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(t)}function jy(e){return e.length?e.reduce((t,r)=>t+r,0)/e.length:0}function CE(e){if(e.length<=1)return 0;const t=jy(e),r=e.reduce((a,s)=>a+(s-t)**2,0)/e.length;return Math.sqrt(r)}function NE({siges_code:e,medication_name:t}){const r=String(e??"").trim();if(r)return`code:${r}`;const a=String(t??"").trim().toLowerCase();return a?`name:${a}`:""}function Xx(e){const t=String(e||"").replace(/\D/g,"");return t.length<4?Number.POSITIVE_INFINITY:Number.parseInt(t.slice(-4),10)}function Wx(e){return String(e||"").trim().startsWith("110")}function Kx({status:e}){if(!e?.message)return null;const t=e.type==="success"?"bg-emerald-50 border-emerald-200 text-emerald-800":e.type==="error"?"bg-rose-50 border-rose-200 text-rose-800":"bg-blue-50 border-blue-200 text-blue-800";return w.jsx("div",{className:`border rounded-lg px-4 py-3 text-sm ${t}`,children:w.jsx("span",{children:e.message})})}function OE({medications:e,months:t,tertiaryPackaging:r,medicationCategories:a,inventoryStatus:s,monthlyStatus:l,onRefreshInventories:c,onRefreshConsumptions:u}){const[h,d]=ze.useState(2),[g,x]=ze.useState(""),[v,_]=ze.useState(!0),[b,y]=ze.useState("Todas"),[S,k]=ze.useState(50),[O,T]=ze.useState(1),j=ze.useMemo(()=>{const G=(t??[]).slice(0,3),ne=G.map(M=>String(M?.label??"").trim()).filter(Boolean),pe=new Map;for(const M of a??[]){const z=String(M?.siges_code??"").trim();if(!z)continue;const te=String(M?.category??"").trim();te&&pe.set(z,te)}const J=new Map;for(const M of r??[]){const z=String(M?.siges_code??"").trim();if(!z)continue;const te=Ks(M?.tertiary_quantity);te>0&&J.set(z,te)}const be=new Map;for(const M of e??[]){const z=String(M?.siges_code??"").trim();if(!z)continue;const te=String(M?.inventory_type||"772"),ge=be.get(z)??{inv771:0,inv772:0};te==="771"&&(ge.inv771+=Ks(M?.stock)),te==="772"&&(ge.inv772+=Ks(M?.stock)),be.set(z,ge)}const L=new Map;G.forEach((M,z)=>{const te=M?.items??[];for(const ge of te){const Ee=String(ge?.siges_code??"").trim(),ye=String(ge?.medication_name??"").trim(),Ae=NE({siges_code:Ee,medication_name:ye});if(!Ae)continue;const tt=L.get(Ae)??{siges_code:Ee,medication_name:ye,perMonth:[0,0,0]};tt.siges_code=tt.siges_code||Ee,tt.medication_name=tt.medication_name||ye,tt.perMonth[z]+=Ks(ge?.quantity),L.set(Ae,tt)}});const N=Math.max(0,Number(h)||0),V=Array.from(L.values()).map(M=>{const z=M.perMonth.slice(0,3),te=jy(z),ge=CE(z),Ee=te+ge,ye=String(M.siges_code??"").trim(),Ae=be.get(ye)??{inv771:0,inv772:0},tt=Ks(Ae.inv771)+Ks(Ae.inv772),P=Ee*N-tt,St=Math.max(0,P),at=J.get(ye)??0,Et=at>0?St===0?0:Math.ceil(St/at)*at:St,dt=pe.get(ye)??"";return{siges_code:ye,medication_name:M.medication_name,consumoTotal:Ee,invTotal:tt,empaqueTerciario:at,pedido:Et,category:dt}});return{monthLabels:ne,rows:V}},[a,e,t,h,r]),X=j.monthLabels??[],I=ze.useMemo(()=>{const G=g.trim().toLowerCase(),ne=j.rows??[],pe=v?ne.filter(L=>Ks(L.pedido)>0):ne,J=b==="Todas"?pe:b==="Sin categora"?pe.filter(L=>!String(L.category||"").trim()):pe.filter(L=>String(L.category||"").trim()===b);return(G?J.filter(L=>`${L.siges_code} ${L.medication_name}`.toLowerCase().includes(G)):J).sort((L,N)=>{const V=L?.siges_code||"",M=N?.siges_code||"",z=Wx(V),te=Wx(M);if(z!==te)return z?-1:1;const ge=Xx(V),Ee=Xx(M);return ge!==Ee?ge-Ee:String(V).localeCompare(String(M),"es",{numeric:!0,sensitivity:"base"})})},[b,j.rows,v,g]),C=I.length,K=Math.max(1,Number(S)||50),q=Math.max(1,Math.ceil(C/K)),oe=Math.min(Math.max(O,1),q),ee=C===0?0:(oe-1)*K+1,Z=Math.min(oe*K,C),xe=ze.useMemo(()=>{const G=(oe-1)*K;return I.slice(G,G+K)},[I,oe,K]),Ce=ze.useMemo(()=>{const G=new Set;for(const ne of a??[]){const pe=String(ne?.category??"").trim();pe&&G.add(pe)}return["Todas",...Array.from(G).sort((ne,pe)=>ne.localeCompare(pe,"es")),"Sin categora"]},[a]),Se=()=>{const G=new Date,ne=`${String(G.getDate()).padStart(2,"0")}/${String(G.getMonth()+1).padStart(2,"0")}/${G.getFullYear()}`,pe="Solicitud Pedido (filtrado)",J=X.length?X.slice().reverse().join(", "):"Sin datos",be=b||"Todas",L=z=>String(z??"").replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;"),N=I.map(z=>{const te=L(z.siges_code),ge=L(z.medication_name),Ee=L(qs(z.consumoTotal)),ye=L(qs(z.invTotal)),Ae=z.empaqueTerciario?L(qs(z.empaqueTerciario)):"",tt=L(qs(z.pedido));return`<tr>
          <td class="mono center">${te}</td>
          <td>${ge}</td>
          <td class="mono right">${Ee}</td>
          <td class="mono right">${ye}</td>
          <td class="mono right">${Ae}</td>
          <td class="mono right strong">${tt}</td>
        </tr>`}).join(""),V=`<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>${L(pe)}</title>
    <style>
      @page { size: A4 landscape; margin: 12mm; }
      body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; color: #0f172a; }
      h1 { font-size: 16px; margin: 0 0 4px; }
      .meta { font-size: 12px; color: #475569; margin-bottom: 10px; }
      table { width: 100%; border-collapse: collapse; font-size: 11px; }
      th, td { border: 1px solid #e2e8f0; padding: 6px 8px; vertical-align: top; }
      th { background: #f8fafc; text-transform: uppercase; font-size: 10px; letter-spacing: .04em; }
      .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace; }
      .center { text-align: center; }
      .right { text-align: right; }
      .strong { font-weight: 700; color: #1d4ed8; }
    </style>
  </head>
  <body>
    <h1>${L(pe)}</h1>
    <div class="meta">Generado: ${L(ne)}  Meses usados: ${L(J)}  Meses a pedir: ${L(h)}  Categora: ${L(be)}  Filas: ${L(I.length)}</div>
    <table>
      <thead>
        <tr>
          <th>Cdigo</th>
          <th>Medicamento</th>
          <th>Consumo total</th>
          <th>Inventario total</th>
          <th>Empaque terciario</th>
          <th>Pedido</th>
        </tr>
      </thead>
      <tbody>${N||""}</tbody>
    </table>
    <script>window.onload = () => { window.focus(); window.print(); };<\/script>
  </body>
</html>`,M=window.open("","_blank","noopener,noreferrer");M&&(M.document.open(),M.document.write(V),M.document.close())};return w.jsxs("div",{className:"space-y-6",children:[w.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-5",children:[w.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[w.jsxs("div",{className:"space-y-1",children:[w.jsx("h3",{className:"font-semibold text-slate-800",children:"Solicitud Pedido"}),w.jsx("p",{className:"text-xs text-slate-500",children:"Pedido = (Consumo total  Meses)  (Inventario total). Consumo total = Promedio + Desv. Est. Inventario total = Inv. 772 + Inv. 771."})]}),w.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[w.jsxs("button",{type:"button",onClick:()=>{u?.(),c?.()},className:"px-3 py-2 rounded-lg border border-slate-200 text-slate-700 hover:bg-slate-50 text-sm flex items-center gap-2",children:[w.jsx(qi,{size:16}),"Sincronizar"]}),w.jsxs("button",{type:"button",onClick:Se,className:"px-3 py-2 rounded-lg border border-slate-200 text-slate-700 hover:bg-slate-50 text-sm flex items-center gap-2",title:"Exporta lo filtrado usando la impresora del navegador (Guardar como PDF).",children:[w.jsx(Hc,{size:16}),"Exportar PDF"]})]})]}),w.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-3 gap-3",children:[w.jsxs("div",{className:"md:col-span-1",children:[w.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase mb-1",children:"Meses a pedir"}),w.jsx("input",{type:"number",min:0,step:1,value:h,onChange:G=>{d(Number(G.target.value)||0),T(1)},className:"w-full border border-slate-200 rounded-lg px-3 py-2 text-sm bg-white"})]}),w.jsxs("div",{className:"md:col-span-2 flex flex-col gap-2",children:[w.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase mb-1",children:"Filtros"}),w.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[w.jsx("select",{value:b,onChange:G=>{y(G.target.value),T(1)},className:"border border-slate-200 rounded-lg px-3 py-2 text-sm bg-white",title:"Filtrar por categora",children:Ce.map(G=>w.jsx("option",{value:G,children:G},G))}),w.jsx("button",{type:"button",onClick:()=>{_(G=>!G),T(1)},className:"px-3 py-2 rounded-lg border border-slate-200 text-slate-700 hover:bg-slate-50 text-sm",children:v?"Mostrar pedido 0":"Ocultar pedido 0"}),w.jsx("input",{value:g,onChange:G=>{x(G.target.value),T(1)},placeholder:"Buscar por cdigo o medicamento...",className:"flex-1 min-w-72 border border-slate-200 rounded-lg px-3 py-2 text-sm bg-white"})]})]})]}),w.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-3",children:[w.jsx(Kx,{status:s}),w.jsx(Kx,{status:l})]})]}),w.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm overflow-hidden",children:[w.jsxs("div",{className:"p-4 border-b border-slate-100 bg-slate-50 flex items-center justify-between",children:[w.jsxs("div",{className:"flex items-center gap-3",children:[w.jsx("div",{className:"bg-blue-50 text-blue-600 p-2 rounded-lg",children:w.jsx(lm,{size:18})}),w.jsxs("div",{children:[w.jsx("h3",{className:"font-bold text-slate-800",children:"Clculo por medicamento"}),w.jsxs("p",{className:"text-xs text-slate-500",children:["Meses usados: ",X.length?X.slice().reverse().join(", "):"Sin datos"]})]})]}),w.jsxs("span",{className:"text-xs text-slate-500",children:[C," filas"]})]}),w.jsx("div",{className:"overflow-auto max-h-[70vh]",children:w.jsxs("table",{className:"w-full min-w-[860px] text-left",children:[w.jsx("thead",{className:"sticky top-0 z-10 bg-slate-50 text-slate-500 text-[10px] uppercase font-bold shadow-sm",children:w.jsxs("tr",{children:[w.jsx("th",{className:"px-4 py-4 whitespace-nowrap w-36 text-center",children:"Cdigo"}),w.jsx("th",{className:"px-4 py-4 whitespace-nowrap",children:"Medicamento"}),w.jsx("th",{className:"px-3 py-4 text-center whitespace-nowrap w-40",children:"Consumo total"}),w.jsx("th",{className:"px-3 py-4 text-center whitespace-nowrap w-40",children:"Inventario total"}),w.jsx("th",{className:"px-3 py-4 text-center whitespace-nowrap w-40",children:"Empaque terciario"}),w.jsx("th",{className:"px-3 py-4 text-center whitespace-nowrap w-40",children:"Pedido"})]})}),w.jsxs("tbody",{className:"divide-y divide-slate-100",children:[xe.map((G,ne)=>w.jsxs("tr",{className:"hover:bg-slate-50",children:[w.jsx("td",{className:"px-4 py-4 text-xs text-slate-600 font-mono whitespace-nowrap text-center",children:G.siges_code||""}),w.jsx("td",{className:"px-4 py-4 text-sm font-medium text-slate-700 whitespace-normal break-words",children:G.medication_name}),w.jsx("td",{className:"px-3 py-4 text-center font-mono text-sm tabular-nums",children:qs(G.consumoTotal)}),w.jsx("td",{className:"px-3 py-4 text-center font-mono text-sm tabular-nums",children:qs(G.invTotal)}),w.jsx("td",{className:"px-3 py-4 text-center font-mono text-sm tabular-nums",children:G.empaqueTerciario?qs(G.empaqueTerciario):""}),w.jsx("td",{className:"px-3 py-4 text-center font-mono text-sm font-bold text-blue-700 tabular-nums",children:qs(G.pedido)})]},`${G.siges_code||G.medication_name}-${ne}`)),xe.length===0&&w.jsx("tr",{children:w.jsx("td",{colSpan:6,className:"px-6 py-10 text-center text-sm text-slate-400",children:"No hay resultados."})})]})]})}),w.jsxs("div",{className:"p-4 border-t border-slate-100 bg-slate-50 flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[w.jsx("div",{className:"text-xs text-slate-500",children:C===0?"0 resultados":`Mostrando ${ee}-${Z} de ${C}`}),w.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[w.jsx("label",{className:"text-xs text-slate-500",children:"Filas"}),w.jsx("select",{value:K,onChange:G=>{k(Number(G.target.value)||50),T(1)},className:"border border-slate-200 rounded-lg px-2 py-1 text-xs bg-white",children:[25,50,100,200].map(G=>w.jsx("option",{value:G,children:G},G))}),w.jsx("button",{type:"button",onClick:()=>T(G=>Math.max(1,G-1)),disabled:oe<=1,className:"px-3 py-1.5 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 disabled:opacity-40 disabled:hover:bg-white",children:"Anterior"}),w.jsxs("span",{className:"text-xs text-slate-600",children:["Pgina ",oe," de ",q]}),w.jsx("button",{type:"button",onClick:()=>T(G=>Math.min(q,G+1)),disabled:oe>=q,className:"px-3 py-1.5 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 disabled:opacity-40 disabled:hover:bg-white",children:"Siguiente"})]})]})]})]})}function RE({status:e,fileInputRef:t,onChooseFile:r,onFileChange:a,onDownloadTemplate:s,onRefresh:l,canClear:c,onClear:u,search:h,onSearchChange:d,items:g,totalItems:x,page:v,pageSize:_,onPageChange:b,onPageSizeChange:y}){const S=C=>{const K=Number(C);return Number.isFinite(K)?K.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):String(C??"0")},k=Number(x)||0,O=Number(_)||50,T=Math.max(1,Math.ceil(k/O)),j=Math.min(Math.max(Number(v)||1,1),T),X=k===0?0:(j-1)*O+1,I=Math.min(j*O,k);return w.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden",children:[w.jsxs("div",{className:"p-4 border-b border-slate-100 bg-slate-50 flex flex-col gap-3",children:[w.jsxs("div",{className:"flex flex-wrap gap-3 items-center justify-between",children:[w.jsxs("div",{className:"relative w-80",children:[w.jsx(om,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:18}),w.jsx("input",{type:"text",value:h,onChange:C=>d?.(C.target.value),placeholder:"Buscar por cdigo o medicamento...",className:"w-full pl-10 pr-4 py-2 border border-slate-200 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 outline-none"})]}),w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("input",{type:"file",ref:t,onChange:a,accept:".xlsx",className:"hidden"}),w.jsxs("button",{type:"button",onClick:l,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 flex items-center gap-2",title:"Sincronizar empaque terciario",children:[w.jsx(qi,{size:14}),"Sincronizar"]}),w.jsxs("button",{type:"button",onClick:r,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-blue-50 hover:text-blue-700 flex items-center gap-2",children:[w.jsx(io,{size:14}),"Cargar XLSX"]}),w.jsxs("button",{type:"button",onClick:s,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 flex items-center gap-2",children:[w.jsx(Hc,{size:14}),"Plantilla"]}),w.jsxs("button",{type:"button",onClick:u,disabled:!c,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-red-200 text-red-600 hover:bg-red-50 flex items-center gap-2 disabled:opacity-40 disabled:hover:bg-white",title:"Eliminar toda la carga",children:[w.jsx(to,{size:14}),"Eliminar carga"]})]})]}),e?.message&&w.jsxs("div",{className:`p-3 rounded-lg text-xs flex items-center gap-2 ${e.type==="success"?"bg-green-50 text-green-700 border border-green-100":e.type==="error"?"bg-red-50 text-red-700 border border-red-100":"bg-blue-50 text-blue-700 border border-blue-100"}`,children:[e.type==="success"?w.jsx(zc,{size:16}):w.jsx(si,{size:16}),w.jsx("span",{children:e.message})]})]}),w.jsx("div",{className:"overflow-x-auto",children:w.jsxs("table",{className:"min-w-max w-full text-left",children:[w.jsx("thead",{className:"bg-slate-50 text-slate-500 text-[10px] uppercase font-bold",children:w.jsxs("tr",{children:[w.jsx("th",{className:"px-6 py-4 text-center whitespace-nowrap",children:"Cdigo SIGES"}),w.jsx("th",{className:"px-6 py-4 whitespace-nowrap",children:"Medicamento"}),w.jsx("th",{className:"px-6 py-4 text-center whitespace-nowrap",children:"Empaque terciario"})]})}),w.jsxs("tbody",{className:"divide-y divide-slate-100",children:[g.map(C=>w.jsxs("tr",{className:"hover:bg-slate-50 transition-colors group text-sm",children:[w.jsx("td",{className:"px-6 py-4 text-slate-700 font-mono text-center whitespace-nowrap",children:C.siges_code}),w.jsx("td",{className:"px-6 py-4 text-slate-700 max-w-[520px]",children:w.jsx("span",{className:"block truncate",children:C.medication_name})}),w.jsx("td",{className:"px-6 py-4 text-center whitespace-nowrap text-slate-800 font-mono",children:S(C.tertiary_quantity)})]},C.id)),g.length===0&&w.jsx("tr",{children:w.jsxs("td",{colSpan:3,className:"px-6 py-10 text-center text-sm text-slate-400",children:['No hay resultados para "',h,'".']})})]})]})}),w.jsxs("div",{className:"p-4 border-t border-slate-100 bg-slate-50 flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[w.jsx("div",{className:"text-xs text-slate-500",children:k===0?"0 resultados":`Mostrando ${X}-${I} de ${k}`}),w.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[w.jsx("label",{className:"text-xs text-slate-500",children:"Filas"}),w.jsx("select",{value:O,onChange:C=>y?.(Number(C.target.value)||50),className:"border border-slate-200 rounded-lg px-2 py-1 text-xs bg-white",children:[25,50,100,200].map(C=>w.jsx("option",{value:C,children:C},C))}),w.jsx("button",{type:"button",onClick:()=>b?.(j-1),disabled:j<=1,className:"px-3 py-1.5 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 disabled:opacity-40 disabled:hover:bg-white",children:"Anterior"}),w.jsxs("span",{className:"text-xs text-slate-600",children:["Pgina ",j," de ",T]}),w.jsx("button",{type:"button",onClick:()=>b?.(j+1),disabled:j>=T,className:"px-3 py-1.5 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 disabled:opacity-40 disabled:hover:bg-white",children:"Siguiente"})]})]})]})}const Ml=["Ordinario","Fro","Estupefaciente","Psicotrpico","Alcohol","Suero","Compra Local"];function DE({status:e,fileInputRef:t,onChooseFile:r,onFileChange:a,onDownloadTemplate:s,onRefresh:l,canClear:c,onClear:u,onEdit:h,onDelete:d,search:g,onSearchChange:x,items:v,totalItems:_,page:b,pageSize:y,onPageChange:S,onPageSizeChange:k}){const[O,T]=ze.useState(null),[j,X]=ze.useState(Ml[0]),[I,C]=ze.useState(""),K=!!h,q=!!d,oe=be=>{if(!be)return;T(be),C(String(be.medication_name||"").trim());const L=String(be.category||"").trim();X(Ml.includes(L)?L:Ml[0])},ee=()=>{T(null),C(""),X(Ml[0])},Z=async()=>{O&&(await h?.({...O,medication_name:I,category:j}),ee())},xe=Number(_)||0,Ce=Number(y)||50,Se=Math.max(1,Math.ceil(xe/Ce)),G=Math.min(Math.max(Number(b)||1,1),Se),ne=xe===0?0:(G-1)*Ce+1,pe=Math.min(G*Ce,xe),J=ze.useMemo(()=>K||q,[q,K]);return w.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden",children:[w.jsxs("div",{className:"p-4 border-b border-slate-100 bg-slate-50 flex flex-col gap-3",children:[w.jsxs("div",{className:"flex flex-wrap gap-3 items-center justify-between",children:[w.jsxs("div",{className:"relative w-80",children:[w.jsx(om,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:18}),w.jsx("input",{type:"text",value:g,onChange:be=>x?.(be.target.value),placeholder:"Buscar por cdigo o medicamento...",className:"w-full pl-10 pr-4 py-2 border border-slate-200 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 outline-none"})]}),w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("input",{type:"file",ref:t,onChange:a,accept:".xlsx",className:"hidden"}),w.jsxs("button",{type:"button",onClick:l,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 flex items-center gap-2",title:"Sincronizar categoras",children:[w.jsx(qi,{size:14}),"Sincronizar"]}),w.jsxs("button",{type:"button",onClick:r,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-blue-50 hover:text-blue-700 flex items-center gap-2",children:[w.jsx(io,{size:14}),"Cargar XLSX"]}),w.jsxs("button",{type:"button",onClick:s,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 flex items-center gap-2",children:[w.jsx(Hc,{size:14}),"Plantilla"]}),w.jsxs("button",{type:"button",onClick:u,disabled:!c,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-red-200 text-red-600 hover:bg-red-50 flex items-center gap-2 disabled:opacity-40 disabled:hover:bg-white",title:"Eliminar toda la carga",children:[w.jsx(to,{size:14}),"Eliminar carga"]})]})]}),w.jsxs("div",{className:"text-[11px] text-slate-500",children:["Categoras permitidas: ",Ml.join(", "),"."]}),e?.message&&w.jsxs("div",{className:`p-3 rounded-lg text-xs flex items-center gap-2 ${e.type==="success"?"bg-green-50 text-green-700 border border-green-100":e.type==="error"?"bg-red-50 text-red-700 border border-red-100":"bg-blue-50 text-blue-700 border border-blue-100"}`,children:[e.type==="success"?w.jsx(zc,{size:16}):w.jsx(si,{size:16}),w.jsx("span",{children:e.message})]})]}),w.jsx("div",{className:"overflow-x-auto",children:w.jsxs("table",{className:"min-w-max w-full text-left",children:[w.jsx("thead",{className:"bg-slate-50 text-slate-500 text-[10px] uppercase font-bold",children:w.jsxs("tr",{children:[w.jsx("th",{className:"px-6 py-4 text-center whitespace-nowrap",children:"Cdigo"}),w.jsx("th",{className:"px-6 py-4 whitespace-nowrap",children:"Medicamento"}),w.jsx("th",{className:"px-6 py-4 text-center whitespace-nowrap",children:"Categora"}),J&&w.jsx("th",{className:"px-6 py-4 text-center whitespace-nowrap",children:"Acciones"})]})}),w.jsxs("tbody",{className:"divide-y divide-slate-100",children:[v.map(be=>w.jsxs("tr",{className:"hover:bg-slate-50 transition-colors group text-sm",children:[w.jsx("td",{className:"px-6 py-4 text-slate-700 font-mono text-center whitespace-nowrap",children:be.siges_code}),w.jsx("td",{className:"px-6 py-4 text-slate-700 max-w-[520px]",children:w.jsx("span",{className:"block truncate",children:be.medication_name})}),w.jsx("td",{className:"px-6 py-4 text-center whitespace-nowrap text-slate-800 font-mono",children:be.category}),J&&w.jsx("td",{className:"px-6 py-4 text-center whitespace-nowrap",children:w.jsxs("div",{className:"flex items-center justify-center gap-2",children:[K&&w.jsx("button",{type:"button",onClick:()=>oe(be),className:"p-2 rounded-lg border border-slate-200 text-slate-600 hover:bg-slate-100",title:"Editar",children:w.jsx(tE,{size:16})}),q&&w.jsx("button",{type:"button",onClick:()=>d?.(be),className:"p-2 rounded-lg border border-red-200 text-red-600 hover:bg-red-50",title:"Eliminar",children:w.jsx(to,{size:16})})]})})]},be.id)),v.length===0&&w.jsx("tr",{children:w.jsxs("td",{colSpan:J?4:3,className:"px-6 py-10 text-center text-sm text-slate-400",children:['No hay resultados para "',g,'".']})})]})]})}),O&&w.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 p-4",children:w.jsxs("div",{className:"w-full max-w-lg rounded-xl bg-white border border-slate-200 shadow-xl overflow-hidden",children:[w.jsxs("div",{className:"p-4 border-b border-slate-100 bg-slate-50 flex items-center justify-between",children:[w.jsxs("div",{children:[w.jsx("div",{className:"text-sm font-bold text-slate-800",children:"Editar categora"}),w.jsx("div",{className:"text-xs text-slate-500 font-mono",children:O.siges_code})]}),w.jsx("button",{type:"button",onClick:ee,className:"p-2 rounded-lg text-slate-500 hover:bg-slate-100",title:"Cerrar",children:w.jsx(cm,{size:18})})]}),w.jsxs("div",{className:"p-4 space-y-3",children:[w.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase",children:"Medicamento"}),w.jsx("input",{value:I,onChange:be=>C(be.target.value),className:"w-full border border-slate-200 rounded-lg px-3 py-2 text-sm",placeholder:"Nombre del medicamento"}),w.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase",children:"Categora"}),w.jsx("select",{value:j,onChange:be=>X(be.target.value),className:"w-full border border-slate-200 rounded-lg px-3 py-2 text-sm bg-white",children:Ml.map(be=>w.jsx("option",{value:be,children:be},be))})]}),w.jsxs("div",{className:"p-4 border-t border-slate-100 bg-slate-50 flex items-center justify-end gap-2",children:[w.jsx("button",{type:"button",onClick:ee,className:"px-3 py-2 rounded-lg border border-slate-200 text-slate-700 hover:bg-white text-sm",children:"Cancelar"}),w.jsx("button",{type:"button",onClick:Z,className:"px-3 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 text-sm font-bold",children:"Guardar"})]})]})}),w.jsxs("div",{className:"p-4 border-t border-slate-100 bg-slate-50 flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[w.jsx("div",{className:"text-xs text-slate-500",children:xe===0?"0 resultados":`Mostrando ${ne}-${pe} de ${xe}`}),w.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[w.jsx("label",{className:"text-xs text-slate-500",children:"Filas"}),w.jsx("select",{value:Ce,onChange:be=>k?.(Number(be.target.value)||50),className:"border border-slate-200 rounded-lg px-2 py-1 text-xs bg-white",children:[25,50,100,200].map(be=>w.jsx("option",{value:be,children:be},be))}),w.jsx("button",{type:"button",onClick:()=>S?.(G-1),disabled:G<=1,className:"px-3 py-1.5 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 disabled:opacity-40 disabled:hover:bg-white",children:"Anterior"}),w.jsxs("span",{className:"text-xs text-slate-600",children:["Pgina ",G," de ",Se]}),w.jsx("button",{type:"button",onClick:()=>S?.(G+1),disabled:G>=Se,className:"px-3 py-1.5 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 disabled:opacity-40 disabled:hover:bg-white",children:"Siguiente"})]})]})]})}const FE=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"];function ME(e){const t=String(e??"").trim();if(!t)return"";const r=t.slice(0,10);return/^\d{4}-\d{2}-\d{2}$/.test(r)?r:""}function LE({status:e,entries:t,onRefresh:r,onSave:a}){const s=new Date().getFullYear(),[l,c]=ze.useState(s),[u,h]=ze.useState(()=>Array.from({length:12},()=>"")),[d,g]=ze.useState(!1),[x,v]=ze.useState(!1),_=ze.useMemo(()=>{const S=new Set([s]);for(const k of t??[]){const O=Number(k?.year);Number.isFinite(O)&&O>0&&S.add(O)}return Array.from(S).sort((k,O)=>O-k)},[s,t]),b=ze.useMemo(()=>{const S=new Map;for(const k of t??[]){const O=Number(k?.year)||0,T=Number(k?.month)||0;!O||T<1||T>12||S.set(`${O}-${T}`,k)}return S},[t]);ze.useEffect(()=>{_.includes(l)||c(_[0]??s)},[_.join(","),l]),ze.useEffect(()=>{const S=Array.from({length:12},(k,O)=>{const T=b.get(`${l}-${O+1}`);return ME(T?.scheduled_receipt_date)});h(S),v(!1)},[b,l]);const y=async()=>{if(!(!a||d)){g(!0);try{const S=Array.from({length:12},(k,O)=>({year:l,month:O+1,scheduled_receipt_date:u[O]?String(u[O]):null}));await a(S),v(!1)}finally{g(!1)}}};return w.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden",children:[w.jsxs("div",{className:"p-4 border-b border-slate-100 bg-slate-50 flex flex-col gap-3",children:[w.jsxs("div",{className:"flex flex-wrap gap-3 items-center justify-between",children:[w.jsx("div",{className:"flex items-center gap-3",children:w.jsxs("div",{children:[w.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase mb-1",children:"Ao"}),w.jsx("select",{value:l,onChange:S=>c(Number(S.target.value)||s),className:"border border-slate-200 rounded-lg px-3 py-2 text-sm bg-white",children:_.map(S=>w.jsx("option",{value:S,children:S},S))})]})}),w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsxs("button",{type:"button",onClick:r,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 flex items-center gap-2",title:"Sincronizar calendario",children:[w.jsx(qi,{size:14}),"Sincronizar"]}),w.jsxs("button",{type:"button",onClick:y,disabled:!x||d,className:"px-3 py-2 rounded-lg text-xs font-bold bg-blue-600 text-white hover:bg-blue-700 flex items-center gap-2 disabled:opacity-40 disabled:hover:bg-blue-600",title:"Guardar cambios",children:[w.jsx(sE,{size:14}),"Guardar"]})]})]}),e?.message&&w.jsxs("div",{className:`p-3 rounded-lg text-xs flex items-center gap-2 ${e.type==="success"?"bg-green-50 text-green-700 border border-green-100":e.type==="error"?"bg-red-50 text-red-700 border border-red-100":"bg-blue-50 text-blue-700 border border-blue-100"}`,children:[e.type==="success"?w.jsx(zc,{size:16}):w.jsx(si,{size:16}),w.jsx("span",{children:e.message})]})]}),w.jsx("div",{className:"overflow-x-auto",children:w.jsxs("table",{className:"min-w-max w-full text-left",children:[w.jsx("thead",{className:"bg-slate-50 text-slate-500 text-[10px] uppercase font-bold",children:w.jsxs("tr",{children:[w.jsx("th",{className:"px-6 py-4 whitespace-nowrap",children:"Mes"}),w.jsx("th",{className:"px-6 py-4 whitespace-nowrap",children:"Recepcin programada"})]})}),w.jsx("tbody",{className:"divide-y divide-slate-100",children:FE.map((S,k)=>w.jsxs("tr",{className:"hover:bg-slate-50 transition-colors text-sm",children:[w.jsx("td",{className:"px-6 py-4 text-slate-700 whitespace-nowrap",children:S}),w.jsx("td",{className:"px-6 py-4 text-slate-700 whitespace-nowrap",children:w.jsx("input",{type:"date",value:u[k]??"",onChange:O=>{const T=O.target.value;h(j=>{const X=[...j];return X[k]=T,X}),v(!0)},className:"border border-slate-200 rounded-lg px-3 py-2 text-sm bg-white"})})]},S))})]})})]})}function IE(e){return e.replace(/^\uFEFF/,"")}function BE(e){const t=(e.match(/,/g)||[]).length;return(e.match(/;/g)||[]).length>t?";":","}function Uy(e){const t=IE(e).replace(/\r\n/g,`
`).replace(/\r/g,`
`),r=[];let a=[],s="",l=!1,c=0;const u=t.split(`
`)[0]||"",h=BE(u);for(;c<t.length;){const g=t[c];if(l){if(g==='"'){if(t[c+1]==='"'){s+='"',c+=2;continue}l=!1,c+=1;continue}s+=g,c+=1;continue}if(g==='"'){l=!0,c+=1;continue}if(g===h){a.push(s),s="",c+=1;continue}if(g===`
`){a.push(s),s="",a.every(v=>String(v||"").trim()==="")||r.push(a),a=[],c+=1;continue}s+=g,c+=1}return a.push(s),a.every(g=>String(g||"").trim()==="")||r.push(a),{rows:r,delimiter:h}}function Yx(e){const{rows:t}=Uy(e);return t}function jE(e){return String(e||"").trim().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]/g,"")}function UE(e){const t={nombre:"Nombre",name:"Nombre",categoria:"Categoria",category:"Categoria",codigosiges:"CodigoSIGES",codsiges:"CodigoSIGES",siges:"CodigoSIGES",codigosicop:"IdentificadorSICOP",identificadorsicop:"IdentificadorSICOP",identificac:"IdentificadorSICOP",identificador:"IdentificadorSICOP",idsicop:"IdentificadorSICOP",clasificadorsicop:"ClasificadorSICOP",clasificador:"ClasificadorSICOP",sicopclasificador:"ClasificadorSICOP",sicopidentificador:"IdentificadorSICOP",medicamento:"Medicamento",descripcionsicop:"Medicamento",descripcion:"Medicamento",lote:"Lote",batch:"Lote",vencimiento:"Vencimiento",expirydate:"Vencimiento",stock:"Stock",stockminimo:"StockMinimo",minstock:"StockMinimo",unidad:"Unidad",unit:"Unidad",producto:"Medicamento",item:"Medicamento",cantidad:"Cantidad",consumo:"Cantidad",salida:"Cantidad",responsable:"Responsable",usuario:"Responsable",user:"Responsable",motivo:"Motivo",destino:"Motivo",observacion:"Motivo",fecha:"Fecha",fechahora:"Fecha",date:"Fecha"};return e.map(r=>t[jE(r)]||String(r||"").trim())}function dd(e){if(e instanceof Date&&!Number.isNaN(e.getTime()))return e.toISOString().slice(0,10);const t=String(e??"").trim();if(!t)return new Date().toISOString().slice(0,10);const r=t.slice(0,10);if(/^\d{4}-\d{2}-\d{2}$/.test(r))return r;const a=new Date(t);return Number.isNaN(a.getTime())?new Date().toISOString().slice(0,10):a.toISOString().slice(0,10)}function ro(e,t){const r=String(e??"");return r.includes('"')||r.includes(`
`)||r.includes("\r")||r.includes(t)?`"${r.replace(/"/g,'""')}"`:r}function PE(){const t=["CodigoSIGES","ClasificadorSICOP","IdentificadorSICOP","Medicamento","Categoria","Lote","Vencimiento","Stock","StockMinimo","Unidad"],r=["SIG-0001","SICOP-CL-01","SICOP-ID-0001","Paracetamol","Analgsico","LOT-2025-01","2027-12-31",100,20,"Tabletas"],s=`\uFEFF${[t.map(h=>ro(h,";")).join(";"),r.map(h=>ro(h,";")).join(";")].join(`
`)}
`,l=new Blob([s],{type:"text/csv;charset=utf-8"}),c=URL.createObjectURL(l),u=document.createElement("a");u.href=c,u.download="plantilla_catalogo.csv",document.body.appendChild(u),u.click(),u.remove(),URL.revokeObjectURL(c)}function zE(){const t=["CodigoSIGES","Medicamento","Consumo","Costo"],r=["110-16-0010","Paracetamol",1555.85,148621015e-2],s=`\uFEFF${[t.map(h=>ro(h,";")).join(";"),r.map(h=>ro(h,";")).join(";")].join(`
`)}
`,l=new Blob([s],{type:"text/csv;charset=utf-8"}),c=URL.createObjectURL(l),u=document.createElement("a");u.href=c,u.download="plantilla_consumo_mensual.csv",document.body.appendChild(u),u.click(),u.remove(),URL.revokeObjectURL(c)}function Jx(e){const{rows:t}=Uy(e);if(t.length===0)return[];const r=t[0],a=UE(r);return t.slice(1).map(l=>{const c={};for(let u=0;u<a.length;u+=1){const h=a[u];h&&(c[h]=l[u]??"")}return c})}function HE(e){const t=String(e||"772").trim()||"772",r=";",a=["CodigoSIGES","ClasificadorSICOP","IdentificadorSICOP","Medicamento","Categoria","Lote","Vencimiento","Stock","StockMinimo","Unidad"],s=["SIG-0001","SICOP-CL-01","SICOP-ID-0001","Paracetamol","General","LOT-2025-01","2027-12-31",100,20,"Tabletas"],c=`\uFEFF${[a.map(g=>ro(g,r)).join(r),s.map(g=>ro(g,r)).join(r)].join(`
`)}
`,u=new Blob([c],{type:"text/csv;charset=utf-8"}),h=URL.createObjectURL(u),d=document.createElement("a");d.href=h,d.download=`plantilla_inventario_${t}.csv`,document.body.appendChild(d),d.click(),d.remove(),URL.revokeObjectURL(h)}function $E(e){const t=String(e||"771").trim()||"771",r=`<?xml version="1.0" encoding="UTF-8"?>
<Inventario tipo="${t}">
  <Item>
    <CodigoSIGES>110-16-0010</CodigoSIGES>
    <Medicamento>Paracetamol</Medicamento>
    <Lote>LOT-2025-01</Lote>
    <Vencimiento>2027-12-31</Vencimiento>
    <Inventario>100</Inventario>
  </Item>
</Inventario>
`,a=new Blob([r],{type:"application/xml;charset=utf-8"}),s=URL.createObjectURL(a),l=document.createElement("a");l.href=s,l.download=`plantilla_inventario_${t}.xml`,document.body.appendChild(l),l.click(),l.remove(),URL.revokeObjectURL(s)}function Gu(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,a=Object.getOwnPropertySymbols(e);s<a.length;s++)t.indexOf(a[s])<0&&Object.prototype.propertyIsEnumerable.call(e,a[s])&&(r[a[s]]=e[a[s]]);return r}function VE(e,t,r,a){function s(l){return l instanceof r?l:new r(function(c){c(l)})}return new(r||(r=Promise))(function(l,c){function u(g){try{d(a.next(g))}catch(x){c(x)}}function h(g){try{d(a.throw(g))}catch(x){c(x)}}function d(g){g.done?l(g.value):s(g.value).then(u,h)}d((a=a.apply(e,t||[])).next())})}const GE=e=>e?(...t)=>e(...t):(...t)=>fetch(...t);class um extends Error{constructor(t,r="FunctionsError",a){super(t),this.name=r,this.context=a}}class qE extends um{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class Qx extends um{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class Zx extends um{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var jd;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(jd||(jd={}));class XE{constructor(t,{headers:r={},customFetch:a,region:s=jd.Any}={}){this.url=t,this.headers=r,this.region=s,this.fetch=GE(a)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return VE(this,arguments,void 0,function*(r,a={}){var s;let l,c;try{const{headers:u,method:h,body:d,signal:g,timeout:x}=a;let v={},{region:_}=a;_||(_=this.region);const b=new URL(`${this.url}/${r}`);_&&_!=="any"&&(v["x-region"]=_,b.searchParams.set("forceFunctionRegion",_));let y;d&&(u&&!Object.prototype.hasOwnProperty.call(u,"Content-Type")||!u)?typeof Blob<"u"&&d instanceof Blob||d instanceof ArrayBuffer?(v["Content-Type"]="application/octet-stream",y=d):typeof d=="string"?(v["Content-Type"]="text/plain",y=d):typeof FormData<"u"&&d instanceof FormData?y=d:(v["Content-Type"]="application/json",y=JSON.stringify(d)):y=d;let S=g;x&&(c=new AbortController,l=setTimeout(()=>c.abort(),x),g?(S=c.signal,g.addEventListener("abort",()=>c.abort())):S=c.signal);const k=yield this.fetch(b.toString(),{method:h||"POST",headers:Object.assign(Object.assign(Object.assign({},v),this.headers),u),body:y,signal:S}).catch(X=>{throw new qE(X)}),O=k.headers.get("x-relay-error");if(O&&O==="true")throw new Qx(k);if(!k.ok)throw new Zx(k);let T=((s=k.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),j;return T==="application/json"?j=yield k.json():T==="application/octet-stream"||T==="application/pdf"?j=yield k.blob():T==="text/event-stream"?j=k:T==="multipart/form-data"?j=yield k.formData():j=yield k.text(),{data:j,error:null,response:k}}catch(u){return{data:null,error:u,response:u instanceof Zx||u instanceof Qx?u.context:void 0}}finally{l&&clearTimeout(l)}})}}var WE=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}},KE=class{constructor(e){var t,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(t=e.shouldThrowOnError)!==null&&t!==void 0?t:!1,this.signal=e.signal,this.isMaybeSingle=(r=e.isMaybeSingle)!==null&&r!==void 0?r:!1,e.fetch?this.fetch=e.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){var r=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const a=this.fetch;let s=a(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async l=>{let c=null,u=null,h=null,d=l.status,g=l.statusText;if(l.ok){var x,v;if(r.method!=="HEAD"){var _;const k=await l.text();k===""||(r.headers.get("Accept")==="text/csv"||r.headers.get("Accept")&&(!((_=r.headers.get("Accept"))===null||_===void 0)&&_.includes("application/vnd.pgrst.plan+text"))?u=k:u=JSON.parse(k))}const y=(x=r.headers.get("Prefer"))===null||x===void 0?void 0:x.match(/count=(exact|planned|estimated)/),S=(v=l.headers.get("content-range"))===null||v===void 0?void 0:v.split("/");y&&S&&S.length>1&&(h=parseInt(S[1])),r.isMaybeSingle&&r.method==="GET"&&Array.isArray(u)&&(u.length>1?(c={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,h=null,d=406,g="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{var b;const y=await l.text();try{c=JSON.parse(y),Array.isArray(c)&&l.status===404&&(u=[],c=null,d=200,g="OK")}catch{l.status===404&&y===""?(d=204,g="No Content"):c={message:y}}if(c&&r.isMaybeSingle&&(!(c==null||(b=c.details)===null||b===void 0)&&b.includes("0 rows"))&&(c=null,d=200,g="OK"),c&&r.shouldThrowOnError)throw new WE(c)}return{error:c,data:u,count:h,status:d,statusText:g}});return this.shouldThrowOnError||(s=s.catch(l=>{var c;let u="";const h=l?.cause;if(h){var d,g,x,v;const b=(d=h?.message)!==null&&d!==void 0?d:"",y=(g=h?.code)!==null&&g!==void 0?g:"";u=`${(x=l?.name)!==null&&x!==void 0?x:"FetchError"}: ${l?.message}`,u+=`

Caused by: ${(v=h?.name)!==null&&v!==void 0?v:"Error"}: ${b}`,y&&(u+=` (${y})`),h?.stack&&(u+=`
${h.stack}`)}else{var _;u=(_=l?.stack)!==null&&_!==void 0?_:""}return{error:{message:`${(c=l?.name)!==null&&c!==void 0?c:"FetchError"}: ${l?.message}`,details:u,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),s.then(e,t)}returns(){return this}overrideTypes(){return this}},YE=class extends KE{select(e){let t=!1;const r=(e??"*").split("").map(a=>/\s/.test(a)&&!t?"":(a==='"'&&(t=!t),a)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:a,referencedTable:s=a}={}){const l=s?`${s}.order`:"order",c=this.url.searchParams.get(l);return this.url.searchParams.set(l,`${c?`${c},`:""}${e}.${t?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const a=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(a,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:a=r}={}){const s=typeof a>"u"?"offset":`${a}.offset`,l=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(s,`${e}`),this.url.searchParams.set(l,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:a=!1,wal:s=!1,format:l="text"}={}){var c;const u=[e?"analyze":null,t?"verbose":null,r?"settings":null,a?"buffers":null,s?"wal":null].filter(Boolean).join("|"),h=(c=this.headers.get("Accept"))!==null&&c!==void 0?c:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${l}; for="${h}"; options=${u};`),l==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};const ev=new RegExp("[,()]");var Vl=class extends YE{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}regexMatch(e,t){return this.url.searchParams.append(e,`match.${t}`),this}regexIMatch(e,t){return this.url.searchParams.append(e,`imatch.${t}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}isDistinct(e,t){return this.url.searchParams.append(e,`isdistinct.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map(a=>typeof a=="string"&&ev.test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}notIn(e,t){const r=Array.from(new Set(t)).map(a=>typeof a=="string"&&ev.test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(e,`not.in.(${r})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:a}={}){let s="";a==="plain"?s="pl":a==="phrase"?s="ph":a==="websearch"&&(s="w");const l=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${s}fts${l}.${t}`),this}match(e){return Object.entries(e).forEach(([t,r])=>{this.url.searchParams.append(t,`eq.${r}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const a=r?`${r}.or`:"or";return this.url.searchParams.append(a,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}},JE=class{constructor(e,{headers:t={},schema:r,fetch:a}){this.url=e,this.headers=new Headers(t),this.schema=r,this.fetch=a}select(e,t){const{head:r=!1,count:a}=t??{},s=r?"HEAD":"GET";let l=!1;const c=(e??"*").split("").map(u=>/\s/.test(u)&&!l?"":(u==='"'&&(l=!l),u)).join("");return this.url.searchParams.set("select",c),a&&this.headers.append("Prefer",`count=${a}`),new Vl({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(e,{count:t,defaultToNull:r=!0}={}){var a;const s="POST";if(t&&this.headers.append("Prefer",`count=${t}`),r||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const l=e.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(l.length>0){const c=[...new Set(l)].map(u=>`"${u}"`);this.url.searchParams.set("columns",c.join(","))}}return new Vl({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:a,defaultToNull:s=!0}={}){var l;const c="POST";if(this.headers.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),t!==void 0&&this.url.searchParams.set("on_conflict",t),a&&this.headers.append("Prefer",`count=${a}`),s||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const u=e.reduce((h,d)=>h.concat(Object.keys(d)),[]);if(u.length>0){const h=[...new Set(u)].map(d=>`"${d}"`);this.url.searchParams.set("columns",h.join(","))}}return new Vl({method:c,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}update(e,{count:t}={}){var r;const a="PATCH";return t&&this.headers.append("Prefer",`count=${t}`),new Vl({method:a,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:e}={}){var t;const r="DELETE";return e&&this.headers.append("Prefer",`count=${e}`),new Vl({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}},QE=class Py{constructor(t,{headers:r={},schema:a,fetch:s}={}){this.url=t,this.headers=new Headers(r),this.schemaName=a,this.fetch=s}from(t){if(!t||typeof t!="string"||t.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new JE(new URL(`${this.url}/${t}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new Py(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:a=!1,get:s=!1,count:l}={}){var c;let u;const h=new URL(`${this.url}/rpc/${t}`);let d;a||s?(u=a?"HEAD":"GET",Object.entries(r).filter(([x,v])=>v!==void 0).map(([x,v])=>[x,Array.isArray(v)?`{${v.join(",")}}`:`${v}`]).forEach(([x,v])=>{h.searchParams.append(x,v)})):(u="POST",d=r);const g=new Headers(this.headers);return l&&g.set("Prefer",`count=${l}`),new Vl({method:u,url:h,headers:g,schema:this.schemaName,body:d,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}};class ZE{constructor(){}static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const a=r.node,s=parseInt(a.replace(/^v/,"").split(".")[0]);return s>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${s} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const a=this.getWebSocketConstructor();return new a(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const eT="2.89.0",tT=`realtime-js/${eT}`,zy="1.0.0",rT="2.0.0",tv=zy,Ud=1e4,aT=1e3,nT=100;var Ys;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(Ys||(Ys={}));var jr;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(jr||(jr={}));var En;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(En||(En={}));var Pd;(function(e){e.websocket="websocket"})(Pd||(Pd={}));var Ri;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Ri||(Ri={}));class sT{constructor(t){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=t??[]}encode(t,r){if(t.event===this.BROADCAST_EVENT&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(t));let a=[t.join_ref,t.ref,t.topic,t.event,t.payload];return r(JSON.stringify(a))}_binaryEncodeUserBroadcastPush(t){var r;return this._isArrayBuffer((r=t.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var r,a;const s=(a=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&a!==void 0?a:new ArrayBuffer(0);return this._encodeUserBroadcastPush(t,this.BINARY_ENCODING,s)}_encodeJsonUserBroadcastPush(t){var r,a;const s=(a=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&a!==void 0?a:{},c=new TextEncoder().encode(JSON.stringify(s)).buffer;return this._encodeUserBroadcastPush(t,this.JSON_ENCODING,c)}_encodeUserBroadcastPush(t,r,a){var s,l;const c=t.topic,u=(s=t.ref)!==null&&s!==void 0?s:"",h=(l=t.join_ref)!==null&&l!==void 0?l:"",d=t.payload.event,g=this.allowedMetadataKeys?this._pick(t.payload,this.allowedMetadataKeys):{},x=Object.keys(g).length===0?"":JSON.stringify(g);if(h.length>255)throw new Error(`joinRef length ${h.length} exceeds maximum of 255`);if(u.length>255)throw new Error(`ref length ${u.length} exceeds maximum of 255`);if(c.length>255)throw new Error(`topic length ${c.length} exceeds maximum of 255`);if(d.length>255)throw new Error(`userEvent length ${d.length} exceeds maximum of 255`);if(x.length>255)throw new Error(`metadata length ${x.length} exceeds maximum of 255`);const v=this.USER_BROADCAST_PUSH_META_LENGTH+h.length+u.length+c.length+d.length+x.length,_=new ArrayBuffer(this.HEADER_LENGTH+v);let b=new DataView(_),y=0;b.setUint8(y++,this.KINDS.userBroadcastPush),b.setUint8(y++,h.length),b.setUint8(y++,u.length),b.setUint8(y++,c.length),b.setUint8(y++,d.length),b.setUint8(y++,x.length),b.setUint8(y++,r),Array.from(h,k=>b.setUint8(y++,k.charCodeAt(0))),Array.from(u,k=>b.setUint8(y++,k.charCodeAt(0))),Array.from(c,k=>b.setUint8(y++,k.charCodeAt(0))),Array.from(d,k=>b.setUint8(y++,k.charCodeAt(0))),Array.from(x,k=>b.setUint8(y++,k.charCodeAt(0)));var S=new Uint8Array(_.byteLength+a.byteLength);return S.set(new Uint8Array(_),0),S.set(new Uint8Array(a),_.byteLength),S.buffer}decode(t,r){if(this._isArrayBuffer(t)){let a=this._binaryDecode(t);return r(a)}if(typeof t=="string"){const a=JSON.parse(t),[s,l,c,u,h]=a;return r({join_ref:s,ref:l,topic:c,event:u,payload:h})}return r({})}_binaryDecode(t){const r=new DataView(t),a=r.getUint8(0),s=new TextDecoder;if(a===this.KINDS.userBroadcast)return this._decodeUserBroadcast(t,r,s)}_decodeUserBroadcast(t,r,a){const s=r.getUint8(1),l=r.getUint8(2),c=r.getUint8(3),u=r.getUint8(4);let h=this.HEADER_LENGTH+4;const d=a.decode(t.slice(h,h+s));h=h+s;const g=a.decode(t.slice(h,h+l));h=h+l;const x=a.decode(t.slice(h,h+c));h=h+c;const v=t.slice(h,t.byteLength),_=u===this.JSON_ENCODING?JSON.parse(a.decode(v)):v,b={type:this.BROADCAST_EVENT,event:g,payload:_};return c>0&&(b.meta=JSON.parse(x)),{join_ref:null,ref:null,topic:d,event:this.BROADCAST_EVENT,payload:b}}_isArrayBuffer(t){var r;return t instanceof ArrayBuffer||((r=t?.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(t,r){return!t||typeof t!="object"?{}:Object.fromEntries(Object.entries(t).filter(([a])=>r.includes(a)))}}class Hy{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var tr;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(tr||(tr={}));const rv=(e,t,r={})=>{var a;const s=(a=r.skipTypes)!==null&&a!==void 0?a:[];return t?Object.keys(t).reduce((l,c)=>(l[c]=iT(c,e,t,s),l),{}):{}},iT=(e,t,r,a)=>{const s=t.find(u=>u.name===e),l=s?.type,c=r[e];return l&&!a.includes(l)?$y(l,c):zd(c)},$y=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return uT(t,r)}switch(e){case tr.bool:return lT(t);case tr.float4:case tr.float8:case tr.int2:case tr.int4:case tr.int8:case tr.numeric:case tr.oid:return oT(t);case tr.json:case tr.jsonb:return cT(t);case tr.timestamp:return fT(t);case tr.abstime:case tr.date:case tr.daterange:case tr.int4range:case tr.int8range:case tr.money:case tr.reltime:case tr.text:case tr.time:case tr.timestamptz:case tr.timetz:case tr.tsrange:case tr.tstzrange:return zd(t);default:return zd(t)}},zd=e=>e,lT=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},oT=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},cT=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e},uT=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,a=e[r];if(e[0]==="{"&&a==="}"){let l;const c=e.slice(1,r);try{l=JSON.parse("["+c+"]")}catch{l=c?c.split(","):[]}return l.map(u=>$y(t,u))}return e},fT=e=>typeof e=="string"?e.replace(" ","T"):e,Vy=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class md{constructor(t,r,a={},s=Ud){this.channel=t,this.event=r,this.payload=a,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var a;return this._hasReceived(t)&&r((a=this.receivedResp)===null||a===void 0?void 0:a.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(a=>a.status===t).forEach(a=>a.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var av;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(av||(av={}));class fc{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const a=r?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(a.state,{},s=>{const{onJoin:l,onLeave:c,onSync:u}=this.caller;this.joinRef=this.channel._joinRef(),this.state=fc.syncState(this.state,s,l,c),this.pendingDiffs.forEach(h=>{this.state=fc.syncDiff(this.state,h,l,c)}),this.pendingDiffs=[],u()}),this.channel._on(a.diff,{},s=>{const{onJoin:l,onLeave:c,onSync:u}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=fc.syncDiff(this.state,s,l,c),u())}),this.onJoin((s,l,c)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:l,newPresences:c})}),this.onLeave((s,l,c)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:l,leftPresences:c})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,a,s){const l=this.cloneDeep(t),c=this.transformState(r),u={},h={};return this.map(l,(d,g)=>{c[d]||(h[d]=g)}),this.map(c,(d,g)=>{const x=l[d];if(x){const v=g.map(S=>S.presence_ref),_=x.map(S=>S.presence_ref),b=g.filter(S=>_.indexOf(S.presence_ref)<0),y=x.filter(S=>v.indexOf(S.presence_ref)<0);b.length>0&&(u[d]=b),y.length>0&&(h[d]=y)}else u[d]=g}),this.syncDiff(l,{joins:u,leaves:h},a,s)}static syncDiff(t,r,a,s){const{joins:l,leaves:c}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return a||(a=()=>{}),s||(s=()=>{}),this.map(l,(u,h)=>{var d;const g=(d=t[u])!==null&&d!==void 0?d:[];if(t[u]=this.cloneDeep(h),g.length>0){const x=t[u].map(_=>_.presence_ref),v=g.filter(_=>x.indexOf(_.presence_ref)<0);t[u].unshift(...v)}a(u,g,h)}),this.map(c,(u,h)=>{let d=t[u];if(!d)return;const g=h.map(x=>x.presence_ref);d=d.filter(x=>g.indexOf(x.presence_ref)<0),t[u]=d,s(u,d,h),d.length===0&&delete t[u]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(a=>r(a,t[a]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,a)=>{const s=t[a];return"metas"in s?r[a]=s.metas.map(l=>(l.presence_ref=l.phx_ref,delete l.phx_ref,delete l.phx_ref_prev,l)):r[a]=s,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var nv;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(nv||(nv={}));var hc;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(hc||(hc={}));var os;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(os||(os={}));class Wl{constructor(t,r={config:{}},a){var s,l;if(this.topic=t,this.params=r,this.socket=a,this.bindings={},this.state=jr.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new md(this,En.join,this.params,this.timeout),this.rejoinTimer=new Hy(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=jr.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(c=>c.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=jr.closed,this.socket._remove(this)}),this._onError(c=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,c),this.state=jr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=jr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",c=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,c),this.state=jr.errored,this.rejoinTimer.scheduleTimeout())}),this._on(En.reply,{},(c,u)=>{this._trigger(this._replyEventName(u),c)}),this.presence=new fc(this),this.broadcastEndpointURL=Vy(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((l=(s=this.params.config)===null||s===void 0?void 0:s.broadcast)===null||l===void 0)&&l.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var a,s,l;if(this.socket.isConnected()||this.socket.connect(),this.state==jr.closed){const{config:{broadcast:c,presence:u,private:h}}=this.params,d=(s=(a=this.bindings.postgres_changes)===null||a===void 0?void 0:a.map(_=>_.filter))!==null&&s!==void 0?s:[],g=!!this.bindings[hc.PRESENCE]&&this.bindings[hc.PRESENCE].length>0||((l=this.params.config.presence)===null||l===void 0?void 0:l.enabled)===!0,x={},v={broadcast:c,presence:Object.assign(Object.assign({},u),{enabled:g}),postgres_changes:d,private:h};this.socket.accessTokenValue&&(x.access_token=this.socket.accessTokenValue),this._onError(_=>t?.(os.CHANNEL_ERROR,_)),this._onClose(()=>t?.(os.CLOSED)),this.updateJoinPayload(Object.assign({config:v},x)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:_})=>{var b;if(this.socket._isManualToken()||this.socket.setAuth(),_===void 0){t?.(os.SUBSCRIBED);return}else{const y=this.bindings.postgres_changes,S=(b=y?.length)!==null&&b!==void 0?b:0,k=[];for(let O=0;O<S;O++){const T=y[O],{filter:{event:j,schema:X,table:I,filter:C}}=T,K=_&&_[O];if(K&&K.event===j&&Wl.isFilterValueEqual(K.schema,X)&&Wl.isFilterValueEqual(K.table,I)&&Wl.isFilterValueEqual(K.filter,C))k.push(Object.assign(Object.assign({},T),{id:K.id}));else{this.unsubscribe(),this.state=jr.errored,t?.(os.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=k,t&&t(os.SUBSCRIBED);return}}).receive("error",_=>{this.state=jr.errored,t?.(os.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(_).join(", ")||"error")))}).receive("timeout",()=>{t?.(os.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,a){return this.state===jr.joined&&t===hc.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(t,r,a)}async httpSend(t,r,a={}){var s;if(r==null)return Promise.reject("Payload is required for httpSend()");const l={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(l.Authorization=`Bearer ${this.socket.accessTokenValue}`);const c={method:"POST",headers:l,body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:r,private:this.private}]})},u=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(s=a.timeout)!==null&&s!==void 0?s:this.timeout);if(u.status===202)return{success:!0};let h=u.statusText;try{const d=await u.json();h=d.error||d.message||h}catch{}return Promise.reject(new Error(h))}async send(t,r={}){var a,s;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:l,payload:c}=t,u={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(u.Authorization=`Bearer ${this.socket.accessTokenValue}`);const h={method:"POST",headers:u,body:JSON.stringify({messages:[{topic:this.subTopic,event:l,payload:c,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,h,(a=r.timeout)!==null&&a!==void 0?a:this.timeout);return await((s=d.body)===null||s===void 0?void 0:s.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(l=>{var c,u,h;const d=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((h=(u=(c=this.params)===null||c===void 0?void 0:c.config)===null||u===void 0?void 0:u.broadcast)===null||h===void 0)&&h.ack)&&l("ok"),d.receive("ok",()=>l("ok")),d.receive("error",()=>l("error")),d.receive("timeout",()=>l("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=jr.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(En.close,"leave",this._joinRef())};this.joinPush.destroy();let a=null;return new Promise(s=>{a=new md(this,En.leave,{},t),a.receive("ok",()=>{r(),s("ok")}).receive("timeout",()=>{r(),s("timed out")}).receive("error",()=>{s("error")}),a.send(),this._canPush()||a.trigger("ok",{})}).finally(()=>{a?.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=jr.closed,this.bindings={}}async _fetchWithTimeout(t,r,a){const s=new AbortController,l=setTimeout(()=>s.abort(),a),c=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:s.signal}));return clearTimeout(l),c}_push(t,r,a=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new md(this,t,r,a);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>nT){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,a){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,a){var s,l;const c=t.toLocaleLowerCase(),{close:u,error:h,leave:d,join:g}=En;if(a&&[u,h,d,g].indexOf(c)>=0&&a!==this._joinRef())return;let v=this._onMessage(c,r,a);if(r&&!v)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(c)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(_=>{var b,y,S;return((b=_.filter)===null||b===void 0?void 0:b.event)==="*"||((S=(y=_.filter)===null||y===void 0?void 0:y.event)===null||S===void 0?void 0:S.toLocaleLowerCase())===c}).map(_=>_.callback(v,a)):(l=this.bindings[c])===null||l===void 0||l.filter(_=>{var b,y,S,k,O,T;if(["broadcast","presence","postgres_changes"].includes(c))if("id"in _){const j=_.id,X=(b=_.filter)===null||b===void 0?void 0:b.event;return j&&((y=r.ids)===null||y===void 0?void 0:y.includes(j))&&(X==="*"||X?.toLocaleLowerCase()===((S=r.data)===null||S===void 0?void 0:S.type.toLocaleLowerCase()))}else{const j=(O=(k=_?.filter)===null||k===void 0?void 0:k.event)===null||O===void 0?void 0:O.toLocaleLowerCase();return j==="*"||j===((T=r?.event)===null||T===void 0?void 0:T.toLocaleLowerCase())}else return _.type.toLocaleLowerCase()===c}).map(_=>{if(typeof v=="object"&&"ids"in v){const b=v.data,{schema:y,table:S,commit_timestamp:k,type:O,errors:T}=b;v=Object.assign(Object.assign({},{schema:y,table:S,commit_timestamp:k,eventType:O,new:{},old:{},errors:T}),this._getPayloadRecords(b))}_.callback(v,a)})}_isClosed(){return this.state===jr.closed}_isJoined(){return this.state===jr.joined}_isJoining(){return this.state===jr.joining}_isLeaving(){return this.state===jr.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,a){const s=t.toLocaleLowerCase(),l={type:s,filter:r,callback:a};return this.bindings[s]?this.bindings[s].push(l):this.bindings[s]=[l],this}_off(t,r){const a=t.toLocaleLowerCase();return this.bindings[a]&&(this.bindings[a]=this.bindings[a].filter(s=>{var l;return!(((l=s.type)===null||l===void 0?void 0:l.toLocaleLowerCase())===a&&Wl.isEqual(s.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const a in t)if(t[a]!==r[a])return!1;return!0}static isFilterValueEqual(t,r){return(t??void 0)===(r??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(En.close,{},t)}_onError(t){this._on(En.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=jr.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=rv(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=rv(t.columns,t.old_record)),r}}const gd=()=>{},cu={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},hT=[1e3,2e3,5e3,1e4],dT=1e4,mT=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class gT{constructor(t,r){var a;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Ud,this.transport=null,this.heartbeatIntervalMs=cu.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=gd,this.ref=0,this.reconnectTimer=null,this.vsn=tv,this.logger=gd,this.conn=null,this.sendBuffer=[],this.serializer=new sT,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=s=>s?(...l)=>s(...l):(...l)=>fetch(...l),!(!((a=r?.params)===null||a===void 0)&&a.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${Pd.websocket}`,this.httpEndpoint=Vy(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=ZE.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const a=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(a),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,a){this.logger(t,r,a)}connectionState(){switch(this.conn&&this.conn.readyState){case Ys.connecting:return Ri.Connecting;case Ys.open:return Ri.Open;case Ys.closing:return Ri.Closing;default:return Ri.Closed}}isConnected(){return this.connectionState()===Ri.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const a=`realtime:${t}`,s=this.getChannels().find(l=>l.topic===a);if(s)return s;{const l=new Wl(`realtime:${t}`,r,this);return this.channels.push(l),l}}push(t){const{topic:r,event:a,payload:s,ref:l}=t,c=()=>{this.encode(t,u=>{var h;(h=this.conn)===null||h===void 0||h.send(u)})};this.log("push",`${r} ${a} (${l})`,s),this.isConnected()?c():this.sendBuffer.push(c)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(aT,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},cu.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(a=>a.topic===t&&(a._isJoined()||a._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(d){this.log("error","error in heartbeat callback",d)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:a,event:s,payload:l,ref:c}=r,u=c?`(${c})`:"",h=l.status||"";this.log("receive",`${h} ${a} ${s} ${u}`.trim(),l),this.channels.filter(d=>d._isMember(a)).forEach(d=>d._trigger(s,l,c)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t),this.conn.readyState===Ys.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===Ys.open||this.conn.readyState===Ys.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this._terminateWorker()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(En.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const a=t.match(/\?/)?"&":"?",s=new URLSearchParams(r);return`${t}${a}${s}`}_workerObjectUrl(t){let r;if(t)r=t;else{const a=new Blob([mT],{type:"application/javascript"});r=URL.createObjectURL(a)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r,a=!1;if(t)r=t,a=!0;else if(this.accessToken)try{r=await this.accessToken()}catch(s){this.log("error","Error fetching access token from callback",s),r=this.accessTokenValue}else r=this.accessTokenValue;a?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(s=>{const l={access_token:r,version:tT};r&&s.updateJoinPayload(l),s.joinedOnce&&s._isJoined()&&s._push(En.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this._isManualToken()||this.setAuth().catch(r=>{this.log("error",`Error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(a=>{try{a(r)}catch(s){this.log("error",`error in ${t} callback`,s)}})}catch(a){this.log("error",`error triggering ${t} callbacks`,a)}}_setupReconnectionTimer(){this.reconnectTimer=new Hy(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},cu.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,a,s,l,c,u,h,d,g,x,v,_;switch(this.transport=(r=t?.transport)!==null&&r!==void 0?r:null,this.timeout=(a=t?.timeout)!==null&&a!==void 0?a:Ud,this.heartbeatIntervalMs=(s=t?.heartbeatIntervalMs)!==null&&s!==void 0?s:cu.HEARTBEAT_INTERVAL,this.worker=(l=t?.worker)!==null&&l!==void 0?l:!1,this.accessToken=(c=t?.accessToken)!==null&&c!==void 0?c:null,this.heartbeatCallback=(u=t?.heartbeatCallback)!==null&&u!==void 0?u:gd,this.vsn=(h=t?.vsn)!==null&&h!==void 0?h:tv,t?.params&&(this.params=t.params),t?.logger&&(this.logger=t.logger),(t?.logLevel||t?.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(d=t?.reconnectAfterMs)!==null&&d!==void 0?d:(b=>hT[b-1]||dT),this.vsn){case zy:this.encode=(g=t?.encode)!==null&&g!==void 0?g:((b,y)=>y(JSON.stringify(b))),this.decode=(x=t?.decode)!==null&&x!==void 0?x:((b,y)=>y(JSON.parse(b)));break;case rT:this.encode=(v=t?.encode)!==null&&v!==void 0?v:this.serializer.encode.bind(this.serializer),this.decode=(_=t?.decode)!==null&&_!==void 0?_:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t?.workerUrl}}}var wc=class extends Error{constructor(e,t){super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown=t.icebergType==="CommitStateUnknownException"||[500,502,504].includes(t.status)&&t.icebergType?.includes("CommitState")===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function pT(e,t,r){const a=new URL(t,e);if(r)for(const[s,l]of Object.entries(r))l!==void 0&&a.searchParams.set(s,l);return a.toString()}async function xT(e){return!e||e.type==="none"?{}:e.type==="bearer"?{Authorization:`Bearer ${e.token}`}:e.type==="header"?{[e.name]:e.value}:e.type==="custom"?await e.getHeaders():{}}function vT(e){const t=e.fetchImpl??globalThis.fetch;return{async request({method:r,path:a,query:s,body:l,headers:c}){const u=pT(e.baseUrl,a,s),h=await xT(e.auth),d=await t(u,{method:r,headers:{...l?{"Content-Type":"application/json"}:{},...h,...c},body:l?JSON.stringify(l):void 0}),g=await d.text(),x=(d.headers.get("content-type")||"").includes("application/json"),v=x&&g?JSON.parse(g):g;if(!d.ok){const _=x?v:void 0,b=_?.error;throw new wc(b?.message??`Request failed with status ${d.status}`,{status:d.status,icebergType:b?.type,icebergCode:b?.code,details:_})}return{status:d.status,headers:d.headers,data:v}}}}function uu(e){return e.join("")}var yT=class{constructor(e,t=""){this.client=e,this.prefix=t}async listNamespaces(e){const t=e?{parent:uu(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(a=>({namespace:a}))}async createNamespace(e,t){const r={namespace:e.namespace,properties:t?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${uu(e.namespace)}`})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${uu(e.namespace)}`})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${uu(e.namespace)}`}),!0}catch(t){if(t instanceof wc&&t.status===404)return!1;throw t}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(r){if(r instanceof wc&&r.status===409)return;throw r}}};function Ll(e){return e.join("")}var _T=class{constructor(e,t="",r){this.client=e,this.prefix=t,this.accessDelegation=r}async listTables(e){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Ll(e.namespace)}/tables`})).data.identifiers}async createTable(e,t){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Ll(e.namespace)}/tables`,body:t,headers:r})).data.metadata}async updateTable(e,t){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Ll(e.namespace)}/tables/${e.name}`,body:t});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(e,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Ll(e.namespace)}/tables/${e.name}`,query:{purgeRequested:String(t?.purge??!1)}})}async loadTable(e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Ll(e.namespace)}/tables/${e.name}`,headers:t})).data.metadata}async tableExists(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Ll(e.namespace)}/tables/${e.name}`,headers:t}),!0}catch(r){if(r instanceof wc&&r.status===404)return!1;throw r}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(r){if(r instanceof wc&&r.status===409)return await this.loadTable({namespace:e.namespace,name:t.name});throw r}}},wT=class{constructor(e){let t="v1";e.catalogName&&(t+=`/${e.catalogName}`);const r=e.baseUrl.endsWith("/")?e.baseUrl:`${e.baseUrl}/`;this.client=vT({baseUrl:r,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=e.accessDelegation?.join(","),this.namespaceOps=new yT(this.client,t),this.tableOps=new _T(this.client,t,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}},qu=class extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}};function fr(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}var bT=class extends qu{constructor(e,t,r){super(e),this.name="StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Hd=class extends qu{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}};const fm=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),ST=()=>Response,$d=e=>{if(Array.isArray(e))return e.map(r=>$d(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,a])=>{const s=r.replace(/([-_][a-z])/gi,l=>l.toUpperCase().replace(/[-_]/g,""));t[s]=$d(a)}),t},ET=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},TT=e=>!e||typeof e!="string"||e.length===0||e.length>100||e.trim()!==e||e.includes("/")||e.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(e);function bc(e){"@babel/helpers - typeof";return bc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bc(e)}function kT(e,t){if(bc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(bc(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function AT(e){var t=kT(e,"string");return bc(t)=="symbol"?t:t+""}function CT(e,t,r){return(t=AT(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sv(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function ot(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?sv(Object(r),!0).forEach(function(a){CT(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sv(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}const pd=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},NT=async(e,t,r)=>{e instanceof await ST()&&!r?.noResolveJson?e.json().then(a=>{const s=e.status||500,l=a?.statusCode||s+"";t(new bT(pd(a),s,l))}).catch(a=>{t(new Hd(pd(a),a))}):t(new Hd(pd(e),e))},OT=(e,t,r,a)=>{const s={method:e,headers:t?.headers||{}};return e==="GET"||!a?s:(ET(a)?(s.headers=ot({"Content-Type":"application/json"},t?.headers),s.body=JSON.stringify(a)):s.body=a,t?.duplex&&(s.duplex=t.duplex),ot(ot({},s),r))};async function $c(e,t,r,a,s,l){return new Promise((c,u)=>{e(r,OT(t,a,s,l)).then(h=>{if(!h.ok)throw h;return a?.noResolveJson?h:h.json()}).then(h=>c(h)).catch(h=>NT(h,u,a))})}async function Sc(e,t,r,a){return $c(e,"GET",t,r,a)}async function Sn(e,t,r,a,s){return $c(e,"POST",t,a,s,r)}async function Vd(e,t,r,a,s){return $c(e,"PUT",t,a,s,r)}async function RT(e,t,r,a){return $c(e,"HEAD",t,ot(ot({},r),{},{noResolveJson:!0}),a)}async function hm(e,t,r,a,s){return $c(e,"DELETE",t,a,s,r)}var DT=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}async execute(){var e=this;try{return{data:(await e.downloadFn()).body,error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(fr(t))return{data:null,error:t};throw t}}};let Gy;Gy=Symbol.toStringTag;var FT=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[Gy]="BlobDownloadBuilder",this.promise=null}asStream(){return new DT(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var e=this;try{return{data:await(await e.downloadFn()).blob(),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(fr(t))return{data:null,error:t};throw t}}};const MT={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},iv={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var LT=class{constructor(e,t={},r,a){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=r,this.fetch=fm(a)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(e,t,r,a){var s=this;try{let l;const c=ot(ot({},iv),a);let u=ot(ot({},s.headers),e==="POST"&&{"x-upsert":String(c.upsert)});const h=c.metadata;typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),h&&l.append("metadata",s.encodeMetadata(h)),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.has("cacheControl")||l.append("cacheControl",c.cacheControl),h&&!l.has("metadata")&&l.append("metadata",s.encodeMetadata(h))):(l=r,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType,h&&(u["x-metadata"]=s.toBase64(s.encodeMetadata(h))),(typeof ReadableStream<"u"&&l instanceof ReadableStream||l&&typeof l=="object"&&"pipe"in l&&typeof l.pipe=="function")&&!c.duplex&&(c.duplex="half")),a?.headers&&(u=ot(ot({},u),a.headers));const d=s._removeEmptyFolders(t),g=s._getFinalPath(d),x=await(e=="PUT"?Vd:Sn)(s.fetch,`${s.url}/object/${g}`,l,ot({headers:u},c?.duplex?{duplex:c.duplex}:{}));return{data:{path:d,id:x.Id,fullPath:x.Key},error:null}}catch(l){if(s.shouldThrowOnError)throw l;if(fr(l))return{data:null,error:l};throw l}}async upload(e,t,r){return this.uploadOrUpdate("POST",e,t,r)}async uploadToSignedUrl(e,t,r,a){var s=this;const l=s._removeEmptyFolders(e),c=s._getFinalPath(l),u=new URL(s.url+`/object/upload/sign/${c}`);u.searchParams.set("token",t);try{let h;const d=ot({upsert:iv.upsert},a),g=ot(ot({},s.headers),{"x-upsert":String(d.upsert)});return typeof Blob<"u"&&r instanceof Blob?(h=new FormData,h.append("cacheControl",d.cacheControl),h.append("",r)):typeof FormData<"u"&&r instanceof FormData?(h=r,h.append("cacheControl",d.cacheControl)):(h=r,g["cache-control"]=`max-age=${d.cacheControl}`,g["content-type"]=d.contentType),{data:{path:l,fullPath:(await Vd(s.fetch,u.toString(),h,{headers:g})).Key},error:null}}catch(h){if(s.shouldThrowOnError)throw h;if(fr(h))return{data:null,error:h};throw h}}async createSignedUploadUrl(e,t){var r=this;try{let a=r._getFinalPath(e);const s=ot({},r.headers);t?.upsert&&(s["x-upsert"]="true");const l=await Sn(r.fetch,`${r.url}/object/upload/sign/${a}`,{},{headers:s}),c=new URL(r.url+l.url),u=c.searchParams.get("token");if(!u)throw new qu("No token returned by API");return{data:{signedUrl:c.toString(),path:e,token:u},error:null}}catch(a){if(r.shouldThrowOnError)throw a;if(fr(a))return{data:null,error:a};throw a}}async update(e,t,r){return this.uploadOrUpdate("PUT",e,t,r)}async move(e,t,r){var a=this;try{return{data:await Sn(a.fetch,`${a.url}/object/move`,{bucketId:a.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r?.destinationBucket},{headers:a.headers}),error:null}}catch(s){if(a.shouldThrowOnError)throw s;if(fr(s))return{data:null,error:s};throw s}}async copy(e,t,r){var a=this;try{return{data:{path:(await Sn(a.fetch,`${a.url}/object/copy`,{bucketId:a.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r?.destinationBucket},{headers:a.headers})).Key},error:null}}catch(s){if(a.shouldThrowOnError)throw s;if(fr(s))return{data:null,error:s};throw s}}async createSignedUrl(e,t,r){var a=this;try{let s=a._getFinalPath(e),l=await Sn(a.fetch,`${a.url}/object/sign/${s}`,ot({expiresIn:t},r?.transform?{transform:r.transform}:{}),{headers:a.headers});const c=r?.download?`&download=${r.download===!0?"":r.download}`:"";return l={signedUrl:encodeURI(`${a.url}${l.signedURL}${c}`)},{data:l,error:null}}catch(s){if(a.shouldThrowOnError)throw s;if(fr(s))return{data:null,error:s};throw s}}async createSignedUrls(e,t,r){var a=this;try{const s=await Sn(a.fetch,`${a.url}/object/sign/${a.bucketId}`,{expiresIn:t,paths:e},{headers:a.headers}),l=r?.download?`&download=${r.download===!0?"":r.download}`:"";return{data:s.map(c=>ot(ot({},c),{},{signedUrl:c.signedURL?encodeURI(`${a.url}${c.signedURL}${l}`):null})),error:null}}catch(s){if(a.shouldThrowOnError)throw s;if(fr(s))return{data:null,error:s};throw s}}download(e,t){const r=typeof t?.transform<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString(t?.transform||{}),s=a?`?${a}`:"",l=this._getFinalPath(e),c=()=>Sc(this.fetch,`${this.url}/${r}/${l}${s}`,{headers:this.headers,noResolveJson:!0});return new FT(c,this.shouldThrowOnError)}async info(e){var t=this;const r=t._getFinalPath(e);try{return{data:$d(await Sc(t.fetch,`${t.url}/object/info/${r}`,{headers:t.headers})),error:null}}catch(a){if(t.shouldThrowOnError)throw a;if(fr(a))return{data:null,error:a};throw a}}async exists(e){var t=this;const r=t._getFinalPath(e);try{return await RT(t.fetch,`${t.url}/object/${r}`,{headers:t.headers}),{data:!0,error:null}}catch(a){if(t.shouldThrowOnError)throw a;if(fr(a)&&a instanceof Hd){const s=a.originalError;if([400,404].includes(s?.status))return{data:!1,error:a}}throw a}}getPublicUrl(e,t){const r=this._getFinalPath(e),a=[],s=t?.download?`download=${t.download===!0?"":t.download}`:"";s!==""&&a.push(s);const l=typeof t?.transform<"u"?"render/image":"object",c=this.transformOptsToQueryString(t?.transform||{});c!==""&&a.push(c);let u=a.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${r}${u}`)}}}async remove(e){var t=this;try{return{data:await hm(t.fetch,`${t.url}/object/${t.bucketId}`,{prefixes:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(fr(r))return{data:null,error:r};throw r}}async list(e,t,r){var a=this;try{const s=ot(ot(ot({},MT),t),{},{prefix:e||""});return{data:await Sn(a.fetch,`${a.url}/object/list/${a.bucketId}`,s,{headers:a.headers},r),error:null}}catch(s){if(a.shouldThrowOnError)throw s;if(fr(s))return{data:null,error:s};throw s}}async listV2(e,t){var r=this;try{const a=ot({},e);return{data:await Sn(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,a,{headers:r.headers},t),error:null}}catch(a){if(r.shouldThrowOnError)throw a;if(fr(a))return{data:null,error:a};throw a}}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}};const qy="2.89.0",Xy={"X-Client-Info":`storage-js/${qy}`};var IT=class{constructor(e,t={},r,a){this.shouldThrowOnError=!1;const s=new URL(e);a?.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase.")),this.url=s.href.replace(/\/$/,""),this.headers=ot(ot({},Xy),t),this.fetch=fm(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(e){var t=this;try{const r=t.listBucketOptionsToQueryString(e);return{data:await Sc(t.fetch,`${t.url}/bucket${r}`,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(fr(r))return{data:null,error:r};throw r}}async getBucket(e){var t=this;try{return{data:await Sc(t.fetch,`${t.url}/bucket/${e}`,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(fr(r))return{data:null,error:r};throw r}}async createBucket(e,t={public:!1}){var r=this;try{return{data:await Sn(r.fetch,`${r.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}),error:null}}catch(a){if(r.shouldThrowOnError)throw a;if(fr(a))return{data:null,error:a};throw a}}async updateBucket(e,t){var r=this;try{return{data:await Vd(r.fetch,`${r.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}),error:null}}catch(a){if(r.shouldThrowOnError)throw a;if(fr(a))return{data:null,error:a};throw a}}async emptyBucket(e){var t=this;try{return{data:await Sn(t.fetch,`${t.url}/bucket/${e}/empty`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(fr(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await hm(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(fr(r))return{data:null,error:r};throw r}}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}},BT=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=ot(ot({},Xy),t),this.fetch=fm(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var t=this;try{return{data:await Sn(t.fetch,`${t.url}/bucket`,{name:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(fr(r))return{data:null,error:r};throw r}}async listBuckets(e){var t=this;try{const r=new URLSearchParams;e?.limit!==void 0&&r.set("limit",e.limit.toString()),e?.offset!==void 0&&r.set("offset",e.offset.toString()),e?.sortColumn&&r.set("sortColumn",e.sortColumn),e?.sortOrder&&r.set("sortOrder",e.sortOrder),e?.search&&r.set("search",e.search);const a=r.toString(),s=a?`${t.url}/bucket?${a}`:`${t.url}/bucket`;return{data:await Sc(t.fetch,s,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(fr(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await hm(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(fr(r))return{data:null,error:r};throw r}}from(e){var t=this;if(!TT(e))throw new qu("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new wT({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:async()=>t.headers},fetch:this.fetch}),a=this.shouldThrowOnError;return new Proxy(r,{get(s,l){const c=s[l];return typeof c!="function"?c:async(...u)=>{try{return{data:await c.apply(s,u),error:null}}catch(h){if(a)throw h;return{data:null,error:h}}}}})}};const dm={"X-Client-Info":`storage-js/${qy}`,"Content-Type":"application/json"};var Wy=class extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function Ga(e){return typeof e=="object"&&e!==null&&"__isStorageVectorsError"in e}var xd=class extends Wy{constructor(e,t,r){super(e),this.name="StorageVectorsApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},jT=class extends Wy{constructor(e,t){super(e),this.name="StorageVectorsUnknownError",this.originalError=t}};const mm=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),UT=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},lv=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),PT=async(e,t,r)=>{if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!r?.noResolveJson){const a=e.status||500,s=e;if(typeof s.json=="function")s.json().then(l=>{const c=l?.statusCode||l?.code||a+"";t(new xd(lv(l),a,c))}).catch(()=>{const l=a+"";t(new xd(s.statusText||`HTTP ${a} error`,a,l))});else{const l=a+"";t(new xd(s.statusText||`HTTP ${a} error`,a,l))}}else t(new jT(lv(e),e))},zT=(e,t,r,a)=>{const s={method:e,headers:t?.headers||{}};return a?(UT(a)?(s.headers=ot({"Content-Type":"application/json"},t?.headers),s.body=JSON.stringify(a)):s.body=a,ot(ot({},s),r)):s};async function HT(e,t,r,a,s,l){return new Promise((c,u)=>{e(r,zT(t,a,s,l)).then(h=>{if(!h.ok)throw h;if(a?.noResolveJson)return h;const d=h.headers.get("content-type");return!d||!d.includes("application/json")?{}:h.json()}).then(h=>c(h)).catch(h=>PT(h,u,a))})}async function qa(e,t,r,a,s){return HT(e,"POST",t,a,s,r)}var $T=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=ot(ot({},dm),t),this.fetch=mm(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(e){var t=this;try{return{data:await qa(t.fetch,`${t.url}/CreateIndex`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ga(r))return{data:null,error:r};throw r}}async getIndex(e,t){var r=this;try{return{data:await qa(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers}),error:null}}catch(a){if(r.shouldThrowOnError)throw a;if(Ga(a))return{data:null,error:a};throw a}}async listIndexes(e){var t=this;try{return{data:await qa(t.fetch,`${t.url}/ListIndexes`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ga(r))return{data:null,error:r};throw r}}async deleteIndex(e,t){var r=this;try{return{data:await qa(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers})||{},error:null}}catch(a){if(r.shouldThrowOnError)throw a;if(Ga(a))return{data:null,error:a};throw a}}},VT=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=ot(ot({},dm),t),this.fetch=mm(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(e){var t=this;try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await qa(t.fetch,`${t.url}/PutVectors`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ga(r))return{data:null,error:r};throw r}}async getVectors(e){var t=this;try{return{data:await qa(t.fetch,`${t.url}/GetVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ga(r))return{data:null,error:r};throw r}}async listVectors(e){var t=this;try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:await qa(t.fetch,`${t.url}/ListVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ga(r))return{data:null,error:r};throw r}}async queryVectors(e){var t=this;try{return{data:await qa(t.fetch,`${t.url}/QueryVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ga(r))return{data:null,error:r};throw r}}async deleteVectors(e){var t=this;try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await qa(t.fetch,`${t.url}/DeleteVectors`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ga(r))return{data:null,error:r};throw r}}},GT=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=ot(ot({},dm),t),this.fetch=mm(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var t=this;try{return{data:await qa(t.fetch,`${t.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ga(r))return{data:null,error:r};throw r}}async getBucket(e){var t=this;try{return{data:await qa(t.fetch,`${t.url}/GetVectorBucket`,{vectorBucketName:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ga(r))return{data:null,error:r};throw r}}async listBuckets(e={}){var t=this;try{return{data:await qa(t.fetch,`${t.url}/ListVectorBuckets`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ga(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await qa(t.fetch,`${t.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ga(r))return{data:null,error:r};throw r}}},qT=class extends GT{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new XT(this.url,this.headers,e,this.fetch)}async createBucket(e){var t=()=>super.createBucket,r=this;return t().call(r,e)}async getBucket(e){var t=()=>super.getBucket,r=this;return t().call(r,e)}async listBuckets(e={}){var t=()=>super.listBuckets,r=this;return t().call(r,e)}async deleteBucket(e){var t=()=>super.deleteBucket,r=this;return t().call(r,e)}},XT=class extends $T{constructor(e,t,r,a){super(e,t,a),this.vectorBucketName=r}async createIndex(e){var t=()=>super.createIndex,r=this;return t().call(r,ot(ot({},e),{},{vectorBucketName:r.vectorBucketName}))}async listIndexes(e={}){var t=()=>super.listIndexes,r=this;return t().call(r,ot(ot({},e),{},{vectorBucketName:r.vectorBucketName}))}async getIndex(e){var t=()=>super.getIndex,r=this;return t().call(r,r.vectorBucketName,e)}async deleteIndex(e){var t=()=>super.deleteIndex,r=this;return t().call(r,r.vectorBucketName,e)}index(e){return new WT(this.url,this.headers,this.vectorBucketName,e,this.fetch)}},WT=class extends VT{constructor(e,t,r,a,s){super(e,t,s),this.vectorBucketName=r,this.indexName=a}async putVectors(e){var t=()=>super.putVectors,r=this;return t().call(r,ot(ot({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async getVectors(e){var t=()=>super.getVectors,r=this;return t().call(r,ot(ot({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async listVectors(e={}){var t=()=>super.listVectors,r=this;return t().call(r,ot(ot({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async queryVectors(e){var t=()=>super.queryVectors,r=this;return t().call(r,ot(ot({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async deleteVectors(e){var t=()=>super.deleteVectors,r=this;return t().call(r,ot(ot({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}},KT=class extends IT{constructor(e,t={},r,a){super(e,t,r,a)}from(e){return new LT(this.url,this.headers,e,this.fetch)}get vectors(){return new qT(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new BT(this.url+"/iceberg",this.headers,this.fetch)}};const Ky="2.89.0",Gl=30*1e3,Gd=3,vd=Gd*Gl,YT="http://localhost:9999",JT="supabase.auth.token",QT={"X-Client-Info":`gotrue-js/${Ky}`},qd="X-Supabase-Api-Version",Yy={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},ZT=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,e4=600*1e3;class Ec extends Error{constructor(t,r,a){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=a}}function rt(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class t4 extends Ec{constructor(t,r,a){super(t,r,a),this.name="AuthApiError",this.status=r,this.code=a}}function r4(e){return rt(e)&&e.name==="AuthApiError"}class Di extends Ec{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class ms extends Ec{constructor(t,r,a,s){super(t,a,s),this.name=r,this.status=a}}class Ha extends ms{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function a4(e){return rt(e)&&e.name==="AuthSessionMissingError"}class Il extends ms{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class fu extends ms{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class hu extends ms{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function n4(e){return rt(e)&&e.name==="AuthImplicitGrantRedirectError"}class ov extends ms{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class s4 extends ms{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class Xd extends ms{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function yd(e){return rt(e)&&e.name==="AuthRetryableFetchError"}class cv extends ms{constructor(t,r,a){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=a}}class Wd extends ms{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Au="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),uv=` 	
\r=`.split(""),i4=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<uv.length;t+=1)e[uv[t].charCodeAt(0)]=-2;for(let t=0;t<Au.length;t+=1)e[Au[t].charCodeAt(0)]=t;return e})();function fv(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const a=t.queue>>t.queuedBits-6&63;r(Au[a]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const a=t.queue>>t.queuedBits-6&63;r(Au[a]),t.queuedBits-=6}}function Jy(e,t,r){const a=i4[e];if(a>-1)for(t.queue=t.queue<<6|a,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(a===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function hv(e){const t=[],r=c=>{t.push(String.fromCodePoint(c))},a={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},l=c=>{c4(c,a,r)};for(let c=0;c<e.length;c+=1)Jy(e.charCodeAt(c),s,l);return t.join("")}function l4(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function o4(e,t){for(let r=0;r<e.length;r+=1){let a=e.charCodeAt(r);if(a>55295&&a<=56319){const s=(a-55296)*1024&65535;a=(e.charCodeAt(r+1)-56320&65535|s)+65536,r+=1}l4(a,t)}}function c4(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let a=1;a<6;a+=1)if((e>>7-a&1)===0){t.utf8seq=a;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function Yl(e){const t=[],r={queue:0,queuedBits:0},a=s=>{t.push(s)};for(let s=0;s<e.length;s+=1)Jy(e.charCodeAt(s),r,a);return new Uint8Array(t)}function u4(e){const t=[];return o4(e,r=>t.push(r)),new Uint8Array(t)}function Mi(e){const t=[],r={queue:0,queuedBits:0},a=s=>{t.push(s)};return e.forEach(s=>fv(s,r,a)),fv(null,r,a),t.join("")}function f4(e){return Math.round(Date.now()/1e3)+e}function h4(){return Symbol("auth-callback")}const ea=()=>typeof window<"u"&&typeof document<"u",Ci={tested:!1,writable:!1},Qy=()=>{if(!ea())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Ci.tested)return Ci.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Ci.tested=!0,Ci.writable=!0}catch{Ci.tested=!0,Ci.writable=!1}return Ci.writable};function d4(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((s,l)=>{t[l]=s})}catch{}return r.searchParams.forEach((a,s)=>{t[s]=a}),t}const Zy=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),m4=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",ql=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},Ni=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Zr=async(e,t)=>{await e.removeItem(t)};class Xu{constructor(){this.promise=new Xu.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}Xu.promiseConstructor=Promise;function _d(e){const t=e.split(".");if(t.length!==3)throw new Wd("Invalid JWT structure");for(let a=0;a<t.length;a++)if(!ZT.test(t[a]))throw new Wd("JWT not in base64url format");return{header:JSON.parse(hv(t[0])),payload:JSON.parse(hv(t[1])),signature:Yl(t[2]),raw:{header:t[0],payload:t[1]}}}async function g4(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function p4(e,t){return new Promise((a,s)=>{(async()=>{for(let l=0;l<1/0;l++)try{const c=await e(l);if(!t(l,null,c)){a(c);return}}catch(c){if(!t(l,c)){s(c);return}}})()})}function x4(e){return("0"+e.toString(16)).substr(-2)}function v4(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",a=r.length;let s="";for(let l=0;l<56;l++)s+=r.charAt(Math.floor(Math.random()*a));return s}return crypto.getRandomValues(t),Array.from(t,x4).join("")}async function y4(e){const r=new TextEncoder().encode(e),a=await crypto.subtle.digest("SHA-256",r),s=new Uint8Array(a);return Array.from(s).map(l=>String.fromCharCode(l)).join("")}async function _4(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await y4(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Bl(e,t,r=!1){const a=v4();let s=a;r&&(s+="/PASSWORD_RECOVERY"),await ql(e,`${t}-code-verifier`,s);const l=await _4(a);return[l,a===l?"plain":"s256"]}const w4=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function b4(e){const t=e.headers.get(qd);if(!t||!t.match(w4))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function S4(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function E4(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const T4=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function jl(e){if(!T4.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function wd(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const a=r.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function k4(e,t){return new Proxy(e,{get:(r,a,s)=>{if(a==="__isInsecureUserWarningProxy")return!0;if(typeof a=="symbol"){const l=a.toString();if(l==="Symbol(Symbol.toPrimitive)"||l==="Symbol(Symbol.toStringTag)"||l==="Symbol(util.inspect.custom)"||l==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,a,s)}return!t.value&&typeof a=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(r,a,s)}})}function dv(e){return JSON.parse(JSON.stringify(e))}const Oi=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),A4=[502,503,504];async function mv(e){var t;if(!m4(e))throw new Xd(Oi(e),0);if(A4.includes(e.status))throw new Xd(Oi(e),e.status);let r;try{r=await e.json()}catch(l){throw new Di(Oi(l),l)}let a;const s=b4(e);if(s&&s.getTime()>=Yy["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?a=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(a=r.error_code),a){if(a==="weak_password")throw new cv(Oi(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(a==="session_not_found")throw new Ha}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((l,c)=>l&&typeof c=="string",!0))throw new cv(Oi(r),e.status,r.weak_password.reasons);throw new t4(Oi(r),e.status||500,a)}const C4=(e,t,r,a)=>{const s={method:e,headers:t?.headers||{}};return e==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t?.headers),s.body=JSON.stringify(a),Object.assign(Object.assign({},s),r))};async function lt(e,t,r,a){var s;const l=Object.assign({},a?.headers);l[qd]||(l[qd]=Yy["2024-01-01"].name),a?.jwt&&(l.Authorization=`Bearer ${a.jwt}`);const c=(s=a?.query)!==null&&s!==void 0?s:{};a?.redirectTo&&(c.redirect_to=a.redirectTo);const u=Object.keys(c).length?"?"+new URLSearchParams(c).toString():"",h=await N4(e,t,r+u,{headers:l,noResolveJson:a?.noResolveJson},{},a?.body);return a?.xform?a?.xform(h):{data:Object.assign({},h),error:null}}async function N4(e,t,r,a,s,l){const c=C4(t,a,s,l);let u;try{u=await e(r,Object.assign({},c))}catch(h){throw console.error(h),new Xd(Oi(h),0)}if(u.ok||await mv(u),a?.noResolveJson)return u;try{return await u.json()}catch(h){await mv(h)}}function bn(e){var t;let r=null;D4(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=f4(e.expires_in)));const a=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:a},error:null}}function gv(e){const t=bn(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,a)=>r&&typeof a=="string",!0)&&(t.data.weak_password=e.weak_password),t}function Qs(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function O4(e){return{data:e,error:null}}function R4(e){const{action_link:t,email_otp:r,hashed_token:a,redirect_to:s,verification_type:l}=e,c=Gu(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),u={action_link:t,email_otp:r,hashed_token:a,redirect_to:s,verification_type:l},h=Object.assign({},c);return{data:{properties:u,user:h},error:null}}function pv(e){return e}function D4(e){return e.access_token&&e.refresh_token&&e.expires_in}const bd=["global","local","others"];class F4{constructor({url:t="",headers:r={},fetch:a}){this.url=t,this.headers=r,this.fetch=Zy(a),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=bd[0]){if(bd.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${bd.join(", ")}`);try{return await lt(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(a){if(rt(a))return{data:null,error:a};throw a}}async inviteUserByEmail(t,r={}){try{return await lt(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Qs})}catch(a){if(rt(a))return{data:{user:null},error:a};throw a}}async generateLink(t){try{const{options:r}=t,a=Gu(t,["options"]),s=Object.assign(Object.assign({},a),r);return"newEmail"in a&&(s.new_email=a?.newEmail,delete s.newEmail),await lt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:R4,redirectTo:r?.redirectTo})}catch(r){if(rt(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await lt(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Qs})}catch(r){if(rt(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,a,s,l,c,u,h;try{const d={nextPage:null,lastPage:0,total:0},g=await lt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(r=t?.page)===null||r===void 0?void 0:r.toString())!==null&&a!==void 0?a:"",per_page:(l=(s=t?.perPage)===null||s===void 0?void 0:s.toString())!==null&&l!==void 0?l:""},xform:pv});if(g.error)throw g.error;const x=await g.json(),v=(c=g.headers.get("x-total-count"))!==null&&c!==void 0?c:0,_=(h=(u=g.headers.get("link"))===null||u===void 0?void 0:u.split(","))!==null&&h!==void 0?h:[];return _.length>0&&(_.forEach(b=>{const y=parseInt(b.split(";")[0].split("=")[1].substring(0,1)),S=JSON.parse(b.split(";")[1].split("=")[1]);d[`${S}Page`]=y}),d.total=parseInt(v)),{data:Object.assign(Object.assign({},x),d),error:null}}catch(d){if(rt(d))return{data:{users:[]},error:d};throw d}}async getUserById(t){jl(t);try{return await lt(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Qs})}catch(r){if(rt(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){jl(t);try{return await lt(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:Qs})}catch(a){if(rt(a))return{data:{user:null},error:a};throw a}}async deleteUser(t,r=!1){jl(t);try{return await lt(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:Qs})}catch(a){if(rt(a))return{data:{user:null},error:a};throw a}}async _listFactors(t){jl(t.userId);try{const{data:r,error:a}=await lt(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:r,error:a}}catch(r){if(rt(r))return{data:null,error:r};throw r}}async _deleteFactor(t){jl(t.userId),jl(t.id);try{return{data:await lt(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(rt(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,a,s,l,c,u,h;try{const d={nextPage:null,lastPage:0,total:0},g=await lt(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(r=t?.page)===null||r===void 0?void 0:r.toString())!==null&&a!==void 0?a:"",per_page:(l=(s=t?.perPage)===null||s===void 0?void 0:s.toString())!==null&&l!==void 0?l:""},xform:pv});if(g.error)throw g.error;const x=await g.json(),v=(c=g.headers.get("x-total-count"))!==null&&c!==void 0?c:0,_=(h=(u=g.headers.get("link"))===null||u===void 0?void 0:u.split(","))!==null&&h!==void 0?h:[];return _.length>0&&(_.forEach(b=>{const y=parseInt(b.split(";")[0].split("=")[1].substring(0,1)),S=JSON.parse(b.split(";")[1].split("=")[1]);d[`${S}Page`]=y}),d.total=parseInt(v)),{data:Object.assign(Object.assign({},x),d),error:null}}catch(d){if(rt(d))return{data:{clients:[]},error:d};throw d}}async _createOAuthClient(t){try{return await lt(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(rt(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await lt(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(rt(r))return{data:null,error:r};throw r}}async _updateOAuthClient(t,r){try{return await lt(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:r,headers:this.headers,xform:a=>({data:a,error:null})})}catch(a){if(rt(a))return{data:null,error:a};throw a}}async _deleteOAuthClient(t){try{return await lt(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(rt(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await lt(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(rt(r))return{data:null,error:r};throw r}}}function xv(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const Ul={debug:!!(globalThis&&Qy()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class e_ extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class M4 extends e_{}async function L4(e,t,r){Ul.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const a=new globalThis.AbortController;return t>0&&setTimeout(()=>{a.abort(),Ul.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:a.signal},async s=>{if(s){Ul.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,s.name);try{return await r()}finally{Ul.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,s.name)}}else{if(t===0)throw Ul.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new M4(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Ul.debug)try{const l=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(l,null,"  "))}catch(l){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",l)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function I4(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function t_(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function B4(e){return parseInt(e,16)}function j4(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,a=>a.toString(16).padStart(2,"0")).join("")}function U4(e){var t;const{chainId:r,domain:a,expirationTime:s,issuedAt:l=new Date,nonce:c,notBefore:u,requestId:h,resources:d,scheme:g,uri:x,version:v}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!a)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(c&&c.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${c}`);if(!x)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(v!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${v}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const _=t_(e.address),b=g?`${g}://${a}`:a,y=e.statement?`${e.statement}
`:"",S=`${b} wants you to sign in with your Ethereum account:
${_}

${y}`;let k=`URI: ${x}
Version: ${v}
Chain ID: ${r}${c?`
Nonce: ${c}`:""}
Issued At: ${l.toISOString()}`;if(s&&(k+=`
Expiration Time: ${s.toISOString()}`),u&&(k+=`
Not Before: ${u.toISOString()}`),h&&(k+=`
Request ID: ${h}`),d){let O=`
Resources:`;for(const T of d){if(!T||typeof T!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${T}`);O+=`
- ${T}`}k+=O}return`${S}
${k}`}class Ir extends Error{constructor({message:t,code:r,cause:a,name:s}){var l;super(t,{cause:a}),this.__isWebAuthnError=!0,this.name=(l=s??(a instanceof Error?a.name:void 0))!==null&&l!==void 0?l:"Unknown Error",this.code=r}}class Cu extends Ir{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function P4({error:e,options:t}){var r,a,s;const{publicKey:l}=t;if(!l)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Ir({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=l.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new Ir({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((a=l.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new Ir({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((s=l.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new Ir({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new Ir({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new Ir({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return l.pubKeyCredParams.filter(u=>u.type==="public-key").length===0?new Ir({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new Ir({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const c=window.location.hostname;if(r_(c)){if(l.rp.id!==c)return new Ir({message:`The RP ID "${l.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Ir({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(l.user.id.byteLength<1||l.user.id.byteLength>64)return new Ir({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new Ir({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Ir({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function z4({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Ir({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new Ir({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const a=window.location.hostname;if(r_(a)){if(r.rpId!==a)return new Ir({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Ir({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new Ir({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Ir({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class H4{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const $4=new H4;function V4(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:a}=e,s=Gu(e,["challenge","user","excludeCredentials"]),l=Yl(t).buffer,c=Object.assign(Object.assign({},r),{id:Yl(r.id).buffer}),u=Object.assign(Object.assign({},s),{challenge:l,user:c});if(a&&a.length>0){u.excludeCredentials=new Array(a.length);for(let h=0;h<a.length;h++){const d=a[h];u.excludeCredentials[h]=Object.assign(Object.assign({},d),{id:Yl(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return u}function G4(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,a=Gu(e,["challenge","allowCredentials"]),s=Yl(t).buffer,l=Object.assign(Object.assign({},a),{challenge:s});if(r&&r.length>0){l.allowCredentials=new Array(r.length);for(let c=0;c<r.length;c++){const u=r[c];l.allowCredentials[c]=Object.assign(Object.assign({},u),{id:Yl(u.id).buffer,type:u.type||"public-key",transports:u.transports})}}return l}function q4(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:Mi(new Uint8Array(e.response.attestationObject)),clientDataJSON:Mi(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function X4(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,a=e.getClientExtensionResults(),s=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:Mi(new Uint8Array(s.authenticatorData)),clientDataJSON:Mi(new Uint8Array(s.clientDataJSON)),signature:Mi(new Uint8Array(s.signature)),userHandle:s.userHandle?Mi(new Uint8Array(s.userHandle)):void 0},type:"public-key",clientExtensionResults:a,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function r_(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function vv(){var e,t;return!!(ea()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator?.credentials)===null||t===void 0?void 0:t.get)=="function")}async function W4(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Cu("Browser returned unexpected credential type",t)}:{data:null,error:new Cu("Empty credential response",t)}}catch(t){return{data:null,error:P4({error:t,options:e})}}}async function K4(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Cu("Browser returned unexpected credential type",t)}:{data:null,error:new Cu("Empty credential response",t)}}catch(t){return{data:null,error:z4({error:t,options:e})}}}const Y4={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},J4={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Nu(...e){const t=s=>s!==null&&typeof s=="object"&&!Array.isArray(s),r=s=>s instanceof ArrayBuffer||ArrayBuffer.isView(s),a={};for(const s of e)if(s)for(const l in s){const c=s[l];if(c!==void 0)if(Array.isArray(c))a[l]=c;else if(r(c))a[l]=c;else if(t(c)){const u=a[l];t(u)?a[l]=Nu(u,c):a[l]=Nu(c)}else a[l]=c}return a}function Q4(e,t){return Nu(Y4,e,t||{})}function Z4(e,t){return Nu(J4,e,t||{})}class ek{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:a,signal:s},l){try{const{data:c,error:u}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!c)return{data:null,error:u};const h=s??$4.createNewAbortSignal();if(c.webauthn.type==="create"){const{user:d}=c.webauthn.credential_options.publicKey;d.name||(d.name=`${d.id}:${a}`),d.displayName||(d.displayName=d.name)}switch(c.webauthn.type){case"create":{const d=Q4(c.webauthn.credential_options.publicKey,l?.create),{data:g,error:x}=await W4({publicKey:d,signal:h});return g?{data:{factorId:t,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:g}},error:null}:{data:null,error:x}}case"request":{const d=Z4(c.webauthn.credential_options.publicKey,l?.request),{data:g,error:x}=await K4(Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:d,signal:h}));return g?{data:{factorId:t,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:g}},error:null}:{data:null,error:x}}}}catch(c){return rt(c)?{data:null,error:c}:{data:null,error:new Di("Unexpected error in challenge",c)}}}async _verify({challengeId:t,factorId:r,webauthn:a}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:a})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:a=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},l){if(!r)return{data:null,error:new Ec("rpId is required for WebAuthn authentication")};try{if(!vv())return{data:null,error:new Di("Browser does not support WebAuthn",null)};const{data:c,error:u}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:a},signal:s},{request:l});if(!c)return{data:null,error:u};const{webauthn:h}=c;return this._verify({factorId:t,challengeId:c.challengeId,webauthn:{type:h.type,rpId:r,rpOrigins:a,credential_response:h.credential_response}})}catch(c){return rt(c)?{data:null,error:c}:{data:null,error:new Di("Unexpected error in authenticate",c)}}}async _register({friendlyName:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:a=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},l){if(!r)return{data:null,error:new Ec("rpId is required for WebAuthn registration")};try{if(!vv())return{data:null,error:new Di("Browser does not support WebAuthn",null)};const{data:c,error:u}=await this._enroll({friendlyName:t});if(!c)return await this.client.mfa.listFactors().then(g=>{var x;return(x=g.data)===null||x===void 0?void 0:x.all.find(v=>v.factor_type==="webauthn"&&v.friendly_name===t&&v.status!=="unverified")}).then(g=>g?this.client.mfa.unenroll({factorId:g?.id}):void 0),{data:null,error:u};const{data:h,error:d}=await this._challenge({factorId:c.id,friendlyName:c.friendly_name,webauthn:{rpId:r,rpOrigins:a},signal:s},{create:l});return h?this._verify({factorId:c.id,challengeId:h.challengeId,webauthn:{rpId:r,rpOrigins:a,type:h.webauthn.type,credential_response:h.webauthn.credential_response}}):{data:null,error:d}}catch(c){return rt(c)?{data:null,error:c}:{data:null,error:new Di("Unexpected error in register",c)}}}}I4();const tk={url:YT,storageKey:JT,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:QT,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function yv(e,t,r){return await r()}const Pl={};class Tc{get jwks(){var t,r;return(r=(t=Pl[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){Pl[this.storageKey]=Object.assign(Object.assign({},Pl[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=Pl[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){Pl[this.storageKey]=Object.assign(Object.assign({},Pl[this.storageKey]),{cachedAt:t})}constructor(t){var r,a,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const l=Object.assign(Object.assign({},tk),t);if(this.storageKey=l.storageKey,this.instanceID=(r=Tc.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,Tc.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!l.debug,typeof l.debug=="function"&&(this.logger=l.debug),this.instanceID>0&&ea()){const c=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(c),this.logDebugMessages&&console.trace(c)}if(this.persistSession=l.persistSession,this.autoRefreshToken=l.autoRefreshToken,this.admin=new F4({url:l.url,headers:l.headers,fetch:l.fetch}),this.url=l.url,this.headers=l.headers,this.fetch=Zy(l.fetch),this.lock=l.lock||yv,this.detectSessionInUrl=l.detectSessionInUrl,this.flowType=l.flowType,this.hasCustomAuthorizationHeader=l.hasCustomAuthorizationHeader,this.throwOnError=l.throwOnError,l.lock?this.lock=l.lock:this.persistSession&&ea()&&(!((a=globalThis?.navigator)===null||a===void 0)&&a.locks)?this.lock=L4:this.lock=yv,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new ek(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(l.storage?this.storage=l.storage:Qy()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=xv(this.memoryStorage)),l.userStorage&&(this.userStorage=l.userStorage)):(this.memoryStorage={},this.storage=xv(this.memoryStorage)),ea()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(c){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",c)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async c=>{this._debug("received broadcast notification from other tab or client",c),await this._notifyAllSubscribers(c.data.event,c.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${Ky}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let r={},a="none";if(ea()&&(r=d4(window.location.href),this._isImplicitGrantCallback(r)?a="implicit":await this._isPKCECallback(r)&&(a="pkce")),ea()&&this.detectSessionInUrl&&a!=="none"){const{data:s,error:l}=await this._getSessionFromURL(r,a);if(l){if(this._debug("#_initialize()","error detecting session from URL",l),n4(l)){const h=(t=l.details)===null||t===void 0?void 0:t.code;if(h==="identity_already_exists"||h==="identity_not_found"||h==="single_identity_not_deletable")return{error:l}}return await this._removeSession(),{error:l}}const{session:c,redirectType:u}=s;return this._debug("#_initialize()","detected session in URL",c,"redirect type",u),await this._saveSession(c),setTimeout(async()=>{u==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",c):await this._notifyAllSubscribers("SIGNED_IN",c)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return rt(r)?this._returnResult({error:r}):this._returnResult({error:new Di("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,a,s;try{const l=await lt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(a=(r=t?.options)===null||r===void 0?void 0:r.data)!==null&&a!==void 0?a:{},gotrue_meta_security:{captcha_token:(s=t?.options)===null||s===void 0?void 0:s.captchaToken}},xform:bn}),{data:c,error:u}=l;if(u||!c)return this._returnResult({data:{user:null,session:null},error:u});const h=c.session,d=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",h)),this._returnResult({data:{user:d,session:h},error:null})}catch(l){if(rt(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async signUp(t){var r,a,s;try{let l;if("email"in t){const{email:g,password:x,options:v}=t;let _=null,b=null;this.flowType==="pkce"&&([_,b]=await Bl(this.storage,this.storageKey)),l=await lt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:v?.emailRedirectTo,body:{email:g,password:x,data:(r=v?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:v?.captchaToken},code_challenge:_,code_challenge_method:b},xform:bn})}else if("phone"in t){const{phone:g,password:x,options:v}=t;l=await lt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:g,password:x,data:(a=v?.data)!==null&&a!==void 0?a:{},channel:(s=v?.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:v?.captchaToken}},xform:bn})}else throw new fu("You must provide either an email or phone number and a password");const{data:c,error:u}=l;if(u||!c)return await Zr(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:u});const h=c.session,d=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",h)),this._returnResult({data:{user:d,session:h},error:null})}catch(l){if(await Zr(this.storage,`${this.storageKey}-code-verifier`),rt(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async signInWithPassword(t){try{let r;if("email"in t){const{email:l,password:c,options:u}=t;r=await lt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:l,password:c,gotrue_meta_security:{captcha_token:u?.captchaToken}},xform:gv})}else if("phone"in t){const{phone:l,password:c,options:u}=t;r=await lt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:l,password:c,gotrue_meta_security:{captcha_token:u?.captchaToken}},xform:gv})}else throw new fu("You must provide either an email or phone number and a password");const{data:a,error:s}=r;if(s)return this._returnResult({data:{user:null,session:null},error:s});if(!a||!a.session||!a.user){const l=new Il;return this._returnResult({data:{user:null,session:null},error:l})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:Object.assign({user:a.user,session:a.session},a.weak_password?{weakPassword:a.weak_password}:null),error:s})}catch(r){if(rt(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(t){var r,a,s,l;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(a=t.options)===null||a===void 0?void 0:a.scopes,queryParams:(s=t.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(l=t.options)===null||l===void 0?void 0:l.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,a,s,l,c,u,h,d,g,x,v;let _,b;if("message"in t)_=t.message,b=t.signature;else{const{chain:y,wallet:S,statement:k,options:O}=t;let T;if(ea())if(typeof S=="object")T=S;else{const q=window;if("ethereum"in q&&typeof q.ethereum=="object"&&"request"in q.ethereum&&typeof q.ethereum.request=="function")T=q.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof S!="object"||!O?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");T=S}const j=new URL((r=O?.url)!==null&&r!==void 0?r:window.location.href),X=await T.request({method:"eth_requestAccounts"}).then(q=>q).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!X||X.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const I=t_(X[0]);let C=(a=O?.signInWithEthereum)===null||a===void 0?void 0:a.chainId;if(!C){const q=await T.request({method:"eth_chainId"});C=B4(q)}const K={domain:j.host,address:I,statement:k,uri:j.href,version:"1",chainId:C,nonce:(s=O?.signInWithEthereum)===null||s===void 0?void 0:s.nonce,issuedAt:(c=(l=O?.signInWithEthereum)===null||l===void 0?void 0:l.issuedAt)!==null&&c!==void 0?c:new Date,expirationTime:(u=O?.signInWithEthereum)===null||u===void 0?void 0:u.expirationTime,notBefore:(h=O?.signInWithEthereum)===null||h===void 0?void 0:h.notBefore,requestId:(d=O?.signInWithEthereum)===null||d===void 0?void 0:d.requestId,resources:(g=O?.signInWithEthereum)===null||g===void 0?void 0:g.resources};_=U4(K),b=await T.request({method:"personal_sign",params:[j4(_),I]})}try{const{data:y,error:S}=await lt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:_,signature:b},!((x=t.options)===null||x===void 0)&&x.captchaToken?{gotrue_meta_security:{captcha_token:(v=t.options)===null||v===void 0?void 0:v.captchaToken}}:null),xform:bn});if(S)throw S;if(!y||!y.session||!y.user){const k=new Il;return this._returnResult({data:{user:null,session:null},error:k})}return y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("SIGNED_IN",y.session)),this._returnResult({data:Object.assign({},y),error:S})}catch(y){if(rt(y))return this._returnResult({data:{user:null,session:null},error:y});throw y}}async signInWithSolana(t){var r,a,s,l,c,u,h,d,g,x,v,_;let b,y;if("message"in t)b=t.message,y=t.signature;else{const{chain:S,wallet:k,statement:O,options:T}=t;let j;if(ea())if(typeof k=="object")j=k;else{const I=window;if("solana"in I&&typeof I.solana=="object"&&("signIn"in I.solana&&typeof I.solana.signIn=="function"||"signMessage"in I.solana&&typeof I.solana.signMessage=="function"))j=I.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof k!="object"||!T?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");j=k}const X=new URL((r=T?.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in j&&j.signIn){const I=await j.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},T?.signInWithSolana),{version:"1",domain:X.host,uri:X.href}),O?{statement:O}:null));let C;if(Array.isArray(I)&&I[0]&&typeof I[0]=="object")C=I[0];else if(I&&typeof I=="object"&&"signedMessage"in I&&"signature"in I)C=I;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in C&&"signature"in C&&(typeof C.signedMessage=="string"||C.signedMessage instanceof Uint8Array)&&C.signature instanceof Uint8Array)b=typeof C.signedMessage=="string"?C.signedMessage:new TextDecoder().decode(C.signedMessage),y=C.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in j)||typeof j.signMessage!="function"||!("publicKey"in j)||typeof j!="object"||!j.publicKey||!("toBase58"in j.publicKey)||typeof j.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");b=[`${X.host} wants you to sign in with your Solana account:`,j.publicKey.toBase58(),...O?["",O,""]:[""],"Version: 1",`URI: ${X.href}`,`Issued At: ${(s=(a=T?.signInWithSolana)===null||a===void 0?void 0:a.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((l=T?.signInWithSolana)===null||l===void 0)&&l.notBefore?[`Not Before: ${T.signInWithSolana.notBefore}`]:[],...!((c=T?.signInWithSolana)===null||c===void 0)&&c.expirationTime?[`Expiration Time: ${T.signInWithSolana.expirationTime}`]:[],...!((u=T?.signInWithSolana)===null||u===void 0)&&u.chainId?[`Chain ID: ${T.signInWithSolana.chainId}`]:[],...!((h=T?.signInWithSolana)===null||h===void 0)&&h.nonce?[`Nonce: ${T.signInWithSolana.nonce}`]:[],...!((d=T?.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${T.signInWithSolana.requestId}`]:[],...!((x=(g=T?.signInWithSolana)===null||g===void 0?void 0:g.resources)===null||x===void 0)&&x.length?["Resources",...T.signInWithSolana.resources.map(C=>`- ${C}`)]:[]].join(`
`);const I=await j.signMessage(new TextEncoder().encode(b),"utf8");if(!I||!(I instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");y=I}}try{const{data:S,error:k}=await lt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:b,signature:Mi(y)},!((v=t.options)===null||v===void 0)&&v.captchaToken?{gotrue_meta_security:{captcha_token:(_=t.options)===null||_===void 0?void 0:_.captchaToken}}:null),xform:bn});if(k)throw k;if(!S||!S.session||!S.user){const O=new Il;return this._returnResult({data:{user:null,session:null},error:O})}return S.session&&(await this._saveSession(S.session),await this._notifyAllSubscribers("SIGNED_IN",S.session)),this._returnResult({data:Object.assign({},S),error:k})}catch(S){if(rt(S))return this._returnResult({data:{user:null,session:null},error:S});throw S}}async _exchangeCodeForSession(t){const r=await Ni(this.storage,`${this.storageKey}-code-verifier`),[a,s]=(r??"").split("/");try{if(!a&&this.flowType==="pkce")throw new s4;const{data:l,error:c}=await lt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:a},xform:bn});if(await Zr(this.storage,`${this.storageKey}-code-verifier`),c)throw c;if(!l||!l.session||!l.user){const u=new Il;return this._returnResult({data:{user:null,session:null,redirectType:null},error:u})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:Object.assign(Object.assign({},l),{redirectType:s??null}),error:c})}catch(l){if(await Zr(this.storage,`${this.storageKey}-code-verifier`),rt(l))return this._returnResult({data:{user:null,session:null,redirectType:null},error:l});throw l}}async signInWithIdToken(t){try{const{options:r,provider:a,token:s,access_token:l,nonce:c}=t,u=await lt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:a,id_token:s,access_token:l,nonce:c,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:bn}),{data:h,error:d}=u;if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!h||!h.session||!h.user){const g=new Il;return this._returnResult({data:{user:null,session:null},error:g})}return h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",h.session)),this._returnResult({data:h,error:d})}catch(r){if(rt(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(t){var r,a,s,l,c;try{if("email"in t){const{email:u,options:h}=t;let d=null,g=null;this.flowType==="pkce"&&([d,g]=await Bl(this.storage,this.storageKey));const{error:x}=await lt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:u,data:(r=h?.data)!==null&&r!==void 0?r:{},create_user:(a=h?.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:h?.captchaToken},code_challenge:d,code_challenge_method:g},redirectTo:h?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:x})}if("phone"in t){const{phone:u,options:h}=t,{data:d,error:g}=await lt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:u,data:(s=h?.data)!==null&&s!==void 0?s:{},create_user:(l=h?.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:h?.captchaToken},channel:(c=h?.channel)!==null&&c!==void 0?c:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:d?.message_id},error:g})}throw new fu("You must provide either an email or phone number.")}catch(u){if(await Zr(this.storage,`${this.storageKey}-code-verifier`),rt(u))return this._returnResult({data:{user:null,session:null},error:u});throw u}}async verifyOtp(t){var r,a;try{let s,l;"options"in t&&(s=(r=t.options)===null||r===void 0?void 0:r.redirectTo,l=(a=t.options)===null||a===void 0?void 0:a.captchaToken);const{data:c,error:u}=await lt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:l}}),redirectTo:s,xform:bn});if(u)throw u;if(!c)throw new Error("An error occurred on token verification.");const h=c.session,d=c.user;return h?.access_token&&(await this._saveSession(h),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",h)),this._returnResult({data:{user:d,session:h},error:null})}catch(s){if(rt(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithSSO(t){var r,a,s,l,c;try{let u=null,h=null;this.flowType==="pkce"&&([u,h]=await Bl(this.storage,this.storageKey));const d=await lt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&a!==void 0?a:void 0}),!((s=t?.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:u,code_challenge_method:h}),headers:this.headers,xform:O4});return!((l=d.data)===null||l===void 0)&&l.url&&ea()&&!(!((c=t.options)===null||c===void 0)&&c.skipBrowserRedirect)&&window.location.assign(d.data.url),this._returnResult(d)}catch(u){if(await Zr(this.storage,`${this.storageKey}-code-verifier`),rt(u))return this._returnResult({data:null,error:u});throw u}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:a}=t;if(a)throw a;if(!r)throw new Ha;const{error:s}=await lt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:s})})}catch(t){if(rt(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:a,type:s,options:l}=t,{error:c}=await lt(this.fetch,"POST",r,{headers:this.headers,body:{email:a,type:s,gotrue_meta_security:{captcha_token:l?.captchaToken}},redirectTo:l?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:c})}else if("phone"in t){const{phone:a,type:s,options:l}=t,{data:c,error:u}=await lt(this.fetch,"POST",r,{headers:this.headers,body:{phone:a,type:s,gotrue_meta_security:{captcha_token:l?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:c?.message_id},error:u})}throw new fu("You must provide either an email or phone number and a type")}catch(r){if(rt(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const a=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await a,await r()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const a=r();for(this.pendingInLock.push((async()=>{try{await a}catch{}})()),await a;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await a}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await Ni(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const a=t.expires_at?t.expires_at*1e3-Date.now()<vd:!1;if(this._debug("#__loadSession()",`session has${a?"":" not"} expired`,"expires_at",t.expires_at),!a){if(this.userStorage){const c=await Ni(this.userStorage,this.storageKey+"-user");c?.user?t.user=c.user:t.user=wd()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const c={value:this.suppressGetSessionWarning};t.user=k4(t.user,c),c.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:s,error:l}=await this._callRefreshToken(t.refresh_token);return l?this._returnResult({data:{session:null},error:l}):this._returnResult({data:{session:s},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){if(t)return await this._getUser(t);await this.initializePromise;const r=await this._acquireLock(-1,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(t){try{return t?await lt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Qs}):await this._useSession(async r=>{var a,s,l;const{data:c,error:u}=r;if(u)throw u;return!(!((a=c.session)===null||a===void 0)&&a.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Ha}:await lt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(l=(s=c.session)===null||s===void 0?void 0:s.access_token)!==null&&l!==void 0?l:void 0,xform:Qs})})}catch(r){if(rt(r))return a4(r)&&(await this._removeSession(),await Zr(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async a=>{const{data:s,error:l}=a;if(l)throw l;if(!s.session)throw new Ha;const c=s.session;let u=null,h=null;this.flowType==="pkce"&&t.email!=null&&([u,h]=await Bl(this.storage,this.storageKey));const{data:d,error:g}=await lt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:u,code_challenge_method:h}),jwt:c.access_token,xform:Qs});if(g)throw g;return c.user=d.user,await this._saveSession(c),await this._notifyAllSubscribers("USER_UPDATED",c),this._returnResult({data:{user:c.user},error:null})})}catch(a){if(await Zr(this.storage,`${this.storageKey}-code-verifier`),rt(a))return this._returnResult({data:{user:null},error:a});throw a}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Ha;const r=Date.now()/1e3;let a=r,s=!0,l=null;const{payload:c}=_d(t.access_token);if(c.exp&&(a=c.exp,s=a<=r),s){const{data:u,error:h}=await this._callRefreshToken(t.refresh_token);if(h)return this._returnResult({data:{user:null,session:null},error:h});if(!u)return{data:{user:null,session:null},error:null};l=u}else{const{data:u,error:h}=await this._getUser(t.access_token);if(h)throw h;l={access_token:t.access_token,refresh_token:t.refresh_token,user:u.user,token_type:"bearer",expires_in:a-r,expires_at:a},await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)}return this._returnResult({data:{user:l.user,session:l},error:null})}catch(r){if(rt(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var a;if(!t){const{data:c,error:u}=r;if(u)throw u;t=(a=c.session)!==null&&a!==void 0?a:void 0}if(!t?.refresh_token)throw new Ha;const{data:s,error:l}=await this._callRefreshToken(t.refresh_token);return l?this._returnResult({data:{user:null,session:null},error:l}):s?this._returnResult({data:{user:s.user,session:s},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(rt(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(t,r){try{if(!ea())throw new hu("No browser detected.");if(t.error||t.error_description||t.error_code)throw new hu(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new ov("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new hu("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new ov("No code detected.");const{data:O,error:T}=await this._exchangeCodeForSession(t.code);if(T)throw T;const j=new URL(window.location.href);return j.searchParams.delete("code"),window.history.replaceState(window.history.state,"",j.toString()),{data:{session:O.session,redirectType:null},error:null}}const{provider_token:a,provider_refresh_token:s,access_token:l,refresh_token:c,expires_in:u,expires_at:h,token_type:d}=t;if(!l||!u||!c||!d)throw new hu("No session defined in URL");const g=Math.round(Date.now()/1e3),x=parseInt(u);let v=g+x;h&&(v=parseInt(h));const _=v-g;_*1e3<=Gl&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${_}s, should have been closer to ${x}s`);const b=v-x;g-b>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",b,v,g):g-b<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",b,v,g);const{data:y,error:S}=await this._getUser(l);if(S)throw S;const k={provider_token:a,provider_refresh_token:s,access_token:l,expires_in:x,expires_at:v,refresh_token:c,token_type:d,user:y.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:k,redirectType:t.type},error:null})}catch(a){if(rt(a))return this._returnResult({data:{session:null,redirectType:null},error:a});throw a}}_isImplicitGrantCallback(t){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),t):!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await Ni(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var a;const{data:s,error:l}=r;if(l)return this._returnResult({error:l});const c=(a=s.session)===null||a===void 0?void 0:a.access_token;if(c){const{error:u}=await this.admin.signOut(c,t);if(u&&!(r4(u)&&(u.status===404||u.status===401||u.status===403)))return this._returnResult({error:u})}return t!=="others"&&(await this._removeSession(),await Zr(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const r=h4(),a={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,a),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:a}}}async _emitInitialSession(t){return await this._useSession(async r=>{var a,s;try{const{data:{session:l},error:c}=r;if(c)throw c;await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",l)),this._debug("INITIAL_SESSION","callback id",t,"session",l)}catch(l){await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",l),console.error(l)}})}async resetPasswordForEmail(t,r={}){let a=null,s=null;this.flowType==="pkce"&&([a,s]=await Bl(this.storage,this.storageKey,!0));try{return await lt(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:a,code_challenge_method:s,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(l){if(await Zr(this.storage,`${this.storageKey}-code-verifier`),rt(l))return this._returnResult({data:null,error:l});throw l}}async getUserIdentities(){var t;try{const{data:r,error:a}=await this.getUser();if(a)throw a;return this._returnResult({data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(r){if(rt(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:a,error:s}=await this._useSession(async l=>{var c,u,h,d,g;const{data:x,error:v}=l;if(v)throw v;const _=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(c=t.options)===null||c===void 0?void 0:c.redirectTo,scopes:(u=t.options)===null||u===void 0?void 0:u.scopes,queryParams:(h=t.options)===null||h===void 0?void 0:h.queryParams,skipBrowserRedirect:!0});return await lt(this.fetch,"GET",_,{headers:this.headers,jwt:(g=(d=x.session)===null||d===void 0?void 0:d.access_token)!==null&&g!==void 0?g:void 0})});if(s)throw s;return ea()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(a?.url),this._returnResult({data:{provider:t.provider,url:a?.url},error:null})}catch(a){if(rt(a))return this._returnResult({data:{provider:t.provider,url:null},error:a});throw a}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var a;try{const{error:s,data:{session:l}}=r;if(s)throw s;const{options:c,provider:u,token:h,access_token:d,nonce:g}=t,x=await lt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(a=l?.access_token)!==null&&a!==void 0?a:void 0,body:{provider:u,id_token:h,access_token:d,nonce:g,link_identity:!0,gotrue_meta_security:{captcha_token:c?.captchaToken}},xform:bn}),{data:v,error:_}=x;return _?this._returnResult({data:{user:null,session:null},error:_}):!v||!v.session||!v.user?this._returnResult({data:{user:null,session:null},error:new Il}):(v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers("USER_UPDATED",v.session)),this._returnResult({data:v,error:_}))}catch(s){if(await Zr(this.storage,`${this.storageKey}-code-verifier`),rt(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var a,s;const{data:l,error:c}=r;if(c)throw c;return await lt(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(s=(a=l.session)===null||a===void 0?void 0:a.access_token)!==null&&s!==void 0?s:void 0})})}catch(r){if(rt(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const a=Date.now();return await p4(async s=>(s>0&&await g4(200*Math.pow(2,s-1)),this._debug(r,"refreshing attempt",s),await lt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:bn})),(s,l)=>{const c=200*Math.pow(2,s);return l&&yd(l)&&Date.now()+c-a<Gl})}catch(a){if(this._debug(r,"error",a),rt(a))return this._returnResult({data:{session:null,user:null},error:a});throw a}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const a=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",a),ea()&&!r.skipBrowserRedirect&&window.location.assign(a),{data:{provider:t,url:a},error:null}}async _recoverAndRefresh(){var t,r;const a="#_recoverAndRefresh()";this._debug(a,"begin");try{const s=await Ni(this.storage,this.storageKey);if(s&&this.userStorage){let c=await Ni(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!c&&(c={user:s.user},await ql(this.userStorage,this.storageKey+"-user",c)),s.user=(t=c?.user)!==null&&t!==void 0?t:wd()}else if(s&&!s.user&&!s.user){const c=await Ni(this.storage,this.storageKey+"-user");c&&c?.user?(s.user=c.user,await Zr(this.storage,this.storageKey+"-user"),await ql(this.storage,this.storageKey,s)):s.user=wd()}if(this._debug(a,"session from storage",s),!this._isValidSession(s)){this._debug(a,"session is not valid"),s!==null&&await this._removeSession();return}const l=((r=s.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<vd;if(this._debug(a,`session has${l?"":" not"} expired with margin of ${vd}s`),l){if(this.autoRefreshToken&&s.refresh_token){const{error:c}=await this._callRefreshToken(s.refresh_token);c&&(console.error(c),yd(c)||(this._debug(a,"refresh failed with a non-retryable error, removing the session",c),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:c,error:u}=await this._getUser(s.access_token);!u&&c?.user?(s.user=c.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(a,"could not get user data, skipping SIGNED_IN notification")}catch(c){console.error("Error getting user data:",c),this._debug(a,"error getting user data, skipping SIGNED_IN notification",c)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(a,"error",s),console.error(s);return}finally{this._debug(a,"end")}}async _callRefreshToken(t){var r,a;if(!t)throw new Ha;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new Xu;const{data:l,error:c}=await this._refreshAccessToken(t);if(c)throw c;if(!l.session)throw new Ha;await this._saveSession(l.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",l.session);const u={data:l.session,error:null};return this.refreshingDeferred.resolve(u),u}catch(l){if(this._debug(s,"error",l),rt(l)){const c={data:null,error:l};return yd(l)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(c),c}throw(a=this.refreshingDeferred)===null||a===void 0||a.reject(l),l}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(t,r,a=!0){const s=`#_notifyAllSubscribers(${t})`;this._debug(s,"begin",r,`broadcast = ${a}`);try{this.broadcastChannel&&a&&this.broadcastChannel.postMessage({event:t,session:r});const l=[],c=Array.from(this.stateChangeEmitters.values()).map(async u=>{try{await u.callback(t,r)}catch(h){l.push(h)}});if(await Promise.all(c),l.length>0){for(let u=0;u<l.length;u+=1)console.error(l[u]);throw l[0]}}finally{this._debug(s,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await Zr(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},t),a=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!a&&r.user&&await ql(this.userStorage,this.storageKey+"-user",{user:r.user});const s=Object.assign({},r);delete s.user;const l=dv(s);await ql(this.storage,this.storageKey,l)}else{const s=dv(r);await ql(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await Zr(this.storage,this.storageKey),await Zr(this.storage,this.storageKey+"-code-verifier"),await Zr(this.storage,this.storageKey+"-user"),this.userStorage&&await Zr(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&ea()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Gl);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:a}}=r;if(!a||!a.refresh_token||!a.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((a.expires_at*1e3-t)/Gl);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${Gl}ms, refresh threshold is ${Gd} ticks`),s<=Gd&&await this._callRefreshToken(a.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof e_)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!ea()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,a){const s=[`provider=${encodeURIComponent(r)}`];if(a?.redirectTo&&s.push(`redirect_to=${encodeURIComponent(a.redirectTo)}`),a?.scopes&&s.push(`scopes=${encodeURIComponent(a.scopes)}`),this.flowType==="pkce"){const[l,c]=await Bl(this.storage,this.storageKey),u=new URLSearchParams({code_challenge:`${encodeURIComponent(l)}`,code_challenge_method:`${encodeURIComponent(c)}`});s.push(u.toString())}if(a?.queryParams){const l=new URLSearchParams(a.queryParams);s.push(l.toString())}return a?.skipBrowserRedirect&&s.push(`skip_http_redirect=${a.skipBrowserRedirect}`),`${t}?${s.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var a;const{data:s,error:l}=r;return l?this._returnResult({data:null,error:l}):await lt(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(a=s?.session)===null||a===void 0?void 0:a.access_token})})}catch(r){if(rt(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(t){try{return await this._useSession(async r=>{var a,s;const{data:l,error:c}=r;if(c)return this._returnResult({data:null,error:c});const u=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:h,error:d}=await lt(this.fetch,"POST",`${this.url}/factors`,{body:u,headers:this.headers,jwt:(a=l?.session)===null||a===void 0?void 0:a.access_token});return d?this._returnResult({data:null,error:d}):(t.factorType==="totp"&&h.type==="totp"&&(!((s=h?.totp)===null||s===void 0)&&s.qr_code)&&(h.totp.qr_code=`data:image/svg+xml;utf-8,${h.totp.qr_code}`),this._returnResult({data:h,error:null}))})}catch(r){if(rt(r))return this._returnResult({data:null,error:r});throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var a;const{data:s,error:l}=r;if(l)return this._returnResult({data:null,error:l});const c=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?q4(t.webauthn.credential_response):X4(t.webauthn.credential_response)})}:{code:t.code}),{data:u,error:h}=await lt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:c,headers:this.headers,jwt:(a=s?.session)===null||a===void 0?void 0:a.access_token});return h?this._returnResult({data:null,error:h}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+u.expires_in},u)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",u),this._returnResult({data:u,error:h}))})}catch(r){if(rt(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var a;const{data:s,error:l}=r;if(l)return this._returnResult({data:null,error:l});const c=await lt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(a=s?.session)===null||a===void 0?void 0:a.access_token});if(c.error)return c;const{data:u}=c;if(u.type!=="webauthn")return{data:u,error:null};switch(u.webauthn.type){case"create":return{data:Object.assign(Object.assign({},u),{webauthn:Object.assign(Object.assign({},u.webauthn),{credential_options:Object.assign(Object.assign({},u.webauthn.credential_options),{publicKey:V4(u.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},u),{webauthn:Object.assign(Object.assign({},u.webauthn),{credential_options:Object.assign(Object.assign({},u.webauthn.credential_options),{publicKey:G4(u.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(rt(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(t){const{data:r,error:a}=await this._challenge({factorId:t.factorId});return a?this._returnResult({data:null,error:a}):await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:a}=await this.getUser();if(a)return{data:null,error:a};const s={all:[],phone:[],totp:[],webauthn:[]};for(const l of(t=r?.factors)!==null&&t!==void 0?t:[])s.all.push(l),l.status==="verified"&&s[l.factor_type].push(l);return{data:s,error:null}}async _getAuthenticatorAssuranceLevel(){var t,r;const{data:{session:a},error:s}=await this.getSession();if(s)return this._returnResult({data:null,error:s});if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:l}=_d(a.access_token);let c=null;l.aal&&(c=l.aal);let u=c;((r=(t=a.user.factors)===null||t===void 0?void 0:t.filter(g=>g.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(u="aal2");const d=l.amr||[];return{data:{currentLevel:c,nextLevel:u,currentAuthenticationMethods:d},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async r=>{const{data:{session:a},error:s}=r;return s?this._returnResult({data:null,error:s}):a?await lt(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:a.access_token,xform:l=>({data:l,error:null})}):this._returnResult({data:null,error:new Ha})})}catch(r){if(rt(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(t,r){try{return await this._useSession(async a=>{const{data:{session:s},error:l}=a;if(l)return this._returnResult({data:null,error:l});if(!s)return this._returnResult({data:null,error:new Ha});const c=await lt(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"approve"},xform:u=>({data:u,error:null})});return c.data&&c.data.redirect_url&&ea()&&!r?.skipBrowserRedirect&&window.location.assign(c.data.redirect_url),c})}catch(a){if(rt(a))return this._returnResult({data:null,error:a});throw a}}async _denyAuthorization(t,r){try{return await this._useSession(async a=>{const{data:{session:s},error:l}=a;if(l)return this._returnResult({data:null,error:l});if(!s)return this._returnResult({data:null,error:new Ha});const c=await lt(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"deny"},xform:u=>({data:u,error:null})});return c.data&&c.data.redirect_url&&ea()&&!r?.skipBrowserRedirect&&window.location.assign(c.data.redirect_url),c})}catch(a){if(rt(a))return this._returnResult({data:null,error:a});throw a}}async _listOAuthGrants(){try{return await this._useSession(async t=>{const{data:{session:r},error:a}=t;return a?this._returnResult({data:null,error:a}):r?await lt(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:s=>({data:s,error:null})}):this._returnResult({data:null,error:new Ha})})}catch(t){if(rt(t))return this._returnResult({data:null,error:t});throw t}}async _revokeOAuthGrant(t){try{return await this._useSession(async r=>{const{data:{session:a},error:s}=r;return s?this._returnResult({data:null,error:s}):a?(await lt(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:a.access_token,query:{client_id:t.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new Ha})})}catch(r){if(rt(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(t,r={keys:[]}){let a=r.keys.find(u=>u.kid===t);if(a)return a;const s=Date.now();if(a=this.jwks.keys.find(u=>u.kid===t),a&&this.jwks_cached_at+e4>s)return a;const{data:l,error:c}=await lt(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(c)throw c;return!l.keys||l.keys.length===0||(this.jwks=l,this.jwks_cached_at=s,a=l.keys.find(u=>u.kid===t),!a)?null:a}async getClaims(t,r={}){try{let a=t;if(!a){const{data:_,error:b}=await this.getSession();if(b||!_.session)return this._returnResult({data:null,error:b});a=_.session.access_token}const{header:s,payload:l,signature:c,raw:{header:u,payload:h}}=_d(a);r?.allowExpired||S4(l.exp);const d=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,r?.keys?{keys:r.keys}:r?.jwks);if(!d){const{error:_}=await this.getUser(a);if(_)throw _;return{data:{claims:l,header:s,signature:c},error:null}}const g=E4(s.alg),x=await crypto.subtle.importKey("jwk",d,g,!0,["verify"]);if(!await crypto.subtle.verify(g,x,c,u4(`${u}.${h}`)))throw new Wd("Invalid JWT signature");return{data:{claims:l,header:s,signature:c},error:null}}catch(a){if(rt(a))return this._returnResult({data:null,error:a});throw a}}}Tc.nextInstanceID={};const rk=Tc,ak="2.89.0";let lc="";typeof Deno<"u"?lc="deno":typeof document<"u"?lc="web":typeof navigator<"u"&&navigator.product==="ReactNative"?lc="react-native":lc="node";const nk={"X-Client-Info":`supabase-js-${lc}/${ak}`},sk={headers:nk},ik={schema:"public"},lk={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},ok={};function kc(e){"@babel/helpers - typeof";return kc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kc(e)}function ck(e,t){if(kc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(kc(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function uk(e){var t=ck(e,"string");return kc(t)=="symbol"?t:t+""}function fk(e,t,r){return(t=uk(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _v(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function vr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_v(Object(r),!0).forEach(function(a){fk(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_v(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}const hk=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),dk=()=>Headers,mk=(e,t,r)=>{const a=hk(r),s=dk();return async(l,c)=>{var u;const h=(u=await t())!==null&&u!==void 0?u:e;let d=new s(c?.headers);return d.has("apikey")||d.set("apikey",e),d.has("Authorization")||d.set("Authorization",`Bearer ${h}`),a(l,vr(vr({},c),{},{headers:d}))}};function gk(e){return e.endsWith("/")?e:e+"/"}function pk(e,t){var r,a;const{db:s,auth:l,realtime:c,global:u}=e,{db:h,auth:d,realtime:g,global:x}=t,v={db:vr(vr({},h),s),auth:vr(vr({},d),l),realtime:vr(vr({},g),c),storage:{},global:vr(vr(vr({},x),u),{},{headers:vr(vr({},(r=x?.headers)!==null&&r!==void 0?r:{}),(a=u?.headers)!==null&&a!==void 0?a:{})}),accessToken:async()=>""};return e.accessToken?v.accessToken=e.accessToken:delete v.accessToken,v}function xk(e){const t=e?.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(gk(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var vk=class extends rk{constructor(e){super(e)}},yk=class{constructor(e,t,r){var a,s;this.supabaseUrl=e,this.supabaseKey=t;const l=xk(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,u={db:ik,realtime:ok,auth:vr(vr({},lk),{},{storageKey:c}),global:sk},h=pk(r??{},u);if(this.storageKey=(a=h.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(s=h.global.headers)!==null&&s!==void 0?s:{},h.accessToken)this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(g,x)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(x)} is not possible`)}});else{var d;this.auth=this._initSupabaseAuthClient((d=h.auth)!==null&&d!==void 0?d:{},this.headers,h.global.fetch)}this.fetch=mk(t,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(vr({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.accessToken&&this.accessToken().then(g=>this.realtime.setAuth(g)).catch(g=>console.warn("Failed to set initial Realtime auth token:",g)),this.rest=new QE(new URL("rest/v1",l).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),this.storage=new KT(this.storageUrl.href,this.headers,this.fetch,r?.storage),h.accessToken||this._listenForAuthEvents()}get functions(){return new XE(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e=this,t,r;if(e.accessToken)return await e.accessToken();const{data:a}=await e.auth.getSession();return(t=(r=a.session)===null||r===void 0?void 0:r.access_token)!==null&&t!==void 0?t:e.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:a,userStorage:s,storageKey:l,flowType:c,lock:u,debug:h,throwOnError:d},g,x){const v={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new vk({url:this.authUrl.href,headers:vr(vr({},v),g),storageKey:l,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:a,userStorage:s,flowType:c,lock:u,debug:h,throwOnError:d,fetch:x,hasCustomAuthorizationHeader:Object.keys(this.headers).some(_=>_.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new gT(this.realtimeUrl.href,vr(vr({},e),{},{params:vr(vr({},{apikey:this.supabaseKey}),e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",t?.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const _k=(e,t,r)=>new yk(e,t,r);function wk(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}wk()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Ou="",bk="",Js=!!Ou,du=(()=>{try{return Ou&&new URL(Ou).hostname.split(".")[0]||null}catch{return null}})(),mu="supabase",wv=Js?_k(Ou,bk,{auth:{persistSession:!0,autoRefreshToken:!0}}):null,Dr={medications:"bodegapp:medications",monthlyBatches:"bodegapp:monthlyBatches",selectedMonthlyBatchId:"bodegapp:selectedMonthlyBatchId",tertiaryPackaging:"bodegapp:tertiaryPackaging",medicationCategories:"bodegapp:medicationCategories",orderCalendar:"bodegapp:orderCalendar"},Sk=[{id:1,inventory_type:"772",name:"Paracetamol",siges_code:"SIG-0001",sicop_classifier:"SICOP-CL-01",sicop_identifier:"SICOP-ID-0001",category:"Analgsico",batch:"LOT-2023-01",expiry_date:"2025-12-30",stock:500,min_stock:100,unit:"Tabletas"},{id:2,inventory_type:"772",name:"Amoxicilina",siges_code:"SIG-0002",sicop_classifier:"SICOP-CL-02",sicop_identifier:"SICOP-ID-0002",category:"Antibiotico",batch:"LOT-2023-05",expiry_date:"2024-06-15",stock:45,min_stock:50,unit:"Cpsulas"},{id:3,inventory_type:"772",name:"Ibuprofeno",siges_code:"SIG-0003",sicop_classifier:"SICOP-CL-03",sicop_identifier:"SICOP-ID-0003",category:"Antiinflamatorio",batch:"LOT-2023-09",expiry_date:"2026-01-20",stock:120,min_stock:40,unit:"Jarabe"},{id:4,inventory_type:"772",name:"Omeprazol",siges_code:"SIG-0004",sicop_classifier:"SICOP-CL-04",sicop_identifier:"SICOP-ID-0004",category:"Protector Gstrico",batch:"LOT-2023-12",expiry_date:"2025-03-10",stock:15,min_stock:30,unit:"Cpsulas"}];function a_(e){try{return JSON.parse(e)}catch{return null}}function sc(e){const t=window.localStorage.getItem(e);if(!t)return null;const r=a_(t);return Array.isArray(r)?r:null}function Oa(e,t){window.localStorage.setItem(e,JSON.stringify(t))}const Ek={async getMedications(){return sc(Dr.medications)??Sk},async clearMedicationsByInventoryType(e){const t=String(e||"772"),a=(await this.getMedications()??[]).filter(s=>String(s.inventory_type||"772")!==t);return Oa(Dr.medications,a),a},async upsertMedication(e){const t=await this.getMedications()??[],r=e?.id,a=r==null?[...t,e]:t.some(s=>s.id===r)?t.map(s=>s.id===r?e:s):[...t,e];return Oa(Dr.medications,a),e},async upsertMedications(e){const t=await this.getMedications()??[],r=new Map(t.map(s=>[s.id,s]));for(const s of e)r.set(s.id,s);const a=Array.from(r.values());return Oa(Dr.medications,a),a},async deleteMedication(e){const r=(await this.getMedications()??[]).filter(a=>a.id!==e);Oa(Dr.medications,r)},async clearMedications(){Oa(Dr.medications,[])},async getMonthlyBatches(){return(sc(Dr.monthlyBatches)??[]).map(t=>({...t,id:t?.id!=null?String(t.id):t.id}))},async saveMonthlyBatch(e){const t=await this.getMonthlyBatches()??[],r={...e,id:e?.id!=null?String(e.id):e.id},a=[r,...t.filter(s=>String(s.id)!==String(r.id))];return Oa(Dr.monthlyBatches,a),r},async getSelectedMonthlyBatchId(){const e=window.localStorage.getItem(Dr.selectedMonthlyBatchId),t=e?a_(e)??e:null;return t==null?null:String(t)},async setSelectedMonthlyBatchId(e){Oa(Dr.selectedMonthlyBatchId,e)},async getTertiaryPackaging(){return sc(Dr.tertiaryPackaging)??[]},async upsertTertiaryPackaging(e){const t=await this.getTertiaryPackaging()??[],r=new Map(t.map(s=>[String(s.siges_code||"").trim(),s]));for(const s of e??[]){const l=String(s?.siges_code||"").trim();l&&r.set(l,{...s,siges_code:l})}const a=Array.from(r.values());return Oa(Dr.tertiaryPackaging,a),a},async clearTertiaryPackaging(){Oa(Dr.tertiaryPackaging,[])},async getMedicationCategories(){return sc(Dr.medicationCategories)??[]},async upsertMedicationCategories(e){const t=await this.getMedicationCategories()??[],r=new Map(t.map(s=>[String(s.siges_code||"").trim(),s]));for(const s of e??[]){const l=String(s?.siges_code||"").trim();l&&r.set(l,{...s,siges_code:l})}const a=Array.from(r.values());return Oa(Dr.medicationCategories,a),a},async clearMedicationCategories(){Oa(Dr.medicationCategories,[])},async deleteMedicationCategory(e){const r=(await this.getMedicationCategories()??[]).filter(a=>String(a.id)!==String(e));Oa(Dr.medicationCategories,r)},async getOrderCalendar(){return sc(Dr.orderCalendar)??[]},async upsertOrderCalendarEntries(e){const t=await this.getOrderCalendar()??[],r=new Map(t.map(s=>[`${Number(s.year)||0}-${Number(s.month)||0}`,s]));for(const s of e??[]){const l=Number(s?.year)||0,c=Number(s?.month)||0;if(!l||c<1||c>12)continue;const u=`${l}-${c}`;r.set(u,{...s,year:l,month:c,scheduled_receipt_date:s?.scheduled_receipt_date?String(s.scheduled_receipt_date):null})}const a=Array.from(r.values());return Oa(Dr.orderCalendar,a),a},async clearOrderCalendar(){Oa(Dr.orderCalendar,[])}};function $r(){if(!wv)throw new Error("Supabase no est configurado (faltan VITE_SUPABASE_URL / VITE_SUPABASE_ANON_KEY).");return wv}function bv(e){return e?.id?e:globalThis.crypto?.randomUUID?{...e,id:globalThis.crypto.randomUUID()}:{...e,id:String(Date.now())}}const Tk={async getMedications(){const e=$r(),t=1e3;let r=0;const a=[];for(;;){const{data:s,error:l}=await e.from("medications").select("*").order("created_at",{ascending:!0}).range(r,r+t-1);if(l)throw l;const c=s??[];if(a.push(...c),c.length<t)break;r+=t}return a},async clearMedicationsByInventoryType(e){const t=$r(),r=String(e||"772"),{error:a}=await t.from("medications").delete().eq("inventory_type",r);if(a)throw a},async upsertMedication(e){const t=$r(),r=bv(e),{data:a,error:s}=await t.from("medications").upsert(r,{onConflict:"id"}).select("*").single();if(s)throw s;return a},async upsertMedications(e){const t=$r(),r=(e??[]).map(bv),{data:a,error:s}=await t.from("medications").upsert(r,{onConflict:"id"}).select("*");if(s)throw s;return a??[]},async deleteMedication(e){const t=$r(),{error:r}=await t.from("medications").delete().eq("id",e);if(r)throw r},async clearMedications(){const e=$r(),{error:t}=await e.from("medications").delete().neq("id","00000000-0000-0000-0000-000000000000");if(t)throw t},async getMonthlyBatches(){const e=$r(),{data:t,error:r}=await e.from("monthly_batches").select("id,label,items:monthly_batch_items(id,siges_code,medication_name,quantity,cost)").order("created_at",{ascending:!1});if(r)throw r;return(t??[]).map(a=>({...a,items:a.items??[]}))},async saveMonthlyBatch({id:e,label:t,items:r}){const a=$r(),{data:s,error:l}=await a.from("monthly_batches").upsert({id:e,label:t},{onConflict:"label"}).select("id,label").single();if(l)throw l;const{error:c}=await a.from("monthly_batch_items").delete().eq("batch_id",s.id);if(c)throw c;const u=(r??[]).map(h=>({id:globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():String(Date.now())+Math.random(),batch_id:s.id,siges_code:h.siges_code,medication_name:h.medication_name,quantity:h.quantity,cost:h.cost}));if(u.length>0){const{error:h}=await a.from("monthly_batch_items").insert(u);if(h)throw h}return{...s,items:r}},async getSelectedMonthlyBatchId(){return null},async setSelectedMonthlyBatchId(){},async getTertiaryPackaging(){const e=$r(),{data:t,error:r}=await e.from("tertiary_packaging").select("*").order("siges_code",{ascending:!0});if(r)throw r;return t??[]},async upsertTertiaryPackaging(e){const t=$r(),a=(e??[]).map(c=>({id:c?.id||(globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():String(Date.now())+Math.random()),siges_code:String(c?.siges_code||"").trim(),medication_name:String(c?.medication_name||"").trim(),tertiary_quantity:Number(c?.tertiary_quantity)||0})).filter(c=>!!c.siges_code);if(a.length===0)return[];const{data:s,error:l}=await t.from("tertiary_packaging").upsert(a,{onConflict:"siges_code"}).select("*");if(l)throw l;return s??[]},async clearTertiaryPackaging(){const e=$r(),{error:t}=await e.from("tertiary_packaging").delete().neq("id","00000000-0000-0000-0000-000000000000");if(t)throw t},async getMedicationCategories(){const e=$r(),{data:t,error:r}=await e.from("medication_categories").select("*").order("siges_code",{ascending:!0});if(r)throw r;return t??[]},async upsertMedicationCategories(e){const t=$r(),a=(e??[]).map(c=>({id:c?.id||(globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():String(Date.now())+Math.random()),siges_code:String(c?.siges_code||"").trim(),medication_name:String(c?.medication_name||"").trim(),category:String(c?.category||"").trim()})).filter(c=>!!(c.siges_code&&c.category));if(a.length===0)return[];const{data:s,error:l}=await t.from("medication_categories").upsert(a,{onConflict:"siges_code"}).select("*");if(l)throw l;return s??[]},async clearMedicationCategories(){const e=$r(),{error:t}=await e.from("medication_categories").delete().neq("id","00000000-0000-0000-0000-000000000000");if(t)throw t},async deleteMedicationCategory(e){const t=$r(),{error:r}=await t.from("medication_categories").delete().eq("id",e);if(r)throw r},async getOrderCalendar(){const e=$r(),{data:t,error:r}=await e.from("order_calendar").select("*").order("year",{ascending:!0}).order("month",{ascending:!0});if(r)throw r;return t??[]},async upsertOrderCalendarEntries(e){const t=$r(),a=(e??[]).map(c=>({id:c?.id||(globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():String(Date.now())+Math.random()),year:Number(c?.year)||0,month:Number(c?.month)||0,scheduled_receipt_date:c?.scheduled_receipt_date?String(c.scheduled_receipt_date):null})).filter(c=>c.year&&c.month>=1&&c.month<=12);if(a.length===0)return[];const{data:s,error:l}=await t.from("order_calendar").upsert(a,{onConflict:"year,month"}).select("*");if(l)throw l;return s??[]},async clearOrderCalendar(){const e=$r(),{error:t}=await e.from("order_calendar").delete().neq("id","00000000-0000-0000-0000-000000000000");if(t)throw t}},At=Js?Tk:Ek;var Ru={};Ru.version="0.18.5";var n_=1252,kk=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],gm={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},pm=function(e){kk.indexOf(e)!=-1&&(n_=gm[0]=e)};function Ak(){pm(1252)}var Tn=function(e){pm(e)};function xm(){Tn(1200),Ak()}function Sv(e){for(var t=[],r=0,a=e.length;r<a;++r)t[r]=e.charCodeAt(r);return t}function Ck(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function s_(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var oc=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?Ck(e.slice(2)):t==254&&r==255?s_(e.slice(2)):t==65279?e.slice(1):e},gu=function(t){return String.fromCharCode(t)},Ev=function(t){return String.fromCharCode(t)},Ac,Zs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Cc(e){for(var t="",r=0,a=0,s=0,l=0,c=0,u=0,h=0,d=0;d<e.length;)r=e.charCodeAt(d++),l=r>>2,a=e.charCodeAt(d++),c=(r&3)<<4|a>>4,s=e.charCodeAt(d++),u=(a&15)<<2|s>>6,h=s&63,isNaN(a)?u=h=64:isNaN(s)&&(h=64),t+=Zs.charAt(l)+Zs.charAt(c)+Zs.charAt(u)+Zs.charAt(h);return t}function Ka(e){var t="",r=0,a=0,s=0,l=0,c=0,u=0,h=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<e.length;)l=Zs.indexOf(e.charAt(d++)),c=Zs.indexOf(e.charAt(d++)),r=l<<2|c>>4,t+=String.fromCharCode(r),u=Zs.indexOf(e.charAt(d++)),a=(c&15)<<4|u>>2,u!==64&&(t+=String.fromCharCode(a)),h=Zs.indexOf(e.charAt(d++)),s=(u&3)<<6|h,h!==64&&(t+=String.fromCharCode(s));return t}var wt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),gs=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function ti(e){return wt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Tv(e){return wt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Xa=function(t){return wt?gs(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Wu(e){if(typeof ArrayBuffer>"u")return Xa(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),a=0;a!=e.length;++a)r[a]=e.charCodeAt(a)&255;return t}function ii(e){if(Array.isArray(e))return e.map(function(a){return String.fromCharCode(a)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function Nk(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function vm(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return vm(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Gr=wt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:gs(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var a=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)a.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";a.set(new Uint8Array(e[t]),r)}return a}return[].concat.apply([],e.map(function(l){return Array.isArray(l)?l:[].slice.call(l)}))};function Ok(e){for(var t=[],r=0,a=e.length+250,s=ti(e.length+255),l=0;l<e.length;++l){var c=e.charCodeAt(l);if(c<128)s[r++]=c;else if(c<2048)s[r++]=192|c>>6&31,s[r++]=128|c&63;else if(c>=55296&&c<57344){c=(c&1023)+64;var u=e.charCodeAt(++l)&1023;s[r++]=240|c>>8&7,s[r++]=128|c>>2&63,s[r++]=128|u>>6&15|(c&3)<<4,s[r++]=128|u&63}else s[r++]=224|c>>12&15,s[r++]=128|c>>6&63,s[r++]=128|c&63;r>a&&(t.push(s.slice(0,r)),r=0,s=ti(65535),a=65530)}return t.push(s.slice(0,r)),Gr(t)}var _a=/\u0000/g,cc=/[\u0001-\u0006]/g;function Jl(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function kn(e,t){var r=""+e;return r.length>=t?r:yr("0",t-r.length)+r}function ym(e,t){var r=""+e;return r.length>=t?r:yr(" ",t-r.length)+r}function Du(e,t){var r=""+e;return r.length>=t?r:r+yr(" ",t-r.length)}function Rk(e,t){var r=""+Math.round(e);return r.length>=t?r:yr("0",t-r.length)+r}function Dk(e,t){var r=""+e;return r.length>=t?r:yr("0",t-r.length)+r}var kv=Math.pow(2,32);function zl(e,t){if(e>kv||e<-kv)return Rk(e,t);var r=Math.round(e);return Dk(r,t)}function Fu(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Av=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Sd=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Fk(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var ct={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Cv={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Mk={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Mu(e,t,r){for(var a=e<0?-1:1,s=e*a,l=0,c=1,u=0,h=1,d=0,g=0,x=Math.floor(s);d<t&&(x=Math.floor(s),u=x*c+l,g=x*d+h,!(s-x<5e-8));)s=1/(s-x),l=c,c=u,h=d,d=g;if(g>t&&(d>t?(g=h,u=l):(g=d,u=c)),!r)return[0,a*u,g];var v=Math.floor(a*u/g);return[v,a*u-v*g,g]}function Li(e,t,r){if(e>2958465||e<0)return null;var a=e|0,s=Math.floor(86400*(e-a)),l=0,c=[],u={D:a,T:s,u:86400*(e-a)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),t&&t.date1904&&(a+=1462),u.u>.9999&&(u.u=0,++s==86400&&(u.T=s=0,++a,++u.D)),a===60)c=r?[1317,10,29]:[1900,2,29],l=3;else if(a===0)c=r?[1317,8,29]:[1900,1,0],l=6;else{a>60&&--a;var h=new Date(1900,0,1);h.setDate(h.getDate()+a-1),c=[h.getFullYear(),h.getMonth()+1,h.getDate()],l=h.getDay(),a<60&&(l=(l+6)%7),r&&(l=Pk(h,c))}return u.y=c[0],u.m=c[1],u.d=c[2],u.S=s%60,s=Math.floor(s/60),u.M=s%60,s=Math.floor(s/60),u.H=s,u.q=l,u}var i_=new Date(1899,11,31,0,0,0),Lk=i_.getTime(),Ik=new Date(1900,2,1,0,0,0);function l_(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=Ik&&(r+=1440*60*1e3),(r-(Lk+(e.getTimezoneOffset()-i_.getTimezoneOffset())*6e4))/(1440*60*1e3)}function _m(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Bk(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function jk(e){var t=e<0?12:11,r=_m(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function Uk(e){var t=_m(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Nc(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=jk(e):t===10?r=e.toFixed(10).substr(0,12):r=Uk(e),_m(Bk(r.toUpperCase()))}function Pi(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Nc(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return mn(14,l_(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Pk(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function zk(e,t,r,a){var s="",l=0,c=0,u=r.y,h,d=0;switch(e){case 98:u=r.y+543;case 121:switch(t.length){case 1:case 2:h=u%100,d=2;break;default:h=u%1e4,d=4;break}break;case 109:switch(t.length){case 1:case 2:h=r.m,d=t.length;break;case 3:return Sd[r.m-1][1];case 5:return Sd[r.m-1][0];default:return Sd[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:h=r.d,d=t.length;break;case 3:return Av[r.q][0];default:return Av[r.q][1]}break;case 104:switch(t.length){case 1:case 2:h=1+(r.H+11)%12,d=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:h=r.H,d=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:h=r.M,d=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?kn(r.S,t.length):(a>=2?c=a===3?1e3:100:c=a===1?10:1,l=Math.round(c*(r.S+r.u)),l>=60*c&&(l=0),t==="s"?l===0?"0":""+l/c:(s=kn(l,2+a),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":h=r.D*24+r.H;break;case"[m]":case"[mm]":h=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":h=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}d=t.length===3?1:2;break;case 101:h=u,d=1;break}var g=d>0?kn(h,d):"";return g}function ei(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,a=e.substr(0,r);r!=e.length;r+=t)a+=(a.length>0?",":"")+e.substr(r,t);return a}var o_=/%/g;function Hk(e,t,r){var a=t.replace(o_,""),s=t.length-a.length;return us(e,a,r*Math.pow(10,2*s))+yr("%",s)}function $k(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return us(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function c_(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+c_(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var l=Math.floor(Math.log(t)*Math.LOG10E)%s;if(l<0&&(l+=s),r=(t/Math.pow(10,l)).toPrecision(a+1+(s+l)%s),r.indexOf("e")===-1){var c=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(c-r.length+l):r+="E+"+(c-l);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,h,d,g){return h+d+g.substr(0,(s+l)%s)+"."+g.substr(l)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var u_=/# (\?+)( ?)\/( ?)(\d+)/;function Vk(e,t,r){var a=parseInt(e[4],10),s=Math.round(t*a),l=Math.floor(s/a),c=s-l*a,u=a;return r+(l===0?"":""+l)+" "+(c===0?yr(" ",e[1].length+1+e[4].length):ym(c,e[1].length)+e[2]+"/"+e[3]+kn(u,e[4].length))}function Gk(e,t,r){return r+(t===0?"":""+t)+yr(" ",e[1].length+2+e[4].length)}var f_=/^#*0*\.([0#]+)/,h_=/\).*[0#]/,d_=/\(###\) ###\\?-####/;function va(e){for(var t="",r,a=0;a!=e.length;++a)switch(r=e.charCodeAt(a)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function Nv(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Ov(e,t){var r=e-Math.floor(e),a=Math.pow(10,t);return t<(""+Math.round(r*a)).length?0:Math.round(r*a)}function qk(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function Xk(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function on(e,t,r){if(e.charCodeAt(0)===40&&!t.match(h_)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?on("n",a,r):"("+on("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return $k(e,t,r);if(t.indexOf("%")!==-1)return Hk(e,t,r);if(t.indexOf("E")!==-1)return c_(t,r);if(t.charCodeAt(0)===36)return"$"+on(e,t.substr(t.charAt(1)==" "?2:1),r);var s,l,c,u,h=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+zl(h,t.length);if(t.match(/^[#?]+$/))return s=zl(r,0),s==="0"&&(s=""),s.length>t.length?s:va(t.substr(0,t.length-s.length))+s;if(l=t.match(u_))return Vk(l,h,d);if(t.match(/^#+0+$/))return d+zl(h,t.length-t.indexOf("0"));if(l=t.match(f_))return s=Nv(r,l[1].length).replace(/^([^\.]+)$/,"$1."+va(l[1])).replace(/\.$/,"."+va(l[1])).replace(/\.(\d*)$/,function(b,y){return"."+y+yr("0",va(l[1]).length-y.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),l=t.match(/^(0*)\.(#*)$/))return d+Nv(h,l[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=t.match(/^#{1,3},##0(\.?)$/))return d+ei(zl(h,0));if(l=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+on(e,t,-r):ei(""+(Math.floor(r)+qk(r,l[1].length)))+"."+kn(Ov(r,l[1].length),l[1].length);if(l=t.match(/^#,#*,#0/))return on(e,t.replace(/^#,#*,/,""),r);if(l=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Jl(on(e,t.replace(/[\\-]/g,""),r)),c=0,Jl(Jl(t.replace(/\\/g,"")).replace(/[0#]/g,function(b){return c<s.length?s.charAt(c++):b==="0"?"0":""}));if(t.match(d_))return s=on(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var g="";if(l=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(l[4].length,7),u=Mu(h,Math.pow(10,c)-1,!1),s=""+d,g=us("n",l[1],u[1]),g.charAt(g.length-1)==" "&&(g=g.substr(0,g.length-1)+"0"),s+=g+l[2]+"/"+l[3],g=Du(u[2],c),g.length<l[4].length&&(g=va(l[4].substr(l[4].length-g.length))+g),s+=g,s;if(l=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(l[1].length,l[4].length),7),u=Mu(h,Math.pow(10,c)-1,!0),d+(u[0]||(u[1]?"":"0"))+" "+(u[1]?ym(u[1],c)+l[2]+"/"+l[3]+Du(u[2],c):yr(" ",2*c+1+l[2].length+l[3].length));if(l=t.match(/^[#0?]+$/))return s=zl(r,0),t.length<=s.length?s:va(t.substr(0,t.length-s.length))+s;if(l=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),c=s.indexOf(".");var x=t.indexOf(".")-c,v=t.length-s.length-x;return va(t.substr(0,x)+s+t.substr(t.length-v))}if(l=t.match(/^00,000\.([#0]*0)$/))return c=Ov(r,l[1].length),r<0?"-"+on(e,t,-r):ei(Xk(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?kn(0,3-b.length):"")+b})+"."+kn(c,l[1].length);switch(t){case"###,##0.00":return on(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var _=ei(zl(h,0));return _!=="0"?d+_:"";case"###,###.00":return on(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return on(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function Wk(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return us(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function Kk(e,t,r){var a=t.replace(o_,""),s=t.length-a.length;return us(e,a,r*Math.pow(10,2*s))+yr("%",s)}function m_(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+m_(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var l=Math.floor(Math.log(t)*Math.LOG10E)%s;if(l<0&&(l+=s),r=(t/Math.pow(10,l)).toPrecision(a+1+(s+l)%s),!r.match(/[Ee]/)){var c=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(c-r.length+l):r+="E+"+(c-l),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,h,d,g){return h+d+g.substr(0,(s+l)%s)+"."+g.substr(l)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Bn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(h_)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Bn("n",a,r):"("+Bn("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Wk(e,t,r);if(t.indexOf("%")!==-1)return Kk(e,t,r);if(t.indexOf("E")!==-1)return m_(t,r);if(t.charCodeAt(0)===36)return"$"+Bn(e,t.substr(t.charAt(1)==" "?2:1),r);var s,l,c,u,h=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+kn(h,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:va(t.substr(0,t.length-s.length))+s;if(l=t.match(u_))return Gk(l,h,d);if(t.match(/^#+0+$/))return d+kn(h,t.length-t.indexOf("0"));if(l=t.match(f_))return s=(""+r).replace(/^([^\.]+)$/,"$1."+va(l[1])).replace(/\.$/,"."+va(l[1])),s=s.replace(/\.(\d*)$/,function(b,y){return"."+y+yr("0",va(l[1]).length-y.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),l=t.match(/^(0*)\.(#*)$/))return d+(""+h).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=t.match(/^#{1,3},##0(\.?)$/))return d+ei(""+h);if(l=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Bn(e,t,-r):ei(""+r)+"."+yr("0",l[1].length);if(l=t.match(/^#,#*,#0/))return Bn(e,t.replace(/^#,#*,/,""),r);if(l=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Jl(Bn(e,t.replace(/[\\-]/g,""),r)),c=0,Jl(Jl(t.replace(/\\/g,"")).replace(/[0#]/g,function(b){return c<s.length?s.charAt(c++):b==="0"?"0":""}));if(t.match(d_))return s=Bn(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var g="";if(l=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(l[4].length,7),u=Mu(h,Math.pow(10,c)-1,!1),s=""+d,g=us("n",l[1],u[1]),g.charAt(g.length-1)==" "&&(g=g.substr(0,g.length-1)+"0"),s+=g+l[2]+"/"+l[3],g=Du(u[2],c),g.length<l[4].length&&(g=va(l[4].substr(l[4].length-g.length))+g),s+=g,s;if(l=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(l[1].length,l[4].length),7),u=Mu(h,Math.pow(10,c)-1,!0),d+(u[0]||(u[1]?"":"0"))+" "+(u[1]?ym(u[1],c)+l[2]+"/"+l[3]+Du(u[2],c):yr(" ",2*c+1+l[2].length+l[3].length));if(l=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:va(t.substr(0,t.length-s.length))+s;if(l=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),c=s.indexOf(".");var x=t.indexOf(".")-c,v=t.length-s.length-x;return va(t.substr(0,x)+s+t.substr(t.length-v))}if(l=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Bn(e,t,-r):ei(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?kn(0,3-b.length):"")+b})+"."+kn(0,l[1].length);switch(t){case"###,###":case"##,###":case"#,###":var _=ei(""+h);return _!=="0"?d+_:"";default:if(t.match(/\.[0#?]*$/))return Bn(e,t.slice(0,t.lastIndexOf(".")),r)+va(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function us(e,t,r){return(r|0)===r?Bn(e,t,r):on(e,t,r)}function Yk(e){for(var t=[],r=!1,a=0,s=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:r=!r;break;case 95:case 42:case 92:++a;break;case 59:t[t.length]=e.substr(s,a-s),s=a+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var g_=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function lo(e){for(var t=0,r="",a="";t<e.length;)switch(r=e.charAt(t)){case"G":Fu(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(a=r;e.charAt(t++)!=="]"&&t<e.length;)a+=e.charAt(t);if(a.match(g_))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function Jk(e,t,r,a){for(var s=[],l="",c=0,u="",h="t",d,g,x,v="H";c<e.length;)switch(u=e.charAt(c)){case"G":if(!Fu(e,c))throw new Error("unrecognized character "+u+" in "+e);s[s.length]={t:"G",v:"General"},c+=7;break;case'"':for(l="";(x=e.charCodeAt(++c))!==34&&c<e.length;)l+=String.fromCharCode(x);s[s.length]={t:"t",v:l},++c;break;case"\\":var _=e.charAt(++c),b=_==="("||_===")"?_:"t";s[s.length]={t:b,v:_},++c;break;case"_":s[s.length]={t:"t",v:" "},c+=2;break;case"@":s[s.length]={t:"T",v:t},++c;break;case"B":case"b":if(e.charAt(c+1)==="1"||e.charAt(c+1)==="2"){if(d==null&&(d=Li(t,r,e.charAt(c+1)==="2"),d==null))return"";s[s.length]={t:"X",v:e.substr(c,2)},h=u,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||d==null&&(d=Li(t,r),d==null))return"";for(l=u;++c<e.length&&e.charAt(c).toLowerCase()===u;)l+=u;u==="m"&&h.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=v),s[s.length]={t:u,v:l},h=u;break;case"A":case"a":case"":var y={t:u,v:u};if(d==null&&(d=Li(t,r)),e.substr(c,3).toUpperCase()==="A/P"?(d!=null&&(y.v=d.H>=12?"P":"A"),y.t="T",v="h",c+=3):e.substr(c,5).toUpperCase()==="AM/PM"?(d!=null&&(y.v=d.H>=12?"PM":"AM"),y.t="T",c+=5,v="h"):e.substr(c,5).toUpperCase()==="/"?(d!=null&&(y.v=d.H>=12?"":""),y.t="T",c+=5,v="h"):(y.t="t",++c),d==null&&y.t==="T")return"";s[s.length]=y,h=u;break;case"[":for(l=u;e.charAt(c++)!=="]"&&c<e.length;)l+=e.charAt(c);if(l.slice(-1)!=="]")throw'unterminated "[" block: |'+l+"|";if(l.match(g_)){if(d==null&&(d=Li(t,r),d==null))return"";s[s.length]={t:"Z",v:l.toLowerCase()},h=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",lo(e)||(s[s.length]={t:"t",v:l}));break;case".":if(d!=null){for(l=u;++c<e.length&&(u=e.charAt(c))==="0";)l+=u;s[s.length]={t:"s",v:l};break}case"0":case"#":for(l=u;++c<e.length&&"0#?.,E+-%".indexOf(u=e.charAt(c))>-1;)l+=u;s[s.length]={t:"n",v:l};break;case"?":for(l=u;e.charAt(++c)===u;)l+=u;s[s.length]={t:u,v:l},h=u;break;case"*":++c,(e.charAt(c)==" "||e.charAt(c)=="*")&&++c;break;case"(":case")":s[s.length]={t:a===1?"t":u,v:u},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=u;c<e.length&&"0123456789".indexOf(e.charAt(++c))>-1;)l+=e.charAt(c);s[s.length]={t:"D",v:l};break;case" ":s[s.length]={t:u,v:u},++c;break;case"$":s[s.length]={t:"t",v:"$"},++c;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+e);s[s.length]={t:"t",v:u},++c;break}var S=0,k=0,O;for(c=s.length-1,h="t";c>=0;--c)switch(s[c].t){case"h":case"H":s[c].t=v,h="h",S<1&&(S=1);break;case"s":(O=s[c].v.match(/\.0+$/))&&(k=Math.max(k,O[0].length-1)),S<3&&(S=3);case"d":case"y":case"M":case"e":h=s[c].t;break;case"m":h==="s"&&(s[c].t="M",S<2&&(S=2));break;case"X":break;case"Z":S<1&&s[c].v.match(/[Hh]/)&&(S=1),S<2&&s[c].v.match(/[Mm]/)&&(S=2),S<3&&s[c].v.match(/[Ss]/)&&(S=3)}switch(S){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var T="",j;for(c=0;c<s.length;++c)switch(s[c].t){case"t":case"T":case" ":case"D":break;case"X":s[c].v="",s[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[c].v=zk(s[c].t.charCodeAt(0),s[c].v,d,k),s[c].t="t";break;case"n":case"?":for(j=c+1;s[j]!=null&&((u=s[j].t)==="?"||u==="D"||(u===" "||u==="t")&&s[j+1]!=null&&(s[j+1].t==="?"||s[j+1].t==="t"&&s[j+1].v==="/")||s[c].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(s[j].v==="/"||s[j].v===" "&&s[j+1]!=null&&s[j+1].t=="?"));)s[c].v+=s[j].v,s[j]={v:"",t:";"},++j;T+=s[c].v,c=j-1;break;case"G":s[c].t="t",s[c].v=Pi(t,r);break}var X="",I,C;if(T.length>0){T.charCodeAt(0)==40?(I=t<0&&T.charCodeAt(0)===45?-t:t,C=us("n",T,I)):(I=t<0&&a>1?-t:t,C=us("n",T,I),I<0&&s[0]&&s[0].t=="t"&&(C=C.substr(1),s[0].v="-"+s[0].v)),j=C.length-1;var K=s.length;for(c=0;c<s.length;++c)if(s[c]!=null&&s[c].t!="t"&&s[c].v.indexOf(".")>-1){K=c;break}var q=s.length;if(K===s.length&&C.indexOf("E")===-1){for(c=s.length-1;c>=0;--c)s[c]==null||"n?".indexOf(s[c].t)===-1||(j>=s[c].v.length-1?(j-=s[c].v.length,s[c].v=C.substr(j+1,s[c].v.length)):j<0?s[c].v="":(s[c].v=C.substr(0,j+1),j=-1),s[c].t="t",q=c);j>=0&&q<s.length&&(s[q].v=C.substr(0,j+1)+s[q].v)}else if(K!==s.length&&C.indexOf("E")===-1){for(j=C.indexOf(".")-1,c=K;c>=0;--c)if(!(s[c]==null||"n?".indexOf(s[c].t)===-1)){for(g=s[c].v.indexOf(".")>-1&&c===K?s[c].v.indexOf(".")-1:s[c].v.length-1,X=s[c].v.substr(g+1);g>=0;--g)j>=0&&(s[c].v.charAt(g)==="0"||s[c].v.charAt(g)==="#")&&(X=C.charAt(j--)+X);s[c].v=X,s[c].t="t",q=c}for(j>=0&&q<s.length&&(s[q].v=C.substr(0,j+1)+s[q].v),j=C.indexOf(".")+1,c=K;c<s.length;++c)if(!(s[c]==null||"n?(".indexOf(s[c].t)===-1&&c!==K)){for(g=s[c].v.indexOf(".")>-1&&c===K?s[c].v.indexOf(".")+1:0,X=s[c].v.substr(0,g);g<s[c].v.length;++g)j<C.length&&(X+=C.charAt(j++));s[c].v=X,s[c].t="t",q=c}}}for(c=0;c<s.length;++c)s[c]!=null&&"n?".indexOf(s[c].t)>-1&&(I=a>1&&t<0&&c>0&&s[c-1].v==="-"?-t:t,s[c].v=us(s[c].t,s[c].v,I),s[c].t="t");var oe="";for(c=0;c!==s.length;++c)s[c]!=null&&(oe+=s[c].v);return oe}var Rv=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Dv(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function Qk(e,t){var r=Yk(e),a=r.length,s=r[a-1].indexOf("@");if(a<4&&s>-1&&--a,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var l=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[a,l];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var c=r[0].match(Rv),u=r[1].match(Rv);return Dv(t,c)?[a,r[0]]:Dv(t,u)?[a,r[1]]:[a,r[c!=null&&u!=null?2:1]]}return[a,l]}function mn(e,t,r){r==null&&(r={});var a="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?a=r.dateNF:a=e;break;case"number":e==14&&r.dateNF?a=r.dateNF:a=(r.table!=null?r.table:ct)[e],a==null&&(a=r.table&&r.table[Cv[e]]||ct[Cv[e]]),a==null&&(a=Mk[e]||"General");break}if(Fu(a,0))return Pi(t,r);t instanceof Date&&(t=l_(t,r.date1904));var s=Qk(a,t);if(Fu(s[1]))return Pi(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return Jk(s[1],t,r,s[0])}function fs(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(ct[r]==null){t<0&&(t=r);continue}if(ct[r]==e){t=r;break}}t<0&&(t=391)}return ct[t]=e,t}function Ku(e){for(var t=0;t!=392;++t)e[t]!==void 0&&fs(e[t],t)}function oo(){ct=Fk()}var Zk={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},p_=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function eA(e){var t=typeof e=="number"?ct[e]:e;return t=t.replace(p_,"(\\d+)"),new RegExp("^"+t+"$")}function tA(e,t,r){var a=-1,s=-1,l=-1,c=-1,u=-1,h=-1;(t.match(p_)||[]).forEach(function(x,v){var _=parseInt(r[v+1],10);switch(x.toLowerCase().charAt(0)){case"y":a=_;break;case"d":l=_;break;case"h":c=_;break;case"s":h=_;break;case"m":c>=0?u=_:s=_;break}}),h>=0&&u==-1&&s>=0&&(u=s,s=-1);var d=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(l>=1?l:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var g=("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(h>=0?h:0)).slice(-2);return c==-1&&u==-1&&h==-1?d:a==-1&&s==-1&&l==-1?g:d+"T"+g}var rA=(function(){var e={};e.version="1.2.0";function t(){for(var C=0,K=new Array(256),q=0;q!=256;++q)C=q,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,K[q]=C;return typeof Int32Array<"u"?new Int32Array(K):K}var r=t();function a(C){var K=0,q=0,oe=0,ee=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(oe=0;oe!=256;++oe)ee[oe]=C[oe];for(oe=0;oe!=256;++oe)for(q=C[oe],K=256+oe;K<4096;K+=256)q=ee[K]=q>>>8^C[q&255];var Z=[];for(oe=1;oe!=16;++oe)Z[oe-1]=typeof Int32Array<"u"?ee.subarray(oe*256,oe*256+256):ee.slice(oe*256,oe*256+256);return Z}var s=a(r),l=s[0],c=s[1],u=s[2],h=s[3],d=s[4],g=s[5],x=s[6],v=s[7],_=s[8],b=s[9],y=s[10],S=s[11],k=s[12],O=s[13],T=s[14];function j(C,K){for(var q=K^-1,oe=0,ee=C.length;oe<ee;)q=q>>>8^r[(q^C.charCodeAt(oe++))&255];return~q}function X(C,K){for(var q=K^-1,oe=C.length-15,ee=0;ee<oe;)q=T[C[ee++]^q&255]^O[C[ee++]^q>>8&255]^k[C[ee++]^q>>16&255]^S[C[ee++]^q>>>24]^y[C[ee++]]^b[C[ee++]]^_[C[ee++]]^v[C[ee++]]^x[C[ee++]]^g[C[ee++]]^d[C[ee++]]^h[C[ee++]]^u[C[ee++]]^c[C[ee++]]^l[C[ee++]]^r[C[ee++]];for(oe+=15;ee<oe;)q=q>>>8^r[(q^C[ee++])&255];return~q}function I(C,K){for(var q=K^-1,oe=0,ee=C.length,Z=0,xe=0;oe<ee;)Z=C.charCodeAt(oe++),Z<128?q=q>>>8^r[(q^Z)&255]:Z<2048?(q=q>>>8^r[(q^(192|Z>>6&31))&255],q=q>>>8^r[(q^(128|Z&63))&255]):Z>=55296&&Z<57344?(Z=(Z&1023)+64,xe=C.charCodeAt(oe++)&1023,q=q>>>8^r[(q^(240|Z>>8&7))&255],q=q>>>8^r[(q^(128|Z>>2&63))&255],q=q>>>8^r[(q^(128|xe>>6&15|(Z&3)<<4))&255],q=q>>>8^r[(q^(128|xe&63))&255]):(q=q>>>8^r[(q^(224|Z>>12&15))&255],q=q>>>8^r[(q^(128|Z>>6&63))&255],q=q>>>8^r[(q^(128|Z&63))&255]);return~q}return e.table=r,e.bstr=j,e.buf=X,e.str=I,e})(),st=(function(){var t={};t.version="1.2.1";function r(A,U){for(var D=A.split("/"),F=U.split("/"),B=0,H=0,ie=Math.min(D.length,F.length);B<ie;++B){if(H=D[B].length-F[B].length)return H;if(D[B]!=F[B])return D[B]<F[B]?-1:1}return D.length-F.length}function a(A){if(A.charAt(A.length-1)=="/")return A.slice(0,-1).indexOf("/")===-1?A:a(A.slice(0,-1));var U=A.lastIndexOf("/");return U===-1?A:A.slice(0,U+1)}function s(A){if(A.charAt(A.length-1)=="/")return s(A.slice(0,-1));var U=A.lastIndexOf("/");return U===-1?A:A.slice(U+1)}function l(A,U){typeof U=="string"&&(U=new Date(U));var D=U.getHours();D=D<<6|U.getMinutes(),D=D<<5|U.getSeconds()>>>1,A.write_shift(2,D);var F=U.getFullYear()-1980;F=F<<4|U.getMonth()+1,F=F<<5|U.getDate(),A.write_shift(2,F)}function c(A){var U=A.read_shift(2)&65535,D=A.read_shift(2)&65535,F=new Date,B=D&31;D>>>=5;var H=D&15;D>>>=4,F.setMilliseconds(0),F.setFullYear(D+1980),F.setMonth(H-1),F.setDate(B);var ie=U&31;U>>>=5;var _e=U&63;return U>>>=6,F.setHours(U),F.setMinutes(_e),F.setSeconds(ie<<1),F}function u(A){ra(A,0);for(var U={},D=0;A.l<=A.length-4;){var F=A.read_shift(2),B=A.read_shift(2),H=A.l+B,ie={};F===21589&&(D=A.read_shift(1),D&1&&(ie.mtime=A.read_shift(4)),B>5&&(D&2&&(ie.atime=A.read_shift(4)),D&4&&(ie.ctime=A.read_shift(4))),ie.mtime&&(ie.mt=new Date(ie.mtime*1e3))),A.l=H,U[F]=ie}return U}var h;function d(){return h||(h={})}function g(A,U){if(A[0]==80&&A[1]==75)return Hn(A,U);if((A[0]|32)==109&&(A[1]|32)==105)return Vn(A,U);if(A.length<512)throw new Error("CFB file size "+A.length+" < 512");var D=3,F=512,B=0,H=0,ie=0,_e=0,se=0,fe=[],he=A.slice(0,512);ra(he,0);var Oe=x(he);switch(D=Oe[0],D){case 3:F=512;break;case 4:F=4096;break;case 0:if(Oe[1]==0)return Hn(A,U);default:throw new Error("Major Version: Expected 3 or 4 saw "+D)}F!==512&&(he=A.slice(0,F),ra(he,28));var Fe=A.slice(0,F);v(he,D);var He=he.read_shift(4,"i");if(D===3&&He!==0)throw new Error("# Directory Sectors: Expected 0 saw "+He);he.l+=4,ie=he.read_shift(4,"i"),he.l+=4,he.chk("00100000","Mini Stream Cutoff Size: "),_e=he.read_shift(4,"i"),B=he.read_shift(4,"i"),se=he.read_shift(4,"i"),H=he.read_shift(4,"i");for(var Re=-1,je=0;je<109&&(Re=he.read_shift(4,"i"),!(Re<0));++je)fe[je]=Re;var We=_(A,F);S(se,H,We,F,fe);var qt=O(We,ie,fe,F);qt[ie].name="!Directory",B>0&&_e!==xe&&(qt[_e].name="!MiniFAT"),qt[fe[0]].name="!FAT",qt.fat_addrs=fe,qt.ssz=F;var Xt={},er=[],ba=[],pn=[];T(ie,qt,We,er,B,Xt,ba,_e),b(ba,pn,er),er.shift();var xn={FileIndex:ba,FullPaths:pn};return U&&U.raw&&(xn.raw={header:Fe,sectors:We}),xn}function x(A){if(A[A.l]==80&&A[A.l+1]==75)return[0,0];A.chk(Ce,"Header Signature: "),A.l+=16;var U=A.read_shift(2,"u");return[A.read_shift(2,"u"),U]}function v(A,U){var D=9;switch(A.l+=2,D=A.read_shift(2)){case 9:if(U!=3)throw new Error("Sector Shift: Expected 9 saw "+D);break;case 12:if(U!=4)throw new Error("Sector Shift: Expected 12 saw "+D);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+D)}A.chk("0600","Mini Sector Shift: "),A.chk("000000000000","Reserved: ")}function _(A,U){for(var D=Math.ceil(A.length/U)-1,F=[],B=1;B<D;++B)F[B-1]=A.slice(B*U,(B+1)*U);return F[D-1]=A.slice(D*U),F}function b(A,U,D){for(var F=0,B=0,H=0,ie=0,_e=0,se=D.length,fe=[],he=[];F<se;++F)fe[F]=he[F]=F,U[F]=D[F];for(;_e<he.length;++_e)F=he[_e],B=A[F].L,H=A[F].R,ie=A[F].C,fe[F]===F&&(B!==-1&&fe[B]!==B&&(fe[F]=fe[B]),H!==-1&&fe[H]!==H&&(fe[F]=fe[H])),ie!==-1&&(fe[ie]=F),B!==-1&&F!=fe[F]&&(fe[B]=fe[F],he.lastIndexOf(B)<_e&&he.push(B)),H!==-1&&F!=fe[F]&&(fe[H]=fe[F],he.lastIndexOf(H)<_e&&he.push(H));for(F=1;F<se;++F)fe[F]===F&&(H!==-1&&fe[H]!==H?fe[F]=fe[H]:B!==-1&&fe[B]!==B&&(fe[F]=fe[B]));for(F=1;F<se;++F)if(A[F].type!==0){if(_e=F,_e!=fe[_e])do _e=fe[_e],U[F]=U[_e]+"/"+U[F];while(_e!==0&&fe[_e]!==-1&&_e!=fe[_e]);fe[F]=-1}for(U[0]+="/",F=1;F<se;++F)A[F].type!==2&&(U[F]+="/")}function y(A,U,D){for(var F=A.start,B=A.size,H=[],ie=F;D&&B>0&&ie>=0;)H.push(U.slice(ie*Z,ie*Z+Z)),B-=Z,ie=Fi(D,ie*4);return H.length===0?ve(0):Gr(H).slice(0,A.size)}function S(A,U,D,F,B){var H=xe;if(A===xe){if(U!==0)throw new Error("DIFAT chain shorter than expected")}else if(A!==-1){var ie=D[A],_e=(F>>>2)-1;if(!ie)return;for(var se=0;se<_e&&(H=Fi(ie,se*4))!==xe;++se)B.push(H);S(Fi(ie,F-4),U-1,D,F,B)}}function k(A,U,D,F,B){var H=[],ie=[];B||(B=[]);var _e=F-1,se=0,fe=0;for(se=U;se>=0;){B[se]=!0,H[H.length]=se,ie.push(A[se]);var he=D[Math.floor(se*4/F)];if(fe=se*4&_e,F<4+fe)throw new Error("FAT boundary crossed: "+se+" 4 "+F);if(!A[he])break;se=Fi(A[he],fe)}return{nodes:H,data:Vv([ie])}}function O(A,U,D,F){var B=A.length,H=[],ie=[],_e=[],se=[],fe=F-1,he=0,Oe=0,Fe=0,He=0;for(he=0;he<B;++he)if(_e=[],Fe=he+U,Fe>=B&&(Fe-=B),!ie[Fe]){se=[];var Re=[];for(Oe=Fe;Oe>=0;){Re[Oe]=!0,ie[Oe]=!0,_e[_e.length]=Oe,se.push(A[Oe]);var je=D[Math.floor(Oe*4/F)];if(He=Oe*4&fe,F<4+He)throw new Error("FAT boundary crossed: "+Oe+" 4 "+F);if(!A[je]||(Oe=Fi(A[je],He),Re[Oe]))break}H[Fe]={nodes:_e,data:Vv([se])}}return H}function T(A,U,D,F,B,H,ie,_e){for(var se=0,fe=F.length?2:0,he=U[A].data,Oe=0,Fe=0,He;Oe<he.length;Oe+=128){var Re=he.slice(Oe,Oe+128);ra(Re,64),Fe=Re.read_shift(2),He=Am(Re,0,Fe-fe),F.push(He);var je={name:He,type:Re.read_shift(1),color:Re.read_shift(1),L:Re.read_shift(4,"i"),R:Re.read_shift(4,"i"),C:Re.read_shift(4,"i"),clsid:Re.read_shift(16),state:Re.read_shift(4,"i"),start:0,size:0},We=Re.read_shift(2)+Re.read_shift(2)+Re.read_shift(2)+Re.read_shift(2);We!==0&&(je.ct=j(Re,Re.l-8));var qt=Re.read_shift(2)+Re.read_shift(2)+Re.read_shift(2)+Re.read_shift(2);qt!==0&&(je.mt=j(Re,Re.l-8)),je.start=Re.read_shift(4,"i"),je.size=Re.read_shift(4,"i"),je.size<0&&je.start<0&&(je.size=je.type=0,je.start=xe,je.name=""),je.type===5?(se=je.start,B>0&&se!==xe&&(U[se].name="!StreamData")):je.size>=4096?(je.storage="fat",U[je.start]===void 0&&(U[je.start]=k(D,je.start,U.fat_addrs,U.ssz)),U[je.start].name=je.name,je.content=U[je.start].data.slice(0,je.size)):(je.storage="minifat",je.size<0?je.size=0:se!==xe&&je.start!==xe&&U[se]&&(je.content=y(je,U[se].data,(U[_e]||{}).data))),je.content&&ra(je.content,0),H[He]=je,ie.push(je)}}function j(A,U){return new Date((Va(A,U+4)/1e7*Math.pow(2,32)+Va(A,U)/1e7-11644473600)*1e3)}function X(A,U){return d(),g(h.readFileSync(A),U)}function I(A,U){var D=U&&U.type;switch(D||wt&&Buffer.isBuffer(A)&&(D="buffer"),D||"base64"){case"file":return X(A,U);case"base64":return g(Xa(Ka(A)),U);case"binary":return g(Xa(A),U)}return g(A,U)}function C(A,U){var D=U||{},F=D.root||"Root Entry";if(A.FullPaths||(A.FullPaths=[]),A.FileIndex||(A.FileIndex=[]),A.FullPaths.length!==A.FileIndex.length)throw new Error("inconsistent CFB structure");A.FullPaths.length===0&&(A.FullPaths[0]=F+"/",A.FileIndex[0]={name:F,type:5}),D.CLSID&&(A.FileIndex[0].clsid=D.CLSID),K(A)}function K(A){var U="Sh33tJ5";if(!st.find(A,"/"+U)){var D=ve(4);D[0]=55,D[1]=D[3]=50,D[2]=54,A.FileIndex.push({name:U,type:2,content:D,size:4,L:69,R:69,C:69}),A.FullPaths.push(A.FullPaths[0]+U),q(A)}}function q(A,U){C(A);for(var D=!1,F=!1,B=A.FullPaths.length-1;B>=0;--B){var H=A.FileIndex[B];switch(H.type){case 0:F?D=!0:(A.FileIndex.pop(),A.FullPaths.pop());break;case 1:case 2:case 5:F=!0,isNaN(H.R*H.L*H.C)&&(D=!0),H.R>-1&&H.L>-1&&H.R==H.L&&(D=!0);break;default:D=!0;break}}if(!(!D&&!U)){var ie=new Date(1987,1,19),_e=0,se=Object.create?Object.create(null):{},fe=[];for(B=0;B<A.FullPaths.length;++B)se[A.FullPaths[B]]=!0,A.FileIndex[B].type!==0&&fe.push([A.FullPaths[B],A.FileIndex[B]]);for(B=0;B<fe.length;++B){var he=a(fe[B][0]);F=se[he],F||(fe.push([he,{name:s(he).replace("/",""),type:1,clsid:G,ct:ie,mt:ie,content:null}]),se[he]=!0)}for(fe.sort(function(He,Re){return r(He[0],Re[0])}),A.FullPaths=[],A.FileIndex=[],B=0;B<fe.length;++B)A.FullPaths[B]=fe[B][0],A.FileIndex[B]=fe[B][1];for(B=0;B<fe.length;++B){var Oe=A.FileIndex[B],Fe=A.FullPaths[B];if(Oe.name=s(Fe).replace("/",""),Oe.L=Oe.R=Oe.C=-(Oe.color=1),Oe.size=Oe.content?Oe.content.length:0,Oe.start=0,Oe.clsid=Oe.clsid||G,B===0)Oe.C=fe.length>1?1:-1,Oe.size=0,Oe.type=5;else if(Fe.slice(-1)=="/"){for(_e=B+1;_e<fe.length&&a(A.FullPaths[_e])!=Fe;++_e);for(Oe.C=_e>=fe.length?-1:_e,_e=B+1;_e<fe.length&&a(A.FullPaths[_e])!=a(Fe);++_e);Oe.R=_e>=fe.length?-1:_e,Oe.type=1}else a(A.FullPaths[B+1]||"")==a(Fe)&&(Oe.R=B+1),Oe.type=2}}}function oe(A,U){var D=U||{};if(D.fileType=="mad")return mo(A,D);if(q(A),D.fileType==="zip")return ys(A,D);var F=(function(He){for(var Re=0,je=0,We=0;We<He.FileIndex.length;++We){var qt=He.FileIndex[We];if(qt.content){var Xt=qt.content.length;Xt>0&&(Xt<4096?Re+=Xt+63>>6:je+=Xt+511>>9)}}for(var er=He.FullPaths.length+3>>2,ba=Re+7>>3,pn=Re+127>>7,xn=ba+je+er+pn,Y=xn+127>>7,re=Y<=109?0:Math.ceil((Y-109)/127);xn+Y+re+127>>7>Y;)re=++Y<=109?0:Math.ceil((Y-109)/127);var le=[1,re,Y,pn,er,je,Re,0];return He.FileIndex[0].size=Re<<6,le[7]=(He.FileIndex[0].start=le[0]+le[1]+le[2]+le[3]+le[4]+le[5])+(le[6]+7>>3),le})(A),B=ve(F[7]<<9),H=0,ie=0;{for(H=0;H<8;++H)B.write_shift(1,Se[H]);for(H=0;H<8;++H)B.write_shift(2,0);for(B.write_shift(2,62),B.write_shift(2,3),B.write_shift(2,65534),B.write_shift(2,9),B.write_shift(2,6),H=0;H<3;++H)B.write_shift(2,0);for(B.write_shift(4,0),B.write_shift(4,F[2]),B.write_shift(4,F[0]+F[1]+F[2]+F[3]-1),B.write_shift(4,0),B.write_shift(4,4096),B.write_shift(4,F[3]?F[0]+F[1]+F[2]-1:xe),B.write_shift(4,F[3]),B.write_shift(-4,F[1]?F[0]-1:xe),B.write_shift(4,F[1]),H=0;H<109;++H)B.write_shift(-4,H<F[2]?F[1]+H:-1)}if(F[1])for(ie=0;ie<F[1];++ie){for(;H<236+ie*127;++H)B.write_shift(-4,H<F[2]?F[1]+H:-1);B.write_shift(-4,ie===F[1]-1?xe:ie+1)}var _e=function(He){for(ie+=He;H<ie-1;++H)B.write_shift(-4,H+1);He&&(++H,B.write_shift(-4,xe))};for(ie=H=0,ie+=F[1];H<ie;++H)B.write_shift(-4,ne.DIFSECT);for(ie+=F[2];H<ie;++H)B.write_shift(-4,ne.FATSECT);_e(F[3]),_e(F[4]);for(var se=0,fe=0,he=A.FileIndex[0];se<A.FileIndex.length;++se)he=A.FileIndex[se],he.content&&(fe=he.content.length,!(fe<4096)&&(he.start=ie,_e(fe+511>>9)));for(_e(F[6]+7>>3);B.l&511;)B.write_shift(-4,ne.ENDOFCHAIN);for(ie=H=0,se=0;se<A.FileIndex.length;++se)he=A.FileIndex[se],he.content&&(fe=he.content.length,!(!fe||fe>=4096)&&(he.start=ie,_e(fe+63>>6)));for(;B.l&511;)B.write_shift(-4,ne.ENDOFCHAIN);for(H=0;H<F[4]<<2;++H){var Oe=A.FullPaths[H];if(!Oe||Oe.length===0){for(se=0;se<17;++se)B.write_shift(4,0);for(se=0;se<3;++se)B.write_shift(4,-1);for(se=0;se<12;++se)B.write_shift(4,0);continue}he=A.FileIndex[H],H===0&&(he.start=he.size?he.start-1:xe);var Fe=H===0&&D.root||he.name;if(fe=2*(Fe.length+1),B.write_shift(64,Fe,"utf16le"),B.write_shift(2,fe),B.write_shift(1,he.type),B.write_shift(1,he.color),B.write_shift(-4,he.L),B.write_shift(-4,he.R),B.write_shift(-4,he.C),he.clsid)B.write_shift(16,he.clsid,"hex");else for(se=0;se<4;++se)B.write_shift(4,0);B.write_shift(4,he.state||0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,he.start),B.write_shift(4,he.size),B.write_shift(4,0)}for(H=1;H<A.FileIndex.length;++H)if(he=A.FileIndex[H],he.size>=4096)if(B.l=he.start+1<<9,wt&&Buffer.isBuffer(he.content))he.content.copy(B,B.l,0,he.size),B.l+=he.size+511&-512;else{for(se=0;se<he.size;++se)B.write_shift(1,he.content[se]);for(;se&511;++se)B.write_shift(1,0)}for(H=1;H<A.FileIndex.length;++H)if(he=A.FileIndex[H],he.size>0&&he.size<4096)if(wt&&Buffer.isBuffer(he.content))he.content.copy(B,B.l,0,he.size),B.l+=he.size+63&-64;else{for(se=0;se<he.size;++se)B.write_shift(1,he.content[se]);for(;se&63;++se)B.write_shift(1,0)}if(wt)B.l=B.length;else for(;B.l<B.length;)B.write_shift(1,0);return B}function ee(A,U){var D=A.FullPaths.map(function(se){return se.toUpperCase()}),F=D.map(function(se){var fe=se.split("/");return fe[fe.length-(se.slice(-1)=="/"?2:1)]}),B=!1;U.charCodeAt(0)===47?(B=!0,U=D[0].slice(0,-1)+U):B=U.indexOf("/")!==-1;var H=U.toUpperCase(),ie=B===!0?D.indexOf(H):F.indexOf(H);if(ie!==-1)return A.FileIndex[ie];var _e=!H.match(cc);for(H=H.replace(_a,""),_e&&(H=H.replace(cc,"!")),ie=0;ie<D.length;++ie)if((_e?D[ie].replace(cc,"!"):D[ie]).replace(_a,"")==H||(_e?F[ie].replace(cc,"!"):F[ie]).replace(_a,"")==H)return A.FileIndex[ie];return null}var Z=64,xe=-2,Ce="d0cf11e0a1b11ae1",Se=[208,207,17,224,161,177,26,225],G="00000000000000000000000000000000",ne={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:xe,FREESECT:-1,HEADER_SIGNATURE:Ce,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:G,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function pe(A,U,D){d();var F=oe(A,D);h.writeFileSync(U,F)}function J(A){for(var U=new Array(A.length),D=0;D<A.length;++D)U[D]=String.fromCharCode(A[D]);return U.join("")}function be(A,U){var D=oe(A,U);switch(U&&U.type||"buffer"){case"file":return d(),h.writeFileSync(U.filename,D),D;case"binary":return typeof D=="string"?D:J(D);case"base64":return Cc(typeof D=="string"?D:J(D));case"buffer":if(wt)return Buffer.isBuffer(D)?D:gs(D);case"array":return typeof D=="string"?Xa(D):D}return D}var L;function N(A){try{var U=A.InflateRaw,D=new U;if(D._processChunk(new Uint8Array([3,0]),D._finishFlushFlag),D.bytesRead)L=A;else throw new Error("zlib does not expose bytesRead")}catch(F){console.error("cannot use native zlib: "+(F.message||F))}}function V(A,U){if(!L)return Zi(A,U);var D=L.InflateRaw,F=new D,B=F._processChunk(A.slice(A.l),F._finishFlushFlag);return A.l+=F.bytesRead,B}function M(A){return L?L.deflateRawSync(A):gt(A)}var z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],te=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ge=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ee(A){var U=(A<<1|A<<11)&139536|(A<<5|A<<15)&558144;return(U>>16|U>>8|U)&255}for(var ye=typeof Uint8Array<"u",Ae=ye?new Uint8Array(256):[],tt=0;tt<256;++tt)Ae[tt]=Ee(tt);function P(A,U){var D=Ae[A&255];return U<=8?D>>>8-U:(D=D<<8|Ae[A>>8&255],U<=16?D>>>16-U:(D=D<<8|Ae[A>>16&255],D>>>24-U))}function St(A,U){var D=U&7,F=U>>>3;return(A[F]|(D<=6?0:A[F+1]<<8))>>>D&3}function at(A,U){var D=U&7,F=U>>>3;return(A[F]|(D<=5?0:A[F+1]<<8))>>>D&7}function Et(A,U){var D=U&7,F=U>>>3;return(A[F]|(D<=4?0:A[F+1]<<8))>>>D&15}function dt(A,U){var D=U&7,F=U>>>3;return(A[F]|(D<=3?0:A[F+1]<<8))>>>D&31}function Be(A,U){var D=U&7,F=U>>>3;return(A[F]|(D<=1?0:A[F+1]<<8))>>>D&127}function Vt(A,U,D){var F=U&7,B=U>>>3,H=(1<<D)-1,ie=A[B]>>>F;return D<8-F||(ie|=A[B+1]<<8-F,D<16-F)||(ie|=A[B+2]<<16-F,D<24-F)||(ie|=A[B+3]<<24-F),ie&H}function br(A,U,D){var F=U&7,B=U>>>3;return F<=5?A[B]|=(D&7)<<F:(A[B]|=D<<F&255,A[B+1]=(D&7)>>8-F),U+3}function na(A,U,D){var F=U&7,B=U>>>3;return D=(D&1)<<F,A[B]|=D,U+1}function pa(A,U,D){var F=U&7,B=U>>>3;return D<<=F,A[B]|=D&255,D>>>=8,A[B+1]=D,U+8}function Xr(A,U,D){var F=U&7,B=U>>>3;return D<<=F,A[B]|=D&255,D>>>=8,A[B+1]=D&255,A[B+2]=D>>>8,U+16}function Ya(A,U){var D=A.length,F=2*D>U?2*D:U+5,B=0;if(D>=U)return A;if(wt){var H=Tv(F);if(A.copy)A.copy(H);else for(;B<A.length;++B)H[B]=A[B];return H}else if(ye){var ie=new Uint8Array(F);if(ie.set)ie.set(A);else for(;B<D;++B)ie[B]=A[B];return ie}return A.length=F,A}function Mt(A){for(var U=new Array(A),D=0;D<A;++D)U[D]=0;return U}function sa(A,U,D){var F=1,B=0,H=0,ie=0,_e=0,se=A.length,fe=ye?new Uint16Array(32):Mt(32);for(H=0;H<32;++H)fe[H]=0;for(H=se;H<D;++H)A[H]=0;se=A.length;var he=ye?new Uint16Array(se):Mt(se);for(H=0;H<se;++H)fe[B=A[H]]++,F<B&&(F=B),he[H]=0;for(fe[0]=0,H=1;H<=F;++H)fe[H+16]=_e=_e+fe[H-1]<<1;for(H=0;H<se;++H)_e=A[H],_e!=0&&(he[H]=fe[_e+16]++);var Oe=0;for(H=0;H<se;++H)if(Oe=A[H],Oe!=0)for(_e=P(he[H],F)>>F-Oe,ie=(1<<F+4-Oe)-1;ie>=0;--ie)U[_e|ie<<Oe]=Oe&15|H<<4;return F}var zr=ye?new Uint16Array(512):Mt(512),Ja=ye?new Uint16Array(32):Mt(32);if(!ye){for(var cr=0;cr<512;++cr)zr[cr]=0;for(cr=0;cr<32;++cr)Ja[cr]=0}(function(){for(var A=[],U=0;U<32;U++)A.push(5);sa(A,Ja,32);var D=[];for(U=0;U<=143;U++)D.push(8);for(;U<=255;U++)D.push(9);for(;U<=279;U++)D.push(7);for(;U<=287;U++)D.push(8);sa(D,zr,288)})();var mr=(function(){for(var U=ye?new Uint8Array(32768):[],D=0,F=0;D<ge.length-1;++D)for(;F<ge[D+1];++F)U[F]=D;for(;F<32768;++F)U[F]=29;var B=ye?new Uint8Array(259):[];for(D=0,F=0;D<te.length-1;++D)for(;F<te[D+1];++F)B[F]=D;function H(_e,se){for(var fe=0;fe<_e.length;){var he=Math.min(65535,_e.length-fe),Oe=fe+he==_e.length;for(se.write_shift(1,+Oe),se.write_shift(2,he),se.write_shift(2,~he&65535);he-- >0;)se[se.l++]=_e[fe++]}return se.l}function ie(_e,se){for(var fe=0,he=0,Oe=ye?new Uint16Array(32768):[];he<_e.length;){var Fe=Math.min(65535,_e.length-he);if(Fe<10){for(fe=br(se,fe,+(he+Fe==_e.length)),fe&7&&(fe+=8-(fe&7)),se.l=fe/8|0,se.write_shift(2,Fe),se.write_shift(2,~Fe&65535);Fe-- >0;)se[se.l++]=_e[he++];fe=se.l*8;continue}fe=br(se,fe,+(he+Fe==_e.length)+2);for(var He=0;Fe-- >0;){var Re=_e[he];He=(He<<5^Re)&32767;var je=-1,We=0;if((je=Oe[He])&&(je|=he&-32768,je>he&&(je-=32768),je<he))for(;_e[je+We]==_e[he+We]&&We<250;)++We;if(We>2){Re=B[We],Re<=22?fe=pa(se,fe,Ae[Re+1]>>1)-1:(pa(se,fe,3),fe+=5,pa(se,fe,Ae[Re-23]>>5),fe+=3);var qt=Re<8?0:Re-4>>2;qt>0&&(Xr(se,fe,We-te[Re]),fe+=qt),Re=U[he-je],fe=pa(se,fe,Ae[Re]>>3),fe-=3;var Xt=Re<4?0:Re-2>>1;Xt>0&&(Xr(se,fe,he-je-ge[Re]),fe+=Xt);for(var er=0;er<We;++er)Oe[He]=he&32767,He=(He<<5^_e[he])&32767,++he;Fe-=We-1}else Re<=143?Re=Re+48:fe=na(se,fe,1),fe=pa(se,fe,Ae[Re]),Oe[He]=he&32767,++he}fe=pa(se,fe,0)-1}return se.l=(fe+7)/8|0,se.l}return function(se,fe){return se.length<8?H(se,fe):ie(se,fe)}})();function gt(A){var U=ve(50+Math.floor(A.length*1.1)),D=mr(A,U);return U.slice(0,D)}var Gt=ye?new Uint16Array(32768):Mt(32768),ia=ye?new Uint16Array(32768):Mt(32768),Rt=ye?new Uint16Array(128):Mt(128),rr=1,Ma=1;function Wr(A,U){var D=dt(A,U)+257;U+=5;var F=dt(A,U)+1;U+=5;var B=Et(A,U)+4;U+=4;for(var H=0,ie=ye?new Uint8Array(19):Mt(19),_e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],se=1,fe=ye?new Uint8Array(8):Mt(8),he=ye?new Uint8Array(8):Mt(8),Oe=ie.length,Fe=0;Fe<B;++Fe)ie[z[Fe]]=H=at(A,U),se<H&&(se=H),fe[H]++,U+=3;var He=0;for(fe[0]=0,Fe=1;Fe<=se;++Fe)he[Fe]=He=He+fe[Fe-1]<<1;for(Fe=0;Fe<Oe;++Fe)(He=ie[Fe])!=0&&(_e[Fe]=he[He]++);var Re=0;for(Fe=0;Fe<Oe;++Fe)if(Re=ie[Fe],Re!=0){He=Ae[_e[Fe]]>>8-Re;for(var je=(1<<7-Re)-1;je>=0;--je)Rt[He|je<<Re]=Re&7|Fe<<3}var We=[];for(se=1;We.length<D+F;)switch(He=Rt[Be(A,U)],U+=He&7,He>>>=3){case 16:for(H=3+St(A,U),U+=2,He=We[We.length-1];H-- >0;)We.push(He);break;case 17:for(H=3+at(A,U),U+=3;H-- >0;)We.push(0);break;case 18:for(H=11+Be(A,U),U+=7;H-- >0;)We.push(0);break;default:We.push(He),se<He&&(se=He);break}var qt=We.slice(0,D),Xt=We.slice(D);for(Fe=D;Fe<286;++Fe)qt[Fe]=0;for(Fe=F;Fe<30;++Fe)Xt[Fe]=0;return rr=sa(qt,Gt,286),Ma=sa(Xt,ia,30),U}function fo(A,U){if(A[0]==3&&!(A[1]&3))return[ti(U),2];for(var D=0,F=0,B=Tv(U||1<<18),H=0,ie=B.length>>>0,_e=0,se=0;(F&1)==0;){if(F=at(A,D),D+=3,F>>>1)F>>1==1?(_e=9,se=5):(D=Wr(A,D),_e=rr,se=Ma);else{D&7&&(D+=8-(D&7));var fe=A[D>>>3]|A[(D>>>3)+1]<<8;if(D+=32,fe>0)for(!U&&ie<H+fe&&(B=Ya(B,H+fe),ie=B.length);fe-- >0;)B[H++]=A[D>>>3],D+=8;continue}for(;;){!U&&ie<H+32767&&(B=Ya(B,H+32767),ie=B.length);var he=Vt(A,D,_e),Oe=F>>>1==1?zr[he]:Gt[he];if(D+=Oe&15,Oe>>>=4,(Oe>>>8&255)===0)B[H++]=Oe;else{if(Oe==256)break;Oe-=257;var Fe=Oe<8?0:Oe-4>>2;Fe>5&&(Fe=0);var He=H+te[Oe];Fe>0&&(He+=Vt(A,D,Fe),D+=Fe),he=Vt(A,D,se),Oe=F>>>1==1?Ja[he]:ia[he],D+=Oe&15,Oe>>>=4;var Re=Oe<4?0:Oe-2>>1,je=ge[Oe];for(Re>0&&(je+=Vt(A,D,Re),D+=Re),!U&&ie<He&&(B=Ya(B,He+100),ie=B.length);H<He;)B[H]=B[H-je],++H}}}return U?[B,D+7>>>3]:[B.slice(0,H),D+7>>>3]}function Zi(A,U){var D=A.slice(A.l||0),F=fo(D,U);return A.l+=F[1],F[0]}function el(A,U){if(A)typeof console<"u"&&console.error(U);else throw new Error(U)}function Hn(A,U){var D=A;ra(D,0);var F=[],B=[],H={FileIndex:F,FullPaths:B};C(H,{root:U.root});for(var ie=D.length-4;(D[ie]!=80||D[ie+1]!=75||D[ie+2]!=5||D[ie+3]!=6)&&ie>=0;)--ie;D.l=ie+4,D.l+=4;var _e=D.read_shift(2);D.l+=6;var se=D.read_shift(4);for(D.l=se,ie=0;ie<_e;++ie){D.l+=20;var fe=D.read_shift(4),he=D.read_shift(4),Oe=D.read_shift(2),Fe=D.read_shift(2),He=D.read_shift(2);D.l+=8;var Re=D.read_shift(4),je=u(D.slice(D.l+Oe,D.l+Oe+Fe));D.l+=Oe+Fe+He;var We=D.l;D.l=Re+4,vs(D,fe,he,H,je),D.l=We}return H}function vs(A,U,D,F,B){A.l+=2;var H=A.read_shift(2),ie=A.read_shift(2),_e=c(A);if(H&8257)throw new Error("Unsupported ZIP encryption");for(var se=A.read_shift(4),fe=A.read_shift(4),he=A.read_shift(4),Oe=A.read_shift(2),Fe=A.read_shift(2),He="",Re=0;Re<Oe;++Re)He+=String.fromCharCode(A[A.l++]);if(Fe){var je=u(A.slice(A.l,A.l+Fe));(je[21589]||{}).mt&&(_e=je[21589].mt),((B||{})[21589]||{}).mt&&(_e=B[21589].mt)}A.l+=Fe;var We=A.slice(A.l,A.l+fe);switch(ie){case 8:We=V(A,he);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ie)}var qt=!1;H&8&&(se=A.read_shift(4),se==134695760&&(se=A.read_shift(4),qt=!0),fe=A.read_shift(4),he=A.read_shift(4)),fe!=U&&el(qt,"Bad compressed size: "+U+" != "+fe),he!=D&&el(qt,"Bad uncompressed size: "+D+" != "+he),ws(F,He,We,{unsafe:!0,mt:_e})}function ys(A,U){var D=U||{},F=[],B=[],H=ve(1),ie=D.compression?8:0,_e=0,se=0,fe=0,he=0,Oe=0,Fe=A.FullPaths[0],He=Fe,Re=A.FileIndex[0],je=[],We=0;for(se=1;se<A.FullPaths.length;++se)if(He=A.FullPaths[se].slice(Fe.length),Re=A.FileIndex[se],!(!Re.size||!Re.content||He=="Sh33tJ5")){var qt=he,Xt=ve(He.length);for(fe=0;fe<He.length;++fe)Xt.write_shift(1,He.charCodeAt(fe)&127);Xt=Xt.slice(0,Xt.l),je[Oe]=rA.buf(Re.content,0);var er=Re.content;ie==8&&(er=M(er)),H=ve(30),H.write_shift(4,67324752),H.write_shift(2,20),H.write_shift(2,_e),H.write_shift(2,ie),Re.mt?l(H,Re.mt):H.write_shift(4,0),H.write_shift(-4,je[Oe]),H.write_shift(4,er.length),H.write_shift(4,Re.content.length),H.write_shift(2,Xt.length),H.write_shift(2,0),he+=H.length,F.push(H),he+=Xt.length,F.push(Xt),he+=er.length,F.push(er),H=ve(46),H.write_shift(4,33639248),H.write_shift(2,0),H.write_shift(2,20),H.write_shift(2,_e),H.write_shift(2,ie),H.write_shift(4,0),H.write_shift(-4,je[Oe]),H.write_shift(4,er.length),H.write_shift(4,Re.content.length),H.write_shift(2,Xt.length),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(4,0),H.write_shift(4,qt),We+=H.l,B.push(H),We+=Xt.length,B.push(Xt),++Oe}return H=ve(22),H.write_shift(4,101010256),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(2,Oe),H.write_shift(2,Oe),H.write_shift(4,We),H.write_shift(4,he),H.write_shift(2,0),Gr([Gr(F),Gr(B),H])}var wa={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function _s(A,U){if(A.ctype)return A.ctype;var D=A.name||"",F=D.match(/\.([^\.]+)$/);return F&&wa[F[1]]||U&&(F=(D=U).match(/[\.\\]([^\.\\])+$/),F&&wa[F[1]])?wa[F[1]]:"application/octet-stream"}function $n(A){for(var U=Cc(A),D=[],F=0;F<U.length;F+=76)D.push(U.slice(F,F+76));return D.join(`\r
`)+`\r
`}function ho(A){var U=A.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(fe){var he=fe.charCodeAt(0).toString(16).toUpperCase();return"="+(he.length==1?"0"+he:he)});U=U.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),U.charAt(0)==`
`&&(U="=0D"+U.slice(1)),U=U.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var D=[],F=U.split(`\r
`),B=0;B<F.length;++B){var H=F[B];if(H.length==0){D.push("");continue}for(var ie=0;ie<H.length;){var _e=76,se=H.slice(ie,ie+_e);se.charAt(_e-1)=="="?_e--:se.charAt(_e-2)=="="?_e-=2:se.charAt(_e-3)=="="&&(_e-=3),se=H.slice(ie,ie+_e),ie+=_e,ie<H.length&&(se+="="),D.push(se)}}return D.join(`\r
`)}function tl(A){for(var U=[],D=0;D<A.length;++D){for(var F=A[D];D<=A.length&&F.charAt(F.length-1)=="=";)F=F.slice(0,F.length-1)+A[++D];U.push(F)}for(var B=0;B<U.length;++B)U[B]=U[B].replace(/[=][0-9A-Fa-f]{2}/g,function(H){return String.fromCharCode(parseInt(H.slice(1),16))});return Xa(U.join(`\r
`))}function ci(A,U,D){for(var F="",B="",H="",ie,_e=0;_e<10;++_e){var se=U[_e];if(!se||se.match(/^\s*$/))break;var fe=se.match(/^(.*?):\s*([^\s].*)$/);if(fe)switch(fe[1].toLowerCase()){case"content-location":F=fe[2].trim();break;case"content-type":H=fe[2].trim();break;case"content-transfer-encoding":B=fe[2].trim();break}}switch(++_e,B.toLowerCase()){case"base64":ie=Xa(Ka(U.slice(_e).join("")));break;case"quoted-printable":ie=tl(U.slice(_e));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+B)}var he=ws(A,F.slice(D.length),ie,{unsafe:!0});H&&(he.ctype=H)}function Vn(A,U){if(J(A.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var D=U&&U.root||"",F=(wt&&Buffer.isBuffer(A)?A.toString("binary"):J(A)).split(`\r
`),B=0,H="";for(B=0;B<F.length;++B)if(H=F[B],!!/^Content-Location:/i.test(H)&&(H=H.slice(H.indexOf("file")),D||(D=H.slice(0,H.lastIndexOf("/")+1)),H.slice(0,D.length)!=D))for(;D.length>0&&(D=D.slice(0,D.length-1),D=D.slice(0,D.lastIndexOf("/")+1),H.slice(0,D.length)!=D););var ie=(F[1]||"").match(/boundary="(.*?)"/);if(!ie)throw new Error("MAD cannot find boundary");var _e="--"+(ie[1]||""),se=[],fe=[],he={FileIndex:se,FullPaths:fe};C(he);var Oe,Fe=0;for(B=0;B<F.length;++B){var He=F[B];He!==_e&&He!==_e+"--"||(Fe++&&ci(he,F.slice(Oe,B),D),Oe=B)}return he}function mo(A,U){var D=U||{},F=D.boundary||"SheetJS";F="------="+F;for(var B=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+F.slice(2)+'"',"","",""],H=A.FullPaths[0],ie=H,_e=A.FileIndex[0],se=1;se<A.FullPaths.length;++se)if(ie=A.FullPaths[se].slice(H.length),_e=A.FileIndex[se],!(!_e.size||!_e.content||ie=="Sh33tJ5")){ie=ie.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(We){return"_x"+We.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(We){return"_u"+We.charCodeAt(0).toString(16)+"_"});for(var fe=_e.content,he=wt&&Buffer.isBuffer(fe)?fe.toString("binary"):J(fe),Oe=0,Fe=Math.min(1024,he.length),He=0,Re=0;Re<=Fe;++Re)(He=he.charCodeAt(Re))>=32&&He<128&&++Oe;var je=Oe>=Fe*4/5;B.push(F),B.push("Content-Location: "+(D.root||"file:///C:/SheetJS/")+ie),B.push("Content-Transfer-Encoding: "+(je?"quoted-printable":"base64")),B.push("Content-Type: "+_s(_e,ie)),B.push(""),B.push(je?ho(he):$n(he))}return B.push(F+`--\r
`),B.join(`\r
`)}function Nn(A){var U={};return C(U,A),U}function ws(A,U,D,F){var B=F&&F.unsafe;B||C(A);var H=!B&&st.find(A,U);if(!H){var ie=A.FullPaths[0];U.slice(0,ie.length)==ie?ie=U:(ie.slice(-1)!="/"&&(ie+="/"),ie=(ie+U).replace("//","/")),H={name:s(U),type:2},A.FileIndex.push(H),A.FullPaths.push(ie),B||st.utils.cfb_gc(A)}return H.content=D,H.size=D?D.length:0,F&&(F.CLSID&&(H.clsid=F.CLSID),F.mt&&(H.mt=F.mt),F.ct&&(H.ct=F.ct)),H}function On(A,U){C(A);var D=st.find(A,U);if(D){for(var F=0;F<A.FileIndex.length;++F)if(A.FileIndex[F]==D)return A.FileIndex.splice(F,1),A.FullPaths.splice(F,1),!0}return!1}function ui(A,U,D){C(A);var F=st.find(A,U);if(F){for(var B=0;B<A.FileIndex.length;++B)if(A.FileIndex[B]==F)return A.FileIndex[B].name=s(D),A.FullPaths[B]=D,!0}return!1}function fi(A){q(A,!0)}return t.find=ee,t.read=I,t.parse=g,t.write=be,t.writeFile=pe,t.utils={cfb_new:Nn,cfb_add:ws,cfb_del:On,cfb_mov:ui,cfb_gc:fi,ReadShift:dc,CheckField:j_,prep_blob:ra,bconcat:Gr,use_zlib:N,_deflateRaw:gt,_inflateRaw:Zi,consts:ne},t})();function aA(e){return typeof e=="string"?Wu(e):Array.isArray(e)?Nk(e):e}function Vc(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Wu(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var a=r=="utf8"?Un(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(a,e);if(typeof Blob<"u"){var s=new Blob([aA(a)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var l=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(l)},6e4),chrome.downloads.download({url:l,filename:e,saveAs:!0});var c=document.createElement("a");if(c.download!=null)return c.download=e,c.href=l,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(l)},6e4),l}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var u=File(e);return u.open("w"),u.encoding="binary",Array.isArray(t)&&(t=ii(t)),u.write(t),u.close(),t}catch(h){if(!h.message||!h.message.match(/onstruct/))throw h}throw new Error("cannot save file "+e)}function nA(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("Cannot access file "+e)}function wr(e){for(var t=Object.keys(e),r=[],a=0;a<t.length;++a)Object.prototype.hasOwnProperty.call(e,t[a])&&r.push(t[a]);return r}function Fv(e,t){for(var r=[],a=wr(e),s=0;s!==a.length;++s)r[e[a[s]][t]]==null&&(r[e[a[s]][t]]=a[s]);return r}function Yu(e){for(var t=[],r=wr(e),a=0;a!==r.length;++a)t[e[r[a]]]=r[a];return t}function Ju(e){for(var t=[],r=wr(e),a=0;a!==r.length;++a)t[e[r[a]]]=parseInt(r[a],10);return t}function sA(e){for(var t=[],r=wr(e),a=0;a!==r.length;++a)t[e[r[a]]]==null&&(t[e[r[a]]]=[]),t[e[r[a]]].push(r[a]);return t}var Lu=new Date(1899,11,30,0,0,0);function Pr(e,t){var r=e.getTime(),a=Lu.getTime()+(e.getTimezoneOffset()-Lu.getTimezoneOffset())*6e4;return(r-a)/(1440*60*1e3)}var x_=new Date,iA=Lu.getTime()+(x_.getTimezoneOffset()-Lu.getTimezoneOffset())*6e4,Mv=x_.getTimezoneOffset();function Qu(e){var t=new Date;return t.setTime(e*24*60*60*1e3+iA),t.getTimezoneOffset()!==Mv&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Mv)*6e4),t}function lA(e){var t=0,r=0,a=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var l=1;l!=s.length;++l)if(s[l]){switch(r=1,l>3&&(a=!0),s[l].slice(s[l].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[l].slice(s[l].length-1));case"D":r*=24;case"H":r*=60;case"M":if(a)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(s[l],10)}return t}var Lv=new Date("2017-02-19T19:06:09.000Z"),v_=isNaN(Lv.getFullYear())?new Date("2/19/17"):Lv,oA=v_.getFullYear()==2017;function ir(e,t){var r=new Date(e);if(oA)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(v_.getFullYear()==1917&&!isNaN(r.getFullYear())){var a=r.getFullYear();return e.indexOf(""+a)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],l=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(l=new Date(l.getTime()-l.getTimezoneOffset()*60*1e3)),l}function zi(e,t){if(wt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Un(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Un(s_(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Un(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Un(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(l){return r[l]||l})}catch{}for(var a=[],s=0;s!=e.length;++s)a.push(String.fromCharCode(e[s]));return a.join("")}function lr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=lr(e[r]));return t}function yr(e,t){for(var r="";r.length<t;)r+=e;return r}function An(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(a))||(a=a.replace(/[(](.*)[)]/,function(s,l){return r=-r,l}),!isNaN(t=Number(a)))?t/r:t}var cA=["january","february","march","april","may","june","july","august","september","october","november","december"];function ao(e){var t=new Date(e),r=new Date(NaN),a=t.getYear(),s=t.getMonth(),l=t.getDate();if(isNaN(l))return r;var c=e.toLowerCase();if(c.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(c=c.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),c.length>3&&cA.indexOf(c)==-1)return r}else if(c.match(/[a-z]/))return r;return a<0||a>8099?r:(s>0||l>1)&&a!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var uA=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,a,s){if(e||typeof a=="string")return r.split(a);for(var l=r.split(a),c=[l[0]],u=1;u<l.length;++u)c.push(s),c.push(l[u]);return c}})();function y_(e){return e?e.content&&e.type?zi(e.content,!0):e.data?oc(e.data):e.asNodeBuffer&&wt?oc(e.asNodeBuffer().toString("binary")):e.asBinary?oc(e.asBinary()):e._data&&e._data.getContent?oc(zi(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function __(e){if(!e)return null;if(e.data)return Sv(e.data);if(e.asNodeBuffer&&wt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?Sv(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function fA(e){return e&&e.name.slice(-4)===".bin"?__(e):y_(e)}function fn(e,t){for(var r=e.FullPaths||wr(e.files),a=t.toLowerCase().replace(/[\/]/g,"\\"),s=a.replace(/\\/g,"/"),l=0;l<r.length;++l){var c=r[l].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==c||s==c)return e.files?e.files[r[l]]:e.FileIndex[l]}return null}function wm(e,t){var r=fn(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Mr(e,t,r){if(!r)return fA(wm(e,t));if(!t)return null;try{return Mr(e,t)}catch{return null}}function Wa(e,t,r){if(!r)return y_(wm(e,t));if(!t)return null;try{return Wa(e,t)}catch{return null}}function hA(e,t,r){return __(wm(e,t))}function Iv(e){for(var t=e.FullPaths||wr(e.files),r=[],a=0;a<t.length;++a)t[a].slice(-1)!="/"&&r.push(t[a].replace(/^Root Entry[\/]/,""));return r.sort()}function _t(e,t,r){if(e.FullPaths){if(typeof r=="string"){var a;return wt?a=gs(r):a=Ok(r),st.utils.cfb_add(e,t,a)}st.utils.cfb_add(e,t,r)}else e.file(t,r)}function bm(){return st.utils.cfb_new()}function w_(e,t){switch(t.type){case"base64":return st.read(e,{type:"base64"});case"binary":return st.read(e,{type:"binary"});case"buffer":case"array":return st.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function uc(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var a=e.split("/");a.length!==0;){var s=a.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var Ar=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,dA=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Bv=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,mA=/<[^>]*>/g,ga=Ar.match(Bv)?Bv:mA,gA=/<\w*:/,pA=/<(\/?)\w+:/;function ht(e,t,r){for(var a={},s=0,l=0;s!==e.length&&!((l=e.charCodeAt(s))===32||l===10||l===13);++s);if(t||(a[0]=e.slice(0,s)),s===e.length)return a;var c=e.match(dA),u=0,h="",d=0,g="",x="",v=1;if(c)for(d=0;d!=c.length;++d){for(x=c[d],l=0;l!=x.length&&x.charCodeAt(l)!==61;++l);for(g=x.slice(0,l).trim();x.charCodeAt(l+1)==32;)++l;for(v=(s=x.charCodeAt(l+1))==34||s==39?1:0,h=x.slice(l+1+v,x.length-v),u=0;u!=g.length&&g.charCodeAt(u)!==58;++u);if(u===g.length)g.indexOf("_")>0&&(g=g.slice(0,g.indexOf("_"))),a[g]=h,a[g.toLowerCase()]=h;else{var _=(u===5&&g.slice(0,5)==="xmlns"?"xmlns":"")+g.slice(u+1);if(a[_]&&g.slice(u-3,u)=="ext")continue;a[_]=h,a[_.toLowerCase()]=h}}return a}function Pn(e){return e.replace(pA,"<$1")}var b_={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Sm=Yu(b_),Dt=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(a){var s=a+"",l=s.indexOf("<![CDATA[");if(l==-1)return s.replace(e,function(u,h){return b_[u]||String.fromCharCode(parseInt(h,u.indexOf("x")>-1?16:10))||u}).replace(t,function(u,h){return String.fromCharCode(parseInt(h,16))});var c=s.indexOf("]]>");return r(s.slice(0,l))+s.slice(l+9,c)+r(s.slice(c+3))}})(),Em=/[&<>'"]/g,xA=/[\u0000-\u0008\u000b-\u001f]/g;function $t(e){var t=e+"";return t.replace(Em,function(r){return Sm[r]}).replace(xA,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function jv(e){return $t(e).replace(/ /g,"_x0020_")}var S_=/[\u0000-\u001f]/g;function Tm(e){var t=e+"";return t.replace(Em,function(r){return Sm[r]}).replace(/\n/g,"<br/>").replace(S_,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function vA(e){var t=e+"";return t.replace(Em,function(r){return Sm[r]}).replace(S_,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var Uv=(function(){var e=/&#(\d+);/g;function t(r,a){return String.fromCharCode(parseInt(a,10))}return function(a){return a.replace(e,t)}})();function yA(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function sr(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Ed(e){for(var t="",r=0,a=0,s=0,l=0,c=0,u=0;r<e.length;){if(a=e.charCodeAt(r++),a<128){t+=String.fromCharCode(a);continue}if(s=e.charCodeAt(r++),a>191&&a<224){c=(a&31)<<6,c|=s&63,t+=String.fromCharCode(c);continue}if(l=e.charCodeAt(r++),a<240){t+=String.fromCharCode((a&15)<<12|(s&63)<<6|l&63);continue}c=e.charCodeAt(r++),u=((a&7)<<18|(s&63)<<12|(l&63)<<6|c&63)-65536,t+=String.fromCharCode(55296+(u>>>10&1023)),t+=String.fromCharCode(56320+(u&1023))}return t}function Pv(e){var t=ti(2*e.length),r,a,s=1,l=0,c=0,u;for(a=0;a<e.length;a+=s)s=1,(u=e.charCodeAt(a))<128?r=u:u<224?(r=(u&31)*64+(e.charCodeAt(a+1)&63),s=2):u<240?(r=(u&15)*4096+(e.charCodeAt(a+1)&63)*64+(e.charCodeAt(a+2)&63),s=3):(s=4,r=(u&7)*262144+(e.charCodeAt(a+1)&63)*4096+(e.charCodeAt(a+2)&63)*64+(e.charCodeAt(a+3)&63),r-=65536,c=55296+(r>>>10&1023),r=56320+(r&1023)),c!==0&&(t[l++]=c&255,t[l++]=c>>>8,c=0),t[l++]=r%256,t[l++]=r>>>8;return t.slice(0,l).toString("ucs2")}function zv(e){return gs(e,"binary").toString("utf8")}var pu="foo bar baz",Jt=wt&&(zv(pu)==Ed(pu)&&zv||Pv(pu)==Ed(pu)&&Pv)||Ed,Un=wt?function(e){return gs(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,a=0,s=0;r<e.length;)switch(a=e.charCodeAt(r++),!0){case a<128:t.push(String.fromCharCode(a));break;case a<2048:t.push(String.fromCharCode(192+(a>>6))),t.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,s=e.charCodeAt(r++)-56320+(a<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(a>>12))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)))}return t.join("")},Oc=(function(){var e={};return function(r,a){var s=r+"|"+(a||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",a||"")}})(),E_=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var a=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)a=a.replace(e[s][0],e[s][1]);return a}})(),_A=(function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),wA=/<\/?(?:vt:)?variant>/g,bA=/<(?:vt:)([^>]*)>([\s\S]*)</;function Hv(e,t){var r=ht(e),a=e.match(_A(r.baseType))||[],s=[];if(a.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+a.length+" != "+r.size);return s}return a.forEach(function(l){var c=l.replace(wA,"").match(bA);c&&s.push({v:Jt(c[2]),t:c[1]})}),s}var T_=/(^\s|\s$|\n)/;function aa(e,t){return"<"+e+(t.match(T_)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Rc(e){return wr(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Me(e,t,r){return"<"+e+(r!=null?Rc(r):"")+(t!=null?(t.match(T_)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Kd(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function SA(e,t){switch(typeof e){case"string":var r=Me("vt:lpwstr",$t(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Me((e|0)==e?"vt:i4":"vt:r8",$t(String(e)));case"boolean":return Me("vt:bool",e?"true":"false")}if(e instanceof Date)return Me("vt:filetime",Kd(e));throw new Error("Unable to serialize "+e)}function km(e){if(wt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Jt(ii(vm(e)));throw new Error("Bad input format: expected Buffer or string")}var Dc=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Ur={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Xi=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],$a={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function EA(e,t){for(var r=1-2*(e[t+7]>>>7),a=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,l=5;l>=0;--l)s=s*256+e[t+l];return a==2047?s==0?r*(1/0):NaN:(a==0?a=-1022:(a-=1023,s+=Math.pow(2,52)),r*Math.pow(2,a-52)*s)}function TA(e,t,r){var a=(t<0||1/t==-1/0?1:0)<<7,s=0,l=0,c=a?-t:t;isFinite(c)?c==0?s=l=0:(s=Math.floor(Math.log(c)/Math.LN2),l=c*Math.pow(2,52-s),s<=-1023&&(!isFinite(l)||l<Math.pow(2,52))?s=-1022:(l-=Math.pow(2,52),s+=1023)):(s=2047,l=isNaN(t)?26985:0);for(var u=0;u<=5;++u,l/=256)e[r+u]=l&255;e[r+6]=(s&15)<<4|l&15,e[r+7]=s>>4|a}var $v=function(e){for(var t=[],r=10240,a=0;a<e[0].length;++a)if(e[0][a])for(var s=0,l=e[0][a].length;s<l;s+=r)t.push.apply(t,e[0][a].slice(s,s+r));return t},Vv=wt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:gs(t)})):$v(e)}:$v,Gv=function(e,t,r){for(var a=[],s=t;s<r;s+=2)a.push(String.fromCharCode(cs(e,s)));return a.join("").replace(_a,"")},Am=wt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(_a,""):Gv(e,t,r)}:Gv,qv=function(e,t,r){for(var a=[],s=t;s<t+r;++s)a.push(("0"+e[s].toString(16)).slice(-2));return a.join("")},k_=wt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):qv(e,t,r)}:qv,Xv=function(e,t,r){for(var a=[],s=t;s<r;s++)a.push(String.fromCharCode(Xl(e,s)));return a.join("")},Gc=wt?function(t,r,a){return Buffer.isBuffer(t)?t.toString("utf8",r,a):Xv(t,r,a)}:Xv,A_=function(e,t){var r=Va(e,t);return r>0?Gc(e,t+4,t+4+r-1):""},C_=A_,N_=function(e,t){var r=Va(e,t);return r>0?Gc(e,t+4,t+4+r-1):""},O_=N_,R_=function(e,t){var r=2*Va(e,t);return r>0?Gc(e,t+4,t+4+r-1):""},D_=R_,F_=function(t,r){var a=Va(t,r);return a>0?Am(t,r+4,r+4+a):""},M_=F_,L_=function(e,t){var r=Va(e,t);return r>0?Gc(e,t+4,t+4+r):""},I_=L_,B_=function(e,t){return EA(e,t)},Iu=B_,Cm=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};wt&&(C_=function(t,r){if(!Buffer.isBuffer(t))return A_(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},O_=function(t,r){if(!Buffer.isBuffer(t))return N_(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},D_=function(t,r){if(!Buffer.isBuffer(t))return R_(t,r);var a=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a-1)},M_=function(t,r){if(!Buffer.isBuffer(t))return F_(t,r);var a=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a)},I_=function(t,r){if(!Buffer.isBuffer(t))return L_(t,r);var a=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+a)},Iu=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):B_(t,r)},Cm=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Xl=function(e,t){return e[t]},cs=function(e,t){return e[t+1]*256+e[t]},kA=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Va=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Fi=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},AA=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function dc(e,t){var r="",a,s,l=[],c,u,h,d;switch(t){case"dbcs":if(d=this.l,wt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(h=0;h<e;++h)r+=String.fromCharCode(cs(this,d)),d+=2;e*=2;break;case"utf8":r=Gc(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Am(this,this.l,this.l+e);break;case"wstr":return dc.call(this,e,"dbcs");case"lpstr-ansi":r=C_(this,this.l),e=4+Va(this,this.l);break;case"lpstr-cp":r=O_(this,this.l),e=4+Va(this,this.l);break;case"lpwstr":r=D_(this,this.l),e=4+2*Va(this,this.l);break;case"lpp4":e=4+Va(this,this.l),r=M_(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Va(this,this.l),r=I_(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(c=Xl(this,this.l+e++))!==0;)l.push(gu(c));r=l.join("");break;case"_wstr":for(e=0,r="";(c=cs(this,this.l+e))!==0;)l.push(gu(c)),e+=2;e+=2,r=l.join("");break;case"dbcs-cont":for(r="",d=this.l,h=0;h<e;++h){if(this.lens&&this.lens.indexOf(d)!==-1)return c=Xl(this,d),this.l=d+1,u=dc.call(this,e-h,c?"dbcs-cont":"sbcs-cont"),l.join("")+u;l.push(gu(cs(this,d))),d+=2}r=l.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",d=this.l,h=0;h!=e;++h){if(this.lens&&this.lens.indexOf(d)!==-1)return c=Xl(this,d),this.l=d+1,u=dc.call(this,e-h,c?"dbcs-cont":"sbcs-cont"),l.join("")+u;l.push(gu(Xl(this,d))),d+=1}r=l.join("");break;default:switch(e){case 1:return a=Xl(this,this.l),this.l++,a;case 2:return a=(t==="i"?kA:cs)(this,this.l),this.l+=2,a;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(a=(e>0?Fi:AA)(this,this.l),this.l+=4,a):(s=Va(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=Iu(this,this.l):s=Iu([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=k_(this,this.l,e);break}}return this.l+=e,r}var CA=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},NA=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},OA=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function RA(e,t,r){var a=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)OA(this,t.charCodeAt(s),this.l+2*s);a=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;a=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var l=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var c=t.charCodeAt(s);this[this.l++]=c&255,this[this.l++]=c>>8}for(;this.l<l;)this[this.l++]=0;return this}else switch(e){case 1:a=1,this[this.l]=t&255;break;case 2:a=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:a=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:a=4,CA(this,t,this.l);break;case 8:if(a=8,r==="f"){TA(this,t,this.l);break}case 16:break;case-4:a=4,NA(this,t,this.l);break}return this.l+=a,this}function j_(e,t){var r=k_(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function ra(e,t){e.l=t,e.read_shift=dc,e.chk=j_,e.write_shift=RA}function ma(e,t){e.l+=t}function ve(e){var t=ti(e);return ra(t,0),t}function ps(e,t,r){if(e){var a,s,l;ra(e,e.l||0);for(var c=e.length,u=0,h=0;e.l<c;){u=e.read_shift(1),u&128&&(u=(u&127)+((e.read_shift(1)&127)<<7));var d=jc[u]||jc[65535];for(a=e.read_shift(1),l=a&127,s=1;s<4&&a&128;++s)l+=((a=e.read_shift(1))&127)<<7*s;h=e.l+l;var g=d.f&&d.f(e,l,r);if(e.l=h,t(g,d,u))return}}}function Da(){var e=[],t=wt?256:2048,r=function(d){var g=ve(d);return ra(g,0),g},a=r(t),s=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&e.push(a),a=null)},l=function(d){return a&&d<a.length-a.l?a:(s(),a=r(Math.max(d+1,t)))},c=function(){return s(),Gr(e)},u=function(d){s(),a=d,a.l==null&&(a.l=a.length),l(t)};return{next:l,push:u,end:c,_bufs:e}}function Ne(e,t,r,a){var s=+t,l;if(!isNaN(s)){a||(a=jc[s].p||(r||[]).length||0),l=1+(s>=128?1:0)+1,a>=128&&++l,a>=16384&&++l,a>=2097152&&++l;var c=e.next(l);s<=127?c.write_shift(1,s):(c.write_shift(1,(s&127)+128),c.write_shift(1,s>>7));for(var u=0;u!=4;++u)if(a>=128)c.write_shift(1,(a&127)+128),a>>=7;else{c.write_shift(1,a);break}a>0&&Cm(r)&&e.push(r)}}function mc(e,t,r){var a=lr(e);if(t.s?(a.cRel&&(a.c+=t.s.c),a.rRel&&(a.r+=t.s.r)):(a.cRel&&(a.c+=t.c),a.rRel&&(a.r+=t.r)),!r||r.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function Wv(e,t,r){var a=lr(e);return a.s=mc(a.s,t.s,r),a.e=mc(a.e,t.s,r),a}function gc(e,t){if(e.cRel&&e.c<0)for(e=lr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=lr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=ft(e);return!e.cRel&&e.cRel!=null&&(r=MA(r)),!e.rRel&&e.rRel!=null&&(r=DA(r)),r}function Td(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+hr(e.s.c)+":"+(e.e.cRel?"":"$")+hr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+kr(e.s.r)+":"+(e.e.rRel?"":"$")+kr(e.e.r):gc(e.s,t.biff)+":"+gc(e.e,t.biff)}function Nm(e){return parseInt(FA(e),10)-1}function kr(e){return""+(e+1)}function DA(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function FA(e){return e.replace(/\$(\d+)$/,"$1")}function Om(e){for(var t=LA(e),r=0,a=0;a!==t.length;++a)r=26*r+t.charCodeAt(a)-64;return r-1}function hr(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function MA(e){return e.replace(/^([A-Z])/,"$$$1")}function LA(e){return e.replace(/^\$([A-Z])/,"$1")}function IA(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function dr(e){for(var t=0,r=0,a=0;a<e.length;++a){var s=e.charCodeAt(a);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function ft(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Fa(e){var t=e.indexOf(":");return t==-1?{s:dr(e),e:dr(e)}:{s:dr(e.slice(0,t)),e:dr(e.slice(t+1))}}function vt(e,t){return typeof t>"u"||typeof t=="number"?vt(e.s,e.e):(typeof e!="string"&&(e=ft(e)),typeof t!="string"&&(t=ft(t)),e==t?e:e+":"+t)}function Ft(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,a=0,s=0,l=e.length;for(r=0;a<l&&!((s=e.charCodeAt(a)-64)<1||s>26);++a)r=26*r+s;for(t.s.c=--r,r=0;a<l&&!((s=e.charCodeAt(a)-48)<0||s>9);++a)r=10*r+s;if(t.s.r=--r,a===l||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++a,r=0;a!=l&&!((s=e.charCodeAt(a)-64)<1||s>26);++a)r=26*r+s;for(t.e.c=--r,r=0;a!=l&&!((s=e.charCodeAt(a)-48)<0||s>9);++a)r=10*r+s;return t.e.r=--r,t}function Kv(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=mn(e.z,r?Pr(t):t)}catch{}try{return e.w=mn((e.XF||{}).numFmtId||(r?14:0),r?Pr(t):t)}catch{return""+t}}function ds(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?xs[e.v]||e.v:t==null?Kv(e,e.v):Kv(e,t))}function li(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",a={};return a[r]=e,{SheetNames:[r],Sheets:a}}function U_(e,t,r){var a=r||{},s=e?Array.isArray(e):a.dense,l=e||(s?[]:{}),c=0,u=0;if(l&&a.origin!=null){if(typeof a.origin=="number")c=a.origin;else{var h=typeof a.origin=="string"?dr(a.origin):a.origin;c=h.r,u=h.c}l["!ref"]||(l["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(l["!ref"]){var g=Ft(l["!ref"]);d.s.c=g.s.c,d.s.r=g.s.r,d.e.c=Math.max(d.e.c,g.e.c),d.e.r=Math.max(d.e.r,g.e.r),c==-1&&(d.e.r=c=g.e.r+1)}for(var x=0;x!=t.length;++x)if(t[x]){if(!Array.isArray(t[x]))throw new Error("aoa_to_sheet expects an array of arrays");for(var v=0;v!=t[x].length;++v)if(!(typeof t[x][v]>"u")){var _={v:t[x][v]},b=c+x,y=u+v;if(d.s.r>b&&(d.s.r=b),d.s.c>y&&(d.s.c=y),d.e.r<b&&(d.e.r=b),d.e.c<y&&(d.e.c=y),t[x][v]&&typeof t[x][v]=="object"&&!Array.isArray(t[x][v])&&!(t[x][v]instanceof Date))_=t[x][v];else if(Array.isArray(_.v)&&(_.f=t[x][v][1],_.v=_.v[0]),_.v===null)if(_.f)_.t="n";else if(a.nullError)_.t="e",_.v=0;else if(a.sheetStubs)_.t="z";else continue;else typeof _.v=="number"?_.t="n":typeof _.v=="boolean"?_.t="b":_.v instanceof Date?(_.z=a.dateNF||ct[14],a.cellDates?(_.t="d",_.w=mn(_.z,Pr(_.v))):(_.t="n",_.v=Pr(_.v),_.w=mn(_.z,_.v))):_.t="s";if(s)l[b]||(l[b]=[]),l[b][y]&&l[b][y].z&&(_.z=l[b][y].z),l[b][y]=_;else{var S=ft({c:y,r:b});l[S]&&l[S].z&&(_.z=l[S].z),l[S]=_}}}return d.s.c<1e7&&(l["!ref"]=vt(d)),l}function co(e,t){return U_(null,e,t)}function BA(e){return e.read_shift(4,"i")}function Cn(e,t){return t||(t=ve(4)),t.write_shift(4,e),t}function da(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function qr(e,t){var r=!1;return t==null&&(r=!0,t=ve(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function jA(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function UA(e,t){return t||(t=ve(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Rm(e,t){var r=e.l,a=e.read_shift(1),s=da(e),l=[],c={t:s,h:s};if((a&1)!==0){for(var u=e.read_shift(4),h=0;h!=u;++h)l.push(jA(e));c.r=l}else c.r=[{ich:0,ifnt:0}];return e.l=r+t,c}function PA(e,t){var r=!1;return t==null&&(r=!0,t=ve(15+4*e.t.length)),t.write_shift(1,0),qr(e.t,t),r?t.slice(0,t.l):t}var zA=Rm;function HA(e,t){var r=!1;return t==null&&(r=!0,t=ve(23+4*e.t.length)),t.write_shift(1,1),qr(e.t,t),t.write_shift(4,1),UA({},t),r?t.slice(0,t.l):t}function gn(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Wi(e,t){return t==null&&(t=ve(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Ki(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Yi(e,t){return t==null&&(t=ve(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var $A=da,P_=qr;function Dm(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Bu(e,t){var r=!1;return t==null&&(r=!0,t=ve(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var VA=da,Yd=Dm,Fm=Bu;function Mm(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,a=t[0]&2;e.l+=4;var s=a===0?Iu([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Fi(t,0)>>2;return r?s/100:s}function z_(e,t){t==null&&(t=ve(4));var r=0,a=0,s=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?a=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(a=1,r=1),a)t.write_shift(-4,((r?s:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function H_(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function GA(e,t){return t||(t=ve(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Ji=H_,uo=GA;function ha(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Hi(e,t){return(t||ve(8)).write_shift(8,e,"f")}function qA(e){var t={},r=e.read_shift(1),a=r>>>1,s=e.read_shift(1),l=e.read_shift(2,"i"),c=e.read_shift(1),u=e.read_shift(1),h=e.read_shift(1);switch(e.l++,a){case 0:t.auto=1;break;case 1:t.index=s;var d=Ii[s];d&&(t.rgb=Mc(d));break;case 2:t.rgb=Mc([c,u,h]);break;case 3:t.theme=s;break}return l!=0&&(t.tint=l>0?l/32767:l/32768),t}function ju(e,t){if(t||(t=ve(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var a=e.rgb||"FFFFFF";typeof a=="number"&&(a=("000000"+a.toString(16)).slice(-6)),t.write_shift(1,parseInt(a.slice(0,2),16)),t.write_shift(1,parseInt(a.slice(2,4),16)),t.write_shift(1,parseInt(a.slice(4,6),16)),t.write_shift(1,255)}return t}function XA(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function WA(e,t){t||(t=ve(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function $_(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},a=e.read_shift(4);switch(a){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(a>400)throw new Error("Unsupported Clipboard: "+a.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function KA(e){return $_(e,1)}function YA(e){return $_(e,2)}var Lm=2,Ra=3,xu=11,Yv=12,Uu=19,vu=64,JA=65,QA=71,ZA=4108,e3=4126,Vr=80,V_=81,t3=[Vr,V_],Jd={1:{n:"CodePage",t:Lm},2:{n:"Category",t:Vr},3:{n:"PresentationFormat",t:Vr},4:{n:"ByteCount",t:Ra},5:{n:"LineCount",t:Ra},6:{n:"ParagraphCount",t:Ra},7:{n:"SlideCount",t:Ra},8:{n:"NoteCount",t:Ra},9:{n:"HiddenCount",t:Ra},10:{n:"MultimediaClipCount",t:Ra},11:{n:"ScaleCrop",t:xu},12:{n:"HeadingPairs",t:ZA},13:{n:"TitlesOfParts",t:e3},14:{n:"Manager",t:Vr},15:{n:"Company",t:Vr},16:{n:"LinksUpToDate",t:xu},17:{n:"CharacterCount",t:Ra},19:{n:"SharedDoc",t:xu},22:{n:"HyperlinksChanged",t:xu},23:{n:"AppVersion",t:Ra,p:"version"},24:{n:"DigSig",t:JA},26:{n:"ContentType",t:Vr},27:{n:"ContentStatus",t:Vr},28:{n:"Language",t:Vr},29:{n:"Version",t:Vr},255:{},2147483648:{n:"Locale",t:Uu},2147483651:{n:"Behavior",t:Uu},1919054434:{}},Qd={1:{n:"CodePage",t:Lm},2:{n:"Title",t:Vr},3:{n:"Subject",t:Vr},4:{n:"Author",t:Vr},5:{n:"Keywords",t:Vr},6:{n:"Comments",t:Vr},7:{n:"Template",t:Vr},8:{n:"LastAuthor",t:Vr},9:{n:"RevNumber",t:Vr},10:{n:"EditTime",t:vu},11:{n:"LastPrinted",t:vu},12:{n:"CreatedDate",t:vu},13:{n:"ModifiedDate",t:vu},14:{n:"PageCount",t:Ra},15:{n:"WordCount",t:Ra},16:{n:"CharCount",t:Ra},17:{n:"Thumbnail",t:QA},18:{n:"Application",t:Vr},19:{n:"DocSecurity",t:Ra},255:{},2147483648:{n:"Locale",t:Uu},2147483651:{n:"Behavior",t:Uu},1919054434:{}},Jv={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},r3=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function a3(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var n3=a3([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Ii=lr(n3),xs={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},G_={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Zd={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},yu={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Im(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function s3(e){var t=Im();if(!e||!e.match)return t;var r={};if((e.match(ga)||[]).forEach(function(a){var s=ht(a);switch(s[0].replace(gA,"<")){case"<?xml":break;case"<Types":t.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":t[Zd[s.ContentType]]!==void 0&&t[Zd[s.ContentType]].push(s.PartName);break}}),t.xmlns!==Ur.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function q_(e,t){var r=sA(Zd),a=[],s;a[a.length]=Ar,a[a.length]=Me("Types",null,{xmlns:Ur.CT,"xmlns:xsd":Ur.xsd,"xmlns:xsi":Ur.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(h){return Me("Default",null,{Extension:h[0],ContentType:h[1]})}));var l=function(h){e[h]&&e[h].length>0&&(s=e[h][0],a[a.length]=Me("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:yu[h][t.bookType]||yu[h].xlsx}))},c=function(h){(e[h]||[]).forEach(function(d){a[a.length]=Me("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:yu[h][t.bookType]||yu[h].xlsx})})},u=function(h){(e[h]||[]).forEach(function(d){a[a.length]=Me("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:r[h][0]})})};return l("workbooks"),c("sheets"),c("charts"),u("themes"),["strs","styles"].forEach(l),["coreprops","extprops","custprops"].forEach(u),u("vba"),u("comments"),u("threadedcomments"),u("drawings"),c("metadata"),u("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var bt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Fc(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function pc(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var a={};return(e.match(ga)||[]).forEach(function(s){var l=ht(s);if(l[0]==="<Relationship"){var c={};c.Type=l.Type,c.Target=l.Target,c.Id=l.Id,l.TargetMode&&(c.TargetMode=l.TargetMode);var u=l.TargetMode==="External"?l.Target:uc(l.Target,t);r[u]=c,a[l.Id]=c}}),r["!id"]=a,r}function Ql(e){var t=[Ar,Me("Relationships",null,{xmlns:Ur.RELS})];return wr(e["!id"]).forEach(function(r){t[t.length]=Me("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Ht(e,t,r,a,s,l){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,s.Id="rId"+t,s.Type=a,s.Target=r,[bt.HLINK,bt.XPATH,bt.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,t}var i3="application/vnd.oasis.opendocument.spreadsheet";function l3(e,t){for(var r=km(e),a,s;a=Dc.exec(r);)switch(a[3]){case"manifest":break;case"file-entry":if(s=ht(a[0],!1),s.path=="/"&&s.type!==i3)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw a}}function o3(e){var t=[Ar];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function Qv(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function c3(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function u3(e){var t=[Ar];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(Qv(e[r][0],e[r][1])),t.push(c3("",e[r][0]));return t.push(Qv("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function X_(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Ru.version+"</meta:generator></office:meta></office:document-meta>"}var dn=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],f3=(function(){for(var e=new Array(dn.length),t=0;t<dn.length;++t){var r=dn[t],a="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return e})();function W_(e){var t={};e=Jt(e);for(var r=0;r<dn.length;++r){var a=dn[r],s=e.match(f3[r]);s!=null&&s.length>0&&(t[a[1]]=Dt(s[1])),a[2]==="date"&&t[a[1]]&&(t[a[1]]=ir(t[a[1]]))}return t}function kd(e,t,r,a,s){s[e]!=null||t==null||t===""||(s[e]=t,t=$t(t),a[a.length]=r?Me(e,t,r):aa(e,t))}function K_(e,t){var r=t||{},a=[Ar,Me("cp:coreProperties",null,{"xmlns:cp":Ur.CORE_PROPS,"xmlns:dc":Ur.dc,"xmlns:dcterms":Ur.dcterms,"xmlns:dcmitype":Ur.dcmitype,"xmlns:xsi":Ur.xsi})],s={};if(!e&&!r.Props)return a.join("");e&&(e.CreatedDate!=null&&kd("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Kd(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,s),e.ModifiedDate!=null&&kd("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Kd(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,s));for(var l=0;l!=dn.length;++l){var c=dn[l],u=r.Props&&r.Props[c[1]]!=null?r.Props[c[1]]:e?e[c[1]]:null;u===!0?u="1":u===!1?u="0":typeof u=="number"&&(u=String(u)),u!=null&&kd(c[0],u,null,a,s)}return a.length>2&&(a[a.length]="</cp:coreProperties>",a[1]=a[1].replace("/>",">")),a.join("")}var Bi=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Y_=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function J_(e,t,r,a){var s=[];if(typeof e=="string")s=Hv(e,a);else for(var l=0;l<e.length;++l)s=s.concat(e[l].map(function(g){return{v:g}}));var c=typeof t=="string"?Hv(t,a).map(function(g){return g.v}):t,u=0,h=0;if(c.length>0)for(var d=0;d!==s.length;d+=2){switch(h=+s[d+1].v,s[d].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=h,r.SheetNames=c.slice(u,u+h);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=h,r.DefinedNames=c.slice(u,u+h);break;case"Charts":case"Diagramme":r.Chartsheets=h,r.ChartNames=c.slice(u,u+h);break}u+=h}}function h3(e,t,r){var a={};return t||(t={}),e=Jt(e),Bi.forEach(function(s){var l=(e.match(Oc(s[0]))||[])[1];switch(s[2]){case"string":l&&(t[s[1]]=Dt(l));break;case"bool":t[s[1]]=l==="true";break;case"raw":var c=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));c&&c.length>0&&(a[s[1]]=c[1]);break}}),a.HeadingPairs&&a.TitlesOfParts&&J_(a.HeadingPairs,a.TitlesOfParts,t,r),t}function Q_(e){var t=[],r=Me;return e||(e={}),e.Application="SheetJS",t[t.length]=Ar,t[t.length]=Me("Properties",null,{xmlns:Ur.EXT_PROPS,"xmlns:vt":Ur.vt}),Bi.forEach(function(a){if(e[a[1]]!==void 0){var s;switch(a[2]){case"string":s=$t(String(e[a[1]]));break;case"bool":s=e[a[1]]?"true":"false";break}s!==void 0&&(t[t.length]=r(a[0],s))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(a){return"<vt:lpstr>"+$t(a)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var d3=/<[^>]+>[^<]*/g;function m3(e,t){var r={},a="",s=e.match(d3);if(s)for(var l=0;l!=s.length;++l){var c=s[l],u=ht(c);switch(u[0]){case"<?xml":break;case"<Properties":break;case"<property":a=Dt(u.name);break;case"</property>":a=null;break;default:if(c.indexOf("<vt:")===0){var h=c.split(">"),d=h[0].slice(4),g=h[1];switch(d){case"lpstr":case"bstr":case"lpwstr":r[a]=Dt(g);break;case"bool":r[a]=sr(g);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[a]=parseInt(g,10);break;case"r4":case"r8":case"decimal":r[a]=parseFloat(g);break;case"filetime":case"date":r[a]=ir(g);break;case"cy":case"error":r[a]=Dt(g);break;default:if(d.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",c,d,h)}}else if(c.slice(0,2)!=="</"){if(t.WTF)throw new Error(c)}}}return r}function Z_(e){var t=[Ar,Me("Properties",null,{xmlns:Ur.CUST_PROPS,"xmlns:vt":Ur.vt})];if(!e)return t.join("");var r=1;return wr(e).forEach(function(s){++r,t[t.length]=Me("property",SA(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:$t(s)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var em={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Ad;function g3(e,t,r){Ad||(Ad=Yu(em)),t=Ad[t]||t,e[t]=r}function p3(e,t){var r=[];return wr(em).map(function(a){for(var s=0;s<dn.length;++s)if(dn[s][1]==a)return dn[s];for(s=0;s<Bi.length;++s)if(Bi[s][1]==a)return Bi[s];throw a}).forEach(function(a){if(e[a[1]]!=null){var s=t&&t.Props&&t.Props[a[1]]!=null?t.Props[a[1]]:e[a[1]];a[2]==="date"&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"Z")),typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(aa(em[a[1]]||a[1],s))}}),Me("DocumentProperties",r.join(""),{xmlns:$a.o})}function x3(e,t){var r=["Worksheets","SheetNames"],a="CustomDocumentProperties",s=[];return e&&wr(e).forEach(function(l){if(Object.prototype.hasOwnProperty.call(e,l)){for(var c=0;c<dn.length;++c)if(l==dn[c][1])return;for(c=0;c<Bi.length;++c)if(l==Bi[c][1])return;for(c=0;c<r.length;++c)if(l==r[c])return;var u=e[l],h="string";typeof u=="number"?(h="float",u=String(u)):u===!0||u===!1?(h="boolean",u=u?"1":"0"):u=String(u),s.push(Me(jv(l),u,{"dt:dt":h}))}}),t&&wr(t).forEach(function(l){if(Object.prototype.hasOwnProperty.call(t,l)&&!(e&&Object.prototype.hasOwnProperty.call(e,l))){var c=t[l],u="string";typeof c=="number"?(u="float",c=String(c)):c===!0||c===!1?(u="boolean",c=c?"1":"0"):c instanceof Date?(u="dateTime.tz",c=c.toISOString()):c=String(c),s.push(Me(jv(l),c,{"dt:dt":u}))}}),"<"+a+' xmlns="'+$a.o+'">'+s.join("")+"</"+a+">"}function Bm(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function v3(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,a=r%Math.pow(2,32),s=(r-a)/Math.pow(2,32);a*=1e7,s*=1e7;var l=a/Math.pow(2,32)|0;l>0&&(a=a%Math.pow(2,32),s+=l);var c=ve(8);return c.write_shift(4,a),c.write_shift(4,s),c}function e2(e,t,r){var a=e.l,s=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-a&3;)++e.l;return s}function t2(e,t,r){var a=e.read_shift(0,"lpwstr");return a}function r2(e,t,r){return t===31?t2(e):e2(e,t,r)}function tm(e,t,r){return r2(e,t,r===!1?0:4)}function y3(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return r2(e,t,0)}function _3(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a){var s=e.l;r[a]=e.read_shift(0,"lpwstr").replace(_a,""),e.l-s&2&&(e.l+=2)}return r}function w3(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a)r[a]=e.read_shift(0,"lpstr-cp").replace(_a,"");return r}function b3(e){var t=e.l,r=Pu(e,V_);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var a=Pu(e,Ra);return[r,a]}function S3(e){for(var t=e.read_shift(4),r=[],a=0;a<t/2;++a)r.push(b3(e));return r}function Zv(e,t){for(var r=e.read_shift(4),a={},s=0;s!=r;++s){var l=e.read_shift(4),c=e.read_shift(4);a[l]=e.read_shift(c,t===1200?"utf16le":"utf8").replace(_a,"").replace(cc,"!"),t===1200&&c%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),a}function a2(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function E3(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Pu(e,t,r){var a=e.read_shift(2),s,l=r||{};if(e.l+=2,t!==Yv&&a!==t&&t3.indexOf(t)===-1&&!((t&65534)==4126&&(a&65534)==4126))throw new Error("Expected type "+t+" saw "+a);switch(t===Yv?a:t){case 2:return s=e.read_shift(2,"i"),l.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return e2(e,a,4).replace(_a,"");case 31:return t2(e);case 64:return Bm(e);case 65:return a2(e);case 71:return E3(e);case 80:return tm(e,a,!l.raw).replace(_a,"");case 81:return y3(e,a).replace(_a,"");case 4108:return S3(e);case 4126:case 4127:return a==4127?_3(e):w3(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+a)}}function ey(e,t){var r=ve(4),a=ve(4);switch(r.write_shift(4,e==80?31:e),e){case 3:a.write_shift(-4,t);break;case 5:a=ve(8),a.write_shift(8,t,"f");break;case 11:a.write_shift(4,t?1:0);break;case 64:a=v3(t);break;case 31:case 80:for(a=ve(4+2*(t.length+1)+(t.length%2?0:2)),a.write_shift(4,t.length+1),a.write_shift(0,t,"dbcs");a.l!=a.length;)a.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Gr([r,a])}function ty(e,t){var r=e.l,a=e.read_shift(4),s=e.read_shift(4),l=[],c=0,u=0,h=-1,d={};for(c=0;c!=s;++c){var g=e.read_shift(4),x=e.read_shift(4);l[c]=[g,x+r]}l.sort(function(O,T){return O[1]-T[1]});var v={};for(c=0;c!=s;++c){if(e.l!==l[c][1]){var _=!0;if(c>0&&t)switch(t[l[c-1][0]].t){case 2:e.l+2===l[c][1]&&(e.l+=2,_=!1);break;case 80:e.l<=l[c][1]&&(e.l=l[c][1],_=!1);break;case 4108:e.l<=l[c][1]&&(e.l=l[c][1],_=!1);break}if((!t||c==0)&&e.l<=l[c][1]&&(_=!1,e.l=l[c][1]),_)throw new Error("Read Error: Expected address "+l[c][1]+" at "+e.l+" :"+c)}if(t){var b=t[l[c][0]];if(v[b.n]=Pu(e,b.t,{raw:!0}),b.p==="version"&&(v[b.n]=String(v[b.n]>>16)+"."+("0000"+String(v[b.n]&65535)).slice(-4)),b.n=="CodePage")switch(v[b.n]){case 0:v[b.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Tn(u=v[b.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+v[b.n])}}else if(l[c][0]===1){if(u=v.CodePage=Pu(e,Lm),Tn(u),h!==-1){var y=e.l;e.l=l[h][1],d=Zv(e,u),e.l=y}}else if(l[c][0]===0){if(u===0){h=c,e.l=l[c+1][1];continue}d=Zv(e,u)}else{var S=d[l[c][0]],k;switch(e[e.l]){case 65:e.l+=4,k=a2(e);break;case 30:e.l+=4,k=tm(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,k=tm(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,k=e.read_shift(4,"i");break;case 19:e.l+=4,k=e.read_shift(4);break;case 5:e.l+=4,k=e.read_shift(8,"f");break;case 11:e.l+=4,k=Tr(e,4);break;case 64:e.l+=4,k=ir(Bm(e));break;default:throw new Error("unparsed value: "+e[e.l])}v[S]=k}}return e.l=r+a,v}var n2=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function T3(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function ry(e,t,r){var a=ve(8),s=[],l=[],c=8,u=0,h=ve(8),d=ve(8);if(h.write_shift(4,2),h.write_shift(4,1200),d.write_shift(4,1),l.push(h),s.push(d),c+=8+h.length,!t){d=ve(8),d.write_shift(4,0),s.unshift(d);var g=[ve(4)];for(g[0].write_shift(4,e.length),u=0;u<e.length;++u){var x=e[u][0];for(h=ve(8+2*(x.length+1)+(x.length%2?0:2)),h.write_shift(4,u+2),h.write_shift(4,x.length+1),h.write_shift(0,x,"dbcs");h.l!=h.length;)h.write_shift(1,0);g.push(h)}h=Gr(g),l.unshift(h),c+=8+h.length}for(u=0;u<e.length;++u)if(!(t&&!t[e[u][0]])&&!(n2.indexOf(e[u][0])>-1||Y_.indexOf(e[u][0])>-1)&&e[u][1]!=null){var v=e[u][1],_=0;if(t){_=+t[e[u][0]];var b=r[_];if(b.p=="version"&&typeof v=="string"){var y=v.split(".");v=(+y[0]<<16)+(+y[1]||0)}h=ey(b.t,v)}else{var S=T3(v);S==-1&&(S=31,v=String(v)),h=ey(S,v)}l.push(h),d=ve(8),d.write_shift(4,t?_:2+u),s.push(d),c+=8+h.length}var k=8*(l.length+1);for(u=0;u<l.length;++u)s[u].write_shift(4,k),k+=l[u].length;return a.write_shift(4,c),a.write_shift(4,l.length),Gr([a].concat(s).concat(l))}function ay(e,t,r){var a=e.content;if(!a)return{};ra(a,0);var s,l,c,u,h=0;a.chk("feff","Byte Order: "),a.read_shift(2);var d=a.read_shift(4),g=a.read_shift(16);if(g!==st.utils.consts.HEADER_CLSID&&g!==r)throw new Error("Bad PropertySet CLSID "+g);if(s=a.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(l=a.read_shift(16),u=a.read_shift(4),s===1&&u!==a.l)throw new Error("Length mismatch: "+u+" !== "+a.l);s===2&&(c=a.read_shift(16),h=a.read_shift(4));var x=ty(a,t),v={SystemIdentifier:d};for(var _ in x)v[_]=x[_];if(v.FMTID=l,s===1)return v;if(h-a.l==2&&(a.l+=2),a.l!==h)throw new Error("Length mismatch 2: "+a.l+" !== "+h);var b;try{b=ty(a,null)}catch{}for(_ in b)v[_]=b[_];return v.FMTID=[l,c],v}function ny(e,t,r,a,s,l){var c=ve(s?68:48),u=[c];c.write_shift(2,65534),c.write_shift(2,0),c.write_shift(4,842412599),c.write_shift(16,st.utils.consts.HEADER_CLSID,"hex"),c.write_shift(4,s?2:1),c.write_shift(16,t,"hex"),c.write_shift(4,s?68:48);var h=ry(e,r,a);if(u.push(h),s){var d=ry(s,null,null);c.write_shift(16,l,"hex"),c.write_shift(4,68+h.length),u.push(d)}return Gr(u)}function Xs(e,t){return e.read_shift(t),null}function k3(e,t){t||(t=ve(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function A3(e,t,r){for(var a=[],s=e.l+t;e.l<s;)a.push(r(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return a}function Tr(e,t){return e.read_shift(t)===1}function ya(e,t){return t||(t=ve(2)),t.write_shift(2,+!!e),t}function Lr(e){return e.read_shift(2,"u")}function hn(e,t){return t||(t=ve(2)),t.write_shift(2,e),t}function s2(e,t){return A3(e,t,Lr)}function C3(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function i2(e,t,r){return r||(r=ve(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function qc(e,t,r){var a=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var l=e.read_shift(1);l&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var c=a?e.read_shift(a,s):"";return c}function N3(e){var t=e.read_shift(2),r=e.read_shift(1),a=r&4,s=r&8,l=1+(r&1),c=0,u,h={};s&&(c=e.read_shift(2)),a&&(u=e.read_shift(4));var d=l==2?"dbcs-cont":"sbcs-cont",g=t===0?"":e.read_shift(t,d);return s&&(e.l+=4*c),a&&(e.l+=u),h.t=g,s||(h.raw="<t>"+h.t+"</t>",h.r=h.t),h}function O3(e){var t=e.t||"",r=ve(3);r.write_shift(2,t.length),r.write_shift(1,1);var a=ve(2*t.length);a.write_shift(2*t.length,t,"utf16le");var s=[r,a];return Gr(s)}function $i(e,t,r){var a;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?a=e.read_shift(t,"sbcs-cont"):a=e.read_shift(t,"dbcs-cont"),a}function Xc(e,t,r){var a=e.read_shift(r&&r.biff==2?1:2);return a===0?(e.l++,""):$i(e,a,r)}function Qi(e,t,r){if(r.biff>5)return Xc(e,t,r);var a=e.read_shift(1);return a===0?(e.l++,""):e.read_shift(a,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function l2(e,t,r){return r||(r=ve(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function R3(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function D3(e){var t=e.read_shift(4),r=e.l,a=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(a=!0),e.l=r);var s=e.read_shift((a?t-24:t)>>1,"utf16le").replace(_a,"");return a&&(e.l+=24),s}function F3(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var a=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return r+a.replace(/\\/g,"/");var l=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var c=e.read_shift(l>>1,"utf16le").replace(_a,"");return r+c}function M3(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return D3(e);case"0303000000000000c000000000000046":return F3(e);default:throw new Error("Unsupported Moniker "+r)}}function _u(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(_a,""):"";return r}function sy(e,t){t||(t=ve(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function L3(e,t){var r=e.l+t,a=e.read_shift(4);if(a!==2)throw new Error("Unrecognized streamVersion: "+a);var s=e.read_shift(2);e.l+=2;var l,c,u,h,d="",g,x;s&16&&(l=_u(e,r-e.l)),s&128&&(c=_u(e,r-e.l)),(s&257)===257&&(u=_u(e,r-e.l)),(s&257)===1&&(h=M3(e,r-e.l)),s&8&&(d=_u(e,r-e.l)),s&32&&(g=e.read_shift(16)),s&64&&(x=Bm(e)),e.l=r;var v=c||u||h||"";v&&d&&(v+="#"+d),v||(v="#"+d),s&2&&v.charAt(0)=="/"&&v.charAt(1)!="/"&&(v="file://"+v);var _={Target:v};return g&&(_.guid=g),x&&(_.time=x),l&&(_.Tooltip=l),_}function I3(e){var t=ve(512),r=0,a=e.Target;a.slice(0,7)=="file://"&&(a=a.slice(7));var s=a.indexOf("#"),l=s>-1?31:23;switch(a.charAt(0)){case"#":l=28;break;case".":l&=-3;break}t.write_shift(4,2),t.write_shift(4,l);var c=[8,6815827,6619237,4849780,83];for(r=0;r<c.length;++r)t.write_shift(4,c[r]);if(l==28)a=a.slice(1),sy(a,t);else if(l&2){for(c="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<c.length;++r)t.write_shift(1,parseInt(c[r],16));var u=s>-1?a.slice(0,s):a;for(t.write_shift(4,2*(u.length+1)),r=0;r<u.length;++r)t.write_shift(2,u.charCodeAt(r));t.write_shift(2,0),l&8&&sy(s>-1?a.slice(s+1):"",t)}else{for(c="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<c.length;++r)t.write_shift(1,parseInt(c[r],16));for(var h=0;a.slice(h*3,h*3+3)=="../"||a.slice(h*3,h*3+3)=="..\\";)++h;for(t.write_shift(2,h),t.write_shift(4,a.length-3*h+1),r=0;r<a.length-3*h;++r)t.write_shift(1,a.charCodeAt(r+3*h)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function o2(e){var t=e.read_shift(1),r=e.read_shift(1),a=e.read_shift(1),s=e.read_shift(1);return[t,r,a,s]}function c2(e,t){var r=o2(e);return r[3]=0,r}function zn(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return{r:t,c:r,ixfe:a}}function Vi(e,t,r,a){return a||(a=ve(6)),a.write_shift(2,e),a.write_shift(2,t),a.write_shift(2,r||0),a}function B3(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function j3(e,t,r){return t===0?"":Qi(e,t,r)}function U3(e,t,r){var a=r.biff>8?4:2,s=e.read_shift(a),l=e.read_shift(a,"i"),c=e.read_shift(a,"i");return[s,l,c]}function u2(e){var t=e.read_shift(2),r=Mm(e);return[t,r]}function P3(e,t,r){e.l+=4,t-=4;var a=e.l+t,s=qc(e,t,r),l=e.read_shift(2);if(a-=e.l,l!==a)throw new Error("Malformed AddinUdf: padding = "+a+" != "+l);return e.l+=l,s}function Zu(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);return{s:{c:a,r:t},e:{c:s,r}}}function f2(e,t){return t||(t=ve(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function h2(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(1),s=e.read_shift(1);return{s:{c:a,r:t},e:{c:s,r}}}var z3=h2;function d2(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return e.l+=12,[r,t,a]}function H3(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function $3(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function oa(e){e.l+=2,e.l+=e.read_shift(2)}var V3={0:oa,4:oa,5:oa,6:oa,7:$3,8:oa,9:oa,10:oa,11:oa,12:oa,13:H3,14:oa,15:oa,16:oa,17:oa,18:oa,19:oa,20:oa,21:d2};function G3(e,t){for(var r=e.l+t,a=[];e.l<r;){var s=e.read_shift(2);e.l-=2;try{a.push(V3[s](e,r-e.l))}catch{return e.l=r,a}}return e.l!=r&&(e.l=r),a}function wu(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function jm(e,t,r){var a=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":a=1280,s=8;break;case"biff4":a=4,s=6;break;case"biff3":a=3,s=6;break;case"biff2":a=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var l=ve(s);return l.write_shift(2,a),l.write_shift(2,t),s>4&&l.write_shift(2,29282),s>6&&l.write_shift(2,1997),s>8&&(l.write_shift(2,49161),l.write_shift(2,1),l.write_shift(2,1798),l.write_shift(2,0)),l}function q3(e,t){return t===0||e.read_shift(2),1200}function X3(e,t,r){if(r.enc)return e.l+=t,"";var a=e.l,s=Qi(e,0,r);return e.read_shift(t+a-e.l),s}function W3(e,t){var r=!t||t.biff==8,a=ve(r?112:54);for(a.write_shift(t.biff==8?2:1,7),r&&a.write_shift(1,0),a.write_shift(4,859007059),a.write_shift(4,5458548|(r?0:536870912));a.l<a.length;)a.write_shift(1,r?0:32);return a}function K3(e,t,r){var a=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:a&16,fBelow:a&64,fRight:a&128}}function Y3(e,t,r){var a=e.read_shift(4),s=e.read_shift(1)&3,l=e.read_shift(1);switch(l){case 0:l="Worksheet";break;case 1:l="Macrosheet";break;case 2:l="Chartsheet";break;case 6:l="VBAModule";break}var c=qc(e,0,r);return c.length===0&&(c="Sheet1"),{pos:a,hs:s,dt:l,name:c}}function J3(e,t){var r=!t||t.biff>=8?2:1,a=ve(8+r*e.name.length);a.write_shift(4,e.pos),a.write_shift(1,e.hs||0),a.write_shift(1,e.dt),a.write_shift(1,e.name.length),t.biff>=8&&a.write_shift(1,1),a.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var s=a.slice(0,a.l);return s.l=a.l,s}function Q3(e,t){for(var r=e.l+t,a=e.read_shift(4),s=e.read_shift(4),l=[],c=0;c!=s&&e.l<r;++c)l.push(N3(e));return l.Count=a,l.Unique=s,l}function Z3(e,t){var r=ve(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var a=[],s=0;s<e.length;++s)a[s]=O3(e[s]);var l=Gr([r].concat(a));return l.parts=[r.length].concat(a.map(function(c){return c.length})),l}function eC(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function tC(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var a=e.read_shift(1);return e.l+=3,a&7&&(t.level=a&7),a&32&&(t.hidden=!0),a&64&&(t.hpt=r/20),t}function rC(e){var t=B3(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function aC(e){return e.read_shift(2),e.read_shift(4)}function iy(e,t,r){var a=0;r&&r.biff==2||(a=e.read_shift(2));var s=e.read_shift(2);r&&r.biff==2&&(a=1-(s>>15),s&=32767);var l={Unsynced:a&1,DyZero:(a&2)>>1,ExAsc:(a&4)>>2,ExDsc:(a&8)>>3};return[l,s]}function nC(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),u=e.read_shift(2),h=e.read_shift(2),d=e.read_shift(2);return{Pos:[t,r],Dim:[a,s],Flags:l,CurTab:c,FirstTab:u,Selected:h,TabRatio:d}}function sC(){var e=ve(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function iC(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var a=e.read_shift(2);return{RTL:a&64}}function lC(e){var t=ve(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function oC(){}function cC(e,t,r){var a={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return a.name=qc(e,0,r),a}function uC(e,t){var r=e.name||"Arial",a=t&&t.biff==5,s=a?15+r.length:16+2*r.length,l=ve(s);return l.write_shift(2,e.sz*20),l.write_shift(4,0),l.write_shift(2,400),l.write_shift(4,0),l.write_shift(2,0),l.write_shift(1,r.length),a||l.write_shift(1,1),l.write_shift((a?1:2)*r.length,r,a?"sbcs":"utf16le"),l}function fC(e){var t=zn(e);return t.isst=e.read_shift(4),t}function hC(e,t,r,a){var s=ve(10);return Vi(e,t,a,s),s.write_shift(4,r),s}function dC(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=e.l+t,s=zn(e);r.biff==2&&e.l++;var l=Xc(e,a-e.l,r);return s.val=l,s}function mC(e,t,r,a,s){var l=!s||s.biff==8,c=ve(8+ +l+(1+l)*r.length);return Vi(e,t,a,c),c.write_shift(2,r.length),l&&c.write_shift(1,1),c.write_shift((1+l)*r.length,r,l?"utf16le":"sbcs"),c}function gC(e,t,r){var a=e.read_shift(2),s=Qi(e,0,r);return[a,s]}function pC(e,t,r,a){var s=r&&r.biff==5;a||(a=ve(s?3+t.length:5+2*t.length)),a.write_shift(2,e),a.write_shift(s?1:2,t.length),s||a.write_shift(1,1),a.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le");var l=a.length>a.l?a.slice(0,a.l):a;return l.l==null&&(l.l=l.length),l}var xC=Qi;function ly(e,t,r){var a=e.l+t,s=r.biff==8||!r.biff?4:2,l=e.read_shift(s),c=e.read_shift(s),u=e.read_shift(2),h=e.read_shift(2);return e.l=a,{s:{r:l,c:u},e:{r:c,c:h}}}function vC(e,t){var r=t.biff==8||!t.biff?4:2,a=ve(2*r+6);return a.write_shift(r,e.s.r),a.write_shift(r,e.e.r+1),a.write_shift(2,e.s.c),a.write_shift(2,e.e.c+1),a.write_shift(2,0),a}function yC(e){var t=e.read_shift(2),r=e.read_shift(2),a=u2(e);return{r:t,c:r,ixfe:a[0],rknum:a[1]}}function _C(e,t){for(var r=e.l+t-2,a=e.read_shift(2),s=e.read_shift(2),l=[];e.l<r;)l.push(u2(e));if(e.l!==r)throw new Error("MulRK read error");var c=e.read_shift(2);if(l.length!=c-s+1)throw new Error("MulRK length mismatch");return{r:a,c:s,C:c,rkrec:l}}function wC(e,t){for(var r=e.l+t-2,a=e.read_shift(2),s=e.read_shift(2),l=[];e.l<r;)l.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var c=e.read_shift(2);if(l.length!=c-s+1)throw new Error("MulBlank length mismatch");return{r:a,c:s,C:c,ixfe:l}}function bC(e,t,r,a){var s={},l=e.read_shift(4),c=e.read_shift(4),u=e.read_shift(4),h=e.read_shift(2);return s.patternType=r3[u>>26],a.cellStyles&&(s.alc=l&7,s.fWrap=l>>3&1,s.alcV=l>>4&7,s.fJustLast=l>>7&1,s.trot=l>>8&255,s.cIndent=l>>16&15,s.fShrinkToFit=l>>20&1,s.iReadOrder=l>>22&2,s.fAtrNum=l>>26&1,s.fAtrFnt=l>>27&1,s.fAtrAlc=l>>28&1,s.fAtrBdr=l>>29&1,s.fAtrPat=l>>30&1,s.fAtrProt=l>>31&1,s.dgLeft=c&15,s.dgRight=c>>4&15,s.dgTop=c>>8&15,s.dgBottom=c>>12&15,s.icvLeft=c>>16&127,s.icvRight=c>>23&127,s.grbitDiag=c>>30&3,s.icvTop=u&127,s.icvBottom=u>>7&127,s.icvDiag=u>>14&127,s.dgDiag=u>>21&15,s.icvFore=h&127,s.icvBack=h>>7&127,s.fsxButton=h>>14&1),s}function SC(e,t,r){var a={};return a.ifnt=e.read_shift(2),a.numFmtId=e.read_shift(2),a.flags=e.read_shift(2),a.fStyle=a.flags>>2&1,t-=6,a.data=bC(e,t,a.fStyle,r),a}function oy(e,t,r,a){var s=r&&r.biff==5;a||(a=ve(s?16:20)),a.write_shift(2,0),e.style?(a.write_shift(2,e.numFmtId||0),a.write_shift(2,65524)):(a.write_shift(2,e.numFmtId||0),a.write_shift(2,t<<4));var l=0;return e.numFmtId>0&&s&&(l|=1024),a.write_shift(4,l),a.write_shift(4,0),s||a.write_shift(4,0),a.write_shift(2,0),a}function EC(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function TC(e){var t=ve(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function cy(e,t,r){var a=zn(e);(r.biff==2||t==9)&&++e.l;var s=C3(e);return a.val=s,a.t=s===!0||s===!1?"b":"e",a}function kC(e,t,r,a,s,l){var c=ve(8);return Vi(e,t,a,c),i2(r,l,c),c}function AC(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=zn(e),s=ha(e);return a.val=s,a}function CC(e,t,r,a){var s=ve(14);return Vi(e,t,a,s),Hi(r,s),s}var uy=j3;function NC(e,t,r){var a=e.l+t,s=e.read_shift(2),l=e.read_shift(2);if(r.sbcch=l,l==1025||l==14849)return[l,s];if(l<1||l>255)throw new Error("Unexpected SupBook type: "+l);for(var c=$i(e,l),u=[];a>e.l;)u.push(Xc(e));return[l,s,c,u]}function fy(e,t,r){var a=e.read_shift(2),s,l={fBuiltIn:a&1,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return r.sbcch===14849&&(s=P3(e,t-2,r)),l.body=s||e.read_shift(t-2),typeof s=="string"&&(l.Name=s),l}var OC=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function hy(e,t,r){var a=e.l+t,s=e.read_shift(2),l=e.read_shift(1),c=e.read_shift(1),u=e.read_shift(r&&r.biff==2?1:2),h=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),h=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var d=$i(e,c,r);s&32&&(d=OC[d.charCodeAt(0)]);var g=a-e.l;r&&r.biff==2&&--g;var x=a==e.l||u===0||!(g>0)?[]:GO(e,g,r,u);return{chKey:l,Name:d,itab:h,rgce:x}}function m2(e,t,r){if(r.biff<8)return RC(e,t,r);for(var a=[],s=e.l+t,l=e.read_shift(r.biff>8?4:2);l--!==0;)a.push(U3(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return a}function RC(e,t,r){e[e.l+1]==3&&e[e.l]++;var a=qc(e,t,r);return a.charCodeAt(0)==3?a.slice(1):a}function DC(e,t,r){if(r.biff<8){e.l+=t;return}var a=e.read_shift(2),s=e.read_shift(2),l=$i(e,a,r),c=$i(e,s,r);return[l,c]}function FC(e,t,r){var a=h2(e);e.l++;var s=e.read_shift(1);return t-=8,[qO(e,t,r),s,a]}function dy(e,t,r){var a=z3(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[a,$O(e,t,r)]}function MC(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,a=e.read_shift(4);return[t,r,a]}function LC(e,t,r){if(!(r.biff<8)){var a=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),u=Qi(e,0,r);return r.biff<8&&e.read_shift(1),[{r:a,c:s},u,c,l]}}function IC(e,t,r){return LC(e,t,r)}function BC(e,t){for(var r=[],a=e.read_shift(2);a--;)r.push(Zu(e));return r}function jC(e){var t=ve(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)f2(e[r],t);return t}function UC(e,t,r){if(r&&r.biff<8)return zC(e,t,r);var a=d2(e),s=G3(e,t-22,a[1]);return{cmo:a,ft:s}}var PC={8:function(e,t){var r=e.l+t;e.l+=10;var a=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=r,{fmt:a}}};function zC(e,t,r){e.l+=4;var a=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var c=[];return c.push((PC[a]||ma)(e,t,r)),{cmo:[s,a,l],ft:c}}function HC(e,t,r){var a=e.l,s="";try{e.l+=4;var l=(r.lastobj||{cmo:[0,0]}).cmo[1],c;[0,5,7,11,12,14].indexOf(l)==-1?e.l+=6:c=R3(e,6,r);var u=e.read_shift(2);e.read_shift(2),Lr(e,2);var h=e.read_shift(2);e.l+=h;for(var d=1;d<e.lens.length-1;++d){if(e.l-a!=e.lens[d])throw new Error("TxO: bad continue record");var g=e[e.l],x=$i(e,e.lens[d+1]-e.lens[d]-1);if(s+=x,s.length>=(g?u:2*u))break}if(s.length!==u&&s.length!==u*2)throw new Error("cchText: "+u+" != "+s.length);return e.l=a+t,{t:s}}catch{return e.l=a+t,{t:s}}}function $C(e,t){var r=Zu(e);e.l+=16;var a=L3(e,t-24);return[r,a]}function VC(e){var t=ve(24),r=dr(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var a="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)t.write_shift(1,parseInt(a[s],16));return Gr([t,I3(e[1])])}function GC(e,t){e.read_shift(2);var r=Zu(e),a=e.read_shift((t-10)/2,"dbcs-cont");return a=a.replace(_a,""),[r,a]}function qC(e){var t=e[1].Tooltip,r=ve(10+2*(t.length+1));r.write_shift(2,2048);var a=dr(e[0]);r.write_shift(2,a.r),r.write_shift(2,a.r),r.write_shift(2,a.c),r.write_shift(2,a.c);for(var s=0;s<t.length;++s)r.write_shift(2,t.charCodeAt(s));return r.write_shift(2,0),r}function XC(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=Jv[r]||r,r=e.read_shift(2),t[1]=Jv[r]||r,t}function WC(e){return e||(e=ve(4)),e.write_shift(2,1),e.write_shift(2,1),e}function KC(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(c2(e));return r}function YC(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(c2(e));return r}function JC(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function g2(e,t,r){if(!r.cellStyles)return ma(e,t);var a=r&&r.biff>=12?4:2,s=e.read_shift(a),l=e.read_shift(a),c=e.read_shift(a),u=e.read_shift(a),h=e.read_shift(2);a==2&&(e.l+=2);var d={s,e:l,w:c,ixfe:u,flags:h};return(r.biff>=5||!r.biff)&&(d.level=h>>8&7),d}function QC(e,t){var r=ve(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var a=0;return e.hidden&&(a|=1),r.write_shift(1,a),a=e.level||0,r.write_shift(1,a),r.write_shift(2,0),r}function ZC(e,t){var r={};return t<32||(e.l+=16,r.header=ha(e),r.footer=ha(e),e.l+=2),r}function eN(e,t,r){var a={area:!1};if(r.biff!=5)return e.l+=t,a;var s=e.read_shift(1);return e.l+=3,s&16&&(a.area=!0),a}function tN(e){for(var t=ve(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var rN=zn,aN=s2,nN=Xc;function sN(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),s={fmt:t,env:r,len:a,data:e.slice(e.l,e.l+a)};return e.l+=a,s}function iN(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var a=zn(e);++e.l;var s=Qi(e,t-7,r);return a.t="str",a.val=s,a}function lN(e){var t=zn(e);++e.l;var r=ha(e);return t.t="n",t.val=r,t}function oN(e,t,r){var a=ve(15);return Jc(a,e,t),a.write_shift(8,r,"f"),a}function cN(e){var t=zn(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function uN(e,t,r){var a=ve(9);return Jc(a,e,t),a.write_shift(2,r),a}function fN(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function hN(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function dN(e,t,r){var a=e.l+t,s=zn(e),l=e.read_shift(2),c=$i(e,l,r);return e.l=a,s.t="str",s.val=c,s}var mN=[2,3,48,49,131,139,140,245],rm=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Yu({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(u,h){var d=[],g=ti(1);switch(h.type){case"base64":g=Xa(Ka(u));break;case"binary":g=Xa(u);break;case"buffer":case"array":g=u;break}ra(g,0);var x=g.read_shift(1),v=!!(x&136),_=!1,b=!1;switch(x){case 2:break;case 3:break;case 48:_=!0,v=!0;break;case 49:_=!0,v=!0;break;case 131:break;case 139:break;case 140:b=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+x.toString(16))}var y=0,S=521;x==2&&(y=g.read_shift(2)),g.l+=3,x!=2&&(y=g.read_shift(4)),y>1048576&&(y=1e6),x!=2&&(S=g.read_shift(2));var k=g.read_shift(2),O=h.codepage||1252;x!=2&&(g.l+=16,g.read_shift(1),g[g.l]!==0&&(O=e[g[g.l]]),g.l+=1,g.l+=2),b&&(g.l+=36);for(var T=[],j={},X=Math.min(g.length,x==2?521:S-10-(_?264:0)),I=b?32:11;g.l<X&&g[g.l]!=13;)switch(j={},j.name=Ac.utils.decode(O,g.slice(g.l,g.l+I)).replace(/[\u0000\r\n].*$/g,""),g.l+=I,j.type=String.fromCharCode(g.read_shift(1)),x!=2&&!b&&(j.offset=g.read_shift(4)),j.len=g.read_shift(1),x==2&&(j.offset=g.read_shift(2)),j.dec=g.read_shift(1),j.name.length&&T.push(j),x!=2&&(g.l+=b?13:14),j.type){case"B":(!_||j.len!=8)&&h.WTF&&console.log("Skipping "+j.name+":"+j.type);break;case"G":case"P":h.WTF&&console.log("Skipping "+j.name+":"+j.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+j.type)}if(g[g.l]!==13&&(g.l=S-1),g.read_shift(1)!==13)throw new Error("DBF Terminator not found "+g.l+" "+g[g.l]);g.l=S;var C=0,K=0;for(d[0]=[],K=0;K!=T.length;++K)d[0][K]=T[K].name;for(;y-- >0;){if(g[g.l]===42){g.l+=k;continue}for(++g.l,d[++C]=[],K=0,K=0;K!=T.length;++K){var q=g.slice(g.l,g.l+T[K].len);g.l+=T[K].len,ra(q,0);var oe=Ac.utils.decode(O,q);switch(T[K].type){case"C":oe.trim().length&&(d[C][K]=oe.replace(/\s+$/,""));break;case"D":oe.length===8?d[C][K]=new Date(+oe.slice(0,4),+oe.slice(4,6)-1,+oe.slice(6,8)):d[C][K]=oe;break;case"F":d[C][K]=parseFloat(oe.trim());break;case"+":case"I":d[C][K]=b?q.read_shift(-4,"i")^2147483648:q.read_shift(4,"i");break;case"L":switch(oe.trim().toUpperCase()){case"Y":case"T":d[C][K]=!0;break;case"N":case"F":d[C][K]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+oe+"|")}break;case"M":if(!v)throw new Error("DBF Unexpected MEMO for type "+x.toString(16));d[C][K]="##MEMO##"+(b?parseInt(oe.trim(),10):q.read_shift(4));break;case"N":oe=oe.replace(/\u0000/g,"").trim(),oe&&oe!="."&&(d[C][K]=+oe||0);break;case"@":d[C][K]=new Date(q.read_shift(-8,"f")-621356832e5);break;case"T":d[C][K]=new Date((q.read_shift(4)-2440588)*864e5+q.read_shift(4));break;case"Y":d[C][K]=q.read_shift(4,"i")/1e4+q.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[C][K]=-q.read_shift(-8,"f");break;case"B":if(_&&T[K].len==8){d[C][K]=q.read_shift(8,"f");break}case"G":case"P":q.l+=T[K].len;break;case"0":if(T[K].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+T[K].type)}}}if(x!=2&&g.l<g.length&&g[g.l++]!=26)throw new Error("DBF EOF Marker missing "+(g.l-1)+" of "+g.length+" "+g[g.l-1].toString(16));return h&&h.sheetRows&&(d=d.slice(0,h.sheetRows)),h.DBF=T,d}function a(u,h){var d=h||{};d.dateNF||(d.dateNF="yyyymmdd");var g=co(r(u,d),d);return g["!cols"]=d.DBF.map(function(x){return{wch:x.len,DBF:x}}),delete d.DBF,g}function s(u,h){try{return li(a(u,h),h)}catch(d){if(h&&h.WTF)throw d}return{SheetNames:[],Sheets:{}}}var l={B:8,C:250,L:1,D:8,"?":0,"":0};function c(u,h){var d=h||{};if(+d.codepage>=0&&Tn(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var g=Da(),x=Vu(u,{header:1,raw:!0,cellDates:!0}),v=x[0],_=x.slice(1),b=u["!cols"]||[],y=0,S=0,k=0,O=1;for(y=0;y<v.length;++y){if(((b[y]||{}).DBF||{}).name){v[y]=b[y].DBF.name,++k;continue}if(v[y]!=null){if(++k,typeof v[y]=="number"&&(v[y]=v[y].toString(10)),typeof v[y]!="string")throw new Error("DBF Invalid column name "+v[y]+" |"+typeof v[y]+"|");if(v.indexOf(v[y])!==y){for(S=0;S<1024;++S)if(v.indexOf(v[y]+"_"+S)==-1){v[y]+="_"+S;break}}}}var T=Ft(u["!ref"]),j=[],X=[],I=[];for(y=0;y<=T.e.c-T.s.c;++y){var C="",K="",q=0,oe=[];for(S=0;S<_.length;++S)_[S][y]!=null&&oe.push(_[S][y]);if(oe.length==0||v[y]==null){j[y]="?";continue}for(S=0;S<oe.length;++S){switch(typeof oe[S]){case"number":K="B";break;case"string":K="C";break;case"boolean":K="L";break;case"object":K=oe[S]instanceof Date?"D":"C";break;default:K="C"}q=Math.max(q,String(oe[S]).length),C=C&&C!=K?"C":K}q>250&&(q=250),K=((b[y]||{}).DBF||{}).type,K=="C"&&b[y].DBF.len>q&&(q=b[y].DBF.len),C=="B"&&K=="N"&&(C="N",I[y]=b[y].DBF.dec,q=b[y].DBF.len),X[y]=C=="C"||K=="N"?q:l[C]||0,O+=X[y],j[y]=C}var ee=g.next(32);for(ee.write_shift(4,318902576),ee.write_shift(4,_.length),ee.write_shift(2,296+32*k),ee.write_shift(2,O),y=0;y<4;++y)ee.write_shift(4,0);for(ee.write_shift(4,0|(+t[n_]||3)<<8),y=0,S=0;y<v.length;++y)if(v[y]!=null){var Z=g.next(32),xe=(v[y].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);Z.write_shift(1,xe,"sbcs"),Z.write_shift(1,j[y]=="?"?"C":j[y],"sbcs"),Z.write_shift(4,S),Z.write_shift(1,X[y]||l[j[y]]||0),Z.write_shift(1,I[y]||0),Z.write_shift(1,2),Z.write_shift(4,0),Z.write_shift(1,0),Z.write_shift(4,0),Z.write_shift(4,0),S+=X[y]||l[j[y]]||0}var Ce=g.next(264);for(Ce.write_shift(4,13),y=0;y<65;++y)Ce.write_shift(4,0);for(y=0;y<_.length;++y){var Se=g.next(O);for(Se.write_shift(1,0),S=0;S<v.length;++S)if(v[S]!=null)switch(j[S]){case"L":Se.write_shift(1,_[y][S]==null?63:_[y][S]?84:70);break;case"B":Se.write_shift(8,_[y][S]||0,"f");break;case"N":var G="0";for(typeof _[y][S]=="number"&&(G=_[y][S].toFixed(I[S]||0)),k=0;k<X[S]-G.length;++k)Se.write_shift(1,32);Se.write_shift(1,G,"sbcs");break;case"D":_[y][S]?(Se.write_shift(4,("0000"+_[y][S].getFullYear()).slice(-4),"sbcs"),Se.write_shift(2,("00"+(_[y][S].getMonth()+1)).slice(-2),"sbcs"),Se.write_shift(2,("00"+_[y][S].getDate()).slice(-2),"sbcs")):Se.write_shift(8,"00000000","sbcs");break;case"C":var ne=String(_[y][S]!=null?_[y][S]:"").slice(0,X[S]);for(Se.write_shift(1,ne,"sbcs"),k=0;k<X[S]-ne.length;++k)Se.write_shift(1,32);break}}return g.next(1).write_shift(1,26),g.end()}return{to_workbook:s,to_sheet:a,from_sheet:c}})(),p2=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+wr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(v,_){var b=e[_];return typeof b=="number"?Ev(b):b},a=function(v,_,b){var y=_.charCodeAt(0)-32<<4|b.charCodeAt(0)-48;return y==59?v:Ev(y)};e["|"]=254;function s(v,_){switch(_.type){case"base64":return l(Ka(v),_);case"binary":return l(v,_);case"buffer":return l(wt&&Buffer.isBuffer(v)?v.toString("binary"):ii(v),_);case"array":return l(zi(v),_)}throw new Error("Unrecognized type "+_.type)}function l(v,_){var b=v.split(/[\n\r]+/),y=-1,S=-1,k=0,O=0,T=[],j=[],X=null,I={},C=[],K=[],q=[],oe=0,ee;for(+_.codepage>=0&&Tn(+_.codepage);k!==b.length;++k){oe=0;var Z=b[k].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(t,r),xe=Z.replace(/;;/g,"\0").split(";").map(function(z){return z.replace(/\u0000/g,";")}),Ce=xe[0],Se;if(Z.length>0)switch(Ce){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":xe[1].charAt(0)=="P"&&j.push(Z.slice(3).replace(/;;/g,";"));break;case"C":var G=!1,ne=!1,pe=!1,J=!1,be=-1,L=-1;for(O=1;O<xe.length;++O)switch(xe[O].charAt(0)){case"A":break;case"X":S=parseInt(xe[O].slice(1))-1,ne=!0;break;case"Y":for(y=parseInt(xe[O].slice(1))-1,ne||(S=0),ee=T.length;ee<=y;++ee)T[ee]=[];break;case"K":Se=xe[O].slice(1),Se.charAt(0)==='"'?Se=Se.slice(1,Se.length-1):Se==="TRUE"?Se=!0:Se==="FALSE"?Se=!1:isNaN(An(Se))?isNaN(ao(Se).getDate())||(Se=ir(Se)):(Se=An(Se),X!==null&&lo(X)&&(Se=Qu(Se))),G=!0;break;case"E":J=!0;var N=Zl(xe[O].slice(1),{r:y,c:S});T[y][S]=[T[y][S],N];break;case"S":pe=!0,T[y][S]=[T[y][S],"S5S"];break;case"G":break;case"R":be=parseInt(xe[O].slice(1))-1;break;case"C":L=parseInt(xe[O].slice(1))-1;break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+Z)}if(G&&(T[y][S]&&T[y][S].length==2?T[y][S][0]=Se:T[y][S]=Se,X=null),pe){if(J)throw new Error("SYLK shared formula cannot have own formula");var V=be>-1&&T[be][L];if(!V||!V[1])throw new Error("SYLK shared formula cannot find base");T[y][S][1]=M2(V[1],{r:y-be,c:S-L})}break;case"F":var M=0;for(O=1;O<xe.length;++O)switch(xe[O].charAt(0)){case"X":S=parseInt(xe[O].slice(1))-1,++M;break;case"Y":for(y=parseInt(xe[O].slice(1))-1,ee=T.length;ee<=y;++ee)T[ee]=[];break;case"M":oe=parseInt(xe[O].slice(1))/20;break;case"F":break;case"G":break;case"P":X=j[parseInt(xe[O].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(q=xe[O].slice(1).split(" "),ee=parseInt(q[0],10);ee<=parseInt(q[1],10);++ee)oe=parseInt(q[2],10),K[ee-1]=oe===0?{hidden:!0}:{wch:oe},ri(K[ee-1]);break;case"C":S=parseInt(xe[O].slice(1))-1,K[S]||(K[S]={});break;case"R":y=parseInt(xe[O].slice(1))-1,C[y]||(C[y]={}),oe>0?(C[y].hpt=oe,C[y].hpx=so(oe)):oe===0&&(C[y].hidden=!0);break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+Z)}M<1&&(X=null);break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+Z)}}return C.length>0&&(I["!rows"]=C),K.length>0&&(I["!cols"]=K),_&&_.sheetRows&&(T=T.slice(0,_.sheetRows)),[T,I]}function c(v,_){var b=s(v,_),y=b[0],S=b[1],k=co(y,_);return wr(S).forEach(function(O){k[O]=S[O]}),k}function u(v,_){return li(c(v,_),_)}function h(v,_,b,y){var S="C;Y"+(b+1)+";X"+(y+1)+";K";switch(v.t){case"n":S+=v.v||0,v.f&&!v.F&&(S+=";E"+Vm(v.f,{r:b,c:y}));break;case"b":S+=v.v?"TRUE":"FALSE";break;case"e":S+=v.w||v.v;break;case"d":S+='"'+(v.w||v.v)+'"';break;case"s":S+='"'+v.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return S}function d(v,_){_.forEach(function(b,y){var S="F;W"+(y+1)+" "+(y+1)+" ";b.hidden?S+="0":(typeof b.width=="number"&&!b.wpx&&(b.wpx=Lc(b.width)),typeof b.wpx=="number"&&!b.wch&&(b.wch=Ic(b.wpx)),typeof b.wch=="number"&&(S+=Math.round(b.wch))),S.charAt(S.length-1)!=" "&&v.push(S)})}function g(v,_){_.forEach(function(b,y){var S="F;";b.hidden?S+="M0;":b.hpt?S+="M"+20*b.hpt+";":b.hpx&&(S+="M"+20*Bc(b.hpx)+";"),S.length>2&&v.push(S+"R"+(y+1))})}function x(v,_){var b=["ID;PWXL;N;E"],y=[],S=Ft(v["!ref"]),k,O=Array.isArray(v),T=`\r
`;b.push("P;PGeneral"),b.push("F;P0;DG0G8;M255"),v["!cols"]&&d(b,v["!cols"]),v["!rows"]&&g(b,v["!rows"]),b.push("B;Y"+(S.e.r-S.s.r+1)+";X"+(S.e.c-S.s.c+1)+";D"+[S.s.c,S.s.r,S.e.c,S.e.r].join(" "));for(var j=S.s.r;j<=S.e.r;++j)for(var X=S.s.c;X<=S.e.c;++X){var I=ft({r:j,c:X});k=O?(v[j]||[])[X]:v[I],!(!k||k.v==null&&(!k.f||k.F))&&y.push(h(k,v,j,X))}return b.join(T)+T+y.join(T)+T+"E"+T}return{to_workbook:u,to_sheet:c,from_sheet:x}})(),x2=(function(){function e(l,c){switch(c.type){case"base64":return t(Ka(l),c);case"binary":return t(l,c);case"buffer":return t(wt&&Buffer.isBuffer(l)?l.toString("binary"):ii(l),c);case"array":return t(zi(l),c)}throw new Error("Unrecognized type "+c.type)}function t(l,c){for(var u=l.split(`
`),h=-1,d=-1,g=0,x=[];g!==u.length;++g){if(u[g].trim()==="BOT"){x[++h]=[],d=0;continue}if(!(h<0)){var v=u[g].trim().split(","),_=v[0],b=v[1];++g;for(var y=u[g]||"";(y.match(/["]/g)||[]).length&1&&g<u.length-1;)y+=`
`+u[++g];switch(y=y.trim(),+_){case-1:if(y==="BOT"){x[++h]=[],d=0;continue}else if(y!=="EOD")throw new Error("Unrecognized DIF special command "+y);break;case 0:y==="TRUE"?x[h][d]=!0:y==="FALSE"?x[h][d]=!1:isNaN(An(b))?isNaN(ao(b).getDate())?x[h][d]=b:x[h][d]=ir(b):x[h][d]=An(b),++d;break;case 1:y=y.slice(1,y.length-1),y=y.replace(/""/g,'"'),y&&y.match(/^=".*"$/)&&(y=y.slice(2,-1)),x[h][d++]=y!==""?y:null;break}if(y==="EOD")break}}return c&&c.sheetRows&&(x=x.slice(0,c.sheetRows)),x}function r(l,c){return co(e(l,c),c)}function a(l,c){return li(r(l,c),c)}var s=(function(){var l=function(h,d,g,x,v){h.push(d),h.push(g+","+x),h.push('"'+v.replace(/"/g,'""')+'"')},c=function(h,d,g,x){h.push(d+","+g),h.push(d==1?'"'+x.replace(/"/g,'""')+'"':x)};return function(h){var d=[],g=Ft(h["!ref"]),x,v=Array.isArray(h);l(d,"TABLE",0,1,"sheetjs"),l(d,"VECTORS",0,g.e.r-g.s.r+1,""),l(d,"TUPLES",0,g.e.c-g.s.c+1,""),l(d,"DATA",0,0,"");for(var _=g.s.r;_<=g.e.r;++_){c(d,-1,0,"BOT");for(var b=g.s.c;b<=g.e.c;++b){var y=ft({r:_,c:b});if(x=v?(h[_]||[])[b]:h[y],!x){c(d,1,0,"");continue}switch(x.t){case"n":var S=x.w;!S&&x.v!=null&&(S=x.v),S==null?x.f&&!x.F?c(d,1,0,"="+x.f):c(d,1,0,""):c(d,0,S,"V");break;case"b":c(d,0,x.v?1:0,x.v?"TRUE":"FALSE");break;case"s":c(d,1,0,isNaN(x.v)?x.v:'="'+x.v+'"');break;case"d":x.w||(x.w=mn(x.z||ct[14],Pr(ir(x.v)))),c(d,0,x.w,"V");break;default:c(d,1,0,"")}}}c(d,-1,0,"EOD");var k=`\r
`,O=d.join(k);return O}})();return{to_workbook:a,to_sheet:r,from_sheet:s}})(),v2=(function(){function e(x){return x.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(x){return x.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(x,v){for(var _=x.split(`
`),b=-1,y=-1,S=0,k=[];S!==_.length;++S){var O=_[S].trim().split(":");if(O[0]==="cell"){var T=dr(O[1]);if(k.length<=T.r)for(b=k.length;b<=T.r;++b)k[b]||(k[b]=[]);switch(b=T.r,y=T.c,O[2]){case"t":k[b][y]=e(O[3]);break;case"v":k[b][y]=+O[3];break;case"vtf":var j=O[O.length-1];case"vtc":O[3]==="nl"?k[b][y]=!!+O[4]:k[b][y]=+O[4],O[2]=="vtf"&&(k[b][y]=[k[b][y],j])}}}return v&&v.sheetRows&&(k=k.slice(0,v.sheetRows)),k}function a(x,v){return co(r(x,v),v)}function s(x,v){return li(a(x,v),v)}var l=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),c=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),h="--SocialCalcSpreadsheetControlSave--";function d(x){if(!x||!x["!ref"])return"";for(var v=[],_=[],b,y="",S=Fa(x["!ref"]),k=Array.isArray(x),O=S.s.r;O<=S.e.r;++O)for(var T=S.s.c;T<=S.e.c;++T)if(y=ft({r:O,c:T}),b=k?(x[O]||[])[T]:x[y],!(!b||b.v==null||b.t==="z")){switch(_=["cell",y,"t"],b.t){case"s":case"str":_.push(t(b.v));break;case"n":b.f?(_[2]="vtf",_[3]="n",_[4]=b.v,_[5]=t(b.f)):(_[2]="v",_[3]=b.v);break;case"b":_[2]="vt"+(b.f?"f":"c"),_[3]="nl",_[4]=b.v?"1":"0",_[5]=t(b.f||(b.v?"TRUE":"FALSE"));break;case"d":var j=Pr(ir(b.v));_[2]="vtc",_[3]="nd",_[4]=""+j,_[5]=b.w||mn(b.z||ct[14],j);break;case"e":continue}v.push(_.join(":"))}return v.push("sheet:c:"+(S.e.c-S.s.c+1)+":r:"+(S.e.r-S.s.r+1)+":tvf:1"),v.push("valueformat:1:text-wiki"),v.join(`
`)}function g(x){return[l,c,u,c,d(x),h].join(`
`)}return{to_workbook:s,to_sheet:a,from_sheet:g}})(),no=(function(){function e(g,x,v,_,b){b.raw?x[v][_]=g:g===""||(g==="TRUE"?x[v][_]=!0:g==="FALSE"?x[v][_]=!1:isNaN(An(g))?isNaN(ao(g).getDate())?x[v][_]=g:x[v][_]=ir(g):x[v][_]=An(g))}function t(g,x){var v=x||{},_=[];if(!g||g.length===0)return _;for(var b=g.split(/[\r\n]/),y=b.length-1;y>=0&&b[y].length===0;)--y;for(var S=10,k=0,O=0;O<=y;++O)k=b[O].indexOf(" "),k==-1?k=b[O].length:k++,S=Math.max(S,k);for(O=0;O<=y;++O){_[O]=[];var T=0;for(e(b[O].slice(0,S).trim(),_,O,T,v),T=1;T<=(b[O].length-S)/10+1;++T)e(b[O].slice(S+(T-1)*10,S+T*10).trim(),_,O,T,v)}return v.sheetRows&&(_=_.slice(0,v.sheetRows)),_}var r={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function s(g){for(var x={},v=!1,_=0,b=0;_<g.length;++_)(b=g.charCodeAt(_))==34?v=!v:!v&&b in r&&(x[b]=(x[b]||0)+1);b=[];for(_ in x)Object.prototype.hasOwnProperty.call(x,_)&&b.push([x[_],_]);if(!b.length){x=a;for(_ in x)Object.prototype.hasOwnProperty.call(x,_)&&b.push([x[_],_])}return b.sort(function(y,S){return y[0]-S[0]||a[y[1]]-a[S[1]]}),r[b.pop()[1]]||44}function l(g,x){var v=x||{},_="",b=v.dense?[]:{},y={s:{c:0,r:0},e:{c:0,r:0}};g.slice(0,4)=="sep="?g.charCodeAt(5)==13&&g.charCodeAt(6)==10?(_=g.charAt(4),g=g.slice(7)):g.charCodeAt(5)==13||g.charCodeAt(5)==10?(_=g.charAt(4),g=g.slice(6)):_=s(g.slice(0,1024)):v&&v.FS?_=v.FS:_=s(g.slice(0,1024));var S=0,k=0,O=0,T=0,j=0,X=_.charCodeAt(0),I=!1,C=0,K=g.charCodeAt(0);g=g.replace(/\r\n/mg,`
`);var q=v.dateNF!=null?eA(v.dateNF):null;function oe(){var ee=g.slice(T,j),Z={};if(ee.charAt(0)=='"'&&ee.charAt(ee.length-1)=='"'&&(ee=ee.slice(1,-1).replace(/""/g,'"')),ee.length===0)Z.t="z";else if(v.raw)Z.t="s",Z.v=ee;else if(ee.trim().length===0)Z.t="s",Z.v=ee;else if(ee.charCodeAt(0)==61)ee.charCodeAt(1)==34&&ee.charCodeAt(ee.length-1)==34?(Z.t="s",Z.v=ee.slice(2,-1).replace(/""/g,'"')):N8(ee)?(Z.t="n",Z.f=ee.slice(1)):(Z.t="s",Z.v=ee);else if(ee=="TRUE")Z.t="b",Z.v=!0;else if(ee=="FALSE")Z.t="b",Z.v=!1;else if(!isNaN(O=An(ee)))Z.t="n",v.cellText!==!1&&(Z.w=ee),Z.v=O;else if(!isNaN(ao(ee).getDate())||q&&ee.match(q)){Z.z=v.dateNF||ct[14];var xe=0;q&&ee.match(q)&&(ee=tA(ee,v.dateNF,ee.match(q)||[]),xe=1),v.cellDates?(Z.t="d",Z.v=ir(ee,xe)):(Z.t="n",Z.v=Pr(ir(ee,xe))),v.cellText!==!1&&(Z.w=mn(Z.z,Z.v instanceof Date?Pr(Z.v):Z.v)),v.cellNF||delete Z.z}else Z.t="s",Z.v=ee;if(Z.t=="z"||(v.dense?(b[S]||(b[S]=[]),b[S][k]=Z):b[ft({c:k,r:S})]=Z),T=j+1,K=g.charCodeAt(T),y.e.c<k&&(y.e.c=k),y.e.r<S&&(y.e.r=S),C==X)++k;else if(k=0,++S,v.sheetRows&&v.sheetRows<=S)return!0}e:for(;j<g.length;++j)switch(C=g.charCodeAt(j)){case 34:K===34&&(I=!I);break;case X:case 10:case 13:if(!I&&oe())break e;break}return j-T>0&&oe(),b["!ref"]=vt(y),b}function c(g,x){return!(x&&x.PRN)||x.FS||g.slice(0,4)=="sep="||g.indexOf("	")>=0||g.indexOf(",")>=0||g.indexOf(";")>=0?l(g,x):co(t(g,x),x)}function u(g,x){var v="",_=x.type=="string"?[0,0,0,0]:Qm(g,x);switch(x.type){case"base64":v=Ka(g);break;case"binary":v=g;break;case"buffer":x.codepage==65001?v=g.toString("utf8"):x.codepage&&typeof Ac<"u"||(v=wt&&Buffer.isBuffer(g)?g.toString("binary"):ii(g));break;case"array":v=zi(g);break;case"string":v=g;break;default:throw new Error("Unrecognized type "+x.type)}return _[0]==239&&_[1]==187&&_[2]==191?v=Jt(v.slice(3)):x.type!="string"&&x.type!="buffer"&&x.codepage==65001?v=Jt(v):x.type=="binary"&&typeof Ac<"u",v.slice(0,19)=="socialcalc:version:"?v2.to_sheet(x.type=="string"?v:Jt(v),x):c(v,x)}function h(g,x){return li(u(g,x),x)}function d(g){for(var x=[],v=Ft(g["!ref"]),_,b=Array.isArray(g),y=v.s.r;y<=v.e.r;++y){for(var S=[],k=v.s.c;k<=v.e.c;++k){var O=ft({r:y,c:k});if(_=b?(g[y]||[])[k]:g[O],!_||_.v==null){S.push("          ");continue}for(var T=(_.w||(ds(_),_.w)||"").slice(0,10);T.length<10;)T+=" ";S.push(T+(k===0?" ":""))}x.push(S.join(""))}return x.join(`
`)}return{to_workbook:h,to_sheet:u,from_sheet:d}})();function gN(e,t){var r=t||{},a=!!r.WTF;r.WTF=!0;try{var s=p2.to_workbook(e,r);return r.WTF=a,s}catch(l){if(r.WTF=a,!l.message.match(/SYLK bad record ID/)&&a)throw l;return no.to_workbook(e,t)}}var ji=(function(){function e(N,V,M){if(N){ra(N,N.l||0);for(var z=M.Enum||be;N.l<N.length;){var te=N.read_shift(2),ge=z[te]||z[65535],Ee=N.read_shift(2),ye=N.l+Ee,Ae=ge.f&&ge.f(N,Ee,M);if(N.l=ye,V(Ae,ge,te))return}}}function t(N,V){switch(V.type){case"base64":return r(Xa(Ka(N)),V);case"binary":return r(Xa(N),V);case"buffer":case"array":return r(N,V)}throw"Unsupported type "+V.type}function r(N,V){if(!N)return N;var M=V||{},z=M.dense?[]:{},te="Sheet1",ge="",Ee=0,ye={},Ae=[],tt=[],P={s:{r:0,c:0},e:{r:0,c:0}},St=M.sheetRows||0;if(N[2]==0&&(N[3]==8||N[3]==9)&&N.length>=16&&N[14]==5&&N[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(N[2]==2)M.Enum=be,e(N,function(Be,Vt,br){switch(br){case 0:M.vers=Be,Be>=4096&&(M.qpro=!0);break;case 6:P=Be;break;case 204:Be&&(ge=Be);break;case 222:ge=Be;break;case 15:case 51:M.qpro||(Be[1].v=Be[1].v.slice(1));case 13:case 14:case 16:br==14&&(Be[2]&112)==112&&(Be[2]&15)>1&&(Be[2]&15)<15&&(Be[1].z=M.dateNF||ct[14],M.cellDates&&(Be[1].t="d",Be[1].v=Qu(Be[1].v))),M.qpro&&Be[3]>Ee&&(z["!ref"]=vt(P),ye[te]=z,Ae.push(te),z=M.dense?[]:{},P={s:{r:0,c:0},e:{r:0,c:0}},Ee=Be[3],te=ge||"Sheet"+(Ee+1),ge="");var na=M.dense?(z[Be[0].r]||[])[Be[0].c]:z[ft(Be[0])];if(na){na.t=Be[1].t,na.v=Be[1].v,Be[1].z!=null&&(na.z=Be[1].z),Be[1].f!=null&&(na.f=Be[1].f);break}M.dense?(z[Be[0].r]||(z[Be[0].r]=[]),z[Be[0].r][Be[0].c]=Be[1]):z[ft(Be[0])]=Be[1];break}},M);else if(N[2]==26||N[2]==14)M.Enum=L,N[2]==14&&(M.qpro=!0,N.l=0),e(N,function(Be,Vt,br){switch(br){case 204:te=Be;break;case 22:Be[1].v=Be[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Be[3]>Ee&&(z["!ref"]=vt(P),ye[te]=z,Ae.push(te),z=M.dense?[]:{},P={s:{r:0,c:0},e:{r:0,c:0}},Ee=Be[3],te="Sheet"+(Ee+1)),St>0&&Be[0].r>=St)break;M.dense?(z[Be[0].r]||(z[Be[0].r]=[]),z[Be[0].r][Be[0].c]=Be[1]):z[ft(Be[0])]=Be[1],P.e.c<Be[0].c&&(P.e.c=Be[0].c),P.e.r<Be[0].r&&(P.e.r=Be[0].r);break;case 27:Be[14e3]&&(tt[Be[14e3][0]]=Be[14e3][1]);break;case 1537:tt[Be[0]]=Be[1],Be[0]==Ee&&(te=Be[1]);break}},M);else throw new Error("Unrecognized LOTUS BOF "+N[2]);if(z["!ref"]=vt(P),ye[ge||te]=z,Ae.push(ge||te),!tt.length)return{SheetNames:Ae,Sheets:ye};for(var at={},Et=[],dt=0;dt<tt.length;++dt)ye[Ae[dt]]?(Et.push(tt[dt]||Ae[dt]),at[tt[dt]]=ye[tt[dt]]||ye[Ae[dt]]):(Et.push(tt[dt]),at[tt[dt]]={"!ref":"A1"});return{SheetNames:Et,Sheets:at}}function a(N,V){var M=V||{};if(+M.codepage>=0&&Tn(+M.codepage),M.type=="string")throw new Error("Cannot write WK1 to JS string");var z=Da(),te=Ft(N["!ref"]),ge=Array.isArray(N),Ee=[];Le(z,0,l(1030)),Le(z,6,h(te));for(var ye=Math.min(te.e.r,8191),Ae=te.s.r;Ae<=ye;++Ae)for(var tt=kr(Ae),P=te.s.c;P<=te.e.c;++P){Ae===te.s.r&&(Ee[P]=hr(P));var St=Ee[P]+tt,at=ge?(N[Ae]||[])[P]:N[St];if(!(!at||at.t=="z"))if(at.t=="n")(at.v|0)==at.v&&at.v>=-32768&&at.v<=32767?Le(z,13,_(Ae,P,at.v)):Le(z,14,y(Ae,P,at.v));else{var Et=ds(at);Le(z,15,x(Ae,P,Et.slice(0,239)))}}return Le(z,1),z.end()}function s(N,V){var M=V||{};if(+M.codepage>=0&&Tn(+M.codepage),M.type=="string")throw new Error("Cannot write WK3 to JS string");var z=Da();Le(z,0,c(N));for(var te=0,ge=0;te<N.SheetNames.length;++te)(N.Sheets[N.SheetNames[te]]||{})["!ref"]&&Le(z,27,J(N.SheetNames[te],ge++));var Ee=0;for(te=0;te<N.SheetNames.length;++te){var ye=N.Sheets[N.SheetNames[te]];if(!(!ye||!ye["!ref"])){for(var Ae=Ft(ye["!ref"]),tt=Array.isArray(ye),P=[],St=Math.min(Ae.e.r,8191),at=Ae.s.r;at<=St;++at)for(var Et=kr(at),dt=Ae.s.c;dt<=Ae.e.c;++dt){at===Ae.s.r&&(P[dt]=hr(dt));var Be=P[dt]+Et,Vt=tt?(ye[at]||[])[dt]:ye[Be];if(!(!Vt||Vt.t=="z"))if(Vt.t=="n")Le(z,23,oe(at,dt,Ee,Vt.v));else{var br=ds(Vt);Le(z,22,C(at,dt,Ee,br.slice(0,239)))}}++Ee}}return Le(z,1),z.end()}function l(N){var V=ve(2);return V.write_shift(2,N),V}function c(N){var V=ve(26);V.write_shift(2,4096),V.write_shift(2,4),V.write_shift(4,0);for(var M=0,z=0,te=0,ge=0;ge<N.SheetNames.length;++ge){var Ee=N.SheetNames[ge],ye=N.Sheets[Ee];if(!(!ye||!ye["!ref"])){++te;var Ae=Fa(ye["!ref"]);M<Ae.e.r&&(M=Ae.e.r),z<Ae.e.c&&(z=Ae.e.c)}}return M>8191&&(M=8191),V.write_shift(2,M),V.write_shift(1,te),V.write_shift(1,z),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(1,1),V.write_shift(1,2),V.write_shift(4,0),V.write_shift(4,0),V}function u(N,V,M){var z={s:{c:0,r:0},e:{c:0,r:0}};return V==8&&M.qpro?(z.s.c=N.read_shift(1),N.l++,z.s.r=N.read_shift(2),z.e.c=N.read_shift(1),N.l++,z.e.r=N.read_shift(2),z):(z.s.c=N.read_shift(2),z.s.r=N.read_shift(2),V==12&&M.qpro&&(N.l+=2),z.e.c=N.read_shift(2),z.e.r=N.read_shift(2),V==12&&M.qpro&&(N.l+=2),z.s.c==65535&&(z.s.c=z.e.c=z.s.r=z.e.r=0),z)}function h(N){var V=ve(8);return V.write_shift(2,N.s.c),V.write_shift(2,N.s.r),V.write_shift(2,N.e.c),V.write_shift(2,N.e.r),V}function d(N,V,M){var z=[{c:0,r:0},{t:"n",v:0},0,0];return M.qpro&&M.vers!=20768?(z[0].c=N.read_shift(1),z[3]=N.read_shift(1),z[0].r=N.read_shift(2),N.l+=2):(z[2]=N.read_shift(1),z[0].c=N.read_shift(2),z[0].r=N.read_shift(2)),z}function g(N,V,M){var z=N.l+V,te=d(N,V,M);if(te[1].t="s",M.vers==20768){N.l++;var ge=N.read_shift(1);return te[1].v=N.read_shift(ge,"utf8"),te}return M.qpro&&N.l++,te[1].v=N.read_shift(z-N.l,"cstr"),te}function x(N,V,M){var z=ve(7+M.length);z.write_shift(1,255),z.write_shift(2,V),z.write_shift(2,N),z.write_shift(1,39);for(var te=0;te<z.length;++te){var ge=M.charCodeAt(te);z.write_shift(1,ge>=128?95:ge)}return z.write_shift(1,0),z}function v(N,V,M){var z=d(N,V,M);return z[1].v=N.read_shift(2,"i"),z}function _(N,V,M){var z=ve(7);return z.write_shift(1,255),z.write_shift(2,V),z.write_shift(2,N),z.write_shift(2,M,"i"),z}function b(N,V,M){var z=d(N,V,M);return z[1].v=N.read_shift(8,"f"),z}function y(N,V,M){var z=ve(13);return z.write_shift(1,255),z.write_shift(2,V),z.write_shift(2,N),z.write_shift(8,M,"f"),z}function S(N,V,M){var z=N.l+V,te=d(N,V,M);if(te[1].v=N.read_shift(8,"f"),M.qpro)N.l=z;else{var ge=N.read_shift(2);j(N.slice(N.l,N.l+ge),te),N.l+=ge}return te}function k(N,V,M){var z=V&32768;return V&=-32769,V=(z?N:0)+(V>=8192?V-16384:V),(z?"":"$")+(M?hr(V):kr(V))}var O={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},T=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function j(N,V){ra(N,0);for(var M=[],z=0,te="",ge="",Ee="",ye="";N.l<N.length;){var Ae=N[N.l++];switch(Ae){case 0:M.push(N.read_shift(8,"f"));break;case 1:ge=k(V[0].c,N.read_shift(2),!0),te=k(V[0].r,N.read_shift(2),!1),M.push(ge+te);break;case 2:{var tt=k(V[0].c,N.read_shift(2),!0),P=k(V[0].r,N.read_shift(2),!1);ge=k(V[0].c,N.read_shift(2),!0),te=k(V[0].r,N.read_shift(2),!1),M.push(tt+P+":"+ge+te)}break;case 3:if(N.l<N.length){console.error("WK1 premature formula end");return}break;case 4:M.push("("+M.pop()+")");break;case 5:M.push(N.read_shift(2));break;case 6:{for(var St="";Ae=N[N.l++];)St+=String.fromCharCode(Ae);M.push('"'+St.replace(/"/g,'""')+'"')}break;case 8:M.push("-"+M.pop());break;case 23:M.push("+"+M.pop());break;case 22:M.push("NOT("+M.pop()+")");break;case 20:case 21:ye=M.pop(),Ee=M.pop(),M.push(["AND","OR"][Ae-20]+"("+Ee+","+ye+")");break;default:if(Ae<32&&T[Ae])ye=M.pop(),Ee=M.pop(),M.push(Ee+T[Ae]+ye);else if(O[Ae]){if(z=O[Ae][1],z==69&&(z=N[N.l++]),z>M.length){console.error("WK1 bad formula parse 0x"+Ae.toString(16)+":|"+M.join("|")+"|");return}var at=M.slice(-z);M.length-=z,M.push(O[Ae][0]+"("+at.join(",")+")")}else return Ae<=7?console.error("WK1 invalid opcode "+Ae.toString(16)):Ae<=24?console.error("WK1 unsupported op "+Ae.toString(16)):Ae<=30?console.error("WK1 invalid opcode "+Ae.toString(16)):Ae<=115?console.error("WK1 unsupported function opcode "+Ae.toString(16)):console.error("WK1 unrecognized opcode "+Ae.toString(16))}}M.length==1?V[1].f=""+M[0]:console.error("WK1 bad formula parse |"+M.join("|")+"|")}function X(N){var V=[{c:0,r:0},{t:"n",v:0},0];return V[0].r=N.read_shift(2),V[3]=N[N.l++],V[0].c=N[N.l++],V}function I(N,V){var M=X(N);return M[1].t="s",M[1].v=N.read_shift(V-4,"cstr"),M}function C(N,V,M,z){var te=ve(6+z.length);te.write_shift(2,N),te.write_shift(1,M),te.write_shift(1,V),te.write_shift(1,39);for(var ge=0;ge<z.length;++ge){var Ee=z.charCodeAt(ge);te.write_shift(1,Ee>=128?95:Ee)}return te.write_shift(1,0),te}function K(N,V){var M=X(N);M[1].v=N.read_shift(2);var z=M[1].v>>1;if(M[1].v&1)switch(z&7){case 0:z=(z>>3)*5e3;break;case 1:z=(z>>3)*500;break;case 2:z=(z>>3)/20;break;case 3:z=(z>>3)/200;break;case 4:z=(z>>3)/2e3;break;case 5:z=(z>>3)/2e4;break;case 6:z=(z>>3)/16;break;case 7:z=(z>>3)/64;break}return M[1].v=z,M}function q(N,V){var M=X(N),z=N.read_shift(4),te=N.read_shift(4),ge=N.read_shift(2);if(ge==65535)return z===0&&te===3221225472?(M[1].t="e",M[1].v=15):z===0&&te===3489660928?(M[1].t="e",M[1].v=42):M[1].v=0,M;var Ee=ge&32768;return ge=(ge&32767)-16446,M[1].v=(1-Ee*2)*(te*Math.pow(2,ge+32)+z*Math.pow(2,ge)),M}function oe(N,V,M,z){var te=ve(14);if(te.write_shift(2,N),te.write_shift(1,M),te.write_shift(1,V),z==0)return te.write_shift(4,0),te.write_shift(4,0),te.write_shift(2,65535),te;var ge=0,Ee=0,ye=0,Ae=0;return z<0&&(ge=1,z=-z),Ee=Math.log2(z)|0,z/=Math.pow(2,Ee-31),Ae=z>>>0,(Ae&2147483648)==0&&(z/=2,++Ee,Ae=z>>>0),z-=Ae,Ae|=2147483648,Ae>>>=0,z*=Math.pow(2,32),ye=z>>>0,te.write_shift(4,ye),te.write_shift(4,Ae),Ee+=16383+(ge?32768:0),te.write_shift(2,Ee),te}function ee(N,V){var M=q(N);return N.l+=V-14,M}function Z(N,V){var M=X(N),z=N.read_shift(4);return M[1].v=z>>6,M}function xe(N,V){var M=X(N),z=N.read_shift(8,"f");return M[1].v=z,M}function Ce(N,V){var M=xe(N);return N.l+=V-10,M}function Se(N,V){return N[N.l+V-1]==0?N.read_shift(V,"cstr"):""}function G(N,V){var M=N[N.l++];M>V-1&&(M=V-1);for(var z="";z.length<M;)z+=String.fromCharCode(N[N.l++]);return z}function ne(N,V,M){if(!(!M.qpro||V<21)){var z=N.read_shift(1);N.l+=17,N.l+=1,N.l+=2;var te=N.read_shift(V-21,"cstr");return[z,te]}}function pe(N,V){for(var M={},z=N.l+V;N.l<z;){var te=N.read_shift(2);if(te==14e3){for(M[te]=[0,""],M[te][0]=N.read_shift(2);N[N.l];)M[te][1]+=String.fromCharCode(N[N.l]),N.l++;N.l++}}return M}function J(N,V){var M=ve(5+N.length);M.write_shift(2,14e3),M.write_shift(2,V);for(var z=0;z<N.length;++z){var te=N.charCodeAt(z);M[M.l++]=te>127?95:te}return M[M.l++]=0,M}var be={0:{n:"BOF",f:Lr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:v},14:{n:"NUMBER",f:b},15:{n:"LABEL",f:g},16:{n:"FORMULA",f:S},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:g},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Se},222:{n:"SHEETNAMELP",f:G},65535:{n:""}},L={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:I},23:{n:"NUMBER17",f:q},24:{n:"NUMBER18",f:K},25:{n:"FORMULA19",f:ee},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:pe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:Z},38:{n:"??"},39:{n:"NUMBER27",f:xe},40:{n:"FORMULA28",f:Ce},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Se},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ne},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:s,to_workbook:t}})();function pN(e){var t={},r=e.match(ga),a=0,s=!1;if(r)for(;a!=r.length;++a){var l=ht(r[a]);switch(l[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!l.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(l.val=="1")break;t.cp=gm[parseInt(l.val,10)];break;case"<outline":if(!l.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=l.val;break;case"<sz":t.sz=l.val;break;case"<strike":if(!l.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!l.val)break;switch(l.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(l.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(l.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":l.rgb&&(t.color=l.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=l.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=l.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(l[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+l[0])}}return t}var xN=(function(){var e=Oc("t"),t=Oc("rPr");function r(l){var c=l.match(e);if(!c)return{t:"s",v:""};var u={t:"s",v:Dt(c[1])},h=l.match(t);return h&&(u.s=pN(h[1])),u}var a=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(c){return c.replace(a,"").split(s).map(r).filter(function(u){return u.v})}})(),vN=(function(){var t=/(\r\n|\n)/g;function r(s,l,c){var u=[];s.u&&u.push("text-decoration: underline;"),s.uval&&u.push("text-underline-style:"+s.uval+";"),s.sz&&u.push("font-size:"+s.sz+"pt;"),s.outline&&u.push("text-effect: outline;"),s.shadow&&u.push("text-shadow: auto;"),l.push('<span style="'+u.join("")+'">'),s.b&&(l.push("<b>"),c.push("</b>")),s.i&&(l.push("<i>"),c.push("</i>")),s.strike&&(l.push("<s>"),c.push("</s>"));var h=s.valign||"";return h=="superscript"||h=="super"?h="sup":h=="subscript"&&(h="sub"),h!=""&&(l.push("<"+h+">"),c.push("</"+h+">")),c.push("</span>"),s}function a(s){var l=[[],s.v,[]];return s.v?(s.s&&r(s.s,l[0],l[2]),l[0].join("")+l[1].replace(t,"<br/>")+l[2].join("")):""}return function(l){return l.map(a).join("")}})(),yN=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,_N=/<(?:\w+:)?r>/,wN=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Um(e,t){var r=t?t.cellHTML:!0,a={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=Dt(Jt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=Jt(e),r&&(a.h=Tm(a.t))):e.match(_N)&&(a.r=Jt(e),a.t=Dt(Jt((e.replace(wN,"").match(yN)||[]).join("").replace(ga,""))),r&&(a.h=vN(xN(a.r)))),a):{t:""}}var bN=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,SN=/<(?:\w+:)?(?:si|sstItem)>/g,EN=/<\/(?:\w+:)?(?:si|sstItem)>/;function TN(e,t){var r=[],a="";if(!e)return r;var s=e.match(bN);if(s){a=s[2].replace(SN,"").split(EN);for(var l=0;l!=a.length;++l){var c=Um(a[l].trim(),t);c!=null&&(r[r.length]=c)}s=ht(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}var kN=/^\s|\s$|[\t\n\r]/;function y2(e,t){if(!t.bookSST)return"";var r=[Ar];r[r.length]=Me("sst",null,{xmlns:Xi[0],count:e.Count,uniqueCount:e.Unique});for(var a=0;a!=e.length;++a)if(e[a]!=null){var s=e[a],l="<si>";s.r?l+=s.r:(l+="<t",s.t||(s.t=""),s.t.match(kN)&&(l+=' xml:space="preserve"'),l+=">"+$t(s.t)+"</t>"),l+="</si>",r[r.length]=l}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function AN(e){return[e.read_shift(4),e.read_shift(4)]}function CN(e,t){var r=[],a=!1;return ps(e,function(l,c,u){switch(u){case 159:r.Count=l[0],r.Unique=l[1];break;case 19:r.push(l);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(c.T,!a||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}),r}function NN(e,t){return t||(t=ve(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var ON=PA;function RN(e){var t=Da();Ne(t,159,NN(e));for(var r=0;r<e.length;++r)Ne(t,19,ON(e[r]));return Ne(t,160),t.end()}function _2(e){for(var t=[],r=e.split(""),a=0;a<r.length;++a)t[a]=r[a].charCodeAt(0);return t}function hs(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function DN(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=hs(e,4),t.U=hs(e,4),t.W=hs(e,4),t}function FN(e){for(var t=e.read_shift(4),r=e.l+t-4,a={},s=e.read_shift(4),l=[];s-- >0;)l.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(a.name=e.read_shift(0,"lpp4"),a.comps=l,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return a}function MN(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(FN(e));return t}function LN(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function IN(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=hs(e,4),t.U=hs(e,4),t.W=hs(e,4),t}function BN(e){var t=IN(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function w2(e,t){var r=e.l+t,a={};a.Flags=e.read_shift(4)&63,e.l+=4,a.AlgID=e.read_shift(4);var s=!1;switch(a.AlgID){case 26126:case 26127:case 26128:s=a.Flags==36;break;case 26625:s=a.Flags==4;break;case 0:s=a.Flags==16||a.Flags==4||a.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=e.read_shift(4),a.KeySize=e.read_shift(4),a.ProviderType=e.read_shift(4),e.l+=8,a.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,a}function b2(e,t){var r={},a=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,a),e.l=a,r}function jN(e){var t=hs(e);switch(t.Minor){case 2:return[t.Minor,UN(e)];case 3:return[t.Minor,PN()];case 4:return[t.Minor,zN(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function UN(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),a=w2(e,r),s=b2(e,e.length-e.l);return{t:"Std",h:a,v:s}}function PN(){throw new Error("File is password-protected: ECMA-376 Extensible")}function zN(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),a={};return r.replace(ga,function(l){var c=ht(l);switch(Pn(c[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(u){a[u]=c[u]});break;case"<dataIntegrity":a.encryptedHmacKey=c.encryptedHmacKey,a.encryptedHmacValue=c.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":a.uri=c.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":a.encs.push(c);break;default:throw c[0]}}),a}function HN(e,t){var r={},a=r.EncryptionVersionInfo=hs(e,4);if(t-=4,a.Minor!=2)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);r.Flags=e.read_shift(4),t-=4;var s=e.read_shift(4);return t-=4,r.EncryptionHeader=w2(e,s),t-=s,r.EncryptionVerifier=b2(e,t),r}function $N(e){var t={},r=t.EncryptionVersionInfo=hs(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function Pm(e){var t=0,r,a=_2(e),s=a.length+1,l,c,u,h,d;for(r=ti(s),r[0]=a.length,l=1;l!=s;++l)r[l]=a[l-1];for(l=s-1;l>=0;--l)c=r[l],u=(t&16384)===0?0:1,h=t<<1&32767,d=u|h,t=d^c;return t^52811}var S2=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(c){return(c/2|c*128)&255},s=function(c,u){return a(c^u)},l=function(c){for(var u=t[c.length-1],h=104,d=c.length-1;d>=0;--d)for(var g=c[d],x=0;x!=7;++x)g&64&&(u^=r[h]),g*=2,--h;return u};return function(c){for(var u=_2(c),h=l(u),d=u.length,g=ti(16),x=0;x!=16;++x)g[x]=0;var v,_,b;for((d&1)===1&&(v=h>>8,g[d]=s(e[0],v),--d,v=h&255,_=u[u.length-1],g[d]=s(_,v));d>0;)--d,v=h>>8,g[d]=s(u[d],v),--d,v=h&255,g[d]=s(u[d],v);for(d=15,b=15-u.length;b>0;)v=h>>8,g[d]=s(e[b],v),--d,--b,v=h&255,g[d]=s(u[d],v),--d,--b;return g}})(),VN=function(e,t,r,a,s){s||(s=t),a||(a=S2(e));var l,c;for(l=0;l!=t.length;++l)c=t[l],c^=a[r],c=(c>>5|c<<3)&255,s[l]=c,++r;return[s,r,a]},GN=function(e){var t=0,r=S2(e);return function(a){var s=VN("",a,t,r);return t=s[1],s[0]}};function qN(e,t,r,a){var s={key:Lr(e),verificationBytes:Lr(e)};return r.password&&(s.verifier=Pm(r.password)),a.valid=s.verificationBytes===s.verifier,a.valid&&(a.insitu=GN(r.password)),s}function XN(e,t,r){var a=r||{};return a.Info=e.read_shift(2),e.l-=2,a.Info===1?a.Data=$N(e):a.Data=HN(e,t),a}function WN(e,t,r){var a={Type:r.biff>=8?e.read_shift(2):0};return a.Type?XN(e,t-2,a):qN(e,r.biff>=8?t:t-2,r,a),a}var E2=(function(){function e(s,l){switch(l.type){case"base64":return t(Ka(s),l);case"binary":return t(s,l);case"buffer":return t(wt&&Buffer.isBuffer(s)?s.toString("binary"):ii(s),l);case"array":return t(zi(s),l)}throw new Error("Unrecognized type "+l.type)}function t(s,l){var c=l||{},u=c.dense?[]:{},h=s.match(/\\trowd.*?\\row\b/g);if(!h.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:h.length-1}};return h.forEach(function(g,x){Array.isArray(u)&&(u[x]=[]);for(var v=/\\\w+\b/g,_=0,b,y=-1;b=v.exec(g);){switch(b[0]){case"\\cell":var S=g.slice(_,v.lastIndex-b[0].length);if(S[0]==" "&&(S=S.slice(1)),++y,S.length){var k={v:S,t:"s"};Array.isArray(u)?u[x][y]=k:u[ft({r:x,c:y})]=k}break}_=v.lastIndex}y>d.e.c&&(d.e.c=y)}),u["!ref"]=vt(d),u}function r(s,l){return li(e(s,l),l)}function a(s){for(var l=["{\\rtf1\\ansi"],c=Ft(s["!ref"]),u,h=Array.isArray(s),d=c.s.r;d<=c.e.r;++d){l.push("\\trowd\\trautofit1");for(var g=c.s.c;g<=c.e.c;++g)l.push("\\cellx"+(g+1));for(l.push("\\pard\\intbl"),g=c.s.c;g<=c.e.c;++g){var x=ft({r:d,c:g});u=h?(s[d]||[])[g]:s[x],!(!u||u.v==null&&(!u.f||u.F))&&(l.push(" "+(u.w||(ds(u),u.w))),l.push("\\cell"))}l.push("\\pard\\intbl\\row")}return l.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:a}})();function KN(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Mc(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function YN(e){var t=e[0]/255,r=e[1]/255,a=e[2]/255,s=Math.max(t,r,a),l=Math.min(t,r,a),c=s-l;if(c===0)return[0,0,t];var u=0,h=0,d=s+l;switch(h=c/(d>1?2-d:d),s){case t:u=((r-a)/c+6)%6;break;case r:u=(a-t)/c+2;break;case a:u=(t-r)/c+4;break}return[u/6,h,d/2]}function JN(e){var t=e[0],r=e[1],a=e[2],s=r*2*(a<.5?a:1-a),l=a-s/2,c=[l,l,l],u=6*t,h;if(r!==0)switch(u|0){case 0:case 6:h=s*u,c[0]+=s,c[1]+=h;break;case 1:h=s*(2-u),c[0]+=h,c[1]+=s;break;case 2:h=s*(u-2),c[1]+=s,c[2]+=h;break;case 3:h=s*(4-u),c[1]+=h,c[2]+=s;break;case 4:h=s*(u-4),c[2]+=s,c[0]+=h;break;case 5:h=s*(6-u),c[2]+=h,c[0]+=s;break}for(var d=0;d!=3;++d)c[d]=Math.round(c[d]*255);return c}function zu(e,t){if(t===0)return e;var r=YN(KN(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Mc(JN(r))}var T2=6,QN=15,ZN=1,fa=T2;function Lc(e){return Math.floor((e+Math.round(128/fa)/256)*fa)}function Ic(e){return Math.floor((e-5)/fa*100+.5)/100}function Hu(e){return Math.round((e*fa+5)/fa*256)/256}function Cd(e){return Hu(Ic(Lc(e)))}function zm(e){var t=Math.abs(e-Cd(e)),r=fa;if(t>.005)for(fa=ZN;fa<QN;++fa)Math.abs(e-Cd(e))<=t&&(t=Math.abs(e-Cd(e)),r=fa);fa=r}function ri(e){e.width?(e.wpx=Lc(e.width),e.wch=Ic(e.wpx),e.MDW=fa):e.wpx?(e.wch=Ic(e.wpx),e.width=Hu(e.wch),e.MDW=fa):typeof e.wch=="number"&&(e.width=Hu(e.wch),e.wpx=Lc(e.width),e.MDW=fa),e.customWidth&&delete e.customWidth}var e6=96,k2=e6;function Bc(e){return e*96/k2}function so(e){return e*k2/96}var t6={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function r6(e,t,r,a){t.Borders=[];var s={},l=!1;(e[0].match(ga)||[]).forEach(function(c){var u=ht(c);switch(Pn(u[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},u.diagonalUp&&(s.diagonalUp=sr(u.diagonalUp)),u.diagonalDown&&(s.diagonalDown=sr(u.diagonalDown)),t.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(a&&a.WTF&&!l)throw new Error("unrecognized "+u[0]+" in borders")}})}function a6(e,t,r,a){t.Fills=[];var s={},l=!1;(e[0].match(ga)||[]).forEach(function(c){var u=ht(c);switch(Pn(u[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},t.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":u.patternType&&(s.patternType=u.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),u.indexed&&(s.bgColor.indexed=parseInt(u.indexed,10)),u.theme&&(s.bgColor.theme=parseInt(u.theme,10)),u.tint&&(s.bgColor.tint=parseFloat(u.tint)),u.rgb&&(s.bgColor.rgb=u.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),u.theme&&(s.fgColor.theme=parseInt(u.theme,10)),u.tint&&(s.fgColor.tint=parseFloat(u.tint)),u.rgb!=null&&(s.fgColor.rgb=u.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(a&&a.WTF&&!l)throw new Error("unrecognized "+u[0]+" in fills")}})}function n6(e,t,r,a){t.Fonts=[];var s={},l=!1;(e[0].match(ga)||[]).forEach(function(c){var u=ht(c);switch(Pn(u[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(s),s={};break;case"<name":u.val&&(s.name=Jt(u.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=u.val?sr(u.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=u.val?sr(u.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(u.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=u.val?sr(u.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=u.val?sr(u.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=u.val?sr(u.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=u.val?sr(u.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=u.val?sr(u.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":u.val&&(s.sz=+u.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":u.val&&(s.vertAlign=u.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":u.val&&(s.family=parseInt(u.val,10));break;case"<family/>":case"</family>":break;case"<scheme":u.val&&(s.scheme=u.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(u.val=="1")break;u.codepage=gm[parseInt(u.val,10)];break;case"<color":if(s.color||(s.color={}),u.auto&&(s.color.auto=sr(u.auto)),u.rgb)s.color.rgb=u.rgb.slice(-6);else if(u.indexed){s.color.index=parseInt(u.indexed,10);var h=Ii[s.color.index];s.color.index==81&&(h=Ii[1]),h||(h=Ii[1]),s.color.rgb=h[0].toString(16)+h[1].toString(16)+h[2].toString(16)}else u.theme&&(s.color.theme=parseInt(u.theme,10),u.tint&&(s.color.tint=parseFloat(u.tint)),u.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=zu(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":l=!0;break;case"</AlternateContent>":l=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(a&&a.WTF&&!l)throw new Error("unrecognized "+u[0]+" in fonts")}})}function s6(e,t,r){t.NumberFmt=[];for(var a=wr(ct),s=0;s<a.length;++s)t.NumberFmt[a[s]]=ct[a[s]];var l=e[0].match(ga);if(l)for(s=0;s<l.length;++s){var c=ht(l[s]);switch(Pn(c[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var u=Dt(Jt(c.formatCode)),h=parseInt(c.numFmtId,10);if(t.NumberFmt[h]=u,h>0){if(h>392){for(h=392;h>60&&t.NumberFmt[h]!=null;--h);t.NumberFmt[h]=u}fs(u,h)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+c[0]+" in numFmts")}}}function i6(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)e[a]!=null&&(t[t.length]=Me("numFmt",null,{numFmtId:a,formatCode:$t(e[a])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Me("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var bu=["numFmtId","fillId","fontId","borderId","xfId"],Su=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function l6(e,t,r){t.CellXf=[];var a,s=!1;(e[0].match(ga)||[]).forEach(function(l){var c=ht(l),u=0;switch(Pn(c[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(a=c,delete a[0],u=0;u<bu.length;++u)a[bu[u]]&&(a[bu[u]]=parseInt(a[bu[u]],10));for(u=0;u<Su.length;++u)a[Su[u]]&&(a[Su[u]]=sr(a[Su[u]]));if(t.NumberFmt&&a.numFmtId>392){for(u=392;u>60;--u)if(t.NumberFmt[a.numFmtId]==t.NumberFmt[u]){a.numFmtId=u;break}}t.CellXf.push(a);break;case"</xf>":break;case"<alignment":case"<alignment/>":var h={};c.vertical&&(h.vertical=c.vertical),c.horizontal&&(h.horizontal=c.horizontal),c.textRotation!=null&&(h.textRotation=c.textRotation),c.indent&&(h.indent=c.indent),c.wrapText&&(h.wrapText=sr(c.wrapText)),a.alignment=h;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+c[0]+" in cellXfs")}})}function o6(e){var t=[];return t[t.length]=Me("cellXfs",null),e.forEach(function(r){t[t.length]=Me("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Me("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var c6=(function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,a=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,l=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(u,h,d){var g={};if(!u)return g;u=u.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var x;return(x=u.match(t))&&s6(x,g,d),(x=u.match(s))&&n6(x,g,h,d),(x=u.match(a))&&a6(x,g,h,d),(x=u.match(l))&&r6(x,g,h,d),(x=u.match(r))&&l6(x,g,d),g}})();function A2(e,t){var r=[Ar,Me("styleSheet",null,{xmlns:Xi[0],"xmlns:vt":Ur.vt})],a;return e.SSF&&(a=i6(e.SSF))!=null&&(r[r.length]=a),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(a=o6(t.cellXfs))&&(r[r.length]=a),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function u6(e,t){var r=e.read_shift(2),a=da(e);return[r,a]}function f6(e,t,r){r||(r=ve(6+4*t.length)),r.write_shift(2,e),qr(t,r);var a=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),a}function h6(e,t,r){var a={};a.sz=e.read_shift(2)/20;var s=XA(e);s.fItalic&&(a.italic=1),s.fCondense&&(a.condense=1),s.fExtend&&(a.extend=1),s.fShadow&&(a.shadow=1),s.fOutline&&(a.outline=1),s.fStrikeout&&(a.strike=1);var l=e.read_shift(2);switch(l===700&&(a.bold=1),e.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var c=e.read_shift(1);c!=0&&(a.underline=c);var u=e.read_shift(1);u>0&&(a.family=u);var h=e.read_shift(1);switch(h>0&&(a.charset=h),e.l++,a.color=qA(e),e.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=da(e),a}function d6(e,t){t||(t=ve(153)),t.write_shift(2,e.sz*20),WA(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),ju(e.color,t);var a=0;return a=2,t.write_shift(1,a),qr(e.name,t),t.length>t.l?t.slice(0,t.l):t}var m6=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Nd,g6=ma;function my(e,t){t||(t=ve(84)),Nd||(Nd=Yu(m6));var r=Nd[e.patternType];r==null&&(r=40),t.write_shift(4,r);var a=0;if(r!=40)for(ju({auto:1},t),ju({auto:1},t);a<12;++a)t.write_shift(4,0);else{for(;a<4;++a)t.write_shift(4,0);for(;a<12;++a)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function p6(e,t){var r=e.l+t,a=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:a,numFmtId:s}}function C2(e,t,r){r||(r=ve(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var a=0;return r.write_shift(1,a),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function ic(e,t){return t||(t=ve(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var x6=ma;function v6(e,t){return t||(t=ve(51)),t.write_shift(1,0),ic(null,t),ic(null,t),ic(null,t),ic(null,t),ic(null,t),t.length>t.l?t.slice(0,t.l):t}function y6(e,t){return t||(t=ve(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Bu(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function _6(e,t,r){var a=ve(2052);return a.write_shift(4,e),Bu(t,a),Bu(r,a),a.length>a.l?a.slice(0,a.l):a}function w6(e,t,r){var a={};a.NumberFmt=[];for(var s in ct)a.NumberFmt[s]=ct[s];a.CellXf=[],a.Fonts=[];var l=[],c=!1;return ps(e,function(h,d,g){switch(g){case 44:a.NumberFmt[h[0]]=h[1],fs(h[1],h[0]);break;case 43:a.Fonts.push(h),h.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(h.color.rgb=zu(t.themeElements.clrScheme[h.color.theme].rgb,h.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:l[l.length-1]==617&&a.CellXf.push(h);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:c=!0;break;case 36:c=!1;break;case 37:l.push(g),c=!0;break;case 38:l.pop(),c=!1;break;default:if(d.T>0)l.push(g);else if(d.T<0)l.pop();else if(!c||r.WTF&&l[l.length-1]!=37)throw new Error("Unexpected record 0x"+g.toString(16))}}),a}function b6(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var s=a[0];s<=a[1];++s)t[s]!=null&&++r}),r!=0&&(Ne(e,615,Cn(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var s=a[0];s<=a[1];++s)t[s]!=null&&Ne(e,44,f6(s,t[s]))}),Ne(e,616))}}function S6(e){var t=1;Ne(e,611,Cn(t)),Ne(e,43,d6({sz:12,color:{theme:1},name:"Calibri",family:2})),Ne(e,612)}function E6(e){var t=2;Ne(e,603,Cn(t)),Ne(e,45,my({patternType:"none"})),Ne(e,45,my({patternType:"gray125"})),Ne(e,604)}function T6(e){var t=1;Ne(e,613,Cn(t)),Ne(e,46,v6()),Ne(e,614)}function k6(e){var t=1;Ne(e,626,Cn(t)),Ne(e,47,C2({numFmtId:0},65535)),Ne(e,627)}function A6(e,t){Ne(e,617,Cn(t.length)),t.forEach(function(r){Ne(e,47,C2(r,0))}),Ne(e,618)}function C6(e){var t=1;Ne(e,619,Cn(t)),Ne(e,48,y6({xfId:0,name:"Normal"})),Ne(e,620)}function N6(e){var t=0;Ne(e,505,Cn(t)),Ne(e,506)}function O6(e){var t=0;Ne(e,508,_6(t,"TableStyleMedium9","PivotStyleMedium4")),Ne(e,509)}function R6(e,t){var r=Da();return Ne(r,278),b6(r,e.SSF),S6(r),E6(r),T6(r),k6(r),A6(r,t.cellXfs),C6(r),N6(r),O6(r),Ne(r,279),r.end()}var D6=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function F6(e,t,r){t.themeElements.clrScheme=[];var a={};(e[0].match(ga)||[]).forEach(function(s){var l=ht(s);switch(l[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=l.val;break;case"<a:sysClr":a.rgb=l.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":l[0].charAt(1)==="/"?(t.themeElements.clrScheme[D6.indexOf(l[0])]=a,a={}):a.name=l[0].slice(3,l[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+l[0]+" in clrScheme")}})}function M6(){}function L6(){}var I6=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,B6=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,j6=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function U6(e,t,r){t.themeElements={};var a;[["clrScheme",I6,F6],["fontScheme",B6,M6],["fmtScheme",j6,L6]].forEach(function(s){if(!(a=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](a,t,r)})}var P6=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function N2(e,t){(!e||e.length===0)&&(e=Hm());var r,a={};if(!(r=e.match(P6)))throw new Error("themeElements not found in theme");return U6(r[0],a,t),a.raw=e,a}function Hm(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Ar];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function z6(e,t,r){var a=e.l+t,s=e.read_shift(4);if(s!==124226){if(!r.cellStyles){e.l=a;return}var l=e.slice(e.l);e.l=a;var c;try{c=w_(l,{type:"array"})}catch{return}var u=Wa(c,"theme/theme/theme1.xml",!0);if(u)return N2(u,r)}}function H6(e){return e.read_shift(4)}function $6(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=V6(e,4);break;case 2:t.xclrValue=o2(e);break;case 3:t.xclrValue=H6(e);break;case 4:e.l+=4;break}return e.l+=8,t}function V6(e,t){return ma(e,t)}function G6(e,t){return ma(e,t)}function q6(e){var t=e.read_shift(2),r=e.read_shift(2)-4,a=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=$6(e);break;case 6:a[1]=G6(e,r);break;case 14:case 15:a[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return a}function X6(e,t){var r=e.l+t;e.l+=2;var a=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),l=[];s-- >0;)l.push(q6(e,r-e.l));return{ixfe:a,ext:l}}function W6(e,t){t.forEach(function(r){r[0]})}function K6(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:da(e)}}function Y6(e){var t=ve(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),qr(e.name,t),t.slice(0,t.l)}function J6(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function Q6(e){var t=ve(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function Z6(e,t){var r=ve(8+2*t.length);return r.write_shift(4,e),qr(t,r),r.slice(0,r.l)}function e8(e){return e.l+=4,e.read_shift(4)!=0}function t8(e,t){var r=ve(8);return r.write_shift(4,e),r.write_shift(4,1),r}function r8(e,t,r){var a={Types:[],Cell:[],Value:[]},s=r||{},l=[],c=!1,u=2;return ps(e,function(h,d,g){switch(g){case 335:a.Types.push({name:h.name});break;case 51:h.forEach(function(x){u==1?a.Cell.push({type:a.Types[x[0]-1].name,index:x[1]}):u==0&&a.Value.push({type:a.Types[x[0]-1].name,index:x[1]})});break;case 337:u=h?1:0;break;case 338:u=2;break;case 35:l.push(g),c=!0;break;case 36:l.pop(),c=!1;break;default:if(!d.T){if(!c||s.WTF&&l[l.length-1]!=35)throw new Error("Unexpected record 0x"+g.toString(16))}}}),a}function a8(){var e=Da();return Ne(e,332),Ne(e,334,Cn(1)),Ne(e,335,Y6({name:"XLDAPR",version:12e4,flags:3496657072})),Ne(e,336),Ne(e,339,Z6(1,"XLDAPR")),Ne(e,52),Ne(e,35,Cn(514)),Ne(e,4096,Cn(0)),Ne(e,4097,hn(1)),Ne(e,36),Ne(e,53),Ne(e,340),Ne(e,337,t8(1)),Ne(e,51,Q6([[1,0]])),Ne(e,338),Ne(e,333),e.end()}function n8(e,t,r){var a={Types:[],Cell:[],Value:[]};if(!e)return a;var s=!1,l=2,c;return e.replace(ga,function(u){var h=ht(u);switch(Pn(h[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":a.Types.push({name:h.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<a.Types.length;++d)a.Types[d].name==h.name&&(c=a.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":l==1?a.Cell.push({type:a.Types[h.t-1].name,index:+h.v}):l==0&&a.Value.push({type:a.Types[h.t-1].name,index:+h.v});break;case"</rc>":break;case"<cellMetadata":l=1;break;case"</cellMetadata>":l=2;break;case"<valueMetadata":l=0;break;case"</valueMetadata>":l=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!c)break;c.offsets||(c.offsets=[]),c.offsets.push(+h.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+h[0]+" in metadata")}return u}),a}function O2(){var e=[Ar];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function s8(e){var t=[];if(!e)return t;var r=1;return(e.match(ga)||[]).forEach(function(a){var s=ht(a);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,t.push(s);break}}),t}function i8(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=ft(r);var a=e.read_shift(1);return a&2&&(t.l="1"),a&8&&(t.a="1"),t}function l8(e,t,r){var a=[];return ps(e,function(l,c,u){switch(u){case 63:a.push(l);break;default:if(!c.T)throw new Error("Unexpected record 0x"+u.toString(16))}}),a}function o8(e,t,r,a){if(!e)return e;var s=a||{},l=!1;ps(e,function(u,h,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:l=!0;break;case 36:l=!1;break;default:if(!h.T){if(!l||s.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},s)}function c8(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var Kl=1024;function R2(e,t){for(var r=[21600,21600],a=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[Me("xml",null,{"xmlns:v":$a.v,"xmlns:o":$a.o,"xmlns:x":$a.x,"xmlns:mv":$a.mv}).replace(/\/>/,">"),Me("o:shapelayout",Me("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Me("v:shapetype",[Me("v:stroke",null,{joinstyle:"miter"}),Me("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:a})];Kl<e*1e3;)Kl+=1e3;return t.forEach(function(l){var c=dr(l[0]),u={color2:"#BEFF82",type:"gradient"};u.type=="gradient"&&(u.angle="-180");var h=u.type=="gradient"?Me("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=Me("v:fill",h,u),g={on:"t",obscured:"t"};++Kl,s=s.concat(["<v:shape"+Rc({id:"_x0000_s"+Kl,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(l[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,Me("v:shadow",null,g),Me("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",aa("x:Anchor",[c.c+1,0,c.r+1,0,c.c+3,20,c.r+5,20].join(",")),aa("x:AutoFill","False"),aa("x:Row",String(c.r)),aa("x:Column",String(c.c)),l[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function gy(e,t,r,a){var s=Array.isArray(e),l;t.forEach(function(c){var u=dr(c.ref);if(s?(e[u.r]||(e[u.r]=[]),l=e[u.r][u.c]):l=e[c.ref],!l){l={t:"z"},s?e[u.r][u.c]=l:e[c.ref]=l;var h=Ft(e["!ref"]||"BDWGO1000001:A1");h.s.r>u.r&&(h.s.r=u.r),h.e.r<u.r&&(h.e.r=u.r),h.s.c>u.c&&(h.s.c=u.c),h.e.c<u.c&&(h.e.c=u.c);var d=vt(h);d!==e["!ref"]&&(e["!ref"]=d)}l.c||(l.c=[]);var g={a:c.author,t:c.t,r:c.r,T:r};c.h&&(g.h=c.h);for(var x=l.c.length-1;x>=0;--x){if(!r&&l.c[x].T)return;r&&!l.c[x].T&&l.c.splice(x,1)}if(r&&a){for(x=0;x<a.length;++x)if(g.a==a[x].id){g.a=a[x].name||g.a;break}}l.c.push(g)})}function u8(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],a=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(c){if(!(c===""||c.trim()==="")){var u=c.match(/<(?:\w+:)?author[^>]*>(.*)/);u&&r.push(u[1])}});var l=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return l&&l[1]&&l[1].split(/<\/\w*:?comment>/).forEach(function(c){if(!(c===""||c.trim()==="")){var u=c.match(/<(?:\w+:)?comment[^>]*>/);if(u){var h=ht(u[0]),d={author:h.authorId&&r[h.authorId]||"sheetjsghost",ref:h.ref,guid:h.guid},g=dr(h.ref);if(!(t.sheetRows&&t.sheetRows<=g.r)){var x=c.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),v=!!x&&!!x[1]&&Um(x[1])||{r:"",t:"",h:""};d.r=v.r,v.r=="<t></t>"&&(v.t=v.h=""),d.t=(v.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(d.h=v.h),a.push(d)}}}}),a}function D2(e){var t=[Ar,Me("comments",null,{xmlns:Xi[0]})],r=[];return t.push("<authors>"),e.forEach(function(a){a[1].forEach(function(s){var l=$t(s.a);r.indexOf(l)==-1&&(r.push(l),t.push("<author>"+l+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),t.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(a){var s=0,l=[];if(a[1][0]&&a[1][0].T&&a[1][0].ID?s=r.indexOf("tc="+a[1][0].ID):a[1].forEach(function(h){h.a&&(s=r.indexOf($t(h.a))),l.push(h.t||"")}),t.push('<comment ref="'+a[0]+'" authorId="'+s+'"><text>'),l.length<=1)t.push(aa("t",$t(l[0]||"")));else{for(var c=`Comment:
    `+l[0]+`
`,u=1;u<l.length;++u)c+=`Reply:
    `+l[u]+`
`;t.push(aa("t",$t(c)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function f8(e,t){var r=[],a=!1,s={},l=0;return e.replace(ga,function(u,h){var d=ht(u);switch(Pn(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":l=h+u.length;break;case"</text>":s.t=e.slice(l,h).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":a=!0;break;case"</mentions>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return u}),r}function h8(e,t,r){var a=[Ar,Me("ThreadedComments",null,{xmlns:Ur.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var l="";(s[1]||[]).forEach(function(c,u){if(!c.T){delete c.ID;return}c.a&&t.indexOf(c.a)==-1&&t.push(c.a);var h={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};u==0?l=h.id:h.parentId=l,c.ID=h.id,c.a&&(h.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(c.a)).slice(-12)+"}"),a.push(Me("threadedComment",aa("text",c.t||""),h))})}),a.push("</ThreadedComments>"),a.join("")}function d8(e,t){var r=[],a=!1;return e.replace(ga,function(l){var c=ht(l);switch(Pn(c[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:c.displayname,id:c.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return l}),r}function m8(e){var t=[Ar,Me("personList",null,{xmlns:Ur.TCMNT,"xmlns:x":Xi[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,a){t.push(Me("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+a).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function g8(e){var t={};t.iauthor=e.read_shift(4);var r=Ji(e);return t.rfx=r.s,t.ref=ft(r.s),e.l+=16,t}function p8(e,t){return t==null&&(t=ve(36)),t.write_shift(4,e[1].iauthor),uo(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var x8=da;function v8(e){return qr(e.slice(0,54))}function y8(e,t){var r=[],a=[],s={},l=!1;return ps(e,function(u,h,d){switch(d){case 632:a.push(u);break;case 635:s=u;break;case 637:s.t=u.t,s.h=u.h,s.r=u.r;break;case 636:if(s.author=a[s.iauthor],delete s.iauthor,t.sheetRows&&s.rfx&&t.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!h.T){if(!l||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),r}function _8(e){var t=Da(),r=[];return Ne(t,628),Ne(t,630),e.forEach(function(a){a[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),Ne(t,632,v8(s.a)))})}),Ne(t,631),Ne(t,633),e.forEach(function(a){a[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var l={s:dr(a[0]),e:dr(a[0])};Ne(t,635,p8([l,s])),s.t&&s.t.length>0&&Ne(t,637,HA(s)),Ne(t,636),delete s.iauthor})}),Ne(t,634),Ne(t,629),t.end()}var w8="application/vnd.ms-office.vbaProject";function b8(e){var t=st.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,a){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");st.utils.cfb_add(t,s,e.FileIndex[a].content)}}),st.write(t)}function S8(e,t){t.FullPaths.forEach(function(r,a){if(a!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&st.utils.cfb_add(e,s,t.FileIndex[a].content)}})}var F2=["xlsb","xlsm","xlam","biff8","xla"];function E8(){return{"!type":"dialog"}}function T8(){return{"!type":"dialog"}}function k8(){return{"!type":"macro"}}function A8(){return{"!type":"macro"}}var Zl=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(a,s,l,c){var u=!1,h=!1;l.length==0?h=!0:l.charAt(0)=="["&&(h=!0,l=l.slice(1,-1)),c.length==0?u=!0:c.charAt(0)=="["&&(u=!0,c=c.slice(1,-1));var d=l.length>0?parseInt(l,10)|0:0,g=c.length>0?parseInt(c,10)|0:0;return u?g+=t.c:--g,h?d+=t.r:--d,s+(u?"":"$")+hr(g)+(h?"":"$")+kr(d)}return function(s,l){return t=l,s.replace(e,r)}})(),$m=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Vm=(function(){return function(t,r){return t.replace($m,function(a,s,l,c,u,h){var d=Om(c)-(l?0:r.c),g=Nm(h)-(u?0:r.r),x=g==0?"":u?g+1:"["+g+"]",v=d==0?"":l?d+1:"["+d+"]";return s+"R"+x+"C"+v})}})();function M2(e,t){return e.replace($m,function(r,a,s,l,c,u){return a+(s=="$"?s+l:hr(Om(l)+t.c))+(c=="$"?c+u:kr(Nm(u)+t.r))})}function C8(e,t,r){var a=Fa(t),s=a.s,l=dr(r),c={r:l.r-s.r,c:l.c-s.c};return M2(e,c)}function N8(e){return e.length!=1}function py(e){return e.replace(/_xlfn\./g,"")}function Fr(e){e.l+=1}function ai(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function L2(e,t,r){var a=2;if(r){if(r.biff>=2&&r.biff<=5)return I2(e);r.biff==12&&(a=4)}var s=e.read_shift(a),l=e.read_shift(a),c=ai(e),u=ai(e);return{s:{r:s,c:c[0],cRel:c[1],rRel:c[2]},e:{r:l,c:u[0],cRel:u[1],rRel:u[2]}}}function I2(e){var t=ai(e),r=ai(e),a=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:a,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function O8(e,t,r){if(r.biff<8)return I2(e);var a=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),l=ai(e),c=ai(e);return{s:{r:a,c:l[0],cRel:l[1],rRel:l[2]},e:{r:s,c:c[0],cRel:c[1],rRel:c[2]}}}function B2(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return R8(e);var a=e.read_shift(r&&r.biff==12?4:2),s=ai(e);return{r:a,c:s[0],cRel:s[1],rRel:s[2]}}function R8(e){var t=ai(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function D8(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function F8(e,t,r){var a=r&&r.biff?r.biff:8;if(a>=2&&a<=5)return M8(e);var s=e.read_shift(a>=12?4:2),l=e.read_shift(2),c=(l&16384)>>14,u=(l&32768)>>15;if(l&=16383,u==1)for(;s>524287;)s-=1048576;if(c==1)for(;l>8191;)l=l-16384;return{r:s,c:l,cRel:c,rRel:u}}function M8(e){var t=e.read_shift(2),r=e.read_shift(1),a=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,a==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:a}}function L8(e,t,r){var a=(e[e.l++]&96)>>5,s=L2(e,r.biff>=2&&r.biff<=5?6:8,r);return[a,s]}function I8(e,t,r){var a=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),l=8;if(r)switch(r.biff){case 5:e.l+=12,l=6;break;case 12:l=12;break}var c=L2(e,l,r);return[a,s,c]}function B8(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[a]}function j8(e,t,r){var a=(e[e.l++]&96)>>5,s=e.read_shift(2),l=8;if(r)switch(r.biff){case 5:e.l+=12,l=6;break;case 12:l=12;break}return e.l+=l,[a,s]}function U8(e,t,r){var a=(e[e.l++]&96)>>5,s=O8(e,t-1,r);return[a,s]}function P8(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[a]}function xy(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function z8(e,t,r){e.l+=2;for(var a=e.read_shift(r&&r.biff==2?1:2),s=[],l=0;l<=a;++l)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function H8(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function $8(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function V8(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function G8(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[a]}function j2(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function q8(e){return e.read_shift(2),j2(e)}function X8(e){return e.read_shift(2),j2(e)}function W8(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=B2(e,0,r);return[a,s]}function K8(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=F8(e,0,r);return[a,s]}function Y8(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var l=B2(e,0,r);return[a,s,l]}function J8(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[e5[s],z2[s],a]}function Q8(e,t,r){var a=e[e.l++],s=e.read_shift(1),l=r&&r.biff<=3?[a==88?-1:0,e.read_shift(1)]:Z8(e);return[s,(l[0]===0?z2:ZO)[l[1]]]}function Z8(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function eO(e,t,r){e.l+=r&&r.biff==2?3:4}function tO(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var a=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[a,s]}function rO(e){return e.l++,xs[e.read_shift(1)]}function aO(e){return e.l++,e.read_shift(2)}function nO(e){return e.l++,e.read_shift(1)!==0}function sO(e){return e.l++,ha(e)}function iO(e,t,r){return e.l++,qc(e,t-1,r)}function lO(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Tr(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=xs[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=ha(e);break;case 2:r[1]=Qi(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function oO(e,t,r){for(var a=e.read_shift(r.biff==12?4:2),s=[],l=0;l!=a;++l)s.push((r.biff==12?Ji:Zu)(e));return s}function cO(e,t,r){var a=0,s=0;r.biff==12?(a=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),a=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--a,--s==0&&(s=256));for(var l=0,c=[];l!=a&&(c[l]=[]);++l)for(var u=0;u!=s;++u)c[l][u]=lO(e,r.biff);return c}function uO(e,t,r){var a=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,l=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[a,0,l]}function fO(e,t,r){if(r.biff==5)return hO(e);var a=e.read_shift(1)>>>5&3,s=e.read_shift(2),l=e.read_shift(4);return[a,s,l]}function hO(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var a=e.read_shift(2);return e.l+=12,[t,r,a]}function dO(e,t,r){var a=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[a,s]}function mO(e,t,r){var a=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[a,s]}function gO(e,t,r){var a=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[a]}function pO(e,t,r){var a=(e[e.l++]&96)>>5,s=e.read_shift(2),l=4;if(r)switch(r.biff){case 5:l=15;break;case 12:l=6;break}return e.l+=l,[a,s]}var xO=ma,vO=ma,yO=ma;function Wc(e,t,r){return e.l+=2,[D8(e)]}function Gm(e){return e.l+=6,[]}var _O=Wc,wO=Gm,bO=Gm,SO=Wc;function U2(e){return e.l+=2,[Lr(e),e.read_shift(2)&1]}var EO=Wc,TO=U2,kO=Gm,AO=Wc,CO=Wc,NO=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function OO(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),s=e.read_shift(2),l=e.read_shift(2),c=NO[r>>2&31];return{ixti:t,coltype:r&3,rt:c,idx:a,c:s,C:l}}function RO(e){return e.l+=2,[e.read_shift(4)]}function DO(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function FO(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function MO(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function LO(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function IO(e){return e.l+=4,[0,0]}var vy={1:{n:"PtgExp",f:tO},2:{n:"PtgTbl",f:yO},3:{n:"PtgAdd",f:Fr},4:{n:"PtgSub",f:Fr},5:{n:"PtgMul",f:Fr},6:{n:"PtgDiv",f:Fr},7:{n:"PtgPower",f:Fr},8:{n:"PtgConcat",f:Fr},9:{n:"PtgLt",f:Fr},10:{n:"PtgLe",f:Fr},11:{n:"PtgEq",f:Fr},12:{n:"PtgGe",f:Fr},13:{n:"PtgGt",f:Fr},14:{n:"PtgNe",f:Fr},15:{n:"PtgIsect",f:Fr},16:{n:"PtgUnion",f:Fr},17:{n:"PtgRange",f:Fr},18:{n:"PtgUplus",f:Fr},19:{n:"PtgUminus",f:Fr},20:{n:"PtgPercent",f:Fr},21:{n:"PtgParen",f:Fr},22:{n:"PtgMissArg",f:Fr},23:{n:"PtgStr",f:iO},26:{n:"PtgSheet",f:DO},27:{n:"PtgEndSheet",f:FO},28:{n:"PtgErr",f:rO},29:{n:"PtgBool",f:nO},30:{n:"PtgInt",f:aO},31:{n:"PtgNum",f:sO},32:{n:"PtgArray",f:P8},33:{n:"PtgFunc",f:J8},34:{n:"PtgFuncVar",f:Q8},35:{n:"PtgName",f:uO},36:{n:"PtgRef",f:W8},37:{n:"PtgArea",f:L8},38:{n:"PtgMemArea",f:dO},39:{n:"PtgMemErr",f:xO},40:{n:"PtgMemNoMem",f:vO},41:{n:"PtgMemFunc",f:mO},42:{n:"PtgRefErr",f:gO},43:{n:"PtgAreaErr",f:B8},44:{n:"PtgRefN",f:K8},45:{n:"PtgAreaN",f:U8},46:{n:"PtgMemAreaN",f:MO},47:{n:"PtgMemNoMemN",f:LO},57:{n:"PtgNameX",f:fO},58:{n:"PtgRef3d",f:Y8},59:{n:"PtgArea3d",f:I8},60:{n:"PtgRefErr3d",f:pO},61:{n:"PtgAreaErr3d",f:j8},255:{}},BO={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},jO={1:{n:"PtgElfLel",f:U2},2:{n:"PtgElfRw",f:AO},3:{n:"PtgElfCol",f:_O},6:{n:"PtgElfRwV",f:CO},7:{n:"PtgElfColV",f:SO},10:{n:"PtgElfRadical",f:EO},11:{n:"PtgElfRadicalS",f:kO},13:{n:"PtgElfColS",f:wO},15:{n:"PtgElfColSV",f:bO},16:{n:"PtgElfRadicalLel",f:TO},25:{n:"PtgList",f:OO},29:{n:"PtgSxName",f:RO},255:{}},UO={0:{n:"PtgAttrNoop",f:IO},1:{n:"PtgAttrSemi",f:G8},2:{n:"PtgAttrIf",f:$8},4:{n:"PtgAttrChoose",f:z8},8:{n:"PtgAttrGoto",f:H8},16:{n:"PtgAttrSum",f:eO},32:{n:"PtgAttrBaxcel",f:xy},33:{n:"PtgAttrBaxcel",f:xy},64:{n:"PtgAttrSpace",f:q8},65:{n:"PtgAttrSpaceSemi",f:X8},128:{n:"PtgAttrIfError",f:V8},255:{}};function Kc(e,t,r,a){if(a.biff<8)return ma(e,t);for(var s=e.l+t,l=[],c=0;c!==r.length;++c)switch(r[c][0]){case"PtgArray":r[c][1]=cO(e,0,a),l.push(r[c][1]);break;case"PtgMemArea":r[c][2]=oO(e,r[c][1],a),l.push(r[c][2]);break;case"PtgExp":a&&a.biff==12&&(r[c][1][1]=e.read_shift(4),l.push(r[c][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[c][0]}return t=s-e.l,t!==0&&l.push(ma(e,t)),l}function Yc(e,t,r){for(var a=e.l+t,s,l,c=[];a!=e.l;)t=a-e.l,l=e[e.l],s=vy[l]||vy[BO[l]],(l===24||l===25)&&(s=(l===24?jO:UO)[e[e.l+1]]),!s||!s.f?ma(e,t):c.push([s.n,s.f(e,t,r)]);return c}function PO(e){for(var t=[],r=0;r<e.length;++r){for(var a=e[r],s=[],l=0;l<a.length;++l){var c=a[l];c?c[0]===2?s.push('"'+c[1].replace(/"/g,'""')+'"'):s.push(c[1]):s.push("")}t.push(s.join(","))}return t.join(";")}var zO={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function HO(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function P2(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var a=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!a)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[a[0]][0]){case 357:return s=a[1]==-1?"#REF":e.SheetNames[a[1]],a[1]==a[2]?s:s+":"+e.SheetNames[a[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[a[0]][0];default:return"SH33TJSSRC"+e[a[0]][0]}switch(e[a[0]][0][0]){case 1025:return s=a[1]==-1?"#REF":e.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?s:s+":"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map(function(l){return l.Name}).join(";;");default:return e[a[0]][0][3]?(s=a[1]==-1?"#REF":e[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?s:s+":"+e[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function yy(e,t,r){var a=P2(e,t,r);return a=="#REF"?a:HO(a,r)}function ua(e,t,r,a,s){var l=s&&s.biff||8,c={s:{c:0,r:0}},u=[],h,d,g,x=0,v=0,_,b="";if(!e[0]||!e[0][0])return"";for(var y=-1,S="",k=0,O=e[0].length;k<O;++k){var T=e[0][k];switch(T[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(h=u.pop(),d=u.pop(),y>=0){switch(e[0][y][1][0]){case 0:S=yr(" ",e[0][y][1][1]);break;case 1:S=yr("\r",e[0][y][1][1]);break;default:if(S="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][y][1][0])}d=d+S,y=-1}u.push(d+zO[T[0]]+h);break;case"PtgIsect":h=u.pop(),d=u.pop(),u.push(d+" "+h);break;case"PtgUnion":h=u.pop(),d=u.pop(),u.push(d+","+h);break;case"PtgRange":h=u.pop(),d=u.pop(),u.push(d+":"+h);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":g=mc(T[1][1],c,s),u.push(gc(g,l));break;case"PtgRefN":g=r?mc(T[1][1],r,s):T[1][1],u.push(gc(g,l));break;case"PtgRef3d":x=T[1][1],g=mc(T[1][2],c,s),b=yy(a,x,s),u.push(b+"!"+gc(g,l));break;case"PtgFunc":case"PtgFuncVar":var j=T[1][0],X=T[1][1];j||(j=0),j&=127;var I=j==0?[]:u.slice(-j);u.length-=j,X==="User"&&(X=I.shift()),u.push(X+"("+I.join(",")+")");break;case"PtgBool":u.push(T[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(T[1]);break;case"PtgNum":u.push(String(T[1]));break;case"PtgStr":u.push('"'+T[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(T[1]);break;case"PtgAreaN":_=Wv(T[1][1],r?{s:r}:c,s),u.push(Td(_,s));break;case"PtgArea":_=Wv(T[1][1],c,s),u.push(Td(_,s));break;case"PtgArea3d":x=T[1][1],_=T[1][2],b=yy(a,x,s),u.push(b+"!"+Td(_,s));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":v=T[1][2];var C=(a.names||[])[v-1]||(a[0]||[])[v],K=C?C.Name:"SH33TJSNAME"+String(v);K&&K.slice(0,6)=="_xlfn."&&!s.xlfn&&(K=K.slice(6)),u.push(K);break;case"PtgNameX":var q=T[1][1];v=T[1][2];var oe;if(s.biff<=5)q<0&&(q=-q),a[q]&&(oe=a[q][v]);else{var ee="";if(((a[q]||[])[0]||[])[0]==14849||(((a[q]||[])[0]||[])[0]==1025?a[q][v]&&a[q][v].itab>0&&(ee=a.SheetNames[a[q][v].itab-1]+"!"):ee=a.SheetNames[v-1]+"!"),a[q]&&a[q][v])ee+=a[q][v].Name;else if(a[0]&&a[0][v])ee+=a[0][v].Name;else{var Z=(P2(a,q,s)||"").split(";;");Z[v-1]?ee=Z[v-1]:ee+="SH33TJSERRX"}u.push(ee);break}oe||(oe={Name:"SH33TJSERRY"}),u.push(oe.Name);break;case"PtgParen":var xe="(",Ce=")";if(y>=0){switch(S="",e[0][y][1][0]){case 2:xe=yr(" ",e[0][y][1][1])+xe;break;case 3:xe=yr("\r",e[0][y][1][1])+xe;break;case 4:Ce=yr(" ",e[0][y][1][1])+Ce;break;case 5:Ce=yr("\r",e[0][y][1][1])+Ce;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][y][1][0])}y=-1}u.push(xe+u.pop()+Ce);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":g={c:T[1][1],r:T[1][0]};var Se={c:r.c,r:r.r};if(a.sharedf[ft(g)]){var G=a.sharedf[ft(g)];u.push(ua(G,c,Se,a,s))}else{var ne=!1;for(h=0;h!=a.arrayf.length;++h)if(d=a.arrayf[h],!(g.c<d[0].s.c||g.c>d[0].e.c)&&!(g.r<d[0].s.r||g.r>d[0].e.r)){u.push(ua(d[1],c,Se,a,s)),ne=!0;break}ne||u.push(T[1])}break;case"PtgArray":u.push("{"+PO(T[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":y=k;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+T[1].idx+"[#"+T[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(T));default:throw new Error("Unrecognized Formula Token: "+String(T))}var pe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&y>=0&&pe.indexOf(e[0][k][0])==-1){T=e[0][y];var J=!0;switch(T[1][0]){case 4:J=!1;case 0:S=yr(" ",T[1][1]);break;case 5:J=!1;case 1:S=yr("\r",T[1][1]);break;default:if(S="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+T[1][0])}u.push((J?S:"")+u.pop()+(J?"":S)),y=-1}}if(u.length>1&&s.WTF)throw new Error("bad formula stack");return u[0]}function $O(e,t,r){var a=e.l+t,s=r.biff==2?1:2,l,c=e.read_shift(s);if(c==65535)return[[],ma(e,t-2)];var u=Yc(e,c,r);return t!==c+s&&(l=Kc(e,t-c-s,u,r)),e.l=a,[u,l]}function VO(e,t,r){var a=e.l+t,s=r.biff==2?1:2,l,c=e.read_shift(s);if(c==65535)return[[],ma(e,t-2)];var u=Yc(e,c,r);return t!==c+s&&(l=Kc(e,t-c-s,u,r)),e.l=a,[u,l]}function GO(e,t,r,a){var s=e.l+t,l=Yc(e,a,r),c;return s!==e.l&&(c=Kc(e,s-e.l,l,r)),[l,c]}function qO(e,t,r){var a=e.l+t,s,l=e.read_shift(2),c=Yc(e,l,r);return l==65535?[[],ma(e,t-2)]:(t!==l+2&&(s=Kc(e,a-l-2,c,r)),[c,s])}function XO(e){var t;if(cs(e,e.l+6)!==65535)return[ha(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function WO(e){if(e==null){var t=ve(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Hi(e);return Hi(0)}function Od(e,t,r){var a=e.l+t,s=zn(e);r.biff==2&&++e.l;var l=XO(e),c=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var u=VO(e,a-e.l,r);return{cell:s,val:l[0],formula:u,shared:c>>3&1,tt:l[1]}}function KO(e,t,r,a,s){var l=Vi(t,r,s),c=WO(e.v),u=ve(6),h=33;u.write_shift(2,h),u.write_shift(4,0);for(var d=ve(e.bf.length),g=0;g<e.bf.length;++g)d[g]=e.bf[g];var x=Gr([l,c,u,d]);return x}function ef(e,t,r){var a=e.read_shift(4),s=Yc(e,a,r),l=e.read_shift(4),c=l>0?Kc(e,l,s,r):null;return[s,c]}var YO=ef,tf=ef,JO=ef,QO=ef,ZO={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},z2={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},e5={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function _y(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function t5(e){var t="of:="+e.replace($m,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Rd(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function r5(e){return e.replace(/\./,"!")}var xc={},eo={},vc=typeof Map<"u";function qm(e,t,r){var a=0,s=e.length;if(r){if(vc?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var l=vc?r.get(t):r[t];a<l.length;++a)if(e[l[a]].t===t)return e.Count++,l[a]}}else for(;a<s;++a)if(e[a].t===t)return e.Count++,a;return e[s]={t},e.Count++,e.Unique++,r&&(vc?(r.has(t)||r.set(t,[]),r.get(t).push(s)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(s))),s}function rf(e,t){var r={min:e+1,max:e+1},a=-1;return t.MDW&&(fa=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?a=Ic(t.wpx):t.wch!=null&&(a=t.wch),a>-1?(r.width=Hu(a),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Ui(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function oi(e,t,r){var a=r.revssf[t.z!=null?t.z:"General"],s=60,l=e.length;if(a==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){fs(t.z,s),r.ssf[s]=t.z,r.revssf[t.z]=a=s;break}}for(s=0;s!=l;++s)if(e[s].numFmtId===a)return s;return e[l]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},l}function H2(e,t,r,a,s,l){try{a.cellNF&&(e.z=ct[t])}catch(u){if(a.WTF)throw u}if(!(e.t==="z"&&!a.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=ir(e.v)),(!a||a.cellText!==!1)&&e.t!=="z")try{if(ct[t]==null&&fs(Zk[t]||"General",t),e.t==="e")e.w=e.w||xs[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Nc(e.v);else if(e.t==="d"){var c=Pr(e.v);(c|0)===c?e.w=c.toString(10):e.w=Nc(c)}else{if(e.v===void 0)return"";e.w=Pi(e.v,eo)}else e.t==="d"?e.w=mn(t,Pr(e.v),eo):e.w=mn(t,e.v,eo)}catch(u){if(a.WTF)throw u}if(a.cellStyles&&r!=null)try{e.s=l.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=zu(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),a.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=zu(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),a.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(u){if(a.WTF&&l.Fills)throw u}}}function a5(e,t,r){if(e&&e["!ref"]){var a=Ft(e["!ref"]);if(a.e.c<a.s.c||a.e.r<a.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function n5(e,t){var r=Ft(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=vt(r))}var s5=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,i5=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,l5=/<(?:\w:)?hyperlink [^>]*>/mg,o5=/"(\w*:\w*)"/,c5=/<(?:\w:)?col\b[^>]*[\/]?>/g,u5=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,f5=/<(?:\w:)?pageMargins[^>]*\/>/g,$2=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,h5=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,d5=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function m5(e,t,r,a,s,l,c){if(!e)return e;a||(a={"!id":{}});var u=t.dense?[]:{},h={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",g="",x=e.match(i5);x?(d=e.slice(0,x.index),g=e.slice(x.index+x[0].length)):d=g=e;var v=d.match($2);v?Xm(v[0],u,s,r):(v=d.match(h5))&&p5(v[0],v[1]||"",u,s,r);var _=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(_>0){var b=d.slice(_,_+50).match(o5);b&&n5(u,b[1])}var y=d.match(d5);y&&y[1]&&N5(y[1],s);var S=[];if(t.cellStyles){var k=d.match(c5);k&&E5(S,k)}x&&D5(x[1],u,t,h,l,c);var O=g.match(u5);O&&(u["!autofilter"]=k5(O[0]));var T=[],j=g.match(s5);if(j)for(_=0;_!=j.length;++_)T[_]=Ft(j[_].slice(j[_].indexOf('"')+1));var X=g.match(l5);X&&w5(u,X,a);var I=g.match(f5);if(I&&(u["!margins"]=b5(ht(I[0]))),!u["!ref"]&&h.e.c>=h.s.c&&h.e.r>=h.s.r&&(u["!ref"]=vt(h)),t.sheetRows>0&&u["!ref"]){var C=Ft(u["!ref"]);t.sheetRows<=+C.e.r&&(C.e.r=t.sheetRows-1,C.e.r>h.e.r&&(C.e.r=h.e.r),C.e.r<C.s.r&&(C.s.r=C.e.r),C.e.c>h.e.c&&(C.e.c=h.e.c),C.e.c<C.s.c&&(C.s.c=C.e.c),u["!fullref"]=u["!ref"],u["!ref"]=vt(C))}return S.length>0&&(u["!cols"]=S),T.length>0&&(u["!merges"]=T),u}function g5(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+vt(e[r])+'"/>';return t+"</mergeCells>"}function Xm(e,t,r,a){var s=ht(e);r.Sheets[a]||(r.Sheets[a]={}),s.codeName&&(r.Sheets[a].CodeName=Dt(Jt(s.codeName)))}function p5(e,t,r,a,s){Xm(e.slice(0,e.indexOf(">")),r,a,s)}function x5(e,t,r,a,s){var l=!1,c={},u=null;if(a.bookType!=="xlsx"&&t.vbaraw){var h=t.SheetNames[r];try{t.Workbook&&(h=t.Workbook.Sheets[r].CodeName||h)}catch{}l=!0,c.codeName=Un($t(h))}if(e&&e["!outline"]){var d={summaryBelow:1,summaryRight:1};e["!outline"].above&&(d.summaryBelow=0),e["!outline"].left&&(d.summaryRight=0),u=(u||"")+Me("outlinePr",null,d)}!l&&!u||(s[s.length]=Me("sheetPr",u,c))}var v5=["objects","scenarios","selectLockedCells","selectUnlockedCells"],y5=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function _5(e){var t={sheet:1};return v5.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),y5.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=Pm(e.password).toString(16).toUpperCase()),Me("sheetProtection",null,t)}function w5(e,t,r){for(var a=Array.isArray(e),s=0;s!=t.length;++s){var l=ht(Jt(t[s]),!0);if(!l.ref)return;var c=((r||{})["!id"]||[])[l.id];c?(l.Target=c.Target,l.location&&(l.Target+="#"+Dt(l.location))):(l.Target="#"+Dt(l.location),c={Target:l.Target,TargetMode:"Internal"}),l.Rel=c,l.tooltip&&(l.Tooltip=l.tooltip,delete l.tooltip);for(var u=Ft(l.ref),h=u.s.r;h<=u.e.r;++h)for(var d=u.s.c;d<=u.e.c;++d){var g=ft({c:d,r:h});a?(e[h]||(e[h]=[]),e[h][d]||(e[h][d]={t:"z",v:void 0}),e[h][d].l=l):(e[g]||(e[g]={t:"z",v:void 0}),e[g].l=l)}}}function b5(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function S5(e){return Ui(e),Me("pageMargins",null,e)}function E5(e,t){for(var r=!1,a=0;a!=t.length;++a){var s=ht(t[a],!0);s.hidden&&(s.hidden=sr(s.hidden));var l=parseInt(s.min,10)-1,c=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,zm(s.width)),ri(s);l<=c;)e[l++]=lr(s)}}function T5(e,t){for(var r=["<cols>"],a,s=0;s!=t.length;++s)(a=t[s])&&(r[r.length]=Me("col",null,rf(s,a)));return r[r.length]="</cols>",r.join("")}function k5(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function A5(e,t,r,a){var s=typeof e.ref=="string"?e.ref:vt(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var l=r.Workbook.Names,c=Fa(s);c.s.r==c.e.r&&(c.e.r=Fa(t["!ref"]).e.r,s=vt(c));for(var u=0;u<l.length;++u){var h=l[u];if(h.Name=="_xlnm._FilterDatabase"&&h.Sheet==a){h.Ref="'"+r.SheetNames[a]+"'!"+s;break}}return u==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+s}),Me("autoFilter",null,{ref:s})}var C5=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function N5(e,t){t.Views||(t.Views=[{}]),(e.match(C5)||[]).forEach(function(r,a){var s=ht(r);t.Views[a]||(t.Views[a]={}),+s.zoomScale&&(t.Views[a].zoom=+s.zoomScale),sr(s.rightToLeft)&&(t.Views[a].RTL=!0)})}function O5(e,t,r,a){var s={workbookViewId:"0"};return(((a||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=a.Workbook.Views[0].RTL?"1":"0"),Me("sheetViews",Me("sheetView",null,s),{})}function R5(e,t,r,a){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",l=e.t,c=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=xs[e.v];break;case"d":a&&a.cellDates?s=ir(e.v,-1).toISOString():(e=lr(e),e.t="n",s=""+(e.v=Pr(ir(e.v)))),typeof e.z>"u"&&(e.z=ct[14]);break;default:s=e.v;break}var u=aa("v",$t(s)),h={r:t},d=oi(a.cellXfs,e,a);switch(d!==0&&(h.s=d),e.t){case"n":break;case"d":h.t="d";break;case"b":h.t="b";break;case"e":h.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(a&&a.bookSST){u=aa("v",""+qm(a.Strings,e.v,a.revStrings)),h.t="s";break}h.t="str";break}if(e.t!=l&&(e.t=l,e.v=c),typeof e.f=="string"&&e.f){var g=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;u=Me("f",$t(e.f),g)+(e.v!=null?u:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(h.cm=1),Me("c",u,h)}var D5=(function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,l=Oc("v"),c=Oc("f");return function(h,d,g,x,v,_){for(var b=0,y="",S=[],k=[],O=0,T=0,j=0,X="",I,C,K=0,q=0,oe,ee,Z=0,xe=0,Ce=Array.isArray(_.CellXf),Se,G=[],ne=[],pe=Array.isArray(d),J=[],be={},L=!1,N=!!g.sheetStubs,V=h.split(t),M=0,z=V.length;M!=z;++M){y=V[M].trim();var te=y.length;if(te!==0){var ge=0;e:for(b=0;b<te;++b)switch(y[b]){case">":if(y[b-1]!="/"){++b;break e}if(g&&g.cellStyles){if(C=ht(y.slice(ge,b),!0),K=C.r!=null?parseInt(C.r,10):K+1,q=-1,g.sheetRows&&g.sheetRows<K)continue;be={},L=!1,C.ht&&(L=!0,be.hpt=parseFloat(C.ht),be.hpx=so(be.hpt)),C.hidden=="1"&&(L=!0,be.hidden=!0),C.outlineLevel!=null&&(L=!0,be.level=+C.outlineLevel),L&&(J[K-1]=be)}break;case"<":ge=b;break}if(ge>=b)break;if(C=ht(y.slice(ge,b),!0),K=C.r!=null?parseInt(C.r,10):K+1,q=-1,!(g.sheetRows&&g.sheetRows<K)){x.s.r>K-1&&(x.s.r=K-1),x.e.r<K-1&&(x.e.r=K-1),g&&g.cellStyles&&(be={},L=!1,C.ht&&(L=!0,be.hpt=parseFloat(C.ht),be.hpx=so(be.hpt)),C.hidden=="1"&&(L=!0,be.hidden=!0),C.outlineLevel!=null&&(L=!0,be.level=+C.outlineLevel),L&&(J[K-1]=be)),S=y.slice(b).split(e);for(var Ee=0;Ee!=S.length&&S[Ee].trim().charAt(0)=="<";++Ee);for(S=S.slice(Ee),b=0;b!=S.length;++b)if(y=S[b].trim(),y.length!==0){if(k=y.match(r),O=b,T=0,j=0,y="<c "+(y.slice(0,1)=="<"?">":"")+y,k!=null&&k.length===2){for(O=0,X=k[1],T=0;T!=X.length&&!((j=X.charCodeAt(T)-64)<1||j>26);++T)O=26*O+j;--O,q=O}else++q;for(T=0;T!=y.length&&y.charCodeAt(T)!==62;++T);if(++T,C=ht(y.slice(0,T),!0),C.r||(C.r=ft({r:K-1,c:q})),X=y.slice(T),I={t:""},(k=X.match(l))!=null&&k[1]!==""&&(I.v=Dt(k[1])),g.cellFormula){if((k=X.match(c))!=null&&k[1]!==""){if(I.f=Dt(Jt(k[1])).replace(/\r\n/g,`
`),g.xlfn||(I.f=py(I.f)),k[0].indexOf('t="array"')>-1)I.F=(X.match(s)||[])[1],I.F.indexOf(":")>-1&&G.push([Ft(I.F),I.F]);else if(k[0].indexOf('t="shared"')>-1){ee=ht(k[0]);var ye=Dt(Jt(k[1]));g.xlfn||(ye=py(ye)),ne[parseInt(ee.si,10)]=[ee,ye,C.r]}}else(k=X.match(/<f[^>]*\/>/))&&(ee=ht(k[0]),ne[ee.si]&&(I.f=C8(ne[ee.si][1],ne[ee.si][2],C.r)));var Ae=dr(C.r);for(T=0;T<G.length;++T)Ae.r>=G[T][0].s.r&&Ae.r<=G[T][0].e.r&&Ae.c>=G[T][0].s.c&&Ae.c<=G[T][0].e.c&&(I.F=G[T][1])}if(C.t==null&&I.v===void 0)if(I.f||I.F)I.v=0,I.t="n";else if(N)I.t="z";else continue;else I.t=C.t||"n";switch(x.s.c>q&&(x.s.c=q),x.e.c<q&&(x.e.c=q),I.t){case"n":if(I.v==""||I.v==null){if(!N)continue;I.t="z"}else I.v=parseFloat(I.v);break;case"s":if(typeof I.v>"u"){if(!N)continue;I.t="z"}else oe=xc[parseInt(I.v,10)],I.v=oe.t,I.r=oe.r,g.cellHTML&&(I.h=oe.h);break;case"str":I.t="s",I.v=I.v!=null?Jt(I.v):"",g.cellHTML&&(I.h=Tm(I.v));break;case"inlineStr":k=X.match(a),I.t="s",k!=null&&(oe=Um(k[1]))?(I.v=oe.t,g.cellHTML&&(I.h=oe.h)):I.v="";break;case"b":I.v=sr(I.v);break;case"d":g.cellDates?I.v=ir(I.v,1):(I.v=Pr(ir(I.v,1)),I.t="n");break;case"e":(!g||g.cellText!==!1)&&(I.w=I.v),I.v=G_[I.v];break}if(Z=xe=0,Se=null,Ce&&C.s!==void 0&&(Se=_.CellXf[C.s],Se!=null&&(Se.numFmtId!=null&&(Z=Se.numFmtId),g.cellStyles&&Se.fillId!=null&&(xe=Se.fillId))),H2(I,Z,xe,g,v,_),g.cellDates&&Ce&&I.t=="n"&&lo(ct[Z])&&(I.t="d",I.v=Qu(I.v)),C.cm&&g.xlmeta){var tt=(g.xlmeta.Cell||[])[+C.cm-1];tt&&tt.type=="XLDAPR"&&(I.D=!0)}if(pe){var P=dr(C.r);d[P.r]||(d[P.r]=[]),d[P.r][P.c]=I}else d[C.r]=I}}}}J.length>0&&(d["!rows"]=J)}})();function F5(e,t,r,a){var s=[],l=[],c=Ft(e["!ref"]),u="",h,d="",g=[],x=0,v=0,_=e["!rows"],b=Array.isArray(e),y={r:d},S,k=-1;for(v=c.s.c;v<=c.e.c;++v)g[v]=hr(v);for(x=c.s.r;x<=c.e.r;++x){for(l=[],d=kr(x),v=c.s.c;v<=c.e.c;++v){h=g[v]+d;var O=b?(e[x]||[])[v]:e[h];O!==void 0&&(u=R5(O,h,e,t))!=null&&l.push(u)}(l.length>0||_&&_[x])&&(y={r:d},_&&_[x]&&(S=_[x],S.hidden&&(y.hidden=1),k=-1,S.hpx?k=Bc(S.hpx):S.hpt&&(k=S.hpt),k>-1&&(y.ht=k,y.customHeight=1),S.level&&(y.outlineLevel=S.level)),s[s.length]=Me("row",l.join(""),y))}if(_)for(;x<_.length;++x)_&&_[x]&&(y={r:x+1},S=_[x],S.hidden&&(y.hidden=1),k=-1,S.hpx?k=Bc(S.hpx):S.hpt&&(k=S.hpt),k>-1&&(y.ht=k,y.customHeight=1),S.level&&(y.outlineLevel=S.level),s[s.length]=Me("row","",y));return s.join("")}function V2(e,t,r,a){var s=[Ar,Me("worksheet",null,{xmlns:Xi[0],"xmlns:r":Ur.r})],l=r.SheetNames[e],c=0,u="",h=r.Sheets[l];h==null&&(h={});var d=h["!ref"]||"A1",g=Ft(d);if(g.e.c>16383||g.e.r>1048575){if(t.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");g.e.c=Math.min(g.e.c,16383),g.e.r=Math.min(g.e.c,1048575),d=vt(g)}a||(a={}),h["!comments"]=[];var x=[];x5(h,r,e,t,s),s[s.length]=Me("dimension",null,{ref:d}),s[s.length]=O5(h,t,e,r),t.sheetFormat&&(s[s.length]=Me("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),h["!cols"]!=null&&h["!cols"].length>0&&(s[s.length]=T5(h,h["!cols"])),s[c=s.length]="<sheetData/>",h["!links"]=[],h["!ref"]!=null&&(u=F5(h,t),u.length>0&&(s[s.length]=u)),s.length>c+1&&(s[s.length]="</sheetData>",s[c]=s[c].replace("/>",">")),h["!protect"]&&(s[s.length]=_5(h["!protect"])),h["!autofilter"]!=null&&(s[s.length]=A5(h["!autofilter"],h,r,e)),h["!merges"]!=null&&h["!merges"].length>0&&(s[s.length]=g5(h["!merges"]));var v=-1,_,b=-1;return h["!links"].length>0&&(s[s.length]="<hyperlinks>",h["!links"].forEach(function(y){y[1].Target&&(_={ref:y[0]},y[1].Target.charAt(0)!="#"&&(b=Ht(a,-1,$t(y[1].Target).replace(/#.*$/,""),bt.HLINK),_["r:id"]="rId"+b),(v=y[1].Target.indexOf("#"))>-1&&(_.location=$t(y[1].Target.slice(v+1))),y[1].Tooltip&&(_.tooltip=$t(y[1].Tooltip)),s[s.length]=Me("hyperlink",null,_))}),s[s.length]="</hyperlinks>"),delete h["!links"],h["!margins"]!=null&&(s[s.length]=S5(h["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(s[s.length]=aa("ignoredErrors",Me("ignoredError",null,{numberStoredAsText:1,sqref:d}))),x.length>0&&(b=Ht(a,-1,"../drawings/drawing"+(e+1)+".xml",bt.DRAW),s[s.length]=Me("drawing",null,{"r:id":"rId"+b}),h["!drawing"]=x),h["!comments"].length>0&&(b=Ht(a,-1,"../drawings/vmlDrawing"+(e+1)+".vml",bt.VML),s[s.length]=Me("legacyDrawing",null,{"r:id":"rId"+b}),h["!legacy"]=b),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function M5(e,t){var r={},a=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var l=e.read_shift(1);return e.l=a,l&7&&(r.level=l&7),l&16&&(r.hidden=!0),l&32&&(r.hpt=s/20),r}function L5(e,t,r){var a=ve(145),s=(r["!rows"]||[])[e]||{};a.write_shift(4,e),a.write_shift(4,0);var l=320;s.hpx?l=Bc(s.hpx)*20:s.hpt&&(l=s.hpt*20),a.write_shift(2,l),a.write_shift(1,0);var c=0;s.level&&(c|=s.level),s.hidden&&(c|=16),(s.hpx||s.hpt)&&(c|=32),a.write_shift(1,c),a.write_shift(1,0);var u=0,h=a.l;a.l+=4;for(var d={r:e,c:0},g=0;g<16;++g)if(!(t.s.c>g+1<<10||t.e.c<g<<10)){for(var x=-1,v=-1,_=g<<10;_<g+1<<10;++_){d.c=_;var b=Array.isArray(r)?(r[d.r]||[])[d.c]:r[ft(d)];b&&(x<0&&(x=_),v=_)}x<0||(++u,a.write_shift(4,x),a.write_shift(4,v))}var y=a.l;return a.l=h,a.write_shift(4,u),a.l=y,a.length>a.l?a.slice(0,a.l):a}function I5(e,t,r,a){var s=L5(a,r,t);(s.length>17||(t["!rows"]||[])[a])&&Ne(e,0,s)}var B5=Ji,j5=uo;function U5(){}function P5(e,t){var r={},a=e[e.l];return++e.l,r.above=!(a&64),r.left=!(a&128),e.l+=18,r.name=$A(e),r}function z5(e,t,r){r==null&&(r=ve(84+4*e.length));var a=192;t&&(t.above&&(a&=-65),t.left&&(a&=-129)),r.write_shift(1,a);for(var s=1;s<3;++s)r.write_shift(1,0);return ju({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),P_(e,r),r.slice(0,r.l)}function H5(e){var t=gn(e);return[t]}function $5(e,t,r){return r==null&&(r=ve(8)),Wi(t,r)}function V5(e){var t=Ki(e);return[t]}function G5(e,t,r){return r==null&&(r=ve(4)),Yi(t,r)}function q5(e){var t=gn(e),r=e.read_shift(1);return[t,r,"b"]}function X5(e,t,r){return r==null&&(r=ve(9)),Wi(t,r),r.write_shift(1,e.v?1:0),r}function W5(e){var t=Ki(e),r=e.read_shift(1);return[t,r,"b"]}function K5(e,t,r){return r==null&&(r=ve(5)),Yi(t,r),r.write_shift(1,e.v?1:0),r}function Y5(e){var t=gn(e),r=e.read_shift(1);return[t,r,"e"]}function J5(e,t,r){return r==null&&(r=ve(9)),Wi(t,r),r.write_shift(1,e.v),r}function Q5(e){var t=Ki(e),r=e.read_shift(1);return[t,r,"e"]}function Z5(e,t,r){return r==null&&(r=ve(8)),Yi(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function eR(e){var t=gn(e),r=e.read_shift(4);return[t,r,"s"]}function tR(e,t,r){return r==null&&(r=ve(12)),Wi(t,r),r.write_shift(4,t.v),r}function rR(e){var t=Ki(e),r=e.read_shift(4);return[t,r,"s"]}function aR(e,t,r){return r==null&&(r=ve(8)),Yi(t,r),r.write_shift(4,t.v),r}function nR(e){var t=gn(e),r=ha(e);return[t,r,"n"]}function sR(e,t,r){return r==null&&(r=ve(16)),Wi(t,r),Hi(e.v,r),r}function G2(e){var t=Ki(e),r=ha(e);return[t,r,"n"]}function iR(e,t,r){return r==null&&(r=ve(12)),Yi(t,r),Hi(e.v,r),r}function lR(e){var t=gn(e),r=Mm(e);return[t,r,"n"]}function oR(e,t,r){return r==null&&(r=ve(12)),Wi(t,r),z_(e.v,r),r}function cR(e){var t=Ki(e),r=Mm(e);return[t,r,"n"]}function uR(e,t,r){return r==null&&(r=ve(8)),Yi(t,r),z_(e.v,r),r}function fR(e){var t=gn(e),r=Rm(e);return[t,r,"is"]}function hR(e){var t=gn(e),r=da(e);return[t,r,"str"]}function dR(e,t,r){return r==null&&(r=ve(12+4*e.v.length)),Wi(t,r),qr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function mR(e){var t=Ki(e),r=da(e);return[t,r,"str"]}function gR(e,t,r){return r==null&&(r=ve(8+4*e.v.length)),Yi(t,r),qr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function pR(e,t,r){var a=e.l+t,s=gn(e);s.r=r["!row"];var l=e.read_shift(1),c=[s,l,"b"];if(r.cellFormula){e.l+=2;var u=tf(e,a-e.l,r);c[3]=ua(u,null,s,r.supbooks,r)}else e.l=a;return c}function xR(e,t,r){var a=e.l+t,s=gn(e);s.r=r["!row"];var l=e.read_shift(1),c=[s,l,"e"];if(r.cellFormula){e.l+=2;var u=tf(e,a-e.l,r);c[3]=ua(u,null,s,r.supbooks,r)}else e.l=a;return c}function vR(e,t,r){var a=e.l+t,s=gn(e);s.r=r["!row"];var l=ha(e),c=[s,l,"n"];if(r.cellFormula){e.l+=2;var u=tf(e,a-e.l,r);c[3]=ua(u,null,s,r.supbooks,r)}else e.l=a;return c}function yR(e,t,r){var a=e.l+t,s=gn(e);s.r=r["!row"];var l=da(e),c=[s,l,"str"];if(r.cellFormula){e.l+=2;var u=tf(e,a-e.l,r);c[3]=ua(u,null,s,r.supbooks,r)}else e.l=a;return c}var _R=Ji,wR=uo;function bR(e,t){return t==null&&(t=ve(4)),t.write_shift(4,e),t}function SR(e,t){var r=e.l+t,a=Ji(e),s=Dm(e),l=da(e),c=da(e),u=da(e);e.l=r;var h={rfx:a,relId:s,loc:l,display:u};return c&&(h.Tooltip=c),h}function ER(e,t){var r=ve(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));uo({s:dr(e[0]),e:dr(e[0])},r),Fm("rId"+t,r);var a=e[1].Target.indexOf("#"),s=a==-1?"":e[1].Target.slice(a+1);return qr(s||"",r),qr(e[1].Tooltip||"",r),qr("",r),r.slice(0,r.l)}function TR(){}function kR(e,t,r){var a=e.l+t,s=H_(e),l=e.read_shift(1),c=[s];if(c[2]=l,r.cellFormula){var u=YO(e,a-e.l,r);c[1]=u}else e.l=a;return c}function AR(e,t,r){var a=e.l+t,s=Ji(e),l=[s];if(r.cellFormula){var c=QO(e,a-e.l,r);l[1]=c,e.l=a}else e.l=a;return l}function CR(e,t,r){r==null&&(r=ve(18));var a=rf(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(a.width||10)*256),r.write_shift(4,0);var s=0;return t.hidden&&(s|=1),typeof a.width=="number"&&(s|=2),t.level&&(s|=t.level<<8),r.write_shift(2,s),r}var q2=["left","right","top","bottom","header","footer"];function NR(e){var t={};return q2.forEach(function(r){t[r]=ha(e)}),t}function OR(e,t){return t==null&&(t=ve(48)),Ui(e),q2.forEach(function(r){Hi(e[r],t)}),t}function RR(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function DR(e,t,r){r==null&&(r=ve(30));var a=924;return(((t||{}).Views||[])[0]||{}).RTL&&(a|=32),r.write_shift(2,a),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function FR(e){var t=ve(24);return t.write_shift(4,4),t.write_shift(4,1),uo(e,t),t}function MR(e,t){return t==null&&(t=ve(66)),t.write_shift(2,e.password?Pm(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function LR(){}function IR(){}function BR(e,t,r,a,s,l,c){if(!e)return e;var u=t||{};a||(a={"!id":{}});var h=u.dense?[]:{},d,g={s:{r:2e6,c:2e6},e:{r:0,c:0}},x=!1,v=!1,_,b,y,S,k,O,T,j,X,I=[];u.biff=12,u["!row"]=0;var C=0,K=!1,q=[],oe={},ee=u.supbooks||s.supbooks||[[]];if(ee.sharedf=oe,ee.arrayf=q,ee.SheetNames=s.SheetNames||s.Sheets.map(function(pe){return pe.name}),!u.supbooks&&(u.supbooks=ee,s.Names))for(var Z=0;Z<s.Names.length;++Z)ee[0][Z+1]=s.Names[Z];var xe=[],Ce=[],Se=!1;jc[16]={n:"BrtShortReal",f:G2};var G;if(ps(e,function(J,be,L){if(!v)switch(L){case 148:d=J;break;case 0:_=J,u.sheetRows&&u.sheetRows<=_.r&&(v=!0),j=kr(S=_.r),u["!row"]=_.r,(J.hidden||J.hpt||J.level!=null)&&(J.hpt&&(J.hpx=so(J.hpt)),Ce[J.r]=J);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(b={t:J[2]},J[2]){case"n":b.v=J[1];break;case"s":T=xc[J[1]],b.v=T.t,b.r=T.r;break;case"b":b.v=!!J[1];break;case"e":b.v=J[1],u.cellText!==!1&&(b.w=xs[b.v]);break;case"str":b.t="s",b.v=J[1];break;case"is":b.t="s",b.v=J[1].t;break}if((y=c.CellXf[J[0].iStyleRef])&&H2(b,y.numFmtId,null,u,l,c),k=J[0].c==-1?k+1:J[0].c,u.dense?(h[S]||(h[S]=[]),h[S][k]=b):h[hr(k)+j]=b,u.cellFormula){for(K=!1,C=0;C<q.length;++C){var N=q[C];_.r>=N[0].s.r&&_.r<=N[0].e.r&&k>=N[0].s.c&&k<=N[0].e.c&&(b.F=vt(N[0]),K=!0)}!K&&J.length>3&&(b.f=J[3])}if(g.s.r>_.r&&(g.s.r=_.r),g.s.c>k&&(g.s.c=k),g.e.r<_.r&&(g.e.r=_.r),g.e.c<k&&(g.e.c=k),u.cellDates&&y&&b.t=="n"&&lo(ct[y.numFmtId])){var V=Li(b.v);V&&(b.t="d",b.v=new Date(V.y,V.m-1,V.d,V.H,V.M,V.S,V.u))}G&&(G.type=="XLDAPR"&&(b.D=!0),G=void 0);break;case 1:case 12:if(!u.sheetStubs||x)break;b={t:"z",v:void 0},k=J[0].c==-1?k+1:J[0].c,u.dense?(h[S]||(h[S]=[]),h[S][k]=b):h[hr(k)+j]=b,g.s.r>_.r&&(g.s.r=_.r),g.s.c>k&&(g.s.c=k),g.e.r<_.r&&(g.e.r=_.r),g.e.c<k&&(g.e.c=k),G&&(G.type=="XLDAPR"&&(b.D=!0),G=void 0);break;case 176:I.push(J);break;case 49:G=((u.xlmeta||{}).Cell||[])[J-1];break;case 494:var M=a["!id"][J.relId];for(M?(J.Target=M.Target,J.loc&&(J.Target+="#"+J.loc),J.Rel=M):J.relId==""&&(J.Target="#"+J.loc),S=J.rfx.s.r;S<=J.rfx.e.r;++S)for(k=J.rfx.s.c;k<=J.rfx.e.c;++k)u.dense?(h[S]||(h[S]=[]),h[S][k]||(h[S][k]={t:"z",v:void 0}),h[S][k].l=J):(O=ft({c:k,r:S}),h[O]||(h[O]={t:"z",v:void 0}),h[O].l=J);break;case 426:if(!u.cellFormula)break;q.push(J),X=u.dense?h[S][k]:h[hr(k)+j],X.f=ua(J[1],g,{r:_.r,c:k},ee,u),X.F=vt(J[0]);break;case 427:if(!u.cellFormula)break;oe[ft(J[0].s)]=J[1],X=u.dense?h[S][k]:h[hr(k)+j],X.f=ua(J[1],g,{r:_.r,c:k},ee,u);break;case 60:if(!u.cellStyles)break;for(;J.e>=J.s;)xe[J.e--]={width:J.w/256,hidden:!!(J.flags&1),level:J.level},Se||(Se=!0,zm(J.w/256)),ri(xe[J.e+1]);break;case 161:h["!autofilter"]={ref:vt(J)};break;case 476:h["!margins"]=J;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),J.name&&(s.Sheets[r].CodeName=J.name),(J.above||J.left)&&(h["!outline"]={above:J.above,left:J.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),J.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:x=!0;break;case 36:x=!1;break;case 37:x=!0;break;case 38:x=!1;break;default:if(!be.T){if(!x||u.WTF)throw new Error("Unexpected record 0x"+L.toString(16))}}},u),delete u.supbooks,delete u["!row"],!h["!ref"]&&(g.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(h["!ref"]=vt(d||g)),u.sheetRows&&h["!ref"]){var ne=Ft(h["!ref"]);u.sheetRows<=+ne.e.r&&(ne.e.r=u.sheetRows-1,ne.e.r>g.e.r&&(ne.e.r=g.e.r),ne.e.r<ne.s.r&&(ne.s.r=ne.e.r),ne.e.c>g.e.c&&(ne.e.c=g.e.c),ne.e.c<ne.s.c&&(ne.s.c=ne.e.c),h["!fullref"]=h["!ref"],h["!ref"]=vt(ne))}return I.length>0&&(h["!merges"]=I),xe.length>0&&(h["!cols"]=xe),Ce.length>0&&(h["!rows"]=Ce),h}function jR(e,t,r,a,s,l,c){if(t.v===void 0)return!1;var u="";switch(t.t){case"b":u=t.v?"1":"0";break;case"d":t=lr(t),t.z=t.z||ct[14],t.v=Pr(ir(t.v)),t.t="n";break;case"n":case"e":u=""+t.v;break;default:u=t.v;break}var h={r,c:a};switch(h.s=oi(s.cellXfs,t,s),t.l&&l["!links"].push([ft(h),t.l]),t.c&&l["!comments"].push([ft(h),t.c]),t.t){case"s":case"str":return s.bookSST?(u=qm(s.Strings,t.v,s.revStrings),h.t="s",h.v=u,c?Ne(e,18,aR(t,h)):Ne(e,7,tR(t,h))):(h.t="str",c?Ne(e,17,gR(t,h)):Ne(e,6,dR(t,h))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?c?Ne(e,13,uR(t,h)):Ne(e,2,oR(t,h)):c?Ne(e,16,iR(t,h)):Ne(e,5,sR(t,h)),!0;case"b":return h.t="b",c?Ne(e,15,K5(t,h)):Ne(e,4,X5(t,h)),!0;case"e":return h.t="e",c?Ne(e,14,Z5(t,h)):Ne(e,3,J5(t,h)),!0}return c?Ne(e,12,G5(t,h)):Ne(e,1,$5(t,h)),!0}function UR(e,t,r,a){var s=Ft(t["!ref"]||"A1"),l,c="",u=[];Ne(e,145);var h=Array.isArray(t),d=s.e.r;t["!rows"]&&(d=Math.max(s.e.r,t["!rows"].length-1));for(var g=s.s.r;g<=d;++g){c=kr(g),I5(e,t,s,g);var x=!1;if(g<=s.e.r)for(var v=s.s.c;v<=s.e.c;++v){g===s.s.r&&(u[v]=hr(v)),l=u[v]+c;var _=h?(t[g]||[])[v]:t[l];if(!_){x=!1;continue}x=jR(e,_,g,v,a,t,x)}}Ne(e,146)}function PR(e,t){!t||!t["!merges"]||(Ne(e,177,bR(t["!merges"].length)),t["!merges"].forEach(function(r){Ne(e,176,wR(r))}),Ne(e,178))}function zR(e,t){!t||!t["!cols"]||(Ne(e,390),t["!cols"].forEach(function(r,a){r&&Ne(e,60,CR(a,r))}),Ne(e,391))}function HR(e,t){!t||!t["!ref"]||(Ne(e,648),Ne(e,649,FR(Ft(t["!ref"]))),Ne(e,650))}function $R(e,t,r){t["!links"].forEach(function(a){if(a[1].Target){var s=Ht(r,-1,a[1].Target.replace(/#.*$/,""),bt.HLINK);Ne(e,494,ER(a,s))}}),delete t["!links"]}function VR(e,t,r,a){if(t["!comments"].length>0){var s=Ht(a,-1,"../drawings/vmlDrawing"+(r+1)+".vml",bt.VML);Ne(e,551,Fm("rId"+s)),t["!legacy"]=s}}function GR(e,t,r,a){if(t["!autofilter"]){var s=t["!autofilter"],l=typeof s.ref=="string"?s.ref:vt(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var c=r.Workbook.Names,u=Fa(l);u.s.r==u.e.r&&(u.e.r=Fa(t["!ref"]).e.r,l=vt(u));for(var h=0;h<c.length;++h){var d=c[h];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==a){d.Ref="'"+r.SheetNames[a]+"'!"+l;break}}h==c.length&&c.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+l}),Ne(e,161,uo(Ft(l))),Ne(e,162)}}function qR(e,t,r){Ne(e,133),Ne(e,137,DR(t,r)),Ne(e,138),Ne(e,134)}function XR(e,t){t["!protect"]&&Ne(e,535,MR(t["!protect"]))}function WR(e,t,r,a){var s=Da(),l=r.SheetNames[e],c=r.Sheets[l]||{},u=l;try{r&&r.Workbook&&(u=r.Workbook.Sheets[e].CodeName||u)}catch{}var h=Ft(c["!ref"]||"A1");if(h.e.c>16383||h.e.r>1048575){if(t.WTF)throw new Error("Range "+(c["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575)}return c["!links"]=[],c["!comments"]=[],Ne(s,129),(r.vbaraw||c["!outline"])&&Ne(s,147,z5(u,c["!outline"])),Ne(s,148,j5(h)),qR(s,c,r.Workbook),zR(s,c),UR(s,c,e,t),XR(s,c),GR(s,c,r,e),PR(s,c),$R(s,c,a),c["!margins"]&&Ne(s,476,OR(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&HR(s,c),VR(s,c,e,a),Ne(s,130),s.end()}function KR(e){var t=[],r=e.match(/^<c:numCache>/),a;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(l){var c=l.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);c&&(t[+c[1]]=r?+c[2]:c[2])});var s=Dt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(l){a=l.replace(/<.*?>/g,"")}),[t,s,a]}function YR(e,t,r,a,s,l){var c=l||{"!type":"chart"};if(!e)return l;var u=0,h=0,d="A",g={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(x){var v=KR(x);g.s.r=g.s.c=0,g.e.c=u,d=hr(u),v[0].forEach(function(_,b){c[d+kr(b)]={t:"n",v:_,z:v[1]},h=b}),g.e.r<h&&(g.e.r=h),++u}),u>0&&(c["!ref"]=vt(g)),c}function JR(e,t,r,a,s){if(!e)return e;a||(a={"!id":{}});var l={"!type":"chart","!drawel":null,"!rel":""},c,u=e.match($2);return u&&Xm(u[0],l,s,r),(c=e.match(/drawing r:id="(.*?)"/))&&(l["!rel"]=c[1]),a["!id"][l["!rel"]]&&(l["!drawel"]=a["!id"][l["!rel"]]),l}function QR(e,t){e.l+=10;var r=da(e);return{name:r}}function ZR(e,t,r,a,s){if(!e)return e;a||(a={"!id":{}});var l={"!type":"chart","!drawel":null,"!rel":""},c=!1;return ps(e,function(h,d,g){switch(g){case 550:l["!rel"]=h;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),h.name&&(s.Sheets[r].CodeName=h.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:c=!0;break;case 36:c=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!c||t.WTF)throw new Error("Unexpected record 0x"+g.toString(16))}}}},t),a["!id"][l["!rel"]]&&(l["!drawel"]=a["!id"][l["!rel"]]),l}var Wm=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],eD=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],tD=[],rD=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function wy(e,t){for(var r=0;r!=e.length;++r)for(var a=e[r],s=0;s!=t.length;++s){var l=t[s];if(a[l[0]]==null)a[l[0]]=l[1];else switch(l[2]){case"bool":typeof a[l[0]]=="string"&&(a[l[0]]=sr(a[l[0]]));break;case"int":typeof a[l[0]]=="string"&&(a[l[0]]=parseInt(a[l[0]],10));break}}}function by(e,t){for(var r=0;r!=t.length;++r){var a=t[r];if(e[a[0]]==null)e[a[0]]=a[1];else switch(a[2]){case"bool":typeof e[a[0]]=="string"&&(e[a[0]]=sr(e[a[0]]));break;case"int":typeof e[a[0]]=="string"&&(e[a[0]]=parseInt(e[a[0]],10));break}}}function X2(e){by(e.WBProps,Wm),by(e.CalcPr,rD),wy(e.WBView,eD),wy(e.Sheets,tD),eo.date1904=sr(e.WBProps.date1904)}function aD(e){return!e.Workbook||!e.Workbook.WBProps?"false":sr(e.Workbook.WBProps.date1904)?"true":"false"}var nD="][*?/\\".split("");function W2(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return nD.forEach(function(a){if(e.indexOf(a)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function sD(e,t,r){e.forEach(function(a,s){W2(a);for(var l=0;l<s;++l)if(a==e[l])throw new Error("Duplicate Sheet Name: "+a);if(r){var c=t&&t[s]&&t[s].CodeName||a;if(c.charCodeAt(0)==95&&c.length>22)throw new Error("Bad Code Name: Worksheet"+c)}})}function iD(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];sD(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)a5(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var lD=/<\w+:workbook/;function oD(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,s="xmlns",l={},c=0;if(e.replace(ga,function(h,d){var g=ht(h);switch(Pn(g[0])){case"<?xml":break;case"<workbook":h.match(lD)&&(s="xmlns"+h.match(/<(\w+):/)[1]),r.xmlns=g[s];break;case"</workbook>":break;case"<fileVersion":delete g[0],r.AppVersion=g;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Wm.forEach(function(x){if(g[x[0]]!=null)switch(x[2]){case"bool":r.WBProps[x[0]]=sr(g[x[0]]);break;case"int":r.WBProps[x[0]]=parseInt(g[x[0]],10);break;default:r.WBProps[x[0]]=g[x[0]]}}),g.codeName&&(r.WBProps.CodeName=Jt(g.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete g[0],r.WBView.push(g);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(g.state){case"hidden":g.Hidden=1;break;case"veryHidden":g.Hidden=2;break;default:g.Hidden=0}delete g.state,g.name=Dt(Jt(g.name)),delete g[0],r.Sheets.push(g);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":a=!0;break;case"</definedNames>":a=!1;break;case"<definedName":l={},l.Name=Jt(g.name),g.comment&&(l.Comment=g.comment),g.localSheetId&&(l.Sheet=+g.localSheetId),sr(g.hidden||"0")&&(l.Hidden=!0),c=d+h.length;break;case"</definedName>":l.Ref=Dt(Jt(e.slice(c,d))),r.Names.push(l);break;case"<definedName/>":break;case"<calcPr":delete g[0],r.CalcPr=g;break;case"<calcPr/>":delete g[0],r.CalcPr=g;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</AlternateContent>":a=!1;break;case"<revisionPtr":break;default:if(!a&&t.WTF)throw new Error("unrecognized "+g[0]+" in workbook")}return h}),Xi.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return X2(r),r}function K2(e){var t=[Ar];t[t.length]=Me("workbook",null,{xmlns:Xi[0],"xmlns:r":Ur.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,a={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Wm.forEach(function(u){e.Workbook.WBProps[u[0]]!=null&&e.Workbook.WBProps[u[0]]!=u[1]&&(a[u[0]]=e.Workbook.WBProps[u[0]])}),e.Workbook.WBProps.CodeName&&(a.codeName=e.Workbook.WBProps.CodeName,delete a.CodeName)),t[t.length]=Me("workbookPr",null,a);var s=e.Workbook&&e.Workbook.Sheets||[],l=0;if(s&&s[0]&&s[0].Hidden){for(t[t.length]="<bookViews>",l=0;l!=e.SheetNames.length&&!(!s[l]||!s[l].Hidden);++l);l==e.SheetNames.length&&(l=0),t[t.length]='<workbookView firstSheet="'+l+'" activeTab="'+l+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",l=0;l!=e.SheetNames.length;++l){var c={name:$t(e.SheetNames[l].slice(0,31))};if(c.sheetId=""+(l+1),c["r:id"]="rId"+(l+1),s[l])switch(s[l].Hidden){case 1:c.state="hidden";break;case 2:c.state="veryHidden";break}t[t.length]=Me("sheet",null,c)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(u){var h={name:u.Name};u.Comment&&(h.comment=u.Comment),u.Sheet!=null&&(h.localSheetId=""+u.Sheet),u.Hidden&&(h.hidden="1"),u.Ref&&(t[t.length]=Me("definedName",$t(u.Ref),h))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function cD(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Yd(e),r.name=da(e),r}function uD(e,t){return t||(t=ve(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Fm(e.strRelID,t),qr(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function fD(e,t){var r={},a=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?da(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(a&65536),r.backupFile=!!(a&64),r.checkCompatibility=!!(a&4096),r.date1904=!!(a&1),r.filterPrivacy=!!(a&8),r.hidePivotFieldList=!!(a&1024),r.promptedSolutions=!!(a&16),r.publishItems=!!(a&2048),r.refreshAllConnections=!!(a&262144),r.saveExternalLinkValues=!!(a&128),r.showBorderUnselectedTables=!!(a&4),r.showInkAnnotation=!!(a&32),r.showObjects=["all","placeholders","none"][a>>13&3],r.showPivotChartFilter=!!(a&32768),r.updateLinks=["userSet","never","always"][a>>8&3],r}function hD(e,t){t||(t=ve(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),P_(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function dD(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function mD(e,t,r){var a=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),l=VA(e),c=JO(e,0,r),u=Dm(e);e.l=a;var h={Name:l,Ptg:c};return s<268435455&&(h.Sheet=s),u&&(h.Comment=u),h}function gD(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],s=!1;t||(t={}),t.biff=12;var l=[],c=[[]];return c.SheetNames=[],c.XTI=[],jc[16]={n:"BrtFRTArchID$",f:dD},ps(e,function(h,d,g){switch(g){case 156:c.SheetNames.push(h.name),r.Sheets.push(h);break;case 153:r.WBProps=h;break;case 39:h.Sheet!=null&&(t.SID=h.Sheet),h.Ref=ua(h.Ptg,null,null,c,t),delete t.SID,delete h.Ptg,l.push(h);break;case 1036:break;case 357:case 358:case 355:case 667:c[0].length?c.push([g,h]):c[0]=[g,h],c[c.length-1].XTI=[];break;case 362:c.length===0&&(c[0]=[],c[0].XTI=[]),c[c.length-1].XTI=c[c.length-1].XTI.concat(h),c.XTI=c.XTI.concat(h);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:a.push(g),s=!0;break;case 36:a.pop(),s=!1;break;case 37:a.push(g),s=!0;break;case 38:a.pop(),s=!1;break;case 16:break;default:if(!d.T){if(!s||t.WTF&&a[a.length-1]!=37&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+g.toString(16))}}},t),X2(r),r.Names=l,r.supbooks=c,r}function pD(e,t){Ne(e,143);for(var r=0;r!=t.SheetNames.length;++r){var a=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,s={Hidden:a,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};Ne(e,156,uD(s))}Ne(e,144)}function xD(e,t){t||(t=ve(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return qr("SheetJS",t),qr(Ru.version,t),qr(Ru.version,t),qr("7262",t),t.length>t.l?t.slice(0,t.l):t}function vD(e,t){t||(t=ve(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function yD(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,a=0,s=-1,l=-1;a<r.length;++a)!r[a]||!r[a].Hidden&&s==-1?s=a:r[a].Hidden==1&&l==-1&&(l=a);l>s||(Ne(e,135),Ne(e,158,vD(s)),Ne(e,136))}}function _D(e,t){var r=Da();return Ne(r,131),Ne(r,128,xD()),Ne(r,153,hD(e.Workbook&&e.Workbook.WBProps||null)),yD(r,e),pD(r,e),Ne(r,132),r.end()}function wD(e,t,r){return t.slice(-4)===".bin"?gD(e,r):oD(e,r)}function bD(e,t,r,a,s,l,c,u){return t.slice(-4)===".bin"?BR(e,a,r,s,l,c,u):m5(e,a,r,s,l,c,u)}function SD(e,t,r,a,s,l,c,u){return t.slice(-4)===".bin"?ZR(e,a,r,s,l):JR(e,a,r,s,l)}function ED(e,t,r,a,s,l,c,u){return t.slice(-4)===".bin"?k8():A8()}function TD(e,t,r,a,s,l,c,u){return t.slice(-4)===".bin"?E8():T8()}function kD(e,t,r,a){return t.slice(-4)===".bin"?w6(e,r,a):c6(e,r,a)}function AD(e,t,r){return N2(e,r)}function CD(e,t,r){return t.slice(-4)===".bin"?CN(e,r):TN(e,r)}function ND(e,t,r){return t.slice(-4)===".bin"?y8(e,r):u8(e,r)}function OD(e,t,r){return t.slice(-4)===".bin"?l8(e):s8(e)}function RD(e,t,r,a){return r.slice(-4)===".bin"?o8(e,t,r,a):void 0}function DD(e,t,r){return t.slice(-4)===".bin"?r8(e,t,r):n8(e,t,r)}function FD(e,t,r){return(t.slice(-4)===".bin"?_D:K2)(e)}function MD(e,t,r,a,s){return(t.slice(-4)===".bin"?WR:V2)(e,r,a,s)}function LD(e,t,r){return(t.slice(-4)===".bin"?R6:A2)(e,r)}function ID(e,t,r){return(t.slice(-4)===".bin"?RN:y2)(e,r)}function BD(e,t,r){return(t.slice(-4)===".bin"?_8:D2)(e)}function jD(e){return(e.slice(-4)===".bin"?a8:O2)()}var Y2=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,J2=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function wn(e,t){var r=e.split(/\s+/),a=[];if(a[0]=r[0],r.length===1)return a;var s=e.match(Y2),l,c,u,h;if(s)for(h=0;h!=s.length;++h)l=s[h].match(J2),(c=l[1].indexOf(":"))===-1?a[l[1]]=l[2].slice(1,l[2].length-1):(l[1].slice(0,6)==="xmlns:"?u="xmlns"+l[1].slice(6):u=l[1].slice(c+1),a[u]=l[2].slice(1,l[2].length-1));return a}function UD(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var a=e.match(Y2),s,l,c,u;if(a)for(u=0;u!=a.length;++u)s=a[u].match(J2),(l=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?c="xmlns"+s[1].slice(6):c=s[1].slice(l+1),r[c]=s[2].slice(1,s[2].length-1));return r}var yc;function PD(e,t){var r=yc[e]||Dt(e);return r==="General"?Pi(t):mn(r,t)}function zD(e,t,r,a){var s=a;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=sr(a);break;case"i2":case"int":s=parseInt(a,10);break;case"r4":case"float":s=parseFloat(a);break;case"date":case"dateTime.tz":s=ir(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Dt(t)]=s}function HD(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||xs[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Nc(e.v):e.w=Pi(e.v):e.w=PD(t||"General",e.v)}catch(l){if(r.WTF)throw l}try{var a=yc[t]||t||"General";if(r.cellNF&&(e.z=a),r.cellDates&&e.t=="n"&&lo(a)){var s=Li(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(l){if(r.WTF)throw l}}}function $D(e,t,r){if(r.cellStyles&&t.Interior){var a=t.Interior;a.Pattern&&(a.patternType=t6[a.Pattern]||a.Pattern)}e[t.ID]=t}function VD(e,t,r,a,s,l,c,u,h,d){var g="General",x=a.StyleID,v={};d=d||{};var _=[],b=0;for(x===void 0&&u&&(x=u.StyleID),x===void 0&&c&&(x=c.StyleID);l[x]!==void 0&&(l[x].nf&&(g=l[x].nf),l[x].Interior&&_.push(l[x].Interior),!!l[x].Parent);)x=l[x].Parent;switch(r.Type){case"Boolean":a.t="b",a.v=sr(e);break;case"String":a.t="s",a.r=Uv(Dt(e)),a.v=e.indexOf("<")>-1?Dt(t||e).replace(/<.*?>/g,""):a.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),a.v=(ir(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),a.v!==a.v?a.v=Dt(e):a.v<60&&(a.v=a.v-1),(!g||g=="General")&&(g="yyyy-mm-dd");case"Number":a.v===void 0&&(a.v=+e),a.t||(a.t="n");break;case"Error":a.t="e",a.v=G_[e],d.cellText!==!1&&(a.w=e);break;default:e==""&&t==""?a.t="z":(a.t="s",a.v=Uv(t||e));break}if(HD(a,g,d),d.cellFormula!==!1)if(a.Formula){var y=Dt(a.Formula);y.charCodeAt(0)==61&&(y=y.slice(1)),a.f=Zl(y,s),delete a.Formula,a.ArrayRange=="RC"?a.F=Zl("RC:RC",s):a.ArrayRange&&(a.F=Zl(a.ArrayRange,s),h.push([Ft(a.F),a.F]))}else for(b=0;b<h.length;++b)s.r>=h[b][0].s.r&&s.r<=h[b][0].e.r&&s.c>=h[b][0].s.c&&s.c<=h[b][0].e.c&&(a.F=h[b][1]);d.cellStyles&&(_.forEach(function(S){!v.patternType&&S.patternType&&(v.patternType=S.patternType)}),a.s=v),a.StyleID!==void 0&&(a.ixfe=a.StyleID)}function GD(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Dd(e,t){var r=t||{};oo();var a=oc(km(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(a=Jt(a));var s=a.slice(0,1024).toLowerCase(),l=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var c=lr(r);return c.type="string",no.to_workbook(a,c)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Vt){s.indexOf("<"+Vt)>=0&&(l=!0)}),l)return OF(a,r);yc={"General Number":"General","General Date":ct[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ct[15],"Short Date":ct[14],"Long Time":ct[19],"Medium Time":ct[18],"Short Time":ct[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ct[2],Standard:ct[4],Percent:ct[10],Scientific:ct[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var u,h=[],d,g={},x=[],v=r.dense?[]:{},_="",b={},y={},S=wn('<Data ss:Type="String">'),k=0,O=0,T=0,j={s:{r:2e6,c:2e6},e:{r:0,c:0}},X={},I={},C="",K=0,q=[],oe={},ee={},Z=0,xe=[],Ce=[],Se={},G=[],ne,pe=!1,J=[],be=[],L={},N=0,V=0,M={Sheets:[],WBProps:{date1904:!1}},z={};Dc.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"");for(var te="";u=Dc.exec(a);)switch(u[3]=(te=u[3]).toLowerCase()){case"data":if(te=="data"){if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break}if(h[h.length-1][1])break;u[1]==="/"?VD(a.slice(k,u.index),C,S,h[h.length-1][0]=="comment"?Se:b,{c:O,r:T},X,G[O],y,J,r):(C="",S=wn(u[0]),k=u.index+u[0].length);break;case"cell":if(u[1]==="/")if(Ce.length>0&&(b.c=Ce),(!r.sheetRows||r.sheetRows>T)&&b.v!==void 0&&(r.dense?(v[T]||(v[T]=[]),v[T][O]=b):v[hr(O)+kr(T)]=b),b.HRef&&(b.l={Target:Dt(b.HRef)},b.HRefScreenTip&&(b.l.Tooltip=b.HRefScreenTip),delete b.HRef,delete b.HRefScreenTip),(b.MergeAcross||b.MergeDown)&&(N=O+(parseInt(b.MergeAcross,10)|0),V=T+(parseInt(b.MergeDown,10)|0),q.push({s:{c:O,r:T},e:{c:N,r:V}})),!r.sheetStubs)b.MergeAcross?O=N+1:++O;else if(b.MergeAcross||b.MergeDown){for(var ge=O;ge<=N;++ge)for(var Ee=T;Ee<=V;++Ee)(ge>O||Ee>T)&&(r.dense?(v[Ee]||(v[Ee]=[]),v[Ee][ge]={t:"z"}):v[hr(ge)+kr(Ee)]={t:"z"});O=N+1}else++O;else b=UD(u[0]),b.Index&&(O=+b.Index-1),O<j.s.c&&(j.s.c=O),O>j.e.c&&(j.e.c=O),u[0].slice(-2)==="/>"&&++O,Ce=[];break;case"row":u[1]==="/"||u[0].slice(-2)==="/>"?(T<j.s.r&&(j.s.r=T),T>j.e.r&&(j.e.r=T),u[0].slice(-2)==="/>"&&(y=wn(u[0]),y.Index&&(T=+y.Index-1)),O=0,++T):(y=wn(u[0]),y.Index&&(T=+y.Index-1),L={},(y.AutoFitHeight=="0"||y.Height)&&(L.hpx=parseInt(y.Height,10),L.hpt=Bc(L.hpx),be[T]=L),y.Hidden=="1"&&(L.hidden=!0,be[T]=L));break;case"worksheet":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"));x.push(_),j.s.r<=j.e.r&&j.s.c<=j.e.c&&(v["!ref"]=vt(j),r.sheetRows&&r.sheetRows<=j.e.r&&(v["!fullref"]=v["!ref"],j.e.r=r.sheetRows-1,v["!ref"]=vt(j))),q.length&&(v["!merges"]=q),G.length>0&&(v["!cols"]=G),be.length>0&&(v["!rows"]=be),g[_]=v}else j={s:{r:2e6,c:2e6},e:{r:0,c:0}},T=O=0,h.push([u[3],!1]),d=wn(u[0]),_=Dt(d.Name),v=r.dense?[]:{},q=[],J=[],be=[],z={name:_,Hidden:0},M.Sheets.push(z);break;case"table":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else{if(u[0].slice(-2)=="/>")break;h.push([u[3],!1]),G=[],pe=!1}break;case"style":u[1]==="/"?$D(X,I,r):I=wn(u[0]);break;case"numberformat":I.nf=Dt(wn(u[0]).Format||"General"),yc[I.nf]&&(I.nf=yc[I.nf]);for(var ye=0;ye!=392&&ct[ye]!=I.nf;++ye);if(ye==392){for(ye=57;ye!=392;++ye)if(ct[ye]==null){fs(I.nf,ye);break}}break;case"column":if(h[h.length-1][0]!=="table")break;if(ne=wn(u[0]),ne.Hidden&&(ne.hidden=!0,delete ne.Hidden),ne.Width&&(ne.wpx=parseInt(ne.Width,10)),!pe&&ne.wpx>10){pe=!0,fa=T2;for(var Ae=0;Ae<G.length;++Ae)G[Ae]&&ri(G[Ae])}pe&&ri(ne),G[ne.Index-1||G.length]=ne;for(var tt=0;tt<+ne.Span;++tt)G[G.length]=lr(ne);break;case"namedrange":if(u[1]==="/")break;M.Names||(M.Names=[]);var P=ht(u[0]),St={Name:P.Name,Ref:Zl(P.RefersTo.slice(1),{r:0,c:0})};M.Sheets.length>0&&(St.Sheet=M.Sheets.length-1),M.Names.push(St);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(u[0].slice(-2)==="/>")break;u[1]==="/"?C+=a.slice(K,u.index):K=u.index+u[0].length;break;case"interior":if(!r.cellStyles)break;I.Interior=wn(u[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(u[0].slice(-2)==="/>")break;u[1]==="/"?g3(oe,te,a.slice(Z,u.index)):Z=u.index+u[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else h.push([u[3],!1]);break;case"comment":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"));GD(Se),Ce.push(Se)}else h.push([u[3],!1]),d=wn(u[0]),Se={a:d.Author};break;case"autofilter":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else if(u[0].charAt(u[0].length-2)!=="/"){var at=wn(u[0]);v["!autofilter"]={ref:Zl(at.Range).replace(/\$/g,"")},h.push([u[3],!0])}break;case"name":break;case"datavalidation":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break;case"null":break;default:if(h.length==0&&u[3]=="document"||h.length==0&&u[3]=="uof")return Ay(a,r);var Et=!0;switch(h[h.length-1][0]){case"officedocumentsettings":switch(u[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Et=!1}break;case"componentoptions":switch(u[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Et=!1}break;case"excelworkbook":switch(u[3]){case"date1904":M.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Et=!1}break;case"workbookoptions":switch(u[3]){case"owcversion":break;case"height":break;case"width":break;default:Et=!1}break;case"worksheetoptions":switch(u[3]){case"visible":if(u[0].slice(-2)!=="/>")if(u[1]==="/")switch(a.slice(Z,u.index)){case"SheetHidden":z.Hidden=1;break;case"SheetVeryHidden":z.Hidden=2;break}else Z=u.index+u[0].length;break;case"header":v["!margins"]||Ui(v["!margins"]={},"xlml"),isNaN(+ht(u[0]).Margin)||(v["!margins"].header=+ht(u[0]).Margin);break;case"footer":v["!margins"]||Ui(v["!margins"]={},"xlml"),isNaN(+ht(u[0]).Margin)||(v["!margins"].footer=+ht(u[0]).Margin);break;case"pagemargins":var dt=ht(u[0]);v["!margins"]||Ui(v["!margins"]={},"xlml"),isNaN(+dt.Top)||(v["!margins"].top=+dt.Top),isNaN(+dt.Left)||(v["!margins"].left=+dt.Left),isNaN(+dt.Right)||(v["!margins"].right=+dt.Right),isNaN(+dt.Bottom)||(v["!margins"].bottom=+dt.Bottom);break;case"displayrighttoleft":M.Views||(M.Views=[]),M.Views[0]||(M.Views[0]={}),M.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":v["!outline"]||(v["!outline"]={}),v["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":v["!outline"]||(v["!outline"]={}),v["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Et=!1}break;case"pivottable":case"pivotcache":switch(u[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Et=!1}break;case"pagebreaks":switch(u[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Et=!1}break;case"autofilter":switch(u[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Et=!1}break;case"querytable":switch(u[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Et=!1}break;case"datavalidation":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Et=!1}break;case"sorting":case"conditionalformatting":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Et=!1}break;case"mapinfo":case"schema":case"data":switch(u[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Et=!1}break;case"smarttags":break;default:Et=!1;break}if(Et||u[3].match(/!\[CDATA/))break;if(!h[h.length-1][1])throw"Unrecognized tag: "+u[3]+"|"+h.join("|");if(h[h.length-1][0]==="customdocumentproperties"){if(u[0].slice(-2)==="/>")break;u[1]==="/"?zD(ee,te,xe,a.slice(Z,u.index)):(xe=u,Z=u.index+u[0].length);break}if(r.WTF)throw"Unrecognized tag: "+u[3]+"|"+h.join("|")}var Be={};return!r.bookSheets&&!r.bookProps&&(Be.Sheets=g),Be.SheetNames=x,Be.Workbook=M,Be.SSF=lr(ct),Be.Props=oe,Be.Custprops=ee,Be}function am(e,t){switch(Ym(t=t||{}),t.type||"base64"){case"base64":return Dd(Ka(e),t);case"binary":case"buffer":case"file":return Dd(e,t);case"array":return Dd(ii(e),t)}}function qD(e,t){var r=[];return e.Props&&r.push(p3(e.Props,t)),e.Custprops&&r.push(x3(e.Props,e.Custprops)),r.join("")}function XD(){return""}function WD(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(a,s){var l=[];l.push(Me("NumberFormat",null,{"ss:Format":$t(ct[a.numFmtId])}));var c={"ss:ID":"s"+(21+s)};r.push(Me("Style",l.join(""),c))}),Me("Styles",r.join(""))}function Q2(e){return Me("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Vm(e.Ref,{r:0,c:0})})}function KD(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],a=0;a<t.length;++a){var s=t[a];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(Q2(s)))}return Me("Names",r.join(""))}function YD(e,t,r,a){if(!e||!((a||{}).Workbook||{}).Names)return"";for(var s=a.Workbook.Names,l=[],c=0;c<s.length;++c){var u=s[c];u.Sheet==r&&(u.Name.match(/^_xlfn\./)||l.push(Q2(u)))}return l.join("")}function JD(e,t,r,a){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(Me("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(Me("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(Me("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),a&&a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[r])if(a.Workbook.Sheets[r].Hidden)s.push(Me("Visible",a.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var l=0;l<r&&!(a.Workbook.Sheets[l]&&!a.Workbook.Sheets[l].Hidden);++l);l==r&&s.push("<Selected/>")}return((((a||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(aa("ProtectContents","True")),e["!protect"].objects&&s.push(aa("ProtectObjects","True")),e["!protect"].scenarios&&s.push(aa("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(aa("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(aa("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(c){e["!protect"][c[0]]&&s.push("<"+c[1]+"/>")})),s.length==0?"":Me("WorksheetOptions",s.join(""),{xmlns:$a.x})}function QD(e){return e.map(function(t){var r=yA(t.t||""),a=Me("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Me("Comment",a,{"ss:Author":t.a})}).join("")}function ZD(e,t,r,a,s,l,c){if(!e||e.v==null&&e.f==null)return"";var u={};if(e.f&&(u["ss:Formula"]="="+$t(Vm(e.f,c))),e.F&&e.F.slice(0,t.length)==t){var h=dr(e.F.slice(t.length+1));u["ss:ArrayRange"]="RC:R"+(h.r==c.r?"":"["+(h.r-c.r)+"]")+"C"+(h.c==c.c?"":"["+(h.c-c.c)+"]")}if(e.l&&e.l.Target&&(u["ss:HRef"]=$t(e.l.Target),e.l.Tooltip&&(u["x:HRefScreenTip"]=$t(e.l.Tooltip))),r["!merges"])for(var d=r["!merges"],g=0;g!=d.length;++g)d[g].s.c!=c.c||d[g].s.r!=c.r||(d[g].e.c>d[g].s.c&&(u["ss:MergeAcross"]=d[g].e.c-d[g].s.c),d[g].e.r>d[g].s.r&&(u["ss:MergeDown"]=d[g].e.r-d[g].s.r));var x="",v="";switch(e.t){case"z":if(!a.sheetStubs)return"";break;case"n":x="Number",v=String(e.v);break;case"b":x="Boolean",v=e.v?"1":"0";break;case"e":x="Error",v=xs[e.v];break;case"d":x="DateTime",v=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||ct[14]);break;case"s":x="String",v=vA(e.v||"");break}var _=oi(a.cellXfs,e,a);u["ss:StyleID"]="s"+(21+_),u["ss:Index"]=c.c+1;var b=e.v!=null?v:"",y=e.t=="z"?"":'<Data ss:Type="'+x+'">'+b+"</Data>";return(e.c||[]).length>0&&(y+=QD(e.c)),Me("Cell",y,u)}function eF(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=so(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function tF(e,t,r,a){if(!e["!ref"])return"";var s=Ft(e["!ref"]),l=e["!merges"]||[],c=0,u=[];e["!cols"]&&e["!cols"].forEach(function(S,k){ri(S);var O=!!S.width,T=rf(k,S),j={"ss:Index":k+1};O&&(j["ss:Width"]=Lc(T.width)),S.hidden&&(j["ss:Hidden"]="1"),u.push(Me("Column",null,j))});for(var h=Array.isArray(e),d=s.s.r;d<=s.e.r;++d){for(var g=[eF(d,(e["!rows"]||[])[d])],x=s.s.c;x<=s.e.c;++x){var v=!1;for(c=0;c!=l.length;++c)if(!(l[c].s.c>x)&&!(l[c].s.r>d)&&!(l[c].e.c<x)&&!(l[c].e.r<d)){(l[c].s.c!=x||l[c].s.r!=d)&&(v=!0);break}if(!v){var _={r:d,c:x},b=ft(_),y=h?(e[d]||[])[x]:e[b];g.push(ZD(y,b,e,t,r,a,_))}}g.push("</Row>"),g.length>2&&u.push(g.join(""))}return u.join("")}function rF(e,t,r){var a=[],s=r.SheetNames[e],l=r.Sheets[s],c=l?YD(l,t,e,r):"";return c.length>0&&a.push("<Names>"+c+"</Names>"),c=l?tF(l,t,e,r):"",c.length>0&&a.push("<Table>"+c+"</Table>"),a.push(JD(l,t,e,r)),a.join("")}function aF(e,t){t||(t={}),e.SSF||(e.SSF=lr(ct)),e.SSF&&(oo(),Ku(e.SSF),t.revssf=Ju(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],oi(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(qD(e,t)),r.push(XD()),r.push(""),r.push("");for(var a=0;a<e.SheetNames.length;++a)r.push(Me("Worksheet",rF(a,t,e),{"ss:Name":$t(e.SheetNames[a])}));return r[2]=WD(e,t),r[3]=KD(e),Ar+Me("Workbook",r.join(""),{xmlns:$a.ss,"xmlns:o":$a.o,"xmlns:x":$a.x,"xmlns:ss":$a.ss,"xmlns:dt":$a.dt,"xmlns:html":$a.html})}function nF(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=KA(r),r.length-r.l<=4)return t;var a=r.read_shift(4);if(a==0||a>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(a=r.read_shift(4),a!==1907505652)||(t.UnicodeClipboardFormat=YA(r),a=r.read_shift(4),a==0||a>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var sF=[60,1084,2066,2165,2175];function iF(e,t,r,a,s){var l=a,c=[],u=r.slice(r.l,r.l+l);if(s&&s.enc&&s.enc.insitu&&u.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(u)}c.push(u),r.l+=l;for(var h=cs(r,r.l),d=nm[h],g=0;d!=null&&sF.indexOf(h)>-1;)l=cs(r,r.l+2),g=r.l+4,h==2066?g+=4:(h==2165||h==2175)&&(g+=12),u=r.slice(g,r.l+4+l),c.push(u),r.l+=4+l,d=nm[h=cs(r,r.l)];var x=Gr(c);ra(x,0);var v=0;x.lens=[];for(var _=0;_<c.length;++_)x.lens.push(v),v+=c[_].length;if(x.length<a)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+x.length+" < "+a;return t.f(x,x.length,s)}function In(e,t,r){if(e.t!=="z"&&e.XF){var a=0;try{a=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=ct[a])}catch(l){if(t.WTF)throw l}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||xs[e.v]:a===0||a=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Nc(e.v):e.w=Pi(e.v):e.w=mn(a,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(l){if(t.WTF)throw l}if(t.cellDates&&a&&e.t=="n"&&lo(ct[a]||String(a))){var s=Li(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function Eu(e,t,r){return{v:e,ixfe:t,t:r}}function lF(e,t){var r={opts:{}},a={},s=t.dense?[]:{},l={},c={},u=null,h=[],d="",g={},x,v="",_,b,y,S,k={},O=[],T,j,X=[],I=[],C={Sheets:[],WBProps:{date1904:!1},Views:[{}]},K={},q=function(gt){return gt<8?Ii[gt]:gt<64&&I[gt-8]||Ii[gt]},oe=function(gt,Gt,ia){var Rt=Gt.XF.data;if(!(!Rt||!Rt.patternType||!ia||!ia.cellStyles)){Gt.s={},Gt.s.patternType=Rt.patternType;var rr;(rr=Mc(q(Rt.icvFore)))&&(Gt.s.fgColor={rgb:rr}),(rr=Mc(q(Rt.icvBack)))&&(Gt.s.bgColor={rgb:rr})}},ee=function(gt,Gt,ia){if(!(L>1)&&!(ia.sheetRows&&gt.r>=ia.sheetRows)){if(ia.cellStyles&&Gt.XF&&Gt.XF.data&&oe(gt,Gt,ia),delete Gt.ixfe,delete Gt.XF,x=gt,v=ft(gt),(!c||!c.s||!c.e)&&(c={s:{r:0,c:0},e:{r:0,c:0}}),gt.r<c.s.r&&(c.s.r=gt.r),gt.c<c.s.c&&(c.s.c=gt.c),gt.r+1>c.e.r&&(c.e.r=gt.r+1),gt.c+1>c.e.c&&(c.e.c=gt.c+1),ia.cellFormula&&Gt.f){for(var Rt=0;Rt<O.length;++Rt)if(!(O[Rt][0].s.c>gt.c||O[Rt][0].s.r>gt.r)&&!(O[Rt][0].e.c<gt.c||O[Rt][0].e.r<gt.r)){Gt.F=vt(O[Rt][0]),(O[Rt][0].s.c!=gt.c||O[Rt][0].s.r!=gt.r)&&delete Gt.f,Gt.f&&(Gt.f=""+ua(O[Rt][1],c,gt,J,Z));break}}ia.dense?(s[gt.r]||(s[gt.r]=[]),s[gt.r][gt.c]=Gt):s[v]=Gt}},Z={enc:!1,sbcch:0,snames:[],sharedf:k,arrayf:O,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(Z.password=t.password);var xe,Ce=[],Se=[],G=[],ne=[],pe=!1,J=[];J.SheetNames=Z.snames,J.sharedf=Z.sharedf,J.arrayf=Z.arrayf,J.names=[],J.XTI=[];var be=0,L=0,N=0,V=[],M=[],z;Z.codepage=1200,Tn(1200);for(var te=!1;e.l<e.length-1;){var ge=e.l,Ee=e.read_shift(2);if(Ee===0&&be===10)break;var ye=e.l===e.length?0:e.read_shift(2),Ae=nm[Ee];if(Ae&&Ae.f){if(t.bookSheets&&be===133&&Ee!==133)break;if(be=Ee,Ae.r===2||Ae.r==12){var tt=e.read_shift(2);if(ye-=2,!Z.enc&&tt!==Ee&&((tt&255)<<8|tt>>8)!==Ee)throw new Error("rt mismatch: "+tt+"!="+Ee);Ae.r==12&&(e.l+=10,ye-=10)}var P={};if(Ee===10?P=Ae.f(e,ye,Z):P=iF(Ee,Ae,e,ye,Z),L==0&&[9,521,1033,2057].indexOf(be)===-1)continue;switch(Ee){case 34:r.opts.Date1904=C.WBProps.date1904=P;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(Z.enc||(e.l=0),Z.enc=P,!t.password)throw new Error("File is password-protected");if(P.valid==null)throw new Error("Encryption scheme unsupported");if(!P.valid)throw new Error("Password is incorrect");break;case 92:Z.lastuser=P;break;case 66:var St=Number(P);switch(St){case 21010:St=1200;break;case 32768:St=1e4;break;case 32769:St=1252;break}Tn(Z.codepage=St),te=!0;break;case 317:Z.rrtabid=P;break;case 25:Z.winlocked=P;break;case 439:r.opts.RefreshAll=P;break;case 12:r.opts.CalcCount=P;break;case 16:r.opts.CalcDelta=P;break;case 17:r.opts.CalcIter=P;break;case 13:r.opts.CalcMode=P;break;case 14:r.opts.CalcPrecision=P;break;case 95:r.opts.CalcSaveRecalc=P;break;case 15:Z.CalcRefMode=P;break;case 2211:r.opts.FullCalc=P;break;case 129:P.fDialog&&(s["!type"]="dialog"),P.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),P.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:X.push(P);break;case 430:J.push([P]),J[J.length-1].XTI=[];break;case 35:case 547:J[J.length-1].push(P);break;case 24:case 536:z={Name:P.Name,Ref:ua(P.rgce,c,null,J,Z)},P.itab>0&&(z.Sheet=P.itab-1),J.names.push(z),J[0]||(J[0]=[],J[0].XTI=[]),J[J.length-1].push(P),P.Name=="_xlnm._FilterDatabase"&&P.itab>0&&P.rgce&&P.rgce[0]&&P.rgce[0][0]&&P.rgce[0][0][0]=="PtgArea3d"&&(M[P.itab-1]={ref:vt(P.rgce[0][0][1][2])});break;case 22:Z.ExternCount=P;break;case 23:J.length==0&&(J[0]=[],J[0].XTI=[]),J[J.length-1].XTI=J[J.length-1].XTI.concat(P),J.XTI=J.XTI.concat(P);break;case 2196:if(Z.biff<8)break;z!=null&&(z.Comment=P[1]);break;case 18:s["!protect"]=P;break;case 19:P!==0&&Z.WTF&&console.error("Password verifier: "+P);break;case 133:l[P.pos]=P,Z.snames.push(P.name);break;case 10:{if(--L)break;if(c.e){if(c.e.r>0&&c.e.c>0){if(c.e.r--,c.e.c--,s["!ref"]=vt(c),t.sheetRows&&t.sheetRows<=c.e.r){var at=c.e.r;c.e.r=t.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=vt(c),c.e.r=at}c.e.r++,c.e.c++}Ce.length>0&&(s["!merges"]=Ce),Se.length>0&&(s["!objects"]=Se),G.length>0&&(s["!cols"]=G),ne.length>0&&(s["!rows"]=ne),C.Sheets.push(K)}d===""?g=s:a[d]=s,s=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(Z.biff===8&&(Z.biff={9:2,521:3,1033:4}[Ee]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[P.BIFFVer]||8),Z.biffguess=P.BIFFVer==0,P.BIFFVer==0&&P.dt==4096&&(Z.biff=5,te=!0,Tn(Z.codepage=28591)),Z.biff==8&&P.BIFFVer==0&&P.dt==16&&(Z.biff=2),L++)break;if(s=t.dense?[]:{},Z.biff<8&&!te&&(te=!0,Tn(Z.codepage=t.codepage||1252)),Z.biff<5||P.BIFFVer==0&&P.dt==4096){d===""&&(d="Sheet1"),c={s:{r:0,c:0},e:{r:0,c:0}};var Et={pos:e.l-ye,name:d};l[Et.pos]=Et,Z.snames.push(d)}else d=(l[ge]||{name:""}).name;P.dt==32&&(s["!type"]="chart"),P.dt==64&&(s["!type"]="macro"),Ce=[],Se=[],Z.arrayf=O=[],G=[],ne=[],pe=!1,K={Hidden:(l[ge]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(t.dense?(s[P.r]||[])[P.c]:s[ft({c:P.c,r:P.r})])&&++P.c,T={ixfe:P.ixfe,XF:X[P.ixfe]||{},v:P.val,t:"n"},N>0&&(T.z=V[T.ixfe>>8&63]),In(T,t,r.opts.Date1904),ee({c:P.c,r:P.r},T,t);break;case 5:case 517:T={ixfe:P.ixfe,XF:X[P.ixfe],v:P.val,t:P.t},N>0&&(T.z=V[T.ixfe>>8&63]),In(T,t,r.opts.Date1904),ee({c:P.c,r:P.r},T,t);break;case 638:T={ixfe:P.ixfe,XF:X[P.ixfe],v:P.rknum,t:"n"},N>0&&(T.z=V[T.ixfe>>8&63]),In(T,t,r.opts.Date1904),ee({c:P.c,r:P.r},T,t);break;case 189:for(var dt=P.c;dt<=P.C;++dt){var Be=P.rkrec[dt-P.c][0];T={ixfe:Be,XF:X[Be],v:P.rkrec[dt-P.c][1],t:"n"},N>0&&(T.z=V[T.ixfe>>8&63]),In(T,t,r.opts.Date1904),ee({c:dt,r:P.r},T,t)}break;case 6:case 518:case 1030:{if(P.val=="String"){u=P;break}if(T=Eu(P.val,P.cell.ixfe,P.tt),T.XF=X[T.ixfe],t.cellFormula){var Vt=P.formula;if(Vt&&Vt[0]&&Vt[0][0]&&Vt[0][0][0]=="PtgExp"){var br=Vt[0][0][1][0],na=Vt[0][0][1][1],pa=ft({r:br,c:na});k[pa]?T.f=""+ua(P.formula,c,P.cell,J,Z):T.F=((t.dense?(s[br]||[])[na]:s[pa])||{}).F}else T.f=""+ua(P.formula,c,P.cell,J,Z)}N>0&&(T.z=V[T.ixfe>>8&63]),In(T,t,r.opts.Date1904),ee(P.cell,T,t),u=P}break;case 7:case 519:if(u)u.val=P,T=Eu(P,u.cell.ixfe,"s"),T.XF=X[T.ixfe],t.cellFormula&&(T.f=""+ua(u.formula,c,u.cell,J,Z)),N>0&&(T.z=V[T.ixfe>>8&63]),In(T,t,r.opts.Date1904),ee(u.cell,T,t),u=null;else throw new Error("String record expects Formula");break;case 33:case 545:{O.push(P);var Xr=ft(P[0].s);if(_=t.dense?(s[P[0].s.r]||[])[P[0].s.c]:s[Xr],t.cellFormula&&_){if(!u||!Xr||!_)break;_.f=""+ua(P[1],c,P[0],J,Z),_.F=vt(P[0])}}break;case 1212:{if(!t.cellFormula)break;if(v){if(!u)break;k[ft(u.cell)]=P[0],_=t.dense?(s[u.cell.r]||[])[u.cell.c]:s[ft(u.cell)],(_||{}).f=""+ua(P[0],c,x,J,Z)}}break;case 253:T=Eu(h[P.isst].t,P.ixfe,"s"),h[P.isst].h&&(T.h=h[P.isst].h),T.XF=X[T.ixfe],N>0&&(T.z=V[T.ixfe>>8&63]),In(T,t,r.opts.Date1904),ee({c:P.c,r:P.r},T,t);break;case 513:t.sheetStubs&&(T={ixfe:P.ixfe,XF:X[P.ixfe],t:"z"},N>0&&(T.z=V[T.ixfe>>8&63]),In(T,t,r.opts.Date1904),ee({c:P.c,r:P.r},T,t));break;case 190:if(t.sheetStubs)for(var Ya=P.c;Ya<=P.C;++Ya){var Mt=P.ixfe[Ya-P.c];T={ixfe:Mt,XF:X[Mt],t:"z"},N>0&&(T.z=V[T.ixfe>>8&63]),In(T,t,r.opts.Date1904),ee({c:Ya,r:P.r},T,t)}break;case 214:case 516:case 4:T=Eu(P.val,P.ixfe,"s"),T.XF=X[T.ixfe],N>0&&(T.z=V[T.ixfe>>8&63]),In(T,t,r.opts.Date1904),ee({c:P.c,r:P.r},T,t);break;case 0:case 512:L===1&&(c=P);break;case 252:h=P;break;case 1054:if(Z.biff==4){V[N++]=P[1];for(var sa=0;sa<N+163&&ct[sa]!=P[1];++sa);sa>=163&&fs(P[1],N+163)}else fs(P[1],P[0]);break;case 30:{V[N++]=P;for(var zr=0;zr<N+163&&ct[zr]!=P;++zr);zr>=163&&fs(P,N+163)}break;case 229:Ce=Ce.concat(P);break;case 93:Se[P.cmo[0]]=Z.lastobj=P;break;case 438:Z.lastobj.TxO=P;break;case 127:Z.lastobj.ImData=P;break;case 440:for(S=P[0].s.r;S<=P[0].e.r;++S)for(y=P[0].s.c;y<=P[0].e.c;++y)_=t.dense?(s[S]||[])[y]:s[ft({c:y,r:S})],_&&(_.l=P[1]);break;case 2048:for(S=P[0].s.r;S<=P[0].e.r;++S)for(y=P[0].s.c;y<=P[0].e.c;++y)_=t.dense?(s[S]||[])[y]:s[ft({c:y,r:S})],_&&_.l&&(_.l.Tooltip=P[1]);break;case 28:{if(Z.biff<=5&&Z.biff>=2)break;_=t.dense?(s[P[0].r]||[])[P[0].c]:s[ft(P[0])];var Ja=Se[P[2]];_||(t.dense?(s[P[0].r]||(s[P[0].r]=[]),_=s[P[0].r][P[0].c]={t:"z"}):_=s[ft(P[0])]={t:"z"},c.e.r=Math.max(c.e.r,P[0].r),c.s.r=Math.min(c.s.r,P[0].r),c.e.c=Math.max(c.e.c,P[0].c),c.s.c=Math.min(c.s.c,P[0].c)),_.c||(_.c=[]),b={a:P[1],t:Ja.TxO.t},_.c.push(b)}break;case 2173:W6(X[P.ixfe],P.ext);break;case 125:{if(!Z.cellStyles)break;for(;P.e>=P.s;)G[P.e--]={width:P.w/256,level:P.level||0,hidden:!!(P.flags&1)},pe||(pe=!0,zm(P.w/256)),ri(G[P.e+1])}break;case 520:{var cr={};P.level!=null&&(ne[P.r]=cr,cr.level=P.level),P.hidden&&(ne[P.r]=cr,cr.hidden=!0),P.hpt&&(ne[P.r]=cr,cr.hpt=P.hpt,cr.hpx=so(P.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||Ui(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Ee]]=P;break;case 161:s["!margins"]||Ui(s["!margins"]={}),s["!margins"].header=P.header,s["!margins"].footer=P.footer;break;case 574:P.RTL&&(C.Views[0].RTL=!0);break;case 146:I=P;break;case 2198:xe=P;break;case 140:j=P;break;case 442:d?K.CodeName=P||K.name:C.WBProps.CodeName=P||"ThisWorkbook";break}}else Ae||console.error("Missing Info for XLS Record 0x"+Ee.toString(16)),e.l+=ye}return r.SheetNames=wr(l).sort(function(mr,gt){return Number(mr)-Number(gt)}).map(function(mr){return l[mr].name}),t.bookSheets||(r.Sheets=a),!r.SheetNames.length&&g["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=g)):r.Preamble=g,r.Sheets&&M.forEach(function(mr,gt){r.Sheets[r.SheetNames[gt]]["!autofilter"]=mr}),r.Strings=h,r.SSF=lr(ct),Z.enc&&(r.Encryption=Z.enc),xe&&(r.Themes=xe),r.Metadata={},j!==void 0&&(r.Metadata.Country=j),J.names.length>0&&(C.Names=J.names),r.Workbook=C,r}var _c={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function oF(e,t,r){var a=st.find(e,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var s=ay(a,Jd,_c.DSI);for(var l in s)t[l]=s[l]}catch(d){if(r.WTF)throw d}var c=st.find(e,"/!SummaryInformation");if(c&&c.size>0)try{var u=ay(c,Qd,_c.SI);for(var h in u)t[h]==null&&(t[h]=u[h])}catch(d){if(r.WTF)throw d}t.HeadingPairs&&t.TitlesOfParts&&(J_(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function cF(e,t){var r=[],a=[],s=[],l=0,c,u=Fv(Jd,"n"),h=Fv(Qd,"n");if(e.Props)for(c=wr(e.Props),l=0;l<c.length;++l)(Object.prototype.hasOwnProperty.call(u,c[l])?r:Object.prototype.hasOwnProperty.call(h,c[l])?a:s).push([c[l],e.Props[c[l]]]);if(e.Custprops)for(c=wr(e.Custprops),l=0;l<c.length;++l)Object.prototype.hasOwnProperty.call(e.Props||{},c[l])||(Object.prototype.hasOwnProperty.call(u,c[l])?r:Object.prototype.hasOwnProperty.call(h,c[l])?a:s).push([c[l],e.Custprops[c[l]]]);var d=[];for(l=0;l<s.length;++l)n2.indexOf(s[l][0])>-1||Y_.indexOf(s[l][0])>-1||s[l][1]!=null&&d.push(s[l]);a.length&&st.utils.cfb_add(t,"/SummaryInformation",ny(a,_c.SI,h,Qd)),(r.length||d.length)&&st.utils.cfb_add(t,"/DocumentSummaryInformation",ny(r,_c.DSI,u,Jd,d.length?d:null,_c.UDI))}function Z2(e,t){t||(t={}),Ym(t),xm(),t.codepage&&pm(t.codepage);var r,a;if(e.FullPaths){if(st.find(e,"/encryption"))throw new Error("File is password-protected");r=st.find(e,"!CompObj"),a=st.find(e,"/Workbook")||st.find(e,"/Book")}else{switch(t.type){case"base64":e=Xa(Ka(e));break;case"binary":e=Xa(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}ra(e,0),a={content:e}}var s,l;if(r&&nF(r),t.bookProps&&!t.bookSheets)s={};else{var c=wt?"buffer":"array";if(a&&a.content)s=lF(a.content,t);else if((l=st.find(e,"PerfectOffice_MAIN"))&&l.content)s=ji.to_workbook(l.content,(t.type=c,t));else if((l=st.find(e,"NativeContent_MAIN"))&&l.content)s=ji.to_workbook(l.content,(t.type=c,t));else throw(l=st.find(e,"MN0"))&&l.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&st.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=b8(e))}var u={};return e.FullPaths&&oF(e,u,t),s.Props=s.Custprops=u,t.bookFiles&&(s.cfb=e),s}function uF(e,t){var r=t||{},a=st.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return st.utils.cfb_add(a,s,ew(e,r)),r.biff==8&&(e.Props||e.Custprops)&&cF(e,a),r.biff==8&&e.vbaraw&&S8(a,st.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),a}var jc={0:{f:M5},1:{f:H5},2:{f:lR},3:{f:Y5},4:{f:q5},5:{f:nR},6:{f:hR},7:{f:eR},8:{f:yR},9:{f:vR},10:{f:pR},11:{f:xR},12:{f:V5},13:{f:cR},14:{f:Q5},15:{f:W5},16:{f:G2},17:{f:mR},18:{f:rR},19:{f:Rm},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:mD},40:{},42:{},43:{f:h6},44:{f:u6},45:{f:g6},46:{f:x6},47:{f:p6},48:{},49:{f:BA},50:{},51:{f:J6},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:g2},62:{f:fR},63:{f:i8},64:{f:LR},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:ma,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:RR},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:P5},148:{f:B5,p:16},151:{f:TR},152:{},153:{f:fD},154:{},155:{},156:{f:cD},157:{},158:{},159:{T:1,f:AN},160:{T:-1},161:{T:1,f:Ji},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:_R},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:K6},336:{T:-1},337:{f:e8,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Yd},357:{},358:{},359:{},360:{T:1},361:{},362:{f:m2},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:kR},427:{f:AR},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:NR},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:U5},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:SR},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Yd},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:x8},633:{T:1},634:{T:-1},635:{T:1,f:g8},636:{T:-1},637:{f:zA},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:QR},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:IR},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},nm={6:{f:Od},10:{f:Xs},12:{f:Lr},13:{f:Lr},14:{f:Tr},15:{f:Tr},16:{f:ha},17:{f:Tr},18:{f:Tr},19:{f:Lr},20:{f:uy},21:{f:uy},23:{f:m2},24:{f:hy},25:{f:Tr},26:{},27:{},28:{f:IC},29:{},34:{f:Tr},35:{f:fy},38:{f:ha},39:{f:ha},40:{f:ha},41:{f:ha},42:{f:Tr},43:{f:Tr},47:{f:WN},49:{f:cC},51:{f:Lr},60:{},61:{f:nC},64:{f:Tr},65:{f:oC},66:{f:Lr},77:{},80:{},81:{},82:{},85:{f:Lr},89:{},90:{},91:{},92:{f:X3},93:{f:UC},94:{},95:{f:Tr},96:{},97:{},99:{f:Tr},125:{f:g2},128:{f:EC},129:{f:K3},130:{f:Lr},131:{f:Tr},132:{f:Tr},133:{f:Y3},134:{},140:{f:XC},141:{f:Lr},144:{},146:{f:YC},151:{},152:{},153:{},154:{},155:{},156:{f:Lr},157:{},158:{},160:{f:aN},161:{f:ZC},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:_C},190:{f:wC},193:{f:Xs},197:{},198:{},199:{},200:{},201:{},202:{f:Tr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Lr},220:{},221:{f:Tr},222:{},224:{f:SC},225:{f:q3},226:{f:Xs},227:{},229:{f:BC},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:Q3},253:{f:fC},255:{f:eC},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:s2},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Tr},353:{f:Xs},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:NC},431:{f:Tr},432:{},433:{},434:{},437:{},438:{f:HC},439:{f:Tr},440:{f:$C},441:{},442:{f:Xc},443:{},444:{f:Lr},445:{},446:{},448:{f:Xs},449:{f:aC,r:2},450:{f:Xs},512:{f:ly},513:{f:rN},515:{f:AC},516:{f:dC},517:{f:cy},519:{f:nN},520:{f:tC},523:{},545:{f:dy},549:{f:iy},566:{},574:{f:iC},638:{f:yC},659:{},1048:{},1054:{f:gC},1084:{},1212:{f:FC},2048:{f:GC},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:wu},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Xs},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:JC,r:12},2173:{f:X6,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Tr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:DC,r:12},2197:{},2198:{f:z6,r:12},2199:{},2200:{},2201:{},2202:{f:MC,r:12},2203:{f:Xs},2204:{},2205:{},2206:{},2207:{},2211:{f:rC},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Lr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:eN},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:KC},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:ly},1:{},2:{f:cN},3:{f:lN},4:{f:iN},5:{f:cy},7:{f:fN},8:{},9:{f:wu},11:{},22:{f:Lr},30:{f:xC},31:{},32:{},33:{f:dy},36:{},37:{f:iy},50:{f:hN},62:{},52:{},67:{},68:{f:Lr},69:{},86:{},126:{},127:{f:sN},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:dN},223:{},234:{},354:{},421:{},518:{f:Od},521:{f:wu},536:{f:hy},547:{f:fy},561:{},579:{},1030:{f:Od},1033:{f:wu},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Le(e,t,r,a){var s=t;if(!isNaN(s)){var l=a||(r||[]).length||0,c=e.next(4);c.write_shift(2,s),c.write_shift(2,l),l>0&&Cm(r)&&e.push(r)}}function fF(e,t,r,a){var s=(r||[]).length||0;if(s<=8224)return Le(e,t,r,s);var l=t;if(!isNaN(l)){for(var c=r.parts||[],u=0,h=0,d=0;d+(c[u]||8224)<=8224;)d+=c[u]||8224,u++;var g=e.next(4);for(g.write_shift(2,l),g.write_shift(2,d),e.push(r.slice(h,h+d)),h+=d;h<s;){for(g=e.next(4),g.write_shift(2,60),d=0;d+(c[u]||8224)<=8224;)d+=c[u]||8224,u++;g.write_shift(2,d),e.push(r.slice(h,h+d)),h+=d}}}function Jc(e,t,r){return e||(e=ve(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function hF(e,t,r,a){var s=ve(9);return Jc(s,e,t),i2(r,a||"b",s),s}function dF(e,t,r){var a=ve(8+2*r.length);return Jc(a,e,t),a.write_shift(1,r.length),a.write_shift(r.length,r,"sbcs"),a.l<a.length?a.slice(0,a.l):a}function mF(e,t,r,a){if(t.v!=null)switch(t.t){case"d":case"n":var s=t.t=="d"?Pr(ir(t.v)):t.v;s==(s|0)&&s>=0&&s<65536?Le(e,2,uN(r,a,s)):Le(e,3,oN(r,a,s));return;case"b":case"e":Le(e,5,hF(r,a,t.v,t.t));return;case"s":case"str":Le(e,4,dF(r,a,(t.v||"").slice(0,255)));return}Le(e,1,Jc(null,r,a))}function gF(e,t,r,a){var s=Array.isArray(t),l=Ft(t["!ref"]||"A1"),c,u="",h=[];if(l.e.c>255||l.e.r>16383){if(a.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");l.e.c=Math.min(l.e.c,255),l.e.r=Math.min(l.e.c,16383),c=vt(l)}for(var d=l.s.r;d<=l.e.r;++d){u=kr(d);for(var g=l.s.c;g<=l.e.c;++g){d===l.s.r&&(h[g]=hr(g)),c=h[g]+u;var x=s?(t[d]||[])[g]:t[c];x&&mF(e,x,d,g)}}}function pF(e,t){for(var r=t||{},a=Da(),s=0,l=0;l<e.SheetNames.length;++l)e.SheetNames[l]==r.sheet&&(s=l);if(s==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Le(a,r.biff==4?1033:r.biff==3?521:9,jm(e,16,r)),gF(a,e.Sheets[e.SheetNames[s]],s,r),Le(a,10),a.end()}function xF(e,t,r){Le(e,49,uC({sz:12,name:"Arial"},r))}function vF(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var s=a[0];s<=a[1];++s)t[s]!=null&&Le(e,1054,pC(s,t[s],r))})}function yF(e,t){var r=ve(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Le(e,2151,r),r=ve(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),f2(Ft(t["!ref"]||"A1"),r),r.write_shift(4,4),Le(e,2152,r)}function _F(e,t){for(var r=0;r<16;++r)Le(e,224,oy({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(a){Le(e,224,oy(a,0,t))})}function wF(e,t){for(var r=0;r<t["!links"].length;++r){var a=t["!links"][r];Le(e,440,VC(a)),a[1].Tooltip&&Le(e,2048,qC(a))}delete t["!links"]}function bF(e,t){if(t){var r=0;t.forEach(function(a,s){++r<=256&&a&&Le(e,125,QC(rf(s,a),s))})}}function SF(e,t,r,a,s){var l=16+oi(s.cellXfs,t,s);if(t.v==null&&!t.bf){Le(e,513,Vi(r,a,l));return}if(t.bf)Le(e,6,KO(t,r,a,s,l));else switch(t.t){case"d":case"n":var c=t.t=="d"?Pr(ir(t.v)):t.v;Le(e,515,CC(r,a,c,l));break;case"b":case"e":Le(e,517,kC(r,a,t.v,l,s,t.t));break;case"s":case"str":if(s.bookSST){var u=qm(s.Strings,t.v,s.revStrings);Le(e,253,hC(r,a,u,l))}else Le(e,516,mC(r,a,(t.v||"").slice(0,255),l,s));break;default:Le(e,513,Vi(r,a,l))}}function EF(e,t,r){var a=Da(),s=r.SheetNames[e],l=r.Sheets[s]||{},c=(r||{}).Workbook||{},u=(c.Sheets||[])[e]||{},h=Array.isArray(l),d=t.biff==8,g,x="",v=[],_=Ft(l["!ref"]||"A1"),b=d?65536:16384;if(_.e.c>255||_.e.r>=b){if(t.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:IV16384");_.e.c=Math.min(_.e.c,255),_.e.r=Math.min(_.e.c,b-1)}Le(a,2057,jm(r,16,t)),Le(a,13,hn(1)),Le(a,12,hn(100)),Le(a,15,ya(!0)),Le(a,17,ya(!1)),Le(a,16,Hi(.001)),Le(a,95,ya(!0)),Le(a,42,ya(!1)),Le(a,43,ya(!1)),Le(a,130,hn(1)),Le(a,128,TC()),Le(a,131,ya(!1)),Le(a,132,ya(!1)),d&&bF(a,l["!cols"]),Le(a,512,vC(_,t)),d&&(l["!links"]=[]);for(var y=_.s.r;y<=_.e.r;++y){x=kr(y);for(var S=_.s.c;S<=_.e.c;++S){y===_.s.r&&(v[S]=hr(S)),g=v[S]+x;var k=h?(l[y]||[])[S]:l[g];k&&(SF(a,k,y,S,t),d&&k.l&&l["!links"].push([g,k.l]))}}var O=u.CodeName||u.name||s;return d&&Le(a,574,lC((c.Views||[])[0])),d&&(l["!merges"]||[]).length&&Le(a,229,jC(l["!merges"])),d&&wF(a,l),Le(a,442,l2(O)),d&&yF(a,l),Le(a,10),a.end()}function TF(e,t,r){var a=Da(),s=(e||{}).Workbook||{},l=s.Sheets||[],c=s.WBProps||{},u=r.biff==8,h=r.biff==5;if(Le(a,2057,jm(e,5,r)),r.bookType=="xla"&&Le(a,135),Le(a,225,u?hn(1200):null),Le(a,193,k3(2)),h&&Le(a,191),h&&Le(a,192),Le(a,226),Le(a,92,W3("SheetJS",r)),Le(a,66,hn(u?1200:1252)),u&&Le(a,353,hn(0)),u&&Le(a,448),Le(a,317,tN(e.SheetNames.length)),u&&e.vbaraw&&Le(a,211),u&&e.vbaraw){var d=c.CodeName||"ThisWorkbook";Le(a,442,l2(d))}Le(a,156,hn(17)),Le(a,25,ya(!1)),Le(a,18,ya(!1)),Le(a,19,hn(0)),u&&Le(a,431,ya(!1)),u&&Le(a,444,hn(0)),Le(a,61,sC()),Le(a,64,ya(!1)),Le(a,141,hn(0)),Le(a,34,ya(aD(e)=="true")),Le(a,14,ya(!0)),u&&Le(a,439,ya(!1)),Le(a,218,hn(0)),xF(a,e,r),vF(a,e.SSF,r),_F(a,r),u&&Le(a,352,ya(!1));var g=a.end(),x=Da();u&&Le(x,140,WC()),u&&r.Strings&&fF(x,252,Z3(r.Strings)),Le(x,10);var v=x.end(),_=Da(),b=0,y=0;for(y=0;y<e.SheetNames.length;++y)b+=(u?12:11)+(u?2:1)*e.SheetNames[y].length;var S=g.length+b+v.length;for(y=0;y<e.SheetNames.length;++y){var k=l[y]||{};Le(_,133,J3({pos:S,hs:k.Hidden||0,dt:0,name:e.SheetNames[y]},r)),S+=t[y].length}var O=_.end();if(b!=O.length)throw new Error("BS8 "+b+" != "+O.length);var T=[];return g.length&&T.push(g),O.length&&T.push(O),v.length&&T.push(v),Gr(T)}function kF(e,t){var r=t||{},a=[];e&&!e.SSF&&(e.SSF=lr(ct)),e&&e.SSF&&(oo(),Ku(e.SSF),r.revssf=Ju(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Jm(r),r.cellXfs=[],oi(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)a[a.length]=EF(s,r,e);return a.unshift(TF(e,a,r)),Gr(a)}function ew(e,t){for(var r=0;r<=e.SheetNames.length;++r){var a=e.Sheets[e.SheetNames[r]];if(!(!a||!a["!ref"])){var s=Fa(a["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var l=t||{};switch(l.biff||2){case 8:case 5:return kF(e,t);case 4:case 3:case 2:return pF(e,t)}throw new Error("invalid type "+l.bookType+" for BIFF")}function Sy(e,t){var r=t||{},a=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var l=e.match(/<\/table/i),c=s.index,u=l&&l.index||e.length,h=uA(e.slice(c,u),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,g=0,x=0,v=0,_={s:{r:1e7,c:1e7},e:{r:0,c:0}},b=[];for(c=0;c<h.length;++c){var y=h[c].trim(),S=y.slice(0,3).toLowerCase();if(S=="<tr"){if(++d,r.sheetRows&&r.sheetRows<=d){--d;break}g=0;continue}if(!(S!="<td"&&S!="<th")){var k=y.split(/<\/t[dh]>/i);for(u=0;u<k.length;++u){var O=k[u].trim();if(O.match(/<t[dh]/i)){for(var T=O,j=0;T.charAt(0)=="<"&&(j=T.indexOf(">"))>-1;)T=T.slice(j+1);for(var X=0;X<b.length;++X){var I=b[X];I.s.c==g&&I.s.r<d&&d<=I.e.r&&(g=I.e.c+1,X=-1)}var C=ht(O.slice(0,O.indexOf(">")));v=C.colspan?+C.colspan:1,((x=+C.rowspan)>1||v>1)&&b.push({s:{r:d,c:g},e:{r:d+(x||1)-1,c:g+v-1}});var K=C.t||C["data-t"]||"";if(!T.length){g+=v;continue}if(T=E_(T),_.s.r>d&&(_.s.r=d),_.e.r<d&&(_.e.r=d),_.s.c>g&&(_.s.c=g),_.e.c<g&&(_.e.c=g),!T.length){g+=v;continue}var q={t:"s",v:T};r.raw||!T.trim().length||K=="s"||(T==="TRUE"?q={t:"b",v:!0}:T==="FALSE"?q={t:"b",v:!1}:isNaN(An(T))?isNaN(ao(T).getDate())||(q={t:"d",v:ir(T)},r.cellDates||(q={t:"n",v:Pr(q.v)}),q.z=r.dateNF||ct[14]):q={t:"n",v:An(T)}),r.dense?(a[d]||(a[d]=[]),a[d][g]=q):a[ft({r:d,c:g})]=q,g+=v}}}}return a["!ref"]=vt(_),b.length&&(a["!merges"]=b),a}function AF(e,t,r,a){for(var s=e["!merges"]||[],l=[],c=t.s.c;c<=t.e.c;++c){for(var u=0,h=0,d=0;d<s.length;++d)if(!(s[d].s.r>r||s[d].s.c>c)&&!(s[d].e.r<r||s[d].e.c<c)){if(s[d].s.r<r||s[d].s.c<c){u=-1;break}u=s[d].e.r-s[d].s.r+1,h=s[d].e.c-s[d].s.c+1;break}if(!(u<0)){var g=ft({r,c}),x=a.dense?(e[r]||[])[c]:e[g],v=x&&x.v!=null&&(x.h||Tm(x.w||(ds(x),x.w)||""))||"",_={};u>1&&(_.rowspan=u),h>1&&(_.colspan=h),a.editable?v='<span contenteditable="true">'+v+"</span>":x&&(_["data-t"]=x&&x.t||"z",x.v!=null&&(_["data-v"]=x.v),x.z!=null&&(_["data-z"]=x.z),x.l&&(x.l.Target||"#").charAt(0)!="#"&&(v='<a href="'+x.l.Target+'">'+v+"</a>")),_.id=(a.id||"sjs")+"-"+g,l.push(Me("td",v,_))}}var b="<tr>";return b+l.join("")+"</tr>"}var CF='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',NF="</body></html>";function OF(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return li(Sy(r[0],t),t);var a=e1();return r.forEach(function(s,l){t1(a,Sy(s,t),"Sheet"+(l+1))}),a}function RF(e,t,r){var a=[];return a.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function tw(e,t){var r=t||{},a=r.header!=null?r.header:CF,s=r.footer!=null?r.footer:NF,l=[a],c=Fa(e["!ref"]);r.dense=Array.isArray(e),l.push(RF(e,c,r));for(var u=c.s.r;u<=c.e.r;++u)l.push(AF(e,c,u,r));return l.push("</table>"+s),l.join("")}function rw(e,t,r){var a=r||{},s=0,l=0;if(a.origin!=null)if(typeof a.origin=="number")s=a.origin;else{var c=typeof a.origin=="string"?dr(a.origin):a.origin;s=c.r,l=c.c}var u=t.getElementsByTagName("tr"),h=Math.min(a.sheetRows||1e7,u.length),d={s:{r:0,c:0},e:{r:s,c:l}};if(e["!ref"]){var g=Fa(e["!ref"]);d.s.r=Math.min(d.s.r,g.s.r),d.s.c=Math.min(d.s.c,g.s.c),d.e.r=Math.max(d.e.r,g.e.r),d.e.c=Math.max(d.e.c,g.e.c),s==-1&&(d.e.r=s=g.e.r+1)}var x=[],v=0,_=e["!rows"]||(e["!rows"]=[]),b=0,y=0,S=0,k=0,O=0,T=0;for(e["!cols"]||(e["!cols"]=[]);b<u.length&&y<h;++b){var j=u[b];if(Ey(j)){if(a.display)continue;_[y]={hidden:!0}}var X=j.children;for(S=k=0;S<X.length;++S){var I=X[S];if(!(a.display&&Ey(I))){var C=I.hasAttribute("data-v")?I.getAttribute("data-v"):I.hasAttribute("v")?I.getAttribute("v"):E_(I.innerHTML),K=I.getAttribute("data-z")||I.getAttribute("z");for(v=0;v<x.length;++v){var q=x[v];q.s.c==k+l&&q.s.r<y+s&&y+s<=q.e.r&&(k=q.e.c+1-l,v=-1)}T=+I.getAttribute("colspan")||1,((O=+I.getAttribute("rowspan")||1)>1||T>1)&&x.push({s:{r:y+s,c:k+l},e:{r:y+s+(O||1)-1,c:k+l+(T||1)-1}});var oe={t:"s",v:C},ee=I.getAttribute("data-t")||I.getAttribute("t")||"";C!=null&&(C.length==0?oe.t=ee||"z":a.raw||C.trim().length==0||ee=="s"||(C==="TRUE"?oe={t:"b",v:!0}:C==="FALSE"?oe={t:"b",v:!1}:isNaN(An(C))?isNaN(ao(C).getDate())||(oe={t:"d",v:ir(C)},a.cellDates||(oe={t:"n",v:Pr(oe.v)}),oe.z=a.dateNF||ct[14]):oe={t:"n",v:An(C)})),oe.z===void 0&&K!=null&&(oe.z=K);var Z="",xe=I.getElementsByTagName("A");if(xe&&xe.length)for(var Ce=0;Ce<xe.length&&!(xe[Ce].hasAttribute("href")&&(Z=xe[Ce].getAttribute("href"),Z.charAt(0)!="#"));++Ce);Z&&Z.charAt(0)!="#"&&(oe.l={Target:Z}),a.dense?(e[y+s]||(e[y+s]=[]),e[y+s][k+l]=oe):e[ft({c:k+l,r:y+s})]=oe,d.e.c<k+l&&(d.e.c=k+l),k+=T}}++y}return x.length&&(e["!merges"]=(e["!merges"]||[]).concat(x)),d.e.r=Math.max(d.e.r,y-1+s),e["!ref"]=vt(d),y>=h&&(e["!fullref"]=vt((d.e.r=u.length-b+y-1+s,d))),e}function aw(e,t){var r=t||{},a=r.dense?[]:{};return rw(a,e,t)}function DF(e,t){return li(aw(e,t),t)}function Ey(e){var t="",r=FF(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function FF(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function MF(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(a,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Dt(t.replace(/<[^>]*>/g,""));return[r]}var Ty={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function nw(e,t){var r=t||{},a=km(e),s=[],l,c,u={name:""},h="",d=0,g,x,v={},_=[],b=r.dense?[]:{},y,S,k={value:""},O="",T=0,j=[],X=-1,I=-1,C={s:{r:1e6,c:1e7},e:{r:0,c:0}},K=0,q={},oe=[],ee={},Z=0,xe=0,Ce=[],Se=1,G=1,ne=[],pe={Names:[]},J={},be=["",""],L=[],N={},V="",M=0,z=!1,te=!1,ge=0;for(Dc.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");y=Dc.exec(a);)switch(y[3]=y[3].replace(/_.*$/,"")){case"table":case"":y[1]==="/"?(C.e.c>=C.s.c&&C.e.r>=C.s.r?b["!ref"]=vt(C):b["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=C.e.r&&(b["!fullref"]=b["!ref"],C.e.r=r.sheetRows-1,b["!ref"]=vt(C)),oe.length&&(b["!merges"]=oe),Ce.length&&(b["!rows"]=Ce),g.name=g.||g.name,typeof JSON<"u"&&JSON.stringify(g),_.push(g.name),v[g.name]=b,te=!1):y[0].charAt(y[0].length-2)!=="/"&&(g=ht(y[0],!1),X=I=-1,C.s.r=C.s.c=1e7,C.e.r=C.e.c=0,b=r.dense?[]:{},oe=[],Ce=[],te=!0);break;case"table-row-group":y[1]==="/"?--K:++K;break;case"table-row":case"":if(y[1]==="/"){X+=Se,Se=1;break}if(x=ht(y[0],!1),x.?X=x.-1:X==-1&&(X=0),Se=+x["number-rows-repeated"]||1,Se<10)for(ge=0;ge<Se;++ge)K>0&&(Ce[X+ge]={level:K});I=-1;break;case"covered-table-cell":y[1]!=="/"&&++I,r.sheetStubs&&(r.dense?(b[X]||(b[X]=[]),b[X][I]={t:"z"}):b[ft({r:X,c:I})]={t:"z"}),O="",j=[];break;case"table-cell":case"":if(y[0].charAt(y[0].length-2)==="/")++I,k=ht(y[0],!1),G=parseInt(k["number-columns-repeated"]||"1",10),S={t:"z",v:null},k.formula&&r.cellFormula!=!1&&(S.f=_y(Dt(k.formula))),(k.||k["value-type"])=="string"&&(S.t="s",S.v=Dt(k["string-value"]||""),r.dense?(b[X]||(b[X]=[]),b[X][I]=S):b[ft({r:X,c:I})]=S),I+=G-1;else if(y[1]!=="/"){++I,O="",T=0,j=[],G=1;var Ee=Se?X+Se-1:X;if(I>C.e.c&&(C.e.c=I),I<C.s.c&&(C.s.c=I),X<C.s.r&&(C.s.r=X),Ee>C.e.r&&(C.e.r=Ee),k=ht(y[0],!1),L=[],N={},S={t:k.||k["value-type"],v:null},r.cellFormula)if(k.formula&&(k.formula=Dt(k.formula)),k["number-matrix-columns-spanned"]&&k["number-matrix-rows-spanned"]&&(Z=parseInt(k["number-matrix-rows-spanned"],10)||0,xe=parseInt(k["number-matrix-columns-spanned"],10)||0,ee={s:{r:X,c:I},e:{r:X+Z-1,c:I+xe-1}},S.F=vt(ee),ne.push([ee,S.F])),k.formula)S.f=_y(k.formula);else for(ge=0;ge<ne.length;++ge)X>=ne[ge][0].s.r&&X<=ne[ge][0].e.r&&I>=ne[ge][0].s.c&&I<=ne[ge][0].e.c&&(S.F=ne[ge][1]);switch((k["number-columns-spanned"]||k["number-rows-spanned"])&&(Z=parseInt(k["number-rows-spanned"],10)||0,xe=parseInt(k["number-columns-spanned"],10)||0,ee={s:{r:X,c:I},e:{r:X+Z-1,c:I+xe-1}},oe.push(ee)),k["number-columns-repeated"]&&(G=parseInt(k["number-columns-repeated"],10)),S.t){case"boolean":S.t="b",S.v=sr(k["boolean-value"]);break;case"float":S.t="n",S.v=parseFloat(k.value);break;case"percentage":S.t="n",S.v=parseFloat(k.value);break;case"currency":S.t="n",S.v=parseFloat(k.value);break;case"date":S.t="d",S.v=ir(k["date-value"]),r.cellDates||(S.t="n",S.v=Pr(S.v)),S.z="m/d/yy";break;case"time":S.t="n",S.v=lA(k["time-value"])/86400,r.cellDates&&(S.t="d",S.v=Qu(S.v)),S.z="HH:MM:SS";break;case"number":S.t="n",S.v=parseFloat(k.);break;default:if(S.t==="string"||S.t==="text"||!S.t)S.t="s",k["string-value"]!=null&&(O=Dt(k["string-value"]),j=[]);else throw new Error("Unsupported value type "+S.t)}}else{if(z=!1,S.t==="s"&&(S.v=O||"",j.length&&(S.R=j),z=T==0),J.Target&&(S.l=J),L.length>0&&(S.c=L,L=[]),O&&r.cellText!==!1&&(S.w=O),z&&(S.t="z",delete S.v),(!z||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=X))for(var ye=0;ye<Se;++ye){if(G=parseInt(k["number-columns-repeated"]||"1",10),r.dense)for(b[X+ye]||(b[X+ye]=[]),b[X+ye][I]=ye==0?S:lr(S);--G>0;)b[X+ye][I+G]=lr(S);else for(b[ft({r:X+ye,c:I})]=S;--G>0;)b[ft({r:X+ye,c:I+G})]=lr(S);C.e.c<=I&&(C.e.c=I)}G=parseInt(k["number-columns-repeated"]||"1",10),I+=G-1,G=0,S={},O="",j=[]}J={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(y[1]==="/"){if((l=s.pop())[0]!==y[3])throw"Bad state: "+l}else y[0].charAt(y[0].length-2)!=="/"&&s.push([y[3],!0]);break;case"annotation":if(y[1]==="/"){if((l=s.pop())[0]!==y[3])throw"Bad state: "+l;N.t=O,j.length&&(N.R=j),N.a=V,L.push(N)}else y[0].charAt(y[0].length-2)!=="/"&&s.push([y[3],!1]);V="",M=0,O="",T=0,j=[];break;case"creator":y[1]==="/"?V=a.slice(M,y.index):M=y.index+y[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(y[1]==="/"){if((l=s.pop())[0]!==y[3])throw"Bad state: "+l}else y[0].charAt(y[0].length-2)!=="/"&&s.push([y[3],!1]);O="",T=0,j=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(y[1]==="/"){if(q[u.name]=h,(l=s.pop())[0]!==y[3])throw"Bad state: "+l}else y[0].charAt(y[0].length-2)!=="/"&&(h="",u=ht(y[0],!1),s.push([y[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":c=ht(y[0],!1),h+=Ty[y[3]][c.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":c=ht(y[0],!1),h+=Ty[y[3]][c.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(y[0].slice(-2)==="/>")break;if(y[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":h+=a.slice(d,y.index);break}else d=y.index+y[0].length;break;case"named-range":c=ht(y[0],!1),be=Rd(c["cell-range-address"]);var Ae={Name:c.name,Ref:be[0]+"!"+be[1]};te&&(Ae.Sheet=_.length),pe.Names.push(Ae);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(y[1]==="/"&&(!k||!k["string-value"])){var tt=MF(a.slice(T,y.index));O=(O.length>0?O+`
`:"")+tt[0]}else ht(y[0],!1),T=y.index+y[0].length;break;case"s":break;case"database-range":if(y[1]==="/")break;try{be=Rd(ht(y[0])["target-range-address"]),v[be[0]]["!autofilter"]={ref:be[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(y[1]!=="/"){if(J=ht(y[0],!1),!J.href)break;J.Target=Dt(J.href),delete J.href,J.Target.charAt(0)=="#"&&J.Target.indexOf(".")>-1?(be=Rd(J.Target.slice(1)),J.Target="#"+be[0]+"!"+be[1]):J.Target.match(/^\.\.[\\\/]/)&&(J.Target=J.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(y[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(y)}}var P={Sheets:v,SheetNames:_,Workbook:pe};return r.bookSheets&&delete P.Sheets,P}function ky(e,t){t=t||{},fn(e,"META-INF/manifest.xml")&&l3(Mr(e,"META-INF/manifest.xml"),t);var r=Wa(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var a=nw(Jt(r),t);return fn(e,"meta.xml")&&(a.Props=W_(Mr(e,"meta.xml"))),a}function Ay(e,t){return nw(e,t)}var LF=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Rc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Ar+t}})(),Cy=(function(){var e=function(l){return $t(l).replace(/  +/g,function(c){return'<text:s text:c="'+c.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,a=function(l,c,u){var h=[];h.push('      <table:table table:name="'+$t(c.SheetNames[u])+`" table:style-name="ta1">
`);var d=0,g=0,x=Fa(l["!ref"]||"A1"),v=l["!merges"]||[],_=0,b=Array.isArray(l);if(l["!cols"])for(g=0;g<=x.e.c;++g)h.push("        <table:table-column"+(l["!cols"][g]?' table:style-name="co'+l["!cols"][g].ods+'"':"")+`></table:table-column>
`);var y="",S=l["!rows"]||[];for(d=0;d<x.s.r;++d)y=S[d]?' table:style-name="ro'+S[d].ods+'"':"",h.push("        <table:table-row"+y+`></table:table-row>
`);for(;d<=x.e.r;++d){for(y=S[d]?' table:style-name="ro'+S[d].ods+'"':"",h.push("        <table:table-row"+y+`>
`),g=0;g<x.s.c;++g)h.push(t);for(;g<=x.e.c;++g){var k=!1,O={},T="";for(_=0;_!=v.length;++_)if(!(v[_].s.c>g)&&!(v[_].s.r>d)&&!(v[_].e.c<g)&&!(v[_].e.r<d)){(v[_].s.c!=g||v[_].s.r!=d)&&(k=!0),O["table:number-columns-spanned"]=v[_].e.c-v[_].s.c+1,O["table:number-rows-spanned"]=v[_].e.r-v[_].s.r+1;break}if(k){h.push(r);continue}var j=ft({r:d,c:g}),X=b?(l[d]||[])[g]:l[j];if(X&&X.f&&(O["table:formula"]=$t(t5(X.f)),X.F&&X.F.slice(0,j.length)==j)){var I=Fa(X.F);O["table:number-matrix-columns-spanned"]=I.e.c-I.s.c+1,O["table:number-matrix-rows-spanned"]=I.e.r-I.s.r+1}if(!X){h.push(t);continue}switch(X.t){case"b":T=X.v?"TRUE":"FALSE",O["office:value-type"]="boolean",O["office:boolean-value"]=X.v?"true":"false";break;case"n":T=X.w||String(X.v||0),O["office:value-type"]="float",O["office:value"]=X.v||0;break;case"s":case"str":T=X.v==null?"":X.v,O["office:value-type"]="string";break;case"d":T=X.w||ir(X.v).toISOString(),O["office:value-type"]="date",O["office:date-value"]=ir(X.v).toISOString(),O["table:style-name"]="ce1";break;default:h.push(t);continue}var C=e(T);if(X.l&&X.l.Target){var K=X.l.Target;K=K.charAt(0)=="#"?"#"+r5(K.slice(1)):K,K.charAt(0)!="#"&&!K.match(/^\w+:/)&&(K="../"+K),C=Me("text:a",C,{"xlink:href":K.replace(/&/g,"&amp;")})}h.push("          "+Me("table:table-cell",Me("text:p",C,{}),O)+`
`)}h.push(`        </table:table-row>
`)}return h.push(`      </table:table>
`),h.join("")},s=function(l,c){l.push(` <office:automatic-styles>
`),l.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),l.push(`   <number:month number:style="long"/>
`),l.push(`   <number:text>/</number:text>
`),l.push(`   <number:day number:style="long"/>
`),l.push(`   <number:text>/</number:text>
`),l.push(`   <number:year/>
`),l.push(`  </number:date-style>
`);var u=0;c.SheetNames.map(function(d){return c.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var g=0;g<d["!cols"].length;++g)if(d["!cols"][g]){var x=d["!cols"][g];if(x.width==null&&x.wpx==null&&x.wch==null)continue;ri(x),x.ods=u;var v=d["!cols"][g].wpx+"px";l.push('  <style:style style:name="co'+u+`" style:family="table-column">
`),l.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+v+`"/>
`),l.push(`  </style:style>
`),++u}}});var h=0;c.SheetNames.map(function(d){return c.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var g=0;g<d["!rows"].length;++g)if(d["!rows"][g]){d["!rows"][g].ods=h;var x=d["!rows"][g].hpx+"px";l.push('  <style:style style:name="ro'+h+`" style:family="table-row">
`),l.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+x+`"/>
`),l.push(`  </style:style>
`),++h}}}),l.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),l.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),l.push(`  </style:style>
`),l.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),l.push(` </office:automatic-styles>
`)};return function(c,u){var h=[Ar],d=Rc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),g=Rc({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});u.bookType=="fods"?(h.push("<office:document"+d+g+`>
`),h.push(X_().replace(/office:document-meta/g,"office:meta"))):h.push("<office:document-content"+d+`>
`),s(h,c),h.push(`  <office:body>
`),h.push(`    <office:spreadsheet>
`);for(var x=0;x!=c.SheetNames.length;++x)h.push(a(c.Sheets[c.SheetNames[x]],c,x));return h.push(`    </office:spreadsheet>
`),h.push(`  </office:body>
`),u.bookType=="fods"?h.push("</office:document>"):h.push("</office:document-content>"),h.join("")}})();function sw(e,t){if(t.bookType=="fods")return Cy(e,t);var r=bm(),a="",s=[],l=[];return a="mimetype",_t(r,a,"application/vnd.oasis.opendocument.spreadsheet"),a="content.xml",_t(r,a,Cy(e,t)),s.push([a,"text/xml"]),l.push([a,"ContentFile"]),a="styles.xml",_t(r,a,LF(e,t)),s.push([a,"text/xml"]),l.push([a,"StylesFile"]),a="meta.xml",_t(r,a,Ar+X_()),s.push([a,"text/xml"]),l.push([a,"MetadataFile"]),a="manifest.rdf",_t(r,a,u3(l)),s.push([a,"application/rdf+xml"]),a="META-INF/manifest.xml",_t(r,a,o3(s)),r}function Gi(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function sm(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Jt(ii(e))}function IF(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Xa(Un(e))}function BF(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var a=0;a<t.length;++a)if(e[r+a]!=t[a])continue e;return!0}return!1}function ni(e){var t=e.reduce(function(s,l){return s+l.length},0),r=new Uint8Array(t),a=0;return e.forEach(function(s){r.set(s,a),a+=s.length}),r}function Ny(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function jF(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,a=e[t+14]&1,s=t+13;s>=t;--s)a=a*256+e[s];return(e[t+15]&128?-a:a)*Math.pow(10,r-6176)}function UF(e,t,r){var a=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,a-6176);e[t+15]|=a>>7,e[t+14]|=(a&127)<<1;for(var l=0;s>=1;++l,s/=256)e[t+l]=s&255;e[t+15]|=r>=0?0:128}function Uc(e,t){var r=t?t[0]:0,a=e[r]&127;e:if(e[r++]>=128&&(a|=(e[r]&127)<<7,e[r++]<128||(a|=(e[r]&127)<<14,e[r++]<128)||(a|=(e[r]&127)<<21,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),a}function zt(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function _r(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Bt(e){for(var t=[],r=[0];r[0]<e.length;){var a=r[0],s=Uc(e,r),l=s&7;s=Math.floor(s/8);var c=0,u;if(s==0)break;switch(l){case 0:{for(var h=r[0];e[r[0]++]>=128;);u=e.slice(h,r[0])}break;case 5:c=4,u=e.slice(r[0],r[0]+c),r[0]+=c;break;case 1:c=8,u=e.slice(r[0],r[0]+c),r[0]+=c;break;case 2:c=Uc(e,r),u=e.slice(r[0],r[0]+c),r[0]+=c;break;default:throw new Error("PB Type ".concat(l," for Field ").concat(s," at offset ").concat(a))}var d={data:u,type:l};t[s]==null?t[s]=[d]:t[s].push(d)}return t}function ta(e){var t=[];return e.forEach(function(r,a){r.forEach(function(s){s.data&&(t.push(zt(a*8+s.type)),s.type==2&&t.push(zt(s.data.length)),t.push(s.data))})}),ni(t)}function Km(e,t){return e?.map(function(r){return t(r.data)})||[]}function cn(e){for(var t,r=[],a=[0];a[0]<e.length;){var s=Uc(e,a),l=Bt(e.slice(a[0],a[0]+s));a[0]+=s;var c={id:_r(l[1][0].data),messages:[]};l[2].forEach(function(u){var h=Bt(u.data),d=_r(h[3][0].data);c.messages.push({meta:h,data:e.slice(a[0],a[0]+d)}),a[0]+=d}),(t=l[3])!=null&&t[0]&&(c.merge=_r(l[3][0].data)>>>0>0),r.push(c)}return r}function Hl(e){var t=[];return e.forEach(function(r){var a=[];a[1]=[{data:zt(r.id),type:0}],a[2]=[],r.merge!=null&&(a[3]=[{data:zt(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(c){s.push(c.data),c.meta[3]=[{type:0,data:zt(c.data.length)}],a[2].push({data:ta(c.meta),type:2})});var l=ta(a);t.push(zt(l.length)),t.push(l),s.forEach(function(c){return t.push(c)})}),ni(t)}function PF(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],a=Uc(t,r),s=[];r[0]<t.length;){var l=t[r[0]]&3;if(l==0){var c=t[r[0]++]>>2;if(c<60)++c;else{var u=c-59;c=t[r[0]],u>1&&(c|=t[r[0]+1]<<8),u>2&&(c|=t[r[0]+2]<<16),u>3&&(c|=t[r[0]+3]<<24),c>>>=0,c++,r[0]+=u}s.push(t.slice(r[0],r[0]+c)),r[0]+=c;continue}else{var h=0,d=0;if(l==1?(d=(t[r[0]]>>2&7)+4,h=(t[r[0]++]&224)<<3,h|=t[r[0]++]):(d=(t[r[0]++]>>2)+1,l==2?(h=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(h=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[ni(s)],h==0)throw new Error("Invalid offset 0");if(h>s[0].length)throw new Error("Invalid offset beyond length");if(d>=h)for(s.push(s[0].slice(-h)),d-=h;d>=s[s.length-1].length;)s.push(s[s.length-1]),d-=s[s.length-1].length;s.push(s[0].slice(-h,-h+d))}}var g=ni(s);if(g.length!=a)throw new Error("Unexpected length: ".concat(g.length," != ").concat(a));return g}function un(e){for(var t=[],r=0;r<e.length;){var a=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(PF(a,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return ni(t)}function $l(e){for(var t=[],r=0;r<e.length;){var a=Math.min(e.length-r,268435455),s=new Uint8Array(4);t.push(s);var l=zt(a),c=l.length;t.push(l),a<=60?(c++,t.push(new Uint8Array([a-1<<2]))):a<=256?(c+=2,t.push(new Uint8Array([240,a-1&255]))):a<=65536?(c+=3,t.push(new Uint8Array([244,a-1&255,a-1>>8&255]))):a<=16777216?(c+=4,t.push(new Uint8Array([248,a-1&255,a-1>>8&255,a-1>>16&255]))):a<=4294967296&&(c+=5,t.push(new Uint8Array([252,a-1&255,a-1>>8&255,a-1>>16&255,a-1>>>24&255]))),t.push(e.slice(r,r+a)),c+=a,s[0]=0,s[1]=c&255,s[2]=c>>8&255,s[3]=c>>16&255,r+=a}return ni(t)}function zF(e,t,r,a){var s=Gi(e),l=s.getUint32(4,!0),c=(a>1?12:8)+Ny(l&(a>1?3470:398))*4,u=-1,h=-1,d=NaN,g=new Date(2001,0,1);l&512&&(u=s.getUint32(c,!0),c+=4),c+=Ny(l&(a>1?12288:4096))*4,l&16&&(h=s.getUint32(c,!0),c+=4),l&32&&(d=s.getFloat64(c,!0),c+=8),l&64&&(g.setTime(g.getTime()+s.getFloat64(c,!0)*1e3),c+=8);var x;switch(e[2]){case 0:break;case 2:x={t:"n",v:d};break;case 3:x={t:"s",v:t[h]};break;case 5:x={t:"d",v:g};break;case 6:x={t:"b",v:d>0};break;case 7:x={t:"n",v:d/86400};break;case 8:x={t:"e",v:0};break;case 9:if(u>-1)x={t:"s",v:r[u]};else if(h>-1)x={t:"s",v:t[h]};else if(!isNaN(d))x={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return x}function HF(e,t,r){var a=Gi(e),s=a.getUint32(8,!0),l=12,c=-1,u=-1,h=NaN,d=NaN,g=new Date(2001,0,1);s&1&&(h=jF(e,l),l+=16),s&2&&(d=a.getFloat64(l,!0),l+=8),s&4&&(g.setTime(g.getTime()+a.getFloat64(l,!0)*1e3),l+=8),s&8&&(u=a.getUint32(l,!0),l+=4),s&16&&(c=a.getUint32(l,!0),l+=4);var x;switch(e[1]){case 0:break;case 2:x={t:"n",v:h};break;case 3:x={t:"s",v:t[u]};break;case 5:x={t:"d",v:g};break;case 6:x={t:"b",v:d>0};break;case 7:x={t:"n",v:d/86400};break;case 8:x={t:"e",v:0};break;case 9:if(c>-1)x={t:"s",v:r[c]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:x={t:"n",v:h};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return x}function Fd(e,t){var r=new Uint8Array(32),a=Gi(r),s=12,l=0;switch(r[0]=5,e.t){case"n":r[1]=2,UF(r,s,e.v),l|=1,s+=16;break;case"b":r[1]=6,a.setFloat64(s,e.v?1:0,!0),l|=2,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,a.setUint32(s,t.indexOf(e.v),!0),l|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(8,l,!0),r.slice(0,s)}function Md(e,t){var r=new Uint8Array(32),a=Gi(r),s=12,l=0;switch(r[0]=3,e.t){case"n":r[2]=2,a.setFloat64(s,e.v,!0),l|=32,s+=8;break;case"b":r[2]=6,a.setFloat64(s,e.v?1:0,!0),l|=32,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,a.setUint32(s,t.indexOf(e.v),!0),l|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(4,l,!0),r.slice(0,s)}function $F(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return zF(e,t,r,e[0]);case 5:return HF(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function ca(e){var t=Bt(e);return Uc(t[1][0].data)}function Oy(e,t){var r=Bt(t.data),a=_r(r[1][0].data),s=r[3],l=[];return(s||[]).forEach(function(c){var u=Bt(c.data),h=_r(u[1][0].data)>>>0;switch(a){case 1:l[h]=sm(u[3][0].data);break;case 8:{var d=e[ca(u[9][0].data)][0],g=Bt(d.data),x=e[ca(g[1][0].data)][0],v=_r(x.meta[1][0].data);if(v!=2001)throw new Error("2000 unexpected reference to ".concat(v));var _=Bt(x.data);l[h]=_[3].map(function(b){return sm(b.data)}).join("")}break}}),l}function VF(e,t){var r,a,s,l,c,u,h,d,g,x,v,_,b,y,S=Bt(e),k=_r(S[1][0].data)>>>0,O=_r(S[2][0].data)>>>0,T=((a=(r=S[8])==null?void 0:r[0])==null?void 0:a.data)&&_r(S[8][0].data)>0||!1,j,X;if((l=(s=S[7])==null?void 0:s[0])!=null&&l.data&&t!=0)j=(u=(c=S[7])==null?void 0:c[0])==null?void 0:u.data,X=(d=(h=S[6])==null?void 0:h[0])==null?void 0:d.data;else if((x=(g=S[4])==null?void 0:g[0])!=null&&x.data&&t!=1)j=(_=(v=S[4])==null?void 0:v[0])==null?void 0:_.data,X=(y=(b=S[3])==null?void 0:b[0])==null?void 0:y.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var I=T?4:1,C=Gi(j),K=[],q=0;q<j.length/2;++q){var oe=C.getUint16(q*2,!0);oe<65535&&K.push([q,oe])}if(K.length!=O)throw"Expected ".concat(O," cells, found ").concat(K.length);var ee=[];for(q=0;q<K.length-1;++q)ee[K[q][0]]=X.subarray(K[q][1]*I,K[q+1][1]*I);return K.length>=1&&(ee[K[K.length-1][0]]=X.subarray(K[K.length-1][1]*I)),{R:k,cells:ee}}function GF(e,t){var r,a=Bt(t.data),s=(r=a?.[7])!=null&&r[0]?_r(a[7][0].data)>>>0>0?1:0:-1,l=Km(a[5],function(c){return VF(c,s)});return{nrows:_r(a[4][0].data)>>>0,data:l.reduce(function(c,u){return c[u.R]||(c[u.R]=[]),u.cells.forEach(function(h,d){if(c[u.R][d])throw new Error("Duplicate cell r=".concat(u.R," c=").concat(d));c[u.R][d]=h}),c},[])}}function qF(e,t,r){var a,s=Bt(t.data),l={s:{r:0,c:0},e:{r:0,c:0}};if(l.e.r=(_r(s[6][0].data)>>>0)-1,l.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(l.e.c=(_r(s[7][0].data)>>>0)-1,l.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=vt(l);var c=Bt(s[4][0].data),u=Oy(e,e[ca(c[4][0].data)][0]),h=(a=c[17])!=null&&a[0]?Oy(e,e[ca(c[17][0].data)][0]):[],d=Bt(c[3][0].data),g=0;d[1].forEach(function(x){var v=Bt(x.data),_=e[ca(v[2][0].data)][0],b=_r(_.meta[1][0].data);if(b!=6002)throw new Error("6001 unexpected reference to ".concat(b));var y=GF(e,_);y.data.forEach(function(S,k){S.forEach(function(O,T){var j=ft({r:g+k,c:T}),X=$F(O,u,h);X&&(r[j]=X)})}),g+=y.nrows})}function XF(e,t){var r=Bt(t.data),a={"!ref":"A1"},s=e[ca(r[2][0].data)],l=_r(s[0].meta[1][0].data);if(l!=6001)throw new Error("6000 unexpected reference to ".concat(l));return qF(e,s[0],a),a}function WF(e,t){var r,a=Bt(t.data),s={name:(r=a[1])!=null&&r[0]?sm(a[1][0].data):"",sheets:[]},l=Km(a[2],ca);return l.forEach(function(c){e[c].forEach(function(u){var h=_r(u.meta[1][0].data);h==6e3&&s.sheets.push(XF(e,u))})}),s}function KF(e,t){var r=e1(),a=Bt(t.data),s=Km(a[1],ca);if(s.forEach(function(l){e[l].forEach(function(c){var u=_r(c.meta[1][0].data);if(u==2){var h=WF(e,c);h.sheets.forEach(function(d,g){t1(r,d,g==0?h.name:h.name+"_"+g,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Ld(e){var t,r,a,s,l={},c=[];if(e.FullPaths.forEach(function(h){if(h.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(h){if(h.name.match(/\.iwa$/)){var d;try{d=un(h.content)}catch(x){return console.log("?? "+h.content.length+" "+(x.message||x))}var g;try{g=cn(d)}catch(x){return console.log("## "+(x.message||x))}g.forEach(function(x){l[x.id]=x.messages,c.push(x.id)})}}),!c.length)throw new Error("File has no messages");var u=((s=(a=(r=(t=l?.[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:a[1])==null?void 0:s[0].data)&&_r(l[1][0].meta[1][0].data)==1&&l[1][0];if(u||c.forEach(function(h){l[h].forEach(function(d){var g=_r(d.meta[1][0].data)>>>0;if(g==1)if(!u)u=d;else throw new Error("Document has multiple roots")})}),!u)throw new Error("Cannot find Document root");return KF(l,u)}function YF(e,t,r){var a,s,l,c;if(!((a=e[6])!=null&&a[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var u=((c=(l=e[8])==null?void 0:l[0])==null?void 0:c.data)&&_r(e[8][0].data)>0||!1;if(u)throw"Math only works with normal offsets";for(var h=0,d=Gi(e[7][0].data),g=0,x=[],v=Gi(e[4][0].data),_=0,b=[],y=0;y<t.length;++y){if(t[y]==null){d.setUint16(y*2,65535,!0),v.setUint16(y*2,65535);continue}d.setUint16(y*2,g,!0),v.setUint16(y*2,_,!0);var S,k;switch(typeof t[y]){case"string":S=Fd({t:"s",v:t[y]},r),k=Md({t:"s",v:t[y]},r);break;case"number":S=Fd({t:"n",v:t[y]},r),k=Md({t:"n",v:t[y]},r);break;case"boolean":S=Fd({t:"b",v:t[y]},r),k=Md({t:"b",v:t[y]},r);break;default:throw new Error("Unsupported value "+t[y])}x.push(S),g+=S.length,b.push(k),_+=k.length,++h}for(e[2][0].data=zt(h);y<e[7][0].data.length/2;++y)d.setUint16(y*2,65535,!0),v.setUint16(y*2,65535,!0);return e[6][0].data=ni(x),e[3][0].data=ni(b),h}function JF(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var a=Fa(r["!ref"]);a.s.r=a.s.c=0;var s=!1;a.e.c>9&&(s=!0,a.e.c=9),a.e.r>49&&(s=!0,a.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(vt(a)));var l=Vu(r,{range:a,header:1}),c=["~Sh33tJ5~"];l.forEach(function(V){return V.forEach(function(M){typeof M=="string"&&c.push(M)})});var u={},h=[],d=st.read(t.numbers,{type:"base64"});d.FileIndex.map(function(V,M){return[V,d.FullPaths[M]]}).forEach(function(V){var M=V[0],z=V[1];if(M.type==2&&M.name.match(/\.iwa/)){var te=M.content,ge=un(te),Ee=cn(ge);Ee.forEach(function(ye){h.push(ye.id),u[ye.id]={deps:[],location:z,type:_r(ye.messages[0].meta[1][0].data)}})}}),h.sort(function(V,M){return V-M});var g=h.filter(function(V){return V>1}).map(function(V){return[V,zt(V)]});d.FileIndex.map(function(V,M){return[V,d.FullPaths[M]]}).forEach(function(V){var M=V[0];if(V[1],!!M.name.match(/\.iwa/)){var z=cn(un(M.content));z.forEach(function(te){te.messages.forEach(function(ge){g.forEach(function(Ee){te.messages.some(function(ye){return _r(ye.meta[1][0].data)!=11006&&BF(ye.data,Ee[1])})&&u[Ee[0]].deps.push(te.id)})})})}});for(var x=st.find(d,u[1].location),v=cn(un(x.content)),_,b=0;b<v.length;++b){var y=v[b];y.id==1&&(_=y)}var S=ca(Bt(_.messages[0].data)[1][0].data);for(x=st.find(d,u[S].location),v=cn(un(x.content)),b=0;b<v.length;++b)y=v[b],y.id==S&&(_=y);for(S=ca(Bt(_.messages[0].data)[2][0].data),x=st.find(d,u[S].location),v=cn(un(x.content)),b=0;b<v.length;++b)y=v[b],y.id==S&&(_=y);for(S=ca(Bt(_.messages[0].data)[2][0].data),x=st.find(d,u[S].location),v=cn(un(x.content)),b=0;b<v.length;++b)y=v[b],y.id==S&&(_=y);var k=Bt(_.messages[0].data);{k[6][0].data=zt(a.e.r+1),k[7][0].data=zt(a.e.c+1);var O=ca(k[46][0].data),T=st.find(d,u[O].location),j=cn(un(T.content));{for(var X=0;X<j.length&&j[X].id!=O;++X);if(j[X].id!=O)throw"Bad ColumnRowUIDMapArchive";var I=Bt(j[X].messages[0].data);I[1]=[],I[2]=[],I[3]=[];for(var C=0;C<=a.e.c;++C){var K=[];K[1]=K[2]=[{type:0,data:zt(C+420690)}],I[1].push({type:2,data:ta(K)}),I[2].push({type:0,data:zt(C)}),I[3].push({type:0,data:zt(C)})}I[4]=[],I[5]=[],I[6]=[];for(var q=0;q<=a.e.r;++q)K=[],K[1]=K[2]=[{type:0,data:zt(q+726270)}],I[4].push({type:2,data:ta(K)}),I[5].push({type:0,data:zt(q)}),I[6].push({type:0,data:zt(q)});j[X].messages[0].data=ta(I)}T.content=$l(Hl(j)),T.size=T.content.length,delete k[46];var oe=Bt(k[4][0].data);{oe[7][0].data=zt(a.e.r+1);var ee=Bt(oe[1][0].data),Z=ca(ee[2][0].data);T=st.find(d,u[Z].location),j=cn(un(T.content));{if(j[0].id!=Z)throw"Bad HeaderStorageBucket";var xe=Bt(j[0].messages[0].data);for(q=0;q<l.length;++q){var Ce=Bt(xe[2][0].data);Ce[1][0].data=zt(q),Ce[4][0].data=zt(l[q].length),xe[2][q]={type:xe[2][0].type,data:ta(Ce)}}j[0].messages[0].data=ta(xe)}T.content=$l(Hl(j)),T.size=T.content.length;var Se=ca(oe[2][0].data);T=st.find(d,u[Se].location),j=cn(un(T.content));{if(j[0].id!=Se)throw"Bad HeaderStorageBucket";for(xe=Bt(j[0].messages[0].data),C=0;C<=a.e.c;++C)Ce=Bt(xe[2][0].data),Ce[1][0].data=zt(C),Ce[4][0].data=zt(a.e.r+1),xe[2][C]={type:xe[2][0].type,data:ta(Ce)};j[0].messages[0].data=ta(xe)}T.content=$l(Hl(j)),T.size=T.content.length;var G=ca(oe[4][0].data);(function(){for(var V=st.find(d,u[G].location),M=cn(un(V.content)),z,te=0;te<M.length;++te){var ge=M[te];ge.id==G&&(z=ge)}var Ee=Bt(z.messages[0].data);{Ee[3]=[];var ye=[];c.forEach(function(P,St){ye[1]=[{type:0,data:zt(St)}],ye[2]=[{type:0,data:zt(1)}],ye[3]=[{type:2,data:IF(P)}],Ee[3].push({type:2,data:ta(ye)})})}z.messages[0].data=ta(Ee);var Ae=Hl(M),tt=$l(Ae);V.content=tt,V.size=V.content.length})();var ne=Bt(oe[3][0].data);{var pe=ne[1][0];delete ne[2];var J=Bt(pe.data);{var be=ca(J[2][0].data);(function(){for(var V=st.find(d,u[be].location),M=cn(un(V.content)),z,te=0;te<M.length;++te){var ge=M[te];ge.id==be&&(z=ge)}var Ee=Bt(z.messages[0].data);{delete Ee[6],delete ne[7];var ye=new Uint8Array(Ee[5][0].data);Ee[5]=[];for(var Ae=0,tt=0;tt<=a.e.r;++tt){var P=Bt(ye);Ae+=YF(P,l[tt],c),P[1][0].data=zt(tt),Ee[5].push({data:ta(P),type:2})}Ee[1]=[{type:0,data:zt(a.e.c+1)}],Ee[2]=[{type:0,data:zt(a.e.r+1)}],Ee[3]=[{type:0,data:zt(Ae)}],Ee[4]=[{type:0,data:zt(a.e.r+1)}]}z.messages[0].data=ta(Ee);var St=Hl(M),at=$l(St);V.content=at,V.size=V.content.length})()}pe.data=ta(J)}oe[3][0].data=ta(ne)}k[4][0].data=ta(oe)}_.messages[0].data=ta(k);var L=Hl(v),N=$l(L);return x.content=N,x.size=x.content.length,d}function iw(e){return function(r){for(var a=0;a!=e.length;++a){var s=e[a];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function Ym(e){iw([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Jm(e){iw([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function QF(e){return bt.WS.indexOf(e)>-1?"sheet":e==bt.CS?"chart":e==bt.DS?"dialog":e==bt.MS?"macro":e&&e.length?e:"sheet"}function ZF(e,t){if(!e)return 0;try{e=t.map(function(a){return a.id||(a.id=a.strRelID),[a.name,e["!id"][a.id].Target,QF(e["!id"][a.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function eM(e,t,r,a,s,l,c,u,h,d,g,x){try{l[a]=pc(Wa(e,r,!0),t);var v=Mr(e,t),_;switch(u){case"sheet":_=bD(v,t,s,h,l[a],d,g,x);break;case"chart":if(_=SD(v,t,s,h,l[a],d,g,x),!_||!_["!drawel"])break;var b=uc(_["!drawel"].Target,t),y=Fc(b),S=c8(Wa(e,b,!0),pc(Wa(e,y,!0),b)),k=uc(S,b),O=Fc(k);_=YR(Wa(e,k,!0),k,h,pc(Wa(e,O,!0),k),d,_);break;case"macro":_=ED(v,t,s,h,l[a],d,g,x);break;case"dialog":_=TD(v,t,s,h,l[a],d,g,x);break;default:throw new Error("Unrecognized sheet type "+u)}c[a]=_;var T=[];l&&l[a]&&wr(l[a]).forEach(function(j){var X="";if(l[a][j].Type==bt.CMNT){X=uc(l[a][j].Target,t);var I=ND(Mr(e,X,!0),X,h);if(!I||!I.length)return;gy(_,I,!1)}l[a][j].Type==bt.TCMNT&&(X=uc(l[a][j].Target,t),T=T.concat(f8(Mr(e,X,!0),h)))}),T&&T.length&&gy(_,T,!0,h.people||[])}catch(j){if(h.WTF)throw j}}function ln(e){return e.charAt(0)=="/"?e.slice(1):e}function tM(e,t){if(oo(),t=t||{},Ym(t),fn(e,"META-INF/manifest.xml")||fn(e,"objectdata.xml"))return ky(e,t);if(fn(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Ld<"u"){if(e.FileIndex)return Ld(e);var r=st.utils.cfb_new();return Iv(e).forEach(function(Ce){_t(r,Ce,hA(e,Ce))}),Ld(r)}throw new Error("Unsupported NUMBERS file")}if(!fn(e,"[Content_Types].xml"))throw fn(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):fn(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var a=Iv(e),s=s3(Wa(e,"[Content_Types].xml")),l=!1,c,u;if(s.workbooks.length===0&&(u="xl/workbook.xml",Mr(e,u,!0)&&s.workbooks.push(u)),s.workbooks.length===0){if(u="xl/workbook.bin",!Mr(e,u,!0))throw new Error("Could not find workbook");s.workbooks.push(u),l=!0}s.workbooks[0].slice(-3)=="bin"&&(l=!0);var h={},d={};if(!t.bookSheets&&!t.bookProps){if(xc=[],s.sst)try{xc=CD(Mr(e,ln(s.sst)),s.sst,t)}catch(Ce){if(t.WTF)throw Ce}t.cellStyles&&s.themes.length&&(h=AD(Wa(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(d=kD(Mr(e,ln(s.style)),s.style,h,t))}s.links.map(function(Ce){try{var Se=pc(Wa(e,Fc(ln(Ce))),Ce);return RD(Mr(e,ln(Ce)),Se,Ce,t)}catch{}});var g=wD(Mr(e,ln(s.workbooks[0])),s.workbooks[0],t),x={},v="";s.coreprops.length&&(v=Mr(e,ln(s.coreprops[0]),!0),v&&(x=W_(v)),s.extprops.length!==0&&(v=Mr(e,ln(s.extprops[0]),!0),v&&h3(v,x,t)));var _={};(!t.bookSheets||t.bookProps)&&s.custprops.length!==0&&(v=Wa(e,ln(s.custprops[0]),!0),v&&(_=m3(v,t)));var b={};if((t.bookSheets||t.bookProps)&&(g.Sheets?c=g.Sheets.map(function(Se){return Se.name}):x.Worksheets&&x.SheetNames.length>0&&(c=x.SheetNames),t.bookProps&&(b.Props=x,b.Custprops=_),t.bookSheets&&typeof c<"u"&&(b.SheetNames=c),t.bookSheets?b.SheetNames:t.bookProps))return b;c={};var y={};t.bookDeps&&s.calcchain&&(y=OD(Mr(e,ln(s.calcchain)),s.calcchain));var S=0,k={},O,T;{var j=g.Sheets;x.Worksheets=j.length,x.SheetNames=[];for(var X=0;X!=j.length;++X)x.SheetNames[X]=j[X].name}var I=l?"bin":"xml",C=s.workbooks[0].lastIndexOf("/"),K=(s.workbooks[0].slice(0,C+1)+"_rels/"+s.workbooks[0].slice(C+1)+".rels").replace(/^\//,"");fn(e,K)||(K="xl/_rels/workbook."+I+".rels");var q=pc(Wa(e,K,!0),K.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=DD(Mr(e,ln(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=d8(Mr(e,ln(s.people[0])),t)),q&&(q=ZF(q,g.Sheets));var oe=Mr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(S=0;S!=x.Worksheets;++S){var ee="sheet";if(q&&q[S]?(O="xl/"+q[S][1].replace(/[\/]?xl\//,""),fn(e,O)||(O=q[S][1]),fn(e,O)||(O=K.replace(/_rels\/.*$/,"")+q[S][1]),ee=q[S][2]):(O="xl/worksheets/sheet"+(S+1-oe)+"."+I,O=O.replace(/sheet0\./,"sheet.")),T=O.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(S!=t.sheets)continue e;break;case"string":if(x.SheetNames[S].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var Z=!1,xe=0;xe!=t.sheets.length;++xe)typeof t.sheets[xe]=="number"&&t.sheets[xe]==S&&(Z=1),typeof t.sheets[xe]=="string"&&t.sheets[xe].toLowerCase()==x.SheetNames[S].toLowerCase()&&(Z=1);if(!Z)continue e}}eM(e,O,T,x.SheetNames[S],S,k,c,ee,t,g,h,d)}return b={Directory:s,Workbook:g,Props:x,Custprops:_,Deps:y,Sheets:c,SheetNames:x.SheetNames,Strings:xc,Styles:d,Themes:h,SSF:lr(ct)},t&&t.bookFiles&&(e.files?(b.keys=a,b.files=e.files):(b.keys=[],b.files={},e.FullPaths.forEach(function(Ce,Se){Ce=Ce.replace(/^Root Entry[\/]/,""),b.keys.push(Ce),b.files[Ce]=e.FileIndex[Se]}))),t&&t.bookVBA&&(s.vba.length>0?b.vbaraw=Mr(e,ln(s.vba[0]),!0):s.defaults&&s.defaults.bin===w8&&(b.vbaraw=Mr(e,"xl/vbaProject.bin",!0))),b}function rM(e,t){var r=t||{},a="Workbook",s=st.find(e,a);try{if(a="/!DataSpaces/Version",s=st.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(DN(s.content),a="/!DataSpaces/DataSpaceMap",s=st.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);var l=MN(s.content);if(l.length!==1||l[0].comps.length!==1||l[0].comps[0].t!==0||l[0].name!=="StrongEncryptionDataSpace"||l[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=st.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);var c=LN(s.content);if(c.length!=1||c[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=st.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);BN(s.content)}catch{}if(a="/EncryptionInfo",s=st.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);var u=jN(s.content);if(a="/EncryptedPackage",s=st.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(u[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(u[1],s.content,r.password||"",r);if(u[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(u[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function aM(e,t){return t.bookType=="ods"?sw(e,t):t.bookType=="numbers"?JF(e,t):t.bookType=="xlsb"?nM(e,t):sM(e,t)}function nM(e,t){Kl=1024,e&&!e.SSF&&(e.SSF=lr(ct)),e&&e.SSF&&(oo(),Ku(e.SSF),t.revssf=Ju(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,vc?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",a=F2.indexOf(t.bookType)>-1,s=Im();Jm(t=t||{});var l=bm(),c="",u=0;if(t.cellXfs=[],oi(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),c="docProps/core.xml",_t(l,c,K_(e.Props,t)),s.coreprops.push(c),Ht(t.rels,2,c,bt.CORE_PROPS),c="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var h=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&h.push(e.SheetNames[d]);e.Props.SheetNames=h}for(e.Props.Worksheets=e.Props.SheetNames.length,_t(l,c,Q_(e.Props)),s.extprops.push(c),Ht(t.rels,3,c,bt.EXT_PROPS),e.Custprops!==e.Props&&wr(e.Custprops||{}).length>0&&(c="docProps/custom.xml",_t(l,c,Z_(e.Custprops)),s.custprops.push(c),Ht(t.rels,4,c,bt.CUST_PROPS)),u=1;u<=e.SheetNames.length;++u){var g={"!id":{}},x=e.Sheets[e.SheetNames[u-1]],v=(x||{})["!type"]||"sheet";if(c="xl/worksheets/sheet"+u+"."+r,_t(l,c,MD(u-1,c,t,e,g)),s.sheets.push(c),Ht(t.wbrels,-1,"worksheets/sheet"+u+"."+r,bt.WS[0]),x){var _=x["!comments"],b=!1,y="";_&&_.length>0&&(y="xl/comments"+u+"."+r,_t(l,y,BD(_,y)),s.comments.push(y),Ht(g,-1,"../comments"+u+"."+r,bt.CMNT),b=!0),x["!legacy"]&&b&&_t(l,"xl/drawings/vmlDrawing"+u+".vml",R2(u,x["!comments"])),delete x["!comments"],delete x["!legacy"]}g["!id"].rId1&&_t(l,Fc(c),Ql(g))}return t.Strings!=null&&t.Strings.length>0&&(c="xl/sharedStrings."+r,_t(l,c,ID(t.Strings,c,t)),s.strs.push(c),Ht(t.wbrels,-1,"sharedStrings."+r,bt.SST)),c="xl/workbook."+r,_t(l,c,FD(e,c)),s.workbooks.push(c),Ht(t.rels,1,c,bt.WB),c="xl/theme/theme1.xml",_t(l,c,Hm(e.Themes,t)),s.themes.push(c),Ht(t.wbrels,-1,"theme/theme1.xml",bt.THEME),c="xl/styles."+r,_t(l,c,LD(e,c,t)),s.styles.push(c),Ht(t.wbrels,-1,"styles."+r,bt.STY),e.vbaraw&&a&&(c="xl/vbaProject.bin",_t(l,c,e.vbaraw),s.vba.push(c),Ht(t.wbrels,-1,"vbaProject.bin",bt.VBA)),c="xl/metadata."+r,_t(l,c,jD(c)),s.metadata.push(c),Ht(t.wbrels,-1,"metadata."+r,bt.XLMETA),_t(l,"[Content_Types].xml",q_(s,t)),_t(l,"_rels/.rels",Ql(t.rels)),_t(l,"xl/_rels/workbook."+r+".rels",Ql(t.wbrels)),delete t.revssf,delete t.ssf,l}function sM(e,t){Kl=1024,e&&!e.SSF&&(e.SSF=lr(ct)),e&&e.SSF&&(oo(),Ku(e.SSF),t.revssf=Ju(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,vc?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",a=F2.indexOf(t.bookType)>-1,s=Im();Jm(t=t||{});var l=bm(),c="",u=0;if(t.cellXfs=[],oi(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),c="docProps/core.xml",_t(l,c,K_(e.Props,t)),s.coreprops.push(c),Ht(t.rels,2,c,bt.CORE_PROPS),c="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var h=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&h.push(e.SheetNames[d]);e.Props.SheetNames=h}e.Props.Worksheets=e.Props.SheetNames.length,_t(l,c,Q_(e.Props)),s.extprops.push(c),Ht(t.rels,3,c,bt.EXT_PROPS),e.Custprops!==e.Props&&wr(e.Custprops||{}).length>0&&(c="docProps/custom.xml",_t(l,c,Z_(e.Custprops)),s.custprops.push(c),Ht(t.rels,4,c,bt.CUST_PROPS));var g=["SheetJ5"];for(t.tcid=0,u=1;u<=e.SheetNames.length;++u){var x={"!id":{}},v=e.Sheets[e.SheetNames[u-1]],_=(v||{})["!type"]||"sheet";if(c="xl/worksheets/sheet"+u+"."+r,_t(l,c,V2(u-1,t,e,x)),s.sheets.push(c),Ht(t.wbrels,-1,"worksheets/sheet"+u+"."+r,bt.WS[0]),v){var b=v["!comments"],y=!1,S="";if(b&&b.length>0){var k=!1;b.forEach(function(O){O[1].forEach(function(T){T.T==!0&&(k=!0)})}),k&&(S="xl/threadedComments/threadedComment"+u+"."+r,_t(l,S,h8(b,g,t)),s.threadedcomments.push(S),Ht(x,-1,"../threadedComments/threadedComment"+u+"."+r,bt.TCMNT)),S="xl/comments"+u+"."+r,_t(l,S,D2(b)),s.comments.push(S),Ht(x,-1,"../comments"+u+"."+r,bt.CMNT),y=!0}v["!legacy"]&&y&&_t(l,"xl/drawings/vmlDrawing"+u+".vml",R2(u,v["!comments"])),delete v["!comments"],delete v["!legacy"]}x["!id"].rId1&&_t(l,Fc(c),Ql(x))}return t.Strings!=null&&t.Strings.length>0&&(c="xl/sharedStrings."+r,_t(l,c,y2(t.Strings,t)),s.strs.push(c),Ht(t.wbrels,-1,"sharedStrings."+r,bt.SST)),c="xl/workbook."+r,_t(l,c,K2(e)),s.workbooks.push(c),Ht(t.rels,1,c,bt.WB),c="xl/theme/theme1.xml",_t(l,c,Hm(e.Themes,t)),s.themes.push(c),Ht(t.wbrels,-1,"theme/theme1.xml",bt.THEME),c="xl/styles."+r,_t(l,c,A2(e,t)),s.styles.push(c),Ht(t.wbrels,-1,"styles."+r,bt.STY),e.vbaraw&&a&&(c="xl/vbaProject.bin",_t(l,c,e.vbaraw),s.vba.push(c),Ht(t.wbrels,-1,"vbaProject.bin",bt.VBA)),c="xl/metadata."+r,_t(l,c,O2()),s.metadata.push(c),Ht(t.wbrels,-1,"metadata."+r,bt.XLMETA),g.length>1&&(c="xl/persons/person.xml",_t(l,c,m8(g)),s.people.push(c),Ht(t.wbrels,-1,"persons/person.xml",bt.PEOPLE)),_t(l,"[Content_Types].xml",q_(s,t)),_t(l,"_rels/.rels",Ql(t.rels)),_t(l,"xl/_rels/workbook."+r+".rels",Ql(t.wbrels)),delete t.revssf,delete t.ssf,l}function Qm(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Ka(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function iM(e,t){return st.find(e,"EncryptedPackage")?rM(e,t):Z2(e,t)}function lM(e,t){var r,a=e,s=t||{};return s.type||(s.type=wt&&Buffer.isBuffer(e)?"buffer":"base64"),r=w_(a,s),tM(r,s)}function lw(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return am(e.slice(r),t);default:break e}return no.to_workbook(e,t)}function oM(e,t){var r="",a=Qm(e,t);switch(t.type){case"base64":r=Ka(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=zi(e);break;default:throw new Error("Unrecognized type "+t.type)}return a[0]==239&&a[1]==187&&a[2]==191&&(r=Jt(r)),t.type="binary",lw(r,t)}function cM(e,t){var r=e;return t.type=="base64"&&(r=Ka(r)),r=Ac.utils.decode(1200,r.slice(2),"str"),t.type="binary",lw(r,t)}function uM(e){return e.match(/[^\x00-\x7F]/)?Un(e):e}function Id(e,t,r,a){return a?(r.type="string",no.to_workbook(e,r)):no.to_workbook(t,r)}function $u(e,t){xm();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return $u(new Uint8Array(e),(r=lr(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var a=e,s=[0,0,0,0],l=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),eo={},r.dateNF&&(eo.dateNF=r.dateNF),r.type||(r.type=wt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=wt?"buffer":"binary",a=nA(e),typeof Uint8Array<"u"&&!wt&&(r.type="array")),r.type=="string"&&(l=!0,r.type="binary",r.codepage=65001,a=uM(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var c=new ArrayBuffer(3),u=new Uint8Array(c);if(u.foo="bar",!u.foo)return r=lr(r),r.type="array",$u(vm(a),r)}switch((s=Qm(a,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return iM(st.read(a,r),r);break;case 9:if(s[1]<=8)return Z2(a,r);break;case 60:return am(a,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return gN(a,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return x2.to_workbook(a,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?lM(a,r):Id(e,a,r,l);case 239:return s[3]===60?am(a,r):Id(e,a,r,l);case 255:if(s[1]===254)return cM(a,r);if(s[1]===0&&s[2]===2&&s[3]===0)return ji.to_workbook(a,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return ji.to_workbook(a,r);break;case 3:case 131:case 139:case 140:return rm.to_workbook(a,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return E2.to_workbook(a,r);break;case 10:case 13:case 32:return oM(a,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return mN.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?rm.to_workbook(a,r):Id(e,a,r,l)}function ow(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Vc(t.file,st.write(e,{type:wt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return st.write(e,t)}function fM(e,t){var r=lr(t||{}),a=aM(e,r);return hM(a,r)}function hM(e,t){var r={},a=wt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=a;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=a;break;default:throw new Error("Unrecognized type "+t.type)}var s=e.FullPaths?st.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(t.type=="binary"||t.type=="base64")return s;s=new Uint8Array(Wu(s))}return t.password&&typeof encrypt_agile<"u"?ow(encrypt_agile(s,t.password),t):t.type==="file"?Vc(t.file,s):t.type=="string"?Jt(s):s}function dM(e,t){var r=t||{},a=uF(e,r);return ow(a,r)}function jn(e,t,r){r||(r="");var a=r+e;switch(t.type){case"base64":return Cc(Un(a));case"binary":return Un(a);case"string":return e;case"file":return Vc(t.file,a,"utf8");case"buffer":return wt?gs(a,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(a):jn(a,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function mM(e,t){switch(t.type){case"base64":return Cc(e);case"binary":return e;case"string":return e;case"file":return Vc(t.file,e,"binary");case"buffer":return wt?gs(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Tu(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",a=0;a<e.length;++a)r+=String.fromCharCode(e[a]);return t.type=="base64"?Cc(r):t.type=="string"?Jt(r):r;case"file":return Vc(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function cw(e,t){xm(),iD(e);var r=lr(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var a=cw(e,r);return r.type="array",Wu(a)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=e.SheetNames.indexOf(r.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return jn(aF(e,r),r);case"slk":case"sylk":return jn(p2.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"htm":case"html":return jn(tw(e.Sheets[e.SheetNames[s]],r),r);case"txt":return mM(uw(e.Sheets[e.SheetNames[s]],r),r);case"csv":return jn(Zm(e.Sheets[e.SheetNames[s]],r),r,"\uFEFF");case"dif":return jn(x2.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"dbf":return Tu(rm.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"prn":return jn(no.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"rtf":return jn(E2.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"eth":return jn(v2.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"fods":return jn(sw(e,r),r);case"wk1":return Tu(ji.sheet_to_wk1(e.Sheets[e.SheetNames[s]],r),r);case"wk3":return Tu(ji.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Tu(ew(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),dM(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return fM(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function gM(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function Ry(e,t,r){var a={};return a.type="file",a.file=t,gM(a),cw(e,a)}function pM(e,t,r,a,s,l,c,u){var h=kr(r),d=u.defval,g=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),x=!0,v=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(v,"__rowNum__",{value:r,enumerable:!1})}catch{v.__rowNum__=r}else v.__rowNum__=r;if(!c||e[r])for(var _=t.s.c;_<=t.e.c;++_){var b=c?e[r][_]:e[a[_]+h];if(b===void 0||b.t===void 0){if(d===void 0)continue;l[_]!=null&&(v[l[_]]=d);continue}var y=b.v;switch(b.t){case"z":if(y==null)break;continue;case"e":y=y==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+b.t)}if(l[_]!=null){if(y==null)if(b.t=="e"&&y===null)v[l[_]]=null;else if(d!==void 0)v[l[_]]=d;else if(g&&y===null)v[l[_]]=null;else continue;else v[l[_]]=g&&(b.t!=="n"||b.t==="n"&&u.rawNumbers!==!1)?y:ds(b,y,u);y!=null&&(x=!1)}}return{row:v,isempty:x}}function Vu(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},a=0,s=1,l=[],c=0,u="",h={s:{r:0,c:0},e:{r:0,c:0}},d=t||{},g=d.range!=null?d.range:e["!ref"];switch(d.header===1?a=1:d.header==="A"?a=2:Array.isArray(d.header)?a=3:d.header==null&&(a=0),typeof g){case"string":h=Ft(g);break;case"number":h=Ft(e["!ref"]),h.s.r=g;break;default:h=g}a>0&&(s=0);var x=kr(h.s.r),v=[],_=[],b=0,y=0,S=Array.isArray(e),k=h.s.r,O=0,T={};S&&!e[k]&&(e[k]=[]);var j=d.skipHidden&&e["!cols"]||[],X=d.skipHidden&&e["!rows"]||[];for(O=h.s.c;O<=h.e.c;++O)if(!(j[O]||{}).hidden)switch(v[O]=hr(O),r=S?e[k][O]:e[v[O]+x],a){case 1:l[O]=O-h.s.c;break;case 2:l[O]=v[O];break;case 3:l[O]=d.header[O-h.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),u=c=ds(r,null,d),y=T[c]||0,!y)T[c]=1;else{do u=c+"_"+y++;while(T[u]);T[c]=y,T[u]=1}l[O]=u}for(k=h.s.r+s;k<=h.e.r;++k)if(!(X[k]||{}).hidden){var I=pM(e,h,k,v,a,l,S,d);(I.isempty===!1||(a===1?d.blankrows!==!1:d.blankrows))&&(_[b++]=I.row)}return _.length=b,_}var Dy=/"/g;function xM(e,t,r,a,s,l,c,u){for(var h=!0,d=[],g="",x=kr(r),v=t.s.c;v<=t.e.c;++v)if(a[v]){var _=u.dense?(e[r]||[])[v]:e[a[v]+x];if(_==null)g="";else if(_.v!=null){h=!1,g=""+(u.rawNumbers&&_.t=="n"?_.v:ds(_,null,u));for(var b=0,y=0;b!==g.length;++b)if((y=g.charCodeAt(b))===s||y===l||y===34||u.forceQuotes){g='"'+g.replace(Dy,'""')+'"';break}g=="ID"&&(g='"ID"')}else _.f!=null&&!_.F?(h=!1,g="="+_.f,g.indexOf(",")>=0&&(g='"'+g.replace(Dy,'""')+'"')):g="";d.push(g)}return u.blankrows===!1&&h?null:d.join(c)}function Zm(e,t){var r=[],a=t??{};if(e==null||e["!ref"]==null)return"";var s=Ft(e["!ref"]),l=a.FS!==void 0?a.FS:",",c=l.charCodeAt(0),u=a.RS!==void 0?a.RS:`
`,h=u.charCodeAt(0),d=new RegExp((l=="|"?"\\|":l)+"+$"),g="",x=[];a.dense=Array.isArray(e);for(var v=a.skipHidden&&e["!cols"]||[],_=a.skipHidden&&e["!rows"]||[],b=s.s.c;b<=s.e.c;++b)(v[b]||{}).hidden||(x[b]=hr(b));for(var y=0,S=s.s.r;S<=s.e.r;++S)(_[S]||{}).hidden||(g=xM(e,s,S,x,c,h,l,a),g!=null&&(a.strip&&(g=g.replace(d,"")),(g||a.blankrows!==!1)&&r.push((y++?u:"")+g)));return delete a.dense,r.join("")}function uw(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Zm(e,t);return r}function vM(e){var t="",r,a="";if(e==null||e["!ref"]==null)return[];var s=Ft(e["!ref"]),l="",c=[],u,h=[],d=Array.isArray(e);for(u=s.s.c;u<=s.e.c;++u)c[u]=hr(u);for(var g=s.s.r;g<=s.e.r;++g)for(l=kr(g),u=s.s.c;u<=s.e.c;++u)if(t=c[u]+l,r=d?(e[g]||[])[u]:e[t],a="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;a=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)a=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)a=""+r.v;else if(r.t=="b")a=r.v?"TRUE":"FALSE";else if(r.w!==void 0)a="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?a="'"+r.v:a=""+r.v}}h[h.length]=t+"="+a}return h}function fw(e,t,r){var a=r||{},s=+!a.skipHeader,l=e||{},c=0,u=0;if(l&&a.origin!=null)if(typeof a.origin=="number")c=a.origin;else{var h=typeof a.origin=="string"?dr(a.origin):a.origin;c=h.r,u=h.c}var d,g={s:{c:0,r:0},e:{c:u,r:c+t.length-1+s}};if(l["!ref"]){var x=Ft(l["!ref"]);g.e.c=Math.max(g.e.c,x.e.c),g.e.r=Math.max(g.e.r,x.e.r),c==-1&&(c=x.e.r+1,g.e.r=c+t.length-1+s)}else c==-1&&(c=0,g.e.r=t.length-1+s);var v=a.header||[],_=0;t.forEach(function(y,S){wr(y).forEach(function(k){(_=v.indexOf(k))==-1&&(v[_=v.length]=k);var O=y[k],T="z",j="",X=ft({c:u+_,r:c+S+s});d=Pc(l,X),O&&typeof O=="object"&&!(O instanceof Date)?l[X]=O:(typeof O=="number"?T="n":typeof O=="boolean"?T="b":typeof O=="string"?T="s":O instanceof Date?(T="d",a.cellDates||(T="n",O=Pr(O)),j=a.dateNF||ct[14]):O===null&&a.nullError&&(T="e",O=0),d?(d.t=T,d.v=O,delete d.w,delete d.R,j&&(d.z=j)):l[X]=d={t:T,v:O},j&&(d.z=j))})}),g.e.c=Math.max(g.e.c,u+v.length-1);var b=kr(c);if(s)for(_=0;_<v.length;++_)l[hr(_+u)+b]={t:"s",v:v[_]};return l["!ref"]=vt(g),l}function yM(e,t){return fw(null,e,t)}function Pc(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var a=dr(t);return e[a.r]||(e[a.r]=[]),e[a.r][a.c]||(e[a.r][a.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Pc(e,ft(t)):Pc(e,ft({r:t,c:r||0}))}function _M(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function e1(){return{SheetNames:[],Sheets:{}}}function t1(e,t,r,a){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&e.SheetNames.indexOf(r)>=0){var l=r.match(/(^.*?)(\d+)$/);s=l&&+l[2]||0;var c=l&&l[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=c+s)!=-1;++s);}if(W2(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function wM(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var a=_M(e,t);switch(e.Workbook.Sheets[a]||(e.Workbook.Sheets[a]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[a].Hidden=r}function bM(e,t){return e.z=t,e}function hw(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function SM(e,t,r){return hw(e,"#"+t,r)}function EM(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function TM(e,t,r,a){for(var s=typeof t!="string"?t:Ft(t),l=typeof t=="string"?t:vt(t),c=s.s.r;c<=s.e.r;++c)for(var u=s.s.c;u<=s.e.c;++u){var h=Pc(e,c,u);h.t="n",h.F=l,delete h.v,c==s.s.r&&u==s.s.c&&(h.f=r,a&&(h.D=!0))}return e}var Ws={encode_col:hr,encode_row:kr,encode_cell:ft,encode_range:vt,decode_col:Om,decode_row:Nm,split_cell:IA,decode_cell:dr,decode_range:Fa,format_cell:ds,sheet_add_aoa:U_,sheet_add_json:fw,sheet_add_dom:rw,aoa_to_sheet:co,json_to_sheet:yM,table_to_sheet:aw,table_to_book:DF,sheet_to_csv:Zm,sheet_to_txt:uw,sheet_to_json:Vu,sheet_to_html:tw,sheet_to_formulae:vM,sheet_to_row_object_array:Vu,sheet_get_cell:Pc,book_new:e1,book_append_sheet:t1,book_set_sheet_visibility:wM,cell_set_number_format:bM,cell_set_hyperlink:hw,cell_set_internal_link:SM,cell_add_comment:EM,sheet_set_array_formula:TM,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function kM(){const[e,t]=ze.useState("dashboard"),[r,a]=ze.useState(!0),[s,l]=ze.useState([]),[c,u]=ze.useState(""),[h,d]=ze.useState("772"),[g,x]=ze.useState(!1),[v,_]=ze.useState(50),[b,y]=ze.useState({771:1,772:1}),[S,k]=ze.useState(!1),[O,T]=ze.useState(null),[j,X]=ze.useState({loading:!0,message:"",type:""}),I=ze.useRef(null),[C,K]=ze.useState({loading:!1,message:"",type:""}),q=ze.useRef(null),[oe,ee]=ze.useState({loading:!1,message:"",type:""}),Z=ze.useRef(null),[xe,Ce]=ze.useState({loading:!1,message:"",type:""}),[Se,G]=ze.useState([]),[ne,pe]=ze.useState(null),J=ze.useRef(null),[be,L]=ze.useState({loading:!1,message:"",type:""}),[N,V]=ze.useState([]),[M,z]=ze.useState(""),[te,ge]=ze.useState(1),[Ee,ye]=ze.useState(50),Ae=ze.useRef(null),[tt,P]=ze.useState({loading:!1,message:"",type:""}),[St,at]=ze.useState([]),[Et,dt]=ze.useState(""),[Be,Vt]=ze.useState(1),[br,na]=ze.useState(50),[pa,Xr]=ze.useState({loading:!1,message:"",type:""}),[Ya,Mt]=ze.useState([]),sa=Y=>{const re=Y?.message?String(Y.message):"";return re.toLowerCase().includes("schema cache")||re.toLowerCase().includes("could not find the table")?"Parece que en Supabase an no existe (o no se ha refrescado) la tabla `public.tertiary_packaging`. Ejecuta `supabase/schema.sql` en Supabase (SQL Editor) y luego recarga el schema con: NOTIFY pgrst, 'reload schema';":""},zr=Y=>{const re=Y?.message?String(Y.message):"";return re.toLowerCase().includes("schema cache")||re.toLowerCase().includes("could not find the table")?"Parece que en Supabase an no existe (o no se ha refrescado) la tabla `public.medication_categories`. Ejecuta `supabase/schema.sql` en Supabase (SQL Editor) y luego recarga el schema con: NOTIFY pgrst, 'reload schema';":""},Ja=Y=>{const re=Y?.message?String(Y.message):"";return re.toLowerCase().includes("schema cache")||re.toLowerCase().includes("could not find the table")?"Parece que en Supabase an no existe (o no se ha refrescado) la tabla `public.order_calendar`. Ejecuta `supabase/schema.sql` en Supabase (SQL Editor) y luego recarga el schema con: NOTIFY pgrst, 'reload schema';":""};ze.useEffect(()=>{let Y=!1;async function re(){X({loading:!0,message:Js?"Conectando a Supabase...":"Cargando datos locales...",type:"info"});try{const[le,De,Ie]=await Promise.all([At.getMedications(),At.getMonthlyBatches(),At.getSelectedMonthlyBatchId?.()]);if(Y)return;l(le??[]);const Ue=(De??[]).map(qe=>({...qe,id:qe?.id!=null?String(qe.id):qe.id}));G(Ue);try{const qe=await At.getTertiaryPackaging?.()??[];Y||V(qe??[])}catch(qe){const ut=sa(qe);Y||(V([]),L({loading:!1,message:ut?`${String(qe?.message||qe||"Error al cargar Empaque Terciario.")}. ${ut}`:String(qe?.message||qe||"Error al cargar Empaque Terciario."),type:"error"}))}try{const qe=await At.getMedicationCategories?.()??[];Y||at(qe??[])}catch(qe){const ut=zr(qe);Y||(at([]),P({loading:!1,message:ut?`${String(qe?.message||qe||"Error al cargar Categoras.")}. ${ut}`:String(qe?.message||qe||"Error al cargar Categoras."),type:"error"}))}try{const qe=await At.getOrderCalendar?.()??[];Y||Mt(qe??[])}catch(qe){const ut=Ja(qe);Y||(Mt([]),Xr({loading:!1,message:ut?`${String(qe?.message||qe||"Error al cargar Calendario.")}. ${ut}`:String(qe?.message||qe||"Error al cargar Calendario."),type:"error"}))}const $e=Ie!=null?String(Ie):null,Qe=Ue?.[0]?.id??null,Ze=$e&&Ue.some(qe=>qe.id===$e)?$e:Qe;pe(Ze),await At.setSelectedMonthlyBatchId?.(Ze),X({loading:!1,message:"",type:""})}catch(le){if(Y)return;X({loading:!1,message:le?.message?String(le.message):"No se pudieron cargar los datos.",type:"error"})}}return re(),()=>{Y=!0}},[]);const cr=Y=>{const re=Y==null?null:String(Y);pe(re),At.setSelectedMonthlyBatchId?.(re)},mr=Y=>{const re=String(Y??"").trim();if(!re)return"";const le=re.replace(/\D/g,"");return le.length===9?`${le.slice(0,3)}-${le.slice(3,5)}-${le.slice(5,9)}`:re.replace(/\s+/g," ")},gt=Y=>{const re=String(Y??"").trim();if(!re)return 0;const le=re.replace(/\s/g,""),De=le.includes(","),Ie=le.includes(".");let Ue=le;De&&Ie?Ue=le.replace(/,/g,""):De&&!Ie&&(Ue=le.replace(/,/g,"."));const $e=Number.parseFloat(Ue);return Number.isFinite($e)?$e:0},Gt=ze.useMemo(()=>s.filter(Y=>Y.stock<=Y.min_stock),[s]),ia=ze.useMemo(()=>({totalItems:s.length,lowStockCount:Gt.length,totalStockValue:s.reduce((Y,re)=>Y+re.stock,0),recentConsumptions:Se[0]?.items?.length||0}),[s,Gt,Se]),Rt=ze.useMemo(()=>{const Y=String(h||"772"),re=c.trim().toLowerCase(),le=({siges_code:$e,name:Qe})=>{const Ke=String($e||"").trim();if(Ke)return`code:${Ke.toLowerCase()}`;const Ze=String(Qe||"").trim().toLowerCase();return Ze?`name:${Ze}`:""},De=$e=>{$e.sort((Qe,Ke)=>{const Ze=String(Qe.batch).localeCompare(String(Ke.batch));return Ze!==0?Ze:String(Qe.expiry_date).localeCompare(String(Ke.expiry_date))})},Ie=$e=>{const Qe=[],Ke=new Map;for(const Ze of $e){const qe=String(Ze.siges_code||"").trim(),ut=String(Ze.name||"").trim(),Pe=`${qe}||${ut}`.toLowerCase(),Ve=Ke.get(Pe),Ge={id:Ze.id,batch:String(Ze.batch||"").trim()||"S/N",expiry_date:Ze.expiry_date?String(Ze.expiry_date).trim():"",stock:Number(Ze.stock)||0};if(Ve)Ve.lots.push(Ge),Ve.stock+=Ge.stock;else{const Ye={id:`group:${Pe}`,inventory_type:"771",siges_code:qe,name:ut,lots:[Ge],stock:Ge.stock};Ke.set(Pe,Ye),Qe.push(Ye)}}for(const Ze of Qe)De(Ze.lots);return Qe};if(Y==="771"){const $e=s.filter(Ke=>String(Ke.inventory_type||"772")==="771"),Qe=Ie($e);return re?Qe.filter(Ke=>{const Ze=Ke.lots.map(ut=>`${ut.batch} ${ut.expiry_date} ${ut.stock}`).join(" ");return`${Ke.siges_code} ${Ke.name} ${Ze}`.toLowerCase().includes(re)}):Qe}if(Y==="total"){const $e=(()=>{const Ve=(Se??[]).slice().sort((Ye,pt)=>{const et=new Date(Ye?.created_at||Ye?.updated_at||0).getTime();return new Date(pt?.created_at||pt?.updated_at||0).getTime()-et}).slice(0,4),Ge=new Map;for(const Ye of Ve)for(const pt of Ye?.items??[]){const et=mr(pt?.siges_code);if(!et)continue;const gr=Number(pt?.quantity)||0;Ge.set(et,(Ge.get(et)||0)+gr)}return Ge})(),Qe=new Map,Ke=({siges_code:Pe,name:Ve})=>{const Ge=le({siges_code:Pe,name:Ve});if(!Ge)return null;const Ye=Qe.get(Ge);if(Ye)return Ye;const pt={id:`total:${Ge}`,inventory_type:"total",siges_code:String(Pe||"").trim(),name:String(Ve||"").trim(),lots:[],stock772:0,stock771:0,stock:0};return Qe.set(Ge,pt),pt};for(const Pe of s){const Ve=String(Pe.inventory_type||"772");if(Ve!=="771"&&Ve!=="772")continue;const Ge=Ke({siges_code:Pe.siges_code,name:Pe.name});if(Ge)if(Ge.siges_code||(Ge.siges_code=String(Pe.siges_code||"").trim()),Ge.name||(Ge.name=String(Pe.name||"").trim()),Ve==="772")Ge.stock772+=Number(Pe.stock)||0;else{const Ye={id:Pe.id,batch:String(Pe.batch||"").trim()||"S/N",expiry_date:Pe.expiry_date?String(Pe.expiry_date).trim():"",stock:Number(Pe.stock)||0};Ge.lots.push(Ye),Ge.stock771+=Ye.stock}}const Ze=Array.from(Qe.values()).map(Pe=>(De(Pe.lots),Pe.stock=Pe.stock772+Pe.stock771,Pe)),qe=(Se??[]).some(Pe=>(Pe?.items??[]).length>0),ut=g&&qe?Ze.filter(Pe=>{const Ve=String(Pe.siges_code||"").trim();return Ve?($e.get(Ve)||0)>0:!1}):Ze;return re?ut.filter(Pe=>{const Ve=Pe.lots.map(Ye=>`${Ye.batch} ${Ye.expiry_date} ${Ye.stock}`).join(" ");return`${Pe.siges_code} ${Pe.name} ${Pe.stock772} ${Pe.stock771} ${Pe.stock} ${Ve}`.toLowerCase().includes(re)}):ut}const Ue=s.filter($e=>String($e.inventory_type||"772")===Y);return re?Ue.filter($e=>`${$e.siges_code} ${$e.name} ${$e.category} ${$e.batch} ${$e.expiry_date} ${$e.unit}`.toLowerCase().includes(re)):Ue},[g,c,s,h,Se]),rr=b?.[String(h||"772")]??1,Ma=ze.useMemo(()=>{const Y=v||50,re=Math.max(1,Math.ceil(Rt.length/Y)),De=(Math.min(Math.max(rr,1),re)-1)*Y;return Rt.slice(De,De+Y)},[Rt,rr,v]),Wr=ze.useMemo(()=>{const Y=String(h||"772");return Y==="total"?Rt.length:Y!=="771"?s.filter(re=>String(re.inventory_type||"772")===Y).length:Rt.length},[Rt,h,s]),fo=ze.useMemo(()=>(Se??[]).some(Y=>(Y?.items??[]).length>0),[Se]),Zi=async()=>{try{L({loading:!0,message:"Sincronizando...",type:"info"});const Y=await At.getTertiaryPackaging?.()??[];V(Y),L({loading:!1,message:`Sincronizado: ${Y.length} registros.`,type:"success"}),window.setTimeout(()=>L({loading:!1,message:"",type:""}),4e3)}catch(Y){const re=sa(Y);L({loading:!1,message:re?`${String(Y?.message||"No se pudo sincronizar.")}. ${re}`:Y?.message?String(Y.message):"No se pudo sincronizar.",type:"error"})}},el=async()=>{try{P({loading:!0,message:"Sincronizando...",type:"info"});const Y=await At.getMedicationCategories?.()??[];at(Y),P({loading:!1,message:`Sincronizado: ${Y.length} registros.`,type:"success"}),window.setTimeout(()=>P({loading:!1,message:"",type:""}),4e3)}catch(Y){const re=zr(Y);P({loading:!1,message:re?`${String(Y?.message||"No se pudo sincronizar.")}. ${re}`:Y?.message?String(Y.message):"No se pudo sincronizar.",type:"error"})}},Hn=async()=>{try{Xr({loading:!0,message:"Sincronizando...",type:"info"});const Y=await At.getOrderCalendar?.()??[];Mt(Y),Xr({loading:!1,message:`Sincronizado: ${Y.length} registros.`,type:"success"}),window.setTimeout(()=>Xr({loading:!1,message:"",type:""}),4e3)}catch(Y){const re=Ja(Y);Xr({loading:!1,message:re?`${String(Y?.message||"No se pudo sincronizar.")}. ${re}`:Y?.message?String(Y.message):"No se pudo sincronizar.",type:"error"})}},vs=async Y=>{try{Xr({loading:!0,message:"Guardando...",type:"info"}),await At.upsertOrderCalendarEntries?.(Y);const re=await At.getOrderCalendar?.()??[];Mt(re),Xr({loading:!1,message:"Calendario actualizado.",type:"success"}),window.setTimeout(()=>Xr({loading:!1,message:"",type:""}),2500)}catch(re){const le=Ja(re);Xr({loading:!1,message:le?`${String(re?.message||"No se pudo guardar.")}. ${le}`:re?.message?String(re.message):"No se pudo guardar.",type:"error"})}},ys=async Y=>{try{P({loading:!0,message:"Guardando...",type:"info"}),await At.upsertMedicationCategories?.([Y]);const re=await At.getMedicationCategories?.()??[];at(re),P({loading:!1,message:"Categora actualizada.",type:"success"}),window.setTimeout(()=>P({loading:!1,message:"",type:""}),2500)}catch(re){const le=zr(re);P({loading:!1,message:le?`${String(re?.message||"No se pudo guardar.")}. ${le}`:re?.message?String(re.message):"No se pudo guardar.",type:"error"})}},wa=async Y=>{if(!(!Y?.id||!window.confirm("Desea eliminar esta categora?")))try{P({loading:!0,message:"Eliminando...",type:"info"}),await At.deleteMedicationCategory?.(Y.id);const le=await At.getMedicationCategories?.()??[];at(le),P({loading:!1,message:"Categora eliminada.",type:"success"}),window.setTimeout(()=>P({loading:!1,message:"",type:""}),2500)}catch(le){const De=zr(le);P({loading:!1,message:De?`${String(le?.message||"No se pudo eliminar.")}. ${De}`:le?.message?String(le.message):"No se pudo eliminar.",type:"error"})}},_s=()=>{const Y=[["CODIGO","MEDICAMENTO","EMPAQUE TERCIARIO"],["110-16-0010","PARACETAMOL 500 MG., TABLETAS",200]],re=Ws.aoa_to_sheet(Y),le=Ws.book_new();Ws.book_append_sheet(le,re,"Empaque"),Ry(le,"empaque_terciario.xlsx")},$n=async()=>{if(window.confirm("Desea eliminar toda la carga de Empaque Terciario? Esta accin no se puede deshacer."))try{L({loading:!0,message:"Eliminando...",type:"info"}),await At.clearTertiaryPackaging?.(),V([]),L({loading:!1,message:"Carga eliminada.",type:"success"}),window.setTimeout(()=>L({loading:!1,message:"",type:""}),4e3)}catch(re){const le=sa(re);L({loading:!1,message:le?`${String(re?.message||"No se pudo eliminar la carga.")}. ${le}`:re?.message?String(re.message):"No se pudo eliminar la carga.",type:"error"})}},ho=Y=>{const re=Y.target.files?.[0];if(!re)return;L({loading:!0,message:`Procesando: ${re.name}`,type:"info"});const le=new FileReader;le.onerror=()=>{L({loading:!1,message:"No se pudo leer el archivo.",type:"error"})},le.onload=async De=>{try{const Ie=De.target?.result,Ue=$u(Ie,{type:"array"}),$e=Ue.SheetNames?.[0];if(!$e)throw new Error("El XLSX no tiene hojas.");const Qe=Ue.Sheets[$e],Ke=Ws.sheet_to_json(Qe,{header:1,raw:!1,blankrows:!1}),Ze=Array.isArray(Ke)?Ke:[],ut=(Ye=>{const pt=Sa=>String(Sa??"").trim().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]/g,""),et=pt(Ye?.[0]),gr=pt(Ye?.[1]),Qt=pt(Ye?.[2]);return et.includes("siges")||et.includes("codigo")||gr.includes("medicamento")||Qt.includes("cantidad")})(Ze?.[0])?Ze.slice(1):Ze,Pe=new Map((s??[]).map(Ye=>[mr(Ye.siges_code),String(Ye.name||"").trim()]).filter(([Ye])=>!!Ye)),Ve=ut.map((Ye,pt)=>{const et=mr(Ye?.[0]),Qt=String(Ye?.[1]??"").trim()||Pe.get(et)||"",Sa=gt(Ye?.[2]);return et?{id:globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():String(Date.now())+pt,siges_code:et,medication_name:Qt,tertiary_quantity:Sa}:null}).filter(Boolean),Ge=await At.upsertTertiaryPackaging?.(Ve)??Ve;V(Ge),L({loading:!1,message:`Empaque Terciario: ${Ve.length} registros importados/actualizados.`,type:"success"}),window.setTimeout(()=>L({loading:!1,message:"",type:""}),4e3)}catch(Ie){const Ue=sa(Ie);L({loading:!1,message:Ue?`${String(Ie?.message||"Error al procesar/guardar el XLSX.")}. ${Ue}`:Ie?.message?String(Ie.message):"Error al procesar/guardar el XLSX.",type:"error"})}},le.readAsArrayBuffer(re),Y.target.value=null},tl=Y=>{const re=String(Y??"").trim();if(!re)return"";const le=re.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s+/g," ").trim();return le==="ordinario"?"Ordinario":le==="frio"?"Fro":le==="estupefaciente"?"Estupefaciente":le==="psicotropico"?"Psicotrpico":le==="alcohol"?"Alcohol":le==="suero"?"Suero":le==="compra local"||le==="compralocal"?"Compra Local":""},ci=()=>{const Y=[["CODIGO","MEDICAMENTO","CATEGORIA"],["110-16-0010","PARACETAMOL 500 MG., TABLETAS","Ordinario"]],re=Ws.aoa_to_sheet(Y),le=Ws.book_new();Ws.book_append_sheet(le,re,"Categorias"),Ry(le,"categorias.xlsx")},Vn=async()=>{if(window.confirm("Desea eliminar toda la carga de Categoras? Esta accin no se puede deshacer."))try{P({loading:!0,message:"Eliminando...",type:"info"}),await At.clearMedicationCategories?.(),at([]),P({loading:!1,message:"Carga eliminada.",type:"success"}),window.setTimeout(()=>P({loading:!1,message:"",type:""}),4e3)}catch(re){const le=zr(re);P({loading:!1,message:le?`${String(re?.message||"No se pudo eliminar la carga.")}. ${le}`:re?.message?String(re.message):"No se pudo eliminar la carga.",type:"error"})}},mo=Y=>{const re=Y.target.files?.[0];if(!re)return;P({loading:!0,message:`Procesando: ${re.name}`,type:"info"});const le=new FileReader;le.onerror=()=>{P({loading:!1,message:"No se pudo leer el archivo.",type:"error"})},le.onload=async De=>{try{const Ie=De.target?.result,Ue=$u(Ie,{type:"array"}),$e=Ue.SheetNames?.[0];if(!$e)throw new Error("El XLSX no tiene hojas.");const Qe=Ue.Sheets[$e],Ke=Ws.sheet_to_json(Qe,{header:1,raw:!1,blankrows:!1}),Ze=Array.isArray(Ke)?Ke:[],ut=(Ye=>{const pt=Sa=>String(Sa??"").trim().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]/g,""),et=pt(Ye?.[0]),gr=pt(Ye?.[1]),Qt=pt(Ye?.[2]);return et.includes("codigo")||et.includes("siges")||gr.includes("medicamento")||Qt.includes("categoria")})(Ze?.[0])?Ze.slice(1):Ze,Pe=[];let Ve=0;for(let Ye=0;Ye<ut.length;Ye+=1){const pt=ut[Ye],et=mr(pt?.[0]),gr=String(pt?.[1]??"").trim(),Qt=tl(pt?.[2]);if(et){if(!Qt){Ve+=1;continue}Pe.push({id:globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():String(Date.now())+Ye,siges_code:et,medication_name:gr,category:Qt})}}const Ge=await At.upsertMedicationCategories?.(Pe)??Pe;at(Ge),P({loading:!1,message:`Categoras: ${Pe.length} registros importados/actualizados.${Ve?` (${Ve} filas con categora invlida omitidas)`:""}`,type:"success"}),window.setTimeout(()=>P({loading:!1,message:"",type:""}),4e3)}catch(Ie){const Ue=zr(Ie);P({loading:!1,message:Ue?`${String(Ie?.message||"Error al procesar/guardar el XLSX.")}. ${Ue}`:Ie?.message?String(Ie.message):"Error al procesar/guardar el XLSX.",type:"error"})}},le.readAsArrayBuffer(re),Y.target.value=null},Nn=ze.useMemo(()=>{const Y=Et.trim().toLowerCase(),re=(St??[]).map(le=>({...le,siges_code:mr(le?.siges_code),medication_name:String(le?.medication_name||"").trim(),category:String(le?.category||"").trim()}));return Y?re.filter(le=>`${le.siges_code} ${le.medication_name} ${le.category}`.toLowerCase().includes(Y)):re},[Et,St]),ws=ze.useMemo(()=>{const Y=br||50,re=Math.max(1,Math.ceil(Nn.length/Y)),De=(Math.min(Math.max(Be,1),re)-1)*Y;return Nn.slice(De,De+Y)},[Be,br,Nn]),On=ze.useMemo(()=>{const Y=M.trim().toLowerCase(),re=(N??[]).map(le=>{const De=mr(le?.siges_code),Ie=(s??[]).find(Ue=>mr(Ue.siges_code)===De)?.name;return{...le,siges_code:De,medication_name:String(le?.medication_name||Ie||"").trim(),tertiary_quantity:Number(le?.tertiary_quantity)||0}});return Y?re.filter(le=>`${le.siges_code} ${le.medication_name}`.toLowerCase().includes(Y)):re},[s,N,M]),ui=ze.useMemo(()=>{const Y=Ee||50,re=Math.max(1,Math.ceil(On.length/Y)),De=(Math.min(Math.max(te,1),re)-1)*Y;return On.slice(De,De+Y)},[On,te,Ee]),fi=()=>{T(null),k(!0)},A=Y=>{T(Y),k(!0)},U=async()=>{const Y=await At.getMedications();l(Y??[])},D=async Y=>{Y.preventDefault();const re=new FormData(Y.target),le={id:O?O.id:globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():Date.now(),inventory_type:O?.inventory_type??String(h||"772"),siges_code:O?.siges_code??"",sicop_classifier:O?.sicop_classifier??"",sicop_identifier:O?.sicop_identifier??"",name:String(re.get("name")||"").trim(),category:String(re.get("category")||"").trim(),batch:String(re.get("batch")||"").trim(),expiry_date:String(re.get("expiry_date")||"").trim(),stock:Number.parseFloat(String(re.get("stock")||"0"))||0,min_stock:Number.parseFloat(String(re.get("min_stock")||"0"))||0,unit:String(re.get("unit")||"").trim()};try{X({loading:!0,message:"Guardando...",type:"info"}),await At.upsertMedication(le),await U(),T(null),k(!1),X({loading:!1,message:"",type:""})}catch(De){X({loading:!1,message:De?.message?String(De.message):"No se pudo guardar el medicamento.",type:"error"})}},F=async Y=>{try{X({loading:!0,message:"Eliminando...",type:"info"}),await At.deleteMedication(Y),await U(),X({loading:!1,message:"",type:""})}catch(re){X({loading:!1,message:re?.message?String(re.message):"No se pudo eliminar el medicamento.",type:"error"})}},B=async()=>{try{X({loading:!0,message:"Eliminando catlogo...",type:"info"}),await At.clearMedications(),await U(),X({loading:!1,message:"",type:""})}catch(Y){X({loading:!1,message:Y?.message?String(Y.message):"No se pudo limpiar el catlogo.",type:"error"})}},H=({siges_code:Y,name:re})=>{const le=String(Y||"").trim();if(le)return`code:${le}`;const De=String(re||"").trim().toLowerCase();return De?`name:${De}`:""},ie=Y=>{const re=String(Y??"").trim();if(!re)return 0;const le=re.replace(/\s/g,""),De=le.includes(","),Ie=le.includes(".");let Ue=le;De&&Ie?Ue=le.replace(/,/g,""):De&&!Ie&&(Ue=le.replace(/,/g,"."));const $e=Number.parseFloat(Ue);return Number.isFinite($e)?$e:0},_e=Y=>{const re=String(Y??"").trim();if(!re)return null;const le=re.slice(0,10);if(/^\d{4}-\d{2}-\d{2}$/.test(le))return le;const De=re.replace(/\D/g,"");if(De.length===8){const $e=De.slice(0,4),Qe=De.slice(4,6),Ke=De.slice(6,8);return`${$e}-${Qe}-${Ke}`}const Ie=re.match(/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/);if(Ie){const $e=Ie[1].padStart(2,"0"),Qe=Ie[2].padStart(2,"0");return`${Ie[3]}-${Qe}-${$e}`}const Ue=new Date(re);return Number.isNaN(Ue.getTime())?null:Ue.toISOString().slice(0,10)},se=(Y,re,le=[])=>{if(!Y)return"";for(const De of re){const Ie=Y.getElementsByTagName(De)?.[0],Ue=Ie?.textContent!=null?String(Ie.textContent).trim():"";if(Ue)return Ue}for(const De of le){const Ie=Y.getAttribute?.(De);if(Ie!=null&&String(Ie).trim())return String(Ie).trim()}return""},fe=Y=>{const le=Array.from(Y.getElementsByTagNameNS("*","FormattedAreaPair")).filter($e=>$e.getAttribute("Level")==="4"&&$e.getAttribute("Type")==="Group");if(!le.length)return null;const De=($e,Qe)=>{const Ke=Array.from($e.getElementsByTagNameNS("*","FormattedReportObject"));for(const Ze of Ke){const qe=Ze.getAttribute?.("FieldName");if(!qe||!Qe(qe))continue;const ut=Ze.getElementsByTagNameNS("*","Value")?.[0],Pe=Ze.getElementsByTagNameNS("*","FormattedValue")?.[0],Ge=((ut?.textContent!=null?String(ut.textContent):"")||(Pe?.textContent!=null?String(Pe.textContent):"")).trim();if(Ge)return Ge}return""},Ie=$e=>Qe=>String(Qe).includes($e),Ue=[];for(const $e of le){const Qe=De($e,Ie(".PRODUCTO}")),Ke=De($e,Ie(".DSC_PRODUCTO}")),Ze=mr(Qe),qe=String(Ke||"").trim();if(!Ze||!qe)continue;const ut=Array.from($e.getElementsByTagNameNS("*","FormattedAreaPair")).filter(Pe=>Pe.getAttribute("Level")==="5"&&Pe.getAttribute("Type")==="Details");for(const Pe of ut){const Ve=De(Pe,Ie(".IDE_LOTE}"))||"S/N",Ge=De(Pe,Ie(".CAN_LOTE}"))||"0",Ye=De(Pe,Ie(".FEC_VENCIMIENTO}")),pt=ie(Ge),et=_e(Ye);Ue.push({siges_code:Ze,name:qe,batch:String(Ve).trim()||"S/N",expiry_date:et,stock:pt})}}return Ue},he=Y=>{const le=new DOMParser().parseFromString(String(Y||""),"application/xml");if(le.querySelector("parsererror"))throw new Error("XML invlido o mal formado.");const De=fe(le);if(Array.isArray(De))return De;const Ie=["CodigoSIGES","CodigoSiges","codigoSIGES","codigoSiges","Codigo","codigo","SIGES","Siges","siges_code"],Ue=["Medicamento","medicamento","Nombre","nombre","Descripcion","descripcion","Medication"],$e=["Lote","lote","Batch","batch","LoteMedicamento","loteMedicamento"],Qe=["Vencimiento","vencimiento","FechaVencimiento","fechaVencimiento","FechaCaducidad","fechaCaducidad","expiry_date","ExpiryDate"],Ke=["Inventario","inventario","Stock","stock","Existencia","existencia","Cantidad","cantidad"],Ze=new Set;for(const ut of Ie){const Pe=le.getElementsByTagName(ut);for(const Ve of Pe){let Ge=Ve.parentElement,Ye=0;for(;Ge&&Ge!==le.documentElement&&Ye<6;){const pt=!!se(Ge,$e,["lote","Lote","batch","Batch"]),et=!!se(Ge,Qe,["vencimiento","Vencimiento","expiry","Expiry"]),gr=!!se(Ge,Ke,["inventario","Inventario","stock","Stock"]);if(pt||et||gr)break;Ge=Ge.parentElement,Ye+=1}Ge&&Ze.add(Ge)}}const qe=[];for(const ut of Ze){const Pe=se(ut,Ie,["CodigoSIGES","codigoSIGES","siges_code","Codigo","codigo"]),Ve=se(ut,Ue,["Medicamento","medicamento","Nombre","nombre"]).trim(),Ge=se(ut,$e,["Lote","lote","Batch","batch"]).trim(),Ye=se(ut,Qe,["Vencimiento","vencimiento","ExpiryDate","expiry_date"]).trim(),pt=se(ut,Ke,["Inventario","inventario","Stock","stock"]).trim();!Pe||!Ve||qe.push({siges_code:mr(Pe),name:Ve||"Sin nombre",batch:Ge||"S/N",expiry_date:_e(Ye),stock:ie(pt)})}return qe},Oe=({siges_code:Y,name:re,batch:le,expiry_date:De})=>{const Ie=String(Y||"").trim(),Ue=String(re||"").trim().toLowerCase(),$e=String(le||"").trim().toLowerCase(),Qe=De?String(De).trim():"";return Ie?`code:${Ie}|lot:${$e}|exp:${Qe}`:`name:${Ue}|lot:${$e}|exp:${Qe}`},Fe=async({text:Y})=>{const le=he(Y),De=[],Ie=new Set;for(const Ve of le){const Ge=Oe(Ve);!Ge||Ie.has(Ge)||(Ie.add(Ge),De.push(Ve))}const $e=(await At.getMedications()??[]).filter(Ve=>String(Ve.inventory_type||"772")==="771"),Qe=new Map($e.map(Ve=>[Oe(Ve),Ve.id]).filter(([Ve])=>!!Ve)),Ke=Date.now(),Ze=De.map((Ve,Ge)=>{const Ye=Oe(Ve);return{id:Qe.get(Ye)??(globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():Ke+Ge),inventory_type:"771",siges_code:Ve.siges_code,sicop_classifier:"",sicop_identifier:"",name:Ve.name,category:"General",batch:Ve.batch||"S/N",expiry_date:Ve.expiry_date,stock:Ve.stock,min_stock:0,unit:"Unidad"}});await At.upsertMedications(Ze);const qe=await At.getMedications()??[],ut=qe.filter(Ve=>String(Ve.inventory_type||"772")==="771").length,Pe=qe.reduce((Ve,Ge)=>{const Ye=String(Ge.inventory_type||"772");return Ve[Ye]=(Ve[Ye]||0)+1,Ve},{});return await U(),{importedCount:Ze.length,visibleCountForType:ut,totalCountByType:Pe}},He=Y=>{const re=Ue=>String(Ue??"").trim().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]/g,""),le=re(Y?.[0]),De=re(Y?.[1]),Ie=re(Y?.[2]);return le.includes("siges")||le.includes("codigosiges")||De.includes("medicamento")||De.includes("nombre")||Ie.includes("inventario")||Ie.includes("stock")},Re=async({text:Y,type:re})=>{const le=String(re||"772").trim()||"772",De=Yx(Y),Ie=He(De?.[0])?De.slice(1):De,Ue=Ie.some(et=>{const gr=String(et?.[0]??"").trim(),Qt=String(et?.[1]??"").trim();return!!(gr&&Qt)}),$e=Ue?null:Jx(Y),Ke=(await At.getMedications()??[]).filter(et=>String(et.inventory_type||"772")===le),Ze=new Map(Ke.map(et=>[H(et),et.id]).filter(([et])=>!!et)),qe=Date.now(),ut=(Ie??[]).map((et,gr)=>{if(!Ue)return null;const Qt=String(et?.[0]??"").trim(),Sa=String(et?.[1]??"").trim();if(!Qt||!Sa)return null;const bs=H({siges_code:Qt,name:Sa});return bs?{id:Ze.get(bs)??(globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():qe+gr),inventory_type:le,siges_code:Qt,sicop_classifier:"",sicop_identifier:"",name:Sa,category:"General",batch:"S/N",expiry_date:dd(""),stock:ie(et?.[2]),min_stock:0,unit:"Unidad"}:null}).filter(Boolean),Pe=($e??[]).map((et,gr)=>{if(Ue)return null;const Qt=String(et.CodigoSIGES||"").trim(),Sa=String(et.Medicamento||et.Nombre||"").trim(),bs=H({siges_code:Qt,name:Sa});return bs?{id:Ze.get(bs)??(globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():qe+gr),inventory_type:le,siges_code:Qt,sicop_classifier:String(et.ClasificadorSICOP||"").trim(),sicop_identifier:String(et.IdentificadorSICOP||"").trim(),name:Sa||"Sin nombre",category:String(et.Categoria||"General").trim()||"General",batch:String(et.Lote||"S/N").trim()||"S/N",expiry_date:dd(et.Vencimiento),stock:ie(et.Stock),min_stock:ie(et.StockMinimo||0),unit:String(et.Unidad||"Unidad").trim()||"Unidad"}:null}).filter(Boolean),Ve=Ue?ut:Pe;await At.upsertMedications(Ve);const Ge=await At.getMedications()??[],Ye=Ge.filter(et=>String(et.inventory_type||"772")===le).length,pt=Ge.reduce((et,gr)=>{const Qt=String(gr.inventory_type||"772");return et[Qt]=(et[Qt]||0)+1,et},{});return await U(),{importedCount:Ve.length,visibleCountForType:Ye,totalCountByType:pt}},je=Y=>{const re=Y.target.files?.[0];if(!re)return;K({loading:!0,message:"Procesando archivo...",type:"info"});const le=new FileReader;le.onerror=()=>{K({loading:!1,message:"No se pudo leer el archivo.",type:"error"})},le.onload=async De=>{try{const Ie=String(De.target?.result||""),Ue=Jx(Ie),$e=Date.now(),Qe=Ue.map((Ke,Ze)=>({id:globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():$e+Ze,inventory_type:"772",siges_code:String(Ke.CodigoSIGES||"").trim(),sicop_classifier:String(Ke.ClasificadorSICOP||"").trim(),sicop_identifier:String(Ke.IdentificadorSICOP||"").trim(),name:Ke.Medicamento||Ke.Nombre||"Sin nombre",category:Ke.Categoria||"General",batch:Ke.Lote||"S/N",expiry_date:dd(Ke.Vencimiento),stock:ie(Ke.Stock),min_stock:ie(Ke.StockMinimo||10),unit:Ke.Unidad||"Unidad"}));await At.upsertMedications(Qe),await U(),K({loading:!1,message:`Se han importado ${Qe.length} medicamentos con xito.`,type:"success"}),window.setTimeout(()=>K({loading:!1,message:"",type:""}),4e3)}catch(Ie){const Ue=Ie?.message?String(Ie.message):"",Qe=Ue.includes("invalid input syntax for type integer")?"Tu base de datos en Supabase tiene `stock`/`min_stock` como INTEGER. Ejecuta `supabase/schema.sql` (ALTER COLUMN a NUMERIC) o usa valores enteros.":"";K({loading:!1,message:Qe?`${Ue}. ${Qe}`:Ue||"Error al procesar/guardar el CSV.",type:"error"})}},le.readAsText(re),Y.target.value=null},We=Y=>{const re=String(Y||h||"772");if(re!=="total")return re==="771"?$E(re):HE(re)},qt=Y=>{const re=Y.target.files?.[0];if(!re)return;const le=String(h||"772");if(le==="total"){ee({loading:!1,message:"Inventario total no admite carga de archivos.",type:"error"}),Y.target.value=null;return}const De=String(re.name||"").toLowerCase(),Ie=De.endsWith(".xml"),Ue=De.endsWith(".csv");if(le==="771"&&!Ie){ee({loading:!1,message:"Para inventario 771, selecciona un archivo .xml.",type:"error"}),Y.target.value=null;return}if(le!=="771"&&!Ue){ee({loading:!1,message:"Para inventario 772, selecciona un archivo .csv.",type:"error"}),Y.target.value=null;return}ee({loading:!0,message:`Procesando inventario ${le}: ${re.name}`,type:"info"});const $e=new FileReader;$e.onerror=()=>{ee({loading:!1,message:"No se pudo leer el archivo.",type:"error"})},$e.onload=async Qe=>{try{const Ke=String(Qe.target?.result||""),Ze=le==="771"?await Fe({text:Ke}):await Re({text:Ke,type:le}),qe=Ze?.importedCount??0,ut=Ze?.visibleCountForType??0,Pe=qe>0&&ut===0&&mu==="supabase"&&Js?"Import datos pero no se pueden listar. Revisa RLS/policies en Supabase para `medications` (SELECT/ALL para `anon`).":"";ee({loading:!1,message:`Inventario ${le}: ${qe} medicamentos importados/actualizados.${Pe?` ${Pe}`:""}`,type:"success"}),window.setTimeout(()=>ee({loading:!1,message:"",type:""}),4e3)}catch(Ke){const Ze=Ke?.message?String(Ke.message):"",ut=Ze.includes("invalid input syntax for type integer")?"Tu base de datos en Supabase tiene `stock`/`min_stock` como INTEGER. Ejecuta `supabase/schema.sql` (ALTER COLUMN a NUMERIC) y vuelve a intentar.":"";ee({loading:!1,message:ut?`${Ze}. ${ut}`:Ze||`Error al procesar/guardar el ${le==="771"?"XML":"CSV"}.`,type:"error"})}},$e.readAsText(re),Y.target.value=null},Xt=async Y=>{const re=String(Y||h||"772");if(!(re==="total"||!window.confirm(`Desea eliminar toda la carga del inventario ${re}? Esta accin no se puede deshacer.`)))try{ee({loading:!0,message:`Eliminando inventario ${re}...`,type:"info"}),await At.clearMedicationsByInventoryType?.(re),await U(),ee({loading:!1,message:`Inventario ${re} eliminado.`,type:"success"}),window.setTimeout(()=>ee({loading:!1,message:"",type:""}),4e3)}catch(De){ee({loading:!1,message:De?.message?String(De.message):"No se pudo eliminar el inventario.",type:"error"})}},er=Y=>String(Y||"").replace(/\.[^/.]+$/,"").trim()||"Mes sin nombre",ba=Y=>{const re=Y.target.files?.[0];if(!re)return;const le=er(re.name);Ce({loading:!0,message:`Procesando: ${re.name}`,type:"info"});const De=new FileReader;De.onerror=()=>{Ce({loading:!1,message:"No se pudo leer el archivo.",type:"error"})},De.onload=async Ie=>{try{const Ue=String(Ie.target?.result||""),$e=Yx(Ue),Qe=Ve=>(Ve||[]).some(Ge=>/codigo|siges|medicamento|consumo|costo/i.test(String(Ge||""))),Ke=Ve=>{const Ge=String(Ve??"").trim();if(!Ge)return 0;const Ye=Ge.includes(",")&&Ge.includes(".")?Ge.replace(/,/g,""):Ge.includes(",")&&!Ge.includes(".")?Ge.replace(/,/g,"."):Ge,pt=Number.parseFloat(Ye.replace(/\s+/g,""));return Number.isFinite(pt)?pt:0},qe=(Qe($e[0])?$e.slice(1):$e).map(Ve=>{const Ge=String(Ve?.[0]??"").trim(),Ye=String(Ve?.[1]??"").trim(),pt=Ke(Ve?.[2]),et=Ke(Ve?.[3]);return!Ge||!Ye?null:{id:globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():String(Date.now())+Math.random(),siges_code:Ge,medication_name:Ye,quantity:pt,cost:et}}).filter(Boolean),ut=await At.saveMonthlyBatch({id:globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():String(Date.now()),label:le,items:qe}),Pe=await At.getMonthlyBatches();G(Pe??[]),cr(ut?.id??null),Ce({loading:!1,message:`Mes "${le}": ${qe.length} registros importados.`,type:"success"}),window.setTimeout(()=>Ce({loading:!1,message:"",type:""}),4e3)}catch(Ue){Ce({loading:!1,message:Ue?.message?String(Ue.message):"Error al procesar/guardar el CSV.",type:"error"})}},De.readAsText(re),Y.target.value=null},pn=async()=>{try{Ce({loading:!0,message:"Sincronizando consumos...",type:"info"});const re=(await At.getMonthlyBatches()??[]).map(Qe=>({...Qe,id:Qe?.id!=null?String(Qe.id):Qe.id}));G(re);const le=ne!=null?String(ne):null,Ie=le&&re.some(Qe=>Qe.id===le)?le:re?.[0]?.id??null;cr(Ie);const Ue=mu==="supabase"&&Js?`supabase${du?` (${du})`:""}`:`local${Js?" (Supabase disponible pero no seleccionado)":" (Supabase no configurado)"}`,$e=re.length===0&&mu==="supabase"&&Js?"Si en Supabase ves meses cargados, revisa RLS/policies para `anon` (SELECT en `monthly_batches`).":re.length===0?"Si tus consumos estn en Supabase, configura `VITE_SUPABASE_URL` y `VITE_SUPABASE_ANON_KEY` y usa `VITE_DATA_PROVIDER=supabase`.":"";Ce({loading:!1,message:`Sincronizado (${Ue}): ${re.length} meses encontrados.${$e?` ${$e}`:""}`,type:"success"}),window.setTimeout(()=>Ce({loading:!1,message:"",type:""}),4e3)}catch(Y){Ce({loading:!1,message:Y?.message?String(Y.message):"No se pudieron sincronizar los consumos.",type:"error"})}},xn=async()=>{try{ee({loading:!0,message:"Sincronizando inventarios...",type:"info"});const Y=await At.getMedications()??[];l(Y);const re=Y.reduce((De,Ie)=>{const Ue=String(Ie.inventory_type||"772");return De[Ue]=(De[Ue]||0)+1,De},{771:0,772:0}),le=mu==="supabase"&&Js?`supabase${du?` (${du})`:""}`:"local";ee({loading:!1,message:`Sincronizado (${le}): 771=${re[771]||0}, 772=${re[772]||0}.`,type:"success"}),window.setTimeout(()=>ee({loading:!1,message:"",type:""}),4e3)}catch(Y){ee({loading:!1,message:Y?.message?String(Y.message):"No se pudieron sincronizar los inventarios.",type:"error"})}};return w.jsxs("div",{className:"flex h-screen bg-slate-50 font-sans text-slate-900 overflow-hidden",children:[w.jsx(xE,{activeTab:e,isSidebarOpen:r,onSelectTab:t,onToggleSidebar:()=>a(Y=>!Y)}),w.jsxs("main",{className:"flex-1 overflow-y-auto p-8",children:[w.jsx(pE,{activeTab:e,onNewMedication:fi}),j.message&&w.jsxs("div",{className:`mb-6 p-3 rounded-lg text-xs flex items-center justify-between gap-3 ${j.type==="error"?"bg-red-50 text-red-700 border border-red-100":"bg-blue-50 text-blue-700 border border-blue-100"}`,children:[w.jsx("span",{children:j.message}),w.jsx("button",{type:"button",onClick:()=>X({loading:!1,message:"",type:""}),className:"text-[11px] font-bold hover:underline",children:"Cerrar"})]}),e==="catalog"&&w.jsx(yE,{medications:s,excelStatus:C,fileInputRef:I,onChooseFile:()=>I.current?.click(),onDownloadTemplate:PE,onFileChange:je,onEditMedication:A,onDeleteMedication:F,onClearCatalog:B}),e==="dashboard"&&w.jsx(EE,{stats:ia,consumptions:Se[0]?.items||[],lowStockItems:Gt,onViewAllConsumptions:()=>t("consumption-monthly"),onEditMedication:A}),e==="inventory"&&w.jsx(TE,{inventoryType:h,onInventoryTypeChange:Y=>{d(Y),u(""),y(re=>({...re,[String(Y||"772")]:1})),ee({loading:!1,message:"",type:""})},inventoryStatus:oe,fileInputRef:q,onChooseFile:()=>q.current?.click(),onFileChange:qt,onDownloadTemplate:We,onRefresh:xn,canClear:String(h||"772")!=="total"&&Wr>0,onClearInventory:Xt,hideNoMovement:g,canToggleHideNoMovement:fo,onToggleHideNoMovement:()=>{x(Y=>!Y),y(Y=>({...Y,total:1}))},search:c,onSearchChange:Y=>{u(Y),y(re=>({...re,[String(h||"772")]:1}))},items:Ma,totalItems:Rt.length,page:rr,pageSize:v,onPageChange:Y=>{const re=Math.max(1,Math.ceil(Rt.length/(v||1))),le=Math.min(Math.max(Number(Y)||1,1),re);y(De=>({...De,[String(h||"772")]:le}))},onPageSizeChange:Y=>{_(Y),y(re=>({...re,[String(h||"772")]:1}))}}),e==="consumption-monthly"&&w.jsx(AE,{months:Se,selectedMonthId:ne,onSelectMonth:cr,monthlyStatus:xe,fileInputRef:Z,onChooseFile:()=>Z.current?.click(),onFileChange:ba,onDownloadTemplate:zE,onRefresh:pn}),e==="consumption-summary"&&w.jsx(SE,{months:Se,onRefresh:pn,status:xe}),e==="order-request"&&w.jsx(OE,{medications:s,months:Se,tertiaryPackaging:N,medicationCategories:St,inventoryStatus:oe,monthlyStatus:xe,onRefreshInventories:xn,onRefreshConsumptions:pn}),e==="calendar"&&w.jsx(LE,{status:pa,entries:Ya,onRefresh:Hn,onSave:vs}),e==="tertiary-packaging"&&w.jsx(RE,{status:be,fileInputRef:J,onChooseFile:()=>J.current?.click(),onFileChange:ho,onDownloadTemplate:_s,onRefresh:Zi,canClear:(N??[]).length>0,onClear:$n,search:M,onSearchChange:Y=>{z(Y),ge(1)},items:ui,totalItems:On.length,page:te,pageSize:Ee,onPageChange:Y=>{const re=Math.max(1,Math.ceil(On.length/(Ee||1))),le=Math.min(Math.max(Number(Y)||1,1),re);ge(le)},onPageSizeChange:Y=>{ye(Y),ge(1)}}),e==="categories"&&w.jsx(DE,{status:tt,fileInputRef:Ae,onChooseFile:()=>Ae.current?.click(),onFileChange:mo,onDownloadTemplate:ci,onRefresh:el,canClear:(St??[]).length>0,onClear:Vn,onEdit:ys,onDelete:wa,search:Et,onSearchChange:Y=>{dt(Y),Vt(1)},items:ws,totalItems:Nn.length,page:Be,pageSize:br,onPageChange:Y=>{const re=Math.max(1,Math.ceil(Nn.length/(br||1))),le=Math.min(Math.max(Number(Y)||1,1),re);Vt(le)},onPageSizeChange:Y=>{na(Y),Vt(1)}}),e==="alerts"&&w.jsx(vE,{lowStockItems:Gt,onEditMedication:A})]}),S&&w.jsx(gE,{editingMed:O,onClose:()=>k(!1),onSubmit:D})]})}function AM(){return w.jsx(kM,{})}kS.createRoot(document.getElementById("root")).render(w.jsx(ze.StrictMode,{children:w.jsx(AM,{})}));
