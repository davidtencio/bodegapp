(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function r(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(s){if(s.ep)return;s.ep=!0;const l=r(s);fetch(s.href,l)}})();var gd={exports:{}},pc={};var Ux;function ES(){if(Ux)return pc;Ux=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function r(a,s,l){var c=null;if(l!==void 0&&(c=""+l),s.key!==void 0&&(c=""+s.key),"key"in s){l={};for(var u in s)u!=="key"&&(l[u]=s[u])}else l=s;return s=l.ref,{$$typeof:e,type:a,key:c,ref:s!==void 0?s:null,props:l}}return pc.Fragment=t,pc.jsx=r,pc.jsxs=r,pc}var Px;function TS(){return Px||(Px=1,gd.exports=ES()),gd.exports}var v=TS(),pd={exports:{}},xt={};var zx;function kS(){if(zx)return xt;zx=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),c=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),x=Symbol.for("react.activity"),y=Symbol.iterator;function _(G){return G===null||typeof G!="object"?null:(G=y&&G[y]||G["@@iterator"],typeof G=="function"?G:null)}var b={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,S={};function k(G,A,z){this.props=G,this.context=A,this.refs=S,this.updater=z||b}k.prototype.isReactComponent={},k.prototype.setState=function(G,A){if(typeof G!="object"&&typeof G!="function"&&G!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,G,A,"setState")},k.prototype.forceUpdate=function(G){this.updater.enqueueForceUpdate(this,G,"forceUpdate")};function C(){}C.prototype=k.prototype;function T(G,A,z){this.props=G,this.context=A,this.refs=S,this.updater=z||b}var j=T.prototype=new C;j.constructor=T,w(j,k.prototype),j.isPureReactComponent=!0;var X=Array.isArray;function D(){}var N={H:null,A:null,T:null,S:null},W=Object.prototype.hasOwnProperty;function P(G,A,z){var I=z.ref;return{$$typeof:e,type:G,key:A,ref:I!==void 0?I:null,props:z}}function re(G,A){return P(G.type,A,G.props)}function ae(G){return typeof G=="object"&&G!==null&&G.$$typeof===e}function Q(G){var A={"=":"=0",":":"=2"};return"$"+G.replace(/[=:]/g,function(z){return A[z]})}var xe=/\/+/g;function Oe(G,A){return typeof G=="object"&&G!==null&&G.key!=null?Q(""+G.key):A.toString(36)}function Ae(G){switch(G.status){case"fulfilled":return G.value;case"rejected":throw G.reason;default:switch(typeof G.status=="string"?G.then(D,D):(G.status="pending",G.then(function(A){G.status==="pending"&&(G.status="fulfilled",G.value=A)},function(A){G.status==="pending"&&(G.status="rejected",G.reason=A)})),G.status){case"fulfilled":return G.value;case"rejected":throw G.reason}}throw G}function K(G,A,z,I,L){var te=typeof G;(te==="undefined"||te==="boolean")&&(G=null);var me=!1;if(G===null)me=!0;else switch(te){case"bigint":case"string":case"number":me=!0;break;case"object":switch(G.$$typeof){case e:case t:me=!0;break;case g:return me=G._init,K(me(G._payload),A,z,I,L)}}if(me)return L=L(G),me=I===""?"."+Oe(G,0):I,X(L)?(z="",me!=null&&(z=me.replace(xe,"$&/")+"/"),K(L,A,z,"",function(Ee){return Ee})):L!=null&&(ae(L)&&(L=re(L,z+(L.key==null||G&&G.key===L.key?"":(""+L.key).replace(xe,"$&/")+"/")+me)),A.push(L)),1;me=0;var ge=I===""?".":I+":";if(X(G))for(var pe=0;pe<G.length;pe++)I=G[pe],te=ge+Oe(I,pe),me+=K(I,A,z,te,L);else if(pe=_(G),typeof pe=="function")for(G=pe.call(G),pe=0;!(I=G.next()).done;)I=I.value,te=ge+Oe(I,pe++),me+=K(I,A,z,te,L);else if(te==="object"){if(typeof G.then=="function")return K(Ae(G),A,z,I,L);throw A=String(G),Error("Objects are not valid as a React child (found: "+(A==="[object Object]"?"object with keys {"+Object.keys(G).join(", ")+"}":A)+"). If you meant to render a collection of children, use an array instead.")}return me}function le(G,A,z){if(G==null)return G;var I=[],L=0;return K(G,I,"","",function(te){return A.call(z,te,L++)}),I}function je(G){if(G._status===-1){var A=G._result;A=A(),A.then(function(z){(G._status===0||G._status===-1)&&(G._status=1,G._result=z)},function(z){(G._status===0||G._status===-1)&&(G._status=2,G._result=z)}),G._status===-1&&(G._status=0,G._result=A)}if(G._status===1)return G._result.default;throw G._result}var U=typeof reportError=="function"?reportError:function(G){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var A=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof G=="object"&&G!==null&&typeof G.message=="string"?String(G.message):String(G),error:G});if(!window.dispatchEvent(A))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",G);return}console.error(G)},ve={map:le,forEach:function(G,A,z){le(G,function(){A.apply(this,arguments)},z)},count:function(G){var A=0;return le(G,function(){A++}),A},toArray:function(G){return le(G,function(A){return A})||[]},only:function(G){if(!ae(G))throw Error("React.Children.only expected to receive a single React element child.");return G}};return xt.Activity=x,xt.Children=ve,xt.Component=k,xt.Fragment=r,xt.Profiler=s,xt.PureComponent=T,xt.StrictMode=a,xt.Suspense=h,xt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=N,xt.__COMPILER_RUNTIME={__proto__:null,c:function(G){return N.H.useMemoCache(G)}},xt.cache=function(G){return function(){return G.apply(null,arguments)}},xt.cacheSignal=function(){return null},xt.cloneElement=function(G,A,z){if(G==null)throw Error("The argument must be a React element, but you passed "+G+".");var I=w({},G.props),L=G.key;if(A!=null)for(te in A.key!==void 0&&(L=""+A.key),A)!W.call(A,te)||te==="key"||te==="__self"||te==="__source"||te==="ref"&&A.ref===void 0||(I[te]=A[te]);var te=arguments.length-2;if(te===1)I.children=z;else if(1<te){for(var me=Array(te),ge=0;ge<te;ge++)me[ge]=arguments[ge+2];I.children=me}return P(G.type,L,I)},xt.createContext=function(G){return G={$$typeof:c,_currentValue:G,_currentValue2:G,_threadCount:0,Provider:null,Consumer:null},G.Provider=G,G.Consumer={$$typeof:l,_context:G},G},xt.createElement=function(G,A,z){var I,L={},te=null;if(A!=null)for(I in A.key!==void 0&&(te=""+A.key),A)W.call(A,I)&&I!=="key"&&I!=="__self"&&I!=="__source"&&(L[I]=A[I]);var me=arguments.length-2;if(me===1)L.children=z;else if(1<me){for(var ge=Array(me),pe=0;pe<me;pe++)ge[pe]=arguments[pe+2];L.children=ge}if(G&&G.defaultProps)for(I in me=G.defaultProps,me)L[I]===void 0&&(L[I]=me[I]);return P(G,te,L)},xt.createRef=function(){return{current:null}},xt.forwardRef=function(G){return{$$typeof:u,render:G}},xt.isValidElement=ae,xt.lazy=function(G){return{$$typeof:g,_payload:{_status:-1,_result:G},_init:je}},xt.memo=function(G,A){return{$$typeof:d,type:G,compare:A===void 0?null:A}},xt.startTransition=function(G){var A=N.T,z={};N.T=z;try{var I=G(),L=N.S;L!==null&&L(z,I),typeof I=="object"&&I!==null&&typeof I.then=="function"&&I.then(D,U)}catch(te){U(te)}finally{A!==null&&z.types!==null&&(A.types=z.types),N.T=A}},xt.unstable_useCacheRefresh=function(){return N.H.useCacheRefresh()},xt.use=function(G){return N.H.use(G)},xt.useActionState=function(G,A,z){return N.H.useActionState(G,A,z)},xt.useCallback=function(G,A){return N.H.useCallback(G,A)},xt.useContext=function(G){return N.H.useContext(G)},xt.useDebugValue=function(){},xt.useDeferredValue=function(G,A){return N.H.useDeferredValue(G,A)},xt.useEffect=function(G,A){return N.H.useEffect(G,A)},xt.useEffectEvent=function(G){return N.H.useEffectEvent(G)},xt.useId=function(){return N.H.useId()},xt.useImperativeHandle=function(G,A,z){return N.H.useImperativeHandle(G,A,z)},xt.useInsertionEffect=function(G,A){return N.H.useInsertionEffect(G,A)},xt.useLayoutEffect=function(G,A){return N.H.useLayoutEffect(G,A)},xt.useMemo=function(G,A){return N.H.useMemo(G,A)},xt.useOptimistic=function(G,A){return N.H.useOptimistic(G,A)},xt.useReducer=function(G,A,z){return N.H.useReducer(G,A,z)},xt.useRef=function(G){return N.H.useRef(G)},xt.useState=function(G){return N.H.useState(G)},xt.useSyncExternalStore=function(G,A,z){return N.H.useSyncExternalStore(G,A,z)},xt.useTransition=function(){return N.H.useTransition()},xt.version="19.2.3",xt}var Hx;function gm(){return Hx||(Hx=1,pd.exports=kS()),pd.exports}var Ce=gm(),xd={exports:{}},xc={},vd={exports:{}},yd={};var $x;function AS(){return $x||($x=1,(function(e){function t(K,le){var je=K.length;K.push(le);e:for(;0<je;){var U=je-1>>>1,ve=K[U];if(0<s(ve,le))K[U]=le,K[je]=ve,je=U;else break e}}function r(K){return K.length===0?null:K[0]}function a(K){if(K.length===0)return null;var le=K[0],je=K.pop();if(je!==le){K[0]=je;e:for(var U=0,ve=K.length,G=ve>>>1;U<G;){var A=2*(U+1)-1,z=K[A],I=A+1,L=K[I];if(0>s(z,je))I<ve&&0>s(L,z)?(K[U]=L,K[I]=je,U=I):(K[U]=z,K[A]=je,U=A);else if(I<ve&&0>s(L,je))K[U]=L,K[I]=je,U=I;else break e}}return le}function s(K,le){var je=K.sortIndex-le.sortIndex;return je!==0?je:K.id-le.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var c=Date,u=c.now();e.unstable_now=function(){return c.now()-u}}var h=[],d=[],g=1,x=null,y=3,_=!1,b=!1,w=!1,S=!1,k=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;function j(K){for(var le=r(d);le!==null;){if(le.callback===null)a(d);else if(le.startTime<=K)a(d),le.sortIndex=le.expirationTime,t(h,le);else break;le=r(d)}}function X(K){if(w=!1,j(K),!b)if(r(h)!==null)b=!0,D||(D=!0,Q());else{var le=r(d);le!==null&&Ae(X,le.startTime-K)}}var D=!1,N=-1,W=5,P=-1;function re(){return S?!0:!(e.unstable_now()-P<W)}function ae(){if(S=!1,D){var K=e.unstable_now();P=K;var le=!0;try{e:{b=!1,w&&(w=!1,C(N),N=-1),_=!0;var je=y;try{t:{for(j(K),x=r(h);x!==null&&!(x.expirationTime>K&&re());){var U=x.callback;if(typeof U=="function"){x.callback=null,y=x.priorityLevel;var ve=U(x.expirationTime<=K);if(K=e.unstable_now(),typeof ve=="function"){x.callback=ve,j(K),le=!0;break t}x===r(h)&&a(h),j(K)}else a(h);x=r(h)}if(x!==null)le=!0;else{var G=r(d);G!==null&&Ae(X,G.startTime-K),le=!1}}break e}finally{x=null,y=je,_=!1}le=void 0}}finally{le?Q():D=!1}}}var Q;if(typeof T=="function")Q=function(){T(ae)};else if(typeof MessageChannel<"u"){var xe=new MessageChannel,Oe=xe.port2;xe.port1.onmessage=ae,Q=function(){Oe.postMessage(null)}}else Q=function(){k(ae,0)};function Ae(K,le){N=k(function(){K(e.unstable_now())},le)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(K){K.callback=null},e.unstable_forceFrameRate=function(K){0>K||125<K?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):W=0<K?Math.floor(1e3/K):5},e.unstable_getCurrentPriorityLevel=function(){return y},e.unstable_next=function(K){switch(y){case 1:case 2:case 3:var le=3;break;default:le=y}var je=y;y=le;try{return K()}finally{y=je}},e.unstable_requestPaint=function(){S=!0},e.unstable_runWithPriority=function(K,le){switch(K){case 1:case 2:case 3:case 4:case 5:break;default:K=3}var je=y;y=K;try{return le()}finally{y=je}},e.unstable_scheduleCallback=function(K,le,je){var U=e.unstable_now();switch(typeof je=="object"&&je!==null?(je=je.delay,je=typeof je=="number"&&0<je?U+je:U):je=U,K){case 1:var ve=-1;break;case 2:ve=250;break;case 5:ve=1073741823;break;case 4:ve=1e4;break;default:ve=5e3}return ve=je+ve,K={id:g++,callback:le,priorityLevel:K,startTime:je,expirationTime:ve,sortIndex:-1},je>U?(K.sortIndex=je,t(d,K),r(h)===null&&K===r(d)&&(w?(C(N),N=-1):w=!0,Ae(X,je-U))):(K.sortIndex=ve,t(h,K),b||_||(b=!0,D||(D=!0,Q()))),K},e.unstable_shouldYield=re,e.unstable_wrapCallback=function(K){var le=y;return function(){var je=y;y=le;try{return K.apply(this,arguments)}finally{y=je}}}})(yd)),yd}var Vx;function CS(){return Vx||(Vx=1,vd.exports=AS()),vd.exports}var _d={exports:{}},ha={};var Gx;function NS(){if(Gx)return ha;Gx=1;var e=gm();function t(h){var d="https://react.dev/errors/"+h;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)d+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+h+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var a={d:{f:r,r:function(){throw Error(t(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},s=Symbol.for("react.portal");function l(h,d,g){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:x==null?null:""+x,children:h,containerInfo:d,implementation:g}}var c=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(h,d){if(h==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return ha.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,ha.createPortal=function(h,d){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(t(299));return l(h,d,null,g)},ha.flushSync=function(h){var d=c.T,g=a.p;try{if(c.T=null,a.p=2,h)return h()}finally{c.T=d,a.p=g,a.d.f()}},ha.preconnect=function(h,d){typeof h=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,a.d.C(h,d))},ha.prefetchDNS=function(h){typeof h=="string"&&a.d.D(h)},ha.preinit=function(h,d){if(typeof h=="string"&&d&&typeof d.as=="string"){var g=d.as,x=u(g,d.crossOrigin),y=typeof d.integrity=="string"?d.integrity:void 0,_=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;g==="style"?a.d.S(h,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:x,integrity:y,fetchPriority:_}):g==="script"&&a.d.X(h,{crossOrigin:x,integrity:y,fetchPriority:_,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},ha.preinitModule=function(h,d){if(typeof h=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var g=u(d.as,d.crossOrigin);a.d.M(h,{crossOrigin:g,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&a.d.M(h)},ha.preload=function(h,d){if(typeof h=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var g=d.as,x=u(g,d.crossOrigin);a.d.L(h,g,{crossOrigin:x,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},ha.preloadModule=function(h,d){if(typeof h=="string")if(d){var g=u(d.as,d.crossOrigin);a.d.m(h,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:g,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else a.d.m(h)},ha.requestFormReset=function(h){a.d.r(h)},ha.unstable_batchedUpdates=function(h,d){return h(d)},ha.useFormState=function(h,d,g){return c.H.useFormState(h,d,g)},ha.useFormStatus=function(){return c.H.useHostTransitionStatus()},ha.version="19.2.3",ha}var qx;function OS(){if(qx)return _d.exports;qx=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),_d.exports=NS(),_d.exports}var Xx;function RS(){if(Xx)return xc;Xx=1;var e=CS(),t=gm(),r=OS();function a(n){var i="https://react.dev/errors/"+n;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)i+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+n+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function l(n){var i=n,o=n;if(n.alternate)for(;i.return;)i=i.return;else{n=i;do i=n,(i.flags&4098)!==0&&(o=i.return),n=i.return;while(n)}return i.tag===3?o:null}function c(n){if(n.tag===13){var i=n.memoizedState;if(i===null&&(n=n.alternate,n!==null&&(i=n.memoizedState)),i!==null)return i.dehydrated}return null}function u(n){if(n.tag===31){var i=n.memoizedState;if(i===null&&(n=n.alternate,n!==null&&(i=n.memoizedState)),i!==null)return i.dehydrated}return null}function h(n){if(l(n)!==n)throw Error(a(188))}function d(n){var i=n.alternate;if(!i){if(i=l(n),i===null)throw Error(a(188));return i!==n?null:n}for(var o=n,f=i;;){var m=o.return;if(m===null)break;var p=m.alternate;if(p===null){if(f=m.return,f!==null){o=f;continue}break}if(m.child===p.child){for(p=m.child;p;){if(p===o)return h(m),n;if(p===f)return h(m),i;p=p.sibling}throw Error(a(188))}if(o.return!==f.return)o=m,f=p;else{for(var E=!1,R=m.child;R;){if(R===o){E=!0,o=m,f=p;break}if(R===f){E=!0,f=m,o=p;break}R=R.sibling}if(!E){for(R=p.child;R;){if(R===o){E=!0,o=p,f=m;break}if(R===f){E=!0,f=p,o=m;break}R=R.sibling}if(!E)throw Error(a(189))}}if(o.alternate!==f)throw Error(a(190))}if(o.tag!==3)throw Error(a(188));return o.stateNode.current===o?n:i}function g(n){var i=n.tag;if(i===5||i===26||i===27||i===6)return n;for(n=n.child;n!==null;){if(i=g(n),i!==null)return i;n=n.sibling}return null}var x=Object.assign,y=Symbol.for("react.element"),_=Symbol.for("react.transitional.element"),b=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),k=Symbol.for("react.profiler"),C=Symbol.for("react.consumer"),T=Symbol.for("react.context"),j=Symbol.for("react.forward_ref"),X=Symbol.for("react.suspense"),D=Symbol.for("react.suspense_list"),N=Symbol.for("react.memo"),W=Symbol.for("react.lazy"),P=Symbol.for("react.activity"),re=Symbol.for("react.memo_cache_sentinel"),ae=Symbol.iterator;function Q(n){return n===null||typeof n!="object"?null:(n=ae&&n[ae]||n["@@iterator"],typeof n=="function"?n:null)}var xe=Symbol.for("react.client.reference");function Oe(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===xe?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case w:return"Fragment";case k:return"Profiler";case S:return"StrictMode";case X:return"Suspense";case D:return"SuspenseList";case P:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case b:return"Portal";case T:return n.displayName||"Context";case C:return(n._context.displayName||"Context")+".Consumer";case j:var i=n.render;return n=n.displayName,n||(n=i.displayName||i.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case N:return i=n.displayName||null,i!==null?i:Oe(n.type)||"Memo";case W:i=n._payload,n=n._init;try{return Oe(n(i))}catch{}}return null}var Ae=Array.isArray,K=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,le=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,je={pending:!1,data:null,method:null,action:null},U=[],ve=-1;function G(n){return{current:n}}function A(n){0>ve||(n.current=U[ve],U[ve]=null,ve--)}function z(n,i){ve++,U[ve]=n.current,n.current=i}var I=G(null),L=G(null),te=G(null),me=G(null);function ge(n,i){switch(z(te,i),z(L,n),z(I,null),i.nodeType){case 9:case 11:n=(n=i.documentElement)&&(n=n.namespaceURI)?ox(n):0;break;default:if(n=i.tagName,i=i.namespaceURI)i=ox(i),n=cx(i,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}A(I),z(I,n)}function pe(){A(I),A(L),A(te)}function Ee(n){n.memoizedState!==null&&z(me,n);var i=I.current,o=cx(i,n.type);i!==o&&(z(L,n),z(I,o))}function et(n){L.current===n&&(A(I),A(L)),me.current===n&&(A(me),hc._currentValue=je)}var q,vt;function nt(n){if(q===void 0)try{throw Error()}catch(o){var i=o.stack.trim().match(/\n( *(at )?)/);q=i&&i[1]||"",vt=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+q+n+vt}var kt=!1;function gt(n,i){if(!n||kt)return"";kt=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var f={DetermineComponentFrameRoot:function(){try{if(i){var ke=function(){throw Error()};if(Object.defineProperty(ke.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ke,[])}catch(ye){var de=ye}Reflect.construct(n,[],ke)}else{try{ke.call()}catch(ye){de=ye}n.call(ke.prototype)}}else{try{throw Error()}catch(ye){de=ye}(ke=n())&&typeof ke.catch=="function"&&ke.catch(function(){})}}catch(ye){if(ye&&de&&typeof ye.stack=="string")return[ye.stack,de.stack]}return[null,null]}};f.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(f.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(f.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var p=f.DetermineComponentFrameRoot(),E=p[0],R=p[1];if(E&&R){var Y=E.split(`
`),ue=R.split(`
`);for(m=f=0;f<Y.length&&!Y[f].includes("DetermineComponentFrameRoot");)f++;for(;m<ue.length&&!ue[m].includes("DetermineComponentFrameRoot");)m++;if(f===Y.length||m===ue.length)for(f=Y.length-1,m=ue.length-1;1<=f&&0<=m&&Y[f]!==ue[m];)m--;for(;1<=f&&0<=m;f--,m--)if(Y[f]!==ue[m]){if(f!==1||m!==1)do if(f--,m--,0>m||Y[f]!==ue[m]){var be=`
`+Y[f].replace(" at new "," at ");return n.displayName&&be.includes("<anonymous>")&&(be=be.replace("<anonymous>",n.displayName)),be}while(1<=f&&0<=m);break}}}finally{kt=!1,Error.prepareStackTrace=o}return(o=n?n.displayName||n.name:"")?nt(o):""}function Re(n,i){switch(n.tag){case 26:case 27:case 5:return nt(n.type);case 16:return nt("Lazy");case 13:return n.child!==i&&i!==null?nt("Suspense Fallback"):nt("Suspense");case 19:return nt("SuspenseList");case 0:case 15:return gt(n.type,!1);case 11:return gt(n.type.render,!1);case 1:return gt(n.type,!0);case 31:return nt("Activity");default:return""}}function jt(n){try{var i="",o=null;do i+=Re(n,o),o=n,n=n.return;while(n);return i}catch(f){return`
Error generating stack: `+f.message+`
`+f.stack}}var sr=Object.prototype.hasOwnProperty,$r=e.unstable_scheduleCallback,wa=e.unstable_cancelCallback,Sn=e.unstable_shouldYield,ka=e.unstable_requestPaint,It=e.unstable_now,Pa=e.unstable_getCurrentPriorityLevel,za=e.unstable_ImmediatePriority,Vr=e.unstable_UserBlockingPriority,hr=e.unstable_NormalPriority,Qr=e.unstable_LowPriority,pt=e.unstable_IdlePriority,$t=e.log,Gr=e.unstable_setDisableYieldValue,Vt=null,Pt=null;function ca(n){if(typeof $t=="function"&&Gr(n),Pt&&typeof Pt.setStrictMode=="function")try{Pt.setStrictMode(Vt,n)}catch{}}var qr=Math.clz32?Math.clz32:fl,Qn=Math.log,Zn=Math.LN2;function fl(n){return n>>>=0,n===0?32:31-(Qn(n)/Zn|0)|0}var ua=256,Ln=262144,Ns=4194304;function Aa(n){var i=n&42;if(i!==0)return i;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return n&261888;case 262144:case 524288:case 1048576:case 2097152:return n&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function es(n,i,o){var f=n.pendingLanes;if(f===0)return 0;var m=0,p=n.suspendedLanes,E=n.pingedLanes;n=n.warmLanes;var R=f&134217727;return R!==0?(f=R&~p,f!==0?m=Aa(f):(E&=R,E!==0?m=Aa(E):o||(o=R&~n,o!==0&&(m=Aa(o))))):(R=f&~p,R!==0?m=Aa(R):E!==0?m=Aa(E):o||(o=f&~n,o!==0&&(m=Aa(o)))),m===0?0:i!==0&&i!==m&&(i&p)===0&&(p=m&-m,o=i&-i,p>=o||p===32&&(o&4194048)!==0)?i:m}function ts(n,i){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&i)===0}function ko(n,i){switch(n){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function hl(){var n=Ns;return Ns<<=1,(Ns&62914560)===0&&(Ns=4194304),n}function gi(n){for(var i=[],o=0;31>o;o++)i.push(n);return i}function rs(n,i){n.pendingLanes|=i,i!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function Ao(n,i,o,f,m,p){var E=n.pendingLanes;n.pendingLanes=o,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=o,n.entangledLanes&=o,n.errorRecoveryDisabledLanes&=o,n.shellSuspendCounter=0;var R=n.entanglements,Y=n.expirationTimes,ue=n.hiddenUpdates;for(o=E&~o;0<o;){var be=31-qr(o),ke=1<<be;R[be]=0,Y[be]=-1;var de=ue[be];if(de!==null)for(ue[be]=null,be=0;be<de.length;be++){var ye=de[be];ye!==null&&(ye.lane&=-536870913)}o&=~ke}f!==0&&dl(n,f,0),p!==0&&m===0&&n.tag!==0&&(n.suspendedLanes|=p&~(E&~i))}function dl(n,i,o){n.pendingLanes|=i,n.suspendedLanes&=~i;var f=31-qr(i);n.entangledLanes|=i,n.entanglements[f]=n.entanglements[f]|1073741824|o&261930}function Os(n,i){var o=n.entangledLanes|=i;for(n=n.entanglements;o;){var f=31-qr(o),m=1<<f;m&i|n[f]&i&&(n[f]|=i),o&=~m}}function ml(n,i){var o=i&-i;return o=(o&42)!==0?1:pi(o),(o&(n.suspendedLanes|i))!==0?0:o}function pi(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function xi(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function O(){var n=le.p;return n!==0?n:(n=window.event,n===void 0?32:Dx(n.type))}function H(n,i){var o=le.p;try{return le.p=n,i()}finally{le.p=o}}var F=Math.random().toString(36).slice(2),M="__reactFiber$"+F,B="__reactProps$"+F,V="__reactContainer$"+F,fe="__reactEvents$"+F,we="__reactListeners$"+F,ce="__reactHandles$"+F,ie="__reactResources$"+F,he="__reactMarker$"+F;function Fe(n){delete n[M],delete n[B],delete n[fe],delete n[we],delete n[ce]}function Le(n){var i=n[M];if(i)return i;for(var o=n.parentNode;o;){if(i=o[V]||o[M]){if(o=i.alternate,i.child!==null||o!==null&&o.child!==null)for(n=px(n);n!==null;){if(o=n[M])return o;n=px(n)}return i}n=o,o=n.parentNode}return null}function qe(n){if(n=n[M]||n[V]){var i=n.tag;if(i===5||i===6||i===13||i===31||i===26||i===27||i===3)return n}return null}function De(n){var i=n.tag;if(i===5||i===26||i===27||i===6)return n.stateNode;throw Error(a(33))}function $e(n){var i=n[ie];return i||(i=n[ie]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function We(n){n[he]=!0}var Yt=new Set,Jt={};function Qt(n,i){Ca(n,i),Ca(n+"Capture",i)}function Ca(n,i){for(Jt[n]=i,n=0;n<i.length;n++)Yt.add(i[n])}var as=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Bn={},nn={};function vi(n){return sr.call(nn,n)?!0:sr.call(Bn,n)?!1:as.test(n)?nn[n]=!0:(Bn[n]=!0,!1)}function fa(n,i,o){if(vi(i))if(o===null)n.removeAttribute(i);else{switch(typeof o){case"undefined":case"function":case"symbol":n.removeAttribute(i);return;case"boolean":var f=i.toLowerCase().slice(0,5);if(f!=="data-"&&f!=="aria-"){n.removeAttribute(i);return}}n.setAttribute(i,""+o)}}function gl(n,i,o){if(o===null)n.removeAttribute(i);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(i);return}n.setAttribute(i,""+o)}}function En(n,i,o,f){if(f===null)n.removeAttribute(o);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(o);return}n.setAttributeNS(i,o,""+f)}}function Na(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function fu(n){var i=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function Co(n,i,o){var f=Object.getOwnPropertyDescriptor(n.constructor.prototype,i);if(!n.hasOwnProperty(i)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var m=f.get,p=f.set;return Object.defineProperty(n,i,{configurable:!0,get:function(){return m.call(this)},set:function(E){o=""+E,p.call(this,E)}}),Object.defineProperty(n,i,{enumerable:f.enumerable}),{getValue:function(){return o},setValue:function(E){o=""+E},stopTracking:function(){n._valueTracker=null,delete n[i]}}}}function pl(n){if(!n._valueTracker){var i=fu(n)?"checked":"value";n._valueTracker=Co(n,i,""+n[i])}}function J(n){if(!n)return!1;var i=n._valueTracker;if(!i)return!0;var o=i.getValue(),f="";return n&&(f=fu(n)?n.checked?"true":"false":n.value),n=f,n!==o?(i.setValue(n),!0):!1}function Z(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var se=/[\n"\\]/g;function Te(n){return n.replace(se,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function Me(n,i,o,f,m,p,E,R){n.name="",E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"?n.type=E:n.removeAttribute("type"),i!=null?E==="number"?(i===0&&n.value===""||n.value!=i)&&(n.value=""+Na(i)):n.value!==""+Na(i)&&(n.value=""+Na(i)):E!=="submit"&&E!=="reset"||n.removeAttribute("value"),i!=null?Ve(n,E,Na(i)):o!=null?Ve(n,E,Na(o)):f!=null&&n.removeAttribute("value"),m==null&&p!=null&&(n.defaultChecked=!!p),m!=null&&(n.checked=m&&typeof m!="function"&&typeof m!="symbol"),R!=null&&typeof R!="function"&&typeof R!="symbol"&&typeof R!="boolean"?n.name=""+Na(R):n.removeAttribute("name")}function Ie(n,i,o,f,m,p,E,R){if(p!=null&&typeof p!="function"&&typeof p!="symbol"&&typeof p!="boolean"&&(n.type=p),i!=null||o!=null){if(!(p!=="submit"&&p!=="reset"||i!=null)){pl(n);return}o=o!=null?""+Na(o):"",i=i!=null?""+Na(i):o,R||i===n.value||(n.value=i),n.defaultValue=i}f=f??m,f=typeof f!="function"&&typeof f!="symbol"&&!!f,n.checked=R?n.checked:!!f,n.defaultChecked=!!f,E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"&&(n.name=E),pl(n)}function Ve(n,i,o){i==="number"&&Z(n.ownerDocument)===n||n.defaultValue===""+o||(n.defaultValue=""+o)}function Je(n,i,o,f){if(n=n.options,i){i={};for(var m=0;m<o.length;m++)i["$"+o[m]]=!0;for(o=0;o<n.length;o++)m=i.hasOwnProperty("$"+n[o].value),n[o].selected!==m&&(n[o].selected=m),m&&f&&(n[o].defaultSelected=!0)}else{for(o=""+Na(o),i=null,m=0;m<n.length;m++){if(n[m].value===o){n[m].selected=!0,f&&(n[m].defaultSelected=!0);return}i!==null||n[m].disabled||(i=n[m])}i!==null&&(i.selected=!0)}}function st(n,i,o){if(i!=null&&(i=""+Na(i),i!==n.value&&(n.value=i),o==null)){n.defaultValue!==i&&(n.defaultValue=i);return}n.defaultValue=o!=null?""+Na(o):""}function rt(n,i,o,f){if(i==null){if(f!=null){if(o!=null)throw Error(a(92));if(Ae(f)){if(1<f.length)throw Error(a(93));f=f[0]}o=f}o==null&&(o=""),i=o}o=Na(i),n.defaultValue=o,f=n.textContent,f===o&&f!==""&&f!==null&&(n.value=f),pl(n)}function Xe(n,i){if(i){var o=n.firstChild;if(o&&o===n.lastChild&&o.nodeType===3){o.nodeValue=i;return}}n.textContent=i}var Pe=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Ye(n,i,o){var f=i.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?f?n.setProperty(i,""):i==="float"?n.cssFloat="":n[i]="":f?n.setProperty(i,o):typeof o!="number"||o===0||Pe.has(i)?i==="float"?n.cssFloat=o:n[i]=(""+o).trim():n[i]=o+"px"}function Be(n,i,o){if(i!=null&&typeof i!="object")throw Error(a(62));if(n=n.style,o!=null){for(var f in o)!o.hasOwnProperty(f)||i!=null&&i.hasOwnProperty(f)||(f.indexOf("--")===0?n.setProperty(f,""):f==="float"?n.cssFloat="":n[f]="");for(var m in i)f=i[m],i.hasOwnProperty(m)&&o[m]!==f&&Ye(n,m,f)}else for(var p in i)i.hasOwnProperty(p)&&Ye(n,p,i[p])}function ze(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ze=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Ke=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function dt(n){return Ke.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}function Ge(){}var Et=null;function zt(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Br=null,Zr=null;function xl(n){var i=qe(n);if(i&&(n=i.stateNode)){var o=n[B]||null;e:switch(n=i.stateNode,i.type){case"input":if(Me(n,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),i=o.name,o.type==="radio"&&i!=null){for(o=n;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+Te(""+i)+'"][type="radio"]'),i=0;i<o.length;i++){var f=o[i];if(f!==n&&f.form===n.form){var m=f[B]||null;if(!m)throw Error(a(90));Me(f,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(i=0;i<o.length;i++)f=o[i],f.form===n.form&&J(f)}break e;case"textarea":st(n,o.value,o.defaultValue);break e;case"select":i=o.value,i!=null&&Je(n,!!o.multiple,i,!1)}}}var Sr=!1;function No(n,i,o){if(Sr)return n(i,o);Sr=!0;try{var f=n(i);return f}finally{if(Sr=!1,(Br!==null||Zr!==null)&&(Qu(),Br&&(i=Br,n=Zr,Zr=Br=null,xl(i),n)))for(i=0;i<n.length;i++)xl(n[i])}}function yi(n,i){var o=n.stateNode;if(o===null)return null;var f=o[B]||null;if(f===null)return null;o=f[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(n=n.type,f=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!f;break e;default:n=!1}if(n)return null;if(o&&typeof o!="function")throw Error(a(231,i,typeof o));return o}var Tn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Oo=!1;if(Tn)try{var _i={};Object.defineProperty(_i,"passive",{get:function(){Oo=!0}}),window.addEventListener("test",_i,_i),window.removeEventListener("test",_i,_i)}catch{Oo=!1}var Un=null,vl=null,Rs=null;function hu(){if(Rs)return Rs;var n,i=vl,o=i.length,f,m="value"in Un?Un.value:Un.textContent,p=m.length;for(n=0;n<o&&i[n]===m[n];n++);var E=o-n;for(f=1;f<=E&&i[o-f]===m[p-f];f++);return Rs=m.slice(n,1<f?1-f:void 0)}function du(n){var i=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&i===13&&(n=13)):n=i,n===10&&(n=13),32<=n||n===13?n:0}function mu(){return!0}function u1(){return!1}function Oa(n){function i(o,f,m,p,E){this._reactName=o,this._targetInst=m,this.type=f,this.nativeEvent=p,this.target=E,this.currentTarget=null;for(var R in n)n.hasOwnProperty(R)&&(o=n[R],this[R]=o?o(p):p[R]);return this.isDefaultPrevented=(p.defaultPrevented!=null?p.defaultPrevented:p.returnValue===!1)?mu:u1,this.isPropagationStopped=u1,this}return x(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=mu)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=mu)},persist:function(){},isPersistent:mu}),i}var wi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},gu=Oa(wi),Ro=x({},wi,{view:0,detail:0}),bw=Oa(Ro),xf,vf,Do,pu=x({},Ro,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:_f,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Do&&(Do&&n.type==="mousemove"?(xf=n.screenX-Do.screenX,vf=n.screenY-Do.screenY):vf=xf=0,Do=n),xf)},movementY:function(n){return"movementY"in n?n.movementY:vf}}),f1=Oa(pu),Sw=x({},pu,{dataTransfer:0}),Ew=Oa(Sw),Tw=x({},Ro,{relatedTarget:0}),yf=Oa(Tw),kw=x({},wi,{animationName:0,elapsedTime:0,pseudoElement:0}),Aw=Oa(kw),Cw=x({},wi,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),Nw=Oa(Cw),Ow=x({},wi,{data:0}),h1=Oa(Ow),Rw={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Dw={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Fw={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Mw(n){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(n):(n=Fw[n])?!!i[n]:!1}function _f(){return Mw}var jw=x({},Ro,{key:function(n){if(n.key){var i=Rw[n.key]||n.key;if(i!=="Unidentified")return i}return n.type==="keypress"?(n=du(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?Dw[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:_f,charCode:function(n){return n.type==="keypress"?du(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?du(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),Iw=Oa(jw),Lw=x({},pu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),d1=Oa(Lw),Bw=x({},Ro,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:_f}),Uw=Oa(Bw),Pw=x({},wi,{propertyName:0,elapsedTime:0,pseudoElement:0}),zw=Oa(Pw),Hw=x({},pu,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),$w=Oa(Hw),Vw=x({},wi,{newState:0,oldState:0}),Gw=Oa(Vw),qw=[9,13,27,32],wf=Tn&&"CompositionEvent"in window,Fo=null;Tn&&"documentMode"in document&&(Fo=document.documentMode);var Xw=Tn&&"TextEvent"in window&&!Fo,m1=Tn&&(!wf||Fo&&8<Fo&&11>=Fo),g1=" ",p1=!1;function x1(n,i){switch(n){case"keyup":return qw.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function v1(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var yl=!1;function Ww(n,i){switch(n){case"compositionend":return v1(i);case"keypress":return i.which!==32?null:(p1=!0,g1);case"textInput":return n=i.data,n===g1&&p1?null:n;default:return null}}function Kw(n,i){if(yl)return n==="compositionend"||!wf&&x1(n,i)?(n=hu(),Rs=vl=Un=null,yl=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return m1&&i.locale!=="ko"?null:i.data;default:return null}}var Yw={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function y1(n){var i=n&&n.nodeName&&n.nodeName.toLowerCase();return i==="input"?!!Yw[n.type]:i==="textarea"}function _1(n,i,o,f){Br?Zr?Zr.push(f):Zr=[f]:Br=f,i=s0(i,"onChange"),0<i.length&&(o=new gu("onChange","change",null,o,f),n.push({event:o,listeners:i}))}var Mo=null,jo=null;function Jw(n){rx(n,0)}function xu(n){var i=De(n);if(J(i))return n}function w1(n,i){if(n==="change")return i}var b1=!1;if(Tn){var bf;if(Tn){var Sf="oninput"in document;if(!Sf){var S1=document.createElement("div");S1.setAttribute("oninput","return;"),Sf=typeof S1.oninput=="function"}bf=Sf}else bf=!1;b1=bf&&(!document.documentMode||9<document.documentMode)}function E1(){Mo&&(Mo.detachEvent("onpropertychange",T1),jo=Mo=null)}function T1(n){if(n.propertyName==="value"&&xu(jo)){var i=[];_1(i,jo,n,zt(n)),No(Jw,i)}}function Qw(n,i,o){n==="focusin"?(E1(),Mo=i,jo=o,Mo.attachEvent("onpropertychange",T1)):n==="focusout"&&E1()}function Zw(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return xu(jo)}function eb(n,i){if(n==="click")return xu(i)}function tb(n,i){if(n==="input"||n==="change")return xu(i)}function rb(n,i){return n===i&&(n!==0||1/n===1/i)||n!==n&&i!==i}var Ha=typeof Object.is=="function"?Object.is:rb;function Io(n,i){if(Ha(n,i))return!0;if(typeof n!="object"||n===null||typeof i!="object"||i===null)return!1;var o=Object.keys(n),f=Object.keys(i);if(o.length!==f.length)return!1;for(f=0;f<o.length;f++){var m=o[f];if(!sr.call(i,m)||!Ha(n[m],i[m]))return!1}return!0}function k1(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function A1(n,i){var o=k1(n);n=0;for(var f;o;){if(o.nodeType===3){if(f=n+o.textContent.length,n<=i&&f>=i)return{node:o,offset:i-n};n=f}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=k1(o)}}function C1(n,i){return n&&i?n===i?!0:n&&n.nodeType===3?!1:i&&i.nodeType===3?C1(n,i.parentNode):"contains"in n?n.contains(i):n.compareDocumentPosition?!!(n.compareDocumentPosition(i)&16):!1:!1}function N1(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var i=Z(n.document);i instanceof n.HTMLIFrameElement;){try{var o=typeof i.contentWindow.location.href=="string"}catch{o=!1}if(o)n=i.contentWindow;else break;i=Z(n.document)}return i}function Ef(n){var i=n&&n.nodeName&&n.nodeName.toLowerCase();return i&&(i==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||i==="textarea"||n.contentEditable==="true")}var ab=Tn&&"documentMode"in document&&11>=document.documentMode,_l=null,Tf=null,Lo=null,kf=!1;function O1(n,i,o){var f=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;kf||_l==null||_l!==Z(f)||(f=_l,"selectionStart"in f&&Ef(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),Lo&&Io(Lo,f)||(Lo=f,f=s0(Tf,"onSelect"),0<f.length&&(i=new gu("onSelect","select",null,i,o),n.push({event:i,listeners:f}),i.target=_l)))}function bi(n,i){var o={};return o[n.toLowerCase()]=i.toLowerCase(),o["Webkit"+n]="webkit"+i,o["Moz"+n]="moz"+i,o}var wl={animationend:bi("Animation","AnimationEnd"),animationiteration:bi("Animation","AnimationIteration"),animationstart:bi("Animation","AnimationStart"),transitionrun:bi("Transition","TransitionRun"),transitionstart:bi("Transition","TransitionStart"),transitioncancel:bi("Transition","TransitionCancel"),transitionend:bi("Transition","TransitionEnd")},Af={},R1={};Tn&&(R1=document.createElement("div").style,"AnimationEvent"in window||(delete wl.animationend.animation,delete wl.animationiteration.animation,delete wl.animationstart.animation),"TransitionEvent"in window||delete wl.transitionend.transition);function Si(n){if(Af[n])return Af[n];if(!wl[n])return n;var i=wl[n],o;for(o in i)if(i.hasOwnProperty(o)&&o in R1)return Af[n]=i[o];return n}var D1=Si("animationend"),F1=Si("animationiteration"),M1=Si("animationstart"),nb=Si("transitionrun"),sb=Si("transitionstart"),ib=Si("transitioncancel"),j1=Si("transitionend"),I1=new Map,Cf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Cf.push("scrollEnd");function kn(n,i){I1.set(n,i),Qt(i,[n])}var vu=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)},sn=[],bl=0,Nf=0;function yu(){for(var n=bl,i=Nf=bl=0;i<n;){var o=sn[i];sn[i++]=null;var f=sn[i];sn[i++]=null;var m=sn[i];sn[i++]=null;var p=sn[i];if(sn[i++]=null,f!==null&&m!==null){var E=f.pending;E===null?m.next=m:(m.next=E.next,E.next=m),f.pending=m}p!==0&&L1(o,m,p)}}function _u(n,i,o,f){sn[bl++]=n,sn[bl++]=i,sn[bl++]=o,sn[bl++]=f,Nf|=f,n.lanes|=f,n=n.alternate,n!==null&&(n.lanes|=f)}function Of(n,i,o,f){return _u(n,i,o,f),wu(n)}function Ei(n,i){return _u(n,null,null,i),wu(n)}function L1(n,i,o){n.lanes|=o;var f=n.alternate;f!==null&&(f.lanes|=o);for(var m=!1,p=n.return;p!==null;)p.childLanes|=o,f=p.alternate,f!==null&&(f.childLanes|=o),p.tag===22&&(n=p.stateNode,n===null||n._visibility&1||(m=!0)),n=p,p=p.return;return n.tag===3?(p=n.stateNode,m&&i!==null&&(m=31-qr(o),n=p.hiddenUpdates,f=n[m],f===null?n[m]=[i]:f.push(i),i.lane=o|536870912),p):null}function wu(n){if(50<sc)throw sc=0,Uh=null,Error(a(185));for(var i=n.return;i!==null;)n=i,i=n.return;return n.tag===3?n.stateNode:null}var Sl={};function lb(n,i,o,f){this.tag=n,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function $a(n,i,o,f){return new lb(n,i,o,f)}function Rf(n){return n=n.prototype,!(!n||!n.isReactComponent)}function ns(n,i){var o=n.alternate;return o===null?(o=$a(n.tag,i,n.key,n.mode),o.elementType=n.elementType,o.type=n.type,o.stateNode=n.stateNode,o.alternate=n,n.alternate=o):(o.pendingProps=i,o.type=n.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=n.flags&65011712,o.childLanes=n.childLanes,o.lanes=n.lanes,o.child=n.child,o.memoizedProps=n.memoizedProps,o.memoizedState=n.memoizedState,o.updateQueue=n.updateQueue,i=n.dependencies,o.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},o.sibling=n.sibling,o.index=n.index,o.ref=n.ref,o.refCleanup=n.refCleanup,o}function B1(n,i){n.flags&=65011714;var o=n.alternate;return o===null?(n.childLanes=0,n.lanes=i,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=o.childLanes,n.lanes=o.lanes,n.child=o.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=o.memoizedProps,n.memoizedState=o.memoizedState,n.updateQueue=o.updateQueue,n.type=o.type,i=o.dependencies,n.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),n}function bu(n,i,o,f,m,p){var E=0;if(f=n,typeof n=="function")Rf(n)&&(E=1);else if(typeof n=="string")E=hS(n,o,I.current)?26:n==="html"||n==="head"||n==="body"?27:5;else e:switch(n){case P:return n=$a(31,o,i,m),n.elementType=P,n.lanes=p,n;case w:return Ti(o.children,m,p,i);case S:E=8,m|=24;break;case k:return n=$a(12,o,i,m|2),n.elementType=k,n.lanes=p,n;case X:return n=$a(13,o,i,m),n.elementType=X,n.lanes=p,n;case D:return n=$a(19,o,i,m),n.elementType=D,n.lanes=p,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case T:E=10;break e;case C:E=9;break e;case j:E=11;break e;case N:E=14;break e;case W:E=16,f=null;break e}E=29,o=Error(a(130,n===null?"null":typeof n,"")),f=null}return i=$a(E,o,i,m),i.elementType=n,i.type=f,i.lanes=p,i}function Ti(n,i,o,f){return n=$a(7,n,f,i),n.lanes=o,n}function Df(n,i,o){return n=$a(6,n,null,i),n.lanes=o,n}function U1(n){var i=$a(18,null,null,0);return i.stateNode=n,i}function Ff(n,i,o){return i=$a(4,n.children!==null?n.children:[],n.key,i),i.lanes=o,i.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},i}var P1=new WeakMap;function ln(n,i){if(typeof n=="object"&&n!==null){var o=P1.get(n);return o!==void 0?o:(i={value:n,source:i,stack:jt(i)},P1.set(n,i),i)}return{value:n,source:i,stack:jt(i)}}var El=[],Tl=0,Su=null,Bo=0,on=[],cn=0,Ds=null,Pn=1,zn="";function ss(n,i){El[Tl++]=Bo,El[Tl++]=Su,Su=n,Bo=i}function z1(n,i,o){on[cn++]=Pn,on[cn++]=zn,on[cn++]=Ds,Ds=n;var f=Pn;n=zn;var m=32-qr(f)-1;f&=~(1<<m),o+=1;var p=32-qr(i)+m;if(30<p){var E=m-m%5;p=(f&(1<<E)-1).toString(32),f>>=E,m-=E,Pn=1<<32-qr(i)+m|o<<m|f,zn=p+n}else Pn=1<<p|o<<m|f,zn=n}function Mf(n){n.return!==null&&(ss(n,1),z1(n,1,0))}function jf(n){for(;n===Su;)Su=El[--Tl],El[Tl]=null,Bo=El[--Tl],El[Tl]=null;for(;n===Ds;)Ds=on[--cn],on[cn]=null,zn=on[--cn],on[cn]=null,Pn=on[--cn],on[cn]=null}function H1(n,i){on[cn++]=Pn,on[cn++]=zn,on[cn++]=Ds,Pn=i.id,zn=i.overflow,Ds=n}var ea=null,lr=null,Dt=!1,Fs=null,un=!1,If=Error(a(519));function Ms(n){var i=Error(a(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Uo(ln(i,n)),If}function $1(n){var i=n.stateNode,o=n.type,f=n.memoizedProps;switch(i[M]=n,i[B]=f,o){case"dialog":Nt("cancel",i),Nt("close",i);break;case"iframe":case"object":case"embed":Nt("load",i);break;case"video":case"audio":for(o=0;o<lc.length;o++)Nt(lc[o],i);break;case"source":Nt("error",i);break;case"img":case"image":case"link":Nt("error",i),Nt("load",i);break;case"details":Nt("toggle",i);break;case"input":Nt("invalid",i),Ie(i,f.value,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name,!0);break;case"select":Nt("invalid",i);break;case"textarea":Nt("invalid",i),rt(i,f.value,f.defaultValue,f.children)}o=f.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||i.textContent===""+o||f.suppressHydrationWarning===!0||ix(i.textContent,o)?(f.popover!=null&&(Nt("beforetoggle",i),Nt("toggle",i)),f.onScroll!=null&&Nt("scroll",i),f.onScrollEnd!=null&&Nt("scrollend",i),f.onClick!=null&&(i.onclick=Ge),i=!0):i=!1,i||Ms(n,!0)}function V1(n){for(ea=n.return;ea;)switch(ea.tag){case 5:case 31:case 13:un=!1;return;case 27:case 3:un=!0;return;default:ea=ea.return}}function kl(n){if(n!==ea)return!1;if(!Dt)return V1(n),Dt=!0,!1;var i=n.tag,o;if((o=i!==3&&i!==27)&&((o=i===5)&&(o=n.type,o=!(o!=="form"&&o!=="button")||ed(n.type,n.memoizedProps)),o=!o),o&&lr&&Ms(n),V1(n),i===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(a(317));lr=gx(n)}else if(i===31){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(a(317));lr=gx(n)}else i===27?(i=lr,Ws(n.type)?(n=sd,sd=null,lr=n):lr=i):lr=ea?hn(n.stateNode.nextSibling):null;return!0}function ki(){lr=ea=null,Dt=!1}function Lf(){var n=Fs;return n!==null&&(Ma===null?Ma=n:Ma.push.apply(Ma,n),Fs=null),n}function Uo(n){Fs===null?Fs=[n]:Fs.push(n)}var Bf=G(null),Ai=null,is=null;function js(n,i,o){z(Bf,i._currentValue),i._currentValue=o}function ls(n){n._currentValue=Bf.current,A(Bf)}function Uf(n,i,o){for(;n!==null;){var f=n.alternate;if((n.childLanes&i)!==i?(n.childLanes|=i,f!==null&&(f.childLanes|=i)):f!==null&&(f.childLanes&i)!==i&&(f.childLanes|=i),n===o)break;n=n.return}}function Pf(n,i,o,f){var m=n.child;for(m!==null&&(m.return=n);m!==null;){var p=m.dependencies;if(p!==null){var E=m.child;p=p.firstContext;e:for(;p!==null;){var R=p;p=m;for(var Y=0;Y<i.length;Y++)if(R.context===i[Y]){p.lanes|=o,R=p.alternate,R!==null&&(R.lanes|=o),Uf(p.return,o,n),f||(E=null);break e}p=R.next}}else if(m.tag===18){if(E=m.return,E===null)throw Error(a(341));E.lanes|=o,p=E.alternate,p!==null&&(p.lanes|=o),Uf(E,o,n),E=null}else E=m.child;if(E!==null)E.return=m;else for(E=m;E!==null;){if(E===n){E=null;break}if(m=E.sibling,m!==null){m.return=E.return,E=m;break}E=E.return}m=E}}function Al(n,i,o,f){n=null;for(var m=i,p=!1;m!==null;){if(!p){if((m.flags&524288)!==0)p=!0;else if((m.flags&262144)!==0)break}if(m.tag===10){var E=m.alternate;if(E===null)throw Error(a(387));if(E=E.memoizedProps,E!==null){var R=m.type;Ha(m.pendingProps.value,E.value)||(n!==null?n.push(R):n=[R])}}else if(m===me.current){if(E=m.alternate,E===null)throw Error(a(387));E.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(n!==null?n.push(hc):n=[hc])}m=m.return}n!==null&&Pf(i,n,o,f),i.flags|=262144}function Eu(n){for(n=n.firstContext;n!==null;){if(!Ha(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function Ci(n){Ai=n,is=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function ta(n){return G1(Ai,n)}function Tu(n,i){return Ai===null&&Ci(n),G1(n,i)}function G1(n,i){var o=i._currentValue;if(i={context:i,memoizedValue:o,next:null},is===null){if(n===null)throw Error(a(308));is=i,n.dependencies={lanes:0,firstContext:i},n.flags|=524288}else is=is.next=i;return o}var ob=typeof AbortController<"u"?AbortController:function(){var n=[],i=this.signal={aborted:!1,addEventListener:function(o,f){n.push(f)}};this.abort=function(){i.aborted=!0,n.forEach(function(o){return o()})}},cb=e.unstable_scheduleCallback,ub=e.unstable_NormalPriority,Nr={$$typeof:T,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function zf(){return{controller:new ob,data:new Map,refCount:0}}function Po(n){n.refCount--,n.refCount===0&&cb(ub,function(){n.controller.abort()})}var zo=null,Hf=0,Cl=0,Nl=null;function fb(n,i){if(zo===null){var o=zo=[];Hf=0,Cl=Gh(),Nl={status:"pending",value:void 0,then:function(f){o.push(f)}}}return Hf++,i.then(q1,q1),i}function q1(){if(--Hf===0&&zo!==null){Nl!==null&&(Nl.status="fulfilled");var n=zo;zo=null,Cl=0,Nl=null;for(var i=0;i<n.length;i++)(0,n[i])()}}function hb(n,i){var o=[],f={status:"pending",value:null,reason:null,then:function(m){o.push(m)}};return n.then(function(){f.status="fulfilled",f.value=i;for(var m=0;m<o.length;m++)(0,o[m])(i)},function(m){for(f.status="rejected",f.reason=m,m=0;m<o.length;m++)(0,o[m])(void 0)}),f}var X1=K.S;K.S=function(n,i){Op=It(),typeof i=="object"&&i!==null&&typeof i.then=="function"&&fb(n,i),X1!==null&&X1(n,i)};var Ni=G(null);function $f(){var n=Ni.current;return n!==null?n:ar.pooledCache}function ku(n,i){i===null?z(Ni,Ni.current):z(Ni,i.pool)}function W1(){var n=$f();return n===null?null:{parent:Nr._currentValue,pool:n}}var Ol=Error(a(460)),Vf=Error(a(474)),Au=Error(a(542)),Cu={then:function(){}};function K1(n){return n=n.status,n==="fulfilled"||n==="rejected"}function Y1(n,i,o){switch(o=n[o],o===void 0?n.push(i):o!==i&&(i.then(Ge,Ge),i=o),i.status){case"fulfilled":return i.value;case"rejected":throw n=i.reason,Q1(n),n;default:if(typeof i.status=="string")i.then(Ge,Ge);else{if(n=ar,n!==null&&100<n.shellSuspendCounter)throw Error(a(482));n=i,n.status="pending",n.then(function(f){if(i.status==="pending"){var m=i;m.status="fulfilled",m.value=f}},function(f){if(i.status==="pending"){var m=i;m.status="rejected",m.reason=f}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw n=i.reason,Q1(n),n}throw Ri=i,Ol}}function Oi(n){try{var i=n._init;return i(n._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(Ri=o,Ol):o}}var Ri=null;function J1(){if(Ri===null)throw Error(a(459));var n=Ri;return Ri=null,n}function Q1(n){if(n===Ol||n===Au)throw Error(a(483))}var Rl=null,Ho=0;function Nu(n){var i=Ho;return Ho+=1,Rl===null&&(Rl=[]),Y1(Rl,n,i)}function $o(n,i){i=i.props.ref,n.ref=i!==void 0?i:null}function Ou(n,i){throw i.$$typeof===y?Error(a(525)):(n=Object.prototype.toString.call(i),Error(a(31,n==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":n)))}function Z1(n){function i(ne,ee){if(n){var oe=ne.deletions;oe===null?(ne.deletions=[ee],ne.flags|=16):oe.push(ee)}}function o(ne,ee){if(!n)return null;for(;ee!==null;)i(ne,ee),ee=ee.sibling;return null}function f(ne){for(var ee=new Map;ne!==null;)ne.key!==null?ee.set(ne.key,ne):ee.set(ne.index,ne),ne=ne.sibling;return ee}function m(ne,ee){return ne=ns(ne,ee),ne.index=0,ne.sibling=null,ne}function p(ne,ee,oe){return ne.index=oe,n?(oe=ne.alternate,oe!==null?(oe=oe.index,oe<ee?(ne.flags|=67108866,ee):oe):(ne.flags|=67108866,ee)):(ne.flags|=1048576,ee)}function E(ne){return n&&ne.alternate===null&&(ne.flags|=67108866),ne}function R(ne,ee,oe,Se){return ee===null||ee.tag!==6?(ee=Df(oe,ne.mode,Se),ee.return=ne,ee):(ee=m(ee,oe),ee.return=ne,ee)}function Y(ne,ee,oe,Se){var it=oe.type;return it===w?be(ne,ee,oe.props.children,Se,oe.key):ee!==null&&(ee.elementType===it||typeof it=="object"&&it!==null&&it.$$typeof===W&&Oi(it)===ee.type)?(ee=m(ee,oe.props),$o(ee,oe),ee.return=ne,ee):(ee=bu(oe.type,oe.key,oe.props,null,ne.mode,Se),$o(ee,oe),ee.return=ne,ee)}function ue(ne,ee,oe,Se){return ee===null||ee.tag!==4||ee.stateNode.containerInfo!==oe.containerInfo||ee.stateNode.implementation!==oe.implementation?(ee=Ff(oe,ne.mode,Se),ee.return=ne,ee):(ee=m(ee,oe.children||[]),ee.return=ne,ee)}function be(ne,ee,oe,Se,it){return ee===null||ee.tag!==7?(ee=Ti(oe,ne.mode,Se,it),ee.return=ne,ee):(ee=m(ee,oe),ee.return=ne,ee)}function ke(ne,ee,oe){if(typeof ee=="string"&&ee!==""||typeof ee=="number"||typeof ee=="bigint")return ee=Df(""+ee,ne.mode,oe),ee.return=ne,ee;if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case _:return oe=bu(ee.type,ee.key,ee.props,null,ne.mode,oe),$o(oe,ee),oe.return=ne,oe;case b:return ee=Ff(ee,ne.mode,oe),ee.return=ne,ee;case W:return ee=Oi(ee),ke(ne,ee,oe)}if(Ae(ee)||Q(ee))return ee=Ti(ee,ne.mode,oe,null),ee.return=ne,ee;if(typeof ee.then=="function")return ke(ne,Nu(ee),oe);if(ee.$$typeof===T)return ke(ne,Tu(ne,ee),oe);Ou(ne,ee)}return null}function de(ne,ee,oe,Se){var it=ee!==null?ee.key:null;if(typeof oe=="string"&&oe!==""||typeof oe=="number"||typeof oe=="bigint")return it!==null?null:R(ne,ee,""+oe,Se);if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case _:return oe.key===it?Y(ne,ee,oe,Se):null;case b:return oe.key===it?ue(ne,ee,oe,Se):null;case W:return oe=Oi(oe),de(ne,ee,oe,Se)}if(Ae(oe)||Q(oe))return it!==null?null:be(ne,ee,oe,Se,null);if(typeof oe.then=="function")return de(ne,ee,Nu(oe),Se);if(oe.$$typeof===T)return de(ne,ee,Tu(ne,oe),Se);Ou(ne,oe)}return null}function ye(ne,ee,oe,Se,it){if(typeof Se=="string"&&Se!==""||typeof Se=="number"||typeof Se=="bigint")return ne=ne.get(oe)||null,R(ee,ne,""+Se,it);if(typeof Se=="object"&&Se!==null){switch(Se.$$typeof){case _:return ne=ne.get(Se.key===null?oe:Se.key)||null,Y(ee,ne,Se,it);case b:return ne=ne.get(Se.key===null?oe:Se.key)||null,ue(ee,ne,Se,it);case W:return Se=Oi(Se),ye(ne,ee,oe,Se,it)}if(Ae(Se)||Q(Se))return ne=ne.get(oe)||null,be(ee,ne,Se,it,null);if(typeof Se.then=="function")return ye(ne,ee,oe,Nu(Se),it);if(Se.$$typeof===T)return ye(ne,ee,oe,Tu(ee,Se),it);Ou(ee,Se)}return null}function Qe(ne,ee,oe,Se){for(var it=null,Lt=null,tt=ee,wt=ee=0,Rt=null;tt!==null&&wt<oe.length;wt++){tt.index>wt?(Rt=tt,tt=null):Rt=tt.sibling;var Bt=de(ne,tt,oe[wt],Se);if(Bt===null){tt===null&&(tt=Rt);break}n&&tt&&Bt.alternate===null&&i(ne,tt),ee=p(Bt,ee,wt),Lt===null?it=Bt:Lt.sibling=Bt,Lt=Bt,tt=Rt}if(wt===oe.length)return o(ne,tt),Dt&&ss(ne,wt),it;if(tt===null){for(;wt<oe.length;wt++)tt=ke(ne,oe[wt],Se),tt!==null&&(ee=p(tt,ee,wt),Lt===null?it=tt:Lt.sibling=tt,Lt=tt);return Dt&&ss(ne,wt),it}for(tt=f(tt);wt<oe.length;wt++)Rt=ye(tt,ne,wt,oe[wt],Se),Rt!==null&&(n&&Rt.alternate!==null&&tt.delete(Rt.key===null?wt:Rt.key),ee=p(Rt,ee,wt),Lt===null?it=Rt:Lt.sibling=Rt,Lt=Rt);return n&&tt.forEach(function(Zs){return i(ne,Zs)}),Dt&&ss(ne,wt),it}function ot(ne,ee,oe,Se){if(oe==null)throw Error(a(151));for(var it=null,Lt=null,tt=ee,wt=ee=0,Rt=null,Bt=oe.next();tt!==null&&!Bt.done;wt++,Bt=oe.next()){tt.index>wt?(Rt=tt,tt=null):Rt=tt.sibling;var Zs=de(ne,tt,Bt.value,Se);if(Zs===null){tt===null&&(tt=Rt);break}n&&tt&&Zs.alternate===null&&i(ne,tt),ee=p(Zs,ee,wt),Lt===null?it=Zs:Lt.sibling=Zs,Lt=Zs,tt=Rt}if(Bt.done)return o(ne,tt),Dt&&ss(ne,wt),it;if(tt===null){for(;!Bt.done;wt++,Bt=oe.next())Bt=ke(ne,Bt.value,Se),Bt!==null&&(ee=p(Bt,ee,wt),Lt===null?it=Bt:Lt.sibling=Bt,Lt=Bt);return Dt&&ss(ne,wt),it}for(tt=f(tt);!Bt.done;wt++,Bt=oe.next())Bt=ye(tt,ne,wt,Bt.value,Se),Bt!==null&&(n&&Bt.alternate!==null&&tt.delete(Bt.key===null?wt:Bt.key),ee=p(Bt,ee,wt),Lt===null?it=Bt:Lt.sibling=Bt,Lt=Bt);return n&&tt.forEach(function(SS){return i(ne,SS)}),Dt&&ss(ne,wt),it}function tr(ne,ee,oe,Se){if(typeof oe=="object"&&oe!==null&&oe.type===w&&oe.key===null&&(oe=oe.props.children),typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case _:e:{for(var it=oe.key;ee!==null;){if(ee.key===it){if(it=oe.type,it===w){if(ee.tag===7){o(ne,ee.sibling),Se=m(ee,oe.props.children),Se.return=ne,ne=Se;break e}}else if(ee.elementType===it||typeof it=="object"&&it!==null&&it.$$typeof===W&&Oi(it)===ee.type){o(ne,ee.sibling),Se=m(ee,oe.props),$o(Se,oe),Se.return=ne,ne=Se;break e}o(ne,ee);break}else i(ne,ee);ee=ee.sibling}oe.type===w?(Se=Ti(oe.props.children,ne.mode,Se,oe.key),Se.return=ne,ne=Se):(Se=bu(oe.type,oe.key,oe.props,null,ne.mode,Se),$o(Se,oe),Se.return=ne,ne=Se)}return E(ne);case b:e:{for(it=oe.key;ee!==null;){if(ee.key===it)if(ee.tag===4&&ee.stateNode.containerInfo===oe.containerInfo&&ee.stateNode.implementation===oe.implementation){o(ne,ee.sibling),Se=m(ee,oe.children||[]),Se.return=ne,ne=Se;break e}else{o(ne,ee);break}else i(ne,ee);ee=ee.sibling}Se=Ff(oe,ne.mode,Se),Se.return=ne,ne=Se}return E(ne);case W:return oe=Oi(oe),tr(ne,ee,oe,Se)}if(Ae(oe))return Qe(ne,ee,oe,Se);if(Q(oe)){if(it=Q(oe),typeof it!="function")throw Error(a(150));return oe=it.call(oe),ot(ne,ee,oe,Se)}if(typeof oe.then=="function")return tr(ne,ee,Nu(oe),Se);if(oe.$$typeof===T)return tr(ne,ee,Tu(ne,oe),Se);Ou(ne,oe)}return typeof oe=="string"&&oe!==""||typeof oe=="number"||typeof oe=="bigint"?(oe=""+oe,ee!==null&&ee.tag===6?(o(ne,ee.sibling),Se=m(ee,oe),Se.return=ne,ne=Se):(o(ne,ee),Se=Df(oe,ne.mode,Se),Se.return=ne,ne=Se),E(ne)):o(ne,ee)}return function(ne,ee,oe,Se){try{Ho=0;var it=tr(ne,ee,oe,Se);return Rl=null,it}catch(tt){if(tt===Ol||tt===Au)throw tt;var Lt=$a(29,tt,null,ne.mode);return Lt.lanes=Se,Lt.return=ne,Lt}}}var Di=Z1(!0),eg=Z1(!1),Is=!1;function Gf(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function qf(n,i){n=n.updateQueue,i.updateQueue===n&&(i.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function Ls(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function Bs(n,i,o){var f=n.updateQueue;if(f===null)return null;if(f=f.shared,(Ht&2)!==0){var m=f.pending;return m===null?i.next=i:(i.next=m.next,m.next=i),f.pending=i,i=wu(n),L1(n,null,o),i}return _u(n,f,i,o),wu(n)}function Vo(n,i,o){if(i=i.updateQueue,i!==null&&(i=i.shared,(o&4194048)!==0)){var f=i.lanes;f&=n.pendingLanes,o|=f,i.lanes=o,Os(n,o)}}function Xf(n,i){var o=n.updateQueue,f=n.alternate;if(f!==null&&(f=f.updateQueue,o===f)){var m=null,p=null;if(o=o.firstBaseUpdate,o!==null){do{var E={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};p===null?m=p=E:p=p.next=E,o=o.next}while(o!==null);p===null?m=p=i:p=p.next=i}else m=p=i;o={baseState:f.baseState,firstBaseUpdate:m,lastBaseUpdate:p,shared:f.shared,callbacks:f.callbacks},n.updateQueue=o;return}n=o.lastBaseUpdate,n===null?o.firstBaseUpdate=i:n.next=i,o.lastBaseUpdate=i}var Wf=!1;function Go(){if(Wf){var n=Nl;if(n!==null)throw n}}function qo(n,i,o,f){Wf=!1;var m=n.updateQueue;Is=!1;var p=m.firstBaseUpdate,E=m.lastBaseUpdate,R=m.shared.pending;if(R!==null){m.shared.pending=null;var Y=R,ue=Y.next;Y.next=null,E===null?p=ue:E.next=ue,E=Y;var be=n.alternate;be!==null&&(be=be.updateQueue,R=be.lastBaseUpdate,R!==E&&(R===null?be.firstBaseUpdate=ue:R.next=ue,be.lastBaseUpdate=Y))}if(p!==null){var ke=m.baseState;E=0,be=ue=Y=null,R=p;do{var de=R.lane&-536870913,ye=de!==R.lane;if(ye?(Ot&de)===de:(f&de)===de){de!==0&&de===Cl&&(Wf=!0),be!==null&&(be=be.next={lane:0,tag:R.tag,payload:R.payload,callback:null,next:null});e:{var Qe=n,ot=R;de=i;var tr=o;switch(ot.tag){case 1:if(Qe=ot.payload,typeof Qe=="function"){ke=Qe.call(tr,ke,de);break e}ke=Qe;break e;case 3:Qe.flags=Qe.flags&-65537|128;case 0:if(Qe=ot.payload,de=typeof Qe=="function"?Qe.call(tr,ke,de):Qe,de==null)break e;ke=x({},ke,de);break e;case 2:Is=!0}}de=R.callback,de!==null&&(n.flags|=64,ye&&(n.flags|=8192),ye=m.callbacks,ye===null?m.callbacks=[de]:ye.push(de))}else ye={lane:de,tag:R.tag,payload:R.payload,callback:R.callback,next:null},be===null?(ue=be=ye,Y=ke):be=be.next=ye,E|=de;if(R=R.next,R===null){if(R=m.shared.pending,R===null)break;ye=R,R=ye.next,ye.next=null,m.lastBaseUpdate=ye,m.shared.pending=null}}while(!0);be===null&&(Y=ke),m.baseState=Y,m.firstBaseUpdate=ue,m.lastBaseUpdate=be,p===null&&(m.shared.lanes=0),$s|=E,n.lanes=E,n.memoizedState=ke}}function tg(n,i){if(typeof n!="function")throw Error(a(191,n));n.call(i)}function rg(n,i){var o=n.callbacks;if(o!==null)for(n.callbacks=null,n=0;n<o.length;n++)tg(o[n],i)}var Dl=G(null),Ru=G(0);function ag(n,i){n=ps,z(Ru,n),z(Dl,i),ps=n|i.baseLanes}function Kf(){z(Ru,ps),z(Dl,Dl.current)}function Yf(){ps=Ru.current,A(Dl),A(Ru)}var Va=G(null),fn=null;function Us(n){var i=n.alternate;z(Er,Er.current&1),z(Va,n),fn===null&&(i===null||Dl.current!==null||i.memoizedState!==null)&&(fn=n)}function Jf(n){z(Er,Er.current),z(Va,n),fn===null&&(fn=n)}function ng(n){n.tag===22?(z(Er,Er.current),z(Va,n),fn===null&&(fn=n)):Ps()}function Ps(){z(Er,Er.current),z(Va,Va.current)}function Ga(n){A(Va),fn===n&&(fn=null),A(Er)}var Er=G(0);function Du(n){for(var i=n;i!==null;){if(i.tag===13){var o=i.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||ad(o)||nd(o)))return i}else if(i.tag===19&&(i.memoizedProps.revealOrder==="forwards"||i.memoizedProps.revealOrder==="backwards"||i.memoizedProps.revealOrder==="unstable_legacy-backwards"||i.memoizedProps.revealOrder==="together")){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===n)break;for(;i.sibling===null;){if(i.return===null||i.return===n)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var os=0,yt=null,Zt=null,Or=null,Fu=!1,Fl=!1,Fi=!1,Mu=0,Xo=0,Ml=null,db=0;function xr(){throw Error(a(321))}function Qf(n,i){if(i===null)return!1;for(var o=0;o<i.length&&o<n.length;o++)if(!Ha(n[o],i[o]))return!1;return!0}function Zf(n,i,o,f,m,p){return os=p,yt=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,K.H=n===null||n.memoizedState===null?zg:mh,Fi=!1,p=o(f,m),Fi=!1,Fl&&(p=ig(i,o,f,m)),sg(n),p}function sg(n){K.H=Yo;var i=Zt!==null&&Zt.next!==null;if(os=0,Or=Zt=yt=null,Fu=!1,Xo=0,Ml=null,i)throw Error(a(300));n===null||Rr||(n=n.dependencies,n!==null&&Eu(n)&&(Rr=!0))}function ig(n,i,o,f){yt=n;var m=0;do{if(Fl&&(Ml=null),Xo=0,Fl=!1,25<=m)throw Error(a(301));if(m+=1,Or=Zt=null,n.updateQueue!=null){var p=n.updateQueue;p.lastEffect=null,p.events=null,p.stores=null,p.memoCache!=null&&(p.memoCache.index=0)}K.H=Hg,p=i(o,f)}while(Fl);return p}function mb(){var n=K.H,i=n.useState()[0];return i=typeof i.then=="function"?Wo(i):i,n=n.useState()[0],(Zt!==null?Zt.memoizedState:null)!==n&&(yt.flags|=1024),i}function eh(){var n=Mu!==0;return Mu=0,n}function th(n,i,o){i.updateQueue=n.updateQueue,i.flags&=-2053,n.lanes&=~o}function rh(n){if(Fu){for(n=n.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}Fu=!1}os=0,Or=Zt=yt=null,Fl=!1,Xo=Mu=0,Ml=null}function ba(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Or===null?yt.memoizedState=Or=n:Or=Or.next=n,Or}function Tr(){if(Zt===null){var n=yt.alternate;n=n!==null?n.memoizedState:null}else n=Zt.next;var i=Or===null?yt.memoizedState:Or.next;if(i!==null)Or=i,Zt=n;else{if(n===null)throw yt.alternate===null?Error(a(467)):Error(a(310));Zt=n,n={memoizedState:Zt.memoizedState,baseState:Zt.baseState,baseQueue:Zt.baseQueue,queue:Zt.queue,next:null},Or===null?yt.memoizedState=Or=n:Or=Or.next=n}return Or}function ju(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Wo(n){var i=Xo;return Xo+=1,Ml===null&&(Ml=[]),n=Y1(Ml,n,i),i=yt,(Or===null?i.memoizedState:Or.next)===null&&(i=i.alternate,K.H=i===null||i.memoizedState===null?zg:mh),n}function Iu(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return Wo(n);if(n.$$typeof===T)return ta(n)}throw Error(a(438,String(n)))}function ah(n){var i=null,o=yt.updateQueue;if(o!==null&&(i=o.memoCache),i==null){var f=yt.alternate;f!==null&&(f=f.updateQueue,f!==null&&(f=f.memoCache,f!=null&&(i={data:f.data.map(function(m){return m.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),o===null&&(o=ju(),yt.updateQueue=o),o.memoCache=i,o=i.data[i.index],o===void 0)for(o=i.data[i.index]=Array(n),f=0;f<n;f++)o[f]=re;return i.index++,o}function cs(n,i){return typeof i=="function"?i(n):i}function Lu(n){var i=Tr();return nh(i,Zt,n)}function nh(n,i,o){var f=n.queue;if(f===null)throw Error(a(311));f.lastRenderedReducer=o;var m=n.baseQueue,p=f.pending;if(p!==null){if(m!==null){var E=m.next;m.next=p.next,p.next=E}i.baseQueue=m=p,f.pending=null}if(p=n.baseState,m===null)n.memoizedState=p;else{i=m.next;var R=E=null,Y=null,ue=i,be=!1;do{var ke=ue.lane&-536870913;if(ke!==ue.lane?(Ot&ke)===ke:(os&ke)===ke){var de=ue.revertLane;if(de===0)Y!==null&&(Y=Y.next={lane:0,revertLane:0,gesture:null,action:ue.action,hasEagerState:ue.hasEagerState,eagerState:ue.eagerState,next:null}),ke===Cl&&(be=!0);else if((os&de)===de){ue=ue.next,de===Cl&&(be=!0);continue}else ke={lane:0,revertLane:ue.revertLane,gesture:null,action:ue.action,hasEagerState:ue.hasEagerState,eagerState:ue.eagerState,next:null},Y===null?(R=Y=ke,E=p):Y=Y.next=ke,yt.lanes|=de,$s|=de;ke=ue.action,Fi&&o(p,ke),p=ue.hasEagerState?ue.eagerState:o(p,ke)}else de={lane:ke,revertLane:ue.revertLane,gesture:ue.gesture,action:ue.action,hasEagerState:ue.hasEagerState,eagerState:ue.eagerState,next:null},Y===null?(R=Y=de,E=p):Y=Y.next=de,yt.lanes|=ke,$s|=ke;ue=ue.next}while(ue!==null&&ue!==i);if(Y===null?E=p:Y.next=R,!Ha(p,n.memoizedState)&&(Rr=!0,be&&(o=Nl,o!==null)))throw o;n.memoizedState=p,n.baseState=E,n.baseQueue=Y,f.lastRenderedState=p}return m===null&&(f.lanes=0),[n.memoizedState,f.dispatch]}function sh(n){var i=Tr(),o=i.queue;if(o===null)throw Error(a(311));o.lastRenderedReducer=n;var f=o.dispatch,m=o.pending,p=i.memoizedState;if(m!==null){o.pending=null;var E=m=m.next;do p=n(p,E.action),E=E.next;while(E!==m);Ha(p,i.memoizedState)||(Rr=!0),i.memoizedState=p,i.baseQueue===null&&(i.baseState=p),o.lastRenderedState=p}return[p,f]}function lg(n,i,o){var f=yt,m=Tr(),p=Dt;if(p){if(o===void 0)throw Error(a(407));o=o()}else o=i();var E=!Ha((Zt||m).memoizedState,o);if(E&&(m.memoizedState=o,Rr=!0),m=m.queue,oh(ug.bind(null,f,m,n),[n]),m.getSnapshot!==i||E||Or!==null&&Or.memoizedState.tag&1){if(f.flags|=2048,jl(9,{destroy:void 0},cg.bind(null,f,m,o,i),null),ar===null)throw Error(a(349));p||(os&127)!==0||og(f,i,o)}return o}function og(n,i,o){n.flags|=16384,n={getSnapshot:i,value:o},i=yt.updateQueue,i===null?(i=ju(),yt.updateQueue=i,i.stores=[n]):(o=i.stores,o===null?i.stores=[n]:o.push(n))}function cg(n,i,o,f){i.value=o,i.getSnapshot=f,fg(i)&&hg(n)}function ug(n,i,o){return o(function(){fg(i)&&hg(n)})}function fg(n){var i=n.getSnapshot;n=n.value;try{var o=i();return!Ha(n,o)}catch{return!0}}function hg(n){var i=Ei(n,2);i!==null&&ja(i,n,2)}function ih(n){var i=ba();if(typeof n=="function"){var o=n;if(n=o(),Fi){ca(!0);try{o()}finally{ca(!1)}}}return i.memoizedState=i.baseState=n,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:cs,lastRenderedState:n},i}function dg(n,i,o,f){return n.baseState=o,nh(n,Zt,typeof f=="function"?f:cs)}function gb(n,i,o,f,m){if(Pu(n))throw Error(a(485));if(n=i.action,n!==null){var p={payload:m,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(E){p.listeners.push(E)}};K.T!==null?o(!0):p.isTransition=!1,f(p),o=i.pending,o===null?(p.next=i.pending=p,mg(i,p)):(p.next=o.next,i.pending=o.next=p)}}function mg(n,i){var o=i.action,f=i.payload,m=n.state;if(i.isTransition){var p=K.T,E={};K.T=E;try{var R=o(m,f),Y=K.S;Y!==null&&Y(E,R),gg(n,i,R)}catch(ue){lh(n,i,ue)}finally{p!==null&&E.types!==null&&(p.types=E.types),K.T=p}}else try{p=o(m,f),gg(n,i,p)}catch(ue){lh(n,i,ue)}}function gg(n,i,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(f){pg(n,i,f)},function(f){return lh(n,i,f)}):pg(n,i,o)}function pg(n,i,o){i.status="fulfilled",i.value=o,xg(i),n.state=o,i=n.pending,i!==null&&(o=i.next,o===i?n.pending=null:(o=o.next,i.next=o,mg(n,o)))}function lh(n,i,o){var f=n.pending;if(n.pending=null,f!==null){f=f.next;do i.status="rejected",i.reason=o,xg(i),i=i.next;while(i!==f)}n.action=null}function xg(n){n=n.listeners;for(var i=0;i<n.length;i++)(0,n[i])()}function vg(n,i){return i}function yg(n,i){if(Dt){var o=ar.formState;if(o!==null){e:{var f=yt;if(Dt){if(lr){t:{for(var m=lr,p=un;m.nodeType!==8;){if(!p){m=null;break t}if(m=hn(m.nextSibling),m===null){m=null;break t}}p=m.data,m=p==="F!"||p==="F"?m:null}if(m){lr=hn(m.nextSibling),f=m.data==="F!";break e}}Ms(f)}f=!1}f&&(i=o[0])}}return o=ba(),o.memoizedState=o.baseState=i,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:vg,lastRenderedState:i},o.queue=f,o=Bg.bind(null,yt,f),f.dispatch=o,f=ih(!1),p=dh.bind(null,yt,!1,f.queue),f=ba(),m={state:i,dispatch:null,action:n,pending:null},f.queue=m,o=gb.bind(null,yt,m,p,o),m.dispatch=o,f.memoizedState=n,[i,o,!1]}function _g(n){var i=Tr();return wg(i,Zt,n)}function wg(n,i,o){if(i=nh(n,i,vg)[0],n=Lu(cs)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var f=Wo(i)}catch(E){throw E===Ol?Au:E}else f=i;i=Tr();var m=i.queue,p=m.dispatch;return o!==i.memoizedState&&(yt.flags|=2048,jl(9,{destroy:void 0},pb.bind(null,m,o),null)),[f,p,n]}function pb(n,i){n.action=i}function bg(n){var i=Tr(),o=Zt;if(o!==null)return wg(i,o,n);Tr(),i=i.memoizedState,o=Tr();var f=o.queue.dispatch;return o.memoizedState=n,[i,f,!1]}function jl(n,i,o,f){return n={tag:n,create:o,deps:f,inst:i,next:null},i=yt.updateQueue,i===null&&(i=ju(),yt.updateQueue=i),o=i.lastEffect,o===null?i.lastEffect=n.next=n:(f=o.next,o.next=n,n.next=f,i.lastEffect=n),n}function Sg(){return Tr().memoizedState}function Bu(n,i,o,f){var m=ba();yt.flags|=n,m.memoizedState=jl(1|i,{destroy:void 0},o,f===void 0?null:f)}function Uu(n,i,o,f){var m=Tr();f=f===void 0?null:f;var p=m.memoizedState.inst;Zt!==null&&f!==null&&Qf(f,Zt.memoizedState.deps)?m.memoizedState=jl(i,p,o,f):(yt.flags|=n,m.memoizedState=jl(1|i,p,o,f))}function Eg(n,i){Bu(8390656,8,n,i)}function oh(n,i){Uu(2048,8,n,i)}function xb(n){yt.flags|=4;var i=yt.updateQueue;if(i===null)i=ju(),yt.updateQueue=i,i.events=[n];else{var o=i.events;o===null?i.events=[n]:o.push(n)}}function Tg(n){var i=Tr().memoizedState;return xb({ref:i,nextImpl:n}),function(){if((Ht&2)!==0)throw Error(a(440));return i.impl.apply(void 0,arguments)}}function kg(n,i){return Uu(4,2,n,i)}function Ag(n,i){return Uu(4,4,n,i)}function Cg(n,i){if(typeof i=="function"){n=n();var o=i(n);return function(){typeof o=="function"?o():i(null)}}if(i!=null)return n=n(),i.current=n,function(){i.current=null}}function Ng(n,i,o){o=o!=null?o.concat([n]):null,Uu(4,4,Cg.bind(null,i,n),o)}function ch(){}function Og(n,i){var o=Tr();i=i===void 0?null:i;var f=o.memoizedState;return i!==null&&Qf(i,f[1])?f[0]:(o.memoizedState=[n,i],n)}function Rg(n,i){var o=Tr();i=i===void 0?null:i;var f=o.memoizedState;if(i!==null&&Qf(i,f[1]))return f[0];if(f=n(),Fi){ca(!0);try{n()}finally{ca(!1)}}return o.memoizedState=[f,i],f}function uh(n,i,o){return o===void 0||(os&1073741824)!==0&&(Ot&261930)===0?n.memoizedState=i:(n.memoizedState=o,n=Dp(),yt.lanes|=n,$s|=n,o)}function Dg(n,i,o,f){return Ha(o,i)?o:Dl.current!==null?(n=uh(n,o,f),Ha(n,i)||(Rr=!0),n):(os&42)===0||(os&1073741824)!==0&&(Ot&261930)===0?(Rr=!0,n.memoizedState=o):(n=Dp(),yt.lanes|=n,$s|=n,i)}function Fg(n,i,o,f,m){var p=le.p;le.p=p!==0&&8>p?p:8;var E=K.T,R={};K.T=R,dh(n,!1,i,o);try{var Y=m(),ue=K.S;if(ue!==null&&ue(R,Y),Y!==null&&typeof Y=="object"&&typeof Y.then=="function"){var be=hb(Y,f);Ko(n,i,be,Wa(n))}else Ko(n,i,f,Wa(n))}catch(ke){Ko(n,i,{then:function(){},status:"rejected",reason:ke},Wa())}finally{le.p=p,E!==null&&R.types!==null&&(E.types=R.types),K.T=E}}function vb(){}function fh(n,i,o,f){if(n.tag!==5)throw Error(a(476));var m=Mg(n).queue;Fg(n,m,i,je,o===null?vb:function(){return jg(n),o(f)})}function Mg(n){var i=n.memoizedState;if(i!==null)return i;i={memoizedState:je,baseState:je,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:cs,lastRenderedState:je},next:null};var o={};return i.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:cs,lastRenderedState:o},next:null},n.memoizedState=i,n=n.alternate,n!==null&&(n.memoizedState=i),i}function jg(n){var i=Mg(n);i.next===null&&(i=n.alternate.memoizedState),Ko(n,i.next.queue,{},Wa())}function hh(){return ta(hc)}function Ig(){return Tr().memoizedState}function Lg(){return Tr().memoizedState}function yb(n){for(var i=n.return;i!==null;){switch(i.tag){case 24:case 3:var o=Wa();n=Ls(o);var f=Bs(i,n,o);f!==null&&(ja(f,i,o),Vo(f,i,o)),i={cache:zf()},n.payload=i;return}i=i.return}}function _b(n,i,o){var f=Wa();o={lane:f,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},Pu(n)?Ug(i,o):(o=Of(n,i,o,f),o!==null&&(ja(o,n,f),Pg(o,i,f)))}function Bg(n,i,o){var f=Wa();Ko(n,i,o,f)}function Ko(n,i,o,f){var m={lane:f,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(Pu(n))Ug(i,m);else{var p=n.alternate;if(n.lanes===0&&(p===null||p.lanes===0)&&(p=i.lastRenderedReducer,p!==null))try{var E=i.lastRenderedState,R=p(E,o);if(m.hasEagerState=!0,m.eagerState=R,Ha(R,E))return _u(n,i,m,0),ar===null&&yu(),!1}catch{}if(o=Of(n,i,m,f),o!==null)return ja(o,n,f),Pg(o,i,f),!0}return!1}function dh(n,i,o,f){if(f={lane:2,revertLane:Gh(),gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},Pu(n)){if(i)throw Error(a(479))}else i=Of(n,o,f,2),i!==null&&ja(i,n,2)}function Pu(n){var i=n.alternate;return n===yt||i!==null&&i===yt}function Ug(n,i){Fl=Fu=!0;var o=n.pending;o===null?i.next=i:(i.next=o.next,o.next=i),n.pending=i}function Pg(n,i,o){if((o&4194048)!==0){var f=i.lanes;f&=n.pendingLanes,o|=f,i.lanes=o,Os(n,o)}}var Yo={readContext:ta,use:Iu,useCallback:xr,useContext:xr,useEffect:xr,useImperativeHandle:xr,useLayoutEffect:xr,useInsertionEffect:xr,useMemo:xr,useReducer:xr,useRef:xr,useState:xr,useDebugValue:xr,useDeferredValue:xr,useTransition:xr,useSyncExternalStore:xr,useId:xr,useHostTransitionStatus:xr,useFormState:xr,useActionState:xr,useOptimistic:xr,useMemoCache:xr,useCacheRefresh:xr};Yo.useEffectEvent=xr;var zg={readContext:ta,use:Iu,useCallback:function(n,i){return ba().memoizedState=[n,i===void 0?null:i],n},useContext:ta,useEffect:Eg,useImperativeHandle:function(n,i,o){o=o!=null?o.concat([n]):null,Bu(4194308,4,Cg.bind(null,i,n),o)},useLayoutEffect:function(n,i){return Bu(4194308,4,n,i)},useInsertionEffect:function(n,i){Bu(4,2,n,i)},useMemo:function(n,i){var o=ba();i=i===void 0?null:i;var f=n();if(Fi){ca(!0);try{n()}finally{ca(!1)}}return o.memoizedState=[f,i],f},useReducer:function(n,i,o){var f=ba();if(o!==void 0){var m=o(i);if(Fi){ca(!0);try{o(i)}finally{ca(!1)}}}else m=i;return f.memoizedState=f.baseState=m,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:m},f.queue=n,n=n.dispatch=_b.bind(null,yt,n),[f.memoizedState,n]},useRef:function(n){var i=ba();return n={current:n},i.memoizedState=n},useState:function(n){n=ih(n);var i=n.queue,o=Bg.bind(null,yt,i);return i.dispatch=o,[n.memoizedState,o]},useDebugValue:ch,useDeferredValue:function(n,i){var o=ba();return uh(o,n,i)},useTransition:function(){var n=ih(!1);return n=Fg.bind(null,yt,n.queue,!0,!1),ba().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,i,o){var f=yt,m=ba();if(Dt){if(o===void 0)throw Error(a(407));o=o()}else{if(o=i(),ar===null)throw Error(a(349));(Ot&127)!==0||og(f,i,o)}m.memoizedState=o;var p={value:o,getSnapshot:i};return m.queue=p,Eg(ug.bind(null,f,p,n),[n]),f.flags|=2048,jl(9,{destroy:void 0},cg.bind(null,f,p,o,i),null),o},useId:function(){var n=ba(),i=ar.identifierPrefix;if(Dt){var o=zn,f=Pn;o=(f&~(1<<32-qr(f)-1)).toString(32)+o,i="_"+i+"R_"+o,o=Mu++,0<o&&(i+="H"+o.toString(32)),i+="_"}else o=db++,i="_"+i+"r_"+o.toString(32)+"_";return n.memoizedState=i},useHostTransitionStatus:hh,useFormState:yg,useActionState:yg,useOptimistic:function(n){var i=ba();i.memoizedState=i.baseState=n;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=o,i=dh.bind(null,yt,!0,o),o.dispatch=i,[n,i]},useMemoCache:ah,useCacheRefresh:function(){return ba().memoizedState=yb.bind(null,yt)},useEffectEvent:function(n){var i=ba(),o={impl:n};return i.memoizedState=o,function(){if((Ht&2)!==0)throw Error(a(440));return o.impl.apply(void 0,arguments)}}},mh={readContext:ta,use:Iu,useCallback:Og,useContext:ta,useEffect:oh,useImperativeHandle:Ng,useInsertionEffect:kg,useLayoutEffect:Ag,useMemo:Rg,useReducer:Lu,useRef:Sg,useState:function(){return Lu(cs)},useDebugValue:ch,useDeferredValue:function(n,i){var o=Tr();return Dg(o,Zt.memoizedState,n,i)},useTransition:function(){var n=Lu(cs)[0],i=Tr().memoizedState;return[typeof n=="boolean"?n:Wo(n),i]},useSyncExternalStore:lg,useId:Ig,useHostTransitionStatus:hh,useFormState:_g,useActionState:_g,useOptimistic:function(n,i){var o=Tr();return dg(o,Zt,n,i)},useMemoCache:ah,useCacheRefresh:Lg};mh.useEffectEvent=Tg;var Hg={readContext:ta,use:Iu,useCallback:Og,useContext:ta,useEffect:oh,useImperativeHandle:Ng,useInsertionEffect:kg,useLayoutEffect:Ag,useMemo:Rg,useReducer:sh,useRef:Sg,useState:function(){return sh(cs)},useDebugValue:ch,useDeferredValue:function(n,i){var o=Tr();return Zt===null?uh(o,n,i):Dg(o,Zt.memoizedState,n,i)},useTransition:function(){var n=sh(cs)[0],i=Tr().memoizedState;return[typeof n=="boolean"?n:Wo(n),i]},useSyncExternalStore:lg,useId:Ig,useHostTransitionStatus:hh,useFormState:bg,useActionState:bg,useOptimistic:function(n,i){var o=Tr();return Zt!==null?dg(o,Zt,n,i):(o.baseState=n,[n,o.queue.dispatch])},useMemoCache:ah,useCacheRefresh:Lg};Hg.useEffectEvent=Tg;function gh(n,i,o,f){i=n.memoizedState,o=o(f,i),o=o==null?i:x({},i,o),n.memoizedState=o,n.lanes===0&&(n.updateQueue.baseState=o)}var ph={enqueueSetState:function(n,i,o){n=n._reactInternals;var f=Wa(),m=Ls(f);m.payload=i,o!=null&&(m.callback=o),i=Bs(n,m,f),i!==null&&(ja(i,n,f),Vo(i,n,f))},enqueueReplaceState:function(n,i,o){n=n._reactInternals;var f=Wa(),m=Ls(f);m.tag=1,m.payload=i,o!=null&&(m.callback=o),i=Bs(n,m,f),i!==null&&(ja(i,n,f),Vo(i,n,f))},enqueueForceUpdate:function(n,i){n=n._reactInternals;var o=Wa(),f=Ls(o);f.tag=2,i!=null&&(f.callback=i),i=Bs(n,f,o),i!==null&&(ja(i,n,o),Vo(i,n,o))}};function $g(n,i,o,f,m,p,E){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(f,p,E):i.prototype&&i.prototype.isPureReactComponent?!Io(o,f)||!Io(m,p):!0}function Vg(n,i,o,f){n=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(o,f),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(o,f),i.state!==n&&ph.enqueueReplaceState(i,i.state,null)}function Mi(n,i){var o=i;if("ref"in i){o={};for(var f in i)f!=="ref"&&(o[f]=i[f])}if(n=n.defaultProps){o===i&&(o=x({},o));for(var m in n)o[m]===void 0&&(o[m]=n[m])}return o}function Gg(n){vu(n)}function qg(n){console.error(n)}function Xg(n){vu(n)}function zu(n,i){try{var o=n.onUncaughtError;o(i.value,{componentStack:i.stack})}catch(f){setTimeout(function(){throw f})}}function Wg(n,i,o){try{var f=n.onCaughtError;f(o.value,{componentStack:o.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function xh(n,i,o){return o=Ls(o),o.tag=3,o.payload={element:null},o.callback=function(){zu(n,i)},o}function Kg(n){return n=Ls(n),n.tag=3,n}function Yg(n,i,o,f){var m=o.type.getDerivedStateFromError;if(typeof m=="function"){var p=f.value;n.payload=function(){return m(p)},n.callback=function(){Wg(i,o,f)}}var E=o.stateNode;E!==null&&typeof E.componentDidCatch=="function"&&(n.callback=function(){Wg(i,o,f),typeof m!="function"&&(Vs===null?Vs=new Set([this]):Vs.add(this));var R=f.stack;this.componentDidCatch(f.value,{componentStack:R!==null?R:""})})}function wb(n,i,o,f,m){if(o.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){if(i=o.alternate,i!==null&&Al(i,o,m,!0),o=Va.current,o!==null){switch(o.tag){case 31:case 13:return fn===null?Zu():o.alternate===null&&vr===0&&(vr=3),o.flags&=-257,o.flags|=65536,o.lanes=m,f===Cu?o.flags|=16384:(i=o.updateQueue,i===null?o.updateQueue=new Set([f]):i.add(f),Hh(n,f,m)),!1;case 22:return o.flags|=65536,f===Cu?o.flags|=16384:(i=o.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([f])},o.updateQueue=i):(o=i.retryQueue,o===null?i.retryQueue=new Set([f]):o.add(f)),Hh(n,f,m)),!1}throw Error(a(435,o.tag))}return Hh(n,f,m),Zu(),!1}if(Dt)return i=Va.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=m,f!==If&&(n=Error(a(422),{cause:f}),Uo(ln(n,o)))):(f!==If&&(i=Error(a(423),{cause:f}),Uo(ln(i,o))),n=n.current.alternate,n.flags|=65536,m&=-m,n.lanes|=m,f=ln(f,o),m=xh(n.stateNode,f,m),Xf(n,m),vr!==4&&(vr=2)),!1;var p=Error(a(520),{cause:f});if(p=ln(p,o),nc===null?nc=[p]:nc.push(p),vr!==4&&(vr=2),i===null)return!0;f=ln(f,o),o=i;do{switch(o.tag){case 3:return o.flags|=65536,n=m&-m,o.lanes|=n,n=xh(o.stateNode,f,n),Xf(o,n),!1;case 1:if(i=o.type,p=o.stateNode,(o.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||p!==null&&typeof p.componentDidCatch=="function"&&(Vs===null||!Vs.has(p))))return o.flags|=65536,m&=-m,o.lanes|=m,m=Kg(m),Yg(m,n,o,f),Xf(o,m),!1}o=o.return}while(o!==null);return!1}var vh=Error(a(461)),Rr=!1;function ra(n,i,o,f){i.child=n===null?eg(i,null,o,f):Di(i,n.child,o,f)}function Jg(n,i,o,f,m){o=o.render;var p=i.ref;if("ref"in f){var E={};for(var R in f)R!=="ref"&&(E[R]=f[R])}else E=f;return Ci(i),f=Zf(n,i,o,E,p,m),R=eh(),n!==null&&!Rr?(th(n,i,m),us(n,i,m)):(Dt&&R&&Mf(i),i.flags|=1,ra(n,i,f,m),i.child)}function Qg(n,i,o,f,m){if(n===null){var p=o.type;return typeof p=="function"&&!Rf(p)&&p.defaultProps===void 0&&o.compare===null?(i.tag=15,i.type=p,Zg(n,i,p,f,m)):(n=bu(o.type,null,f,i,i.mode,m),n.ref=i.ref,n.return=i,i.child=n)}if(p=n.child,!kh(n,m)){var E=p.memoizedProps;if(o=o.compare,o=o!==null?o:Io,o(E,f)&&n.ref===i.ref)return us(n,i,m)}return i.flags|=1,n=ns(p,f),n.ref=i.ref,n.return=i,i.child=n}function Zg(n,i,o,f,m){if(n!==null){var p=n.memoizedProps;if(Io(p,f)&&n.ref===i.ref)if(Rr=!1,i.pendingProps=f=p,kh(n,m))(n.flags&131072)!==0&&(Rr=!0);else return i.lanes=n.lanes,us(n,i,m)}return yh(n,i,o,f,m)}function ep(n,i,o,f){var m=f.children,p=n!==null?n.memoizedState:null;if(n===null&&i.stateNode===null&&(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),f.mode==="hidden"){if((i.flags&128)!==0){if(p=p!==null?p.baseLanes|o:o,n!==null){for(f=i.child=n.child,m=0;f!==null;)m=m|f.lanes|f.childLanes,f=f.sibling;f=m&~p}else f=0,i.child=null;return tp(n,i,p,o,f)}if((o&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},n!==null&&ku(i,p!==null?p.cachePool:null),p!==null?ag(i,p):Kf(),ng(i);else return f=i.lanes=536870912,tp(n,i,p!==null?p.baseLanes|o:o,o,f)}else p!==null?(ku(i,p.cachePool),ag(i,p),Ps(),i.memoizedState=null):(n!==null&&ku(i,null),Kf(),Ps());return ra(n,i,m,o),i.child}function Jo(n,i){return n!==null&&n.tag===22||i.stateNode!==null||(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.sibling}function tp(n,i,o,f,m){var p=$f();return p=p===null?null:{parent:Nr._currentValue,pool:p},i.memoizedState={baseLanes:o,cachePool:p},n!==null&&ku(i,null),Kf(),ng(i),n!==null&&Al(n,i,f,!0),i.childLanes=m,null}function Hu(n,i){return i=Vu({mode:i.mode,children:i.children},n.mode),i.ref=n.ref,n.child=i,i.return=n,i}function rp(n,i,o){return Di(i,n.child,null,o),n=Hu(i,i.pendingProps),n.flags|=2,Ga(i),i.memoizedState=null,n}function bb(n,i,o){var f=i.pendingProps,m=(i.flags&128)!==0;if(i.flags&=-129,n===null){if(Dt){if(f.mode==="hidden")return n=Hu(i,f),i.lanes=536870912,Jo(null,n);if(Jf(i),(n=lr)?(n=mx(n,un),n=n!==null&&n.data==="&"?n:null,n!==null&&(i.memoizedState={dehydrated:n,treeContext:Ds!==null?{id:Pn,overflow:zn}:null,retryLane:536870912,hydrationErrors:null},o=U1(n),o.return=i,i.child=o,ea=i,lr=null)):n=null,n===null)throw Ms(i);return i.lanes=536870912,null}return Hu(i,f)}var p=n.memoizedState;if(p!==null){var E=p.dehydrated;if(Jf(i),m)if(i.flags&256)i.flags&=-257,i=rp(n,i,o);else if(i.memoizedState!==null)i.child=n.child,i.flags|=128,i=null;else throw Error(a(558));else if(Rr||Al(n,i,o,!1),m=(o&n.childLanes)!==0,Rr||m){if(f=ar,f!==null&&(E=ml(f,o),E!==0&&E!==p.retryLane))throw p.retryLane=E,Ei(n,E),ja(f,n,E),vh;Zu(),i=rp(n,i,o)}else n=p.treeContext,lr=hn(E.nextSibling),ea=i,Dt=!0,Fs=null,un=!1,n!==null&&H1(i,n),i=Hu(i,f),i.flags|=4096;return i}return n=ns(n.child,{mode:f.mode,children:f.children}),n.ref=i.ref,i.child=n,n.return=i,n}function $u(n,i){var o=i.ref;if(o===null)n!==null&&n.ref!==null&&(i.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(a(284));(n===null||n.ref!==o)&&(i.flags|=4194816)}}function yh(n,i,o,f,m){return Ci(i),o=Zf(n,i,o,f,void 0,m),f=eh(),n!==null&&!Rr?(th(n,i,m),us(n,i,m)):(Dt&&f&&Mf(i),i.flags|=1,ra(n,i,o,m),i.child)}function ap(n,i,o,f,m,p){return Ci(i),i.updateQueue=null,o=ig(i,f,o,m),sg(n),f=eh(),n!==null&&!Rr?(th(n,i,p),us(n,i,p)):(Dt&&f&&Mf(i),i.flags|=1,ra(n,i,o,p),i.child)}function np(n,i,o,f,m){if(Ci(i),i.stateNode===null){var p=Sl,E=o.contextType;typeof E=="object"&&E!==null&&(p=ta(E)),p=new o(f,p),i.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,p.updater=ph,i.stateNode=p,p._reactInternals=i,p=i.stateNode,p.props=f,p.state=i.memoizedState,p.refs={},Gf(i),E=o.contextType,p.context=typeof E=="object"&&E!==null?ta(E):Sl,p.state=i.memoizedState,E=o.getDerivedStateFromProps,typeof E=="function"&&(gh(i,o,E,f),p.state=i.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof p.getSnapshotBeforeUpdate=="function"||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(E=p.state,typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount(),E!==p.state&&ph.enqueueReplaceState(p,p.state,null),qo(i,f,p,m),Go(),p.state=i.memoizedState),typeof p.componentDidMount=="function"&&(i.flags|=4194308),f=!0}else if(n===null){p=i.stateNode;var R=i.memoizedProps,Y=Mi(o,R);p.props=Y;var ue=p.context,be=o.contextType;E=Sl,typeof be=="object"&&be!==null&&(E=ta(be));var ke=o.getDerivedStateFromProps;be=typeof ke=="function"||typeof p.getSnapshotBeforeUpdate=="function",R=i.pendingProps!==R,be||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(R||ue!==E)&&Vg(i,p,f,E),Is=!1;var de=i.memoizedState;p.state=de,qo(i,f,p,m),Go(),ue=i.memoizedState,R||de!==ue||Is?(typeof ke=="function"&&(gh(i,o,ke,f),ue=i.memoizedState),(Y=Is||$g(i,o,Y,f,de,ue,E))?(be||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount()),typeof p.componentDidMount=="function"&&(i.flags|=4194308)):(typeof p.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=f,i.memoizedState=ue),p.props=f,p.state=ue,p.context=E,f=Y):(typeof p.componentDidMount=="function"&&(i.flags|=4194308),f=!1)}else{p=i.stateNode,qf(n,i),E=i.memoizedProps,be=Mi(o,E),p.props=be,ke=i.pendingProps,de=p.context,ue=o.contextType,Y=Sl,typeof ue=="object"&&ue!==null&&(Y=ta(ue)),R=o.getDerivedStateFromProps,(ue=typeof R=="function"||typeof p.getSnapshotBeforeUpdate=="function")||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(E!==ke||de!==Y)&&Vg(i,p,f,Y),Is=!1,de=i.memoizedState,p.state=de,qo(i,f,p,m),Go();var ye=i.memoizedState;E!==ke||de!==ye||Is||n!==null&&n.dependencies!==null&&Eu(n.dependencies)?(typeof R=="function"&&(gh(i,o,R,f),ye=i.memoizedState),(be=Is||$g(i,o,be,f,de,ye,Y)||n!==null&&n.dependencies!==null&&Eu(n.dependencies))?(ue||typeof p.UNSAFE_componentWillUpdate!="function"&&typeof p.componentWillUpdate!="function"||(typeof p.componentWillUpdate=="function"&&p.componentWillUpdate(f,ye,Y),typeof p.UNSAFE_componentWillUpdate=="function"&&p.UNSAFE_componentWillUpdate(f,ye,Y)),typeof p.componentDidUpdate=="function"&&(i.flags|=4),typeof p.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof p.componentDidUpdate!="function"||E===n.memoizedProps&&de===n.memoizedState||(i.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||E===n.memoizedProps&&de===n.memoizedState||(i.flags|=1024),i.memoizedProps=f,i.memoizedState=ye),p.props=f,p.state=ye,p.context=Y,f=be):(typeof p.componentDidUpdate!="function"||E===n.memoizedProps&&de===n.memoizedState||(i.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||E===n.memoizedProps&&de===n.memoizedState||(i.flags|=1024),f=!1)}return p=f,$u(n,i),f=(i.flags&128)!==0,p||f?(p=i.stateNode,o=f&&typeof o.getDerivedStateFromError!="function"?null:p.render(),i.flags|=1,n!==null&&f?(i.child=Di(i,n.child,null,m),i.child=Di(i,null,o,m)):ra(n,i,o,m),i.memoizedState=p.state,n=i.child):n=us(n,i,m),n}function sp(n,i,o,f){return ki(),i.flags|=256,ra(n,i,o,f),i.child}var _h={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function wh(n){return{baseLanes:n,cachePool:W1()}}function bh(n,i,o){return n=n!==null?n.childLanes&~o:0,i&&(n|=Xa),n}function ip(n,i,o){var f=i.pendingProps,m=!1,p=(i.flags&128)!==0,E;if((E=p)||(E=n!==null&&n.memoizedState===null?!1:(Er.current&2)!==0),E&&(m=!0,i.flags&=-129),E=(i.flags&32)!==0,i.flags&=-33,n===null){if(Dt){if(m?Us(i):Ps(),(n=lr)?(n=mx(n,un),n=n!==null&&n.data!=="&"?n:null,n!==null&&(i.memoizedState={dehydrated:n,treeContext:Ds!==null?{id:Pn,overflow:zn}:null,retryLane:536870912,hydrationErrors:null},o=U1(n),o.return=i,i.child=o,ea=i,lr=null)):n=null,n===null)throw Ms(i);return nd(n)?i.lanes=32:i.lanes=536870912,null}var R=f.children;return f=f.fallback,m?(Ps(),m=i.mode,R=Vu({mode:"hidden",children:R},m),f=Ti(f,m,o,null),R.return=i,f.return=i,R.sibling=f,i.child=R,f=i.child,f.memoizedState=wh(o),f.childLanes=bh(n,E,o),i.memoizedState=_h,Jo(null,f)):(Us(i),Sh(i,R))}var Y=n.memoizedState;if(Y!==null&&(R=Y.dehydrated,R!==null)){if(p)i.flags&256?(Us(i),i.flags&=-257,i=Eh(n,i,o)):i.memoizedState!==null?(Ps(),i.child=n.child,i.flags|=128,i=null):(Ps(),R=f.fallback,m=i.mode,f=Vu({mode:"visible",children:f.children},m),R=Ti(R,m,o,null),R.flags|=2,f.return=i,R.return=i,f.sibling=R,i.child=f,Di(i,n.child,null,o),f=i.child,f.memoizedState=wh(o),f.childLanes=bh(n,E,o),i.memoizedState=_h,i=Jo(null,f));else if(Us(i),nd(R)){if(E=R.nextSibling&&R.nextSibling.dataset,E)var ue=E.dgst;E=ue,f=Error(a(419)),f.stack="",f.digest=E,Uo({value:f,source:null,stack:null}),i=Eh(n,i,o)}else if(Rr||Al(n,i,o,!1),E=(o&n.childLanes)!==0,Rr||E){if(E=ar,E!==null&&(f=ml(E,o),f!==0&&f!==Y.retryLane))throw Y.retryLane=f,Ei(n,f),ja(E,n,f),vh;ad(R)||Zu(),i=Eh(n,i,o)}else ad(R)?(i.flags|=192,i.child=n.child,i=null):(n=Y.treeContext,lr=hn(R.nextSibling),ea=i,Dt=!0,Fs=null,un=!1,n!==null&&H1(i,n),i=Sh(i,f.children),i.flags|=4096);return i}return m?(Ps(),R=f.fallback,m=i.mode,Y=n.child,ue=Y.sibling,f=ns(Y,{mode:"hidden",children:f.children}),f.subtreeFlags=Y.subtreeFlags&65011712,ue!==null?R=ns(ue,R):(R=Ti(R,m,o,null),R.flags|=2),R.return=i,f.return=i,f.sibling=R,i.child=f,Jo(null,f),f=i.child,R=n.child.memoizedState,R===null?R=wh(o):(m=R.cachePool,m!==null?(Y=Nr._currentValue,m=m.parent!==Y?{parent:Y,pool:Y}:m):m=W1(),R={baseLanes:R.baseLanes|o,cachePool:m}),f.memoizedState=R,f.childLanes=bh(n,E,o),i.memoizedState=_h,Jo(n.child,f)):(Us(i),o=n.child,n=o.sibling,o=ns(o,{mode:"visible",children:f.children}),o.return=i,o.sibling=null,n!==null&&(E=i.deletions,E===null?(i.deletions=[n],i.flags|=16):E.push(n)),i.child=o,i.memoizedState=null,o)}function Sh(n,i){return i=Vu({mode:"visible",children:i},n.mode),i.return=n,n.child=i}function Vu(n,i){return n=$a(22,n,null,i),n.lanes=0,n}function Eh(n,i,o){return Di(i,n.child,null,o),n=Sh(i,i.pendingProps.children),n.flags|=2,i.memoizedState=null,n}function lp(n,i,o){n.lanes|=i;var f=n.alternate;f!==null&&(f.lanes|=i),Uf(n.return,i,o)}function Th(n,i,o,f,m,p){var E=n.memoizedState;E===null?n.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:f,tail:o,tailMode:m,treeForkCount:p}:(E.isBackwards=i,E.rendering=null,E.renderingStartTime=0,E.last=f,E.tail=o,E.tailMode=m,E.treeForkCount=p)}function op(n,i,o){var f=i.pendingProps,m=f.revealOrder,p=f.tail;f=f.children;var E=Er.current,R=(E&2)!==0;if(R?(E=E&1|2,i.flags|=128):E&=1,z(Er,E),ra(n,i,f,o),f=Dt?Bo:0,!R&&n!==null&&(n.flags&128)!==0)e:for(n=i.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&lp(n,o,i);else if(n.tag===19)lp(n,o,i);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===i)break e;for(;n.sibling===null;){if(n.return===null||n.return===i)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}switch(m){case"forwards":for(o=i.child,m=null;o!==null;)n=o.alternate,n!==null&&Du(n)===null&&(m=o),o=o.sibling;o=m,o===null?(m=i.child,i.child=null):(m=o.sibling,o.sibling=null),Th(i,!1,m,o,p,f);break;case"backwards":case"unstable_legacy-backwards":for(o=null,m=i.child,i.child=null;m!==null;){if(n=m.alternate,n!==null&&Du(n)===null){i.child=m;break}n=m.sibling,m.sibling=o,o=m,m=n}Th(i,!0,o,null,p,f);break;case"together":Th(i,!1,null,null,void 0,f);break;default:i.memoizedState=null}return i.child}function us(n,i,o){if(n!==null&&(i.dependencies=n.dependencies),$s|=i.lanes,(o&i.childLanes)===0)if(n!==null){if(Al(n,i,o,!1),(o&i.childLanes)===0)return null}else return null;if(n!==null&&i.child!==n.child)throw Error(a(153));if(i.child!==null){for(n=i.child,o=ns(n,n.pendingProps),i.child=o,o.return=i;n.sibling!==null;)n=n.sibling,o=o.sibling=ns(n,n.pendingProps),o.return=i;o.sibling=null}return i.child}function kh(n,i){return(n.lanes&i)!==0?!0:(n=n.dependencies,!!(n!==null&&Eu(n)))}function Sb(n,i,o){switch(i.tag){case 3:ge(i,i.stateNode.containerInfo),js(i,Nr,n.memoizedState.cache),ki();break;case 27:case 5:Ee(i);break;case 4:ge(i,i.stateNode.containerInfo);break;case 10:js(i,i.type,i.memoizedProps.value);break;case 31:if(i.memoizedState!==null)return i.flags|=128,Jf(i),null;break;case 13:var f=i.memoizedState;if(f!==null)return f.dehydrated!==null?(Us(i),i.flags|=128,null):(o&i.child.childLanes)!==0?ip(n,i,o):(Us(i),n=us(n,i,o),n!==null?n.sibling:null);Us(i);break;case 19:var m=(n.flags&128)!==0;if(f=(o&i.childLanes)!==0,f||(Al(n,i,o,!1),f=(o&i.childLanes)!==0),m){if(f)return op(n,i,o);i.flags|=128}if(m=i.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),z(Er,Er.current),f)break;return null;case 22:return i.lanes=0,ep(n,i,o,i.pendingProps);case 24:js(i,Nr,n.memoizedState.cache)}return us(n,i,o)}function cp(n,i,o){if(n!==null)if(n.memoizedProps!==i.pendingProps)Rr=!0;else{if(!kh(n,o)&&(i.flags&128)===0)return Rr=!1,Sb(n,i,o);Rr=(n.flags&131072)!==0}else Rr=!1,Dt&&(i.flags&1048576)!==0&&z1(i,Bo,i.index);switch(i.lanes=0,i.tag){case 16:e:{var f=i.pendingProps;if(n=Oi(i.elementType),i.type=n,typeof n=="function")Rf(n)?(f=Mi(n,f),i.tag=1,i=np(null,i,n,f,o)):(i.tag=0,i=yh(null,i,n,f,o));else{if(n!=null){var m=n.$$typeof;if(m===j){i.tag=11,i=Jg(null,i,n,f,o);break e}else if(m===N){i.tag=14,i=Qg(null,i,n,f,o);break e}}throw i=Oe(n)||n,Error(a(306,i,""))}}return i;case 0:return yh(n,i,i.type,i.pendingProps,o);case 1:return f=i.type,m=Mi(f,i.pendingProps),np(n,i,f,m,o);case 3:e:{if(ge(i,i.stateNode.containerInfo),n===null)throw Error(a(387));f=i.pendingProps;var p=i.memoizedState;m=p.element,qf(n,i),qo(i,f,null,o);var E=i.memoizedState;if(f=E.cache,js(i,Nr,f),f!==p.cache&&Pf(i,[Nr],o,!0),Go(),f=E.element,p.isDehydrated)if(p={element:f,isDehydrated:!1,cache:E.cache},i.updateQueue.baseState=p,i.memoizedState=p,i.flags&256){i=sp(n,i,f,o);break e}else if(f!==m){m=ln(Error(a(424)),i),Uo(m),i=sp(n,i,f,o);break e}else for(n=i.stateNode.containerInfo,n.nodeType===9?n=n.body:n=n.nodeName==="HTML"?n.ownerDocument.body:n,lr=hn(n.firstChild),ea=i,Dt=!0,Fs=null,un=!0,o=eg(i,null,f,o),i.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(ki(),f===m){i=us(n,i,o);break e}ra(n,i,f,o)}i=i.child}return i;case 26:return $u(n,i),n===null?(o=_x(i.type,null,i.pendingProps,null))?i.memoizedState=o:Dt||(o=i.type,n=i.pendingProps,f=i0(te.current).createElement(o),f[M]=i,f[B]=n,aa(f,o,n),We(f),i.stateNode=f):i.memoizedState=_x(i.type,n.memoizedProps,i.pendingProps,n.memoizedState),null;case 27:return Ee(i),n===null&&Dt&&(f=i.stateNode=xx(i.type,i.pendingProps,te.current),ea=i,un=!0,m=lr,Ws(i.type)?(sd=m,lr=hn(f.firstChild)):lr=m),ra(n,i,i.pendingProps.children,o),$u(n,i),n===null&&(i.flags|=4194304),i.child;case 5:return n===null&&Dt&&((m=f=lr)&&(f=Zb(f,i.type,i.pendingProps,un),f!==null?(i.stateNode=f,ea=i,lr=hn(f.firstChild),un=!1,m=!0):m=!1),m||Ms(i)),Ee(i),m=i.type,p=i.pendingProps,E=n!==null?n.memoizedProps:null,f=p.children,ed(m,p)?f=null:E!==null&&ed(m,E)&&(i.flags|=32),i.memoizedState!==null&&(m=Zf(n,i,mb,null,null,o),hc._currentValue=m),$u(n,i),ra(n,i,f,o),i.child;case 6:return n===null&&Dt&&((n=o=lr)&&(o=eS(o,i.pendingProps,un),o!==null?(i.stateNode=o,ea=i,lr=null,n=!0):n=!1),n||Ms(i)),null;case 13:return ip(n,i,o);case 4:return ge(i,i.stateNode.containerInfo),f=i.pendingProps,n===null?i.child=Di(i,null,f,o):ra(n,i,f,o),i.child;case 11:return Jg(n,i,i.type,i.pendingProps,o);case 7:return ra(n,i,i.pendingProps,o),i.child;case 8:return ra(n,i,i.pendingProps.children,o),i.child;case 12:return ra(n,i,i.pendingProps.children,o),i.child;case 10:return f=i.pendingProps,js(i,i.type,f.value),ra(n,i,f.children,o),i.child;case 9:return m=i.type._context,f=i.pendingProps.children,Ci(i),m=ta(m),f=f(m),i.flags|=1,ra(n,i,f,o),i.child;case 14:return Qg(n,i,i.type,i.pendingProps,o);case 15:return Zg(n,i,i.type,i.pendingProps,o);case 19:return op(n,i,o);case 31:return bb(n,i,o);case 22:return ep(n,i,o,i.pendingProps);case 24:return Ci(i),f=ta(Nr),n===null?(m=$f(),m===null&&(m=ar,p=zf(),m.pooledCache=p,p.refCount++,p!==null&&(m.pooledCacheLanes|=o),m=p),i.memoizedState={parent:f,cache:m},Gf(i),js(i,Nr,m)):((n.lanes&o)!==0&&(qf(n,i),qo(i,null,null,o),Go()),m=n.memoizedState,p=i.memoizedState,m.parent!==f?(m={parent:f,cache:f},i.memoizedState=m,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=m),js(i,Nr,f)):(f=p.cache,js(i,Nr,f),f!==m.cache&&Pf(i,[Nr],o,!0))),ra(n,i,i.pendingProps.children,o),i.child;case 29:throw i.pendingProps}throw Error(a(156,i.tag))}function fs(n){n.flags|=4}function Ah(n,i,o,f,m){if((i=(n.mode&32)!==0)&&(i=!1),i){if(n.flags|=16777216,(m&335544128)===m)if(n.stateNode.complete)n.flags|=8192;else if(Ip())n.flags|=8192;else throw Ri=Cu,Vf}else n.flags&=-16777217}function up(n,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!Tx(i))if(Ip())n.flags|=8192;else throw Ri=Cu,Vf}function Gu(n,i){i!==null&&(n.flags|=4),n.flags&16384&&(i=n.tag!==22?hl():536870912,n.lanes|=i,Ul|=i)}function Qo(n,i){if(!Dt)switch(n.tailMode){case"hidden":i=n.tail;for(var o=null;i!==null;)i.alternate!==null&&(o=i),i=i.sibling;o===null?n.tail=null:o.sibling=null;break;case"collapsed":o=n.tail;for(var f=null;o!==null;)o.alternate!==null&&(f=o),o=o.sibling;f===null?i||n.tail===null?n.tail=null:n.tail.sibling=null:f.sibling=null}}function or(n){var i=n.alternate!==null&&n.alternate.child===n.child,o=0,f=0;if(i)for(var m=n.child;m!==null;)o|=m.lanes|m.childLanes,f|=m.subtreeFlags&65011712,f|=m.flags&65011712,m.return=n,m=m.sibling;else for(m=n.child;m!==null;)o|=m.lanes|m.childLanes,f|=m.subtreeFlags,f|=m.flags,m.return=n,m=m.sibling;return n.subtreeFlags|=f,n.childLanes=o,i}function Eb(n,i,o){var f=i.pendingProps;switch(jf(i),i.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return or(i),null;case 1:return or(i),null;case 3:return o=i.stateNode,f=null,n!==null&&(f=n.memoizedState.cache),i.memoizedState.cache!==f&&(i.flags|=2048),ls(Nr),pe(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(n===null||n.child===null)&&(kl(i)?fs(i):n===null||n.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,Lf())),or(i),null;case 26:var m=i.type,p=i.memoizedState;return n===null?(fs(i),p!==null?(or(i),up(i,p)):(or(i),Ah(i,m,null,f,o))):p?p!==n.memoizedState?(fs(i),or(i),up(i,p)):(or(i),i.flags&=-16777217):(n=n.memoizedProps,n!==f&&fs(i),or(i),Ah(i,m,n,f,o)),null;case 27:if(et(i),o=te.current,m=i.type,n!==null&&i.stateNode!=null)n.memoizedProps!==f&&fs(i);else{if(!f){if(i.stateNode===null)throw Error(a(166));return or(i),null}n=I.current,kl(i)?$1(i):(n=xx(m,f,o),i.stateNode=n,fs(i))}return or(i),null;case 5:if(et(i),m=i.type,n!==null&&i.stateNode!=null)n.memoizedProps!==f&&fs(i);else{if(!f){if(i.stateNode===null)throw Error(a(166));return or(i),null}if(p=I.current,kl(i))$1(i);else{var E=i0(te.current);switch(p){case 1:p=E.createElementNS("http://www.w3.org/2000/svg",m);break;case 2:p=E.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;default:switch(m){case"svg":p=E.createElementNS("http://www.w3.org/2000/svg",m);break;case"math":p=E.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;case"script":p=E.createElement("div"),p.innerHTML="<script><\/script>",p=p.removeChild(p.firstChild);break;case"select":p=typeof f.is=="string"?E.createElement("select",{is:f.is}):E.createElement("select"),f.multiple?p.multiple=!0:f.size&&(p.size=f.size);break;default:p=typeof f.is=="string"?E.createElement(m,{is:f.is}):E.createElement(m)}}p[M]=i,p[B]=f;e:for(E=i.child;E!==null;){if(E.tag===5||E.tag===6)p.appendChild(E.stateNode);else if(E.tag!==4&&E.tag!==27&&E.child!==null){E.child.return=E,E=E.child;continue}if(E===i)break e;for(;E.sibling===null;){if(E.return===null||E.return===i)break e;E=E.return}E.sibling.return=E.return,E=E.sibling}i.stateNode=p;e:switch(aa(p,m,f),m){case"button":case"input":case"select":case"textarea":f=!!f.autoFocus;break e;case"img":f=!0;break e;default:f=!1}f&&fs(i)}}return or(i),Ah(i,i.type,n===null?null:n.memoizedProps,i.pendingProps,o),null;case 6:if(n&&i.stateNode!=null)n.memoizedProps!==f&&fs(i);else{if(typeof f!="string"&&i.stateNode===null)throw Error(a(166));if(n=te.current,kl(i)){if(n=i.stateNode,o=i.memoizedProps,f=null,m=ea,m!==null)switch(m.tag){case 27:case 5:f=m.memoizedProps}n[M]=i,n=!!(n.nodeValue===o||f!==null&&f.suppressHydrationWarning===!0||ix(n.nodeValue,o)),n||Ms(i,!0)}else n=i0(n).createTextNode(f),n[M]=i,i.stateNode=n}return or(i),null;case 31:if(o=i.memoizedState,n===null||n.memoizedState!==null){if(f=kl(i),o!==null){if(n===null){if(!f)throw Error(a(318));if(n=i.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(a(557));n[M]=i}else ki(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;or(i),n=!1}else o=Lf(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=o),n=!0;if(!n)return i.flags&256?(Ga(i),i):(Ga(i),null);if((i.flags&128)!==0)throw Error(a(558))}return or(i),null;case 13:if(f=i.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(m=kl(i),f!==null&&f.dehydrated!==null){if(n===null){if(!m)throw Error(a(318));if(m=i.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(a(317));m[M]=i}else ki(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;or(i),m=!1}else m=Lf(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=m),m=!0;if(!m)return i.flags&256?(Ga(i),i):(Ga(i),null)}return Ga(i),(i.flags&128)!==0?(i.lanes=o,i):(o=f!==null,n=n!==null&&n.memoizedState!==null,o&&(f=i.child,m=null,f.alternate!==null&&f.alternate.memoizedState!==null&&f.alternate.memoizedState.cachePool!==null&&(m=f.alternate.memoizedState.cachePool.pool),p=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(p=f.memoizedState.cachePool.pool),p!==m&&(f.flags|=2048)),o!==n&&o&&(i.child.flags|=8192),Gu(i,i.updateQueue),or(i),null);case 4:return pe(),n===null&&Kh(i.stateNode.containerInfo),or(i),null;case 10:return ls(i.type),or(i),null;case 19:if(A(Er),f=i.memoizedState,f===null)return or(i),null;if(m=(i.flags&128)!==0,p=f.rendering,p===null)if(m)Qo(f,!1);else{if(vr!==0||n!==null&&(n.flags&128)!==0)for(n=i.child;n!==null;){if(p=Du(n),p!==null){for(i.flags|=128,Qo(f,!1),n=p.updateQueue,i.updateQueue=n,Gu(i,n),i.subtreeFlags=0,n=o,o=i.child;o!==null;)B1(o,n),o=o.sibling;return z(Er,Er.current&1|2),Dt&&ss(i,f.treeForkCount),i.child}n=n.sibling}f.tail!==null&&It()>Yu&&(i.flags|=128,m=!0,Qo(f,!1),i.lanes=4194304)}else{if(!m)if(n=Du(p),n!==null){if(i.flags|=128,m=!0,n=n.updateQueue,i.updateQueue=n,Gu(i,n),Qo(f,!0),f.tail===null&&f.tailMode==="hidden"&&!p.alternate&&!Dt)return or(i),null}else 2*It()-f.renderingStartTime>Yu&&o!==536870912&&(i.flags|=128,m=!0,Qo(f,!1),i.lanes=4194304);f.isBackwards?(p.sibling=i.child,i.child=p):(n=f.last,n!==null?n.sibling=p:i.child=p,f.last=p)}return f.tail!==null?(n=f.tail,f.rendering=n,f.tail=n.sibling,f.renderingStartTime=It(),n.sibling=null,o=Er.current,z(Er,m?o&1|2:o&1),Dt&&ss(i,f.treeForkCount),n):(or(i),null);case 22:case 23:return Ga(i),Yf(),f=i.memoizedState!==null,n!==null?n.memoizedState!==null!==f&&(i.flags|=8192):f&&(i.flags|=8192),f?(o&536870912)!==0&&(i.flags&128)===0&&(or(i),i.subtreeFlags&6&&(i.flags|=8192)):or(i),o=i.updateQueue,o!==null&&Gu(i,o.retryQueue),o=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),f=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(f=i.memoizedState.cachePool.pool),f!==o&&(i.flags|=2048),n!==null&&A(Ni),null;case 24:return o=null,n!==null&&(o=n.memoizedState.cache),i.memoizedState.cache!==o&&(i.flags|=2048),ls(Nr),or(i),null;case 25:return null;case 30:return null}throw Error(a(156,i.tag))}function Tb(n,i){switch(jf(i),i.tag){case 1:return n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 3:return ls(Nr),pe(),n=i.flags,(n&65536)!==0&&(n&128)===0?(i.flags=n&-65537|128,i):null;case 26:case 27:case 5:return et(i),null;case 31:if(i.memoizedState!==null){if(Ga(i),i.alternate===null)throw Error(a(340));ki()}return n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 13:if(Ga(i),n=i.memoizedState,n!==null&&n.dehydrated!==null){if(i.alternate===null)throw Error(a(340));ki()}return n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 19:return A(Er),null;case 4:return pe(),null;case 10:return ls(i.type),null;case 22:case 23:return Ga(i),Yf(),n!==null&&A(Ni),n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 24:return ls(Nr),null;case 25:return null;default:return null}}function fp(n,i){switch(jf(i),i.tag){case 3:ls(Nr),pe();break;case 26:case 27:case 5:et(i);break;case 4:pe();break;case 31:i.memoizedState!==null&&Ga(i);break;case 13:Ga(i);break;case 19:A(Er);break;case 10:ls(i.type);break;case 22:case 23:Ga(i),Yf(),n!==null&&A(Ni);break;case 24:ls(Nr)}}function Zo(n,i){try{var o=i.updateQueue,f=o!==null?o.lastEffect:null;if(f!==null){var m=f.next;o=m;do{if((o.tag&n)===n){f=void 0;var p=o.create,E=o.inst;f=p(),E.destroy=f}o=o.next}while(o!==m)}}catch(R){qt(i,i.return,R)}}function zs(n,i,o){try{var f=i.updateQueue,m=f!==null?f.lastEffect:null;if(m!==null){var p=m.next;f=p;do{if((f.tag&n)===n){var E=f.inst,R=E.destroy;if(R!==void 0){E.destroy=void 0,m=i;var Y=o,ue=R;try{ue()}catch(be){qt(m,Y,be)}}}f=f.next}while(f!==p)}}catch(be){qt(i,i.return,be)}}function hp(n){var i=n.updateQueue;if(i!==null){var o=n.stateNode;try{rg(i,o)}catch(f){qt(n,n.return,f)}}}function dp(n,i,o){o.props=Mi(n.type,n.memoizedProps),o.state=n.memoizedState;try{o.componentWillUnmount()}catch(f){qt(n,i,f)}}function ec(n,i){try{var o=n.ref;if(o!==null){switch(n.tag){case 26:case 27:case 5:var f=n.stateNode;break;case 30:f=n.stateNode;break;default:f=n.stateNode}typeof o=="function"?n.refCleanup=o(f):o.current=f}}catch(m){qt(n,i,m)}}function Hn(n,i){var o=n.ref,f=n.refCleanup;if(o!==null)if(typeof f=="function")try{f()}catch(m){qt(n,i,m)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(m){qt(n,i,m)}else o.current=null}function mp(n){var i=n.type,o=n.memoizedProps,f=n.stateNode;try{e:switch(i){case"button":case"input":case"select":case"textarea":o.autoFocus&&f.focus();break e;case"img":o.src?f.src=o.src:o.srcSet&&(f.srcset=o.srcSet)}}catch(m){qt(n,n.return,m)}}function Ch(n,i,o){try{var f=n.stateNode;Xb(f,n.type,o,i),f[B]=i}catch(m){qt(n,n.return,m)}}function gp(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&Ws(n.type)||n.tag===4}function Nh(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||gp(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&Ws(n.type)||n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Oh(n,i,o){var f=n.tag;if(f===5||f===6)n=n.stateNode,i?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(n,i):(i=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,i.appendChild(n),o=o._reactRootContainer,o!=null||i.onclick!==null||(i.onclick=Ge));else if(f!==4&&(f===27&&Ws(n.type)&&(o=n.stateNode,i=null),n=n.child,n!==null))for(Oh(n,i,o),n=n.sibling;n!==null;)Oh(n,i,o),n=n.sibling}function qu(n,i,o){var f=n.tag;if(f===5||f===6)n=n.stateNode,i?o.insertBefore(n,i):o.appendChild(n);else if(f!==4&&(f===27&&Ws(n.type)&&(o=n.stateNode),n=n.child,n!==null))for(qu(n,i,o),n=n.sibling;n!==null;)qu(n,i,o),n=n.sibling}function pp(n){var i=n.stateNode,o=n.memoizedProps;try{for(var f=n.type,m=i.attributes;m.length;)i.removeAttributeNode(m[0]);aa(i,f,o),i[M]=n,i[B]=o}catch(p){qt(n,n.return,p)}}var hs=!1,Dr=!1,Rh=!1,xp=typeof WeakSet=="function"?WeakSet:Set,Xr=null;function kb(n,i){if(n=n.containerInfo,Qh=d0,n=N1(n),Ef(n)){if("selectionStart"in n)var o={start:n.selectionStart,end:n.selectionEnd};else e:{o=(o=n.ownerDocument)&&o.defaultView||window;var f=o.getSelection&&o.getSelection();if(f&&f.rangeCount!==0){o=f.anchorNode;var m=f.anchorOffset,p=f.focusNode;f=f.focusOffset;try{o.nodeType,p.nodeType}catch{o=null;break e}var E=0,R=-1,Y=-1,ue=0,be=0,ke=n,de=null;t:for(;;){for(var ye;ke!==o||m!==0&&ke.nodeType!==3||(R=E+m),ke!==p||f!==0&&ke.nodeType!==3||(Y=E+f),ke.nodeType===3&&(E+=ke.nodeValue.length),(ye=ke.firstChild)!==null;)de=ke,ke=ye;for(;;){if(ke===n)break t;if(de===o&&++ue===m&&(R=E),de===p&&++be===f&&(Y=E),(ye=ke.nextSibling)!==null)break;ke=de,de=ke.parentNode}ke=ye}o=R===-1||Y===-1?null:{start:R,end:Y}}else o=null}o=o||{start:0,end:0}}else o=null;for(Zh={focusedElem:n,selectionRange:o},d0=!1,Xr=i;Xr!==null;)if(i=Xr,n=i.child,(i.subtreeFlags&1028)!==0&&n!==null)n.return=i,Xr=n;else for(;Xr!==null;){switch(i=Xr,p=i.alternate,n=i.flags,i.tag){case 0:if((n&4)!==0&&(n=i.updateQueue,n=n!==null?n.events:null,n!==null))for(o=0;o<n.length;o++)m=n[o],m.ref.impl=m.nextImpl;break;case 11:case 15:break;case 1:if((n&1024)!==0&&p!==null){n=void 0,o=i,m=p.memoizedProps,p=p.memoizedState,f=o.stateNode;try{var Qe=Mi(o.type,m);n=f.getSnapshotBeforeUpdate(Qe,p),f.__reactInternalSnapshotBeforeUpdate=n}catch(ot){qt(o,o.return,ot)}}break;case 3:if((n&1024)!==0){if(n=i.stateNode.containerInfo,o=n.nodeType,o===9)rd(n);else if(o===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":rd(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(a(163))}if(n=i.sibling,n!==null){n.return=i.return,Xr=n;break}Xr=i.return}}function vp(n,i,o){var f=o.flags;switch(o.tag){case 0:case 11:case 15:ms(n,o),f&4&&Zo(5,o);break;case 1:if(ms(n,o),f&4)if(n=o.stateNode,i===null)try{n.componentDidMount()}catch(E){qt(o,o.return,E)}else{var m=Mi(o.type,i.memoizedProps);i=i.memoizedState;try{n.componentDidUpdate(m,i,n.__reactInternalSnapshotBeforeUpdate)}catch(E){qt(o,o.return,E)}}f&64&&hp(o),f&512&&ec(o,o.return);break;case 3:if(ms(n,o),f&64&&(n=o.updateQueue,n!==null)){if(i=null,o.child!==null)switch(o.child.tag){case 27:case 5:i=o.child.stateNode;break;case 1:i=o.child.stateNode}try{rg(n,i)}catch(E){qt(o,o.return,E)}}break;case 27:i===null&&f&4&&pp(o);case 26:case 5:ms(n,o),i===null&&f&4&&mp(o),f&512&&ec(o,o.return);break;case 12:ms(n,o);break;case 31:ms(n,o),f&4&&wp(n,o);break;case 13:ms(n,o),f&4&&bp(n,o),f&64&&(n=o.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(o=jb.bind(null,o),tS(n,o))));break;case 22:if(f=o.memoizedState!==null||hs,!f){i=i!==null&&i.memoizedState!==null||Dr,m=hs;var p=Dr;hs=f,(Dr=i)&&!p?gs(n,o,(o.subtreeFlags&8772)!==0):ms(n,o),hs=m,Dr=p}break;case 30:break;default:ms(n,o)}}function yp(n){var i=n.alternate;i!==null&&(n.alternate=null,yp(i)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(i=n.stateNode,i!==null&&Fe(i)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var dr=null,Ra=!1;function ds(n,i,o){for(o=o.child;o!==null;)_p(n,i,o),o=o.sibling}function _p(n,i,o){if(Pt&&typeof Pt.onCommitFiberUnmount=="function")try{Pt.onCommitFiberUnmount(Vt,o)}catch{}switch(o.tag){case 26:Dr||Hn(o,i),ds(n,i,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:Dr||Hn(o,i);var f=dr,m=Ra;Ws(o.type)&&(dr=o.stateNode,Ra=!1),ds(n,i,o),cc(o.stateNode),dr=f,Ra=m;break;case 5:Dr||Hn(o,i);case 6:if(f=dr,m=Ra,dr=null,ds(n,i,o),dr=f,Ra=m,dr!==null)if(Ra)try{(dr.nodeType===9?dr.body:dr.nodeName==="HTML"?dr.ownerDocument.body:dr).removeChild(o.stateNode)}catch(p){qt(o,i,p)}else try{dr.removeChild(o.stateNode)}catch(p){qt(o,i,p)}break;case 18:dr!==null&&(Ra?(n=dr,hx(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,o.stateNode),Xl(n)):hx(dr,o.stateNode));break;case 4:f=dr,m=Ra,dr=o.stateNode.containerInfo,Ra=!0,ds(n,i,o),dr=f,Ra=m;break;case 0:case 11:case 14:case 15:zs(2,o,i),Dr||zs(4,o,i),ds(n,i,o);break;case 1:Dr||(Hn(o,i),f=o.stateNode,typeof f.componentWillUnmount=="function"&&dp(o,i,f)),ds(n,i,o);break;case 21:ds(n,i,o);break;case 22:Dr=(f=Dr)||o.memoizedState!==null,ds(n,i,o),Dr=f;break;default:ds(n,i,o)}}function wp(n,i){if(i.memoizedState===null&&(n=i.alternate,n!==null&&(n=n.memoizedState,n!==null))){n=n.dehydrated;try{Xl(n)}catch(o){qt(i,i.return,o)}}}function bp(n,i){if(i.memoizedState===null&&(n=i.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{Xl(n)}catch(o){qt(i,i.return,o)}}function Ab(n){switch(n.tag){case 31:case 13:case 19:var i=n.stateNode;return i===null&&(i=n.stateNode=new xp),i;case 22:return n=n.stateNode,i=n._retryCache,i===null&&(i=n._retryCache=new xp),i;default:throw Error(a(435,n.tag))}}function Xu(n,i){var o=Ab(n);i.forEach(function(f){if(!o.has(f)){o.add(f);var m=Ib.bind(null,n,f);f.then(m,m)}})}function Da(n,i){var o=i.deletions;if(o!==null)for(var f=0;f<o.length;f++){var m=o[f],p=n,E=i,R=E;e:for(;R!==null;){switch(R.tag){case 27:if(Ws(R.type)){dr=R.stateNode,Ra=!1;break e}break;case 5:dr=R.stateNode,Ra=!1;break e;case 3:case 4:dr=R.stateNode.containerInfo,Ra=!0;break e}R=R.return}if(dr===null)throw Error(a(160));_p(p,E,m),dr=null,Ra=!1,p=m.alternate,p!==null&&(p.return=null),m.return=null}if(i.subtreeFlags&13886)for(i=i.child;i!==null;)Sp(i,n),i=i.sibling}var An=null;function Sp(n,i){var o=n.alternate,f=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:Da(i,n),Fa(n),f&4&&(zs(3,n,n.return),Zo(3,n),zs(5,n,n.return));break;case 1:Da(i,n),Fa(n),f&512&&(Dr||o===null||Hn(o,o.return)),f&64&&hs&&(n=n.updateQueue,n!==null&&(f=n.callbacks,f!==null&&(o=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=o===null?f:o.concat(f))));break;case 26:var m=An;if(Da(i,n),Fa(n),f&512&&(Dr||o===null||Hn(o,o.return)),f&4){var p=o!==null?o.memoizedState:null;if(f=n.memoizedState,o===null)if(f===null)if(n.stateNode===null){e:{f=n.type,o=n.memoizedProps,m=m.ownerDocument||m;t:switch(f){case"title":p=m.getElementsByTagName("title")[0],(!p||p[he]||p[M]||p.namespaceURI==="http://www.w3.org/2000/svg"||p.hasAttribute("itemprop"))&&(p=m.createElement(f),m.head.insertBefore(p,m.querySelector("head > title"))),aa(p,f,o),p[M]=n,We(p),f=p;break e;case"link":var E=Sx("link","href",m).get(f+(o.href||""));if(E){for(var R=0;R<E.length;R++)if(p=E[R],p.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&p.getAttribute("rel")===(o.rel==null?null:o.rel)&&p.getAttribute("title")===(o.title==null?null:o.title)&&p.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){E.splice(R,1);break t}}p=m.createElement(f),aa(p,f,o),m.head.appendChild(p);break;case"meta":if(E=Sx("meta","content",m).get(f+(o.content||""))){for(R=0;R<E.length;R++)if(p=E[R],p.getAttribute("content")===(o.content==null?null:""+o.content)&&p.getAttribute("name")===(o.name==null?null:o.name)&&p.getAttribute("property")===(o.property==null?null:o.property)&&p.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&p.getAttribute("charset")===(o.charSet==null?null:o.charSet)){E.splice(R,1);break t}}p=m.createElement(f),aa(p,f,o),m.head.appendChild(p);break;default:throw Error(a(468,f))}p[M]=n,We(p),f=p}n.stateNode=f}else Ex(m,n.type,n.stateNode);else n.stateNode=bx(m,f,n.memoizedProps);else p!==f?(p===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):p.count--,f===null?Ex(m,n.type,n.stateNode):bx(m,f,n.memoizedProps)):f===null&&n.stateNode!==null&&Ch(n,n.memoizedProps,o.memoizedProps)}break;case 27:Da(i,n),Fa(n),f&512&&(Dr||o===null||Hn(o,o.return)),o!==null&&f&4&&Ch(n,n.memoizedProps,o.memoizedProps);break;case 5:if(Da(i,n),Fa(n),f&512&&(Dr||o===null||Hn(o,o.return)),n.flags&32){m=n.stateNode;try{Xe(m,"")}catch(Qe){qt(n,n.return,Qe)}}f&4&&n.stateNode!=null&&(m=n.memoizedProps,Ch(n,m,o!==null?o.memoizedProps:m)),f&1024&&(Rh=!0);break;case 6:if(Da(i,n),Fa(n),f&4){if(n.stateNode===null)throw Error(a(162));f=n.memoizedProps,o=n.stateNode;try{o.nodeValue=f}catch(Qe){qt(n,n.return,Qe)}}break;case 3:if(c0=null,m=An,An=l0(i.containerInfo),Da(i,n),An=m,Fa(n),f&4&&o!==null&&o.memoizedState.isDehydrated)try{Xl(i.containerInfo)}catch(Qe){qt(n,n.return,Qe)}Rh&&(Rh=!1,Ep(n));break;case 4:f=An,An=l0(n.stateNode.containerInfo),Da(i,n),Fa(n),An=f;break;case 12:Da(i,n),Fa(n);break;case 31:Da(i,n),Fa(n),f&4&&(f=n.updateQueue,f!==null&&(n.updateQueue=null,Xu(n,f)));break;case 13:Da(i,n),Fa(n),n.child.flags&8192&&n.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(Ku=It()),f&4&&(f=n.updateQueue,f!==null&&(n.updateQueue=null,Xu(n,f)));break;case 22:m=n.memoizedState!==null;var Y=o!==null&&o.memoizedState!==null,ue=hs,be=Dr;if(hs=ue||m,Dr=be||Y,Da(i,n),Dr=be,hs=ue,Fa(n),f&8192)e:for(i=n.stateNode,i._visibility=m?i._visibility&-2:i._visibility|1,m&&(o===null||Y||hs||Dr||ji(n)),o=null,i=n;;){if(i.tag===5||i.tag===26){if(o===null){Y=o=i;try{if(p=Y.stateNode,m)E=p.style,typeof E.setProperty=="function"?E.setProperty("display","none","important"):E.display="none";else{R=Y.stateNode;var ke=Y.memoizedProps.style,de=ke!=null&&ke.hasOwnProperty("display")?ke.display:null;R.style.display=de==null||typeof de=="boolean"?"":(""+de).trim()}}catch(Qe){qt(Y,Y.return,Qe)}}}else if(i.tag===6){if(o===null){Y=i;try{Y.stateNode.nodeValue=m?"":Y.memoizedProps}catch(Qe){qt(Y,Y.return,Qe)}}}else if(i.tag===18){if(o===null){Y=i;try{var ye=Y.stateNode;m?dx(ye,!0):dx(Y.stateNode,!1)}catch(Qe){qt(Y,Y.return,Qe)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===n)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===n)break e;for(;i.sibling===null;){if(i.return===null||i.return===n)break e;o===i&&(o=null),i=i.return}o===i&&(o=null),i.sibling.return=i.return,i=i.sibling}f&4&&(f=n.updateQueue,f!==null&&(o=f.retryQueue,o!==null&&(f.retryQueue=null,Xu(n,o))));break;case 19:Da(i,n),Fa(n),f&4&&(f=n.updateQueue,f!==null&&(n.updateQueue=null,Xu(n,f)));break;case 30:break;case 21:break;default:Da(i,n),Fa(n)}}function Fa(n){var i=n.flags;if(i&2){try{for(var o,f=n.return;f!==null;){if(gp(f)){o=f;break}f=f.return}if(o==null)throw Error(a(160));switch(o.tag){case 27:var m=o.stateNode,p=Nh(n);qu(n,p,m);break;case 5:var E=o.stateNode;o.flags&32&&(Xe(E,""),o.flags&=-33);var R=Nh(n);qu(n,R,E);break;case 3:case 4:var Y=o.stateNode.containerInfo,ue=Nh(n);Oh(n,ue,Y);break;default:throw Error(a(161))}}catch(be){qt(n,n.return,be)}n.flags&=-3}i&4096&&(n.flags&=-4097)}function Ep(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var i=n;Ep(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),n=n.sibling}}function ms(n,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)vp(n,i.alternate,i),i=i.sibling}function ji(n){for(n=n.child;n!==null;){var i=n;switch(i.tag){case 0:case 11:case 14:case 15:zs(4,i,i.return),ji(i);break;case 1:Hn(i,i.return);var o=i.stateNode;typeof o.componentWillUnmount=="function"&&dp(i,i.return,o),ji(i);break;case 27:cc(i.stateNode);case 26:case 5:Hn(i,i.return),ji(i);break;case 22:i.memoizedState===null&&ji(i);break;case 30:ji(i);break;default:ji(i)}n=n.sibling}}function gs(n,i,o){for(o=o&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var f=i.alternate,m=n,p=i,E=p.flags;switch(p.tag){case 0:case 11:case 15:gs(m,p,o),Zo(4,p);break;case 1:if(gs(m,p,o),f=p,m=f.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch(ue){qt(f,f.return,ue)}if(f=p,m=f.updateQueue,m!==null){var R=f.stateNode;try{var Y=m.shared.hiddenCallbacks;if(Y!==null)for(m.shared.hiddenCallbacks=null,m=0;m<Y.length;m++)tg(Y[m],R)}catch(ue){qt(f,f.return,ue)}}o&&E&64&&hp(p),ec(p,p.return);break;case 27:pp(p);case 26:case 5:gs(m,p,o),o&&f===null&&E&4&&mp(p),ec(p,p.return);break;case 12:gs(m,p,o);break;case 31:gs(m,p,o),o&&E&4&&wp(m,p);break;case 13:gs(m,p,o),o&&E&4&&bp(m,p);break;case 22:p.memoizedState===null&&gs(m,p,o),ec(p,p.return);break;case 30:break;default:gs(m,p,o)}i=i.sibling}}function Dh(n,i){var o=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),n=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(n=i.memoizedState.cachePool.pool),n!==o&&(n!=null&&n.refCount++,o!=null&&Po(o))}function Fh(n,i){n=null,i.alternate!==null&&(n=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==n&&(i.refCount++,n!=null&&Po(n))}function Cn(n,i,o,f){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)Tp(n,i,o,f),i=i.sibling}function Tp(n,i,o,f){var m=i.flags;switch(i.tag){case 0:case 11:case 15:Cn(n,i,o,f),m&2048&&Zo(9,i);break;case 1:Cn(n,i,o,f);break;case 3:Cn(n,i,o,f),m&2048&&(n=null,i.alternate!==null&&(n=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==n&&(i.refCount++,n!=null&&Po(n)));break;case 12:if(m&2048){Cn(n,i,o,f),n=i.stateNode;try{var p=i.memoizedProps,E=p.id,R=p.onPostCommit;typeof R=="function"&&R(E,i.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(Y){qt(i,i.return,Y)}}else Cn(n,i,o,f);break;case 31:Cn(n,i,o,f);break;case 13:Cn(n,i,o,f);break;case 23:break;case 22:p=i.stateNode,E=i.alternate,i.memoizedState!==null?p._visibility&2?Cn(n,i,o,f):tc(n,i):p._visibility&2?Cn(n,i,o,f):(p._visibility|=2,Il(n,i,o,f,(i.subtreeFlags&10256)!==0||!1)),m&2048&&Dh(E,i);break;case 24:Cn(n,i,o,f),m&2048&&Fh(i.alternate,i);break;default:Cn(n,i,o,f)}}function Il(n,i,o,f,m){for(m=m&&((i.subtreeFlags&10256)!==0||!1),i=i.child;i!==null;){var p=n,E=i,R=o,Y=f,ue=E.flags;switch(E.tag){case 0:case 11:case 15:Il(p,E,R,Y,m),Zo(8,E);break;case 23:break;case 22:var be=E.stateNode;E.memoizedState!==null?be._visibility&2?Il(p,E,R,Y,m):tc(p,E):(be._visibility|=2,Il(p,E,R,Y,m)),m&&ue&2048&&Dh(E.alternate,E);break;case 24:Il(p,E,R,Y,m),m&&ue&2048&&Fh(E.alternate,E);break;default:Il(p,E,R,Y,m)}i=i.sibling}}function tc(n,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var o=n,f=i,m=f.flags;switch(f.tag){case 22:tc(o,f),m&2048&&Dh(f.alternate,f);break;case 24:tc(o,f),m&2048&&Fh(f.alternate,f);break;default:tc(o,f)}i=i.sibling}}var rc=8192;function Ll(n,i,o){if(n.subtreeFlags&rc)for(n=n.child;n!==null;)kp(n,i,o),n=n.sibling}function kp(n,i,o){switch(n.tag){case 26:Ll(n,i,o),n.flags&rc&&n.memoizedState!==null&&dS(o,An,n.memoizedState,n.memoizedProps);break;case 5:Ll(n,i,o);break;case 3:case 4:var f=An;An=l0(n.stateNode.containerInfo),Ll(n,i,o),An=f;break;case 22:n.memoizedState===null&&(f=n.alternate,f!==null&&f.memoizedState!==null?(f=rc,rc=16777216,Ll(n,i,o),rc=f):Ll(n,i,o));break;default:Ll(n,i,o)}}function Ap(n){var i=n.alternate;if(i!==null&&(n=i.child,n!==null)){i.child=null;do i=n.sibling,n.sibling=null,n=i;while(n!==null)}}function ac(n){var i=n.deletions;if((n.flags&16)!==0){if(i!==null)for(var o=0;o<i.length;o++){var f=i[o];Xr=f,Np(f,n)}Ap(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)Cp(n),n=n.sibling}function Cp(n){switch(n.tag){case 0:case 11:case 15:ac(n),n.flags&2048&&zs(9,n,n.return);break;case 3:ac(n);break;case 12:ac(n);break;case 22:var i=n.stateNode;n.memoizedState!==null&&i._visibility&2&&(n.return===null||n.return.tag!==13)?(i._visibility&=-3,Wu(n)):ac(n);break;default:ac(n)}}function Wu(n){var i=n.deletions;if((n.flags&16)!==0){if(i!==null)for(var o=0;o<i.length;o++){var f=i[o];Xr=f,Np(f,n)}Ap(n)}for(n=n.child;n!==null;){switch(i=n,i.tag){case 0:case 11:case 15:zs(8,i,i.return),Wu(i);break;case 22:o=i.stateNode,o._visibility&2&&(o._visibility&=-3,Wu(i));break;default:Wu(i)}n=n.sibling}}function Np(n,i){for(;Xr!==null;){var o=Xr;switch(o.tag){case 0:case 11:case 15:zs(8,o,i);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var f=o.memoizedState.cachePool.pool;f!=null&&f.refCount++}break;case 24:Po(o.memoizedState.cache)}if(f=o.child,f!==null)f.return=o,Xr=f;else e:for(o=n;Xr!==null;){f=Xr;var m=f.sibling,p=f.return;if(yp(f),f===o){Xr=null;break e}if(m!==null){m.return=p,Xr=m;break e}Xr=p}}}var Cb={getCacheForType:function(n){var i=ta(Nr),o=i.data.get(n);return o===void 0&&(o=n(),i.data.set(n,o)),o},cacheSignal:function(){return ta(Nr).controller.signal}},Nb=typeof WeakMap=="function"?WeakMap:Map,Ht=0,ar=null,Ct=null,Ot=0,Gt=0,qa=null,Hs=!1,Bl=!1,Mh=!1,ps=0,vr=0,$s=0,Ii=0,jh=0,Xa=0,Ul=0,nc=null,Ma=null,Ih=!1,Ku=0,Op=0,Yu=1/0,Ju=null,Vs=null,Ur=0,Gs=null,Pl=null,xs=0,Lh=0,Bh=null,Rp=null,sc=0,Uh=null;function Wa(){return(Ht&2)!==0&&Ot!==0?Ot&-Ot:K.T!==null?Gh():O()}function Dp(){if(Xa===0)if((Ot&536870912)===0||Dt){var n=Ln;Ln<<=1,(Ln&3932160)===0&&(Ln=262144),Xa=n}else Xa=536870912;return n=Va.current,n!==null&&(n.flags|=32),Xa}function ja(n,i,o){(n===ar&&(Gt===2||Gt===9)||n.cancelPendingCommit!==null)&&(zl(n,0),qs(n,Ot,Xa,!1)),rs(n,o),((Ht&2)===0||n!==ar)&&(n===ar&&((Ht&2)===0&&(Ii|=o),vr===4&&qs(n,Ot,Xa,!1)),$n(n))}function Fp(n,i,o){if((Ht&6)!==0)throw Error(a(327));var f=!o&&(i&127)===0&&(i&n.expiredLanes)===0||ts(n,i),m=f?Db(n,i):zh(n,i,!0),p=f;do{if(m===0){Bl&&!f&&qs(n,i,0,!1);break}else{if(o=n.current.alternate,p&&!Ob(o)){m=zh(n,i,!1),p=!1;continue}if(m===2){if(p=i,n.errorRecoveryDisabledLanes&p)var E=0;else E=n.pendingLanes&-536870913,E=E!==0?E:E&536870912?536870912:0;if(E!==0){i=E;e:{var R=n;m=nc;var Y=R.current.memoizedState.isDehydrated;if(Y&&(zl(R,E).flags|=256),E=zh(R,E,!1),E!==2){if(Mh&&!Y){R.errorRecoveryDisabledLanes|=p,Ii|=p,m=4;break e}p=Ma,Ma=m,p!==null&&(Ma===null?Ma=p:Ma.push.apply(Ma,p))}m=E}if(p=!1,m!==2)continue}}if(m===1){zl(n,0),qs(n,i,0,!0);break}e:{switch(f=n,p=m,p){case 0:case 1:throw Error(a(345));case 4:if((i&4194048)!==i)break;case 6:qs(f,i,Xa,!Hs);break e;case 2:Ma=null;break;case 3:case 5:break;default:throw Error(a(329))}if((i&62914560)===i&&(m=Ku+300-It(),10<m)){if(qs(f,i,Xa,!Hs),es(f,0,!0)!==0)break e;xs=i,f.timeoutHandle=ux(Mp.bind(null,f,o,Ma,Ju,Ih,i,Xa,Ii,Ul,Hs,p,"Throttled",-0,0),m);break e}Mp(f,o,Ma,Ju,Ih,i,Xa,Ii,Ul,Hs,p,null,-0,0)}}break}while(!0);$n(n)}function Mp(n,i,o,f,m,p,E,R,Y,ue,be,ke,de,ye){if(n.timeoutHandle=-1,ke=i.subtreeFlags,ke&8192||(ke&16785408)===16785408){ke={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Ge},kp(i,p,ke);var Qe=(p&62914560)===p?Ku-It():(p&4194048)===p?Op-It():0;if(Qe=mS(ke,Qe),Qe!==null){xs=p,n.cancelPendingCommit=Qe(Hp.bind(null,n,i,p,o,f,m,E,R,Y,be,ke,null,de,ye)),qs(n,p,E,!ue);return}}Hp(n,i,p,o,f,m,E,R,Y)}function Ob(n){for(var i=n;;){var o=i.tag;if((o===0||o===11||o===15)&&i.flags&16384&&(o=i.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var f=0;f<o.length;f++){var m=o[f],p=m.getSnapshot;m=m.value;try{if(!Ha(p(),m))return!1}catch{return!1}}if(o=i.child,i.subtreeFlags&16384&&o!==null)o.return=i,i=o;else{if(i===n)break;for(;i.sibling===null;){if(i.return===null||i.return===n)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function qs(n,i,o,f){i&=~jh,i&=~Ii,n.suspendedLanes|=i,n.pingedLanes&=~i,f&&(n.warmLanes|=i),f=n.expirationTimes;for(var m=i;0<m;){var p=31-qr(m),E=1<<p;f[p]=-1,m&=~E}o!==0&&dl(n,o,i)}function Qu(){return(Ht&6)===0?(ic(0),!1):!0}function Ph(){if(Ct!==null){if(Gt===0)var n=Ct.return;else n=Ct,is=Ai=null,rh(n),Rl=null,Ho=0,n=Ct;for(;n!==null;)fp(n.alternate,n),n=n.return;Ct=null}}function zl(n,i){var o=n.timeoutHandle;o!==-1&&(n.timeoutHandle=-1,Yb(o)),o=n.cancelPendingCommit,o!==null&&(n.cancelPendingCommit=null,o()),xs=0,Ph(),ar=n,Ct=o=ns(n.current,null),Ot=i,Gt=0,qa=null,Hs=!1,Bl=ts(n,i),Mh=!1,Ul=Xa=jh=Ii=$s=vr=0,Ma=nc=null,Ih=!1,(i&8)!==0&&(i|=i&32);var f=n.entangledLanes;if(f!==0)for(n=n.entanglements,f&=i;0<f;){var m=31-qr(f),p=1<<m;i|=n[m],f&=~p}return ps=i,yu(),o}function jp(n,i){yt=null,K.H=Yo,i===Ol||i===Au?(i=J1(),Gt=3):i===Vf?(i=J1(),Gt=4):Gt=i===vh?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,qa=i,Ct===null&&(vr=1,zu(n,ln(i,n.current)))}function Ip(){var n=Va.current;return n===null?!0:(Ot&4194048)===Ot?fn===null:(Ot&62914560)===Ot||(Ot&536870912)!==0?n===fn:!1}function Lp(){var n=K.H;return K.H=Yo,n===null?Yo:n}function Bp(){var n=K.A;return K.A=Cb,n}function Zu(){vr=4,Hs||(Ot&4194048)!==Ot&&Va.current!==null||(Bl=!0),($s&134217727)===0&&(Ii&134217727)===0||ar===null||qs(ar,Ot,Xa,!1)}function zh(n,i,o){var f=Ht;Ht|=2;var m=Lp(),p=Bp();(ar!==n||Ot!==i)&&(Ju=null,zl(n,i)),i=!1;var E=vr;e:do try{if(Gt!==0&&Ct!==null){var R=Ct,Y=qa;switch(Gt){case 8:Ph(),E=6;break e;case 3:case 2:case 9:case 6:Va.current===null&&(i=!0);var ue=Gt;if(Gt=0,qa=null,Hl(n,R,Y,ue),o&&Bl){E=0;break e}break;default:ue=Gt,Gt=0,qa=null,Hl(n,R,Y,ue)}}Rb(),E=vr;break}catch(be){jp(n,be)}while(!0);return i&&n.shellSuspendCounter++,is=Ai=null,Ht=f,K.H=m,K.A=p,Ct===null&&(ar=null,Ot=0,yu()),E}function Rb(){for(;Ct!==null;)Up(Ct)}function Db(n,i){var o=Ht;Ht|=2;var f=Lp(),m=Bp();ar!==n||Ot!==i?(Ju=null,Yu=It()+500,zl(n,i)):Bl=ts(n,i);e:do try{if(Gt!==0&&Ct!==null){i=Ct;var p=qa;t:switch(Gt){case 1:Gt=0,qa=null,Hl(n,i,p,1);break;case 2:case 9:if(K1(p)){Gt=0,qa=null,Pp(i);break}i=function(){Gt!==2&&Gt!==9||ar!==n||(Gt=7),$n(n)},p.then(i,i);break e;case 3:Gt=7;break e;case 4:Gt=5;break e;case 7:K1(p)?(Gt=0,qa=null,Pp(i)):(Gt=0,qa=null,Hl(n,i,p,7));break;case 5:var E=null;switch(Ct.tag){case 26:E=Ct.memoizedState;case 5:case 27:var R=Ct;if(E?Tx(E):R.stateNode.complete){Gt=0,qa=null;var Y=R.sibling;if(Y!==null)Ct=Y;else{var ue=R.return;ue!==null?(Ct=ue,e0(ue)):Ct=null}break t}}Gt=0,qa=null,Hl(n,i,p,5);break;case 6:Gt=0,qa=null,Hl(n,i,p,6);break;case 8:Ph(),vr=6;break e;default:throw Error(a(462))}}Fb();break}catch(be){jp(n,be)}while(!0);return is=Ai=null,K.H=f,K.A=m,Ht=o,Ct!==null?0:(ar=null,Ot=0,yu(),vr)}function Fb(){for(;Ct!==null&&!Sn();)Up(Ct)}function Up(n){var i=cp(n.alternate,n,ps);n.memoizedProps=n.pendingProps,i===null?e0(n):Ct=i}function Pp(n){var i=n,o=i.alternate;switch(i.tag){case 15:case 0:i=ap(o,i,i.pendingProps,i.type,void 0,Ot);break;case 11:i=ap(o,i,i.pendingProps,i.type.render,i.ref,Ot);break;case 5:rh(i);default:fp(o,i),i=Ct=B1(i,ps),i=cp(o,i,ps)}n.memoizedProps=n.pendingProps,i===null?e0(n):Ct=i}function Hl(n,i,o,f){is=Ai=null,rh(i),Rl=null,Ho=0;var m=i.return;try{if(wb(n,m,i,o,Ot)){vr=1,zu(n,ln(o,n.current)),Ct=null;return}}catch(p){if(m!==null)throw Ct=m,p;vr=1,zu(n,ln(o,n.current)),Ct=null;return}i.flags&32768?(Dt||f===1?n=!0:Bl||(Ot&536870912)!==0?n=!1:(Hs=n=!0,(f===2||f===9||f===3||f===6)&&(f=Va.current,f!==null&&f.tag===13&&(f.flags|=16384))),zp(i,n)):e0(i)}function e0(n){var i=n;do{if((i.flags&32768)!==0){zp(i,Hs);return}n=i.return;var o=Eb(i.alternate,i,ps);if(o!==null){Ct=o;return}if(i=i.sibling,i!==null){Ct=i;return}Ct=i=n}while(i!==null);vr===0&&(vr=5)}function zp(n,i){do{var o=Tb(n.alternate,n);if(o!==null){o.flags&=32767,Ct=o;return}if(o=n.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!i&&(n=n.sibling,n!==null)){Ct=n;return}Ct=n=o}while(n!==null);vr=6,Ct=null}function Hp(n,i,o,f,m,p,E,R,Y){n.cancelPendingCommit=null;do t0();while(Ur!==0);if((Ht&6)!==0)throw Error(a(327));if(i!==null){if(i===n.current)throw Error(a(177));if(p=i.lanes|i.childLanes,p|=Nf,Ao(n,o,p,E,R,Y),n===ar&&(Ct=ar=null,Ot=0),Pl=i,Gs=n,xs=o,Lh=p,Bh=m,Rp=f,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,Lb(hr,function(){return Xp(),null})):(n.callbackNode=null,n.callbackPriority=0),f=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||f){f=K.T,K.T=null,m=le.p,le.p=2,E=Ht,Ht|=4;try{kb(n,i,o)}finally{Ht=E,le.p=m,K.T=f}}Ur=1,$p(),Vp(),Gp()}}function $p(){if(Ur===1){Ur=0;var n=Gs,i=Pl,o=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||o){o=K.T,K.T=null;var f=le.p;le.p=2;var m=Ht;Ht|=4;try{Sp(i,n);var p=Zh,E=N1(n.containerInfo),R=p.focusedElem,Y=p.selectionRange;if(E!==R&&R&&R.ownerDocument&&C1(R.ownerDocument.documentElement,R)){if(Y!==null&&Ef(R)){var ue=Y.start,be=Y.end;if(be===void 0&&(be=ue),"selectionStart"in R)R.selectionStart=ue,R.selectionEnd=Math.min(be,R.value.length);else{var ke=R.ownerDocument||document,de=ke&&ke.defaultView||window;if(de.getSelection){var ye=de.getSelection(),Qe=R.textContent.length,ot=Math.min(Y.start,Qe),tr=Y.end===void 0?ot:Math.min(Y.end,Qe);!ye.extend&&ot>tr&&(E=tr,tr=ot,ot=E);var ne=A1(R,ot),ee=A1(R,tr);if(ne&&ee&&(ye.rangeCount!==1||ye.anchorNode!==ne.node||ye.anchorOffset!==ne.offset||ye.focusNode!==ee.node||ye.focusOffset!==ee.offset)){var oe=ke.createRange();oe.setStart(ne.node,ne.offset),ye.removeAllRanges(),ot>tr?(ye.addRange(oe),ye.extend(ee.node,ee.offset)):(oe.setEnd(ee.node,ee.offset),ye.addRange(oe))}}}}for(ke=[],ye=R;ye=ye.parentNode;)ye.nodeType===1&&ke.push({element:ye,left:ye.scrollLeft,top:ye.scrollTop});for(typeof R.focus=="function"&&R.focus(),R=0;R<ke.length;R++){var Se=ke[R];Se.element.scrollLeft=Se.left,Se.element.scrollTop=Se.top}}d0=!!Qh,Zh=Qh=null}finally{Ht=m,le.p=f,K.T=o}}n.current=i,Ur=2}}function Vp(){if(Ur===2){Ur=0;var n=Gs,i=Pl,o=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||o){o=K.T,K.T=null;var f=le.p;le.p=2;var m=Ht;Ht|=4;try{vp(n,i.alternate,i)}finally{Ht=m,le.p=f,K.T=o}}Ur=3}}function Gp(){if(Ur===4||Ur===3){Ur=0,ka();var n=Gs,i=Pl,o=xs,f=Rp;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?Ur=5:(Ur=0,Pl=Gs=null,qp(n,n.pendingLanes));var m=n.pendingLanes;if(m===0&&(Vs=null),xi(o),i=i.stateNode,Pt&&typeof Pt.onCommitFiberRoot=="function")try{Pt.onCommitFiberRoot(Vt,i,void 0,(i.current.flags&128)===128)}catch{}if(f!==null){i=K.T,m=le.p,le.p=2,K.T=null;try{for(var p=n.onRecoverableError,E=0;E<f.length;E++){var R=f[E];p(R.value,{componentStack:R.stack})}}finally{K.T=i,le.p=m}}(xs&3)!==0&&t0(),$n(n),m=n.pendingLanes,(o&261930)!==0&&(m&42)!==0?n===Uh?sc++:(sc=0,Uh=n):sc=0,ic(0)}}function qp(n,i){(n.pooledCacheLanes&=i)===0&&(i=n.pooledCache,i!=null&&(n.pooledCache=null,Po(i)))}function t0(){return $p(),Vp(),Gp(),Xp()}function Xp(){if(Ur!==5)return!1;var n=Gs,i=Lh;Lh=0;var o=xi(xs),f=K.T,m=le.p;try{le.p=32>o?32:o,K.T=null,o=Bh,Bh=null;var p=Gs,E=xs;if(Ur=0,Pl=Gs=null,xs=0,(Ht&6)!==0)throw Error(a(331));var R=Ht;if(Ht|=4,Cp(p.current),Tp(p,p.current,E,o),Ht=R,ic(0,!1),Pt&&typeof Pt.onPostCommitFiberRoot=="function")try{Pt.onPostCommitFiberRoot(Vt,p)}catch{}return!0}finally{le.p=m,K.T=f,qp(n,i)}}function Wp(n,i,o){i=ln(o,i),i=xh(n.stateNode,i,2),n=Bs(n,i,2),n!==null&&(rs(n,2),$n(n))}function qt(n,i,o){if(n.tag===3)Wp(n,n,o);else for(;i!==null;){if(i.tag===3){Wp(i,n,o);break}else if(i.tag===1){var f=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(Vs===null||!Vs.has(f))){n=ln(o,n),o=Kg(2),f=Bs(i,o,2),f!==null&&(Yg(o,f,i,n),rs(f,2),$n(f));break}}i=i.return}}function Hh(n,i,o){var f=n.pingCache;if(f===null){f=n.pingCache=new Nb;var m=new Set;f.set(i,m)}else m=f.get(i),m===void 0&&(m=new Set,f.set(i,m));m.has(o)||(Mh=!0,m.add(o),n=Mb.bind(null,n,i,o),i.then(n,n))}function Mb(n,i,o){var f=n.pingCache;f!==null&&f.delete(i),n.pingedLanes|=n.suspendedLanes&o,n.warmLanes&=~o,ar===n&&(Ot&o)===o&&(vr===4||vr===3&&(Ot&62914560)===Ot&&300>It()-Ku?(Ht&2)===0&&zl(n,0):jh|=o,Ul===Ot&&(Ul=0)),$n(n)}function Kp(n,i){i===0&&(i=hl()),n=Ei(n,i),n!==null&&(rs(n,i),$n(n))}function jb(n){var i=n.memoizedState,o=0;i!==null&&(o=i.retryLane),Kp(n,o)}function Ib(n,i){var o=0;switch(n.tag){case 31:case 13:var f=n.stateNode,m=n.memoizedState;m!==null&&(o=m.retryLane);break;case 19:f=n.stateNode;break;case 22:f=n.stateNode._retryCache;break;default:throw Error(a(314))}f!==null&&f.delete(i),Kp(n,o)}function Lb(n,i){return $r(n,i)}var r0=null,$l=null,$h=!1,a0=!1,Vh=!1,Xs=0;function $n(n){n!==$l&&n.next===null&&($l===null?r0=$l=n:$l=$l.next=n),a0=!0,$h||($h=!0,Ub())}function ic(n,i){if(!Vh&&a0){Vh=!0;do for(var o=!1,f=r0;f!==null;){if(n!==0){var m=f.pendingLanes;if(m===0)var p=0;else{var E=f.suspendedLanes,R=f.pingedLanes;p=(1<<31-qr(42|n)+1)-1,p&=m&~(E&~R),p=p&201326741?p&201326741|1:p?p|2:0}p!==0&&(o=!0,Zp(f,p))}else p=Ot,p=es(f,f===ar?p:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),(p&3)===0||ts(f,p)||(o=!0,Zp(f,p));f=f.next}while(o);Vh=!1}}function Bb(){Yp()}function Yp(){a0=$h=!1;var n=0;Xs!==0&&Kb()&&(n=Xs);for(var i=It(),o=null,f=r0;f!==null;){var m=f.next,p=Jp(f,i);p===0?(f.next=null,o===null?r0=m:o.next=m,m===null&&($l=o)):(o=f,(n!==0||(p&3)!==0)&&(a0=!0)),f=m}Ur!==0&&Ur!==5||ic(n),Xs!==0&&(Xs=0)}function Jp(n,i){for(var o=n.suspendedLanes,f=n.pingedLanes,m=n.expirationTimes,p=n.pendingLanes&-62914561;0<p;){var E=31-qr(p),R=1<<E,Y=m[E];Y===-1?((R&o)===0||(R&f)!==0)&&(m[E]=ko(R,i)):Y<=i&&(n.expiredLanes|=R),p&=~R}if(i=ar,o=Ot,o=es(n,n===i?o:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),f=n.callbackNode,o===0||n===i&&(Gt===2||Gt===9)||n.cancelPendingCommit!==null)return f!==null&&f!==null&&wa(f),n.callbackNode=null,n.callbackPriority=0;if((o&3)===0||ts(n,o)){if(i=o&-o,i===n.callbackPriority)return i;switch(f!==null&&wa(f),xi(o)){case 2:case 8:o=Vr;break;case 32:o=hr;break;case 268435456:o=pt;break;default:o=hr}return f=Qp.bind(null,n),o=$r(o,f),n.callbackPriority=i,n.callbackNode=o,i}return f!==null&&f!==null&&wa(f),n.callbackPriority=2,n.callbackNode=null,2}function Qp(n,i){if(Ur!==0&&Ur!==5)return n.callbackNode=null,n.callbackPriority=0,null;var o=n.callbackNode;if(t0()&&n.callbackNode!==o)return null;var f=Ot;return f=es(n,n===ar?f:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),f===0?null:(Fp(n,f,i),Jp(n,It()),n.callbackNode!=null&&n.callbackNode===o?Qp.bind(null,n):null)}function Zp(n,i){if(t0())return null;Fp(n,i,!0)}function Ub(){Jb(function(){(Ht&6)!==0?$r(za,Bb):Yp()})}function Gh(){if(Xs===0){var n=Cl;n===0&&(n=ua,ua<<=1,(ua&261888)===0&&(ua=256)),Xs=n}return Xs}function ex(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:dt(""+n)}function tx(n,i){var o=i.ownerDocument.createElement("input");return o.name=i.name,o.value=i.value,n.id&&o.setAttribute("form",n.id),i.parentNode.insertBefore(o,i),n=new FormData(n),o.parentNode.removeChild(o),n}function Pb(n,i,o,f,m){if(i==="submit"&&o&&o.stateNode===m){var p=ex((m[B]||null).action),E=f.submitter;E&&(i=(i=E[B]||null)?ex(i.formAction):E.getAttribute("formAction"),i!==null&&(p=i,E=null));var R=new gu("action","action",null,f,m);n.push({event:R,listeners:[{instance:null,listener:function(){if(f.defaultPrevented){if(Xs!==0){var Y=E?tx(m,E):new FormData(m);fh(o,{pending:!0,data:Y,method:m.method,action:p},null,Y)}}else typeof p=="function"&&(R.preventDefault(),Y=E?tx(m,E):new FormData(m),fh(o,{pending:!0,data:Y,method:m.method,action:p},p,Y))},currentTarget:m}]})}}for(var qh=0;qh<Cf.length;qh++){var Xh=Cf[qh],zb=Xh.toLowerCase(),Hb=Xh[0].toUpperCase()+Xh.slice(1);kn(zb,"on"+Hb)}kn(D1,"onAnimationEnd"),kn(F1,"onAnimationIteration"),kn(M1,"onAnimationStart"),kn("dblclick","onDoubleClick"),kn("focusin","onFocus"),kn("focusout","onBlur"),kn(nb,"onTransitionRun"),kn(sb,"onTransitionStart"),kn(ib,"onTransitionCancel"),kn(j1,"onTransitionEnd"),Ca("onMouseEnter",["mouseout","mouseover"]),Ca("onMouseLeave",["mouseout","mouseover"]),Ca("onPointerEnter",["pointerout","pointerover"]),Ca("onPointerLeave",["pointerout","pointerover"]),Qt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Qt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Qt("onBeforeInput",["compositionend","keypress","textInput","paste"]),Qt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Qt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Qt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),$b=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(lc));function rx(n,i){i=(i&4)!==0;for(var o=0;o<n.length;o++){var f=n[o],m=f.event;f=f.listeners;e:{var p=void 0;if(i)for(var E=f.length-1;0<=E;E--){var R=f[E],Y=R.instance,ue=R.currentTarget;if(R=R.listener,Y!==p&&m.isPropagationStopped())break e;p=R,m.currentTarget=ue;try{p(m)}catch(be){vu(be)}m.currentTarget=null,p=Y}else for(E=0;E<f.length;E++){if(R=f[E],Y=R.instance,ue=R.currentTarget,R=R.listener,Y!==p&&m.isPropagationStopped())break e;p=R,m.currentTarget=ue;try{p(m)}catch(be){vu(be)}m.currentTarget=null,p=Y}}}}function Nt(n,i){var o=i[fe];o===void 0&&(o=i[fe]=new Set);var f=n+"__bubble";o.has(f)||(ax(i,n,2,!1),o.add(f))}function Wh(n,i,o){var f=0;i&&(f|=4),ax(o,n,f,i)}var n0="_reactListening"+Math.random().toString(36).slice(2);function Kh(n){if(!n[n0]){n[n0]=!0,Yt.forEach(function(o){o!=="selectionchange"&&($b.has(o)||Wh(o,!1,n),Wh(o,!0,n))});var i=n.nodeType===9?n:n.ownerDocument;i===null||i[n0]||(i[n0]=!0,Wh("selectionchange",!1,i))}}function ax(n,i,o,f){switch(Dx(i)){case 2:var m=xS;break;case 8:m=vS;break;default:m=ud}o=m.bind(null,i,o,n),m=void 0,!Oo||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(m=!0),f?m!==void 0?n.addEventListener(i,o,{capture:!0,passive:m}):n.addEventListener(i,o,!0):m!==void 0?n.addEventListener(i,o,{passive:m}):n.addEventListener(i,o,!1)}function Yh(n,i,o,f,m){var p=f;if((i&1)===0&&(i&2)===0&&f!==null)e:for(;;){if(f===null)return;var E=f.tag;if(E===3||E===4){var R=f.stateNode.containerInfo;if(R===m)break;if(E===4)for(E=f.return;E!==null;){var Y=E.tag;if((Y===3||Y===4)&&E.stateNode.containerInfo===m)return;E=E.return}for(;R!==null;){if(E=Le(R),E===null)return;if(Y=E.tag,Y===5||Y===6||Y===26||Y===27){f=p=E;continue e}R=R.parentNode}}f=f.return}No(function(){var ue=p,be=zt(o),ke=[];e:{var de=I1.get(n);if(de!==void 0){var ye=gu,Qe=n;switch(n){case"keypress":if(du(o)===0)break e;case"keydown":case"keyup":ye=Iw;break;case"focusin":Qe="focus",ye=yf;break;case"focusout":Qe="blur",ye=yf;break;case"beforeblur":case"afterblur":ye=yf;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ye=f1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ye=Ew;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ye=Uw;break;case D1:case F1:case M1:ye=Aw;break;case j1:ye=zw;break;case"scroll":case"scrollend":ye=bw;break;case"wheel":ye=$w;break;case"copy":case"cut":case"paste":ye=Nw;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ye=d1;break;case"toggle":case"beforetoggle":ye=Gw}var ot=(i&4)!==0,tr=!ot&&(n==="scroll"||n==="scrollend"),ne=ot?de!==null?de+"Capture":null:de;ot=[];for(var ee=ue,oe;ee!==null;){var Se=ee;if(oe=Se.stateNode,Se=Se.tag,Se!==5&&Se!==26&&Se!==27||oe===null||ne===null||(Se=yi(ee,ne),Se!=null&&ot.push(oc(ee,Se,oe))),tr)break;ee=ee.return}0<ot.length&&(de=new ye(de,Qe,null,o,be),ke.push({event:de,listeners:ot}))}}if((i&7)===0){e:{if(de=n==="mouseover"||n==="pointerover",ye=n==="mouseout"||n==="pointerout",de&&o!==Et&&(Qe=o.relatedTarget||o.fromElement)&&(Le(Qe)||Qe[V]))break e;if((ye||de)&&(de=be.window===be?be:(de=be.ownerDocument)?de.defaultView||de.parentWindow:window,ye?(Qe=o.relatedTarget||o.toElement,ye=ue,Qe=Qe?Le(Qe):null,Qe!==null&&(tr=l(Qe),ot=Qe.tag,Qe!==tr||ot!==5&&ot!==27&&ot!==6)&&(Qe=null)):(ye=null,Qe=ue),ye!==Qe)){if(ot=f1,Se="onMouseLeave",ne="onMouseEnter",ee="mouse",(n==="pointerout"||n==="pointerover")&&(ot=d1,Se="onPointerLeave",ne="onPointerEnter",ee="pointer"),tr=ye==null?de:De(ye),oe=Qe==null?de:De(Qe),de=new ot(Se,ee+"leave",ye,o,be),de.target=tr,de.relatedTarget=oe,Se=null,Le(be)===ue&&(ot=new ot(ne,ee+"enter",Qe,o,be),ot.target=oe,ot.relatedTarget=tr,Se=ot),tr=Se,ye&&Qe)t:{for(ot=Vb,ne=ye,ee=Qe,oe=0,Se=ne;Se;Se=ot(Se))oe++;Se=0;for(var it=ee;it;it=ot(it))Se++;for(;0<oe-Se;)ne=ot(ne),oe--;for(;0<Se-oe;)ee=ot(ee),Se--;for(;oe--;){if(ne===ee||ee!==null&&ne===ee.alternate){ot=ne;break t}ne=ot(ne),ee=ot(ee)}ot=null}else ot=null;ye!==null&&nx(ke,de,ye,ot,!1),Qe!==null&&tr!==null&&nx(ke,tr,Qe,ot,!0)}}e:{if(de=ue?De(ue):window,ye=de.nodeName&&de.nodeName.toLowerCase(),ye==="select"||ye==="input"&&de.type==="file")var Lt=w1;else if(y1(de))if(b1)Lt=tb;else{Lt=Zw;var tt=Qw}else ye=de.nodeName,!ye||ye.toLowerCase()!=="input"||de.type!=="checkbox"&&de.type!=="radio"?ue&&ze(ue.elementType)&&(Lt=w1):Lt=eb;if(Lt&&(Lt=Lt(n,ue))){_1(ke,Lt,o,be);break e}tt&&tt(n,de,ue),n==="focusout"&&ue&&de.type==="number"&&ue.memoizedProps.value!=null&&Ve(de,"number",de.value)}switch(tt=ue?De(ue):window,n){case"focusin":(y1(tt)||tt.contentEditable==="true")&&(_l=tt,Tf=ue,Lo=null);break;case"focusout":Lo=Tf=_l=null;break;case"mousedown":kf=!0;break;case"contextmenu":case"mouseup":case"dragend":kf=!1,O1(ke,o,be);break;case"selectionchange":if(ab)break;case"keydown":case"keyup":O1(ke,o,be)}var wt;if(wf)e:{switch(n){case"compositionstart":var Rt="onCompositionStart";break e;case"compositionend":Rt="onCompositionEnd";break e;case"compositionupdate":Rt="onCompositionUpdate";break e}Rt=void 0}else yl?x1(n,o)&&(Rt="onCompositionEnd"):n==="keydown"&&o.keyCode===229&&(Rt="onCompositionStart");Rt&&(m1&&o.locale!=="ko"&&(yl||Rt!=="onCompositionStart"?Rt==="onCompositionEnd"&&yl&&(wt=hu()):(Un=be,vl="value"in Un?Un.value:Un.textContent,yl=!0)),tt=s0(ue,Rt),0<tt.length&&(Rt=new h1(Rt,n,null,o,be),ke.push({event:Rt,listeners:tt}),wt?Rt.data=wt:(wt=v1(o),wt!==null&&(Rt.data=wt)))),(wt=Xw?Ww(n,o):Kw(n,o))&&(Rt=s0(ue,"onBeforeInput"),0<Rt.length&&(tt=new h1("onBeforeInput","beforeinput",null,o,be),ke.push({event:tt,listeners:Rt}),tt.data=wt)),Pb(ke,n,ue,o,be)}rx(ke,i)})}function oc(n,i,o){return{instance:n,listener:i,currentTarget:o}}function s0(n,i){for(var o=i+"Capture",f=[];n!==null;){var m=n,p=m.stateNode;if(m=m.tag,m!==5&&m!==26&&m!==27||p===null||(m=yi(n,o),m!=null&&f.unshift(oc(n,m,p)),m=yi(n,i),m!=null&&f.push(oc(n,m,p))),n.tag===3)return f;n=n.return}return[]}function Vb(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function nx(n,i,o,f,m){for(var p=i._reactName,E=[];o!==null&&o!==f;){var R=o,Y=R.alternate,ue=R.stateNode;if(R=R.tag,Y!==null&&Y===f)break;R!==5&&R!==26&&R!==27||ue===null||(Y=ue,m?(ue=yi(o,p),ue!=null&&E.unshift(oc(o,ue,Y))):m||(ue=yi(o,p),ue!=null&&E.push(oc(o,ue,Y)))),o=o.return}E.length!==0&&n.push({event:i,listeners:E})}var Gb=/\r\n?/g,qb=/\u0000|\uFFFD/g;function sx(n){return(typeof n=="string"?n:""+n).replace(Gb,`
`).replace(qb,"")}function ix(n,i){return i=sx(i),sx(n)===i}function er(n,i,o,f,m,p){switch(o){case"children":typeof f=="string"?i==="body"||i==="textarea"&&f===""||Xe(n,f):(typeof f=="number"||typeof f=="bigint")&&i!=="body"&&Xe(n,""+f);break;case"className":gl(n,"class",f);break;case"tabIndex":gl(n,"tabindex",f);break;case"dir":case"role":case"viewBox":case"width":case"height":gl(n,o,f);break;case"style":Be(n,f,p);break;case"data":if(i!=="object"){gl(n,"data",f);break}case"src":case"href":if(f===""&&(i!=="a"||o!=="href")){n.removeAttribute(o);break}if(f==null||typeof f=="function"||typeof f=="symbol"||typeof f=="boolean"){n.removeAttribute(o);break}f=dt(""+f),n.setAttribute(o,f);break;case"action":case"formAction":if(typeof f=="function"){n.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof p=="function"&&(o==="formAction"?(i!=="input"&&er(n,i,"name",m.name,m,null),er(n,i,"formEncType",m.formEncType,m,null),er(n,i,"formMethod",m.formMethod,m,null),er(n,i,"formTarget",m.formTarget,m,null)):(er(n,i,"encType",m.encType,m,null),er(n,i,"method",m.method,m,null),er(n,i,"target",m.target,m,null)));if(f==null||typeof f=="symbol"||typeof f=="boolean"){n.removeAttribute(o);break}f=dt(""+f),n.setAttribute(o,f);break;case"onClick":f!=null&&(n.onclick=Ge);break;case"onScroll":f!=null&&Nt("scroll",n);break;case"onScrollEnd":f!=null&&Nt("scrollend",n);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(a(61));if(o=f.__html,o!=null){if(m.children!=null)throw Error(a(60));n.innerHTML=o}}break;case"multiple":n.multiple=f&&typeof f!="function"&&typeof f!="symbol";break;case"muted":n.muted=f&&typeof f!="function"&&typeof f!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(f==null||typeof f=="function"||typeof f=="boolean"||typeof f=="symbol"){n.removeAttribute("xlink:href");break}o=dt(""+f),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":f!=null&&typeof f!="function"&&typeof f!="symbol"?n.setAttribute(o,""+f):n.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":f&&typeof f!="function"&&typeof f!="symbol"?n.setAttribute(o,""):n.removeAttribute(o);break;case"capture":case"download":f===!0?n.setAttribute(o,""):f!==!1&&f!=null&&typeof f!="function"&&typeof f!="symbol"?n.setAttribute(o,f):n.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":f!=null&&typeof f!="function"&&typeof f!="symbol"&&!isNaN(f)&&1<=f?n.setAttribute(o,f):n.removeAttribute(o);break;case"rowSpan":case"start":f==null||typeof f=="function"||typeof f=="symbol"||isNaN(f)?n.removeAttribute(o):n.setAttribute(o,f);break;case"popover":Nt("beforetoggle",n),Nt("toggle",n),fa(n,"popover",f);break;case"xlinkActuate":En(n,"http://www.w3.org/1999/xlink","xlink:actuate",f);break;case"xlinkArcrole":En(n,"http://www.w3.org/1999/xlink","xlink:arcrole",f);break;case"xlinkRole":En(n,"http://www.w3.org/1999/xlink","xlink:role",f);break;case"xlinkShow":En(n,"http://www.w3.org/1999/xlink","xlink:show",f);break;case"xlinkTitle":En(n,"http://www.w3.org/1999/xlink","xlink:title",f);break;case"xlinkType":En(n,"http://www.w3.org/1999/xlink","xlink:type",f);break;case"xmlBase":En(n,"http://www.w3.org/XML/1998/namespace","xml:base",f);break;case"xmlLang":En(n,"http://www.w3.org/XML/1998/namespace","xml:lang",f);break;case"xmlSpace":En(n,"http://www.w3.org/XML/1998/namespace","xml:space",f);break;case"is":fa(n,"is",f);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=Ze.get(o)||o,fa(n,o,f))}}function Jh(n,i,o,f,m,p){switch(o){case"style":Be(n,f,p);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(a(61));if(o=f.__html,o!=null){if(m.children!=null)throw Error(a(60));n.innerHTML=o}}break;case"children":typeof f=="string"?Xe(n,f):(typeof f=="number"||typeof f=="bigint")&&Xe(n,""+f);break;case"onScroll":f!=null&&Nt("scroll",n);break;case"onScrollEnd":f!=null&&Nt("scrollend",n);break;case"onClick":f!=null&&(n.onclick=Ge);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Jt.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(m=o.endsWith("Capture"),i=o.slice(2,m?o.length-7:void 0),p=n[B]||null,p=p!=null?p[o]:null,typeof p=="function"&&n.removeEventListener(i,p,m),typeof f=="function")){typeof p!="function"&&p!==null&&(o in n?n[o]=null:n.hasAttribute(o)&&n.removeAttribute(o)),n.addEventListener(i,f,m);break e}o in n?n[o]=f:f===!0?n.setAttribute(o,""):fa(n,o,f)}}}function aa(n,i,o){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Nt("error",n),Nt("load",n);var f=!1,m=!1,p;for(p in o)if(o.hasOwnProperty(p)){var E=o[p];if(E!=null)switch(p){case"src":f=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,i));default:er(n,i,p,E,o,null)}}m&&er(n,i,"srcSet",o.srcSet,o,null),f&&er(n,i,"src",o.src,o,null);return;case"input":Nt("invalid",n);var R=p=E=m=null,Y=null,ue=null;for(f in o)if(o.hasOwnProperty(f)){var be=o[f];if(be!=null)switch(f){case"name":m=be;break;case"type":E=be;break;case"checked":Y=be;break;case"defaultChecked":ue=be;break;case"value":p=be;break;case"defaultValue":R=be;break;case"children":case"dangerouslySetInnerHTML":if(be!=null)throw Error(a(137,i));break;default:er(n,i,f,be,o,null)}}Ie(n,p,R,Y,ue,E,m,!1);return;case"select":Nt("invalid",n),f=E=p=null;for(m in o)if(o.hasOwnProperty(m)&&(R=o[m],R!=null))switch(m){case"value":p=R;break;case"defaultValue":E=R;break;case"multiple":f=R;default:er(n,i,m,R,o,null)}i=p,o=E,n.multiple=!!f,i!=null?Je(n,!!f,i,!1):o!=null&&Je(n,!!f,o,!0);return;case"textarea":Nt("invalid",n),p=m=f=null;for(E in o)if(o.hasOwnProperty(E)&&(R=o[E],R!=null))switch(E){case"value":f=R;break;case"defaultValue":m=R;break;case"children":p=R;break;case"dangerouslySetInnerHTML":if(R!=null)throw Error(a(91));break;default:er(n,i,E,R,o,null)}rt(n,f,m,p);return;case"option":for(Y in o)o.hasOwnProperty(Y)&&(f=o[Y],f!=null)&&(Y==="selected"?n.selected=f&&typeof f!="function"&&typeof f!="symbol":er(n,i,Y,f,o,null));return;case"dialog":Nt("beforetoggle",n),Nt("toggle",n),Nt("cancel",n),Nt("close",n);break;case"iframe":case"object":Nt("load",n);break;case"video":case"audio":for(f=0;f<lc.length;f++)Nt(lc[f],n);break;case"image":Nt("error",n),Nt("load",n);break;case"details":Nt("toggle",n);break;case"embed":case"source":case"link":Nt("error",n),Nt("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ue in o)if(o.hasOwnProperty(ue)&&(f=o[ue],f!=null))switch(ue){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,i));default:er(n,i,ue,f,o,null)}return;default:if(ze(i)){for(be in o)o.hasOwnProperty(be)&&(f=o[be],f!==void 0&&Jh(n,i,be,f,o,void 0));return}}for(R in o)o.hasOwnProperty(R)&&(f=o[R],f!=null&&er(n,i,R,f,o,null))}function Xb(n,i,o,f){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,p=null,E=null,R=null,Y=null,ue=null,be=null;for(ye in o){var ke=o[ye];if(o.hasOwnProperty(ye)&&ke!=null)switch(ye){case"checked":break;case"value":break;case"defaultValue":Y=ke;default:f.hasOwnProperty(ye)||er(n,i,ye,null,f,ke)}}for(var de in f){var ye=f[de];if(ke=o[de],f.hasOwnProperty(de)&&(ye!=null||ke!=null))switch(de){case"type":p=ye;break;case"name":m=ye;break;case"checked":ue=ye;break;case"defaultChecked":be=ye;break;case"value":E=ye;break;case"defaultValue":R=ye;break;case"children":case"dangerouslySetInnerHTML":if(ye!=null)throw Error(a(137,i));break;default:ye!==ke&&er(n,i,de,ye,f,ke)}}Me(n,E,R,Y,ue,be,p,m);return;case"select":ye=E=R=de=null;for(p in o)if(Y=o[p],o.hasOwnProperty(p)&&Y!=null)switch(p){case"value":break;case"multiple":ye=Y;default:f.hasOwnProperty(p)||er(n,i,p,null,f,Y)}for(m in f)if(p=f[m],Y=o[m],f.hasOwnProperty(m)&&(p!=null||Y!=null))switch(m){case"value":de=p;break;case"defaultValue":R=p;break;case"multiple":E=p;default:p!==Y&&er(n,i,m,p,f,Y)}i=R,o=E,f=ye,de!=null?Je(n,!!o,de,!1):!!f!=!!o&&(i!=null?Je(n,!!o,i,!0):Je(n,!!o,o?[]:"",!1));return;case"textarea":ye=de=null;for(R in o)if(m=o[R],o.hasOwnProperty(R)&&m!=null&&!f.hasOwnProperty(R))switch(R){case"value":break;case"children":break;default:er(n,i,R,null,f,m)}for(E in f)if(m=f[E],p=o[E],f.hasOwnProperty(E)&&(m!=null||p!=null))switch(E){case"value":de=m;break;case"defaultValue":ye=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(a(91));break;default:m!==p&&er(n,i,E,m,f,p)}st(n,de,ye);return;case"option":for(var Qe in o)de=o[Qe],o.hasOwnProperty(Qe)&&de!=null&&!f.hasOwnProperty(Qe)&&(Qe==="selected"?n.selected=!1:er(n,i,Qe,null,f,de));for(Y in f)de=f[Y],ye=o[Y],f.hasOwnProperty(Y)&&de!==ye&&(de!=null||ye!=null)&&(Y==="selected"?n.selected=de&&typeof de!="function"&&typeof de!="symbol":er(n,i,Y,de,f,ye));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ot in o)de=o[ot],o.hasOwnProperty(ot)&&de!=null&&!f.hasOwnProperty(ot)&&er(n,i,ot,null,f,de);for(ue in f)if(de=f[ue],ye=o[ue],f.hasOwnProperty(ue)&&de!==ye&&(de!=null||ye!=null))switch(ue){case"children":case"dangerouslySetInnerHTML":if(de!=null)throw Error(a(137,i));break;default:er(n,i,ue,de,f,ye)}return;default:if(ze(i)){for(var tr in o)de=o[tr],o.hasOwnProperty(tr)&&de!==void 0&&!f.hasOwnProperty(tr)&&Jh(n,i,tr,void 0,f,de);for(be in f)de=f[be],ye=o[be],!f.hasOwnProperty(be)||de===ye||de===void 0&&ye===void 0||Jh(n,i,be,de,f,ye);return}}for(var ne in o)de=o[ne],o.hasOwnProperty(ne)&&de!=null&&!f.hasOwnProperty(ne)&&er(n,i,ne,null,f,de);for(ke in f)de=f[ke],ye=o[ke],!f.hasOwnProperty(ke)||de===ye||de==null&&ye==null||er(n,i,ke,de,f,ye)}function lx(n){switch(n){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Wb(){if(typeof performance.getEntriesByType=="function"){for(var n=0,i=0,o=performance.getEntriesByType("resource"),f=0;f<o.length;f++){var m=o[f],p=m.transferSize,E=m.initiatorType,R=m.duration;if(p&&R&&lx(E)){for(E=0,R=m.responseEnd,f+=1;f<o.length;f++){var Y=o[f],ue=Y.startTime;if(ue>R)break;var be=Y.transferSize,ke=Y.initiatorType;be&&lx(ke)&&(Y=Y.responseEnd,E+=be*(Y<R?1:(R-ue)/(Y-ue)))}if(--f,i+=8*(p+E)/(m.duration/1e3),n++,10<n)break}}if(0<n)return i/n/1e6}return navigator.connection&&(n=navigator.connection.downlink,typeof n=="number")?n:5}var Qh=null,Zh=null;function i0(n){return n.nodeType===9?n:n.ownerDocument}function ox(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function cx(n,i){if(n===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&i==="foreignObject"?0:n}function ed(n,i){return n==="textarea"||n==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var td=null;function Kb(){var n=window.event;return n&&n.type==="popstate"?n===td?!1:(td=n,!0):(td=null,!1)}var ux=typeof setTimeout=="function"?setTimeout:void 0,Yb=typeof clearTimeout=="function"?clearTimeout:void 0,fx=typeof Promise=="function"?Promise:void 0,Jb=typeof queueMicrotask=="function"?queueMicrotask:typeof fx<"u"?function(n){return fx.resolve(null).then(n).catch(Qb)}:ux;function Qb(n){setTimeout(function(){throw n})}function Ws(n){return n==="head"}function hx(n,i){var o=i,f=0;do{var m=o.nextSibling;if(n.removeChild(o),m&&m.nodeType===8)if(o=m.data,o==="/$"||o==="/&"){if(f===0){n.removeChild(m),Xl(i);return}f--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")f++;else if(o==="html")cc(n.ownerDocument.documentElement);else if(o==="head"){o=n.ownerDocument.head,cc(o);for(var p=o.firstChild;p;){var E=p.nextSibling,R=p.nodeName;p[he]||R==="SCRIPT"||R==="STYLE"||R==="LINK"&&p.rel.toLowerCase()==="stylesheet"||o.removeChild(p),p=E}}else o==="body"&&cc(n.ownerDocument.body);o=m}while(o);Xl(i)}function dx(n,i){var o=n;n=0;do{var f=o.nextSibling;if(o.nodeType===1?i?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(i?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),f&&f.nodeType===8)if(o=f.data,o==="/$"){if(n===0)break;n--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||n++;o=f}while(o)}function rd(n){var i=n.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var o=i;switch(i=i.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":rd(o),Fe(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}n.removeChild(o)}}function Zb(n,i,o,f){for(;n.nodeType===1;){var m=o;if(n.nodeName.toLowerCase()!==i.toLowerCase()){if(!f&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(f){if(!n[he])switch(i){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(p=n.getAttribute("rel"),p==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(p!==m.rel||n.getAttribute("href")!==(m.href==null||m.href===""?null:m.href)||n.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||n.getAttribute("title")!==(m.title==null?null:m.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(p=n.getAttribute("src"),(p!==(m.src==null?null:m.src)||n.getAttribute("type")!==(m.type==null?null:m.type)||n.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&p&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(i==="input"&&n.type==="hidden"){var p=m.name==null?null:""+m.name;if(m.type==="hidden"&&n.getAttribute("name")===p)return n}else return n;if(n=hn(n.nextSibling),n===null)break}return null}function eS(n,i,o){if(i==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!o||(n=hn(n.nextSibling),n===null))return null;return n}function mx(n,i){for(;n.nodeType!==8;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!i||(n=hn(n.nextSibling),n===null))return null;return n}function ad(n){return n.data==="$?"||n.data==="$~"}function nd(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState!=="loading"}function tS(n,i){var o=n.ownerDocument;if(n.data==="$~")n._reactRetry=i;else if(n.data!=="$?"||o.readyState!=="loading")i();else{var f=function(){i(),o.removeEventListener("DOMContentLoaded",f)};o.addEventListener("DOMContentLoaded",f),n._reactRetry=f}}function hn(n){for(;n!=null;n=n.nextSibling){var i=n.nodeType;if(i===1||i===3)break;if(i===8){if(i=n.data,i==="$"||i==="$!"||i==="$?"||i==="$~"||i==="&"||i==="F!"||i==="F")break;if(i==="/$"||i==="/&")return null}}return n}var sd=null;function gx(n){n=n.nextSibling;for(var i=0;n;){if(n.nodeType===8){var o=n.data;if(o==="/$"||o==="/&"){if(i===0)return hn(n.nextSibling);i--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||i++}n=n.nextSibling}return null}function px(n){n=n.previousSibling;for(var i=0;n;){if(n.nodeType===8){var o=n.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(i===0)return n;i--}else o!=="/$"&&o!=="/&"||i++}n=n.previousSibling}return null}function xx(n,i,o){switch(i=i0(o),n){case"html":if(n=i.documentElement,!n)throw Error(a(452));return n;case"head":if(n=i.head,!n)throw Error(a(453));return n;case"body":if(n=i.body,!n)throw Error(a(454));return n;default:throw Error(a(451))}}function cc(n){for(var i=n.attributes;i.length;)n.removeAttributeNode(i[0]);Fe(n)}var dn=new Map,vx=new Set;function l0(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var vs=le.d;le.d={f:rS,r:aS,D:nS,C:sS,L:iS,m:lS,X:cS,S:oS,M:uS};function rS(){var n=vs.f(),i=Qu();return n||i}function aS(n){var i=qe(n);i!==null&&i.tag===5&&i.type==="form"?jg(i):vs.r(n)}var Vl=typeof document>"u"?null:document;function yx(n,i,o){var f=Vl;if(f&&typeof i=="string"&&i){var m=Te(i);m='link[rel="'+n+'"][href="'+m+'"]',typeof o=="string"&&(m+='[crossorigin="'+o+'"]'),vx.has(m)||(vx.add(m),n={rel:n,crossOrigin:o,href:i},f.querySelector(m)===null&&(i=f.createElement("link"),aa(i,"link",n),We(i),f.head.appendChild(i)))}}function nS(n){vs.D(n),yx("dns-prefetch",n,null)}function sS(n,i){vs.C(n,i),yx("preconnect",n,i)}function iS(n,i,o){vs.L(n,i,o);var f=Vl;if(f&&n&&i){var m='link[rel="preload"][as="'+Te(i)+'"]';i==="image"&&o&&o.imageSrcSet?(m+='[imagesrcset="'+Te(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(m+='[imagesizes="'+Te(o.imageSizes)+'"]')):m+='[href="'+Te(n)+'"]';var p=m;switch(i){case"style":p=Gl(n);break;case"script":p=ql(n)}dn.has(p)||(n=x({rel:"preload",href:i==="image"&&o&&o.imageSrcSet?void 0:n,as:i},o),dn.set(p,n),f.querySelector(m)!==null||i==="style"&&f.querySelector(uc(p))||i==="script"&&f.querySelector(fc(p))||(i=f.createElement("link"),aa(i,"link",n),We(i),f.head.appendChild(i)))}}function lS(n,i){vs.m(n,i);var o=Vl;if(o&&n){var f=i&&typeof i.as=="string"?i.as:"script",m='link[rel="modulepreload"][as="'+Te(f)+'"][href="'+Te(n)+'"]',p=m;switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":p=ql(n)}if(!dn.has(p)&&(n=x({rel:"modulepreload",href:n},i),dn.set(p,n),o.querySelector(m)===null)){switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(fc(p)))return}f=o.createElement("link"),aa(f,"link",n),We(f),o.head.appendChild(f)}}}function oS(n,i,o){vs.S(n,i,o);var f=Vl;if(f&&n){var m=$e(f).hoistableStyles,p=Gl(n);i=i||"default";var E=m.get(p);if(!E){var R={loading:0,preload:null};if(E=f.querySelector(uc(p)))R.loading=5;else{n=x({rel:"stylesheet",href:n,"data-precedence":i},o),(o=dn.get(p))&&id(n,o);var Y=E=f.createElement("link");We(Y),aa(Y,"link",n),Y._p=new Promise(function(ue,be){Y.onload=ue,Y.onerror=be}),Y.addEventListener("load",function(){R.loading|=1}),Y.addEventListener("error",function(){R.loading|=2}),R.loading|=4,o0(E,i,f)}E={type:"stylesheet",instance:E,count:1,state:R},m.set(p,E)}}}function cS(n,i){vs.X(n,i);var o=Vl;if(o&&n){var f=$e(o).hoistableScripts,m=ql(n),p=f.get(m);p||(p=o.querySelector(fc(m)),p||(n=x({src:n,async:!0},i),(i=dn.get(m))&&ld(n,i),p=o.createElement("script"),We(p),aa(p,"link",n),o.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},f.set(m,p))}}function uS(n,i){vs.M(n,i);var o=Vl;if(o&&n){var f=$e(o).hoistableScripts,m=ql(n),p=f.get(m);p||(p=o.querySelector(fc(m)),p||(n=x({src:n,async:!0,type:"module"},i),(i=dn.get(m))&&ld(n,i),p=o.createElement("script"),We(p),aa(p,"link",n),o.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},f.set(m,p))}}function _x(n,i,o,f){var m=(m=te.current)?l0(m):null;if(!m)throw Error(a(446));switch(n){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(i=Gl(o.href),o=$e(m).hoistableStyles,f=o.get(i),f||(f={type:"style",instance:null,count:0,state:null},o.set(i,f)),f):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){n=Gl(o.href);var p=$e(m).hoistableStyles,E=p.get(n);if(E||(m=m.ownerDocument||m,E={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},p.set(n,E),(p=m.querySelector(uc(n)))&&!p._p&&(E.instance=p,E.state.loading=5),dn.has(n)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},dn.set(n,o),p||fS(m,n,o,E.state))),i&&f===null)throw Error(a(528,""));return E}if(i&&f!==null)throw Error(a(529,""));return null;case"script":return i=o.async,o=o.src,typeof o=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=ql(o),o=$e(m).hoistableScripts,f=o.get(i),f||(f={type:"script",instance:null,count:0,state:null},o.set(i,f)),f):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,n))}}function Gl(n){return'href="'+Te(n)+'"'}function uc(n){return'link[rel="stylesheet"]['+n+"]"}function wx(n){return x({},n,{"data-precedence":n.precedence,precedence:null})}function fS(n,i,o,f){n.querySelector('link[rel="preload"][as="style"]['+i+"]")?f.loading=1:(i=n.createElement("link"),f.preload=i,i.addEventListener("load",function(){return f.loading|=1}),i.addEventListener("error",function(){return f.loading|=2}),aa(i,"link",o),We(i),n.head.appendChild(i))}function ql(n){return'[src="'+Te(n)+'"]'}function fc(n){return"script[async]"+n}function bx(n,i,o){if(i.count++,i.instance===null)switch(i.type){case"style":var f=n.querySelector('style[data-href~="'+Te(o.href)+'"]');if(f)return i.instance=f,We(f),f;var m=x({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return f=(n.ownerDocument||n).createElement("style"),We(f),aa(f,"style",m),o0(f,o.precedence,n),i.instance=f;case"stylesheet":m=Gl(o.href);var p=n.querySelector(uc(m));if(p)return i.state.loading|=4,i.instance=p,We(p),p;f=wx(o),(m=dn.get(m))&&id(f,m),p=(n.ownerDocument||n).createElement("link"),We(p);var E=p;return E._p=new Promise(function(R,Y){E.onload=R,E.onerror=Y}),aa(p,"link",f),i.state.loading|=4,o0(p,o.precedence,n),i.instance=p;case"script":return p=ql(o.src),(m=n.querySelector(fc(p)))?(i.instance=m,We(m),m):(f=o,(m=dn.get(p))&&(f=x({},o),ld(f,m)),n=n.ownerDocument||n,m=n.createElement("script"),We(m),aa(m,"link",f),n.head.appendChild(m),i.instance=m);case"void":return null;default:throw Error(a(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(f=i.instance,i.state.loading|=4,o0(f,o.precedence,n));return i.instance}function o0(n,i,o){for(var f=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=f.length?f[f.length-1]:null,p=m,E=0;E<f.length;E++){var R=f[E];if(R.dataset.precedence===i)p=R;else if(p!==m)break}p?p.parentNode.insertBefore(n,p.nextSibling):(i=o.nodeType===9?o.head:o,i.insertBefore(n,i.firstChild))}function id(n,i){n.crossOrigin==null&&(n.crossOrigin=i.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=i.referrerPolicy),n.title==null&&(n.title=i.title)}function ld(n,i){n.crossOrigin==null&&(n.crossOrigin=i.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=i.referrerPolicy),n.integrity==null&&(n.integrity=i.integrity)}var c0=null;function Sx(n,i,o){if(c0===null){var f=new Map,m=c0=new Map;m.set(o,f)}else m=c0,f=m.get(o),f||(f=new Map,m.set(o,f));if(f.has(n))return f;for(f.set(n,null),o=o.getElementsByTagName(n),m=0;m<o.length;m++){var p=o[m];if(!(p[he]||p[M]||n==="link"&&p.getAttribute("rel")==="stylesheet")&&p.namespaceURI!=="http://www.w3.org/2000/svg"){var E=p.getAttribute(i)||"";E=n+E;var R=f.get(E);R?R.push(p):f.set(E,[p])}}return f}function Ex(n,i,o){n=n.ownerDocument||n,n.head.insertBefore(o,i==="title"?n.querySelector("head > title"):null)}function hS(n,i,o){if(o===1||i.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;return i.rel==="stylesheet"?(n=i.disabled,typeof i.precedence=="string"&&n==null):!0;case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function Tx(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}function dS(n,i,o,f){if(o.type==="stylesheet"&&(typeof f.media!="string"||matchMedia(f.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var m=Gl(f.href),p=i.querySelector(uc(m));if(p){i=p._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(n.count++,n=u0.bind(n),i.then(n,n)),o.state.loading|=4,o.instance=p,We(p);return}p=i.ownerDocument||i,f=wx(f),(m=dn.get(m))&&id(f,m),p=p.createElement("link"),We(p);var E=p;E._p=new Promise(function(R,Y){E.onload=R,E.onerror=Y}),aa(p,"link",f),o.instance=p}n.stylesheets===null&&(n.stylesheets=new Map),n.stylesheets.set(o,i),(i=o.state.preload)&&(o.state.loading&3)===0&&(n.count++,o=u0.bind(n),i.addEventListener("load",o),i.addEventListener("error",o))}}var od=0;function mS(n,i){return n.stylesheets&&n.count===0&&h0(n,n.stylesheets),0<n.count||0<n.imgCount?function(o){var f=setTimeout(function(){if(n.stylesheets&&h0(n,n.stylesheets),n.unsuspend){var p=n.unsuspend;n.unsuspend=null,p()}},6e4+i);0<n.imgBytes&&od===0&&(od=62500*Wb());var m=setTimeout(function(){if(n.waitingForImages=!1,n.count===0&&(n.stylesheets&&h0(n,n.stylesheets),n.unsuspend)){var p=n.unsuspend;n.unsuspend=null,p()}},(n.imgBytes>od?50:800)+i);return n.unsuspend=o,function(){n.unsuspend=null,clearTimeout(f),clearTimeout(m)}}:null}function u0(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)h0(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var f0=null;function h0(n,i){n.stylesheets=null,n.unsuspend!==null&&(n.count++,f0=new Map,i.forEach(gS,n),f0=null,u0.call(n))}function gS(n,i){if(!(i.state.loading&4)){var o=f0.get(n);if(o)var f=o.get(null);else{o=new Map,f0.set(n,o);for(var m=n.querySelectorAll("link[data-precedence],style[data-precedence]"),p=0;p<m.length;p++){var E=m[p];(E.nodeName==="LINK"||E.getAttribute("media")!=="not all")&&(o.set(E.dataset.precedence,E),f=E)}f&&o.set(null,f)}m=i.instance,E=m.getAttribute("data-precedence"),p=o.get(E)||f,p===f&&o.set(null,m),o.set(E,m),this.count++,f=u0.bind(this),m.addEventListener("load",f),m.addEventListener("error",f),p?p.parentNode.insertBefore(m,p.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(m,n.firstChild)),i.state.loading|=4}}var hc={$$typeof:T,Provider:null,Consumer:null,_currentValue:je,_currentValue2:je,_threadCount:0};function pS(n,i,o,f,m,p,E,R,Y){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=gi(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gi(0),this.hiddenUpdates=gi(null),this.identifierPrefix=f,this.onUncaughtError=m,this.onCaughtError=p,this.onRecoverableError=E,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Y,this.incompleteTransitions=new Map}function kx(n,i,o,f,m,p,E,R,Y,ue,be,ke){return n=new pS(n,i,o,E,Y,ue,be,ke,R),i=1,p===!0&&(i|=24),p=$a(3,null,null,i),n.current=p,p.stateNode=n,i=zf(),i.refCount++,n.pooledCache=i,i.refCount++,p.memoizedState={element:f,isDehydrated:o,cache:i},Gf(p),n}function Ax(n){return n?(n=Sl,n):Sl}function Cx(n,i,o,f,m,p){m=Ax(m),f.context===null?f.context=m:f.pendingContext=m,f=Ls(i),f.payload={element:o},p=p===void 0?null:p,p!==null&&(f.callback=p),o=Bs(n,f,i),o!==null&&(ja(o,n,i),Vo(o,n,i))}function Nx(n,i){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var o=n.retryLane;n.retryLane=o!==0&&o<i?o:i}}function cd(n,i){Nx(n,i),(n=n.alternate)&&Nx(n,i)}function Ox(n){if(n.tag===13||n.tag===31){var i=Ei(n,67108864);i!==null&&ja(i,n,67108864),cd(n,67108864)}}function Rx(n){if(n.tag===13||n.tag===31){var i=Wa();i=pi(i);var o=Ei(n,i);o!==null&&ja(o,n,i),cd(n,i)}}var d0=!0;function xS(n,i,o,f){var m=K.T;K.T=null;var p=le.p;try{le.p=2,ud(n,i,o,f)}finally{le.p=p,K.T=m}}function vS(n,i,o,f){var m=K.T;K.T=null;var p=le.p;try{le.p=8,ud(n,i,o,f)}finally{le.p=p,K.T=m}}function ud(n,i,o,f){if(d0){var m=fd(f);if(m===null)Yh(n,i,f,m0,o),Fx(n,f);else if(_S(m,n,i,o,f))f.stopPropagation();else if(Fx(n,f),i&4&&-1<yS.indexOf(n)){for(;m!==null;){var p=qe(m);if(p!==null)switch(p.tag){case 3:if(p=p.stateNode,p.current.memoizedState.isDehydrated){var E=Aa(p.pendingLanes);if(E!==0){var R=p;for(R.pendingLanes|=2,R.entangledLanes|=2;E;){var Y=1<<31-qr(E);R.entanglements[1]|=Y,E&=~Y}$n(p),(Ht&6)===0&&(Yu=It()+500,ic(0))}}break;case 31:case 13:R=Ei(p,2),R!==null&&ja(R,p,2),Qu(),cd(p,2)}if(p=fd(f),p===null&&Yh(n,i,f,m0,o),p===m)break;m=p}m!==null&&f.stopPropagation()}else Yh(n,i,f,null,o)}}function fd(n){return n=zt(n),hd(n)}var m0=null;function hd(n){if(m0=null,n=Le(n),n!==null){var i=l(n);if(i===null)n=null;else{var o=i.tag;if(o===13){if(n=c(i),n!==null)return n;n=null}else if(o===31){if(n=u(i),n!==null)return n;n=null}else if(o===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;n=null}else i!==n&&(n=null)}}return m0=n,null}function Dx(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Pa()){case za:return 2;case Vr:return 8;case hr:case Qr:return 32;case pt:return 268435456;default:return 32}default:return 32}}var dd=!1,Ks=null,Ys=null,Js=null,dc=new Map,mc=new Map,Qs=[],yS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Fx(n,i){switch(n){case"focusin":case"focusout":Ks=null;break;case"dragenter":case"dragleave":Ys=null;break;case"mouseover":case"mouseout":Js=null;break;case"pointerover":case"pointerout":dc.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":mc.delete(i.pointerId)}}function gc(n,i,o,f,m,p){return n===null||n.nativeEvent!==p?(n={blockedOn:i,domEventName:o,eventSystemFlags:f,nativeEvent:p,targetContainers:[m]},i!==null&&(i=qe(i),i!==null&&Ox(i)),n):(n.eventSystemFlags|=f,i=n.targetContainers,m!==null&&i.indexOf(m)===-1&&i.push(m),n)}function _S(n,i,o,f,m){switch(i){case"focusin":return Ks=gc(Ks,n,i,o,f,m),!0;case"dragenter":return Ys=gc(Ys,n,i,o,f,m),!0;case"mouseover":return Js=gc(Js,n,i,o,f,m),!0;case"pointerover":var p=m.pointerId;return dc.set(p,gc(dc.get(p)||null,n,i,o,f,m)),!0;case"gotpointercapture":return p=m.pointerId,mc.set(p,gc(mc.get(p)||null,n,i,o,f,m)),!0}return!1}function Mx(n){var i=Le(n.target);if(i!==null){var o=l(i);if(o!==null){if(i=o.tag,i===13){if(i=c(o),i!==null){n.blockedOn=i,H(n.priority,function(){Rx(o)});return}}else if(i===31){if(i=u(o),i!==null){n.blockedOn=i,H(n.priority,function(){Rx(o)});return}}else if(i===3&&o.stateNode.current.memoizedState.isDehydrated){n.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}n.blockedOn=null}function g0(n){if(n.blockedOn!==null)return!1;for(var i=n.targetContainers;0<i.length;){var o=fd(n.nativeEvent);if(o===null){o=n.nativeEvent;var f=new o.constructor(o.type,o);Et=f,o.target.dispatchEvent(f),Et=null}else return i=qe(o),i!==null&&Ox(i),n.blockedOn=o,!1;i.shift()}return!0}function jx(n,i,o){g0(n)&&o.delete(i)}function wS(){dd=!1,Ks!==null&&g0(Ks)&&(Ks=null),Ys!==null&&g0(Ys)&&(Ys=null),Js!==null&&g0(Js)&&(Js=null),dc.forEach(jx),mc.forEach(jx)}function p0(n,i){n.blockedOn===i&&(n.blockedOn=null,dd||(dd=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,wS)))}var x0=null;function Ix(n){x0!==n&&(x0=n,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){x0===n&&(x0=null);for(var i=0;i<n.length;i+=3){var o=n[i],f=n[i+1],m=n[i+2];if(typeof f!="function"){if(hd(f||o)===null)continue;break}var p=qe(o);p!==null&&(n.splice(i,3),i-=3,fh(p,{pending:!0,data:m,method:o.method,action:f},f,m))}}))}function Xl(n){function i(Y){return p0(Y,n)}Ks!==null&&p0(Ks,n),Ys!==null&&p0(Ys,n),Js!==null&&p0(Js,n),dc.forEach(i),mc.forEach(i);for(var o=0;o<Qs.length;o++){var f=Qs[o];f.blockedOn===n&&(f.blockedOn=null)}for(;0<Qs.length&&(o=Qs[0],o.blockedOn===null);)Mx(o),o.blockedOn===null&&Qs.shift();if(o=(n.ownerDocument||n).$$reactFormReplay,o!=null)for(f=0;f<o.length;f+=3){var m=o[f],p=o[f+1],E=m[B]||null;if(typeof p=="function")E||Ix(o);else if(E){var R=null;if(p&&p.hasAttribute("formAction")){if(m=p,E=p[B]||null)R=E.formAction;else if(hd(m)!==null)continue}else R=E.action;typeof R=="function"?o[f+1]=R:(o.splice(f,3),f-=3),Ix(o)}}}function Lx(){function n(p){p.canIntercept&&p.info==="react-transition"&&p.intercept({handler:function(){return new Promise(function(E){return m=E})},focusReset:"manual",scroll:"manual"})}function i(){m!==null&&(m(),m=null),f||setTimeout(o,20)}function o(){if(!f&&!navigation.transition){var p=navigation.currentEntry;p&&p.url!=null&&navigation.navigate(p.url,{state:p.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var f=!1,m=null;return navigation.addEventListener("navigate",n),navigation.addEventListener("navigatesuccess",i),navigation.addEventListener("navigateerror",i),setTimeout(o,100),function(){f=!0,navigation.removeEventListener("navigate",n),navigation.removeEventListener("navigatesuccess",i),navigation.removeEventListener("navigateerror",i),m!==null&&(m(),m=null)}}}function md(n){this._internalRoot=n}v0.prototype.render=md.prototype.render=function(n){var i=this._internalRoot;if(i===null)throw Error(a(409));var o=i.current,f=Wa();Cx(o,f,n,i,null,null)},v0.prototype.unmount=md.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var i=n.containerInfo;Cx(n.current,2,null,n,null,null),Qu(),i[V]=null}};function v0(n){this._internalRoot=n}v0.prototype.unstable_scheduleHydration=function(n){if(n){var i=O();n={blockedOn:null,target:n,priority:i};for(var o=0;o<Qs.length&&i!==0&&i<Qs[o].priority;o++);Qs.splice(o,0,n),o===0&&Mx(n)}};var Bx=t.version;if(Bx!=="19.2.3")throw Error(a(527,Bx,"19.2.3"));le.findDOMNode=function(n){var i=n._reactInternals;if(i===void 0)throw typeof n.render=="function"?Error(a(188)):(n=Object.keys(n).join(","),Error(a(268,n)));return n=d(i),n=n!==null?g(n):null,n=n===null?null:n.stateNode,n};var bS={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:K,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var y0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!y0.isDisabled&&y0.supportsFiber)try{Vt=y0.inject(bS),Pt=y0}catch{}}return xc.createRoot=function(n,i){if(!s(n))throw Error(a(299));var o=!1,f="",m=Gg,p=qg,E=Xg;return i!=null&&(i.unstable_strictMode===!0&&(o=!0),i.identifierPrefix!==void 0&&(f=i.identifierPrefix),i.onUncaughtError!==void 0&&(m=i.onUncaughtError),i.onCaughtError!==void 0&&(p=i.onCaughtError),i.onRecoverableError!==void 0&&(E=i.onRecoverableError)),i=kx(n,1,!1,null,null,o,f,null,m,p,E,Lx),n[V]=i.current,Kh(n),new md(i)},xc.hydrateRoot=function(n,i,o){if(!s(n))throw Error(a(299));var f=!1,m="",p=Gg,E=qg,R=Xg,Y=null;return o!=null&&(o.unstable_strictMode===!0&&(f=!0),o.identifierPrefix!==void 0&&(m=o.identifierPrefix),o.onUncaughtError!==void 0&&(p=o.onUncaughtError),o.onCaughtError!==void 0&&(E=o.onCaughtError),o.onRecoverableError!==void 0&&(R=o.onRecoverableError),o.formState!==void 0&&(Y=o.formState)),i=kx(n,1,!0,i,o??null,f,m,Y,p,E,R,Lx),i.context=Ax(null),o=i.current,f=Wa(),f=pi(f),m=Ls(f),m.callback=null,Bs(o,m,f),o=f,i.current.lanes=o,rs(i,o),$n(i),n[V]=i.current,Kh(n),new v0(i)},xc.version="19.2.3",xc}var Wx;function DS(){if(Wx)return xd.exports;Wx=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),xd.exports=RS(),xd.exports}var FS=DS();const MS=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),jS=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,a)=>a?a.toUpperCase():r.toLowerCase()),Kx=e=>{const t=jS(e);return t.charAt(0).toUpperCase()+t.slice(1)},zy=(...e)=>e.filter((t,r,a)=>!!t&&t.trim()!==""&&a.indexOf(t)===r).join(" ").trim(),IS=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};var LS={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const BS=Ce.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:a,className:s="",children:l,iconNode:c,...u},h)=>Ce.createElement("svg",{ref:h,...LS,width:t,height:t,stroke:e,strokeWidth:a?Number(r)*24/Number(t):r,className:zy("lucide",s),...!l&&!IS(u)&&{"aria-hidden":"true"},...u},[...c.map(([d,g])=>Ce.createElement(d,g)),...Array.isArray(l)?l:[l]]));const nr=(e,t)=>{const r=Ce.forwardRef(({className:a,...s},l)=>Ce.createElement(BS,{ref:l,iconNode:t,className:zy(`lucide-${MS(Kx(e))}`,`lucide-${e}`,a),...s}));return r.displayName=Kx(e),r};const US=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],PS=nr("calendar-days",US);const zS=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],Hy=nr("chart-column",zS);const HS=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],$S=nr("chevron-down",HS);const VS=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],GS=nr("chevron-right",VS);const qS=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],eu=nr("circle-check",qS);const XS=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]],WS=nr("clipboard-check",XS);const KS=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],pm=nr("clipboard-list",KS);const YS=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],rl=nr("download",YS);const JS=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],Yx=nr("eye-off",JS);const QS=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Jx=nr("eye",QS);const ZS=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],eE=nr("file-down",ZS);const tE=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],$y=nr("file-spreadsheet",tE);const rE=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],aE=nr("menu",rE);const nE=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],U0=nr("package",nE);const sE=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],iE=nr("pen",sE);const lE=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],Vy=nr("pencil",lE);const oE=[["path",{d:"m10.5 20.5 10-10a4.95 4.95 0 1 0-7-7l-10 10a4.95 4.95 0 1 0 7 7Z",key:"wa1lgi"}],["path",{d:"m8.5 8.5 7 7",key:"rvfmvr"}]],Gy=nr("pill",oE);const cE=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],uE=nr("plus",cE);const fE=[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]],al=nr("refresh-ccw",fE);const hE=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],dE=nr("save",hE);const mE=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],xm=nr("search",mE);const gE=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],pE=nr("tag",gE);const xE=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],xo=nr("trash-2",xE);const vE=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],yE=nr("trending-down",vE);const _E=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],nl=nr("triangle-alert",_E);const wE=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Ki=nr("upload",wE);const bE=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],tu=nr("x",bE);function SE({editingMed:e,onClose:t,onSubmit:r}){return v.jsx("div",{className:"fixed inset-0 bg-slate-900/60 backdrop-blur-sm flex items-center justify-center z-50 p-4 font-sans",children:v.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-lg overflow-hidden",children:[v.jsxs("div",{className:"p-6 border-b border-slate-100 flex justify-between items-center bg-slate-50",children:[v.jsx("h3",{className:"text-lg font-bold text-slate-800",children:e?"Editar Medicamento":"Nuevo Medicamento"}),v.jsx("button",{type:"button",onClick:t,className:"text-slate-400 hover:text-slate-600 transition-colors",children:v.jsx(tu,{size:24})})]}),v.jsxs("form",{onSubmit:r,className:"p-6 grid grid-cols-2 gap-4",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase mb-1",children:"CDIGO SIGES"}),v.jsx("input",{name:"siges_code",defaultValue:e?.siges_code,className:"w-full border p-2.5 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm font-mono",placeholder:"110-00-0000"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase mb-1",children:"Clasificador SICOP"}),v.jsx("input",{name:"sicop_classifier",defaultValue:e?.sicop_classifier,className:"w-full border p-2.5 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm font-mono",placeholder:"CLASIF-SICOP"})]}),v.jsxs("div",{className:"col-span-2",children:[v.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase mb-1",children:"Identificador SICOP"}),v.jsx("input",{name:"sicop_identifier",defaultValue:e?.sicop_identifier,className:"w-full border p-2.5 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm font-mono",placeholder:"ID-SICOP"})]}),v.jsxs("div",{className:"col-span-2",children:[v.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase mb-1",children:"Nombre Comercial"}),v.jsx("input",{required:!0,name:"name",defaultValue:e?.name,className:"w-full border p-2.5 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm transition-all",placeholder:"Ej. Amoxicilina 500mg"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase mb-1",children:"Categora"}),v.jsxs("select",{name:"category",defaultValue:e?.category,className:"w-full border p-2.5 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm bg-white",children:[v.jsx("option",{children:"Analgsico"}),v.jsx("option",{children:"Antibitico"}),v.jsx("option",{children:"Antiinflamatorio"}),v.jsx("option",{children:"Insumo Mdico"}),v.jsx("option",{children:"Protector Gstrico"})]})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase mb-1",children:"Unidad"}),v.jsx("input",{name:"unit",defaultValue:e?.unit||"Tabletas",className:"w-full border p-2.5 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm",placeholder:"Cajas, Tabletas..."})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase mb-1",children:"Lote"}),v.jsx("input",{name:"batch",defaultValue:e?.batch,className:"w-full border p-2.5 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm font-mono",placeholder:"LOT-000"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase mb-1",children:"Vencimiento"}),v.jsx("input",{type:"date",name:"expiry_date",defaultValue:e?.expiry_date,className:"w-full border p-2.5 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm font-mono"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase mb-1",children:"Stock Inicial"}),v.jsx("input",{type:"number",name:"stock",defaultValue:e?.stock||0,className:"w-full border p-2.5 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm font-mono"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase mb-1",children:"Stock Mnimo"}),v.jsx("input",{type:"number",name:"min_stock",defaultValue:e?.min_stock||10,className:"w-full border p-2.5 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm font-mono"})]}),v.jsxs("div",{className:"col-span-2 pt-4 flex space-x-3",children:[v.jsx("button",{type:"button",onClick:t,className:"flex-1 border border-slate-200 py-3 rounded-xl hover:bg-slate-50 font-semibold transition-colors text-sm",children:"Cancelar"}),v.jsx("button",{type:"submit",className:"flex-1 bg-blue-600 text-white py-3 rounded-xl hover:bg-blue-700 font-semibold shadow-lg shadow-blue-200 transition-all text-sm",children:e?"Guardar Cambios":"Registrar"})]})]})]})})}function EE({activeTab:e}){const t=e==="dashboard"?"Resumen General":e==="inventory"?"Gestin de Inventario":e==="inventory-take"?"Toma Inventario":e==="catalog"?"Catlogo de Productos":e==="consumption-monthly"?"Consumo Mensual":e==="consumption-summary"?"Resumen de Consumo":e==="order-request"?"Solicitud Pedido":e==="calendar"?"Calendario":e==="tertiary-packaging"?"Empaque Terciario":e==="categories"?"Categoras":e==="alerts"?"Alertas de Stock":"Bodegapp";return v.jsx("header",{className:"flex justify-between items-center mb-8",children:v.jsxs("div",{children:[v.jsx("h2",{className:"text-2xl font-bold text-slate-800 capitalize",children:t}),v.jsx("p",{className:"text-slate-500",children:"Sistema central de suministros mdicos."})]})})}const Qx="bodegapp.sidebar.openSections";function TE({id:e,icon:t,label:r,activeTab:a,isSidebarOpen:s,onSelect:l}){return v.jsxs("button",{type:"button",title:s?void 0:r,onClick:()=>l(e),className:`w-full flex items-center space-x-3 p-3 rounded-lg transition-colors ${a===e?"bg-blue-600 text-white shadow-md":"text-slate-600 hover:bg-blue-50"}`,children:[v.jsx(t,{size:20}),s&&v.jsx("span",{className:"font-medium",children:r})]})}function kE({label:e,open:t,isSidebarOpen:r,onToggle:a}){return r?v.jsxs("button",{type:"button",onClick:a,className:"w-full px-3 pt-2 pb-1 text-[10px] font-bold uppercase tracking-wider text-slate-400 flex items-center justify-between hover:text-slate-500",children:[v.jsx("span",{children:e}),v.jsx($S,{size:14,className:`transition-transform ${t?"rotate-0":"-rotate-90"}`})]}):v.jsx("div",{className:"h-px bg-slate-100 my-2"})}function AE({activeTab:e,isSidebarOpen:t,onSelectTab:r,onToggleSidebar:a}){const s=Ce.useMemo(()=>[{id:"inventories",label:"Gestin de inventarios",items:[{id:"inventory",icon:Gy,label:"Inventario"},{id:"inventory-take",icon:WS,label:"Toma Inventario"},{id:"catalog",icon:$y,label:"Catlogo"},{id:"categories",icon:pE,label:"Categoras"}]},{id:"consumption",label:"Consumos y anlisis",items:[{id:"consumption-monthly",icon:Ki,label:"Consumo mensual"},{id:"consumption-summary",icon:Hy,label:"Resumen de consumo"}]},{id:"supply",label:"Abastecimiento",items:[{id:"order-request",icon:pm,label:"Solicitud de pedido"},{id:"tertiary-packaging",icon:U0,label:"Empaque terciario"}]},{id:"planning",label:"Planificacin",items:[{id:"calendar",icon:PS,label:"Calendario"}]}],[]),l=Ce.useMemo(()=>{const h=new Map;for(const d of s)for(const g of d.items)h.set(g.id,d.id);return h},[s]),[c,u]=Ce.useState(()=>{const h={inventories:!0,consumption:!0,supply:!0,planning:!0};try{const d=localStorage.getItem(Qx);if(!d)return h;const g=JSON.parse(d);return!g||typeof g!="object"?h:{inventories:!!(g.inventories??!0),consumption:!!(g.consumption??!0),supply:!!(g.supply??!0),planning:!!(g.planning??!0)}}catch{return h}});return Ce.useEffect(()=>{try{localStorage.setItem(Qx,JSON.stringify(c))}catch{}},[c]),Ce.useEffect(()=>{const h=l.get(e);h&&u(d=>d[h]?d:{...d,[h]:!0})},[e,l]),v.jsxs("aside",{className:`bg-white border-r border-slate-200 transition-all duration-300 flex flex-col ${t?"w-64":"w-20"}`,children:[v.jsxs("div",{className:"p-6 flex items-center space-x-3 border-b border-slate-100",children:[v.jsx("div",{className:"bg-blue-600 p-2 rounded-lg text-white",children:v.jsx(U0,{size:24})}),t&&v.jsxs("h1",{className:"text-xl font-bold tracking-tight text-blue-900 leading-none",children:["BODEGA",v.jsx("br",{}),v.jsx("span",{className:"text-sm font-normal text-slate-500 tracking-normal",children:"PharmaStock v1.1"})]})]}),v.jsx("nav",{className:"flex-1 p-4 mt-4 space-y-2",children:s.map(h=>{const d=!!(c?.[h.id]??!0),g=!t||d;return v.jsxs("div",{className:"space-y-2",children:[v.jsx(kE,{label:h.label,open:d,isSidebarOpen:t,onToggle:()=>u(x=>({...x,[h.id]:!d}))}),g&&v.jsx("div",{className:"space-y-2",children:h.items.map(x=>v.jsx(TE,{id:x.id,icon:x.icon,label:x.label,activeTab:e,isSidebarOpen:t,onSelect:r},x.id))})]},h.id)})}),v.jsx("div",{className:"p-4 border-t border-slate-100",children:v.jsx("button",{type:"button",onClick:a,className:"p-2 hover:bg-slate-100 rounded-lg text-slate-400 w-full flex justify-center",children:t?v.jsx(tu,{size:20}):v.jsx(aE,{size:20})})})]})}function CE({lowStockItems:e,onEditMedication:t}){const r=a=>{const s=Number(a);return Number.isFinite(s)?s.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):String(a??"0")};return v.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.map(a=>v.jsxs("div",{className:"bg-white p-6 rounded-xl border-l-4 border-red-500 shadow-sm flex flex-col justify-between",children:[v.jsxs("div",{children:[v.jsxs("div",{className:"flex justify-between items-start mb-4",children:[v.jsx("h3",{className:"text-lg font-bold text-slate-800",children:a.name}),v.jsx("div",{className:"bg-red-100 p-2 rounded-full text-red-600",children:v.jsx(nl,{size:20})})]}),v.jsxs("div",{className:"space-y-2 mb-6 text-sm text-slate-600",children:[v.jsxs("p",{className:"flex justify-between",children:[v.jsx("span",{children:"Categora:"})," ",v.jsx("span",{className:"font-semibold",children:a.category})]}),v.jsxs("p",{className:"flex justify-between",children:[v.jsx("span",{children:"Stock Mnimo:"})," ",v.jsx("span",{className:"font-semibold",children:r(a.computed_min_stock??a.min_stock)})]}),v.jsxs("p",{className:"flex justify-between",children:[v.jsx("span",{children:"Stock Actual:"})," ",v.jsx("span",{className:"font-bold text-red-600 text-base",children:r(a.stock)})]})]})]}),v.jsx("button",{type:"button",onClick:()=>t(a),className:"w-full bg-blue-600 hover:bg-blue-700 text-white py-2 rounded-lg font-medium transition-colors",children:"Generar Orden de Compra"})]},a.id)),e.length===0&&v.jsxs("div",{className:"col-span-full py-20 text-center bg-white border border-dashed border-slate-300 rounded-2xl",children:[v.jsx("div",{className:"bg-green-100 text-green-600 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4",children:v.jsx(U0,{size:32})}),v.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"Todo en Orden!"}),v.jsx("p",{className:"text-slate-500 max-w-sm mx-auto",children:"No hay medicamentos que requieran atencin inmediata por falta de inventario."})]})]})}function NE({medications:e,excelStatus:t,fileInputRef:r,sicopFileInputRef:a,onChooseFile:s,onChooseSicopFile:l,onDownloadTemplate:c,onFileChange:u,onSicopFileChange:h,onEditMedication:d,onDeleteMedication:g,onClearCatalog:x}){const y=w=>{const S=String(w??"").trim();return S.length<=50?{display:S,full:S}:{display:`${S.slice(0,50)}`,full:S}},_=Ce.useMemo(()=>{const w=k=>{const C=String(k||"").replace(/\D/g,"");return C.length<4?Number.POSITIVE_INFINITY:Number.parseInt(C.slice(-4),10)},S=k=>String(k||"").trim().startsWith("1-10");return[...e||[]].sort((k,C)=>{const T=k?.siges_code||"",j=C?.siges_code||"",X=S(T),D=S(j);if(X!==D)return X?-1:1;const N=w(T),W=w(j);return N!==W?N-W:String(T).localeCompare(String(j),"es",{numeric:!0,sensitivity:"base"})})},[e]),b=Ce.useMemo(()=>{const w=e??[],S=w.filter(C=>String(C?.sicop_classifier||"").trim()).length,k=w.filter(C=>String(C?.sicop_identifier||"").trim()).length;return{total:w.length,withClassifier:S,withIdentifier:k}},[e]);return v.jsx("div",{className:"space-y-6",children:v.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[v.jsxs("div",{className:"lg:col-span-1 bg-white p-6 rounded-2xl border border-slate-200 shadow-sm",children:[v.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[v.jsx("div",{className:"bg-green-100 text-green-600 p-2 rounded-lg",children:v.jsx(Ki,{size:20})}),v.jsx("h3",{className:"font-bold text-slate-800",children:"Importar CSV"})]}),v.jsxs("p",{className:"text-sm text-slate-500 mb-6 leading-relaxed",children:["Cargue su catlogo masivamente. El archivo debe contener las columnas: ",v.jsx("br",{}),v.jsx("code",{className:"bg-slate-100 px-1 rounded text-blue-600 font-mono text-xs",children:"CodigoSIGES, ClasificadorSICOP, IdentificadorSICOP, Medicamento, Categoria, Lote, Vencimiento, Stock, StockMinimo, Unidad"})]}),v.jsx("input",{type:"file",ref:r,onChange:u,accept:".csv",className:"hidden"}),v.jsx("input",{type:"file",ref:a,onChange:h,accept:".csv",className:"hidden"}),v.jsxs("button",{type:"button",onClick:s,className:"w-full flex flex-col items-center justify-center border-2 border-dashed border-slate-300 rounded-xl py-10 hover:border-blue-400 hover:bg-blue-50 transition-all group",children:[v.jsx($y,{size:40,className:"text-slate-300 group-hover:text-blue-500 mb-2 transition-colors"}),v.jsx("span",{className:"text-sm font-semibold text-slate-600 group-hover:text-blue-700",children:"Seleccionar archivo CSV"}),v.jsx("span",{className:"text-xs text-slate-400 mt-1",children:"Soporta .csv"})]}),t.message&&v.jsxs("div",{className:`mt-4 p-3 rounded-lg text-xs flex items-center space-x-2 ${t.type==="success"?"bg-green-50 text-green-700 border border-green-100":t.type==="error"?"bg-red-50 text-red-700 border border-red-100":"bg-blue-50 text-blue-700 border border-blue-100"}`,children:[t.type==="success"?v.jsx(eu,{size:16}):v.jsx(nl,{size:16}),v.jsx("span",{children:t.message})]})]}),v.jsxs("div",{className:"lg:col-span-2 bg-white rounded-2xl border border-slate-200 shadow-sm overflow-hidden",children:[v.jsxs("div",{className:"p-4 border-b border-slate-100 bg-slate-50 flex justify-between items-center",children:[v.jsx("h3",{className:"font-bold text-slate-800",children:"Vista Previa del Catlogo"}),v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsxs("button",{type:"button",onClick:()=>{!e?.length||!window.confirm("Desea eliminar todo el catlogo? Esta accin no se puede deshacer.")||x?.()},disabled:!e?.length,className:"text-xs text-red-600 font-bold flex items-center space-x-1 hover:underline disabled:opacity-40 disabled:hover:no-underline",children:[v.jsx(xo,{size:14}),v.jsx("span",{children:"Eliminar Catlogo"})]}),v.jsxs("button",{type:"button",onClick:c,className:"text-xs text-blue-600 font-bold flex items-center space-x-1 hover:underline",children:[v.jsx(rl,{size:14}),v.jsx("span",{children:"Descargar Plantilla"})]}),v.jsxs("button",{type:"button",onClick:l,className:"text-xs text-slate-600 font-bold flex items-center space-x-1 hover:underline",title:"Importa/actualiza slo cdigos SICOP por Cdigo SIGES",children:[v.jsx(Ki,{size:14}),v.jsx("span",{children:"Cargar SICOP"})]})]})]}),b.total>0&&b.withClassifier===0&&b.withIdentifier===0&&v.jsxs("div",{className:"mx-4 mt-4 p-3 rounded-lg text-xs bg-amber-50 text-amber-800 border border-amber-100",children:["No se detectaron cdigos SICOP en el catlogo. Verifica tu CSV (columnas",v.jsx("span",{className:"font-mono",children:" ClasificadorSICOP"})," /",v.jsx("span",{className:"font-mono",children:" IdentificadorSICOP"}),") o edtalos con el lpiz en una fila."]}),v.jsx("div",{className:"max-h-[400px] overflow-y-auto",children:v.jsxs("table",{className:"w-full text-left",children:[v.jsx("thead",{className:"sticky top-0 bg-white shadow-sm text-slate-500 text-[10px] uppercase font-bold",children:v.jsxs("tr",{children:[v.jsx("th",{className:"px-6 py-3",children:"Cdigo SIGES"}),v.jsx("th",{className:"px-6 py-3",children:"Clasificador SICOP"}),v.jsx("th",{className:"px-6 py-3",children:"Identificador SICOP"}),v.jsx("th",{className:"px-6 py-3",children:"Medicamento"}),v.jsx("th",{className:"px-6 py-3 text-center",children:"Acciones"})]})}),v.jsx("tbody",{className:"divide-y divide-slate-100",children:_.map(w=>v.jsxs("tr",{className:"hover:bg-slate-50 transition-colors group",children:[v.jsx("td",{className:"px-6 py-3 text-sm text-slate-700 font-mono",children:w.siges_code||""}),v.jsx("td",{className:"px-6 py-3 text-sm text-slate-700 font-mono",children:w.sicop_classifier||""}),v.jsx("td",{className:"px-6 py-3 text-sm text-slate-700 font-mono",children:w.sicop_identifier||""}),v.jsx("td",{className:"px-6 py-3 text-sm font-medium text-slate-700",title:y(w.name).full,children:y(w.name).display}),v.jsx("td",{className:"px-6 py-3",children:v.jsxs("div",{className:"flex justify-center space-x-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[v.jsx("button",{type:"button",onClick:()=>d?.(w),className:"p-1.5 text-slate-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg","aria-label":"Editar",title:"Editar",children:v.jsx(iE,{size:14})}),v.jsx("button",{type:"button",onClick:()=>g?.(w.id),className:"p-1.5 text-slate-400 hover:text-red-600 hover:bg-red-50 rounded-lg","aria-label":"Eliminar",title:"Eliminar",children:v.jsx(xo,{size:14})})]})})]},w.id))})]})})]})]})})}function qd(e){const t=typeof e=="number"?e:Number(String(e??"").replace(/,/g,""));return Number.isFinite(t)?t:0}function Wl(e){const t=qd(e);return new Intl.NumberFormat("es-CR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(t)}function qy(e){return e.length?e.reduce((t,r)=>t+r,0)/e.length:0}function OE(e){if(e.length<=1)return 0;const t=qy(e),r=e.reduce((a,s)=>a+(s-t)**2,0)/e.length;return Math.sqrt(r)}function RE({siges_code:e,medication_name:t}){const r=String(e??"").trim();if(r)return`code:${r}`;const a=String(t??"").trim().toLowerCase();return a?`name:${a}`:""}function Zx(e){const t=String(e||"").replace(/\D/g,"");return t.length<4?Number.POSITIVE_INFINITY:Number.parseInt(t.slice(-4),10)}function ev(e){return String(e||"").trim().startsWith("110")}function DE({status:e}){if(!e?.message)return null;const t=e.type==="success"?"bg-emerald-50 border-emerald-200 text-emerald-800":e.type==="error"?"bg-rose-50 border-rose-200 text-rose-800":"bg-blue-50 border-blue-200 text-blue-800";return v.jsx("div",{className:`border rounded-lg px-4 py-3 text-sm ${t}`,children:v.jsx("span",{children:e.message})})}function FE({months:e,onRefresh:t,status:r}){const a=(e??[]).slice(0,3),s=a.map(D=>String(D?.label??"").trim()).filter(Boolean),[l,c]=Ce.useState(""),[u,h]=Ce.useState(!0),[d,g]=Ce.useState(50),[x,y]=Ce.useState(1),_=Ce.useMemo(()=>{const D=new Map;return a.forEach((N,W)=>{const P=N?.items??[];for(const re of P){const ae=String(re?.siges_code??"").trim(),Q=String(re?.medication_name??"").trim(),xe=RE({siges_code:ae,medication_name:Q});if(!xe)continue;const Oe=D.get(xe)??{siges_code:ae,medication_name:Q,perMonth:[0,0,0]};Oe.siges_code=Oe.siges_code||ae,Oe.medication_name=Oe.medication_name||Q,Oe.perMonth[W]+=qd(re?.quantity),D.set(xe,Oe)}}),Array.from(D.values()).map(N=>{const W=N.perMonth.slice(0,3),P=qy(W),re=OE(W);return{...N,avg:P,sd:re,total:P+re}})},[a]),b=Ce.useMemo(()=>{const D=l.trim().toLowerCase(),N=u?_.filter(P=>qd(P.total)>0):_;return(D?N.filter(P=>`${P.siges_code} ${P.medication_name}`.toLowerCase().includes(D)):N).sort((P,re)=>{const ae=P?.siges_code||"",Q=re?.siges_code||"",xe=ev(ae),Oe=ev(Q);if(xe!==Oe)return xe?-1:1;const Ae=Zx(ae),K=Zx(Q);return Ae!==K?Ae-K:String(ae).localeCompare(String(Q),"es",{numeric:!0,sensitivity:"base"})})},[u,_,l]),w=b.length,S=Math.max(1,Number(d)||50),k=Math.max(1,Math.ceil(w/S)),C=Math.min(Math.max(x,1),k),T=Ce.useMemo(()=>{const D=(C-1)*S;return b.slice(D,D+S)},[b,C,S]),j=w===0?0:(C-1)*S+1,X=Math.min(C*S,w);return v.jsxs("div",{className:"space-y-6",children:[v.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-5",children:[v.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[v.jsxs("div",{className:"space-y-1",children:[v.jsx("h3",{className:"font-semibold text-slate-800",children:"Resumen de consumo"}),v.jsx("p",{className:"text-xs text-slate-500",children:"Muestra por medicamento: cdigo, consumos de los ltimos 3 meses, promedio, desviacin estndar y total (promedio + desviacin)."})]}),v.jsx("div",{className:"flex flex-wrap items-center gap-2",children:v.jsxs("button",{type:"button",onClick:t,className:"px-3 py-2 rounded-lg border border-slate-200 text-slate-700 hover:bg-slate-50 text-sm flex items-center gap-2",children:[v.jsx(al,{size:16}),"Sincronizar"]})})]}),v.jsx("div",{className:"mt-4",children:v.jsx(DE,{status:r})})]}),v.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm overflow-hidden",children:[v.jsxs("div",{className:"p-4 border-b border-slate-100 bg-slate-50 flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("div",{className:"bg-blue-50 text-blue-600 p-2 rounded-lg",children:v.jsx(Hy,{size:18})}),v.jsx("h3",{className:"font-bold text-slate-800",children:"Consumo por medicamento (ltimos 3 meses)"})]}),v.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[v.jsx("button",{type:"button",onClick:()=>{h(D=>!D),y(1)},className:"px-3 py-2 rounded-lg border border-slate-200 text-slate-700 hover:bg-slate-50 text-sm",title:"Oculta medicamentos con consumo 0 en los ltimos 3 meses",children:u?"Mostrar sin consumo":"Ocultar sin consumo"}),v.jsx("input",{value:l,onChange:D=>{c(D.target.value),y(1)},placeholder:"Buscar por cdigo o medicamento...",className:"w-72 border border-slate-200 rounded-lg px-3 py-2 text-sm bg-white"})]})]}),a.length===0?v.jsx("div",{className:"p-8 text-center text-slate-500 text-sm",children:"No hay consumos cargados."}):v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"overflow-x-auto",children:v.jsxs("table",{className:"w-full min-w-[1100px] text-left",children:[v.jsx("thead",{className:"sticky top-0 z-10 bg-slate-50 text-slate-500 text-[10px] uppercase font-bold shadow-sm",children:v.jsxs("tr",{children:[v.jsx("th",{className:"px-4 py-4 whitespace-nowrap w-36 text-center",children:"Cdigo SIGES"}),v.jsx("th",{className:"px-4 py-4 whitespace-nowrap text-center",children:"Medicamento"}),v.jsx("th",{className:"px-3 py-4 text-center whitespace-nowrap w-32",children:s[2]??"Mes 3"}),v.jsx("th",{className:"px-3 py-4 text-center whitespace-nowrap w-32",children:s[1]??"Mes 2"}),v.jsx("th",{className:"px-3 py-4 text-center whitespace-nowrap w-32",children:s[0]??"Mes 1"}),v.jsx("th",{className:"px-3 py-4 text-center whitespace-nowrap w-28",children:"Promedio"}),v.jsx("th",{className:"px-3 py-4 text-center whitespace-nowrap w-28",children:"Desv. Est."}),v.jsx("th",{className:"px-3 py-4 text-center whitespace-nowrap w-36",children:"Total (Prom.+Desv.)"})]})}),v.jsxs("tbody",{className:"divide-y divide-slate-100",children:[T.map((D,N)=>v.jsxs("tr",{className:"hover:bg-slate-50",children:[v.jsx("td",{className:"px-4 py-4 text-xs text-slate-600 font-mono whitespace-nowrap text-center",children:D.siges_code||""}),v.jsx("td",{className:"px-4 py-4 text-sm font-medium text-slate-700 whitespace-normal break-words",children:D.medication_name}),v.jsx("td",{className:"px-3 py-4 text-center font-mono text-sm tabular-nums",children:Wl(D.perMonth[2]??0)}),v.jsx("td",{className:"px-3 py-4 text-center font-mono text-sm tabular-nums",children:Wl(D.perMonth[1]??0)}),v.jsx("td",{className:"px-3 py-4 text-center font-mono text-sm tabular-nums",children:Wl(D.perMonth[0]??0)}),v.jsx("td",{className:"px-3 py-4 text-center font-mono text-sm tabular-nums",children:Wl(D.avg)}),v.jsx("td",{className:"px-3 py-4 text-center font-mono text-sm tabular-nums",children:Wl(D.sd)}),v.jsx("td",{className:"px-3 py-4 text-center font-mono text-sm font-bold text-blue-700 tabular-nums",children:Wl(D.total)})]},`${D.siges_code||D.medication_name}-${N}`)),T.length===0&&v.jsx("tr",{children:v.jsx("td",{colSpan:8,className:"px-6 py-10 text-center text-sm text-slate-400",children:"No hay resultados."})})]})]})}),v.jsxs("div",{className:"p-4 border-t border-slate-100 bg-slate-50 flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[v.jsx("div",{className:"text-xs text-slate-500",children:w===0?"0 resultados":`Mostrando ${j}-${X} de ${w}`}),v.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[v.jsx("label",{className:"text-xs text-slate-500",children:"Filas"}),v.jsx("select",{value:S,onChange:D=>{g(Number(D.target.value)||50),y(1)},className:"border border-slate-200 rounded-lg px-2 py-1 text-xs bg-white",children:[25,50,100,200].map(D=>v.jsx("option",{value:D,children:D},D))}),v.jsx("button",{type:"button",onClick:()=>y(D=>Math.max(1,D-1)),disabled:C<=1,className:"px-3 py-1.5 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 disabled:opacity-40 disabled:hover:bg-white",children:"Anterior"}),v.jsxs("span",{className:"text-xs text-slate-600",children:["Pgina ",C," de ",k]}),v.jsx("button",{type:"button",onClick:()=>y(D=>Math.min(k,D+1)),disabled:C>=k,className:"px-3 py-1.5 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 disabled:opacity-40 disabled:hover:bg-white",children:"Siguiente"})]})]})]})]})]})}function _0({title:e,value:t,icon:r,color:a}){const s={blue:"bg-blue-50 text-blue-600 border-blue-100",red:"bg-red-50 text-red-600 border-red-100",green:"bg-green-50 text-green-600 border-green-100",purple:"bg-purple-50 text-purple-600 border-purple-100"},l=typeof t=="number"?new Intl.NumberFormat("en-US",{minimumFractionDigits:0,maximumFractionDigits:e==="Total Unidades"?2:0}).format(t):t;return v.jsxs("div",{className:"p-6 rounded-2xl border bg-white shadow-sm flex items-center space-x-4",children:[v.jsx("div",{className:`p-4 rounded-xl ${s[a]||s.blue}`,children:v.jsx(r,{size:24})}),v.jsxs("div",{children:[v.jsx("p",{className:"text-sm font-medium text-slate-500",children:e}),v.jsx("p",{className:"text-2xl font-bold text-slate-800",children:l})]})]})}function ME({stats:e,consumptions:t,lowStockItems:r,medicationCategories:a,onViewAllConsumptions:s}){const l=_=>{const b=Number(_);return Number.isFinite(b)?b.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):String(_??"0")},c=_=>String(_??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),[u,h]=Ce.useState("Todas"),d=Ce.useMemo(()=>{const _=new Set;for(const b of a??[]){const w=String(b?.category??"").trim();w&&_.add(w)}return["Todas",...Array.from(_).sort((b,w)=>b.localeCompare(w,"es")),"Sin categora"]},[a]),g=Ce.useMemo(()=>{const _=new Map;for(const b of a??[]){const w=String(b?.siges_code??"").trim(),S=String(b?.category??"").trim();w&&_.set(w,S)}return _},[a]),x=Ce.useMemo(()=>{const _=k=>String(k??"").replace(/\D/g,""),b=k=>{if(!k)return Number.POSITIVE_INFINITY;const C=k.slice(-4),T=Number.parseInt(C,10);return Number.isFinite(T)?T:Number.POSITIVE_INFINITY},w=k=>{if(!u||u==="Todas")return!0;const C=String(k?.siges_code??"").trim(),T=g.get(C)||"";return u==="Sin categora"?!T:T===u},S=(r??[]).filter(w);return S.sort((k,C)=>{const T=_(k?.siges_code),j=_(C?.siges_code),X=T.startsWith("110"),D=j.startsWith("110");if(X!==D)return X?-1:1;const N=b(T),W=b(j);if(N!==W)return N-W;const P=T||String(k?.siges_code??""),re=j||String(C?.siges_code??"");return P.localeCompare(re)}),S},[g,u,r]),y=()=>{const _=new Date().toLocaleString(),b="Medicamentos Agotndose",w=(x??[]).map(C=>{const T=l(C?.computed_min_stock??C?.min_stock),j=l(C?.stock),X=C?._daysToReceipt!=null?String(C._daysToReceipt):"";return`
          <tr>
            <td class="center mono">${c(C?.siges_code||"")}</td>
            <td>
              ${c(C?.name||"")}
            </td>
            <td class="center mono">${c(T)}</td>
            <td class="center mono">${c(j)}</td>
            <td class="center mono">${c(X)}</td>
          </tr>
        `}).join(""),S=`
      <!doctype html>
      <html>
        <head>
          <meta charset="utf-8" />
          <meta name="viewport" content="width=device-width, initial-scale=1" />
          <title>${c(b)}</title>
          <style>
            body { font-family: Arial, sans-serif; padding: 24px; color: #0f172a; }
            h1 { font-size: 18px; margin: 0 0 6px; }
            .meta { font-size: 12px; color: #475569; margin-bottom: 16px; }
            table { width: 100%; border-collapse: collapse; }
            th, td { border: 1px solid #e2e8f0; padding: 8px; font-size: 12px; vertical-align: top; }
            th { background: #f8fafc; text-align: left; }
            .center { text-align: center; white-space: nowrap; }
            .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace; }
            .sub { margin-top: 2px; font-size: 11px; color: #475569; }
            @page { size: A4 landscape; margin: 10mm; }
          </style>
        </head>
        <body>
          <h1>${c(b)}</h1>
          <div class="meta">Generado: ${c(_)}  Categora: ${c(u)}  Filas: ${c((x??[]).length)}</div>
          <table>
            <thead>
              <tr>
                <th class="center">Cdigo SIGES</th>
                <th>Medicamento</th>
                <th class="center">Mnimo</th>
                <th class="center">Actual</th>
                <th class="center">Das a recepcin</th>
              </tr>
            </thead>
            <tbody>
              ${w||'<tr><td colspan="5">Sin resultados.</td></tr>'}
            </tbody>
          </table>
          <script>window.onload = () => window.print();<\/script>
        </body>
      </html>
    `,k=document.createElement("iframe");k.style.position="fixed",k.style.right="0",k.style.bottom="0",k.style.width="0",k.style.height="0",k.style.border="0",k.setAttribute("aria-hidden","true"),k.onload=()=>{try{k.contentWindow?.focus(),k.contentWindow?.print()}finally{window.setTimeout(()=>k.remove(),1e3)}},k.srcdoc=S,document.body.appendChild(k)};return v.jsxs("div",{className:"space-y-8",children:[v.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[v.jsx(_0,{title:"Total Medicamentos",value:e.totalItems,icon:Gy,color:"blue"}),v.jsx(_0,{title:"Stock Crtico",value:e.lowStockCount,icon:nl,color:"red"}),v.jsx(_0,{title:"Total Unidades",value:e.totalStockValue,icon:U0,color:"green"}),v.jsx(_0,{title:"Consumos Recientes",value:e.recentConsumptions,icon:pm,color:"purple"})]}),v.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[v.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[v.jsxs("div",{className:"flex justify-between items-center mb-4",children:[v.jsx("h3",{className:"font-bold text-slate-800",children:"ltimos Consumos"}),v.jsxs("button",{type:"button",onClick:s,className:"text-blue-600 text-sm flex items-center hover:underline",children:["Ver todo ",v.jsx(GS,{size:14})]})]}),v.jsx("div",{className:"space-y-4",children:t.slice(0,5).map(_=>v.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-lg",children:[v.jsxs("div",{className:"flex items-center space-x-3",children:[v.jsx("div",{className:"bg-white p-2 rounded-md shadow-sm border border-slate-100 text-slate-400",children:v.jsx(yE,{size:16})}),v.jsxs("div",{children:[v.jsx("p",{className:"font-semibold text-sm",children:_.medication_name}),v.jsx("p",{className:"text-xs text-slate-500",children:_.siges_code||_.date||""})]})]}),v.jsxs("div",{className:"text-right",children:[v.jsx("p",{className:"text-sm font-bold text-slate-800",children:_.quantity}),v.jsx("p",{className:"text-xs text-slate-500 font-mono",children:_.cost??_.user??""})]})]},_.id))})]}),v.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[v.jsxs("div",{className:"flex justify-between items-center mb-4",children:[v.jsx("h3",{className:"font-bold text-slate-800",children:"Medicamentos Agotndose"}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("select",{value:u,onChange:_=>h(_.target.value),className:"px-3 py-2 rounded-lg bg-white border border-slate-200 text-slate-700 text-xs font-bold hover:bg-slate-50",title:"Filtrar por categora",children:d.map(_=>v.jsx("option",{value:_,children:_},_))}),v.jsxs("button",{type:"button",onClick:y,className:"text-slate-600 text-xs font-bold px-3 py-2 rounded-lg bg-white border border-slate-200 hover:bg-slate-100 flex items-center gap-2",title:"Exportar a PDF (imprimir)",children:[v.jsx(rl,{size:14}),"Exportar PDF"]}),v.jsxs("span",{className:"bg-red-100 text-red-700 text-xs px-2 py-1 rounded-full font-bold",children:[x.length," Alertas"]})]})]}),v.jsx("div",{className:"space-y-4",children:x.length>0?x.map(_=>v.jsx("div",{className:"flex items-center p-3 border-l-4 border-red-500 bg-red-50 rounded-r-lg",children:v.jsxs("div",{children:[v.jsx("p",{className:"font-semibold text-sm text-slate-800",children:_.name}),v.jsx("p",{className:"text-[11px] text-slate-500 font-mono",children:_.siges_code||""}),v.jsxs("p",{className:"text-xs text-slate-500",children:["Mnimo: ",l(_.computed_min_stock??_.min_stock)," | Actual: ",l(_.stock)]})]})},_.id)):v.jsx("div",{className:"text-center py-8",children:v.jsx("p",{className:"text-slate-400 text-sm italic",children:"No hay alertas activas de inventario."})})})]})]})]})}function jE({inventoryType:e,onInventoryTypeChange:t,inventoryStatus:r,fileInputRef:a,onChooseFile:s,onFileChange:l,onDownloadTemplate:c,onRefresh:u,canClear:h,onClearInventory:d,hideNoMovement:g,canToggleHideNoMovement:x,onToggleHideNoMovement:y,hideNoMovement4m:_,canToggleHideNoMovement4m:b,onToggleHideNoMovement4m:w,search:S,onSearchChange:k,items:C,totalItems:T,page:j,pageSize:X,onPageChange:D,onPageSizeChange:N}){const W=String(e||"772"),P=W==="771",re=W==="total",ae=re?"w-[260px] max-w-[260px]":"max-w-[620px]",Q=A=>{const z=Number(A);return Number.isFinite(z)?z.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):String(A??"0")},xe=A=>{const z=String(A??"").trim();if(!z)return"S/N";const I=z.match(/^(\d{4})-(\d{2})-(\d{2})/);if(I)return`${I[3]}/${I[2]}/${I[1]}`;const L=new Date(z);if(!Number.isNaN(L.getTime())){const te=String(L.getDate()).padStart(2,"0"),me=String(L.getMonth()+1).padStart(2,"0"),ge=String(L.getFullYear());return`${te}/${me}/${ge}`}return z},Oe=A=>{if(!A)return"";const z=String(A.batch||"").trim()||"S/N",I=xe(A.expiry_date),L=Q(A.stock);return`${z} (${I}): ${L}`},Ae=A=>{if(!A)return!1;const z=String(A.batch||"").trim(),I=z&&z.toUpperCase()!=="S/N",L=!!String(A.expiry_date||"").trim();return I||L},K=Number(T)||0,le=Number(X)||50,je=Math.max(1,Math.ceil(K/le)),U=Math.min(Math.max(Number(j)||1,1),je),ve=K===0?0:(U-1)*le+1,G=Math.min(U*le,K);return v.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden",children:[v.jsxs("div",{className:"p-4 border-b border-slate-100 bg-slate-50 flex flex-col gap-3",children:[v.jsxs("div",{className:"flex flex-wrap gap-3 items-center justify-between",children:[v.jsx("div",{className:"flex items-center gap-2",children:[{key:"772",label:"Inventario 772"},{key:"771",label:"Inventario 771"},{key:"total",label:"Inventario total"}].map(A=>v.jsx("button",{type:"button",onClick:()=>t?.(A.key),className:`px-3 py-1.5 rounded-lg text-xs font-bold border transition-colors ${W===A.key?"bg-blue-600 text-white border-blue-600":"bg-white text-slate-600 border-slate-200 hover:bg-blue-50 hover:text-blue-700"}`,children:A.label},A.key))}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsxs("button",{type:"button",onClick:u,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 flex items-center gap-2",title:"Sincronizar inventarios",children:[v.jsx(al,{size:14}),"Sincronizar"]}),!re&&v.jsxs("button",{type:"button",onClick:()=>w?.(),disabled:!b,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 flex items-center gap-2 disabled:opacity-40 disabled:hover:bg-white",title:b?"Oculta medicamentos sin consumo en los ltimos 4 meses.":"No hay consumos cargados para filtrar.",children:[_?v.jsx(Jx,{size:14}):v.jsx(Yx,{size:14}),_?"Mostrar sin movimiento":"Ocultar sin movimiento (4 meses)"]}),re&&v.jsxs("button",{type:"button",onClick:()=>y?.(),disabled:!x,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 flex items-center gap-2 disabled:opacity-40 disabled:hover:bg-white",title:x?"Oculta medicamentos sin consumo en los ltimos 4 meses.":"No hay consumos cargados para filtrar.",children:[g?v.jsx(Jx,{size:14}):v.jsx(Yx,{size:14}),g?"Mostrar sin movimiento":"Ocultar sin movimiento (4 meses)"]}),!re&&v.jsxs(v.Fragment,{children:[v.jsx("input",{type:"file",ref:a,onChange:l,accept:P?".xml":".csv",className:"hidden"}),v.jsxs("button",{type:"button",onClick:s,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-blue-50 hover:text-blue-700 flex items-center gap-2",children:[v.jsx(Ki,{size:14}),P?"Cargar XML":"Cargar CSV"]}),v.jsxs("button",{type:"button",onClick:()=>c?.(e),className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 flex items-center gap-2",children:[v.jsx(rl,{size:14}),"Plantilla"]}),v.jsxs("button",{type:"button",onClick:()=>d?.(e),disabled:!h,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-red-200 text-red-600 hover:bg-red-50 flex items-center gap-2 disabled:opacity-40 disabled:hover:bg-white",title:"Eliminar toda la carga de este inventario",children:[v.jsx(xo,{size:14}),"Eliminar carga"]})]})]})]}),r?.message&&v.jsxs("div",{className:`p-3 rounded-lg text-xs flex items-center gap-2 ${r.type==="success"?"bg-green-50 text-green-700 border border-green-100":r.type==="error"?"bg-red-50 text-red-700 border border-red-100":"bg-blue-50 text-blue-700 border border-blue-100"}`,children:[r.type==="success"?v.jsx(eu,{size:16}):v.jsx(nl,{size:16}),v.jsx("span",{children:r.message})]}),v.jsxs("div",{className:"relative w-72",children:[v.jsx(xm,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:18}),v.jsx("input",{type:"text",value:S,onChange:A=>k(A.target.value),placeholder:"Buscar medicamento...",className:"w-full pl-10 pr-4 py-2 border border-slate-200 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 outline-none"})]})]}),v.jsx("div",{className:"overflow-x-auto",children:v.jsxs("table",{className:"min-w-max w-full text-left",children:[v.jsx("thead",{className:"bg-slate-50 text-slate-500 text-[10px] uppercase font-bold",children:v.jsxs("tr",{children:[v.jsx("th",{className:"px-6 py-4 text-center whitespace-nowrap",children:"Cdigo SIGES"}),v.jsx("th",{className:`px-6 py-4 whitespace-nowrap ${ae}`,children:"Medicamento"}),re&&v.jsx("th",{className:"px-6 py-4 text-center whitespace-nowrap",children:"Inv. 772"}),(P||re)&&v.jsx("th",{className:"px-6 py-4 whitespace-nowrap",children:"Lotes 771 (venc. / cant.)"}),re&&v.jsx("th",{className:"px-6 py-4 text-center whitespace-nowrap",children:"Inv. 771"}),v.jsx("th",{className:"px-6 py-4 text-center whitespace-nowrap",children:re?"Inventario total":"Inventario"})]})}),v.jsxs("tbody",{className:"divide-y divide-slate-100",children:[C.map(A=>v.jsxs("tr",{className:"hover:bg-slate-50 transition-colors group text-sm",children:[v.jsx("td",{className:"px-6 py-4 text-slate-700 font-mono text-center whitespace-nowrap",children:A.siges_code||""}),v.jsx("td",{className:`px-6 py-4 ${ae} text-slate-700`,children:v.jsx("span",{className:"block truncate",children:A.name})}),re&&v.jsx("td",{className:"px-6 py-4 text-center whitespace-nowrap text-slate-700 font-mono",children:Q(A.stock772)}),(P||re)&&v.jsx("td",{className:`px-6 py-4 text-slate-600 font-mono ${re?"text-center":""}`,children:v.jsx("div",{className:`flex flex-col gap-1 ${re?"items-center":""}`,children:(()=>{const z=Array.isArray(A.lots)?A.lots:[];if(z.length>0&&z.some(Ae))return z.map(te=>v.jsx("div",{className:"whitespace-nowrap",children:Oe(te)},te.id||`${te.batch}-${te.expiry_date}`));const L=Ae(A);return v.jsx("div",{className:"whitespace-nowrap",children:L?Oe(A):""})})()})}),re&&v.jsx("td",{className:"px-6 py-4 text-center whitespace-nowrap text-slate-700 font-mono",children:Q(A.stock771)}),v.jsx("td",{className:"px-6 py-4 text-center whitespace-nowrap text-slate-800",children:v.jsx("span",{className:"font-bold",children:Q(A.stock)})})]},A.id)),C.length===0&&v.jsx("tr",{children:v.jsxs("td",{colSpan:re?6:P?4:3,className:"px-6 py-10 text-center text-sm text-slate-400",children:['No hay resultados para "',S,'".']})})]})]})}),v.jsxs("div",{className:"p-4 border-t border-slate-100 bg-slate-50 flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[v.jsx("div",{className:"text-xs text-slate-500",children:K===0?"0 resultados":`Mostrando ${ve}-${G} de ${K}`}),v.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[v.jsx("label",{className:"text-xs text-slate-500",children:"Filas"}),v.jsx("select",{value:le,onChange:A=>N?.(Number(A.target.value)||50),className:"border border-slate-200 rounded-lg px-2 py-1 text-xs bg-white",children:[25,50,100,200].map(A=>v.jsx("option",{value:A,children:A},A))}),v.jsx("button",{type:"button",onClick:()=>D?.(U-1),disabled:U<=1,className:"px-3 py-1.5 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 disabled:opacity-40 disabled:hover:bg-white",children:"Anterior"}),v.jsxs("span",{className:"text-xs text-slate-600",children:["Pgina ",U," de ",je]}),v.jsx("button",{type:"button",onClick:()=>D?.(U+1),disabled:U>=je,className:"px-3 py-1.5 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 disabled:opacity-40 disabled:hover:bg-white",children:"Siguiente"})]})]})]})}const Ka=e=>{const t=Number(e);return Number.isFinite(t)?t.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):"0.00"},Vn=e=>String(e??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;");function IE({medications:e}){const[t,r]=Ce.useState(""),[a,s]=Ce.useState(""),[l,c]=Ce.useState(""),u=Ce.useRef(null),h=Ce.useRef(null),[d,g]=Ce.useState([]),[x,y]=Ce.useState(null),_=Ce.useMemo(()=>{const T=new Map;for(const X of e??[]){const D=String(X?.siges_code||"").trim(),N=String(X?.name||"").trim(),W=D?`code:${D.toLowerCase()}`:N?`name:${N.toLowerCase()}`:"";if(!W)continue;const P=T.get(W);P?P.registered+=Number(X?.stock)||0:T.set(W,{key:W,code:D,name:N,registered:Number(X?.stock)||0})}const j=Array.from(T.values());return j.sort((X,D)=>{const N=String(X.code||""),W=String(D.code||""),P=N.localeCompare(W,"es",{numeric:!0,sensitivity:"base"});return P!==0?P:String(X.name||"").localeCompare(String(D.name||""),"es",{numeric:!0,sensitivity:"base"})}),j},[e]),b=T=>{const j=String(T||"").trim();if(!j)return null;const X=_.find(W=>W?`${W.code?`${W.code} - `:""}${W.name}`.trim().toLowerCase()===j.toLowerCase():!1);if(X)return X;const D=j.match(/^([0-9]{3}-[0-9]{2}-[0-9]{4}|[A-Za-z0-9\\-_.]+)\s*-\s*(.+)$/);if(D){const W=String(D[1]||"").trim().toLowerCase(),P=_.find(re=>String(re?.code||"").trim().toLowerCase()===W);if(P)return P}const N=_.find(W=>String(W?.name||"").trim().toLowerCase()===j.toLowerCase());return N||null},w=()=>{r(""),s(""),c(""),window.setTimeout(()=>h.current?.focus(),0)},S=({med:T,physical:j})=>{const X=Number(T?.registered)||0,D=Number(j)||0,N=D-X;return{id:globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():`${Date.now()}-${Math.random().toString(16).slice(2)}`,created_at:new Date().toISOString(),key:T?.key||"",siges_code:T?.code||"",name:T?.name||"",registered:X,physical:D,diff:N}},k=T=>{T?.preventDefault?.(),c("");const j=b(t);if(!j){c("Selecciona un medicamento vlido."),window.setTimeout(()=>h.current?.focus(),0);return}const X=Number.parseFloat(String(a||"").replace(",","."));if(!Number.isFinite(X)){c("Ingresa un inventario fsico vlido."),window.setTimeout(()=>u.current?.focus(),0);return}const D=S({med:j,physical:X});if(Math.abs(Number(D.diff)||0)>1e-9){y(D);return}g(W=>[D,...W]),w()},C=()=>{const T=new Date().toLocaleString(),j="Toma de Inventario",X=(d??[]).slice().reverse().map((W,P)=>`
          <tr>
            <td class="center mono">${Vn(String(P+1))}</td>
            <td class="mono">${Vn(W?.siges_code||"")}</td>
            <td>${Vn(W?.name||"")}</td>
            <td class="center mono">${Vn(Ka(W?.registered))}</td>
            <td class="center mono">${Vn(Ka(W?.physical))}</td>
            <td class="center mono ${Number(W?.diff)===0?"":"diff"}">${Vn(Ka(W?.diff))}</td>
          </tr>
        `).join(""),D=`
      <!doctype html>
      <html>
        <head>
          <meta charset="utf-8" />
          <meta name="viewport" content="width=device-width, initial-scale=1" />
          <title>${Vn(j)}</title>
          <style>
            body { font-family: Arial, sans-serif; padding: 24px; color: #0f172a; }
            h1 { font-size: 18px; margin: 0 0 6px; }
            .meta { font-size: 12px; color: #475569; margin-bottom: 16px; }
            table { width: 100%; border-collapse: collapse; }
            th, td { border: 1px solid #e2e8f0; padding: 8px; font-size: 12px; vertical-align: top; }
            th { background: #f8fafc; text-align: left; }
            .center { text-align: center; white-space: nowrap; }
            .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace; }
            .diff { color: #b91c1c; font-weight: 700; }
            @page { size: A4 portrait; margin: 12mm; }
          </style>
        </head>
        <body>
          <h1>${Vn(j)}</h1>
          <div class="meta">Generado: ${Vn(T)}  Registros: ${Vn(String((d??[]).length))}</div>
          <table>
            <thead>
              <tr>
                <th class="center">#</th>
                <th class="center">Cdigo SIGES</th>
                <th>Medicamento</th>
                <th class="center">Registrado</th>
                <th class="center">Fsico</th>
                <th class="center">Diferencia</th>
              </tr>
            </thead>
            <tbody>
              ${X||'<tr><td colspan="6">Sin registros.</td></tr>'}
            </tbody>
          </table>
          <script>window.onload = () => window.print();<\/script>
        </body>
      </html>
    `,N=document.createElement("iframe");N.style.position="fixed",N.style.right="0",N.style.bottom="0",N.style.width="0",N.style.height="0",N.style.border="0",N.setAttribute("aria-hidden","true"),N.onload=()=>{try{N.contentWindow?.focus(),N.contentWindow?.print()}finally{window.setTimeout(()=>N.remove(),1e3)}},N.srcdoc=D,document.body.appendChild(N)};return v.jsxs("div",{className:"space-y-6",children:[v.jsxs("div",{className:"bg-white p-4 md:p-6 rounded-xl border border-slate-200 shadow-sm",children:[v.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[v.jsxs("div",{children:[v.jsx("h3",{className:"font-bold text-slate-800",children:"Toma de Inventario"}),v.jsx("p",{className:"text-xs text-slate-500",children:"Registra el conteo fsico y compralo con el inventario registrado."})]}),v.jsxs("div",{className:"flex gap-2",children:[v.jsxs("button",{type:"button",onClick:C,disabled:(d??[]).length===0,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 flex items-center gap-2 disabled:opacity-40 disabled:hover:bg-white",title:"Exportar a PDF (imprimir)",children:[v.jsx(rl,{size:14}),"Exportar PDF"]}),v.jsxs("button",{type:"button",onClick:()=>g([]),disabled:(d??[]).length===0,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 flex items-center gap-2 disabled:opacity-40 disabled:hover:bg-white",title:"Limpiar la toma actual",children:[v.jsx(tu,{size:14}),"Limpiar"]})]})]}),v.jsxs("form",{onSubmit:k,className:"mt-4 grid grid-cols-1 md:grid-cols-12 gap-3",children:[v.jsxs("div",{className:"md:col-span-7",children:[v.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase mb-1",children:"Medicamento"}),v.jsx("input",{ref:h,type:"text",list:"inventoryTakeMedications",value:t,onChange:T=>r(T.target.value),placeholder:"Escribe y selecciona el medicamento...",className:"w-full px-3 py-2 border border-slate-200 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 outline-none"}),v.jsx("datalist",{id:"inventoryTakeMedications",children:_.slice(0,500).map(T=>v.jsx("option",{value:`${T.code?`${T.code} - `:""}${T.name}`},T.key))}),v.jsx("p",{className:"mt-1 text-[11px] text-slate-400",children:"Tip: escribe el nombre o el cdigo SIGES."})]}),v.jsxs("div",{className:"md:col-span-3",children:[v.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase mb-1",children:"Inventario fsico"}),v.jsx("input",{ref:u,inputMode:"decimal",type:"text",value:a,onChange:T=>s(T.target.value),placeholder:"0.00",className:"w-full px-3 py-2 border border-slate-200 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 outline-none"})]}),v.jsx("div",{className:"md:col-span-2 flex md:items-end",children:v.jsxs("button",{type:"submit",className:"w-full px-3 py-2 rounded-lg text-xs font-bold bg-blue-600 text-white hover:bg-blue-700 flex items-center justify-center gap-2",children:[v.jsx(uE,{size:14}),"Registrar"]})}),l&&v.jsx("div",{className:"md:col-span-12 text-xs text-red-600 font-bold",children:l})]})]}),v.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden",children:[v.jsxs("div",{className:"p-4 border-b border-slate-100 bg-slate-50 flex items-center justify-between",children:[v.jsx("h4",{className:"font-bold text-slate-700 text-sm",children:"Registros"}),v.jsxs("span",{className:"text-xs text-slate-500",children:[d.length," total"]})]}),d.length===0?v.jsx("div",{className:"p-6 text-sm text-slate-400 italic",children:"An no hay registros en esta toma."}):v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"md:hidden divide-y divide-slate-100",children:d.map(T=>v.jsxs("div",{className:"p-4",children:[v.jsxs("div",{className:"flex items-start justify-between gap-3",children:[v.jsxs("div",{className:"min-w-0",children:[v.jsx("div",{className:"text-xs font-mono text-slate-500",children:T.siges_code||""}),v.jsx("div",{className:"font-semibold text-slate-800 text-sm truncate",children:T.name})]}),v.jsx("div",{className:`text-xs font-bold ${Number(T.diff)===0?"text-green-700":"text-red-700"}`,children:Ka(T.diff)})]}),v.jsxs("div",{className:"mt-2 grid grid-cols-3 gap-2 text-xs text-slate-600",children:[v.jsxs("div",{children:[v.jsx("div",{className:"text-[10px] uppercase font-bold text-slate-400",children:"Registrado"}),v.jsx("div",{className:"font-mono",children:Ka(T.registered)})]}),v.jsxs("div",{children:[v.jsx("div",{className:"text-[10px] uppercase font-bold text-slate-400",children:"Fsico"}),v.jsx("div",{className:"font-mono",children:Ka(T.physical)})]}),v.jsxs("div",{children:[v.jsx("div",{className:"text-[10px] uppercase font-bold text-slate-400",children:"Diferencia"}),v.jsx("div",{className:"font-mono",children:Ka(T.diff)})]})]})]},T.id))}),v.jsx("div",{className:"hidden md:block overflow-x-auto",children:v.jsxs("table",{className:"min-w-max w-full text-left",children:[v.jsx("thead",{className:"bg-slate-50 text-slate-500 text-[10px] uppercase font-bold",children:v.jsxs("tr",{children:[v.jsx("th",{className:"px-6 py-4 text-center whitespace-nowrap",children:"Cdigo SIGES"}),v.jsx("th",{className:"px-6 py-4 whitespace-nowrap",children:"Medicamento"}),v.jsx("th",{className:"px-6 py-4 text-center whitespace-nowrap",children:"Registrado"}),v.jsx("th",{className:"px-6 py-4 text-center whitespace-nowrap",children:"Fsico"}),v.jsx("th",{className:"px-6 py-4 text-center whitespace-nowrap",children:"Diferencia"})]})}),v.jsx("tbody",{className:"divide-y divide-slate-100 text-sm",children:d.map(T=>v.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[v.jsx("td",{className:"px-6 py-4 text-slate-700 font-mono text-center whitespace-nowrap",children:T.siges_code||""}),v.jsx("td",{className:"px-6 py-4 text-slate-700",children:v.jsx("span",{className:"block truncate max-w-[680px]",children:T.name})}),v.jsx("td",{className:"px-6 py-4 text-center whitespace-nowrap text-slate-700 font-mono",children:Ka(T.registered)}),v.jsx("td",{className:"px-6 py-4 text-center whitespace-nowrap text-slate-700 font-mono",children:Ka(T.physical)}),v.jsx("td",{className:`px-6 py-4 text-center whitespace-nowrap font-mono ${Number(T.diff)===0?"text-green-700":"text-red-700 font-bold"}`,children:Ka(T.diff)})]},T.id))})]})})]})]}),x&&v.jsx("div",{className:"fixed inset-0 bg-slate-900/40 flex items-center justify-center p-4 z-50",children:v.jsxs("div",{className:"bg-white w-full max-w-md rounded-2xl shadow-lg border border-slate-200 overflow-hidden",children:[v.jsxs("div",{className:"p-4 border-b border-slate-100",children:[v.jsx("h4",{className:"font-bold text-slate-800",children:"Diferencia detectada"}),v.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Revisa los valores antes de registrar."})]}),v.jsxs("div",{className:"p-4 space-y-3",children:[v.jsx("div",{className:"text-xs font-mono text-slate-500",children:x.siges_code||""}),v.jsx("div",{className:"font-semibold text-slate-800",children:x.name}),v.jsxs("div",{className:"grid grid-cols-3 gap-3 text-sm",children:[v.jsxs("div",{className:"bg-slate-50 border border-slate-100 rounded-lg p-3",children:[v.jsx("div",{className:"text-[10px] uppercase font-bold text-slate-400",children:"Registrado"}),v.jsx("div",{className:"font-mono font-bold text-slate-800",children:Ka(x.registered)})]}),v.jsxs("div",{className:"bg-slate-50 border border-slate-100 rounded-lg p-3",children:[v.jsx("div",{className:"text-[10px] uppercase font-bold text-slate-400",children:"Fsico"}),v.jsx("div",{className:"font-mono font-bold text-slate-800",children:Ka(x.physical)})]}),v.jsxs("div",{className:"bg-red-50 border border-red-100 rounded-lg p-3",children:[v.jsx("div",{className:"text-[10px] uppercase font-bold text-red-400",children:"Diferencia"}),v.jsx("div",{className:"font-mono font-bold text-red-700",children:Ka(x.diff)})]})]})]}),v.jsxs("div",{className:"p-4 border-t border-slate-100 flex gap-2",children:[v.jsx("button",{type:"button",onClick:()=>{y(null),window.setTimeout(()=>u.current?.focus(),0)},className:"flex-1 px-3 py-2 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-700 hover:bg-slate-50",children:"Corregir"}),v.jsx("button",{type:"button",onClick:()=>{g(T=>[x,...T]),y(null),w()},className:"flex-1 px-3 py-2 rounded-lg text-xs font-bold bg-blue-600 text-white hover:bg-blue-700",children:"Continuar"})]})]})})]})}function LE({status:e}){if(!e?.message)return null;const t=e.type==="success"?"bg-emerald-50 border-emerald-200 text-emerald-800":e.type==="error"?"bg-rose-50 border-rose-200 text-rose-800":"bg-blue-50 border-blue-200 text-blue-800";return v.jsx("div",{className:`border rounded-lg px-4 py-3 text-sm ${t}`,children:v.jsx("span",{children:e.message})})}function BE({months:e,selectedMonthId:t,onSelectMonth:r,monthlyStatus:a,fileInputRef:s,onChooseFile:l,onFileChange:c,onDownloadTemplate:u,onRefresh:h}){const d=e.find(y=>y.id===t)||null,g=y=>{const _=typeof y=="number"?y:Number(y);return Number.isFinite(_)?new Intl.NumberFormat("es-CR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(_):""},x=y=>{const _=typeof y=="number"?y:Number(y);return Number.isFinite(_)?new Intl.NumberFormat("es-CR",{style:"currency",currency:"CRC",minimumFractionDigits:2,maximumFractionDigits:2}).format(_):""};return v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-5",children:[v.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[v.jsxs("div",{className:"space-y-1",children:[v.jsx("h3",{className:"font-semibold text-slate-800",children:"Importar consumo mensual"}),v.jsxs("p",{className:"text-xs text-slate-500",children:["Recomendado: nombre del archivo ",v.jsx("span",{className:"font-mono",children:"Enero 2025.csv"})," (se usa como nombre del mes)."]})]}),v.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[v.jsx("input",{type:"file",ref:s,onChange:c,accept:".csv",className:"hidden"}),v.jsxs("button",{type:"button",onClick:u,className:"px-3 py-2 rounded-lg border border-slate-200 text-slate-700 hover:bg-slate-50 text-sm flex items-center gap-2",children:[v.jsx(eE,{size:16}),"Descargar plantilla"]}),v.jsxs("button",{type:"button",onClick:h,className:"px-3 py-2 rounded-lg border border-slate-200 text-slate-700 hover:bg-slate-50 text-sm flex items-center gap-2",children:[v.jsx(al,{size:16}),"Sincronizar"]}),v.jsxs("button",{type:"button",onClick:l,className:"px-3 py-2 rounded-lg bg-blue-600 hover:bg-blue-700 text-white text-sm flex items-center gap-2",children:[v.jsx(Ki,{size:16}),"Importar CSV"]})]})]}),v.jsx("div",{className:"mt-4",children:v.jsx(LE,{status:a})}),v.jsxs("div",{className:"mt-4 flex flex-col gap-2 md:flex-row md:items-center",children:[v.jsx("label",{className:"text-xs font-semibold text-slate-600",children:"Mes cargado"}),v.jsxs("select",{className:"border border-slate-200 rounded-lg px-3 py-2 text-sm bg-white",value:t??"",onChange:y=>r(y.target.value||null),children:[v.jsx("option",{value:"",children:"Seleccione un mes..."}),e.map(y=>v.jsx("option",{value:y.id,children:y.label},y.id))]})]})]}),v.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden",children:[v.jsxs("div",{className:"px-6 py-4 border-b border-slate-100 flex items-center justify-between",children:[v.jsx("h4",{className:"font-semibold text-slate-800",children:d?`Detalle: ${d.label}`:"Detalle del mes"}),d&&v.jsxs("span",{className:"text-xs text-slate-500",children:[d.items.length," registros"]})]}),d?d.items.length===0?v.jsx("div",{className:"p-8 text-center text-slate-500 text-sm",children:"No hay consumos en este mes."}):v.jsxs("table",{className:"w-full text-left",children:[v.jsx("thead",{className:"bg-slate-50 text-slate-500 text-[10px] uppercase font-bold",children:v.jsxs("tr",{children:[v.jsx("th",{className:"px-6 py-4 whitespace-nowrap w-32 text-center",children:"Cdigo SIGES"}),v.jsx("th",{className:"px-6 py-4",children:"Medicamento"}),v.jsx("th",{className:"px-6 py-4 text-center whitespace-nowrap",children:"Consumo"}),v.jsx("th",{className:"px-6 py-4 text-center whitespace-nowrap",children:"Costo"})]})}),v.jsx("tbody",{className:"divide-y divide-slate-100",children:d.items.map(y=>v.jsxs("tr",{className:"hover:bg-slate-50",children:[v.jsx("td",{className:"px-6 py-4 text-xs text-slate-500 font-mono whitespace-nowrap w-32 text-center",children:y.siges_code||""}),v.jsx("td",{className:"px-6 py-4 text-sm font-medium",children:y.medication_name}),v.jsx("td",{className:"px-6 py-4 text-center text-slate-800 font-semibold text-sm tabular-nums",children:g(y.quantity)}),v.jsx("td",{className:"px-6 py-4 text-center text-slate-700 text-sm font-mono tabular-nums",children:x(y.cost)})]},y.id))})]}):v.jsx("div",{className:"p-8 text-center text-slate-500 text-sm",children:"Importa un CSV y selecciona un mes para ver el detalle."})]})]})}function qn(e){const t=typeof e=="number"?e:Number(String(e??"").trim().replace(/\s/g,"").replace(/,/g,""));return Number.isFinite(t)?t:0}function ei(e){const t=qn(e);return new Intl.NumberFormat("es-CR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(t)}function Xy(e){return e.length?e.reduce((t,r)=>t+r,0)/e.length:0}function UE(e){if(e.length<=1)return 0;const t=Xy(e),r=e.reduce((a,s)=>a+(s-t)**2,0)/e.length;return Math.sqrt(r)}function PE({siges_code:e,medication_name:t}){const r=String(e??"").trim();if(r)return`code:${r}`;const a=String(t??"").trim().toLowerCase();return a?`name:${a}`:""}function tv(e){const t=String(e||"").replace(/\D/g,"");return t.length<4?Number.POSITIVE_INFINITY:Number.parseInt(t.slice(-4),10)}function rv(e){return String(e||"").trim().startsWith("110")}function av(e,t){const r=String(e??""),a=Math.max(0,Number(t)||0);return!a||r.length<=a?r:`${r.slice(0,a)}`}function nv({status:e}){if(!e?.message)return null;const t=e.type==="success"?"bg-emerald-50 border-emerald-200 text-emerald-800":e.type==="error"?"bg-rose-50 border-rose-200 text-rose-800":"bg-blue-50 border-blue-200 text-blue-800";return v.jsx("div",{className:`border rounded-lg px-4 py-3 text-sm ${t}`,children:v.jsx("span",{children:e.message})})}function zE({medications:e,months:t,tertiaryPackaging:r,medicationCategories:a,inventoryStatus:s,monthlyStatus:l,onRefreshInventories:c,onRefreshConsumptions:u}){const[h,d]=Ce.useState(2),[g,x]=Ce.useState(""),[y,_]=Ce.useState(!0),[b,w]=Ce.useState("Todas"),[S,k]=Ce.useState(0),[C,T]=Ce.useState(50),[j,X]=Ce.useState(1),D=Ce.useMemo(()=>{const U=(t??[]).slice(0,3),ve=U.map(me=>String(me?.label??"").trim()).filter(Boolean),G=new Map;for(const me of a??[]){const ge=String(me?.siges_code??"").trim();if(!ge)continue;const pe=String(me?.category??"").trim();pe&&G.set(ge,pe)}const A=new Map;for(const me of r??[]){const ge=String(me?.siges_code??"").trim();if(!ge)continue;const pe=qn(me?.tertiary_quantity);pe>0&&A.set(ge,pe)}const z=new Map;for(const me of e??[]){const ge=String(me?.siges_code??"").trim();if(!ge)continue;const pe=String(me?.inventory_type||"772"),Ee=z.get(ge)??{inv771:0,inv772:0};pe==="771"&&(Ee.inv771+=qn(me?.stock)),pe==="772"&&(Ee.inv772+=qn(me?.stock)),z.set(ge,Ee)}const I=new Map;U.forEach((me,ge)=>{const pe=me?.items??[];for(const Ee of pe){const et=String(Ee?.siges_code??"").trim(),q=String(Ee?.medication_name??"").trim(),vt=PE({siges_code:et,medication_name:q});if(!vt)continue;const nt=I.get(vt)??{siges_code:et,medication_name:q,perMonth:[0,0,0]};nt.siges_code=nt.siges_code||et,nt.medication_name=nt.medication_name||q,nt.perMonth[ge]+=qn(Ee?.quantity),I.set(vt,nt)}});const L=Math.max(0,Number(h)||0),te=Array.from(I.values()).map(me=>{const ge=me.perMonth.slice(0,3),pe=Xy(ge),Ee=UE(ge),et=pe+Ee,q=String(me.siges_code??"").trim(),vt=z.get(q)??{inv771:0,inv772:0},nt=qn(vt.inv771)+qn(vt.inv772),kt=et*L-nt,gt=Math.max(0,kt),Re=A.get(q)??0,jt=Re>0?gt===0?0:Math.ceil(gt/Re)*Re:gt,sr=G.get(q)??"";return{siges_code:q,medication_name:me.medication_name,consumoTotal:et,invTotal:nt,empaqueTerciario:Re,pedido:jt,category:sr}});return{monthLabels:ve,rows:te}},[a,e,t,h,r]),N=D.monthLabels??[],W=Ce.useMemo(()=>{const U=g.trim().toLowerCase(),ve=D.rows??[],G=y?ve.filter(L=>qn(L.pedido)>0):ve,A=b==="Todas"?G:b==="Sin categora"?G.filter(L=>!String(L.category||"").trim()):G.filter(L=>String(L.category||"").trim()===b),z=S>0?A.filter(L=>{const te=qn(L.consumoTotal);return te<=0?!1:qn(L.invTotal)*30/te<=S}):A;return(U?z.filter(L=>`${L.siges_code} ${L.medication_name}`.toLowerCase().includes(U)):z).sort((L,te)=>{const me=L?.siges_code||"",ge=te?.siges_code||"",pe=rv(me),Ee=rv(ge);if(pe!==Ee)return pe?-1:1;const et=tv(me),q=tv(ge);return et!==q?et-q:String(me).localeCompare(String(ge),"es",{numeric:!0,sensitivity:"base"})})},[b,D.rows,S,y,g]),P=W.length,re=Math.max(1,Number(C)||50),ae=Math.max(1,Math.ceil(P/re)),Q=Math.min(Math.max(j,1),ae),xe=P===0?0:(Q-1)*re+1,Oe=Math.min(Q*re,P),Ae=Ce.useMemo(()=>{const U=(Q-1)*re;return W.slice(U,U+re)},[W,Q,re]),K=Ce.useMemo(()=>{const U=new Set;for(const ve of a??[]){const G=String(ve?.category??"").trim();G&&U.add(G)}return["Todas",...Array.from(U).sort((ve,G)=>ve.localeCompare(G,"es")),"Sin categora"]},[a]),le=Ce.useMemo(()=>[{value:0,label:"Cobertura: todas"},{value:15,label:"Cobertura:  15 das"},{value:30,label:"Cobertura:  30 das"},{value:45,label:"Cobertura:  45 das"},{value:60,label:"Cobertura:  60 das"},{value:90,label:"Cobertura:  90 das"}],[]),je=()=>{const U=new Date,ve=`${String(U.getDate()).padStart(2,"0")}/${String(U.getMonth()+1).padStart(2,"0")}/${U.getFullYear()}`,G="Solicitud Pedido (filtrado)",A=N.length?N.slice().reverse().join(", "):"Sin datos",z=b||"Todas",I=S>0?`<= ${S} dias`:"Todas",L=pe=>String(pe??"").replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;"),te=W.map(pe=>{const Ee=L(pe.siges_code),et=L(av(pe.medication_name,50)),q=L(ei(pe.consumoTotal)),vt=L(ei(pe.invTotal)),nt=pe.empaqueTerciario?L(ei(pe.empaqueTerciario)):"",kt=L(ei(pe.pedido));return`<tr>
          <td class="mono center">${Ee}</td>
          <td>${et}</td>
          <td class="mono right">${q}</td>
          <td class="mono right">${vt}</td>
          <td class="mono right">${nt}</td>
          <td class="mono right strong">${kt}</td>
        </tr>`}).join(""),me=`<!doctype html>
 <html>
   <head>
     <meta charset="utf-8" />
     <title>${L(G)}</title>
     <style>
      @page { size: A4 landscape; margin: 12mm; }
      body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; color: #0f172a; }
      h1 { font-size: 16px; margin: 0 0 4px; }
      .meta { font-size: 12px; color: #475569; margin-bottom: 10px; }
      table { width: 100%; border-collapse: collapse; font-size: 11px; }
      th, td { border: 1px solid #e2e8f0; padding: 6px 8px; vertical-align: top; }
      th { background: #f8fafc; text-transform: uppercase; font-size: 10px; letter-spacing: .04em; }
      .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace; }
      .center { text-align: center; }
      .right { text-align: right; }
      .strong { font-weight: 700; color: #1d4ed8; }
    </style>
  </head>
  <body>
    <h1>${L(G)}</h1>
    <div class="meta">Generado: ${L(ve)}  Meses usados: ${L(A)}  Meses a pedir: ${L(h)}  Categora: ${L(z)}  Cobertura: ${L(I)}  Filas: ${L(W.length)}</div>
    <table>
      <thead>
        <tr>
          <th>Cdigo</th>
          <th>Medicamento</th>
          <th>Consumo total</th>
          <th>Inventario total</th>
          <th>Empaque terciario</th>
          <th>Pedido</th>
        </tr>
      </thead>
      <tbody>${te||""}</tbody>
    </table>
   </body>
 </html>`,ge=document.createElement("iframe");ge.style.position="fixed",ge.style.right="0",ge.style.bottom="0",ge.style.width="0",ge.style.height="0",ge.style.border="0",ge.setAttribute("aria-hidden","true"),ge.onload=()=>{try{ge.contentWindow?.focus(),ge.contentWindow?.print()}finally{window.setTimeout(()=>ge.remove(),1e3)}},ge.srcdoc=me,document.body.appendChild(ge)};return v.jsxs("div",{className:"space-y-6",children:[v.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-5",children:[v.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[v.jsxs("div",{className:"space-y-1",children:[v.jsx("h3",{className:"font-semibold text-slate-800",children:"Solicitud Pedido"}),v.jsx("p",{className:"text-xs text-slate-500",children:"Pedido = (Consumo total  Meses)  (Inventario total). Consumo total = Promedio + Desv. Est. Inventario total = Inv. 772 + Inv. 771."})]}),v.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[v.jsxs("button",{type:"button",onClick:()=>{u?.(),c?.()},className:"px-3 py-2 rounded-lg border border-slate-200 text-slate-700 hover:bg-slate-50 text-sm flex items-center gap-2",children:[v.jsx(al,{size:16}),"Sincronizar"]}),v.jsxs("button",{type:"button",onClick:je,className:"px-3 py-2 rounded-lg border border-slate-200 text-slate-700 hover:bg-slate-50 text-sm flex items-center gap-2",title:"Exporta lo filtrado usando la impresora del navegador (Guardar como PDF).",children:[v.jsx(rl,{size:16}),"Exportar PDF"]})]})]}),v.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-3 gap-3",children:[v.jsxs("div",{className:"md:col-span-1",children:[v.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase mb-1",children:"Meses a pedir"}),v.jsx("input",{type:"number",min:0,step:1,value:h,onChange:U=>{d(Number(U.target.value)||0),X(1)},className:"w-full border border-slate-200 rounded-lg px-3 py-2 text-sm bg-white"})]}),v.jsxs("div",{className:"md:col-span-2 flex flex-col gap-2",children:[v.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase mb-1",children:"Filtros"}),v.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[v.jsx("select",{value:b,onChange:U=>{w(U.target.value),X(1)},className:"border border-slate-200 rounded-lg px-3 py-2 text-sm bg-white",title:"Filtrar por categora",children:K.map(U=>v.jsx("option",{value:U,children:U},U))}),v.jsx("select",{value:S,onChange:U=>{k(Number(U.target.value)||0),X(1)},className:"border border-slate-200 rounded-lg px-3 py-2 text-sm bg-white",title:"Filtrar por cobertura (das)",children:le.map(U=>v.jsx("option",{value:U.value,children:U.label},U.value))}),v.jsx("button",{type:"button",onClick:()=>{_(U=>!U),X(1)},className:"px-3 py-2 rounded-lg border border-slate-200 text-slate-700 hover:bg-slate-50 text-sm",children:y?"Mostrar pedido 0":"Ocultar pedido 0"}),v.jsx("input",{value:g,onChange:U=>{x(U.target.value),X(1)},placeholder:"Buscar por cdigo o medicamento...",className:"flex-1 min-w-72 border border-slate-200 rounded-lg px-3 py-2 text-sm bg-white"})]})]})]}),v.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-3",children:[v.jsx(nv,{status:s}),v.jsx(nv,{status:l})]})]}),v.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm overflow-hidden",children:[v.jsxs("div",{className:"p-4 border-b border-slate-100 bg-slate-50 flex items-center justify-between",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("div",{className:"bg-blue-50 text-blue-600 p-2 rounded-lg",children:v.jsx(pm,{size:18})}),v.jsxs("div",{children:[v.jsx("h3",{className:"font-bold text-slate-800",children:"Clculo por medicamento"}),v.jsxs("p",{className:"text-xs text-slate-500",children:["Meses usados: ",N.length?N.slice().reverse().join(", "):"Sin datos"]})]})]}),v.jsxs("span",{className:"text-xs text-slate-500",children:[P," filas"]})]}),v.jsx("div",{className:"overflow-auto max-h-[70vh]",children:v.jsxs("table",{className:"w-full min-w-[860px] text-left",children:[v.jsx("thead",{className:"sticky top-0 z-10 bg-slate-50 text-slate-500 text-[10px] uppercase font-bold shadow-sm",children:v.jsxs("tr",{children:[v.jsx("th",{className:"px-4 py-4 whitespace-nowrap w-36 text-center",children:"Cdigo"}),v.jsx("th",{className:"px-4 py-4 whitespace-nowrap",children:"Medicamento"}),v.jsx("th",{className:"px-3 py-4 text-center whitespace-nowrap w-40",children:"Consumo total"}),v.jsx("th",{className:"px-3 py-4 text-center whitespace-nowrap w-40",children:"Inventario total"}),v.jsx("th",{className:"px-3 py-4 text-center whitespace-nowrap w-40",children:"Empaque terciario"}),v.jsx("th",{className:"px-3 py-4 text-center whitespace-nowrap w-40",children:"Pedido"})]})}),v.jsxs("tbody",{className:"divide-y divide-slate-100",children:[Ae.map((U,ve)=>v.jsxs("tr",{className:"hover:bg-slate-50",children:[v.jsx("td",{className:"px-4 py-4 text-xs text-slate-600 font-mono whitespace-nowrap text-center",children:U.siges_code||""}),v.jsx("td",{className:"px-4 py-4 text-sm font-medium text-slate-700 whitespace-normal break-words",title:U.medication_name,children:av(U.medication_name,50)}),v.jsx("td",{className:"px-3 py-4 text-center font-mono text-sm tabular-nums",children:ei(U.consumoTotal)}),v.jsx("td",{className:"px-3 py-4 text-center font-mono text-sm tabular-nums",children:ei(U.invTotal)}),v.jsx("td",{className:"px-3 py-4 text-center font-mono text-sm tabular-nums",children:U.empaqueTerciario?ei(U.empaqueTerciario):""}),v.jsx("td",{className:"px-3 py-4 text-center font-mono text-sm font-bold text-blue-700 tabular-nums",children:ei(U.pedido)})]},`${U.siges_code||U.medication_name}-${ve}`)),Ae.length===0&&v.jsx("tr",{children:v.jsx("td",{colSpan:6,className:"px-6 py-10 text-center text-sm text-slate-400",children:"No hay resultados."})})]})]})}),v.jsxs("div",{className:"p-4 border-t border-slate-100 bg-slate-50 flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[v.jsx("div",{className:"text-xs text-slate-500",children:P===0?"0 resultados":`Mostrando ${xe}-${Oe} de ${P}`}),v.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[v.jsx("label",{className:"text-xs text-slate-500",children:"Filas"}),v.jsx("select",{value:re,onChange:U=>{T(Number(U.target.value)||50),X(1)},className:"border border-slate-200 rounded-lg px-2 py-1 text-xs bg-white",children:[25,50,100,200].map(U=>v.jsx("option",{value:U,children:U},U))}),v.jsx("button",{type:"button",onClick:()=>X(U=>Math.max(1,U-1)),disabled:Q<=1,className:"px-3 py-1.5 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 disabled:opacity-40 disabled:hover:bg-white",children:"Anterior"}),v.jsxs("span",{className:"text-xs text-slate-600",children:["Pgina ",Q," de ",ae]}),v.jsx("button",{type:"button",onClick:()=>X(U=>Math.min(ae,U+1)),disabled:Q>=ae,className:"px-3 py-1.5 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 disabled:opacity-40 disabled:hover:bg-white",children:"Siguiente"})]})]})]})]})}function HE({status:e,fileInputRef:t,onChooseFile:r,onFileChange:a,onDownloadTemplate:s,onRefresh:l,canClear:c,onClear:u,onEdit:h,search:d,onSearchChange:g,items:x,totalItems:y,page:_,pageSize:b,onPageChange:w,onPageSizeChange:S}){const[k,C]=Ce.useState(null),[T,j]=Ce.useState(""),[X,D]=Ce.useState(""),N=U=>{const ve=Number(U);return Number.isFinite(ve)?ve.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):String(U??"0")},W=!!h,P=Ce.useMemo(()=>W,[W]),re=U=>{U&&(C(U),j(String(U.medication_name||"").trim()),D(String(U.tertiary_quantity??"").trim()))},ae=()=>{C(null),j(""),D("")},Q=async()=>{if(!k)return;const U=Number(String(X??"").trim().replace(/\s/g,"").replace(/,/g,""));await h?.({...k,medication_name:T,tertiary_quantity:Number.isFinite(U)?U:0}),ae()},xe=Number(y)||0,Oe=Number(b)||50,Ae=Math.max(1,Math.ceil(xe/Oe)),K=Math.min(Math.max(Number(_)||1,1),Ae),le=xe===0?0:(K-1)*Oe+1,je=Math.min(K*Oe,xe);return v.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden",children:[v.jsxs("div",{className:"p-4 border-b border-slate-100 bg-slate-50 flex flex-col gap-3",children:[v.jsxs("div",{className:"flex flex-wrap gap-3 items-center justify-between",children:[v.jsxs("div",{className:"relative w-80",children:[v.jsx(xm,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:18}),v.jsx("input",{type:"text",value:d,onChange:U=>g?.(U.target.value),placeholder:"Buscar por cdigo o medicamento...",className:"w-full pl-10 pr-4 py-2 border border-slate-200 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 outline-none"})]}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("input",{type:"file",ref:t,onChange:a,accept:".xlsx",className:"hidden"}),v.jsxs("button",{type:"button",onClick:l,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 flex items-center gap-2",title:"Sincronizar empaque terciario",children:[v.jsx(al,{size:14}),"Sincronizar"]}),v.jsxs("button",{type:"button",onClick:r,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-blue-50 hover:text-blue-700 flex items-center gap-2",children:[v.jsx(Ki,{size:14}),"Cargar XLSX"]}),v.jsxs("button",{type:"button",onClick:s,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 flex items-center gap-2",children:[v.jsx(rl,{size:14}),"Plantilla"]}),v.jsxs("button",{type:"button",onClick:u,disabled:!c,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-red-200 text-red-600 hover:bg-red-50 flex items-center gap-2 disabled:opacity-40 disabled:hover:bg-white",title:"Eliminar toda la carga",children:[v.jsx(xo,{size:14}),"Eliminar carga"]})]})]}),e?.message&&v.jsxs("div",{className:`p-3 rounded-lg text-xs flex items-center gap-2 ${e.type==="success"?"bg-green-50 text-green-700 border border-green-100":e.type==="error"?"bg-red-50 text-red-700 border border-red-100":"bg-blue-50 text-blue-700 border border-blue-100"}`,children:[e.type==="success"?v.jsx(eu,{size:16}):v.jsx(nl,{size:16}),v.jsx("span",{children:e.message})]})]}),v.jsx("div",{className:"overflow-x-auto",children:v.jsxs("table",{className:"min-w-max w-full text-left",children:[v.jsx("thead",{className:"bg-slate-50 text-slate-500 text-[10px] uppercase font-bold",children:v.jsxs("tr",{children:[v.jsx("th",{className:"px-6 py-4 text-center whitespace-nowrap",children:"Cdigo SIGES"}),v.jsx("th",{className:"px-6 py-4 whitespace-nowrap",children:"Medicamento"}),v.jsx("th",{className:"px-6 py-4 text-center whitespace-nowrap",children:"Empaque terciario"}),P&&v.jsx("th",{className:"px-6 py-4 text-center whitespace-nowrap",children:"Acciones"})]})}),v.jsxs("tbody",{className:"divide-y divide-slate-100",children:[x.map(U=>v.jsxs("tr",{className:"hover:bg-slate-50 transition-colors group text-sm",children:[v.jsx("td",{className:"px-6 py-4 text-slate-700 font-mono text-center whitespace-nowrap",children:U.siges_code}),v.jsx("td",{className:"px-6 py-4 text-slate-700 max-w-[520px]",children:v.jsx("span",{className:"block truncate",children:U.medication_name})}),v.jsx("td",{className:"px-6 py-4 text-center whitespace-nowrap text-slate-800 font-mono",children:N(U.tertiary_quantity)}),P&&v.jsx("td",{className:"px-6 py-4 text-center whitespace-nowrap",children:v.jsx("button",{type:"button",onClick:()=>re(U),className:"p-2 rounded-lg border border-slate-200 text-slate-600 hover:bg-slate-100",title:"Editar",children:v.jsx(Vy,{size:16})})})]},U.id)),x.length===0&&v.jsx("tr",{children:v.jsxs("td",{colSpan:P?4:3,className:"px-6 py-10 text-center text-sm text-slate-400",children:['No hay resultados para "',d,'".']})})]})]})}),k&&v.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 p-4",children:v.jsxs("div",{className:"w-full max-w-lg rounded-xl bg-white border border-slate-200 shadow-xl overflow-hidden",children:[v.jsxs("div",{className:"p-4 border-b border-slate-100 bg-slate-50 flex items-center justify-between",children:[v.jsxs("div",{children:[v.jsx("div",{className:"text-sm font-bold text-slate-800",children:"Editar empaque terciario"}),v.jsx("div",{className:"text-xs text-slate-500 font-mono",children:k.siges_code})]}),v.jsx("button",{type:"button",onClick:ae,className:"p-2 rounded-lg text-slate-500 hover:bg-slate-100",title:"Cerrar",children:v.jsx(tu,{size:18})})]}),v.jsxs("div",{className:"p-4 space-y-3",children:[v.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase",children:"Medicamento"}),v.jsx("input",{value:T,onChange:U=>j(U.target.value),className:"w-full border border-slate-200 rounded-lg px-3 py-2 text-sm",placeholder:"Nombre del medicamento"}),v.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase",children:"Empaque terciario"}),v.jsx("input",{type:"number",step:"0.01",min:"0",value:X,onChange:U=>D(U.target.value),className:"w-full border border-slate-200 rounded-lg px-3 py-2 text-sm",placeholder:"0.00"})]}),v.jsxs("div",{className:"p-4 border-t border-slate-100 bg-slate-50 flex items-center justify-end gap-2",children:[v.jsx("button",{type:"button",onClick:ae,className:"px-3 py-2 rounded-lg border border-slate-200 text-slate-700 hover:bg-white text-sm",children:"Cancelar"}),v.jsx("button",{type:"button",onClick:Q,className:"px-3 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 text-sm font-bold",children:"Guardar"})]})]})}),v.jsxs("div",{className:"p-4 border-t border-slate-100 bg-slate-50 flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[v.jsx("div",{className:"text-xs text-slate-500",children:xe===0?"0 resultados":`Mostrando ${le}-${je} de ${xe}`}),v.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[v.jsx("label",{className:"text-xs text-slate-500",children:"Filas"}),v.jsx("select",{value:Oe,onChange:U=>S?.(Number(U.target.value)||50),className:"border border-slate-200 rounded-lg px-2 py-1 text-xs bg-white",children:[25,50,100,200].map(U=>v.jsx("option",{value:U,children:U},U))}),v.jsx("button",{type:"button",onClick:()=>w?.(K-1),disabled:K<=1,className:"px-3 py-1.5 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 disabled:opacity-40 disabled:hover:bg-white",children:"Anterior"}),v.jsxs("span",{className:"text-xs text-slate-600",children:["Pgina ",K," de ",Ae]}),v.jsx("button",{type:"button",onClick:()=>w?.(K+1),disabled:K>=Ae,className:"px-3 py-1.5 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 disabled:opacity-40 disabled:hover:bg-white",children:"Siguiente"})]})]})]})}const Kl=["Ordinario","Fro","Estupefaciente","Psicotrpico","Alcohol","Suero","Compra Local"];function $E({status:e,fileInputRef:t,onChooseFile:r,onFileChange:a,onDownloadTemplate:s,onRefresh:l,canClear:c,onClear:u,onEdit:h,onDelete:d,search:g,onSearchChange:x,items:y,totalItems:_,page:b,pageSize:w,onPageChange:S,onPageSizeChange:k}){const[C,T]=Ce.useState(null),[j,X]=Ce.useState(Kl[0]),[D,N]=Ce.useState(""),W=!!h,P=!!d,re=ve=>{if(!ve)return;T(ve),N(String(ve.medication_name||"").trim());const G=String(ve.category||"").trim();X(Kl.includes(G)?G:Kl[0])},ae=()=>{T(null),N(""),X(Kl[0])},Q=async()=>{C&&(await h?.({...C,medication_name:D,category:j}),ae())},xe=Number(_)||0,Oe=Number(w)||50,Ae=Math.max(1,Math.ceil(xe/Oe)),K=Math.min(Math.max(Number(b)||1,1),Ae),le=xe===0?0:(K-1)*Oe+1,je=Math.min(K*Oe,xe),U=Ce.useMemo(()=>W||P,[P,W]);return v.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden",children:[v.jsxs("div",{className:"p-4 border-b border-slate-100 bg-slate-50 flex flex-col gap-3",children:[v.jsxs("div",{className:"flex flex-wrap gap-3 items-center justify-between",children:[v.jsxs("div",{className:"relative w-80",children:[v.jsx(xm,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:18}),v.jsx("input",{type:"text",value:g,onChange:ve=>x?.(ve.target.value),placeholder:"Buscar por cdigo o medicamento...",className:"w-full pl-10 pr-4 py-2 border border-slate-200 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 outline-none"})]}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("input",{type:"file",ref:t,onChange:a,accept:".xlsx",className:"hidden"}),v.jsxs("button",{type:"button",onClick:l,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 flex items-center gap-2",title:"Sincronizar categoras",children:[v.jsx(al,{size:14}),"Sincronizar"]}),v.jsxs("button",{type:"button",onClick:r,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-blue-50 hover:text-blue-700 flex items-center gap-2",children:[v.jsx(Ki,{size:14}),"Cargar XLSX"]}),v.jsxs("button",{type:"button",onClick:s,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 flex items-center gap-2",children:[v.jsx(rl,{size:14}),"Plantilla"]}),v.jsxs("button",{type:"button",onClick:u,disabled:!c,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-red-200 text-red-600 hover:bg-red-50 flex items-center gap-2 disabled:opacity-40 disabled:hover:bg-white",title:"Eliminar toda la carga",children:[v.jsx(xo,{size:14}),"Eliminar carga"]})]})]}),v.jsxs("div",{className:"text-[11px] text-slate-500",children:["Categoras permitidas: ",Kl.join(", "),"."]}),e?.message&&v.jsxs("div",{className:`p-3 rounded-lg text-xs flex items-center gap-2 ${e.type==="success"?"bg-green-50 text-green-700 border border-green-100":e.type==="error"?"bg-red-50 text-red-700 border border-red-100":"bg-blue-50 text-blue-700 border border-blue-100"}`,children:[e.type==="success"?v.jsx(eu,{size:16}):v.jsx(nl,{size:16}),v.jsx("span",{children:e.message})]})]}),v.jsx("div",{className:"overflow-x-auto",children:v.jsxs("table",{className:"min-w-max w-full text-left",children:[v.jsx("thead",{className:"bg-slate-50 text-slate-500 text-[10px] uppercase font-bold",children:v.jsxs("tr",{children:[v.jsx("th",{className:"px-6 py-4 text-center whitespace-nowrap",children:"Cdigo"}),v.jsx("th",{className:"px-6 py-4 whitespace-nowrap",children:"Medicamento"}),v.jsx("th",{className:"px-6 py-4 text-center whitespace-nowrap",children:"Categora"}),U&&v.jsx("th",{className:"px-6 py-4 text-center whitespace-nowrap",children:"Acciones"})]})}),v.jsxs("tbody",{className:"divide-y divide-slate-100",children:[y.map(ve=>v.jsxs("tr",{className:"hover:bg-slate-50 transition-colors group text-sm",children:[v.jsx("td",{className:"px-6 py-4 text-slate-700 font-mono text-center whitespace-nowrap",children:ve.siges_code}),v.jsx("td",{className:"px-6 py-4 text-slate-700 max-w-[520px]",children:v.jsx("span",{className:"block truncate",children:ve.medication_name})}),v.jsx("td",{className:"px-6 py-4 text-center whitespace-nowrap text-slate-800 font-mono",children:ve.category}),U&&v.jsx("td",{className:"px-6 py-4 text-center whitespace-nowrap",children:v.jsxs("div",{className:"flex items-center justify-center gap-2",children:[W&&v.jsx("button",{type:"button",onClick:()=>re(ve),className:"p-2 rounded-lg border border-slate-200 text-slate-600 hover:bg-slate-100",title:"Editar",children:v.jsx(Vy,{size:16})}),P&&v.jsx("button",{type:"button",onClick:()=>d?.(ve),className:"p-2 rounded-lg border border-red-200 text-red-600 hover:bg-red-50",title:"Eliminar",children:v.jsx(xo,{size:16})})]})})]},ve.id)),y.length===0&&v.jsx("tr",{children:v.jsxs("td",{colSpan:U?4:3,className:"px-6 py-10 text-center text-sm text-slate-400",children:['No hay resultados para "',g,'".']})})]})]})}),C&&v.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 p-4",children:v.jsxs("div",{className:"w-full max-w-lg rounded-xl bg-white border border-slate-200 shadow-xl overflow-hidden",children:[v.jsxs("div",{className:"p-4 border-b border-slate-100 bg-slate-50 flex items-center justify-between",children:[v.jsxs("div",{children:[v.jsx("div",{className:"text-sm font-bold text-slate-800",children:"Editar categora"}),v.jsx("div",{className:"text-xs text-slate-500 font-mono",children:C.siges_code})]}),v.jsx("button",{type:"button",onClick:ae,className:"p-2 rounded-lg text-slate-500 hover:bg-slate-100",title:"Cerrar",children:v.jsx(tu,{size:18})})]}),v.jsxs("div",{className:"p-4 space-y-3",children:[v.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase",children:"Medicamento"}),v.jsx("input",{value:D,onChange:ve=>N(ve.target.value),className:"w-full border border-slate-200 rounded-lg px-3 py-2 text-sm",placeholder:"Nombre del medicamento"}),v.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase",children:"Categora"}),v.jsx("select",{value:j,onChange:ve=>X(ve.target.value),className:"w-full border border-slate-200 rounded-lg px-3 py-2 text-sm bg-white",children:Kl.map(ve=>v.jsx("option",{value:ve,children:ve},ve))})]}),v.jsxs("div",{className:"p-4 border-t border-slate-100 bg-slate-50 flex items-center justify-end gap-2",children:[v.jsx("button",{type:"button",onClick:ae,className:"px-3 py-2 rounded-lg border border-slate-200 text-slate-700 hover:bg-white text-sm",children:"Cancelar"}),v.jsx("button",{type:"button",onClick:Q,className:"px-3 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 text-sm font-bold",children:"Guardar"})]})]})}),v.jsxs("div",{className:"p-4 border-t border-slate-100 bg-slate-50 flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[v.jsx("div",{className:"text-xs text-slate-500",children:xe===0?"0 resultados":`Mostrando ${le}-${je} de ${xe}`}),v.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[v.jsx("label",{className:"text-xs text-slate-500",children:"Filas"}),v.jsx("select",{value:Oe,onChange:ve=>k?.(Number(ve.target.value)||50),className:"border border-slate-200 rounded-lg px-2 py-1 text-xs bg-white",children:[25,50,100,200].map(ve=>v.jsx("option",{value:ve,children:ve},ve))}),v.jsx("button",{type:"button",onClick:()=>S?.(K-1),disabled:K<=1,className:"px-3 py-1.5 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 disabled:opacity-40 disabled:hover:bg-white",children:"Anterior"}),v.jsxs("span",{className:"text-xs text-slate-600",children:["Pgina ",K," de ",Ae]}),v.jsx("button",{type:"button",onClick:()=>S?.(K+1),disabled:K>=Ae,className:"px-3 py-1.5 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 disabled:opacity-40 disabled:hover:bg-white",children:"Siguiente"})]})]})]})}const VE=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"];function GE(e){const t=String(e??"").trim();if(!t)return"";const r=t.slice(0,10);return/^\d{4}-\d{2}-\d{2}$/.test(r)?r:""}function qE({status:e,entries:t,onRefresh:r,onSave:a}){const s=new Date().getFullYear(),[l,c]=Ce.useState(s),[u,h]=Ce.useState(()=>Array.from({length:12},()=>"")),[d,g]=Ce.useState(!1),[x,y]=Ce.useState(!1),_=Ce.useMemo(()=>{const S=new Set([s,s+1]);for(const k of t??[]){const C=Number(k?.year);Number.isFinite(C)&&C>0&&S.add(C)}return Array.from(S).sort((k,C)=>C-k)},[s,t]),b=Ce.useMemo(()=>{const S=new Map;for(const k of t??[]){const C=Number(k?.year)||0,T=Number(k?.month)||0;!C||T<1||T>12||S.set(`${C}-${T}`,k)}return S},[t]);Ce.useEffect(()=>{_.includes(l)||c(_[0]??s)},[_.join(","),l]),Ce.useEffect(()=>{const S=Array.from({length:12},(k,C)=>{const T=b.get(`${l}-${C+1}`);return GE(T?.scheduled_receipt_date)});h(S),y(!1)},[b,l]);const w=async()=>{if(!(!a||d)){g(!0);try{const S=Array.from({length:12},(k,C)=>({year:l,month:C+1,scheduled_receipt_date:u[C]?String(u[C]):null}));await a(S),y(!1)}finally{g(!1)}}};return v.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden",children:[v.jsxs("div",{className:"p-4 border-b border-slate-100 bg-slate-50 flex flex-col gap-3",children:[v.jsxs("div",{className:"flex flex-wrap gap-3 items-center justify-between",children:[v.jsx("div",{className:"flex items-center gap-3",children:v.jsxs("div",{children:[v.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase mb-1",children:"Ao"}),v.jsx("select",{value:l,onChange:S=>c(Number(S.target.value)||s),className:"border border-slate-200 rounded-lg px-3 py-2 text-sm bg-white",children:_.map(S=>v.jsx("option",{value:S,children:S},S))})]})}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsxs("button",{type:"button",onClick:r,className:"px-3 py-2 rounded-lg text-xs font-bold bg-white border border-slate-200 text-slate-600 hover:bg-slate-100 flex items-center gap-2",title:"Sincronizar calendario",children:[v.jsx(al,{size:14}),"Sincronizar"]}),v.jsxs("button",{type:"button",onClick:w,disabled:!x||d,className:"px-3 py-2 rounded-lg text-xs font-bold bg-blue-600 text-white hover:bg-blue-700 flex items-center gap-2 disabled:opacity-40 disabled:hover:bg-blue-600",title:"Guardar cambios",children:[v.jsx(dE,{size:14}),"Guardar"]})]})]}),e?.message&&v.jsxs("div",{className:`p-3 rounded-lg text-xs flex items-center gap-2 ${e.type==="success"?"bg-green-50 text-green-700 border border-green-100":e.type==="error"?"bg-red-50 text-red-700 border border-red-100":"bg-blue-50 text-blue-700 border border-blue-100"}`,children:[e.type==="success"?v.jsx(eu,{size:16}):v.jsx(nl,{size:16}),v.jsx("span",{children:e.message})]})]}),v.jsx("div",{className:"overflow-x-auto",children:v.jsxs("table",{className:"min-w-max w-full text-left",children:[v.jsx("thead",{className:"bg-slate-50 text-slate-500 text-[10px] uppercase font-bold",children:v.jsxs("tr",{children:[v.jsx("th",{className:"px-6 py-4 whitespace-nowrap",children:"Mes"}),v.jsx("th",{className:"px-6 py-4 whitespace-nowrap",children:"Recepcin programada"})]})}),v.jsx("tbody",{className:"divide-y divide-slate-100",children:VE.map((S,k)=>v.jsxs("tr",{className:"hover:bg-slate-50 transition-colors text-sm",children:[v.jsx("td",{className:"px-6 py-4 text-slate-700 whitespace-nowrap",children:S}),v.jsx("td",{className:"px-6 py-4 text-slate-700 whitespace-nowrap",children:v.jsx("input",{type:"date",value:u[k]??"",onChange:C=>{const T=C.target.value;h(j=>{const X=[...j];return X[k]=T,X}),y(!0)},className:"border border-slate-200 rounded-lg px-3 py-2 text-sm bg-white"})})]},S))})]})})]})}function XE(e){return e.replace(/^\uFEFF/,"")}function WE(e){const t=(e.match(/,/g)||[]).length;return(e.match(/;/g)||[]).length>t?";":","}function Wy(e){const t=XE(e).replace(/\r\n/g,`
`).replace(/\r/g,`
`),r=[];let a=[],s="",l=!1,c=0;const u=t.split(`
`)[0]||"",h=WE(u);for(;c<t.length;){const g=t[c];if(l){if(g==='"'){if(t[c+1]==='"'){s+='"',c+=2;continue}l=!1,c+=1;continue}s+=g,c+=1;continue}if(g==='"'){l=!0,c+=1;continue}if(g===h){a.push(s),s="",c+=1;continue}if(g===`
`){a.push(s),s="",a.every(y=>String(y||"").trim()==="")||r.push(a),a=[],c+=1;continue}s+=g,c+=1}return a.push(s),a.every(g=>String(g||"").trim()==="")||r.push(a),{rows:r,delimiter:h}}function sv(e){const{rows:t}=Wy(e);return t}function KE(e){return String(e||"").trim().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]/g,"")}function YE(e){const t={nombre:"Nombre",name:"Nombre",categoria:"Categoria",category:"Categoria",codigosiges:"CodigoSIGES",codsiges:"CodigoSIGES",siges:"CodigoSIGES",codigosicop:"IdentificadorSICOP",identificadorsicop:"IdentificadorSICOP",identificac:"IdentificadorSICOP",identificador:"IdentificadorSICOP",idsicop:"IdentificadorSICOP",clasificadorsicop:"ClasificadorSICOP",clasificador:"ClasificadorSICOP",sicopclasificador:"ClasificadorSICOP",sicopidentificador:"IdentificadorSICOP",medicamento:"Medicamento",descripcionsicop:"Medicamento",descripcion:"Medicamento",lote:"Lote",batch:"Lote",vencimiento:"Vencimiento",expirydate:"Vencimiento",inventario:"Stock",existencia:"Stock",saldo:"Stock",stock:"Stock",stockminimo:"StockMinimo",minstock:"StockMinimo",unidad:"Unidad",unit:"Unidad",producto:"Medicamento",item:"Medicamento",cantidad:"Cantidad",consumo:"Cantidad",salida:"Cantidad",responsable:"Responsable",usuario:"Responsable",user:"Responsable",motivo:"Motivo",destino:"Motivo",observacion:"Motivo",fecha:"Fecha",fechahora:"Fecha",date:"Fecha"};return e.map(r=>t[KE(r)]||String(r||"").trim())}function w0(e){if(e instanceof Date&&!Number.isNaN(e.getTime()))return e.toISOString().slice(0,10);const t=String(e??"").trim();if(!t)return new Date().toISOString().slice(0,10);const r=t.slice(0,10);if(/^\d{4}-\d{2}-\d{2}$/.test(r))return r;const a=new Date(t);return Number.isNaN(a.getTime())?new Date().toISOString().slice(0,10):a.toISOString().slice(0,10)}function vo(e,t){const r=String(e??"");return r.includes('"')||r.includes(`
`)||r.includes("\r")||r.includes(t)?`"${r.replace(/"/g,'""')}"`:r}function JE(){const t=["CodigoSIGES","ClasificadorSICOP","IdentificadorSICOP","Medicamento","Categoria","Lote","Vencimiento","Stock","StockMinimo","Unidad"],r=["SIG-0001","SICOP-CL-01","SICOP-ID-0001","Paracetamol","Analgsico","LOT-2025-01","2027-12-31",100,20,"Tabletas"],s=`\uFEFF${[t.map(h=>vo(h,";")).join(";"),r.map(h=>vo(h,";")).join(";")].join(`
`)}
`,l=new Blob([s],{type:"text/csv;charset=utf-8"}),c=URL.createObjectURL(l),u=document.createElement("a");u.href=c,u.download="plantilla_catalogo.csv",document.body.appendChild(u),u.click(),u.remove(),URL.revokeObjectURL(c)}function QE(){const t=["CodigoSIGES","Medicamento","Consumo","Costo"],r=["110-16-0010","Paracetamol",1555.85,148621015e-2],s=`\uFEFF${[t.map(h=>vo(h,";")).join(";"),r.map(h=>vo(h,";")).join(";")].join(`
`)}
`,l=new Blob([s],{type:"text/csv;charset=utf-8"}),c=URL.createObjectURL(l),u=document.createElement("a");u.href=c,u.download="plantilla_consumo_mensual.csv",document.body.appendChild(u),u.click(),u.remove(),URL.revokeObjectURL(c)}function wd(e){const{rows:t}=Wy(e);if(t.length===0)return[];const r=t[0],a=YE(r);return t.slice(1).map(l=>{const c={};for(let u=0;u<a.length;u+=1){const h=a[u];h&&(c[h]=l[u]??"")}return c})}function ZE(e){const t=String(e||"772").trim()||"772",r=";",a=["CodigoSIGES","ClasificadorSICOP","IdentificadorSICOP","Medicamento","Categoria","Lote","Vencimiento","Stock","StockMinimo","Unidad"],s=["SIG-0001","SICOP-CL-01","SICOP-ID-0001","Paracetamol","General","LOT-2025-01","2027-12-31",100,20,"Tabletas"],c=`\uFEFF${[a.map(g=>vo(g,r)).join(r),s.map(g=>vo(g,r)).join(r)].join(`
`)}
`,u=new Blob([c],{type:"text/csv;charset=utf-8"}),h=URL.createObjectURL(u),d=document.createElement("a");d.href=h,d.download=`plantilla_inventario_${t}.csv`,document.body.appendChild(d),d.click(),d.remove(),URL.revokeObjectURL(h)}function eT(e){const t=String(e||"771").trim()||"771",r=`<?xml version="1.0" encoding="UTF-8"?>
<Inventario tipo="${t}">
  <Item>
    <CodigoSIGES>110-16-0010</CodigoSIGES>
    <Medicamento>Paracetamol</Medicamento>
    <Lote>LOT-2025-01</Lote>
    <Vencimiento>2027-12-31</Vencimiento>
    <Inventario>100</Inventario>
  </Item>
</Inventario>
`,a=new Blob([r],{type:"application/xml;charset=utf-8"}),s=URL.createObjectURL(a),l=document.createElement("a");l.href=s,l.download=`plantilla_inventario_${t}.xml`,document.body.appendChild(l),l.click(),l.remove(),URL.revokeObjectURL(s)}function nf(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,a=Object.getOwnPropertySymbols(e);s<a.length;s++)t.indexOf(a[s])<0&&Object.prototype.propertyIsEnumerable.call(e,a[s])&&(r[a[s]]=e[a[s]]);return r}function tT(e,t,r,a){function s(l){return l instanceof r?l:new r(function(c){c(l)})}return new(r||(r=Promise))(function(l,c){function u(g){try{d(a.next(g))}catch(x){c(x)}}function h(g){try{d(a.throw(g))}catch(x){c(x)}}function d(g){g.done?l(g.value):s(g.value).then(u,h)}d((a=a.apply(e,t||[])).next())})}const rT=e=>e?(...t)=>e(...t):(...t)=>fetch(...t);class vm extends Error{constructor(t,r="FunctionsError",a){super(t),this.name=r,this.context=a}}class aT extends vm{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class iv extends vm{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class lv extends vm{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Xd;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(Xd||(Xd={}));class nT{constructor(t,{headers:r={},customFetch:a,region:s=Xd.Any}={}){this.url=t,this.headers=r,this.region=s,this.fetch=rT(a)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return tT(this,arguments,void 0,function*(r,a={}){var s;let l,c;try{const{headers:u,method:h,body:d,signal:g,timeout:x}=a;let y={},{region:_}=a;_||(_=this.region);const b=new URL(`${this.url}/${r}`);_&&_!=="any"&&(y["x-region"]=_,b.searchParams.set("forceFunctionRegion",_));let w;d&&(u&&!Object.prototype.hasOwnProperty.call(u,"Content-Type")||!u)?typeof Blob<"u"&&d instanceof Blob||d instanceof ArrayBuffer?(y["Content-Type"]="application/octet-stream",w=d):typeof d=="string"?(y["Content-Type"]="text/plain",w=d):typeof FormData<"u"&&d instanceof FormData?w=d:(y["Content-Type"]="application/json",w=JSON.stringify(d)):w=d;let S=g;x&&(c=new AbortController,l=setTimeout(()=>c.abort(),x),g?(S=c.signal,g.addEventListener("abort",()=>c.abort())):S=c.signal);const k=yield this.fetch(b.toString(),{method:h||"POST",headers:Object.assign(Object.assign(Object.assign({},y),this.headers),u),body:w,signal:S}).catch(X=>{throw new aT(X)}),C=k.headers.get("x-relay-error");if(C&&C==="true")throw new iv(k);if(!k.ok)throw new lv(k);let T=((s=k.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),j;return T==="application/json"?j=yield k.json():T==="application/octet-stream"||T==="application/pdf"?j=yield k.blob():T==="text/event-stream"?j=k:T==="multipart/form-data"?j=yield k.formData():j=yield k.text(),{data:j,error:null,response:k}}catch(u){return{data:null,error:u,response:u instanceof lv||u instanceof iv?u.context:void 0}}finally{l&&clearTimeout(l)}})}}var sT=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}},iT=class{constructor(e){var t,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(t=e.shouldThrowOnError)!==null&&t!==void 0?t:!1,this.signal=e.signal,this.isMaybeSingle=(r=e.isMaybeSingle)!==null&&r!==void 0?r:!1,e.fetch?this.fetch=e.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){var r=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const a=this.fetch;let s=a(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async l=>{let c=null,u=null,h=null,d=l.status,g=l.statusText;if(l.ok){var x,y;if(r.method!=="HEAD"){var _;const k=await l.text();k===""||(r.headers.get("Accept")==="text/csv"||r.headers.get("Accept")&&(!((_=r.headers.get("Accept"))===null||_===void 0)&&_.includes("application/vnd.pgrst.plan+text"))?u=k:u=JSON.parse(k))}const w=(x=r.headers.get("Prefer"))===null||x===void 0?void 0:x.match(/count=(exact|planned|estimated)/),S=(y=l.headers.get("content-range"))===null||y===void 0?void 0:y.split("/");w&&S&&S.length>1&&(h=parseInt(S[1])),r.isMaybeSingle&&r.method==="GET"&&Array.isArray(u)&&(u.length>1?(c={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,h=null,d=406,g="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{var b;const w=await l.text();try{c=JSON.parse(w),Array.isArray(c)&&l.status===404&&(u=[],c=null,d=200,g="OK")}catch{l.status===404&&w===""?(d=204,g="No Content"):c={message:w}}if(c&&r.isMaybeSingle&&(!(c==null||(b=c.details)===null||b===void 0)&&b.includes("0 rows"))&&(c=null,d=200,g="OK"),c&&r.shouldThrowOnError)throw new sT(c)}return{error:c,data:u,count:h,status:d,statusText:g}});return this.shouldThrowOnError||(s=s.catch(l=>{var c;let u="";const h=l?.cause;if(h){var d,g,x,y;const b=(d=h?.message)!==null&&d!==void 0?d:"",w=(g=h?.code)!==null&&g!==void 0?g:"";u=`${(x=l?.name)!==null&&x!==void 0?x:"FetchError"}: ${l?.message}`,u+=`

Caused by: ${(y=h?.name)!==null&&y!==void 0?y:"Error"}: ${b}`,w&&(u+=` (${w})`),h?.stack&&(u+=`
${h.stack}`)}else{var _;u=(_=l?.stack)!==null&&_!==void 0?_:""}return{error:{message:`${(c=l?.name)!==null&&c!==void 0?c:"FetchError"}: ${l?.message}`,details:u,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),s.then(e,t)}returns(){return this}overrideTypes(){return this}},lT=class extends iT{select(e){let t=!1;const r=(e??"*").split("").map(a=>/\s/.test(a)&&!t?"":(a==='"'&&(t=!t),a)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:a,referencedTable:s=a}={}){const l=s?`${s}.order`:"order",c=this.url.searchParams.get(l);return this.url.searchParams.set(l,`${c?`${c},`:""}${e}.${t?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const a=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(a,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:a=r}={}){const s=typeof a>"u"?"offset":`${a}.offset`,l=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(s,`${e}`),this.url.searchParams.set(l,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:a=!1,wal:s=!1,format:l="text"}={}){var c;const u=[e?"analyze":null,t?"verbose":null,r?"settings":null,a?"buffers":null,s?"wal":null].filter(Boolean).join("|"),h=(c=this.headers.get("Accept"))!==null&&c!==void 0?c:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${l}; for="${h}"; options=${u};`),l==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};const ov=new RegExp("[,()]");var so=class extends lT{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}regexMatch(e,t){return this.url.searchParams.append(e,`match.${t}`),this}regexIMatch(e,t){return this.url.searchParams.append(e,`imatch.${t}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}isDistinct(e,t){return this.url.searchParams.append(e,`isdistinct.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map(a=>typeof a=="string"&&ov.test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}notIn(e,t){const r=Array.from(new Set(t)).map(a=>typeof a=="string"&&ov.test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(e,`not.in.(${r})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:a}={}){let s="";a==="plain"?s="pl":a==="phrase"?s="ph":a==="websearch"&&(s="w");const l=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${s}fts${l}.${t}`),this}match(e){return Object.entries(e).forEach(([t,r])=>{this.url.searchParams.append(t,`eq.${r}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const a=r?`${r}.or`:"or";return this.url.searchParams.append(a,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}},oT=class{constructor(e,{headers:t={},schema:r,fetch:a}){this.url=e,this.headers=new Headers(t),this.schema=r,this.fetch=a}select(e,t){const{head:r=!1,count:a}=t??{},s=r?"HEAD":"GET";let l=!1;const c=(e??"*").split("").map(u=>/\s/.test(u)&&!l?"":(u==='"'&&(l=!l),u)).join("");return this.url.searchParams.set("select",c),a&&this.headers.append("Prefer",`count=${a}`),new so({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(e,{count:t,defaultToNull:r=!0}={}){var a;const s="POST";if(t&&this.headers.append("Prefer",`count=${t}`),r||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const l=e.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(l.length>0){const c=[...new Set(l)].map(u=>`"${u}"`);this.url.searchParams.set("columns",c.join(","))}}return new so({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:a,defaultToNull:s=!0}={}){var l;const c="POST";if(this.headers.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),t!==void 0&&this.url.searchParams.set("on_conflict",t),a&&this.headers.append("Prefer",`count=${a}`),s||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const u=e.reduce((h,d)=>h.concat(Object.keys(d)),[]);if(u.length>0){const h=[...new Set(u)].map(d=>`"${d}"`);this.url.searchParams.set("columns",h.join(","))}}return new so({method:c,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}update(e,{count:t}={}){var r;const a="PATCH";return t&&this.headers.append("Prefer",`count=${t}`),new so({method:a,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:e}={}){var t;const r="DELETE";return e&&this.headers.append("Prefer",`count=${e}`),new so({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}},cT=class Ky{constructor(t,{headers:r={},schema:a,fetch:s}={}){this.url=t,this.headers=new Headers(r),this.schemaName=a,this.fetch=s}from(t){if(!t||typeof t!="string"||t.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new oT(new URL(`${this.url}/${t}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new Ky(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:a=!1,get:s=!1,count:l}={}){var c;let u;const h=new URL(`${this.url}/rpc/${t}`);let d;a||s?(u=a?"HEAD":"GET",Object.entries(r).filter(([x,y])=>y!==void 0).map(([x,y])=>[x,Array.isArray(y)?`{${y.join(",")}}`:`${y}`]).forEach(([x,y])=>{h.searchParams.append(x,y)})):(u="POST",d=r);const g=new Headers(this.headers);return l&&g.set("Prefer",`count=${l}`),new so({method:u,url:h,headers:g,schema:this.schemaName,body:d,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}};class uT{constructor(){}static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const a=r.node,s=parseInt(a.replace(/^v/,"").split(".")[0]);return s>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${s} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const a=this.getWebSocketConstructor();return new a(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const fT="2.89.0",hT=`realtime-js/${fT}`,Yy="1.0.0",dT="2.0.0",cv=Yy,Wd=1e4,mT=1e3,gT=100;var ai;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(ai||(ai={}));var Pr;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Pr||(Pr={}));var Dn;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Dn||(Dn={}));var Kd;(function(e){e.websocket="websocket"})(Kd||(Kd={}));var Pi;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Pi||(Pi={}));class pT{constructor(t){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=t??[]}encode(t,r){if(t.event===this.BROADCAST_EVENT&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(t));let a=[t.join_ref,t.ref,t.topic,t.event,t.payload];return r(JSON.stringify(a))}_binaryEncodeUserBroadcastPush(t){var r;return this._isArrayBuffer((r=t.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var r,a;const s=(a=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&a!==void 0?a:new ArrayBuffer(0);return this._encodeUserBroadcastPush(t,this.BINARY_ENCODING,s)}_encodeJsonUserBroadcastPush(t){var r,a;const s=(a=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&a!==void 0?a:{},c=new TextEncoder().encode(JSON.stringify(s)).buffer;return this._encodeUserBroadcastPush(t,this.JSON_ENCODING,c)}_encodeUserBroadcastPush(t,r,a){var s,l;const c=t.topic,u=(s=t.ref)!==null&&s!==void 0?s:"",h=(l=t.join_ref)!==null&&l!==void 0?l:"",d=t.payload.event,g=this.allowedMetadataKeys?this._pick(t.payload,this.allowedMetadataKeys):{},x=Object.keys(g).length===0?"":JSON.stringify(g);if(h.length>255)throw new Error(`joinRef length ${h.length} exceeds maximum of 255`);if(u.length>255)throw new Error(`ref length ${u.length} exceeds maximum of 255`);if(c.length>255)throw new Error(`topic length ${c.length} exceeds maximum of 255`);if(d.length>255)throw new Error(`userEvent length ${d.length} exceeds maximum of 255`);if(x.length>255)throw new Error(`metadata length ${x.length} exceeds maximum of 255`);const y=this.USER_BROADCAST_PUSH_META_LENGTH+h.length+u.length+c.length+d.length+x.length,_=new ArrayBuffer(this.HEADER_LENGTH+y);let b=new DataView(_),w=0;b.setUint8(w++,this.KINDS.userBroadcastPush),b.setUint8(w++,h.length),b.setUint8(w++,u.length),b.setUint8(w++,c.length),b.setUint8(w++,d.length),b.setUint8(w++,x.length),b.setUint8(w++,r),Array.from(h,k=>b.setUint8(w++,k.charCodeAt(0))),Array.from(u,k=>b.setUint8(w++,k.charCodeAt(0))),Array.from(c,k=>b.setUint8(w++,k.charCodeAt(0))),Array.from(d,k=>b.setUint8(w++,k.charCodeAt(0))),Array.from(x,k=>b.setUint8(w++,k.charCodeAt(0)));var S=new Uint8Array(_.byteLength+a.byteLength);return S.set(new Uint8Array(_),0),S.set(new Uint8Array(a),_.byteLength),S.buffer}decode(t,r){if(this._isArrayBuffer(t)){let a=this._binaryDecode(t);return r(a)}if(typeof t=="string"){const a=JSON.parse(t),[s,l,c,u,h]=a;return r({join_ref:s,ref:l,topic:c,event:u,payload:h})}return r({})}_binaryDecode(t){const r=new DataView(t),a=r.getUint8(0),s=new TextDecoder;if(a===this.KINDS.userBroadcast)return this._decodeUserBroadcast(t,r,s)}_decodeUserBroadcast(t,r,a){const s=r.getUint8(1),l=r.getUint8(2),c=r.getUint8(3),u=r.getUint8(4);let h=this.HEADER_LENGTH+4;const d=a.decode(t.slice(h,h+s));h=h+s;const g=a.decode(t.slice(h,h+l));h=h+l;const x=a.decode(t.slice(h,h+c));h=h+c;const y=t.slice(h,t.byteLength),_=u===this.JSON_ENCODING?JSON.parse(a.decode(y)):y,b={type:this.BROADCAST_EVENT,event:g,payload:_};return c>0&&(b.meta=JSON.parse(x)),{join_ref:null,ref:null,topic:d,event:this.BROADCAST_EVENT,payload:b}}_isArrayBuffer(t){var r;return t instanceof ArrayBuffer||((r=t?.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(t,r){return!t||typeof t!="object"?{}:Object.fromEntries(Object.entries(t).filter(([a])=>r.includes(a)))}}class Jy{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var ir;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(ir||(ir={}));const uv=(e,t,r={})=>{var a;const s=(a=r.skipTypes)!==null&&a!==void 0?a:[];return t?Object.keys(t).reduce((l,c)=>(l[c]=xT(c,e,t,s),l),{}):{}},xT=(e,t,r,a)=>{const s=t.find(u=>u.name===e),l=s?.type,c=r[e];return l&&!a.includes(l)?Qy(l,c):Yd(c)},Qy=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return wT(t,r)}switch(e){case ir.bool:return vT(t);case ir.float4:case ir.float8:case ir.int2:case ir.int4:case ir.int8:case ir.numeric:case ir.oid:return yT(t);case ir.json:case ir.jsonb:return _T(t);case ir.timestamp:return bT(t);case ir.abstime:case ir.date:case ir.daterange:case ir.int4range:case ir.int8range:case ir.money:case ir.reltime:case ir.text:case ir.time:case ir.timestamptz:case ir.timetz:case ir.tsrange:case ir.tstzrange:return Yd(t);default:return Yd(t)}},Yd=e=>e,vT=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},yT=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},_T=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e},wT=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,a=e[r];if(e[0]==="{"&&a==="}"){let l;const c=e.slice(1,r);try{l=JSON.parse("["+c+"]")}catch{l=c?c.split(","):[]}return l.map(u=>Qy(t,u))}return e},bT=e=>typeof e=="string"?e.replace(" ","T"):e,Zy=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class bd{constructor(t,r,a={},s=Wd){this.channel=t,this.event=r,this.payload=a,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var a;return this._hasReceived(t)&&r((a=this.receivedResp)===null||a===void 0?void 0:a.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(a=>a.status===t).forEach(a=>a.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var fv;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(fv||(fv={}));class Ec{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const a=r?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(a.state,{},s=>{const{onJoin:l,onLeave:c,onSync:u}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Ec.syncState(this.state,s,l,c),this.pendingDiffs.forEach(h=>{this.state=Ec.syncDiff(this.state,h,l,c)}),this.pendingDiffs=[],u()}),this.channel._on(a.diff,{},s=>{const{onJoin:l,onLeave:c,onSync:u}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Ec.syncDiff(this.state,s,l,c),u())}),this.onJoin((s,l,c)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:l,newPresences:c})}),this.onLeave((s,l,c)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:l,leftPresences:c})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,a,s){const l=this.cloneDeep(t),c=this.transformState(r),u={},h={};return this.map(l,(d,g)=>{c[d]||(h[d]=g)}),this.map(c,(d,g)=>{const x=l[d];if(x){const y=g.map(S=>S.presence_ref),_=x.map(S=>S.presence_ref),b=g.filter(S=>_.indexOf(S.presence_ref)<0),w=x.filter(S=>y.indexOf(S.presence_ref)<0);b.length>0&&(u[d]=b),w.length>0&&(h[d]=w)}else u[d]=g}),this.syncDiff(l,{joins:u,leaves:h},a,s)}static syncDiff(t,r,a,s){const{joins:l,leaves:c}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return a||(a=()=>{}),s||(s=()=>{}),this.map(l,(u,h)=>{var d;const g=(d=t[u])!==null&&d!==void 0?d:[];if(t[u]=this.cloneDeep(h),g.length>0){const x=t[u].map(_=>_.presence_ref),y=g.filter(_=>x.indexOf(_.presence_ref)<0);t[u].unshift(...y)}a(u,g,h)}),this.map(c,(u,h)=>{let d=t[u];if(!d)return;const g=h.map(x=>x.presence_ref);d=d.filter(x=>g.indexOf(x.presence_ref)<0),t[u]=d,s(u,d,h),d.length===0&&delete t[u]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(a=>r(a,t[a]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,a)=>{const s=t[a];return"metas"in s?r[a]=s.metas.map(l=>(l.presence_ref=l.phx_ref,delete l.phx_ref,delete l.phx_ref_prev,l)):r[a]=s,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var hv;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(hv||(hv={}));var Tc;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(Tc||(Tc={}));var ys;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(ys||(ys={}));class co{constructor(t,r={config:{}},a){var s,l;if(this.topic=t,this.params=r,this.socket=a,this.bindings={},this.state=Pr.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new bd(this,Dn.join,this.params,this.timeout),this.rejoinTimer=new Jy(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Pr.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(c=>c.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Pr.closed,this.socket._remove(this)}),this._onError(c=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,c),this.state=Pr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Pr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",c=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,c),this.state=Pr.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Dn.reply,{},(c,u)=>{this._trigger(this._replyEventName(u),c)}),this.presence=new Ec(this),this.broadcastEndpointURL=Zy(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((l=(s=this.params.config)===null||s===void 0?void 0:s.broadcast)===null||l===void 0)&&l.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var a,s,l;if(this.socket.isConnected()||this.socket.connect(),this.state==Pr.closed){const{config:{broadcast:c,presence:u,private:h}}=this.params,d=(s=(a=this.bindings.postgres_changes)===null||a===void 0?void 0:a.map(_=>_.filter))!==null&&s!==void 0?s:[],g=!!this.bindings[Tc.PRESENCE]&&this.bindings[Tc.PRESENCE].length>0||((l=this.params.config.presence)===null||l===void 0?void 0:l.enabled)===!0,x={},y={broadcast:c,presence:Object.assign(Object.assign({},u),{enabled:g}),postgres_changes:d,private:h};this.socket.accessTokenValue&&(x.access_token=this.socket.accessTokenValue),this._onError(_=>t?.(ys.CHANNEL_ERROR,_)),this._onClose(()=>t?.(ys.CLOSED)),this.updateJoinPayload(Object.assign({config:y},x)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:_})=>{var b;if(this.socket._isManualToken()||this.socket.setAuth(),_===void 0){t?.(ys.SUBSCRIBED);return}else{const w=this.bindings.postgres_changes,S=(b=w?.length)!==null&&b!==void 0?b:0,k=[];for(let C=0;C<S;C++){const T=w[C],{filter:{event:j,schema:X,table:D,filter:N}}=T,W=_&&_[C];if(W&&W.event===j&&co.isFilterValueEqual(W.schema,X)&&co.isFilterValueEqual(W.table,D)&&co.isFilterValueEqual(W.filter,N))k.push(Object.assign(Object.assign({},T),{id:W.id}));else{this.unsubscribe(),this.state=Pr.errored,t?.(ys.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=k,t&&t(ys.SUBSCRIBED);return}}).receive("error",_=>{this.state=Pr.errored,t?.(ys.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(_).join(", ")||"error")))}).receive("timeout",()=>{t?.(ys.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,a){return this.state===Pr.joined&&t===Tc.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(t,r,a)}async httpSend(t,r,a={}){var s;if(r==null)return Promise.reject("Payload is required for httpSend()");const l={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(l.Authorization=`Bearer ${this.socket.accessTokenValue}`);const c={method:"POST",headers:l,body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:r,private:this.private}]})},u=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(s=a.timeout)!==null&&s!==void 0?s:this.timeout);if(u.status===202)return{success:!0};let h=u.statusText;try{const d=await u.json();h=d.error||d.message||h}catch{}return Promise.reject(new Error(h))}async send(t,r={}){var a,s;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:l,payload:c}=t,u={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(u.Authorization=`Bearer ${this.socket.accessTokenValue}`);const h={method:"POST",headers:u,body:JSON.stringify({messages:[{topic:this.subTopic,event:l,payload:c,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,h,(a=r.timeout)!==null&&a!==void 0?a:this.timeout);return await((s=d.body)===null||s===void 0?void 0:s.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(l=>{var c,u,h;const d=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((h=(u=(c=this.params)===null||c===void 0?void 0:c.config)===null||u===void 0?void 0:u.broadcast)===null||h===void 0)&&h.ack)&&l("ok"),d.receive("ok",()=>l("ok")),d.receive("error",()=>l("error")),d.receive("timeout",()=>l("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Pr.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Dn.close,"leave",this._joinRef())};this.joinPush.destroy();let a=null;return new Promise(s=>{a=new bd(this,Dn.leave,{},t),a.receive("ok",()=>{r(),s("ok")}).receive("timeout",()=>{r(),s("timed out")}).receive("error",()=>{s("error")}),a.send(),this._canPush()||a.trigger("ok",{})}).finally(()=>{a?.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Pr.closed,this.bindings={}}async _fetchWithTimeout(t,r,a){const s=new AbortController,l=setTimeout(()=>s.abort(),a),c=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:s.signal}));return clearTimeout(l),c}_push(t,r,a=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new bd(this,t,r,a);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>gT){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,a){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,a){var s,l;const c=t.toLocaleLowerCase(),{close:u,error:h,leave:d,join:g}=Dn;if(a&&[u,h,d,g].indexOf(c)>=0&&a!==this._joinRef())return;let y=this._onMessage(c,r,a);if(r&&!y)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(c)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(_=>{var b,w,S;return((b=_.filter)===null||b===void 0?void 0:b.event)==="*"||((S=(w=_.filter)===null||w===void 0?void 0:w.event)===null||S===void 0?void 0:S.toLocaleLowerCase())===c}).map(_=>_.callback(y,a)):(l=this.bindings[c])===null||l===void 0||l.filter(_=>{var b,w,S,k,C,T;if(["broadcast","presence","postgres_changes"].includes(c))if("id"in _){const j=_.id,X=(b=_.filter)===null||b===void 0?void 0:b.event;return j&&((w=r.ids)===null||w===void 0?void 0:w.includes(j))&&(X==="*"||X?.toLocaleLowerCase()===((S=r.data)===null||S===void 0?void 0:S.type.toLocaleLowerCase()))}else{const j=(C=(k=_?.filter)===null||k===void 0?void 0:k.event)===null||C===void 0?void 0:C.toLocaleLowerCase();return j==="*"||j===((T=r?.event)===null||T===void 0?void 0:T.toLocaleLowerCase())}else return _.type.toLocaleLowerCase()===c}).map(_=>{if(typeof y=="object"&&"ids"in y){const b=y.data,{schema:w,table:S,commit_timestamp:k,type:C,errors:T}=b;y=Object.assign(Object.assign({},{schema:w,table:S,commit_timestamp:k,eventType:C,new:{},old:{},errors:T}),this._getPayloadRecords(b))}_.callback(y,a)})}_isClosed(){return this.state===Pr.closed}_isJoined(){return this.state===Pr.joined}_isJoining(){return this.state===Pr.joining}_isLeaving(){return this.state===Pr.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,a){const s=t.toLocaleLowerCase(),l={type:s,filter:r,callback:a};return this.bindings[s]?this.bindings[s].push(l):this.bindings[s]=[l],this}_off(t,r){const a=t.toLocaleLowerCase();return this.bindings[a]&&(this.bindings[a]=this.bindings[a].filter(s=>{var l;return!(((l=s.type)===null||l===void 0?void 0:l.toLocaleLowerCase())===a&&co.isEqual(s.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const a in t)if(t[a]!==r[a])return!1;return!0}static isFilterValueEqual(t,r){return(t??void 0)===(r??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Dn.close,{},t)}_onError(t){this._on(Dn.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Pr.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=uv(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=uv(t.columns,t.old_record)),r}}const Sd=()=>{},b0={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},ST=[1e3,2e3,5e3,1e4],ET=1e4,TT=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class kT{constructor(t,r){var a;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Wd,this.transport=null,this.heartbeatIntervalMs=b0.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Sd,this.ref=0,this.reconnectTimer=null,this.vsn=cv,this.logger=Sd,this.conn=null,this.sendBuffer=[],this.serializer=new pT,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=s=>s?(...l)=>s(...l):(...l)=>fetch(...l),!(!((a=r?.params)===null||a===void 0)&&a.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${Kd.websocket}`,this.httpEndpoint=Zy(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=uT.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const a=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(a),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,a){this.logger(t,r,a)}connectionState(){switch(this.conn&&this.conn.readyState){case ai.connecting:return Pi.Connecting;case ai.open:return Pi.Open;case ai.closing:return Pi.Closing;default:return Pi.Closed}}isConnected(){return this.connectionState()===Pi.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const a=`realtime:${t}`,s=this.getChannels().find(l=>l.topic===a);if(s)return s;{const l=new co(`realtime:${t}`,r,this);return this.channels.push(l),l}}push(t){const{topic:r,event:a,payload:s,ref:l}=t,c=()=>{this.encode(t,u=>{var h;(h=this.conn)===null||h===void 0||h.send(u)})};this.log("push",`${r} ${a} (${l})`,s),this.isConnected()?c():this.sendBuffer.push(c)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(mT,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},b0.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(a=>a.topic===t&&(a._isJoined()||a._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(d){this.log("error","error in heartbeat callback",d)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:a,event:s,payload:l,ref:c}=r,u=c?`(${c})`:"",h=l.status||"";this.log("receive",`${h} ${a} ${s} ${u}`.trim(),l),this.channels.filter(d=>d._isMember(a)).forEach(d=>d._trigger(s,l,c)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t),this.conn.readyState===ai.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===ai.open||this.conn.readyState===ai.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this._terminateWorker()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Dn.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const a=t.match(/\?/)?"&":"?",s=new URLSearchParams(r);return`${t}${a}${s}`}_workerObjectUrl(t){let r;if(t)r=t;else{const a=new Blob([TT],{type:"application/javascript"});r=URL.createObjectURL(a)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r,a=!1;if(t)r=t,a=!0;else if(this.accessToken)try{r=await this.accessToken()}catch(s){this.log("error","Error fetching access token from callback",s),r=this.accessTokenValue}else r=this.accessTokenValue;a?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(s=>{const l={access_token:r,version:hT};r&&s.updateJoinPayload(l),s.joinedOnce&&s._isJoined()&&s._push(Dn.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this._isManualToken()||this.setAuth().catch(r=>{this.log("error",`Error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(a=>{try{a(r)}catch(s){this.log("error",`error in ${t} callback`,s)}})}catch(a){this.log("error",`error triggering ${t} callbacks`,a)}}_setupReconnectionTimer(){this.reconnectTimer=new Jy(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},b0.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,a,s,l,c,u,h,d,g,x,y,_;switch(this.transport=(r=t?.transport)!==null&&r!==void 0?r:null,this.timeout=(a=t?.timeout)!==null&&a!==void 0?a:Wd,this.heartbeatIntervalMs=(s=t?.heartbeatIntervalMs)!==null&&s!==void 0?s:b0.HEARTBEAT_INTERVAL,this.worker=(l=t?.worker)!==null&&l!==void 0?l:!1,this.accessToken=(c=t?.accessToken)!==null&&c!==void 0?c:null,this.heartbeatCallback=(u=t?.heartbeatCallback)!==null&&u!==void 0?u:Sd,this.vsn=(h=t?.vsn)!==null&&h!==void 0?h:cv,t?.params&&(this.params=t.params),t?.logger&&(this.logger=t.logger),(t?.logLevel||t?.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(d=t?.reconnectAfterMs)!==null&&d!==void 0?d:(b=>ST[b-1]||ET),this.vsn){case Yy:this.encode=(g=t?.encode)!==null&&g!==void 0?g:((b,w)=>w(JSON.stringify(b))),this.decode=(x=t?.decode)!==null&&x!==void 0?x:((b,w)=>w(JSON.parse(b)));break;case dT:this.encode=(y=t?.encode)!==null&&y!==void 0?y:this.serializer.encode.bind(this.serializer),this.decode=(_=t?.decode)!==null&&_!==void 0?_:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t?.workerUrl}}}var Mc=class extends Error{constructor(e,t){super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown=t.icebergType==="CommitStateUnknownException"||[500,502,504].includes(t.status)&&t.icebergType?.includes("CommitState")===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function AT(e,t,r){const a=new URL(t,e);if(r)for(const[s,l]of Object.entries(r))l!==void 0&&a.searchParams.set(s,l);return a.toString()}async function CT(e){return!e||e.type==="none"?{}:e.type==="bearer"?{Authorization:`Bearer ${e.token}`}:e.type==="header"?{[e.name]:e.value}:e.type==="custom"?await e.getHeaders():{}}function NT(e){const t=e.fetchImpl??globalThis.fetch;return{async request({method:r,path:a,query:s,body:l,headers:c}){const u=AT(e.baseUrl,a,s),h=await CT(e.auth),d=await t(u,{method:r,headers:{...l?{"Content-Type":"application/json"}:{},...h,...c},body:l?JSON.stringify(l):void 0}),g=await d.text(),x=(d.headers.get("content-type")||"").includes("application/json"),y=x&&g?JSON.parse(g):g;if(!d.ok){const _=x?y:void 0,b=_?.error;throw new Mc(b?.message??`Request failed with status ${d.status}`,{status:d.status,icebergType:b?.type,icebergCode:b?.code,details:_})}return{status:d.status,headers:d.headers,data:y}}}}function S0(e){return e.join("")}var OT=class{constructor(e,t=""){this.client=e,this.prefix=t}async listNamespaces(e){const t=e?{parent:S0(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(a=>({namespace:a}))}async createNamespace(e,t){const r={namespace:e.namespace,properties:t?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${S0(e.namespace)}`})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${S0(e.namespace)}`})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${S0(e.namespace)}`}),!0}catch(t){if(t instanceof Mc&&t.status===404)return!1;throw t}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(r){if(r instanceof Mc&&r.status===409)return;throw r}}};function Yl(e){return e.join("")}var RT=class{constructor(e,t="",r){this.client=e,this.prefix=t,this.accessDelegation=r}async listTables(e){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Yl(e.namespace)}/tables`})).data.identifiers}async createTable(e,t){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Yl(e.namespace)}/tables`,body:t,headers:r})).data.metadata}async updateTable(e,t){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Yl(e.namespace)}/tables/${e.name}`,body:t});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(e,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Yl(e.namespace)}/tables/${e.name}`,query:{purgeRequested:String(t?.purge??!1)}})}async loadTable(e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Yl(e.namespace)}/tables/${e.name}`,headers:t})).data.metadata}async tableExists(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Yl(e.namespace)}/tables/${e.name}`,headers:t}),!0}catch(r){if(r instanceof Mc&&r.status===404)return!1;throw r}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(r){if(r instanceof Mc&&r.status===409)return await this.loadTable({namespace:e.namespace,name:t.name});throw r}}},DT=class{constructor(e){let t="v1";e.catalogName&&(t+=`/${e.catalogName}`);const r=e.baseUrl.endsWith("/")?e.baseUrl:`${e.baseUrl}/`;this.client=NT({baseUrl:r,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=e.accessDelegation?.join(","),this.namespaceOps=new OT(this.client,t),this.tableOps=new RT(this.client,t,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}},sf=class extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}};function mr(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}var FT=class extends sf{constructor(e,t,r){super(e),this.name="StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Jd=class extends sf{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}};const ym=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),MT=()=>Response,Qd=e=>{if(Array.isArray(e))return e.map(r=>Qd(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,a])=>{const s=r.replace(/([-_][a-z])/gi,l=>l.toUpperCase().replace(/[-_]/g,""));t[s]=Qd(a)}),t},jT=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},IT=e=>!e||typeof e!="string"||e.length===0||e.length>100||e.trim()!==e||e.includes("/")||e.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(e);function jc(e){"@babel/helpers - typeof";return jc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jc(e)}function LT(e,t){if(jc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(jc(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function BT(e){var t=LT(e,"string");return jc(t)=="symbol"?t:t+""}function UT(e,t,r){return(t=BT(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dv(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function ut(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?dv(Object(r),!0).forEach(function(a){UT(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dv(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}const Ed=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},PT=async(e,t,r)=>{e instanceof await MT()&&!r?.noResolveJson?e.json().then(a=>{const s=e.status||500,l=a?.statusCode||s+"";t(new FT(Ed(a),s,l))}).catch(a=>{t(new Jd(Ed(a),a))}):t(new Jd(Ed(e),e))},zT=(e,t,r,a)=>{const s={method:e,headers:t?.headers||{}};return e==="GET"||!a?s:(jT(a)?(s.headers=ut({"Content-Type":"application/json"},t?.headers),s.body=JSON.stringify(a)):s.body=a,t?.duplex&&(s.duplex=t.duplex),ut(ut({},s),r))};async function ru(e,t,r,a,s,l){return new Promise((c,u)=>{e(r,zT(t,a,s,l)).then(h=>{if(!h.ok)throw h;return a?.noResolveJson?h:h.json()}).then(h=>c(h)).catch(h=>PT(h,u,a))})}async function Ic(e,t,r,a){return ru(e,"GET",t,r,a)}async function Rn(e,t,r,a,s){return ru(e,"POST",t,a,s,r)}async function Zd(e,t,r,a,s){return ru(e,"PUT",t,a,s,r)}async function HT(e,t,r,a){return ru(e,"HEAD",t,ut(ut({},r),{},{noResolveJson:!0}),a)}async function _m(e,t,r,a,s){return ru(e,"DELETE",t,a,s,r)}var $T=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}async execute(){var e=this;try{return{data:(await e.downloadFn()).body,error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(mr(t))return{data:null,error:t};throw t}}};let e_;e_=Symbol.toStringTag;var VT=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[e_]="BlobDownloadBuilder",this.promise=null}asStream(){return new $T(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var e=this;try{return{data:await(await e.downloadFn()).blob(),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(mr(t))return{data:null,error:t};throw t}}};const GT={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},mv={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var qT=class{constructor(e,t={},r,a){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=r,this.fetch=ym(a)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(e,t,r,a){var s=this;try{let l;const c=ut(ut({},mv),a);let u=ut(ut({},s.headers),e==="POST"&&{"x-upsert":String(c.upsert)});const h=c.metadata;typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),h&&l.append("metadata",s.encodeMetadata(h)),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.has("cacheControl")||l.append("cacheControl",c.cacheControl),h&&!l.has("metadata")&&l.append("metadata",s.encodeMetadata(h))):(l=r,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType,h&&(u["x-metadata"]=s.toBase64(s.encodeMetadata(h))),(typeof ReadableStream<"u"&&l instanceof ReadableStream||l&&typeof l=="object"&&"pipe"in l&&typeof l.pipe=="function")&&!c.duplex&&(c.duplex="half")),a?.headers&&(u=ut(ut({},u),a.headers));const d=s._removeEmptyFolders(t),g=s._getFinalPath(d),x=await(e=="PUT"?Zd:Rn)(s.fetch,`${s.url}/object/${g}`,l,ut({headers:u},c?.duplex?{duplex:c.duplex}:{}));return{data:{path:d,id:x.Id,fullPath:x.Key},error:null}}catch(l){if(s.shouldThrowOnError)throw l;if(mr(l))return{data:null,error:l};throw l}}async upload(e,t,r){return this.uploadOrUpdate("POST",e,t,r)}async uploadToSignedUrl(e,t,r,a){var s=this;const l=s._removeEmptyFolders(e),c=s._getFinalPath(l),u=new URL(s.url+`/object/upload/sign/${c}`);u.searchParams.set("token",t);try{let h;const d=ut({upsert:mv.upsert},a),g=ut(ut({},s.headers),{"x-upsert":String(d.upsert)});return typeof Blob<"u"&&r instanceof Blob?(h=new FormData,h.append("cacheControl",d.cacheControl),h.append("",r)):typeof FormData<"u"&&r instanceof FormData?(h=r,h.append("cacheControl",d.cacheControl)):(h=r,g["cache-control"]=`max-age=${d.cacheControl}`,g["content-type"]=d.contentType),{data:{path:l,fullPath:(await Zd(s.fetch,u.toString(),h,{headers:g})).Key},error:null}}catch(h){if(s.shouldThrowOnError)throw h;if(mr(h))return{data:null,error:h};throw h}}async createSignedUploadUrl(e,t){var r=this;try{let a=r._getFinalPath(e);const s=ut({},r.headers);t?.upsert&&(s["x-upsert"]="true");const l=await Rn(r.fetch,`${r.url}/object/upload/sign/${a}`,{},{headers:s}),c=new URL(r.url+l.url),u=c.searchParams.get("token");if(!u)throw new sf("No token returned by API");return{data:{signedUrl:c.toString(),path:e,token:u},error:null}}catch(a){if(r.shouldThrowOnError)throw a;if(mr(a))return{data:null,error:a};throw a}}async update(e,t,r){return this.uploadOrUpdate("PUT",e,t,r)}async move(e,t,r){var a=this;try{return{data:await Rn(a.fetch,`${a.url}/object/move`,{bucketId:a.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r?.destinationBucket},{headers:a.headers}),error:null}}catch(s){if(a.shouldThrowOnError)throw s;if(mr(s))return{data:null,error:s};throw s}}async copy(e,t,r){var a=this;try{return{data:{path:(await Rn(a.fetch,`${a.url}/object/copy`,{bucketId:a.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r?.destinationBucket},{headers:a.headers})).Key},error:null}}catch(s){if(a.shouldThrowOnError)throw s;if(mr(s))return{data:null,error:s};throw s}}async createSignedUrl(e,t,r){var a=this;try{let s=a._getFinalPath(e),l=await Rn(a.fetch,`${a.url}/object/sign/${s}`,ut({expiresIn:t},r?.transform?{transform:r.transform}:{}),{headers:a.headers});const c=r?.download?`&download=${r.download===!0?"":r.download}`:"";return l={signedUrl:encodeURI(`${a.url}${l.signedURL}${c}`)},{data:l,error:null}}catch(s){if(a.shouldThrowOnError)throw s;if(mr(s))return{data:null,error:s};throw s}}async createSignedUrls(e,t,r){var a=this;try{const s=await Rn(a.fetch,`${a.url}/object/sign/${a.bucketId}`,{expiresIn:t,paths:e},{headers:a.headers}),l=r?.download?`&download=${r.download===!0?"":r.download}`:"";return{data:s.map(c=>ut(ut({},c),{},{signedUrl:c.signedURL?encodeURI(`${a.url}${c.signedURL}${l}`):null})),error:null}}catch(s){if(a.shouldThrowOnError)throw s;if(mr(s))return{data:null,error:s};throw s}}download(e,t){const r=typeof t?.transform<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString(t?.transform||{}),s=a?`?${a}`:"",l=this._getFinalPath(e),c=()=>Ic(this.fetch,`${this.url}/${r}/${l}${s}`,{headers:this.headers,noResolveJson:!0});return new VT(c,this.shouldThrowOnError)}async info(e){var t=this;const r=t._getFinalPath(e);try{return{data:Qd(await Ic(t.fetch,`${t.url}/object/info/${r}`,{headers:t.headers})),error:null}}catch(a){if(t.shouldThrowOnError)throw a;if(mr(a))return{data:null,error:a};throw a}}async exists(e){var t=this;const r=t._getFinalPath(e);try{return await HT(t.fetch,`${t.url}/object/${r}`,{headers:t.headers}),{data:!0,error:null}}catch(a){if(t.shouldThrowOnError)throw a;if(mr(a)&&a instanceof Jd){const s=a.originalError;if([400,404].includes(s?.status))return{data:!1,error:a}}throw a}}getPublicUrl(e,t){const r=this._getFinalPath(e),a=[],s=t?.download?`download=${t.download===!0?"":t.download}`:"";s!==""&&a.push(s);const l=typeof t?.transform<"u"?"render/image":"object",c=this.transformOptsToQueryString(t?.transform||{});c!==""&&a.push(c);let u=a.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${r}${u}`)}}}async remove(e){var t=this;try{return{data:await _m(t.fetch,`${t.url}/object/${t.bucketId}`,{prefixes:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(mr(r))return{data:null,error:r};throw r}}async list(e,t,r){var a=this;try{const s=ut(ut(ut({},GT),t),{},{prefix:e||""});return{data:await Rn(a.fetch,`${a.url}/object/list/${a.bucketId}`,s,{headers:a.headers},r),error:null}}catch(s){if(a.shouldThrowOnError)throw s;if(mr(s))return{data:null,error:s};throw s}}async listV2(e,t){var r=this;try{const a=ut({},e);return{data:await Rn(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,a,{headers:r.headers},t),error:null}}catch(a){if(r.shouldThrowOnError)throw a;if(mr(a))return{data:null,error:a};throw a}}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}};const t_="2.89.0",r_={"X-Client-Info":`storage-js/${t_}`};var XT=class{constructor(e,t={},r,a){this.shouldThrowOnError=!1;const s=new URL(e);a?.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase.")),this.url=s.href.replace(/\/$/,""),this.headers=ut(ut({},r_),t),this.fetch=ym(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(e){var t=this;try{const r=t.listBucketOptionsToQueryString(e);return{data:await Ic(t.fetch,`${t.url}/bucket${r}`,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(mr(r))return{data:null,error:r};throw r}}async getBucket(e){var t=this;try{return{data:await Ic(t.fetch,`${t.url}/bucket/${e}`,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(mr(r))return{data:null,error:r};throw r}}async createBucket(e,t={public:!1}){var r=this;try{return{data:await Rn(r.fetch,`${r.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}),error:null}}catch(a){if(r.shouldThrowOnError)throw a;if(mr(a))return{data:null,error:a};throw a}}async updateBucket(e,t){var r=this;try{return{data:await Zd(r.fetch,`${r.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}),error:null}}catch(a){if(r.shouldThrowOnError)throw a;if(mr(a))return{data:null,error:a};throw a}}async emptyBucket(e){var t=this;try{return{data:await Rn(t.fetch,`${t.url}/bucket/${e}/empty`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(mr(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await _m(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(mr(r))return{data:null,error:r};throw r}}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}},WT=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=ut(ut({},r_),t),this.fetch=ym(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var t=this;try{return{data:await Rn(t.fetch,`${t.url}/bucket`,{name:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(mr(r))return{data:null,error:r};throw r}}async listBuckets(e){var t=this;try{const r=new URLSearchParams;e?.limit!==void 0&&r.set("limit",e.limit.toString()),e?.offset!==void 0&&r.set("offset",e.offset.toString()),e?.sortColumn&&r.set("sortColumn",e.sortColumn),e?.sortOrder&&r.set("sortOrder",e.sortOrder),e?.search&&r.set("search",e.search);const a=r.toString(),s=a?`${t.url}/bucket?${a}`:`${t.url}/bucket`;return{data:await Ic(t.fetch,s,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(mr(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await _m(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(mr(r))return{data:null,error:r};throw r}}from(e){var t=this;if(!IT(e))throw new sf("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new DT({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:async()=>t.headers},fetch:this.fetch}),a=this.shouldThrowOnError;return new Proxy(r,{get(s,l){const c=s[l];return typeof c!="function"?c:async(...u)=>{try{return{data:await c.apply(s,u),error:null}}catch(h){if(a)throw h;return{data:null,error:h}}}}})}};const wm={"X-Client-Info":`storage-js/${t_}`,"Content-Type":"application/json"};var a_=class extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function Za(e){return typeof e=="object"&&e!==null&&"__isStorageVectorsError"in e}var Td=class extends a_{constructor(e,t,r){super(e),this.name="StorageVectorsApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},KT=class extends a_{constructor(e,t){super(e),this.name="StorageVectorsUnknownError",this.originalError=t}};const bm=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),YT=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},gv=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),JT=async(e,t,r)=>{if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!r?.noResolveJson){const a=e.status||500,s=e;if(typeof s.json=="function")s.json().then(l=>{const c=l?.statusCode||l?.code||a+"";t(new Td(gv(l),a,c))}).catch(()=>{const l=a+"";t(new Td(s.statusText||`HTTP ${a} error`,a,l))});else{const l=a+"";t(new Td(s.statusText||`HTTP ${a} error`,a,l))}}else t(new KT(gv(e),e))},QT=(e,t,r,a)=>{const s={method:e,headers:t?.headers||{}};return a?(YT(a)?(s.headers=ut({"Content-Type":"application/json"},t?.headers),s.body=JSON.stringify(a)):s.body=a,ut(ut({},s),r)):s};async function ZT(e,t,r,a,s,l){return new Promise((c,u)=>{e(r,QT(t,a,s,l)).then(h=>{if(!h.ok)throw h;if(a?.noResolveJson)return h;const d=h.headers.get("content-type");return!d||!d.includes("application/json")?{}:h.json()}).then(h=>c(h)).catch(h=>JT(h,u,a))})}async function en(e,t,r,a,s){return ZT(e,"POST",t,a,s,r)}var e4=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=ut(ut({},wm),t),this.fetch=bm(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(e){var t=this;try{return{data:await en(t.fetch,`${t.url}/CreateIndex`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Za(r))return{data:null,error:r};throw r}}async getIndex(e,t){var r=this;try{return{data:await en(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers}),error:null}}catch(a){if(r.shouldThrowOnError)throw a;if(Za(a))return{data:null,error:a};throw a}}async listIndexes(e){var t=this;try{return{data:await en(t.fetch,`${t.url}/ListIndexes`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Za(r))return{data:null,error:r};throw r}}async deleteIndex(e,t){var r=this;try{return{data:await en(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers})||{},error:null}}catch(a){if(r.shouldThrowOnError)throw a;if(Za(a))return{data:null,error:a};throw a}}},t4=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=ut(ut({},wm),t),this.fetch=bm(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(e){var t=this;try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await en(t.fetch,`${t.url}/PutVectors`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Za(r))return{data:null,error:r};throw r}}async getVectors(e){var t=this;try{return{data:await en(t.fetch,`${t.url}/GetVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Za(r))return{data:null,error:r};throw r}}async listVectors(e){var t=this;try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:await en(t.fetch,`${t.url}/ListVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Za(r))return{data:null,error:r};throw r}}async queryVectors(e){var t=this;try{return{data:await en(t.fetch,`${t.url}/QueryVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Za(r))return{data:null,error:r};throw r}}async deleteVectors(e){var t=this;try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await en(t.fetch,`${t.url}/DeleteVectors`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Za(r))return{data:null,error:r};throw r}}},r4=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=ut(ut({},wm),t),this.fetch=bm(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var t=this;try{return{data:await en(t.fetch,`${t.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Za(r))return{data:null,error:r};throw r}}async getBucket(e){var t=this;try{return{data:await en(t.fetch,`${t.url}/GetVectorBucket`,{vectorBucketName:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Za(r))return{data:null,error:r};throw r}}async listBuckets(e={}){var t=this;try{return{data:await en(t.fetch,`${t.url}/ListVectorBuckets`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Za(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await en(t.fetch,`${t.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Za(r))return{data:null,error:r};throw r}}},a4=class extends r4{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new n4(this.url,this.headers,e,this.fetch)}async createBucket(e){var t=()=>super.createBucket,r=this;return t().call(r,e)}async getBucket(e){var t=()=>super.getBucket,r=this;return t().call(r,e)}async listBuckets(e={}){var t=()=>super.listBuckets,r=this;return t().call(r,e)}async deleteBucket(e){var t=()=>super.deleteBucket,r=this;return t().call(r,e)}},n4=class extends e4{constructor(e,t,r,a){super(e,t,a),this.vectorBucketName=r}async createIndex(e){var t=()=>super.createIndex,r=this;return t().call(r,ut(ut({},e),{},{vectorBucketName:r.vectorBucketName}))}async listIndexes(e={}){var t=()=>super.listIndexes,r=this;return t().call(r,ut(ut({},e),{},{vectorBucketName:r.vectorBucketName}))}async getIndex(e){var t=()=>super.getIndex,r=this;return t().call(r,r.vectorBucketName,e)}async deleteIndex(e){var t=()=>super.deleteIndex,r=this;return t().call(r,r.vectorBucketName,e)}index(e){return new s4(this.url,this.headers,this.vectorBucketName,e,this.fetch)}},s4=class extends t4{constructor(e,t,r,a,s){super(e,t,s),this.vectorBucketName=r,this.indexName=a}async putVectors(e){var t=()=>super.putVectors,r=this;return t().call(r,ut(ut({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async getVectors(e){var t=()=>super.getVectors,r=this;return t().call(r,ut(ut({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async listVectors(e={}){var t=()=>super.listVectors,r=this;return t().call(r,ut(ut({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async queryVectors(e){var t=()=>super.queryVectors,r=this;return t().call(r,ut(ut({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async deleteVectors(e){var t=()=>super.deleteVectors,r=this;return t().call(r,ut(ut({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}},i4=class extends XT{constructor(e,t={},r,a){super(e,t,r,a)}from(e){return new qT(this.url,this.headers,e,this.fetch)}get vectors(){return new a4(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new WT(this.url+"/iceberg",this.headers,this.fetch)}};const n_="2.89.0",io=30*1e3,em=3,kd=em*io,l4="http://localhost:9999",o4="supabase.auth.token",c4={"X-Client-Info":`gotrue-js/${n_}`},tm="X-Supabase-Api-Version",s_={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},u4=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,f4=600*1e3;class Lc extends Error{constructor(t,r,a){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=a}}function at(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class h4 extends Lc{constructor(t,r,a){super(t,r,a),this.name="AuthApiError",this.status=r,this.code=a}}function d4(e){return at(e)&&e.name==="AuthApiError"}class zi extends Lc{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class Ts extends Lc{constructor(t,r,a,s){super(t,a,s),this.name=r,this.status=a}}class Ya extends Ts{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function m4(e){return at(e)&&e.name==="AuthSessionMissingError"}class Jl extends Ts{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class E0 extends Ts{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class T0 extends Ts{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function g4(e){return at(e)&&e.name==="AuthImplicitGrantRedirectError"}class pv extends Ts{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class p4 extends Ts{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class rm extends Ts{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function Ad(e){return at(e)&&e.name==="AuthRetryableFetchError"}class xv extends Ts{constructor(t,r,a){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=a}}class am extends Ts{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const P0="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),vv=` 	
\r=`.split(""),x4=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<vv.length;t+=1)e[vv[t].charCodeAt(0)]=-2;for(let t=0;t<P0.length;t+=1)e[P0[t].charCodeAt(0)]=t;return e})();function yv(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const a=t.queue>>t.queuedBits-6&63;r(P0[a]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const a=t.queue>>t.queuedBits-6&63;r(P0[a]),t.queuedBits-=6}}function i_(e,t,r){const a=x4[e];if(a>-1)for(t.queue=t.queue<<6|a,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(a===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function _v(e){const t=[],r=c=>{t.push(String.fromCodePoint(c))},a={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},l=c=>{_4(c,a,r)};for(let c=0;c<e.length;c+=1)i_(e.charCodeAt(c),s,l);return t.join("")}function v4(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function y4(e,t){for(let r=0;r<e.length;r+=1){let a=e.charCodeAt(r);if(a>55295&&a<=56319){const s=(a-55296)*1024&65535;a=(e.charCodeAt(r+1)-56320&65535|s)+65536,r+=1}v4(a,t)}}function _4(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let a=1;a<6;a+=1)if((e>>7-a&1)===0){t.utf8seq=a;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function fo(e){const t=[],r={queue:0,queuedBits:0},a=s=>{t.push(s)};for(let s=0;s<e.length;s+=1)i_(e.charCodeAt(s),r,a);return new Uint8Array(t)}function w4(e){const t=[];return y4(e,r=>t.push(r)),new Uint8Array(t)}function $i(e){const t=[],r={queue:0,queuedBits:0},a=s=>{t.push(s)};return e.forEach(s=>yv(s,r,a)),yv(null,r,a),t.join("")}function b4(e){return Math.round(Date.now()/1e3)+e}function S4(){return Symbol("auth-callback")}const sa=()=>typeof window<"u"&&typeof document<"u",Li={tested:!1,writable:!1},l_=()=>{if(!sa())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Li.tested)return Li.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Li.tested=!0,Li.writable=!0}catch{Li.tested=!0,Li.writable=!1}return Li.writable};function E4(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((s,l)=>{t[l]=s})}catch{}return r.searchParams.forEach((a,s)=>{t[s]=a}),t}const o_=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),T4=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",lo=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},Bi=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},na=async(e,t)=>{await e.removeItem(t)};class lf{constructor(){this.promise=new lf.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}lf.promiseConstructor=Promise;function Cd(e){const t=e.split(".");if(t.length!==3)throw new am("Invalid JWT structure");for(let a=0;a<t.length;a++)if(!u4.test(t[a]))throw new am("JWT not in base64url format");return{header:JSON.parse(_v(t[0])),payload:JSON.parse(_v(t[1])),signature:fo(t[2]),raw:{header:t[0],payload:t[1]}}}async function k4(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function A4(e,t){return new Promise((a,s)=>{(async()=>{for(let l=0;l<1/0;l++)try{const c=await e(l);if(!t(l,null,c)){a(c);return}}catch(c){if(!t(l,c)){s(c);return}}})()})}function C4(e){return("0"+e.toString(16)).substr(-2)}function N4(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",a=r.length;let s="";for(let l=0;l<56;l++)s+=r.charAt(Math.floor(Math.random()*a));return s}return crypto.getRandomValues(t),Array.from(t,C4).join("")}async function O4(e){const r=new TextEncoder().encode(e),a=await crypto.subtle.digest("SHA-256",r),s=new Uint8Array(a);return Array.from(s).map(l=>String.fromCharCode(l)).join("")}async function R4(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await O4(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Ql(e,t,r=!1){const a=N4();let s=a;r&&(s+="/PASSWORD_RECOVERY"),await lo(e,`${t}-code-verifier`,s);const l=await R4(a);return[l,a===l?"plain":"s256"]}const D4=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function F4(e){const t=e.headers.get(tm);if(!t||!t.match(D4))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function M4(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function j4(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const I4=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Zl(e){if(!I4.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Nd(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const a=r.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function L4(e,t){return new Proxy(e,{get:(r,a,s)=>{if(a==="__isInsecureUserWarningProxy")return!0;if(typeof a=="symbol"){const l=a.toString();if(l==="Symbol(Symbol.toPrimitive)"||l==="Symbol(Symbol.toStringTag)"||l==="Symbol(util.inspect.custom)"||l==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,a,s)}return!t.value&&typeof a=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(r,a,s)}})}function wv(e){return JSON.parse(JSON.stringify(e))}const Ui=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),B4=[502,503,504];async function bv(e){var t;if(!T4(e))throw new rm(Ui(e),0);if(B4.includes(e.status))throw new rm(Ui(e),e.status);let r;try{r=await e.json()}catch(l){throw new zi(Ui(l),l)}let a;const s=F4(e);if(s&&s.getTime()>=s_["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?a=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(a=r.error_code),a){if(a==="weak_password")throw new xv(Ui(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(a==="session_not_found")throw new Ya}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((l,c)=>l&&typeof c=="string",!0))throw new xv(Ui(r),e.status,r.weak_password.reasons);throw new h4(Ui(r),e.status||500,a)}const U4=(e,t,r,a)=>{const s={method:e,headers:t?.headers||{}};return e==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t?.headers),s.body=JSON.stringify(a),Object.assign(Object.assign({},s),r))};async function ct(e,t,r,a){var s;const l=Object.assign({},a?.headers);l[tm]||(l[tm]=s_["2024-01-01"].name),a?.jwt&&(l.Authorization=`Bearer ${a.jwt}`);const c=(s=a?.query)!==null&&s!==void 0?s:{};a?.redirectTo&&(c.redirect_to=a.redirectTo);const u=Object.keys(c).length?"?"+new URLSearchParams(c).toString():"",h=await P4(e,t,r+u,{headers:l,noResolveJson:a?.noResolveJson},{},a?.body);return a?.xform?a?.xform(h):{data:Object.assign({},h),error:null}}async function P4(e,t,r,a,s,l){const c=U4(t,a,s,l);let u;try{u=await e(r,Object.assign({},c))}catch(h){throw console.error(h),new rm(Ui(h),0)}if(u.ok||await bv(u),a?.noResolveJson)return u;try{return await u.json()}catch(h){await bv(h)}}function On(e){var t;let r=null;$4(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=b4(e.expires_in)));const a=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:a},error:null}}function Sv(e){const t=On(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,a)=>r&&typeof a=="string",!0)&&(t.data.weak_password=e.weak_password),t}function si(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function z4(e){return{data:e,error:null}}function H4(e){const{action_link:t,email_otp:r,hashed_token:a,redirect_to:s,verification_type:l}=e,c=nf(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),u={action_link:t,email_otp:r,hashed_token:a,redirect_to:s,verification_type:l},h=Object.assign({},c);return{data:{properties:u,user:h},error:null}}function Ev(e){return e}function $4(e){return e.access_token&&e.refresh_token&&e.expires_in}const Od=["global","local","others"];class V4{constructor({url:t="",headers:r={},fetch:a}){this.url=t,this.headers=r,this.fetch=o_(a),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=Od[0]){if(Od.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Od.join(", ")}`);try{return await ct(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(a){if(at(a))return{data:null,error:a};throw a}}async inviteUserByEmail(t,r={}){try{return await ct(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:si})}catch(a){if(at(a))return{data:{user:null},error:a};throw a}}async generateLink(t){try{const{options:r}=t,a=nf(t,["options"]),s=Object.assign(Object.assign({},a),r);return"newEmail"in a&&(s.new_email=a?.newEmail,delete s.newEmail),await ct(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:H4,redirectTo:r?.redirectTo})}catch(r){if(at(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await ct(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:si})}catch(r){if(at(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,a,s,l,c,u,h;try{const d={nextPage:null,lastPage:0,total:0},g=await ct(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(r=t?.page)===null||r===void 0?void 0:r.toString())!==null&&a!==void 0?a:"",per_page:(l=(s=t?.perPage)===null||s===void 0?void 0:s.toString())!==null&&l!==void 0?l:""},xform:Ev});if(g.error)throw g.error;const x=await g.json(),y=(c=g.headers.get("x-total-count"))!==null&&c!==void 0?c:0,_=(h=(u=g.headers.get("link"))===null||u===void 0?void 0:u.split(","))!==null&&h!==void 0?h:[];return _.length>0&&(_.forEach(b=>{const w=parseInt(b.split(";")[0].split("=")[1].substring(0,1)),S=JSON.parse(b.split(";")[1].split("=")[1]);d[`${S}Page`]=w}),d.total=parseInt(y)),{data:Object.assign(Object.assign({},x),d),error:null}}catch(d){if(at(d))return{data:{users:[]},error:d};throw d}}async getUserById(t){Zl(t);try{return await ct(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:si})}catch(r){if(at(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){Zl(t);try{return await ct(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:si})}catch(a){if(at(a))return{data:{user:null},error:a};throw a}}async deleteUser(t,r=!1){Zl(t);try{return await ct(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:si})}catch(a){if(at(a))return{data:{user:null},error:a};throw a}}async _listFactors(t){Zl(t.userId);try{const{data:r,error:a}=await ct(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:r,error:a}}catch(r){if(at(r))return{data:null,error:r};throw r}}async _deleteFactor(t){Zl(t.userId),Zl(t.id);try{return{data:await ct(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(at(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,a,s,l,c,u,h;try{const d={nextPage:null,lastPage:0,total:0},g=await ct(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(r=t?.page)===null||r===void 0?void 0:r.toString())!==null&&a!==void 0?a:"",per_page:(l=(s=t?.perPage)===null||s===void 0?void 0:s.toString())!==null&&l!==void 0?l:""},xform:Ev});if(g.error)throw g.error;const x=await g.json(),y=(c=g.headers.get("x-total-count"))!==null&&c!==void 0?c:0,_=(h=(u=g.headers.get("link"))===null||u===void 0?void 0:u.split(","))!==null&&h!==void 0?h:[];return _.length>0&&(_.forEach(b=>{const w=parseInt(b.split(";")[0].split("=")[1].substring(0,1)),S=JSON.parse(b.split(";")[1].split("=")[1]);d[`${S}Page`]=w}),d.total=parseInt(y)),{data:Object.assign(Object.assign({},x),d),error:null}}catch(d){if(at(d))return{data:{clients:[]},error:d};throw d}}async _createOAuthClient(t){try{return await ct(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(at(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await ct(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(at(r))return{data:null,error:r};throw r}}async _updateOAuthClient(t,r){try{return await ct(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:r,headers:this.headers,xform:a=>({data:a,error:null})})}catch(a){if(at(a))return{data:null,error:a};throw a}}async _deleteOAuthClient(t){try{return await ct(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(at(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await ct(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(at(r))return{data:null,error:r};throw r}}}function Tv(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const eo={debug:!!(globalThis&&l_()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class c_ extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class G4 extends c_{}async function q4(e,t,r){eo.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const a=new globalThis.AbortController;return t>0&&setTimeout(()=>{a.abort(),eo.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:a.signal},async s=>{if(s){eo.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,s.name);try{return await r()}finally{eo.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,s.name)}}else{if(t===0)throw eo.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new G4(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(eo.debug)try{const l=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(l,null,"  "))}catch(l){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",l)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function X4(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function u_(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function W4(e){return parseInt(e,16)}function K4(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,a=>a.toString(16).padStart(2,"0")).join("")}function Y4(e){var t;const{chainId:r,domain:a,expirationTime:s,issuedAt:l=new Date,nonce:c,notBefore:u,requestId:h,resources:d,scheme:g,uri:x,version:y}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!a)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(c&&c.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${c}`);if(!x)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(y!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${y}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const _=u_(e.address),b=g?`${g}://${a}`:a,w=e.statement?`${e.statement}
`:"",S=`${b} wants you to sign in with your Ethereum account:
${_}

${w}`;let k=`URI: ${x}
Version: ${y}
Chain ID: ${r}${c?`
Nonce: ${c}`:""}
Issued At: ${l.toISOString()}`;if(s&&(k+=`
Expiration Time: ${s.toISOString()}`),u&&(k+=`
Not Before: ${u.toISOString()}`),h&&(k+=`
Request ID: ${h}`),d){let C=`
Resources:`;for(const T of d){if(!T||typeof T!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${T}`);C+=`
- ${T}`}k+=C}return`${S}
${k}`}class Lr extends Error{constructor({message:t,code:r,cause:a,name:s}){var l;super(t,{cause:a}),this.__isWebAuthnError=!0,this.name=(l=s??(a instanceof Error?a.name:void 0))!==null&&l!==void 0?l:"Unknown Error",this.code=r}}class z0 extends Lr{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function J4({error:e,options:t}){var r,a,s;const{publicKey:l}=t;if(!l)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Lr({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=l.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new Lr({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((a=l.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new Lr({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((s=l.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new Lr({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new Lr({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new Lr({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return l.pubKeyCredParams.filter(u=>u.type==="public-key").length===0?new Lr({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new Lr({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const c=window.location.hostname;if(f_(c)){if(l.rp.id!==c)return new Lr({message:`The RP ID "${l.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Lr({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(l.user.id.byteLength<1||l.user.id.byteLength>64)return new Lr({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new Lr({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Lr({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function Q4({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Lr({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new Lr({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const a=window.location.hostname;if(f_(a)){if(r.rpId!==a)return new Lr({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Lr({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new Lr({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Lr({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class Z4{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const ek=new Z4;function tk(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:a}=e,s=nf(e,["challenge","user","excludeCredentials"]),l=fo(t).buffer,c=Object.assign(Object.assign({},r),{id:fo(r.id).buffer}),u=Object.assign(Object.assign({},s),{challenge:l,user:c});if(a&&a.length>0){u.excludeCredentials=new Array(a.length);for(let h=0;h<a.length;h++){const d=a[h];u.excludeCredentials[h]=Object.assign(Object.assign({},d),{id:fo(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return u}function rk(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,a=nf(e,["challenge","allowCredentials"]),s=fo(t).buffer,l=Object.assign(Object.assign({},a),{challenge:s});if(r&&r.length>0){l.allowCredentials=new Array(r.length);for(let c=0;c<r.length;c++){const u=r[c];l.allowCredentials[c]=Object.assign(Object.assign({},u),{id:fo(u.id).buffer,type:u.type||"public-key",transports:u.transports})}}return l}function ak(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:$i(new Uint8Array(e.response.attestationObject)),clientDataJSON:$i(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function nk(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,a=e.getClientExtensionResults(),s=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:$i(new Uint8Array(s.authenticatorData)),clientDataJSON:$i(new Uint8Array(s.clientDataJSON)),signature:$i(new Uint8Array(s.signature)),userHandle:s.userHandle?$i(new Uint8Array(s.userHandle)):void 0},type:"public-key",clientExtensionResults:a,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function f_(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function kv(){var e,t;return!!(sa()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator?.credentials)===null||t===void 0?void 0:t.get)=="function")}async function sk(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new z0("Browser returned unexpected credential type",t)}:{data:null,error:new z0("Empty credential response",t)}}catch(t){return{data:null,error:J4({error:t,options:e})}}}async function ik(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new z0("Browser returned unexpected credential type",t)}:{data:null,error:new z0("Empty credential response",t)}}catch(t){return{data:null,error:Q4({error:t,options:e})}}}const lk={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},ok={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function H0(...e){const t=s=>s!==null&&typeof s=="object"&&!Array.isArray(s),r=s=>s instanceof ArrayBuffer||ArrayBuffer.isView(s),a={};for(const s of e)if(s)for(const l in s){const c=s[l];if(c!==void 0)if(Array.isArray(c))a[l]=c;else if(r(c))a[l]=c;else if(t(c)){const u=a[l];t(u)?a[l]=H0(u,c):a[l]=H0(c)}else a[l]=c}return a}function ck(e,t){return H0(lk,e,t||{})}function uk(e,t){return H0(ok,e,t||{})}class fk{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:a,signal:s},l){try{const{data:c,error:u}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!c)return{data:null,error:u};const h=s??ek.createNewAbortSignal();if(c.webauthn.type==="create"){const{user:d}=c.webauthn.credential_options.publicKey;d.name||(d.name=`${d.id}:${a}`),d.displayName||(d.displayName=d.name)}switch(c.webauthn.type){case"create":{const d=ck(c.webauthn.credential_options.publicKey,l?.create),{data:g,error:x}=await sk({publicKey:d,signal:h});return g?{data:{factorId:t,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:g}},error:null}:{data:null,error:x}}case"request":{const d=uk(c.webauthn.credential_options.publicKey,l?.request),{data:g,error:x}=await ik(Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:d,signal:h}));return g?{data:{factorId:t,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:g}},error:null}:{data:null,error:x}}}}catch(c){return at(c)?{data:null,error:c}:{data:null,error:new zi("Unexpected error in challenge",c)}}}async _verify({challengeId:t,factorId:r,webauthn:a}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:a})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:a=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},l){if(!r)return{data:null,error:new Lc("rpId is required for WebAuthn authentication")};try{if(!kv())return{data:null,error:new zi("Browser does not support WebAuthn",null)};const{data:c,error:u}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:a},signal:s},{request:l});if(!c)return{data:null,error:u};const{webauthn:h}=c;return this._verify({factorId:t,challengeId:c.challengeId,webauthn:{type:h.type,rpId:r,rpOrigins:a,credential_response:h.credential_response}})}catch(c){return at(c)?{data:null,error:c}:{data:null,error:new zi("Unexpected error in authenticate",c)}}}async _register({friendlyName:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:a=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},l){if(!r)return{data:null,error:new Lc("rpId is required for WebAuthn registration")};try{if(!kv())return{data:null,error:new zi("Browser does not support WebAuthn",null)};const{data:c,error:u}=await this._enroll({friendlyName:t});if(!c)return await this.client.mfa.listFactors().then(g=>{var x;return(x=g.data)===null||x===void 0?void 0:x.all.find(y=>y.factor_type==="webauthn"&&y.friendly_name===t&&y.status!=="unverified")}).then(g=>g?this.client.mfa.unenroll({factorId:g?.id}):void 0),{data:null,error:u};const{data:h,error:d}=await this._challenge({factorId:c.id,friendlyName:c.friendly_name,webauthn:{rpId:r,rpOrigins:a},signal:s},{create:l});return h?this._verify({factorId:c.id,challengeId:h.challengeId,webauthn:{rpId:r,rpOrigins:a,type:h.webauthn.type,credential_response:h.webauthn.credential_response}}):{data:null,error:d}}catch(c){return at(c)?{data:null,error:c}:{data:null,error:new zi("Unexpected error in register",c)}}}}X4();const hk={url:l4,storageKey:o4,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:c4,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function Av(e,t,r){return await r()}const to={};class Bc{get jwks(){var t,r;return(r=(t=to[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){to[this.storageKey]=Object.assign(Object.assign({},to[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=to[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){to[this.storageKey]=Object.assign(Object.assign({},to[this.storageKey]),{cachedAt:t})}constructor(t){var r,a,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const l=Object.assign(Object.assign({},hk),t);if(this.storageKey=l.storageKey,this.instanceID=(r=Bc.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,Bc.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!l.debug,typeof l.debug=="function"&&(this.logger=l.debug),this.instanceID>0&&sa()){const c=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(c),this.logDebugMessages&&console.trace(c)}if(this.persistSession=l.persistSession,this.autoRefreshToken=l.autoRefreshToken,this.admin=new V4({url:l.url,headers:l.headers,fetch:l.fetch}),this.url=l.url,this.headers=l.headers,this.fetch=o_(l.fetch),this.lock=l.lock||Av,this.detectSessionInUrl=l.detectSessionInUrl,this.flowType=l.flowType,this.hasCustomAuthorizationHeader=l.hasCustomAuthorizationHeader,this.throwOnError=l.throwOnError,l.lock?this.lock=l.lock:this.persistSession&&sa()&&(!((a=globalThis?.navigator)===null||a===void 0)&&a.locks)?this.lock=q4:this.lock=Av,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new fk(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(l.storage?this.storage=l.storage:l_()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Tv(this.memoryStorage)),l.userStorage&&(this.userStorage=l.userStorage)):(this.memoryStorage={},this.storage=Tv(this.memoryStorage)),sa()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(c){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",c)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async c=>{this._debug("received broadcast notification from other tab or client",c),await this._notifyAllSubscribers(c.data.event,c.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${n_}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let r={},a="none";if(sa()&&(r=E4(window.location.href),this._isImplicitGrantCallback(r)?a="implicit":await this._isPKCECallback(r)&&(a="pkce")),sa()&&this.detectSessionInUrl&&a!=="none"){const{data:s,error:l}=await this._getSessionFromURL(r,a);if(l){if(this._debug("#_initialize()","error detecting session from URL",l),g4(l)){const h=(t=l.details)===null||t===void 0?void 0:t.code;if(h==="identity_already_exists"||h==="identity_not_found"||h==="single_identity_not_deletable")return{error:l}}return await this._removeSession(),{error:l}}const{session:c,redirectType:u}=s;return this._debug("#_initialize()","detected session in URL",c,"redirect type",u),await this._saveSession(c),setTimeout(async()=>{u==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",c):await this._notifyAllSubscribers("SIGNED_IN",c)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return at(r)?this._returnResult({error:r}):this._returnResult({error:new zi("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,a,s;try{const l=await ct(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(a=(r=t?.options)===null||r===void 0?void 0:r.data)!==null&&a!==void 0?a:{},gotrue_meta_security:{captcha_token:(s=t?.options)===null||s===void 0?void 0:s.captchaToken}},xform:On}),{data:c,error:u}=l;if(u||!c)return this._returnResult({data:{user:null,session:null},error:u});const h=c.session,d=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",h)),this._returnResult({data:{user:d,session:h},error:null})}catch(l){if(at(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async signUp(t){var r,a,s;try{let l;if("email"in t){const{email:g,password:x,options:y}=t;let _=null,b=null;this.flowType==="pkce"&&([_,b]=await Ql(this.storage,this.storageKey)),l=await ct(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:y?.emailRedirectTo,body:{email:g,password:x,data:(r=y?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:y?.captchaToken},code_challenge:_,code_challenge_method:b},xform:On})}else if("phone"in t){const{phone:g,password:x,options:y}=t;l=await ct(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:g,password:x,data:(a=y?.data)!==null&&a!==void 0?a:{},channel:(s=y?.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:y?.captchaToken}},xform:On})}else throw new E0("You must provide either an email or phone number and a password");const{data:c,error:u}=l;if(u||!c)return await na(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:u});const h=c.session,d=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",h)),this._returnResult({data:{user:d,session:h},error:null})}catch(l){if(await na(this.storage,`${this.storageKey}-code-verifier`),at(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async signInWithPassword(t){try{let r;if("email"in t){const{email:l,password:c,options:u}=t;r=await ct(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:l,password:c,gotrue_meta_security:{captcha_token:u?.captchaToken}},xform:Sv})}else if("phone"in t){const{phone:l,password:c,options:u}=t;r=await ct(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:l,password:c,gotrue_meta_security:{captcha_token:u?.captchaToken}},xform:Sv})}else throw new E0("You must provide either an email or phone number and a password");const{data:a,error:s}=r;if(s)return this._returnResult({data:{user:null,session:null},error:s});if(!a||!a.session||!a.user){const l=new Jl;return this._returnResult({data:{user:null,session:null},error:l})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:Object.assign({user:a.user,session:a.session},a.weak_password?{weakPassword:a.weak_password}:null),error:s})}catch(r){if(at(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(t){var r,a,s,l;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(a=t.options)===null||a===void 0?void 0:a.scopes,queryParams:(s=t.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(l=t.options)===null||l===void 0?void 0:l.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,a,s,l,c,u,h,d,g,x,y;let _,b;if("message"in t)_=t.message,b=t.signature;else{const{chain:w,wallet:S,statement:k,options:C}=t;let T;if(sa())if(typeof S=="object")T=S;else{const P=window;if("ethereum"in P&&typeof P.ethereum=="object"&&"request"in P.ethereum&&typeof P.ethereum.request=="function")T=P.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof S!="object"||!C?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");T=S}const j=new URL((r=C?.url)!==null&&r!==void 0?r:window.location.href),X=await T.request({method:"eth_requestAccounts"}).then(P=>P).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!X||X.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const D=u_(X[0]);let N=(a=C?.signInWithEthereum)===null||a===void 0?void 0:a.chainId;if(!N){const P=await T.request({method:"eth_chainId"});N=W4(P)}const W={domain:j.host,address:D,statement:k,uri:j.href,version:"1",chainId:N,nonce:(s=C?.signInWithEthereum)===null||s===void 0?void 0:s.nonce,issuedAt:(c=(l=C?.signInWithEthereum)===null||l===void 0?void 0:l.issuedAt)!==null&&c!==void 0?c:new Date,expirationTime:(u=C?.signInWithEthereum)===null||u===void 0?void 0:u.expirationTime,notBefore:(h=C?.signInWithEthereum)===null||h===void 0?void 0:h.notBefore,requestId:(d=C?.signInWithEthereum)===null||d===void 0?void 0:d.requestId,resources:(g=C?.signInWithEthereum)===null||g===void 0?void 0:g.resources};_=Y4(W),b=await T.request({method:"personal_sign",params:[K4(_),D]})}try{const{data:w,error:S}=await ct(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:_,signature:b},!((x=t.options)===null||x===void 0)&&x.captchaToken?{gotrue_meta_security:{captcha_token:(y=t.options)===null||y===void 0?void 0:y.captchaToken}}:null),xform:On});if(S)throw S;if(!w||!w.session||!w.user){const k=new Jl;return this._returnResult({data:{user:null,session:null},error:k})}return w.session&&(await this._saveSession(w.session),await this._notifyAllSubscribers("SIGNED_IN",w.session)),this._returnResult({data:Object.assign({},w),error:S})}catch(w){if(at(w))return this._returnResult({data:{user:null,session:null},error:w});throw w}}async signInWithSolana(t){var r,a,s,l,c,u,h,d,g,x,y,_;let b,w;if("message"in t)b=t.message,w=t.signature;else{const{chain:S,wallet:k,statement:C,options:T}=t;let j;if(sa())if(typeof k=="object")j=k;else{const D=window;if("solana"in D&&typeof D.solana=="object"&&("signIn"in D.solana&&typeof D.solana.signIn=="function"||"signMessage"in D.solana&&typeof D.solana.signMessage=="function"))j=D.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof k!="object"||!T?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");j=k}const X=new URL((r=T?.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in j&&j.signIn){const D=await j.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},T?.signInWithSolana),{version:"1",domain:X.host,uri:X.href}),C?{statement:C}:null));let N;if(Array.isArray(D)&&D[0]&&typeof D[0]=="object")N=D[0];else if(D&&typeof D=="object"&&"signedMessage"in D&&"signature"in D)N=D;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in N&&"signature"in N&&(typeof N.signedMessage=="string"||N.signedMessage instanceof Uint8Array)&&N.signature instanceof Uint8Array)b=typeof N.signedMessage=="string"?N.signedMessage:new TextDecoder().decode(N.signedMessage),w=N.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in j)||typeof j.signMessage!="function"||!("publicKey"in j)||typeof j!="object"||!j.publicKey||!("toBase58"in j.publicKey)||typeof j.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");b=[`${X.host} wants you to sign in with your Solana account:`,j.publicKey.toBase58(),...C?["",C,""]:[""],"Version: 1",`URI: ${X.href}`,`Issued At: ${(s=(a=T?.signInWithSolana)===null||a===void 0?void 0:a.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((l=T?.signInWithSolana)===null||l===void 0)&&l.notBefore?[`Not Before: ${T.signInWithSolana.notBefore}`]:[],...!((c=T?.signInWithSolana)===null||c===void 0)&&c.expirationTime?[`Expiration Time: ${T.signInWithSolana.expirationTime}`]:[],...!((u=T?.signInWithSolana)===null||u===void 0)&&u.chainId?[`Chain ID: ${T.signInWithSolana.chainId}`]:[],...!((h=T?.signInWithSolana)===null||h===void 0)&&h.nonce?[`Nonce: ${T.signInWithSolana.nonce}`]:[],...!((d=T?.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${T.signInWithSolana.requestId}`]:[],...!((x=(g=T?.signInWithSolana)===null||g===void 0?void 0:g.resources)===null||x===void 0)&&x.length?["Resources",...T.signInWithSolana.resources.map(N=>`- ${N}`)]:[]].join(`
`);const D=await j.signMessage(new TextEncoder().encode(b),"utf8");if(!D||!(D instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");w=D}}try{const{data:S,error:k}=await ct(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:b,signature:$i(w)},!((y=t.options)===null||y===void 0)&&y.captchaToken?{gotrue_meta_security:{captcha_token:(_=t.options)===null||_===void 0?void 0:_.captchaToken}}:null),xform:On});if(k)throw k;if(!S||!S.session||!S.user){const C=new Jl;return this._returnResult({data:{user:null,session:null},error:C})}return S.session&&(await this._saveSession(S.session),await this._notifyAllSubscribers("SIGNED_IN",S.session)),this._returnResult({data:Object.assign({},S),error:k})}catch(S){if(at(S))return this._returnResult({data:{user:null,session:null},error:S});throw S}}async _exchangeCodeForSession(t){const r=await Bi(this.storage,`${this.storageKey}-code-verifier`),[a,s]=(r??"").split("/");try{if(!a&&this.flowType==="pkce")throw new p4;const{data:l,error:c}=await ct(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:a},xform:On});if(await na(this.storage,`${this.storageKey}-code-verifier`),c)throw c;if(!l||!l.session||!l.user){const u=new Jl;return this._returnResult({data:{user:null,session:null,redirectType:null},error:u})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:Object.assign(Object.assign({},l),{redirectType:s??null}),error:c})}catch(l){if(await na(this.storage,`${this.storageKey}-code-verifier`),at(l))return this._returnResult({data:{user:null,session:null,redirectType:null},error:l});throw l}}async signInWithIdToken(t){try{const{options:r,provider:a,token:s,access_token:l,nonce:c}=t,u=await ct(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:a,id_token:s,access_token:l,nonce:c,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:On}),{data:h,error:d}=u;if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!h||!h.session||!h.user){const g=new Jl;return this._returnResult({data:{user:null,session:null},error:g})}return h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",h.session)),this._returnResult({data:h,error:d})}catch(r){if(at(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(t){var r,a,s,l,c;try{if("email"in t){const{email:u,options:h}=t;let d=null,g=null;this.flowType==="pkce"&&([d,g]=await Ql(this.storage,this.storageKey));const{error:x}=await ct(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:u,data:(r=h?.data)!==null&&r!==void 0?r:{},create_user:(a=h?.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:h?.captchaToken},code_challenge:d,code_challenge_method:g},redirectTo:h?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:x})}if("phone"in t){const{phone:u,options:h}=t,{data:d,error:g}=await ct(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:u,data:(s=h?.data)!==null&&s!==void 0?s:{},create_user:(l=h?.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:h?.captchaToken},channel:(c=h?.channel)!==null&&c!==void 0?c:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:d?.message_id},error:g})}throw new E0("You must provide either an email or phone number.")}catch(u){if(await na(this.storage,`${this.storageKey}-code-verifier`),at(u))return this._returnResult({data:{user:null,session:null},error:u});throw u}}async verifyOtp(t){var r,a;try{let s,l;"options"in t&&(s=(r=t.options)===null||r===void 0?void 0:r.redirectTo,l=(a=t.options)===null||a===void 0?void 0:a.captchaToken);const{data:c,error:u}=await ct(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:l}}),redirectTo:s,xform:On});if(u)throw u;if(!c)throw new Error("An error occurred on token verification.");const h=c.session,d=c.user;return h?.access_token&&(await this._saveSession(h),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",h)),this._returnResult({data:{user:d,session:h},error:null})}catch(s){if(at(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithSSO(t){var r,a,s,l,c;try{let u=null,h=null;this.flowType==="pkce"&&([u,h]=await Ql(this.storage,this.storageKey));const d=await ct(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&a!==void 0?a:void 0}),!((s=t?.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:u,code_challenge_method:h}),headers:this.headers,xform:z4});return!((l=d.data)===null||l===void 0)&&l.url&&sa()&&!(!((c=t.options)===null||c===void 0)&&c.skipBrowserRedirect)&&window.location.assign(d.data.url),this._returnResult(d)}catch(u){if(await na(this.storage,`${this.storageKey}-code-verifier`),at(u))return this._returnResult({data:null,error:u});throw u}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:a}=t;if(a)throw a;if(!r)throw new Ya;const{error:s}=await ct(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:s})})}catch(t){if(at(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:a,type:s,options:l}=t,{error:c}=await ct(this.fetch,"POST",r,{headers:this.headers,body:{email:a,type:s,gotrue_meta_security:{captcha_token:l?.captchaToken}},redirectTo:l?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:c})}else if("phone"in t){const{phone:a,type:s,options:l}=t,{data:c,error:u}=await ct(this.fetch,"POST",r,{headers:this.headers,body:{phone:a,type:s,gotrue_meta_security:{captcha_token:l?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:c?.message_id},error:u})}throw new E0("You must provide either an email or phone number and a type")}catch(r){if(at(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const a=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await a,await r()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const a=r();for(this.pendingInLock.push((async()=>{try{await a}catch{}})()),await a;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await a}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await Bi(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const a=t.expires_at?t.expires_at*1e3-Date.now()<kd:!1;if(this._debug("#__loadSession()",`session has${a?"":" not"} expired`,"expires_at",t.expires_at),!a){if(this.userStorage){const c=await Bi(this.userStorage,this.storageKey+"-user");c?.user?t.user=c.user:t.user=Nd()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const c={value:this.suppressGetSessionWarning};t.user=L4(t.user,c),c.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:s,error:l}=await this._callRefreshToken(t.refresh_token);return l?this._returnResult({data:{session:null},error:l}):this._returnResult({data:{session:s},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){if(t)return await this._getUser(t);await this.initializePromise;const r=await this._acquireLock(-1,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(t){try{return t?await ct(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:si}):await this._useSession(async r=>{var a,s,l;const{data:c,error:u}=r;if(u)throw u;return!(!((a=c.session)===null||a===void 0)&&a.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Ya}:await ct(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(l=(s=c.session)===null||s===void 0?void 0:s.access_token)!==null&&l!==void 0?l:void 0,xform:si})})}catch(r){if(at(r))return m4(r)&&(await this._removeSession(),await na(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async a=>{const{data:s,error:l}=a;if(l)throw l;if(!s.session)throw new Ya;const c=s.session;let u=null,h=null;this.flowType==="pkce"&&t.email!=null&&([u,h]=await Ql(this.storage,this.storageKey));const{data:d,error:g}=await ct(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:u,code_challenge_method:h}),jwt:c.access_token,xform:si});if(g)throw g;return c.user=d.user,await this._saveSession(c),await this._notifyAllSubscribers("USER_UPDATED",c),this._returnResult({data:{user:c.user},error:null})})}catch(a){if(await na(this.storage,`${this.storageKey}-code-verifier`),at(a))return this._returnResult({data:{user:null},error:a});throw a}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Ya;const r=Date.now()/1e3;let a=r,s=!0,l=null;const{payload:c}=Cd(t.access_token);if(c.exp&&(a=c.exp,s=a<=r),s){const{data:u,error:h}=await this._callRefreshToken(t.refresh_token);if(h)return this._returnResult({data:{user:null,session:null},error:h});if(!u)return{data:{user:null,session:null},error:null};l=u}else{const{data:u,error:h}=await this._getUser(t.access_token);if(h)throw h;l={access_token:t.access_token,refresh_token:t.refresh_token,user:u.user,token_type:"bearer",expires_in:a-r,expires_at:a},await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)}return this._returnResult({data:{user:l.user,session:l},error:null})}catch(r){if(at(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var a;if(!t){const{data:c,error:u}=r;if(u)throw u;t=(a=c.session)!==null&&a!==void 0?a:void 0}if(!t?.refresh_token)throw new Ya;const{data:s,error:l}=await this._callRefreshToken(t.refresh_token);return l?this._returnResult({data:{user:null,session:null},error:l}):s?this._returnResult({data:{user:s.user,session:s},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(at(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(t,r){try{if(!sa())throw new T0("No browser detected.");if(t.error||t.error_description||t.error_code)throw new T0(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new pv("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new T0("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new pv("No code detected.");const{data:C,error:T}=await this._exchangeCodeForSession(t.code);if(T)throw T;const j=new URL(window.location.href);return j.searchParams.delete("code"),window.history.replaceState(window.history.state,"",j.toString()),{data:{session:C.session,redirectType:null},error:null}}const{provider_token:a,provider_refresh_token:s,access_token:l,refresh_token:c,expires_in:u,expires_at:h,token_type:d}=t;if(!l||!u||!c||!d)throw new T0("No session defined in URL");const g=Math.round(Date.now()/1e3),x=parseInt(u);let y=g+x;h&&(y=parseInt(h));const _=y-g;_*1e3<=io&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${_}s, should have been closer to ${x}s`);const b=y-x;g-b>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",b,y,g):g-b<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",b,y,g);const{data:w,error:S}=await this._getUser(l);if(S)throw S;const k={provider_token:a,provider_refresh_token:s,access_token:l,expires_in:x,expires_at:y,refresh_token:c,token_type:d,user:w.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:k,redirectType:t.type},error:null})}catch(a){if(at(a))return this._returnResult({data:{session:null,redirectType:null},error:a});throw a}}_isImplicitGrantCallback(t){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),t):!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await Bi(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var a;const{data:s,error:l}=r;if(l)return this._returnResult({error:l});const c=(a=s.session)===null||a===void 0?void 0:a.access_token;if(c){const{error:u}=await this.admin.signOut(c,t);if(u&&!(d4(u)&&(u.status===404||u.status===401||u.status===403)))return this._returnResult({error:u})}return t!=="others"&&(await this._removeSession(),await na(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const r=S4(),a={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,a),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:a}}}async _emitInitialSession(t){return await this._useSession(async r=>{var a,s;try{const{data:{session:l},error:c}=r;if(c)throw c;await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",l)),this._debug("INITIAL_SESSION","callback id",t,"session",l)}catch(l){await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",l),console.error(l)}})}async resetPasswordForEmail(t,r={}){let a=null,s=null;this.flowType==="pkce"&&([a,s]=await Ql(this.storage,this.storageKey,!0));try{return await ct(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:a,code_challenge_method:s,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(l){if(await na(this.storage,`${this.storageKey}-code-verifier`),at(l))return this._returnResult({data:null,error:l});throw l}}async getUserIdentities(){var t;try{const{data:r,error:a}=await this.getUser();if(a)throw a;return this._returnResult({data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(r){if(at(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:a,error:s}=await this._useSession(async l=>{var c,u,h,d,g;const{data:x,error:y}=l;if(y)throw y;const _=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(c=t.options)===null||c===void 0?void 0:c.redirectTo,scopes:(u=t.options)===null||u===void 0?void 0:u.scopes,queryParams:(h=t.options)===null||h===void 0?void 0:h.queryParams,skipBrowserRedirect:!0});return await ct(this.fetch,"GET",_,{headers:this.headers,jwt:(g=(d=x.session)===null||d===void 0?void 0:d.access_token)!==null&&g!==void 0?g:void 0})});if(s)throw s;return sa()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(a?.url),this._returnResult({data:{provider:t.provider,url:a?.url},error:null})}catch(a){if(at(a))return this._returnResult({data:{provider:t.provider,url:null},error:a});throw a}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var a;try{const{error:s,data:{session:l}}=r;if(s)throw s;const{options:c,provider:u,token:h,access_token:d,nonce:g}=t,x=await ct(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(a=l?.access_token)!==null&&a!==void 0?a:void 0,body:{provider:u,id_token:h,access_token:d,nonce:g,link_identity:!0,gotrue_meta_security:{captcha_token:c?.captchaToken}},xform:On}),{data:y,error:_}=x;return _?this._returnResult({data:{user:null,session:null},error:_}):!y||!y.session||!y.user?this._returnResult({data:{user:null,session:null},error:new Jl}):(y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("USER_UPDATED",y.session)),this._returnResult({data:y,error:_}))}catch(s){if(await na(this.storage,`${this.storageKey}-code-verifier`),at(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var a,s;const{data:l,error:c}=r;if(c)throw c;return await ct(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(s=(a=l.session)===null||a===void 0?void 0:a.access_token)!==null&&s!==void 0?s:void 0})})}catch(r){if(at(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const a=Date.now();return await A4(async s=>(s>0&&await k4(200*Math.pow(2,s-1)),this._debug(r,"refreshing attempt",s),await ct(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:On})),(s,l)=>{const c=200*Math.pow(2,s);return l&&Ad(l)&&Date.now()+c-a<io})}catch(a){if(this._debug(r,"error",a),at(a))return this._returnResult({data:{session:null,user:null},error:a});throw a}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const a=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",a),sa()&&!r.skipBrowserRedirect&&window.location.assign(a),{data:{provider:t,url:a},error:null}}async _recoverAndRefresh(){var t,r;const a="#_recoverAndRefresh()";this._debug(a,"begin");try{const s=await Bi(this.storage,this.storageKey);if(s&&this.userStorage){let c=await Bi(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!c&&(c={user:s.user},await lo(this.userStorage,this.storageKey+"-user",c)),s.user=(t=c?.user)!==null&&t!==void 0?t:Nd()}else if(s&&!s.user&&!s.user){const c=await Bi(this.storage,this.storageKey+"-user");c&&c?.user?(s.user=c.user,await na(this.storage,this.storageKey+"-user"),await lo(this.storage,this.storageKey,s)):s.user=Nd()}if(this._debug(a,"session from storage",s),!this._isValidSession(s)){this._debug(a,"session is not valid"),s!==null&&await this._removeSession();return}const l=((r=s.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<kd;if(this._debug(a,`session has${l?"":" not"} expired with margin of ${kd}s`),l){if(this.autoRefreshToken&&s.refresh_token){const{error:c}=await this._callRefreshToken(s.refresh_token);c&&(console.error(c),Ad(c)||(this._debug(a,"refresh failed with a non-retryable error, removing the session",c),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:c,error:u}=await this._getUser(s.access_token);!u&&c?.user?(s.user=c.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(a,"could not get user data, skipping SIGNED_IN notification")}catch(c){console.error("Error getting user data:",c),this._debug(a,"error getting user data, skipping SIGNED_IN notification",c)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(a,"error",s),console.error(s);return}finally{this._debug(a,"end")}}async _callRefreshToken(t){var r,a;if(!t)throw new Ya;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new lf;const{data:l,error:c}=await this._refreshAccessToken(t);if(c)throw c;if(!l.session)throw new Ya;await this._saveSession(l.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",l.session);const u={data:l.session,error:null};return this.refreshingDeferred.resolve(u),u}catch(l){if(this._debug(s,"error",l),at(l)){const c={data:null,error:l};return Ad(l)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(c),c}throw(a=this.refreshingDeferred)===null||a===void 0||a.reject(l),l}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(t,r,a=!0){const s=`#_notifyAllSubscribers(${t})`;this._debug(s,"begin",r,`broadcast = ${a}`);try{this.broadcastChannel&&a&&this.broadcastChannel.postMessage({event:t,session:r});const l=[],c=Array.from(this.stateChangeEmitters.values()).map(async u=>{try{await u.callback(t,r)}catch(h){l.push(h)}});if(await Promise.all(c),l.length>0){for(let u=0;u<l.length;u+=1)console.error(l[u]);throw l[0]}}finally{this._debug(s,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await na(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},t),a=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!a&&r.user&&await lo(this.userStorage,this.storageKey+"-user",{user:r.user});const s=Object.assign({},r);delete s.user;const l=wv(s);await lo(this.storage,this.storageKey,l)}else{const s=wv(r);await lo(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await na(this.storage,this.storageKey),await na(this.storage,this.storageKey+"-code-verifier"),await na(this.storage,this.storageKey+"-user"),this.userStorage&&await na(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&sa()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),io);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:a}}=r;if(!a||!a.refresh_token||!a.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((a.expires_at*1e3-t)/io);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${io}ms, refresh threshold is ${em} ticks`),s<=em&&await this._callRefreshToken(a.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof c_)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!sa()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,a){const s=[`provider=${encodeURIComponent(r)}`];if(a?.redirectTo&&s.push(`redirect_to=${encodeURIComponent(a.redirectTo)}`),a?.scopes&&s.push(`scopes=${encodeURIComponent(a.scopes)}`),this.flowType==="pkce"){const[l,c]=await Ql(this.storage,this.storageKey),u=new URLSearchParams({code_challenge:`${encodeURIComponent(l)}`,code_challenge_method:`${encodeURIComponent(c)}`});s.push(u.toString())}if(a?.queryParams){const l=new URLSearchParams(a.queryParams);s.push(l.toString())}return a?.skipBrowserRedirect&&s.push(`skip_http_redirect=${a.skipBrowserRedirect}`),`${t}?${s.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var a;const{data:s,error:l}=r;return l?this._returnResult({data:null,error:l}):await ct(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(a=s?.session)===null||a===void 0?void 0:a.access_token})})}catch(r){if(at(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(t){try{return await this._useSession(async r=>{var a,s;const{data:l,error:c}=r;if(c)return this._returnResult({data:null,error:c});const u=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:h,error:d}=await ct(this.fetch,"POST",`${this.url}/factors`,{body:u,headers:this.headers,jwt:(a=l?.session)===null||a===void 0?void 0:a.access_token});return d?this._returnResult({data:null,error:d}):(t.factorType==="totp"&&h.type==="totp"&&(!((s=h?.totp)===null||s===void 0)&&s.qr_code)&&(h.totp.qr_code=`data:image/svg+xml;utf-8,${h.totp.qr_code}`),this._returnResult({data:h,error:null}))})}catch(r){if(at(r))return this._returnResult({data:null,error:r});throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var a;const{data:s,error:l}=r;if(l)return this._returnResult({data:null,error:l});const c=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?ak(t.webauthn.credential_response):nk(t.webauthn.credential_response)})}:{code:t.code}),{data:u,error:h}=await ct(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:c,headers:this.headers,jwt:(a=s?.session)===null||a===void 0?void 0:a.access_token});return h?this._returnResult({data:null,error:h}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+u.expires_in},u)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",u),this._returnResult({data:u,error:h}))})}catch(r){if(at(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var a;const{data:s,error:l}=r;if(l)return this._returnResult({data:null,error:l});const c=await ct(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(a=s?.session)===null||a===void 0?void 0:a.access_token});if(c.error)return c;const{data:u}=c;if(u.type!=="webauthn")return{data:u,error:null};switch(u.webauthn.type){case"create":return{data:Object.assign(Object.assign({},u),{webauthn:Object.assign(Object.assign({},u.webauthn),{credential_options:Object.assign(Object.assign({},u.webauthn.credential_options),{publicKey:tk(u.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},u),{webauthn:Object.assign(Object.assign({},u.webauthn),{credential_options:Object.assign(Object.assign({},u.webauthn.credential_options),{publicKey:rk(u.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(at(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(t){const{data:r,error:a}=await this._challenge({factorId:t.factorId});return a?this._returnResult({data:null,error:a}):await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:a}=await this.getUser();if(a)return{data:null,error:a};const s={all:[],phone:[],totp:[],webauthn:[]};for(const l of(t=r?.factors)!==null&&t!==void 0?t:[])s.all.push(l),l.status==="verified"&&s[l.factor_type].push(l);return{data:s,error:null}}async _getAuthenticatorAssuranceLevel(){var t,r;const{data:{session:a},error:s}=await this.getSession();if(s)return this._returnResult({data:null,error:s});if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:l}=Cd(a.access_token);let c=null;l.aal&&(c=l.aal);let u=c;((r=(t=a.user.factors)===null||t===void 0?void 0:t.filter(g=>g.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(u="aal2");const d=l.amr||[];return{data:{currentLevel:c,nextLevel:u,currentAuthenticationMethods:d},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async r=>{const{data:{session:a},error:s}=r;return s?this._returnResult({data:null,error:s}):a?await ct(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:a.access_token,xform:l=>({data:l,error:null})}):this._returnResult({data:null,error:new Ya})})}catch(r){if(at(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(t,r){try{return await this._useSession(async a=>{const{data:{session:s},error:l}=a;if(l)return this._returnResult({data:null,error:l});if(!s)return this._returnResult({data:null,error:new Ya});const c=await ct(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"approve"},xform:u=>({data:u,error:null})});return c.data&&c.data.redirect_url&&sa()&&!r?.skipBrowserRedirect&&window.location.assign(c.data.redirect_url),c})}catch(a){if(at(a))return this._returnResult({data:null,error:a});throw a}}async _denyAuthorization(t,r){try{return await this._useSession(async a=>{const{data:{session:s},error:l}=a;if(l)return this._returnResult({data:null,error:l});if(!s)return this._returnResult({data:null,error:new Ya});const c=await ct(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"deny"},xform:u=>({data:u,error:null})});return c.data&&c.data.redirect_url&&sa()&&!r?.skipBrowserRedirect&&window.location.assign(c.data.redirect_url),c})}catch(a){if(at(a))return this._returnResult({data:null,error:a});throw a}}async _listOAuthGrants(){try{return await this._useSession(async t=>{const{data:{session:r},error:a}=t;return a?this._returnResult({data:null,error:a}):r?await ct(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:s=>({data:s,error:null})}):this._returnResult({data:null,error:new Ya})})}catch(t){if(at(t))return this._returnResult({data:null,error:t});throw t}}async _revokeOAuthGrant(t){try{return await this._useSession(async r=>{const{data:{session:a},error:s}=r;return s?this._returnResult({data:null,error:s}):a?(await ct(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:a.access_token,query:{client_id:t.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new Ya})})}catch(r){if(at(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(t,r={keys:[]}){let a=r.keys.find(u=>u.kid===t);if(a)return a;const s=Date.now();if(a=this.jwks.keys.find(u=>u.kid===t),a&&this.jwks_cached_at+f4>s)return a;const{data:l,error:c}=await ct(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(c)throw c;return!l.keys||l.keys.length===0||(this.jwks=l,this.jwks_cached_at=s,a=l.keys.find(u=>u.kid===t),!a)?null:a}async getClaims(t,r={}){try{let a=t;if(!a){const{data:_,error:b}=await this.getSession();if(b||!_.session)return this._returnResult({data:null,error:b});a=_.session.access_token}const{header:s,payload:l,signature:c,raw:{header:u,payload:h}}=Cd(a);r?.allowExpired||M4(l.exp);const d=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,r?.keys?{keys:r.keys}:r?.jwks);if(!d){const{error:_}=await this.getUser(a);if(_)throw _;return{data:{claims:l,header:s,signature:c},error:null}}const g=j4(s.alg),x=await crypto.subtle.importKey("jwk",d,g,!0,["verify"]);if(!await crypto.subtle.verify(g,x,c,w4(`${u}.${h}`)))throw new am("Invalid JWT signature");return{data:{claims:l,header:s,signature:c},error:null}}catch(a){if(at(a))return this._returnResult({data:null,error:a});throw a}}}Bc.nextInstanceID={};const dk=Bc,mk="2.89.0";let _c="";typeof Deno<"u"?_c="deno":typeof document<"u"?_c="web":typeof navigator<"u"&&navigator.product==="ReactNative"?_c="react-native":_c="node";const gk={"X-Client-Info":`supabase-js-${_c}/${mk}`},pk={headers:gk},xk={schema:"public"},vk={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},yk={};function Uc(e){"@babel/helpers - typeof";return Uc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uc(e)}function _k(e,t){if(Uc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Uc(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wk(e){var t=_k(e,"string");return Uc(t)=="symbol"?t:t+""}function bk(e,t,r){return(t=wk(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Cv(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function yr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Cv(Object(r),!0).forEach(function(a){bk(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Cv(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}const Sk=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),Ek=()=>Headers,Tk=(e,t,r)=>{const a=Sk(r),s=Ek();return async(l,c)=>{var u;const h=(u=await t())!==null&&u!==void 0?u:e;let d=new s(c?.headers);return d.has("apikey")||d.set("apikey",e),d.has("Authorization")||d.set("Authorization",`Bearer ${h}`),a(l,yr(yr({},c),{},{headers:d}))}};function kk(e){return e.endsWith("/")?e:e+"/"}function Ak(e,t){var r,a;const{db:s,auth:l,realtime:c,global:u}=e,{db:h,auth:d,realtime:g,global:x}=t,y={db:yr(yr({},h),s),auth:yr(yr({},d),l),realtime:yr(yr({},g),c),storage:{},global:yr(yr(yr({},x),u),{},{headers:yr(yr({},(r=x?.headers)!==null&&r!==void 0?r:{}),(a=u?.headers)!==null&&a!==void 0?a:{})}),accessToken:async()=>""};return e.accessToken?y.accessToken=e.accessToken:delete y.accessToken,y}function Ck(e){const t=e?.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(kk(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var Nk=class extends dk{constructor(e){super(e)}},Ok=class{constructor(e,t,r){var a,s;this.supabaseUrl=e,this.supabaseKey=t;const l=Ck(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,u={db:xk,realtime:yk,auth:yr(yr({},vk),{},{storageKey:c}),global:pk},h=Ak(r??{},u);if(this.storageKey=(a=h.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(s=h.global.headers)!==null&&s!==void 0?s:{},h.accessToken)this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(g,x)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(x)} is not possible`)}});else{var d;this.auth=this._initSupabaseAuthClient((d=h.auth)!==null&&d!==void 0?d:{},this.headers,h.global.fetch)}this.fetch=Tk(t,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(yr({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.accessToken&&this.accessToken().then(g=>this.realtime.setAuth(g)).catch(g=>console.warn("Failed to set initial Realtime auth token:",g)),this.rest=new cT(new URL("rest/v1",l).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),this.storage=new i4(this.storageUrl.href,this.headers,this.fetch,r?.storage),h.accessToken||this._listenForAuthEvents()}get functions(){return new nT(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e=this,t,r;if(e.accessToken)return await e.accessToken();const{data:a}=await e.auth.getSession();return(t=(r=a.session)===null||r===void 0?void 0:r.access_token)!==null&&t!==void 0?t:e.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:a,userStorage:s,storageKey:l,flowType:c,lock:u,debug:h,throwOnError:d},g,x){const y={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Nk({url:this.authUrl.href,headers:yr(yr({},y),g),storageKey:l,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:a,userStorage:s,flowType:c,lock:u,debug:h,throwOnError:d,fetch:x,hasCustomAuthorizationHeader:Object.keys(this.headers).some(_=>_.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new kT(this.realtimeUrl.href,yr(yr({},e),{},{params:yr(yr({},{apikey:this.supabaseKey}),e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",t?.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const Rk=(e,t,r)=>new Ok(e,t,r);function Dk(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}Dk()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const $0="",Fk="",ni=!!$0,k0=(()=>{try{return $0&&new URL($0).hostname.split(".")[0]||null}catch{return null}})(),A0="supabase",Nv=ni?Rk($0,Fk,{auth:{persistSession:!0,autoRefreshToken:!0}}):null,Fr={medications:"bodegapp:medications",monthlyBatches:"bodegapp:monthlyBatches",selectedMonthlyBatchId:"bodegapp:selectedMonthlyBatchId",tertiaryPackaging:"bodegapp:tertiaryPackaging",medicationCategories:"bodegapp:medicationCategories",orderCalendar:"bodegapp:orderCalendar"},Mk=[{id:1,inventory_type:"772",name:"Paracetamol",siges_code:"SIG-0001",sicop_classifier:"SICOP-CL-01",sicop_identifier:"SICOP-ID-0001",category:"Analgsico",batch:"LOT-2023-01",expiry_date:"2025-12-30",stock:500,min_stock:100,unit:"Tabletas"},{id:2,inventory_type:"772",name:"Amoxicilina",siges_code:"SIG-0002",sicop_classifier:"SICOP-CL-02",sicop_identifier:"SICOP-ID-0002",category:"Antibiotico",batch:"LOT-2023-05",expiry_date:"2024-06-15",stock:45,min_stock:50,unit:"Cpsulas"},{id:3,inventory_type:"772",name:"Ibuprofeno",siges_code:"SIG-0003",sicop_classifier:"SICOP-CL-03",sicop_identifier:"SICOP-ID-0003",category:"Antiinflamatorio",batch:"LOT-2023-09",expiry_date:"2026-01-20",stock:120,min_stock:40,unit:"Jarabe"},{id:4,inventory_type:"772",name:"Omeprazol",siges_code:"SIG-0004",sicop_classifier:"SICOP-CL-04",sicop_identifier:"SICOP-ID-0004",category:"Protector Gstrico",batch:"LOT-2023-12",expiry_date:"2025-03-10",stock:15,min_stock:30,unit:"Cpsulas"}];function h_(e){try{return JSON.parse(e)}catch{return null}}function vc(e){const t=window.localStorage.getItem(e);if(!t)return null;const r=h_(t);return Array.isArray(r)?r:null}function Ia(e,t){window.localStorage.setItem(e,JSON.stringify(t))}const jk={async getMedications(){return vc(Fr.medications)??Mk},async clearMedicationsByInventoryType(e){const t=String(e||"772"),a=(await this.getMedications()??[]).filter(s=>String(s.inventory_type||"772")!==t);return Ia(Fr.medications,a),a},async upsertMedication(e){const t=await this.getMedications()??[],r=e?.id,a=r==null?[...t,e]:t.some(s=>s.id===r)?t.map(s=>s.id===r?e:s):[...t,e];return Ia(Fr.medications,a),e},async upsertMedications(e){const t=await this.getMedications()??[],r=new Map(t.map(s=>[s.id,s]));for(const s of e)r.set(s.id,s);const a=Array.from(r.values());return Ia(Fr.medications,a),a},async deleteMedication(e){const r=(await this.getMedications()??[]).filter(a=>a.id!==e);Ia(Fr.medications,r)},async clearMedications(){Ia(Fr.medications,[])},async getMonthlyBatches(){return(vc(Fr.monthlyBatches)??[]).map(t=>({...t,id:t?.id!=null?String(t.id):t.id}))},async saveMonthlyBatch(e){const t=await this.getMonthlyBatches()??[],r={...e,id:e?.id!=null?String(e.id):e.id},a=[r,...t.filter(s=>String(s.id)!==String(r.id))];return Ia(Fr.monthlyBatches,a),r},async getSelectedMonthlyBatchId(){const e=window.localStorage.getItem(Fr.selectedMonthlyBatchId),t=e?h_(e)??e:null;return t==null?null:String(t)},async setSelectedMonthlyBatchId(e){Ia(Fr.selectedMonthlyBatchId,e)},async getTertiaryPackaging(){return vc(Fr.tertiaryPackaging)??[]},async upsertTertiaryPackaging(e){const t=await this.getTertiaryPackaging()??[],r=new Map(t.map(s=>[String(s.siges_code||"").trim(),s]));for(const s of e??[]){const l=String(s?.siges_code||"").trim();l&&r.set(l,{...s,siges_code:l})}const a=Array.from(r.values());return Ia(Fr.tertiaryPackaging,a),a},async clearTertiaryPackaging(){Ia(Fr.tertiaryPackaging,[])},async getMedicationCategories(){return vc(Fr.medicationCategories)??[]},async upsertMedicationCategories(e){const t=await this.getMedicationCategories()??[],r=new Map(t.map(s=>[String(s.siges_code||"").trim(),s]));for(const s of e??[]){const l=String(s?.siges_code||"").trim();l&&r.set(l,{...s,siges_code:l})}const a=Array.from(r.values());return Ia(Fr.medicationCategories,a),a},async clearMedicationCategories(){Ia(Fr.medicationCategories,[])},async deleteMedicationCategory(e){const r=(await this.getMedicationCategories()??[]).filter(a=>String(a.id)!==String(e));Ia(Fr.medicationCategories,r)},async getOrderCalendar(){return vc(Fr.orderCalendar)??[]},async upsertOrderCalendarEntries(e){const t=await this.getOrderCalendar()??[],r=new Map(t.map(s=>[`${Number(s.year)||0}-${Number(s.month)||0}`,s]));for(const s of e??[]){const l=Number(s?.year)||0,c=Number(s?.month)||0;if(!l||c<1||c>12)continue;const u=`${l}-${c}`;r.set(u,{...s,year:l,month:c,scheduled_receipt_date:s?.scheduled_receipt_date?String(s.scheduled_receipt_date):null})}const a=Array.from(r.values());return Ia(Fr.orderCalendar,a),a},async clearOrderCalendar(){Ia(Fr.orderCalendar,[])}};function Wr(){if(!Nv)throw new Error("Supabase no est configurado (faltan VITE_SUPABASE_URL / VITE_SUPABASE_ANON_KEY).");return Nv}function Ov(e){return e?.id?e:globalThis.crypto?.randomUUID?{...e,id:globalThis.crypto.randomUUID()}:{...e,id:String(Date.now())}}const Ik={async getMedications(){const e=Wr(),t=1e3;let r=0;const a=[];for(;;){const{data:s,error:l}=await e.from("medications").select("*").order("created_at",{ascending:!0}).range(r,r+t-1);if(l)throw l;const c=s??[];if(a.push(...c),c.length<t)break;r+=t}return a},async clearMedicationsByInventoryType(e){const t=Wr(),r=String(e||"772"),{error:a}=await t.from("medications").delete().eq("inventory_type",r);if(a)throw a},async upsertMedication(e){const t=Wr(),r=Ov(e),{data:a,error:s}=await t.from("medications").upsert(r,{onConflict:"id"}).select("*").single();if(s)throw s;return a},async upsertMedications(e){const t=Wr(),r=(e??[]).map(Ov),{data:a,error:s}=await t.from("medications").upsert(r,{onConflict:"id"}).select("*");if(s)throw s;return a??[]},async deleteMedication(e){const t=Wr(),{error:r}=await t.from("medications").delete().eq("id",e);if(r)throw r},async clearMedications(){const e=Wr(),{error:t}=await e.from("medications").delete().neq("id","00000000-0000-0000-0000-000000000000");if(t)throw t},async getMonthlyBatches(){const e=Wr(),{data:t,error:r}=await e.from("monthly_batches").select("id,label,items:monthly_batch_items(id,siges_code,medication_name,quantity,cost)").order("created_at",{ascending:!1});if(r)throw r;return(t??[]).map(a=>({...a,items:a.items??[]}))},async saveMonthlyBatch({id:e,label:t,items:r}){const a=Wr(),{data:s,error:l}=await a.from("monthly_batches").upsert({id:e,label:t},{onConflict:"label"}).select("id,label").single();if(l)throw l;const{error:c}=await a.from("monthly_batch_items").delete().eq("batch_id",s.id);if(c)throw c;const u=(r??[]).map(h=>({id:globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():String(Date.now())+Math.random(),batch_id:s.id,siges_code:h.siges_code,medication_name:h.medication_name,quantity:h.quantity,cost:h.cost}));if(u.length>0){const{error:h}=await a.from("monthly_batch_items").insert(u);if(h)throw h}return{...s,items:r}},async getSelectedMonthlyBatchId(){return null},async setSelectedMonthlyBatchId(){},async getTertiaryPackaging(){const e=Wr(),{data:t,error:r}=await e.from("tertiary_packaging").select("*").order("siges_code",{ascending:!0});if(r)throw r;return t??[]},async upsertTertiaryPackaging(e){const t=Wr(),a=(e??[]).map(c=>({id:c?.id||(globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():String(Date.now())+Math.random()),siges_code:String(c?.siges_code||"").trim(),medication_name:String(c?.medication_name||"").trim(),tertiary_quantity:Number(c?.tertiary_quantity)||0})).filter(c=>!!c.siges_code);if(a.length===0)return[];const{data:s,error:l}=await t.from("tertiary_packaging").upsert(a,{onConflict:"siges_code"}).select("*");if(l)throw l;return s??[]},async clearTertiaryPackaging(){const e=Wr(),{error:t}=await e.from("tertiary_packaging").delete().neq("id","00000000-0000-0000-0000-000000000000");if(t)throw t},async getMedicationCategories(){const e=Wr(),{data:t,error:r}=await e.from("medication_categories").select("*").order("siges_code",{ascending:!0});if(r)throw r;return t??[]},async upsertMedicationCategories(e){const t=Wr(),a=(e??[]).map(c=>({id:c?.id||(globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():String(Date.now())+Math.random()),siges_code:String(c?.siges_code||"").trim(),medication_name:String(c?.medication_name||"").trim(),category:String(c?.category||"").trim()})).filter(c=>!!(c.siges_code&&c.category));if(a.length===0)return[];const{data:s,error:l}=await t.from("medication_categories").upsert(a,{onConflict:"siges_code"}).select("*");if(l)throw l;return s??[]},async clearMedicationCategories(){const e=Wr(),{error:t}=await e.from("medication_categories").delete().neq("id","00000000-0000-0000-0000-000000000000");if(t)throw t},async deleteMedicationCategory(e){const t=Wr(),{error:r}=await t.from("medication_categories").delete().eq("id",e);if(r)throw r},async getOrderCalendar(){const e=Wr(),{data:t,error:r}=await e.from("order_calendar").select("*").order("year",{ascending:!0}).order("month",{ascending:!0});if(r)throw r;return t??[]},async upsertOrderCalendarEntries(e){const t=Wr(),a=(e??[]).map(c=>({id:c?.id||(globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():String(Date.now())+Math.random()),year:Number(c?.year)||0,month:Number(c?.month)||0,scheduled_receipt_date:c?.scheduled_receipt_date?String(c.scheduled_receipt_date):null})).filter(c=>c.year&&c.month>=1&&c.month<=12);if(a.length===0)return[];const{data:s,error:l}=await t.from("order_calendar").upsert(a,{onConflict:"year,month"}).select("*");if(l)throw l;return s??[]},async clearOrderCalendar(){const e=Wr(),{error:t}=await e.from("order_calendar").delete().neq("id","00000000-0000-0000-0000-000000000000");if(t)throw t}},bt=ni?Ik:jk;var V0={};V0.version="0.18.5";var d_=1252,Lk=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Sm={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Em=function(e){Lk.indexOf(e)!=-1&&(d_=Sm[0]=e)};function Bk(){Em(1252)}var Fn=function(e){Em(e)};function Tm(){Fn(1200),Bk()}function Rv(e){for(var t=[],r=0,a=e.length;r<a;++r)t[r]=e.charCodeAt(r);return t}function Uk(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function m_(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var wc=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?Uk(e.slice(2)):t==254&&r==255?m_(e.slice(2)):t==65279?e.slice(1):e},C0=function(t){return String.fromCharCode(t)},Dv=function(t){return String.fromCharCode(t)},Pc,ii="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function zc(e){for(var t="",r=0,a=0,s=0,l=0,c=0,u=0,h=0,d=0;d<e.length;)r=e.charCodeAt(d++),l=r>>2,a=e.charCodeAt(d++),c=(r&3)<<4|a>>4,s=e.charCodeAt(d++),u=(a&15)<<2|s>>6,h=s&63,isNaN(a)?u=h=64:isNaN(s)&&(h=64),t+=ii.charAt(l)+ii.charAt(c)+ii.charAt(u)+ii.charAt(h);return t}function an(e){var t="",r=0,a=0,s=0,l=0,c=0,u=0,h=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<e.length;)l=ii.indexOf(e.charAt(d++)),c=ii.indexOf(e.charAt(d++)),r=l<<2|c>>4,t+=String.fromCharCode(r),u=ii.indexOf(e.charAt(d++)),a=(c&15)<<4|u>>2,u!==64&&(t+=String.fromCharCode(a)),h=ii.indexOf(e.charAt(d++)),s=(u&3)<<6|h,h!==64&&(t+=String.fromCharCode(s));return t}var Tt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),ks=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function oi(e){return Tt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Fv(e){return Tt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var tn=function(t){return Tt?ks(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function of(e){if(typeof ArrayBuffer>"u")return tn(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),a=0;a!=e.length;++a)r[a]=e.charCodeAt(a)&255;return t}function hi(e){if(Array.isArray(e))return e.map(function(a){return String.fromCharCode(a)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function Pk(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function km(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return km(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Yr=Tt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:ks(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var a=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)a.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";a.set(new Uint8Array(e[t]),r)}return a}return[].concat.apply([],e.map(function(l){return Array.isArray(l)?l:[].slice.call(l)}))};function zk(e){for(var t=[],r=0,a=e.length+250,s=oi(e.length+255),l=0;l<e.length;++l){var c=e.charCodeAt(l);if(c<128)s[r++]=c;else if(c<2048)s[r++]=192|c>>6&31,s[r++]=128|c&63;else if(c>=55296&&c<57344){c=(c&1023)+64;var u=e.charCodeAt(++l)&1023;s[r++]=240|c>>8&7,s[r++]=128|c>>2&63,s[r++]=128|u>>6&15|(c&3)<<4,s[r++]=128|u&63}else s[r++]=224|c>>12&15,s[r++]=128|c>>6&63,s[r++]=128|c&63;r>a&&(t.push(s.slice(0,r)),r=0,s=oi(65535),a=65530)}return t.push(s.slice(0,r)),Yr(t)}var Ta=/\u0000/g,bc=/[\u0001-\u0006]/g;function ho(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Mn(e,t){var r=""+e;return r.length>=t?r:_r("0",t-r.length)+r}function Am(e,t){var r=""+e;return r.length>=t?r:_r(" ",t-r.length)+r}function G0(e,t){var r=""+e;return r.length>=t?r:r+_r(" ",t-r.length)}function Hk(e,t){var r=""+Math.round(e);return r.length>=t?r:_r("0",t-r.length)+r}function $k(e,t){var r=""+e;return r.length>=t?r:_r("0",t-r.length)+r}var Mv=Math.pow(2,32);function ro(e,t){if(e>Mv||e<-Mv)return Hk(e,t);var r=Math.round(e);return $k(r,t)}function q0(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var jv=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Rd=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Vk(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var ft={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Iv={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Gk={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function X0(e,t,r){for(var a=e<0?-1:1,s=e*a,l=0,c=1,u=0,h=1,d=0,g=0,x=Math.floor(s);d<t&&(x=Math.floor(s),u=x*c+l,g=x*d+h,!(s-x<5e-8));)s=1/(s-x),l=c,c=u,h=d,d=g;if(g>t&&(d>t?(g=h,u=l):(g=d,u=c)),!r)return[0,a*u,g];var y=Math.floor(a*u/g);return[y,a*u-y*g,g]}function Vi(e,t,r){if(e>2958465||e<0)return null;var a=e|0,s=Math.floor(86400*(e-a)),l=0,c=[],u={D:a,T:s,u:86400*(e-a)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),t&&t.date1904&&(a+=1462),u.u>.9999&&(u.u=0,++s==86400&&(u.T=s=0,++a,++u.D)),a===60)c=r?[1317,10,29]:[1900,2,29],l=3;else if(a===0)c=r?[1317,8,29]:[1900,1,0],l=6;else{a>60&&--a;var h=new Date(1900,0,1);h.setDate(h.getDate()+a-1),c=[h.getFullYear(),h.getMonth()+1,h.getDate()],l=h.getDay(),a<60&&(l=(l+6)%7),r&&(l=Jk(h,c))}return u.y=c[0],u.m=c[1],u.d=c[2],u.S=s%60,s=Math.floor(s/60),u.M=s%60,s=Math.floor(s/60),u.H=s,u.q=l,u}var g_=new Date(1899,11,31,0,0,0),qk=g_.getTime(),Xk=new Date(1900,2,1,0,0,0);function p_(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=Xk&&(r+=1440*60*1e3),(r-(qk+(e.getTimezoneOffset()-g_.getTimezoneOffset())*6e4))/(1440*60*1e3)}function Cm(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Wk(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Kk(e){var t=e<0?12:11,r=Cm(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function Yk(e){var t=Cm(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Hc(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=Kk(e):t===10?r=e.toFixed(10).substr(0,12):r=Yk(e),Cm(Wk(r.toUpperCase()))}function Yi(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Hc(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return wn(14,p_(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Jk(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function Qk(e,t,r,a){var s="",l=0,c=0,u=r.y,h,d=0;switch(e){case 98:u=r.y+543;case 121:switch(t.length){case 1:case 2:h=u%100,d=2;break;default:h=u%1e4,d=4;break}break;case 109:switch(t.length){case 1:case 2:h=r.m,d=t.length;break;case 3:return Rd[r.m-1][1];case 5:return Rd[r.m-1][0];default:return Rd[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:h=r.d,d=t.length;break;case 3:return jv[r.q][0];default:return jv[r.q][1]}break;case 104:switch(t.length){case 1:case 2:h=1+(r.H+11)%12,d=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:h=r.H,d=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:h=r.M,d=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Mn(r.S,t.length):(a>=2?c=a===3?1e3:100:c=a===1?10:1,l=Math.round(c*(r.S+r.u)),l>=60*c&&(l=0),t==="s"?l===0?"0":""+l/c:(s=Mn(l,2+a),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":h=r.D*24+r.H;break;case"[m]":case"[mm]":h=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":h=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}d=t.length===3?1:2;break;case 101:h=u,d=1;break}var g=d>0?Mn(h,d):"";return g}function li(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,a=e.substr(0,r);r!=e.length;r+=t)a+=(a.length>0?",":"")+e.substr(r,t);return a}var x_=/%/g;function Zk(e,t,r){var a=t.replace(x_,""),s=t.length-a.length;return ws(e,a,r*Math.pow(10,2*s))+_r("%",s)}function eA(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return ws(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function v_(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+v_(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var l=Math.floor(Math.log(t)*Math.LOG10E)%s;if(l<0&&(l+=s),r=(t/Math.pow(10,l)).toPrecision(a+1+(s+l)%s),r.indexOf("e")===-1){var c=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(c-r.length+l):r+="E+"+(c-l);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,h,d,g){return h+d+g.substr(0,(s+l)%s)+"."+g.substr(l)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var y_=/# (\?+)( ?)\/( ?)(\d+)/;function tA(e,t,r){var a=parseInt(e[4],10),s=Math.round(t*a),l=Math.floor(s/a),c=s-l*a,u=a;return r+(l===0?"":""+l)+" "+(c===0?_r(" ",e[1].length+1+e[4].length):Am(c,e[1].length)+e[2]+"/"+e[3]+Mn(u,e[4].length))}function rA(e,t,r){return r+(t===0?"":""+t)+_r(" ",e[1].length+2+e[4].length)}var __=/^#*0*\.([0#]+)/,w_=/\).*[0#]/,b_=/\(###\) ###\\?-####/;function Sa(e){for(var t="",r,a=0;a!=e.length;++a)switch(r=e.charCodeAt(a)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function Lv(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Bv(e,t){var r=e-Math.floor(e),a=Math.pow(10,t);return t<(""+Math.round(r*a)).length?0:Math.round(r*a)}function aA(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function nA(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function gn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(w_)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?gn("n",a,r):"("+gn("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return eA(e,t,r);if(t.indexOf("%")!==-1)return Zk(e,t,r);if(t.indexOf("E")!==-1)return v_(t,r);if(t.charCodeAt(0)===36)return"$"+gn(e,t.substr(t.charAt(1)==" "?2:1),r);var s,l,c,u,h=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+ro(h,t.length);if(t.match(/^[#?]+$/))return s=ro(r,0),s==="0"&&(s=""),s.length>t.length?s:Sa(t.substr(0,t.length-s.length))+s;if(l=t.match(y_))return tA(l,h,d);if(t.match(/^#+0+$/))return d+ro(h,t.length-t.indexOf("0"));if(l=t.match(__))return s=Lv(r,l[1].length).replace(/^([^\.]+)$/,"$1."+Sa(l[1])).replace(/\.$/,"."+Sa(l[1])).replace(/\.(\d*)$/,function(b,w){return"."+w+_r("0",Sa(l[1]).length-w.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),l=t.match(/^(0*)\.(#*)$/))return d+Lv(h,l[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=t.match(/^#{1,3},##0(\.?)$/))return d+li(ro(h,0));if(l=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+gn(e,t,-r):li(""+(Math.floor(r)+aA(r,l[1].length)))+"."+Mn(Bv(r,l[1].length),l[1].length);if(l=t.match(/^#,#*,#0/))return gn(e,t.replace(/^#,#*,/,""),r);if(l=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=ho(gn(e,t.replace(/[\\-]/g,""),r)),c=0,ho(ho(t.replace(/\\/g,"")).replace(/[0#]/g,function(b){return c<s.length?s.charAt(c++):b==="0"?"0":""}));if(t.match(b_))return s=gn(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var g="";if(l=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(l[4].length,7),u=X0(h,Math.pow(10,c)-1,!1),s=""+d,g=ws("n",l[1],u[1]),g.charAt(g.length-1)==" "&&(g=g.substr(0,g.length-1)+"0"),s+=g+l[2]+"/"+l[3],g=G0(u[2],c),g.length<l[4].length&&(g=Sa(l[4].substr(l[4].length-g.length))+g),s+=g,s;if(l=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(l[1].length,l[4].length),7),u=X0(h,Math.pow(10,c)-1,!0),d+(u[0]||(u[1]?"":"0"))+" "+(u[1]?Am(u[1],c)+l[2]+"/"+l[3]+G0(u[2],c):_r(" ",2*c+1+l[2].length+l[3].length));if(l=t.match(/^[#0?]+$/))return s=ro(r,0),t.length<=s.length?s:Sa(t.substr(0,t.length-s.length))+s;if(l=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),c=s.indexOf(".");var x=t.indexOf(".")-c,y=t.length-s.length-x;return Sa(t.substr(0,x)+s+t.substr(t.length-y))}if(l=t.match(/^00,000\.([#0]*0)$/))return c=Bv(r,l[1].length),r<0?"-"+gn(e,t,-r):li(nA(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?Mn(0,3-b.length):"")+b})+"."+Mn(c,l[1].length);switch(t){case"###,##0.00":return gn(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var _=li(ro(h,0));return _!=="0"?d+_:"";case"###,###.00":return gn(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return gn(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function sA(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return ws(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function iA(e,t,r){var a=t.replace(x_,""),s=t.length-a.length;return ws(e,a,r*Math.pow(10,2*s))+_r("%",s)}function S_(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+S_(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var l=Math.floor(Math.log(t)*Math.LOG10E)%s;if(l<0&&(l+=s),r=(t/Math.pow(10,l)).toPrecision(a+1+(s+l)%s),!r.match(/[Ee]/)){var c=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(c-r.length+l):r+="E+"+(c-l),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,h,d,g){return h+d+g.substr(0,(s+l)%s)+"."+g.substr(l)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Xn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(w_)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Xn("n",a,r):"("+Xn("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return sA(e,t,r);if(t.indexOf("%")!==-1)return iA(e,t,r);if(t.indexOf("E")!==-1)return S_(t,r);if(t.charCodeAt(0)===36)return"$"+Xn(e,t.substr(t.charAt(1)==" "?2:1),r);var s,l,c,u,h=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+Mn(h,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:Sa(t.substr(0,t.length-s.length))+s;if(l=t.match(y_))return rA(l,h,d);if(t.match(/^#+0+$/))return d+Mn(h,t.length-t.indexOf("0"));if(l=t.match(__))return s=(""+r).replace(/^([^\.]+)$/,"$1."+Sa(l[1])).replace(/\.$/,"."+Sa(l[1])),s=s.replace(/\.(\d*)$/,function(b,w){return"."+w+_r("0",Sa(l[1]).length-w.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),l=t.match(/^(0*)\.(#*)$/))return d+(""+h).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=t.match(/^#{1,3},##0(\.?)$/))return d+li(""+h);if(l=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Xn(e,t,-r):li(""+r)+"."+_r("0",l[1].length);if(l=t.match(/^#,#*,#0/))return Xn(e,t.replace(/^#,#*,/,""),r);if(l=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=ho(Xn(e,t.replace(/[\\-]/g,""),r)),c=0,ho(ho(t.replace(/\\/g,"")).replace(/[0#]/g,function(b){return c<s.length?s.charAt(c++):b==="0"?"0":""}));if(t.match(b_))return s=Xn(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var g="";if(l=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(l[4].length,7),u=X0(h,Math.pow(10,c)-1,!1),s=""+d,g=ws("n",l[1],u[1]),g.charAt(g.length-1)==" "&&(g=g.substr(0,g.length-1)+"0"),s+=g+l[2]+"/"+l[3],g=G0(u[2],c),g.length<l[4].length&&(g=Sa(l[4].substr(l[4].length-g.length))+g),s+=g,s;if(l=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(l[1].length,l[4].length),7),u=X0(h,Math.pow(10,c)-1,!0),d+(u[0]||(u[1]?"":"0"))+" "+(u[1]?Am(u[1],c)+l[2]+"/"+l[3]+G0(u[2],c):_r(" ",2*c+1+l[2].length+l[3].length));if(l=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:Sa(t.substr(0,t.length-s.length))+s;if(l=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),c=s.indexOf(".");var x=t.indexOf(".")-c,y=t.length-s.length-x;return Sa(t.substr(0,x)+s+t.substr(t.length-y))}if(l=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Xn(e,t,-r):li(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?Mn(0,3-b.length):"")+b})+"."+Mn(0,l[1].length);switch(t){case"###,###":case"##,###":case"#,###":var _=li(""+h);return _!=="0"?d+_:"";default:if(t.match(/\.[0#?]*$/))return Xn(e,t.slice(0,t.lastIndexOf(".")),r)+Sa(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function ws(e,t,r){return(r|0)===r?Xn(e,t,r):gn(e,t,r)}function lA(e){for(var t=[],r=!1,a=0,s=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:r=!r;break;case 95:case 42:case 92:++a;break;case 59:t[t.length]=e.substr(s,a-s),s=a+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var E_=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function bo(e){for(var t=0,r="",a="";t<e.length;)switch(r=e.charAt(t)){case"G":q0(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(a=r;e.charAt(t++)!=="]"&&t<e.length;)a+=e.charAt(t);if(a.match(E_))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function oA(e,t,r,a){for(var s=[],l="",c=0,u="",h="t",d,g,x,y="H";c<e.length;)switch(u=e.charAt(c)){case"G":if(!q0(e,c))throw new Error("unrecognized character "+u+" in "+e);s[s.length]={t:"G",v:"General"},c+=7;break;case'"':for(l="";(x=e.charCodeAt(++c))!==34&&c<e.length;)l+=String.fromCharCode(x);s[s.length]={t:"t",v:l},++c;break;case"\\":var _=e.charAt(++c),b=_==="("||_===")"?_:"t";s[s.length]={t:b,v:_},++c;break;case"_":s[s.length]={t:"t",v:" "},c+=2;break;case"@":s[s.length]={t:"T",v:t},++c;break;case"B":case"b":if(e.charAt(c+1)==="1"||e.charAt(c+1)==="2"){if(d==null&&(d=Vi(t,r,e.charAt(c+1)==="2"),d==null))return"";s[s.length]={t:"X",v:e.substr(c,2)},h=u,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||d==null&&(d=Vi(t,r),d==null))return"";for(l=u;++c<e.length&&e.charAt(c).toLowerCase()===u;)l+=u;u==="m"&&h.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=y),s[s.length]={t:u,v:l},h=u;break;case"A":case"a":case"":var w={t:u,v:u};if(d==null&&(d=Vi(t,r)),e.substr(c,3).toUpperCase()==="A/P"?(d!=null&&(w.v=d.H>=12?"P":"A"),w.t="T",y="h",c+=3):e.substr(c,5).toUpperCase()==="AM/PM"?(d!=null&&(w.v=d.H>=12?"PM":"AM"),w.t="T",c+=5,y="h"):e.substr(c,5).toUpperCase()==="/"?(d!=null&&(w.v=d.H>=12?"":""),w.t="T",c+=5,y="h"):(w.t="t",++c),d==null&&w.t==="T")return"";s[s.length]=w,h=u;break;case"[":for(l=u;e.charAt(c++)!=="]"&&c<e.length;)l+=e.charAt(c);if(l.slice(-1)!=="]")throw'unterminated "[" block: |'+l+"|";if(l.match(E_)){if(d==null&&(d=Vi(t,r),d==null))return"";s[s.length]={t:"Z",v:l.toLowerCase()},h=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",bo(e)||(s[s.length]={t:"t",v:l}));break;case".":if(d!=null){for(l=u;++c<e.length&&(u=e.charAt(c))==="0";)l+=u;s[s.length]={t:"s",v:l};break}case"0":case"#":for(l=u;++c<e.length&&"0#?.,E+-%".indexOf(u=e.charAt(c))>-1;)l+=u;s[s.length]={t:"n",v:l};break;case"?":for(l=u;e.charAt(++c)===u;)l+=u;s[s.length]={t:u,v:l},h=u;break;case"*":++c,(e.charAt(c)==" "||e.charAt(c)=="*")&&++c;break;case"(":case")":s[s.length]={t:a===1?"t":u,v:u},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=u;c<e.length&&"0123456789".indexOf(e.charAt(++c))>-1;)l+=e.charAt(c);s[s.length]={t:"D",v:l};break;case" ":s[s.length]={t:u,v:u},++c;break;case"$":s[s.length]={t:"t",v:"$"},++c;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+e);s[s.length]={t:"t",v:u},++c;break}var S=0,k=0,C;for(c=s.length-1,h="t";c>=0;--c)switch(s[c].t){case"h":case"H":s[c].t=y,h="h",S<1&&(S=1);break;case"s":(C=s[c].v.match(/\.0+$/))&&(k=Math.max(k,C[0].length-1)),S<3&&(S=3);case"d":case"y":case"M":case"e":h=s[c].t;break;case"m":h==="s"&&(s[c].t="M",S<2&&(S=2));break;case"X":break;case"Z":S<1&&s[c].v.match(/[Hh]/)&&(S=1),S<2&&s[c].v.match(/[Mm]/)&&(S=2),S<3&&s[c].v.match(/[Ss]/)&&(S=3)}switch(S){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var T="",j;for(c=0;c<s.length;++c)switch(s[c].t){case"t":case"T":case" ":case"D":break;case"X":s[c].v="",s[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[c].v=Qk(s[c].t.charCodeAt(0),s[c].v,d,k),s[c].t="t";break;case"n":case"?":for(j=c+1;s[j]!=null&&((u=s[j].t)==="?"||u==="D"||(u===" "||u==="t")&&s[j+1]!=null&&(s[j+1].t==="?"||s[j+1].t==="t"&&s[j+1].v==="/")||s[c].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(s[j].v==="/"||s[j].v===" "&&s[j+1]!=null&&s[j+1].t=="?"));)s[c].v+=s[j].v,s[j]={v:"",t:";"},++j;T+=s[c].v,c=j-1;break;case"G":s[c].t="t",s[c].v=Yi(t,r);break}var X="",D,N;if(T.length>0){T.charCodeAt(0)==40?(D=t<0&&T.charCodeAt(0)===45?-t:t,N=ws("n",T,D)):(D=t<0&&a>1?-t:t,N=ws("n",T,D),D<0&&s[0]&&s[0].t=="t"&&(N=N.substr(1),s[0].v="-"+s[0].v)),j=N.length-1;var W=s.length;for(c=0;c<s.length;++c)if(s[c]!=null&&s[c].t!="t"&&s[c].v.indexOf(".")>-1){W=c;break}var P=s.length;if(W===s.length&&N.indexOf("E")===-1){for(c=s.length-1;c>=0;--c)s[c]==null||"n?".indexOf(s[c].t)===-1||(j>=s[c].v.length-1?(j-=s[c].v.length,s[c].v=N.substr(j+1,s[c].v.length)):j<0?s[c].v="":(s[c].v=N.substr(0,j+1),j=-1),s[c].t="t",P=c);j>=0&&P<s.length&&(s[P].v=N.substr(0,j+1)+s[P].v)}else if(W!==s.length&&N.indexOf("E")===-1){for(j=N.indexOf(".")-1,c=W;c>=0;--c)if(!(s[c]==null||"n?".indexOf(s[c].t)===-1)){for(g=s[c].v.indexOf(".")>-1&&c===W?s[c].v.indexOf(".")-1:s[c].v.length-1,X=s[c].v.substr(g+1);g>=0;--g)j>=0&&(s[c].v.charAt(g)==="0"||s[c].v.charAt(g)==="#")&&(X=N.charAt(j--)+X);s[c].v=X,s[c].t="t",P=c}for(j>=0&&P<s.length&&(s[P].v=N.substr(0,j+1)+s[P].v),j=N.indexOf(".")+1,c=W;c<s.length;++c)if(!(s[c]==null||"n?(".indexOf(s[c].t)===-1&&c!==W)){for(g=s[c].v.indexOf(".")>-1&&c===W?s[c].v.indexOf(".")+1:0,X=s[c].v.substr(0,g);g<s[c].v.length;++g)j<N.length&&(X+=N.charAt(j++));s[c].v=X,s[c].t="t",P=c}}}for(c=0;c<s.length;++c)s[c]!=null&&"n?".indexOf(s[c].t)>-1&&(D=a>1&&t<0&&c>0&&s[c-1].v==="-"?-t:t,s[c].v=ws(s[c].t,s[c].v,D),s[c].t="t");var re="";for(c=0;c!==s.length;++c)s[c]!=null&&(re+=s[c].v);return re}var Uv=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Pv(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function cA(e,t){var r=lA(e),a=r.length,s=r[a-1].indexOf("@");if(a<4&&s>-1&&--a,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var l=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[a,l];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var c=r[0].match(Uv),u=r[1].match(Uv);return Pv(t,c)?[a,r[0]]:Pv(t,u)?[a,r[1]]:[a,r[c!=null&&u!=null?2:1]]}return[a,l]}function wn(e,t,r){r==null&&(r={});var a="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?a=r.dateNF:a=e;break;case"number":e==14&&r.dateNF?a=r.dateNF:a=(r.table!=null?r.table:ft)[e],a==null&&(a=r.table&&r.table[Iv[e]]||ft[Iv[e]]),a==null&&(a=Gk[e]||"General");break}if(q0(a,0))return Yi(t,r);t instanceof Date&&(t=p_(t,r.date1904));var s=cA(a,t);if(q0(s[1]))return Yi(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return oA(s[1],t,r,s[0])}function bs(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(ft[r]==null){t<0&&(t=r);continue}if(ft[r]==e){t=r;break}}t<0&&(t=391)}return ft[t]=e,t}function cf(e){for(var t=0;t!=392;++t)e[t]!==void 0&&bs(e[t],t)}function So(){ft=Vk()}var uA={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},T_=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function fA(e){var t=typeof e=="number"?ft[e]:e;return t=t.replace(T_,"(\\d+)"),new RegExp("^"+t+"$")}function hA(e,t,r){var a=-1,s=-1,l=-1,c=-1,u=-1,h=-1;(t.match(T_)||[]).forEach(function(x,y){var _=parseInt(r[y+1],10);switch(x.toLowerCase().charAt(0)){case"y":a=_;break;case"d":l=_;break;case"h":c=_;break;case"s":h=_;break;case"m":c>=0?u=_:s=_;break}}),h>=0&&u==-1&&s>=0&&(u=s,s=-1);var d=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(l>=1?l:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var g=("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(h>=0?h:0)).slice(-2);return c==-1&&u==-1&&h==-1?d:a==-1&&s==-1&&l==-1?g:d+"T"+g}var dA=(function(){var e={};e.version="1.2.0";function t(){for(var N=0,W=new Array(256),P=0;P!=256;++P)N=P,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,W[P]=N;return typeof Int32Array<"u"?new Int32Array(W):W}var r=t();function a(N){var W=0,P=0,re=0,ae=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(re=0;re!=256;++re)ae[re]=N[re];for(re=0;re!=256;++re)for(P=N[re],W=256+re;W<4096;W+=256)P=ae[W]=P>>>8^N[P&255];var Q=[];for(re=1;re!=16;++re)Q[re-1]=typeof Int32Array<"u"?ae.subarray(re*256,re*256+256):ae.slice(re*256,re*256+256);return Q}var s=a(r),l=s[0],c=s[1],u=s[2],h=s[3],d=s[4],g=s[5],x=s[6],y=s[7],_=s[8],b=s[9],w=s[10],S=s[11],k=s[12],C=s[13],T=s[14];function j(N,W){for(var P=W^-1,re=0,ae=N.length;re<ae;)P=P>>>8^r[(P^N.charCodeAt(re++))&255];return~P}function X(N,W){for(var P=W^-1,re=N.length-15,ae=0;ae<re;)P=T[N[ae++]^P&255]^C[N[ae++]^P>>8&255]^k[N[ae++]^P>>16&255]^S[N[ae++]^P>>>24]^w[N[ae++]]^b[N[ae++]]^_[N[ae++]]^y[N[ae++]]^x[N[ae++]]^g[N[ae++]]^d[N[ae++]]^h[N[ae++]]^u[N[ae++]]^c[N[ae++]]^l[N[ae++]]^r[N[ae++]];for(re+=15;ae<re;)P=P>>>8^r[(P^N[ae++])&255];return~P}function D(N,W){for(var P=W^-1,re=0,ae=N.length,Q=0,xe=0;re<ae;)Q=N.charCodeAt(re++),Q<128?P=P>>>8^r[(P^Q)&255]:Q<2048?(P=P>>>8^r[(P^(192|Q>>6&31))&255],P=P>>>8^r[(P^(128|Q&63))&255]):Q>=55296&&Q<57344?(Q=(Q&1023)+64,xe=N.charCodeAt(re++)&1023,P=P>>>8^r[(P^(240|Q>>8&7))&255],P=P>>>8^r[(P^(128|Q>>2&63))&255],P=P>>>8^r[(P^(128|xe>>6&15|(Q&3)<<4))&255],P=P>>>8^r[(P^(128|xe&63))&255]):(P=P>>>8^r[(P^(224|Q>>12&15))&255],P=P>>>8^r[(P^(128|Q>>6&63))&255],P=P>>>8^r[(P^(128|Q&63))&255]);return~P}return e.table=r,e.bstr=j,e.buf=X,e.str=D,e})(),lt=(function(){var t={};t.version="1.2.1";function r(O,H){for(var F=O.split("/"),M=H.split("/"),B=0,V=0,fe=Math.min(F.length,M.length);B<fe;++B){if(V=F[B].length-M[B].length)return V;if(F[B]!=M[B])return F[B]<M[B]?-1:1}return F.length-M.length}function a(O){if(O.charAt(O.length-1)=="/")return O.slice(0,-1).indexOf("/")===-1?O:a(O.slice(0,-1));var H=O.lastIndexOf("/");return H===-1?O:O.slice(0,H+1)}function s(O){if(O.charAt(O.length-1)=="/")return s(O.slice(0,-1));var H=O.lastIndexOf("/");return H===-1?O:O.slice(H+1)}function l(O,H){typeof H=="string"&&(H=new Date(H));var F=H.getHours();F=F<<6|H.getMinutes(),F=F<<5|H.getSeconds()>>>1,O.write_shift(2,F);var M=H.getFullYear()-1980;M=M<<4|H.getMonth()+1,M=M<<5|H.getDate(),O.write_shift(2,M)}function c(O){var H=O.read_shift(2)&65535,F=O.read_shift(2)&65535,M=new Date,B=F&31;F>>>=5;var V=F&15;F>>>=4,M.setMilliseconds(0),M.setFullYear(F+1980),M.setMonth(V-1),M.setDate(B);var fe=H&31;H>>>=5;var we=H&63;return H>>>=6,M.setHours(H),M.setMinutes(we),M.setSeconds(fe<<1),M}function u(O){la(O,0);for(var H={},F=0;O.l<=O.length-4;){var M=O.read_shift(2),B=O.read_shift(2),V=O.l+B,fe={};M===21589&&(F=O.read_shift(1),F&1&&(fe.mtime=O.read_shift(4)),B>5&&(F&2&&(fe.atime=O.read_shift(4)),F&4&&(fe.ctime=O.read_shift(4))),fe.mtime&&(fe.mt=new Date(fe.mtime*1e3))),O.l=V,H[M]=fe}return H}var h;function d(){return h||(h={})}function g(O,H){if(O[0]==80&&O[1]==75)return ua(O,H);if((O[0]|32)==109&&(O[1]|32)==105)return rs(O,H);if(O.length<512)throw new Error("CFB file size "+O.length+" < 512");var F=3,M=512,B=0,V=0,fe=0,we=0,ce=0,ie=[],he=O.slice(0,512);la(he,0);var Fe=x(he);switch(F=Fe[0],F){case 3:M=512;break;case 4:M=4096;break;case 0:if(Fe[1]==0)return ua(O,H);default:throw new Error("Major Version: Expected 3 or 4 saw "+F)}M!==512&&(he=O.slice(0,M),la(he,28));var Le=O.slice(0,M);y(he,F);var qe=he.read_shift(4,"i");if(F===3&&qe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+qe);he.l+=4,fe=he.read_shift(4,"i"),he.l+=4,he.chk("00100000","Mini Stream Cutoff Size: "),we=he.read_shift(4,"i"),B=he.read_shift(4,"i"),ce=he.read_shift(4,"i"),V=he.read_shift(4,"i");for(var De=-1,$e=0;$e<109&&(De=he.read_shift(4,"i"),!(De<0));++$e)ie[$e]=De;var We=_(O,M);S(ce,V,We,M,ie);var Yt=C(We,fe,ie,M);Yt[fe].name="!Directory",B>0&&we!==xe&&(Yt[we].name="!MiniFAT"),Yt[ie[0]].name="!FAT",Yt.fat_addrs=ie,Yt.ssz=M;var Jt={},Qt=[],Ca=[],as=[];T(fe,Yt,We,Qt,B,Jt,Ca,we),b(Ca,as,Qt),Qt.shift();var Bn={FileIndex:Ca,FullPaths:as};return H&&H.raw&&(Bn.raw={header:Le,sectors:We}),Bn}function x(O){if(O[O.l]==80&&O[O.l+1]==75)return[0,0];O.chk(Oe,"Header Signature: "),O.l+=16;var H=O.read_shift(2,"u");return[O.read_shift(2,"u"),H]}function y(O,H){var F=9;switch(O.l+=2,F=O.read_shift(2)){case 9:if(H!=3)throw new Error("Sector Shift: Expected 9 saw "+F);break;case 12:if(H!=4)throw new Error("Sector Shift: Expected 12 saw "+F);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+F)}O.chk("0600","Mini Sector Shift: "),O.chk("000000000000","Reserved: ")}function _(O,H){for(var F=Math.ceil(O.length/H)-1,M=[],B=1;B<F;++B)M[B-1]=O.slice(B*H,(B+1)*H);return M[F-1]=O.slice(F*H),M}function b(O,H,F){for(var M=0,B=0,V=0,fe=0,we=0,ce=F.length,ie=[],he=[];M<ce;++M)ie[M]=he[M]=M,H[M]=F[M];for(;we<he.length;++we)M=he[we],B=O[M].L,V=O[M].R,fe=O[M].C,ie[M]===M&&(B!==-1&&ie[B]!==B&&(ie[M]=ie[B]),V!==-1&&ie[V]!==V&&(ie[M]=ie[V])),fe!==-1&&(ie[fe]=M),B!==-1&&M!=ie[M]&&(ie[B]=ie[M],he.lastIndexOf(B)<we&&he.push(B)),V!==-1&&M!=ie[M]&&(ie[V]=ie[M],he.lastIndexOf(V)<we&&he.push(V));for(M=1;M<ce;++M)ie[M]===M&&(V!==-1&&ie[V]!==V?ie[M]=ie[V]:B!==-1&&ie[B]!==B&&(ie[M]=ie[B]));for(M=1;M<ce;++M)if(O[M].type!==0){if(we=M,we!=ie[we])do we=ie[we],H[M]=H[we]+"/"+H[M];while(we!==0&&ie[we]!==-1&&we!=ie[we]);ie[M]=-1}for(H[0]+="/",M=1;M<ce;++M)O[M].type!==2&&(H[M]+="/")}function w(O,H,F){for(var M=O.start,B=O.size,V=[],fe=M;F&&B>0&&fe>=0;)V.push(H.slice(fe*Q,fe*Q+Q)),B-=Q,fe=Hi(F,fe*4);return V.length===0?_e(0):Yr(V).slice(0,O.size)}function S(O,H,F,M,B){var V=xe;if(O===xe){if(H!==0)throw new Error("DIFAT chain shorter than expected")}else if(O!==-1){var fe=F[O],we=(M>>>2)-1;if(!fe)return;for(var ce=0;ce<we&&(V=Hi(fe,ce*4))!==xe;++ce)B.push(V);S(Hi(fe,M-4),H-1,F,M,B)}}function k(O,H,F,M,B){var V=[],fe=[];B||(B=[]);var we=M-1,ce=0,ie=0;for(ce=H;ce>=0;){B[ce]=!0,V[V.length]=ce,fe.push(O[ce]);var he=F[Math.floor(ce*4/M)];if(ie=ce*4&we,M<4+ie)throw new Error("FAT boundary crossed: "+ce+" 4 "+M);if(!O[he])break;ce=Hi(O[he],ie)}return{nodes:V,data:Qv([fe])}}function C(O,H,F,M){var B=O.length,V=[],fe=[],we=[],ce=[],ie=M-1,he=0,Fe=0,Le=0,qe=0;for(he=0;he<B;++he)if(we=[],Le=he+H,Le>=B&&(Le-=B),!fe[Le]){ce=[];var De=[];for(Fe=Le;Fe>=0;){De[Fe]=!0,fe[Fe]=!0,we[we.length]=Fe,ce.push(O[Fe]);var $e=F[Math.floor(Fe*4/M)];if(qe=Fe*4&ie,M<4+qe)throw new Error("FAT boundary crossed: "+Fe+" 4 "+M);if(!O[$e]||(Fe=Hi(O[$e],qe),De[Fe]))break}V[Le]={nodes:we,data:Qv([ce])}}return V}function T(O,H,F,M,B,V,fe,we){for(var ce=0,ie=M.length?2:0,he=H[O].data,Fe=0,Le=0,qe;Fe<he.length;Fe+=128){var De=he.slice(Fe,Fe+128);la(De,64),Le=De.read_shift(2),qe=jm(De,0,Le-ie),M.push(qe);var $e={name:qe,type:De.read_shift(1),color:De.read_shift(1),L:De.read_shift(4,"i"),R:De.read_shift(4,"i"),C:De.read_shift(4,"i"),clsid:De.read_shift(16),state:De.read_shift(4,"i"),start:0,size:0},We=De.read_shift(2)+De.read_shift(2)+De.read_shift(2)+De.read_shift(2);We!==0&&($e.ct=j(De,De.l-8));var Yt=De.read_shift(2)+De.read_shift(2)+De.read_shift(2)+De.read_shift(2);Yt!==0&&($e.mt=j(De,De.l-8)),$e.start=De.read_shift(4,"i"),$e.size=De.read_shift(4,"i"),$e.size<0&&$e.start<0&&($e.size=$e.type=0,$e.start=xe,$e.name=""),$e.type===5?(ce=$e.start,B>0&&ce!==xe&&(H[ce].name="!StreamData")):$e.size>=4096?($e.storage="fat",H[$e.start]===void 0&&(H[$e.start]=k(F,$e.start,H.fat_addrs,H.ssz)),H[$e.start].name=$e.name,$e.content=H[$e.start].data.slice(0,$e.size)):($e.storage="minifat",$e.size<0?$e.size=0:ce!==xe&&$e.start!==xe&&H[ce]&&($e.content=w($e,H[ce].data,(H[we]||{}).data))),$e.content&&la($e.content,0),V[qe]=$e,fe.push($e)}}function j(O,H){return new Date((Qa(O,H+4)/1e7*Math.pow(2,32)+Qa(O,H)/1e7-11644473600)*1e3)}function X(O,H){return d(),g(h.readFileSync(O),H)}function D(O,H){var F=H&&H.type;switch(F||Tt&&Buffer.isBuffer(O)&&(F="buffer"),F||"base64"){case"file":return X(O,H);case"base64":return g(tn(an(O)),H);case"binary":return g(tn(O),H)}return g(O,H)}function N(O,H){var F=H||{},M=F.root||"Root Entry";if(O.FullPaths||(O.FullPaths=[]),O.FileIndex||(O.FileIndex=[]),O.FullPaths.length!==O.FileIndex.length)throw new Error("inconsistent CFB structure");O.FullPaths.length===0&&(O.FullPaths[0]=M+"/",O.FileIndex[0]={name:M,type:5}),F.CLSID&&(O.FileIndex[0].clsid=F.CLSID),W(O)}function W(O){var H="Sh33tJ5";if(!lt.find(O,"/"+H)){var F=_e(4);F[0]=55,F[1]=F[3]=50,F[2]=54,O.FileIndex.push({name:H,type:2,content:F,size:4,L:69,R:69,C:69}),O.FullPaths.push(O.FullPaths[0]+H),P(O)}}function P(O,H){N(O);for(var F=!1,M=!1,B=O.FullPaths.length-1;B>=0;--B){var V=O.FileIndex[B];switch(V.type){case 0:M?F=!0:(O.FileIndex.pop(),O.FullPaths.pop());break;case 1:case 2:case 5:M=!0,isNaN(V.R*V.L*V.C)&&(F=!0),V.R>-1&&V.L>-1&&V.R==V.L&&(F=!0);break;default:F=!0;break}}if(!(!F&&!H)){var fe=new Date(1987,1,19),we=0,ce=Object.create?Object.create(null):{},ie=[];for(B=0;B<O.FullPaths.length;++B)ce[O.FullPaths[B]]=!0,O.FileIndex[B].type!==0&&ie.push([O.FullPaths[B],O.FileIndex[B]]);for(B=0;B<ie.length;++B){var he=a(ie[B][0]);M=ce[he],M||(ie.push([he,{name:s(he).replace("/",""),type:1,clsid:K,ct:fe,mt:fe,content:null}]),ce[he]=!0)}for(ie.sort(function(qe,De){return r(qe[0],De[0])}),O.FullPaths=[],O.FileIndex=[],B=0;B<ie.length;++B)O.FullPaths[B]=ie[B][0],O.FileIndex[B]=ie[B][1];for(B=0;B<ie.length;++B){var Fe=O.FileIndex[B],Le=O.FullPaths[B];if(Fe.name=s(Le).replace("/",""),Fe.L=Fe.R=Fe.C=-(Fe.color=1),Fe.size=Fe.content?Fe.content.length:0,Fe.start=0,Fe.clsid=Fe.clsid||K,B===0)Fe.C=ie.length>1?1:-1,Fe.size=0,Fe.type=5;else if(Le.slice(-1)=="/"){for(we=B+1;we<ie.length&&a(O.FullPaths[we])!=Le;++we);for(Fe.C=we>=ie.length?-1:we,we=B+1;we<ie.length&&a(O.FullPaths[we])!=a(Le);++we);Fe.R=we>=ie.length?-1:we,Fe.type=1}else a(O.FullPaths[B+1]||"")==a(Le)&&(Fe.R=B+1),Fe.type=2}}}function re(O,H){var F=H||{};if(F.fileType=="mad")return Ao(O,F);if(P(O),F.fileType==="zip")return Ns(O,F);var M=(function(qe){for(var De=0,$e=0,We=0;We<qe.FileIndex.length;++We){var Yt=qe.FileIndex[We];if(Yt.content){var Jt=Yt.content.length;Jt>0&&(Jt<4096?De+=Jt+63>>6:$e+=Jt+511>>9)}}for(var Qt=qe.FullPaths.length+3>>2,Ca=De+7>>3,as=De+127>>7,Bn=Ca+$e+Qt+as,nn=Bn+127>>7,vi=nn<=109?0:Math.ceil((nn-109)/127);Bn+nn+vi+127>>7>nn;)vi=++nn<=109?0:Math.ceil((nn-109)/127);var fa=[1,vi,nn,as,Qt,$e,De,0];return qe.FileIndex[0].size=De<<6,fa[7]=(qe.FileIndex[0].start=fa[0]+fa[1]+fa[2]+fa[3]+fa[4]+fa[5])+(fa[6]+7>>3),fa})(O),B=_e(M[7]<<9),V=0,fe=0;{for(V=0;V<8;++V)B.write_shift(1,Ae[V]);for(V=0;V<8;++V)B.write_shift(2,0);for(B.write_shift(2,62),B.write_shift(2,3),B.write_shift(2,65534),B.write_shift(2,9),B.write_shift(2,6),V=0;V<3;++V)B.write_shift(2,0);for(B.write_shift(4,0),B.write_shift(4,M[2]),B.write_shift(4,M[0]+M[1]+M[2]+M[3]-1),B.write_shift(4,0),B.write_shift(4,4096),B.write_shift(4,M[3]?M[0]+M[1]+M[2]-1:xe),B.write_shift(4,M[3]),B.write_shift(-4,M[1]?M[0]-1:xe),B.write_shift(4,M[1]),V=0;V<109;++V)B.write_shift(-4,V<M[2]?M[1]+V:-1)}if(M[1])for(fe=0;fe<M[1];++fe){for(;V<236+fe*127;++V)B.write_shift(-4,V<M[2]?M[1]+V:-1);B.write_shift(-4,fe===M[1]-1?xe:fe+1)}var we=function(qe){for(fe+=qe;V<fe-1;++V)B.write_shift(-4,V+1);qe&&(++V,B.write_shift(-4,xe))};for(fe=V=0,fe+=M[1];V<fe;++V)B.write_shift(-4,le.DIFSECT);for(fe+=M[2];V<fe;++V)B.write_shift(-4,le.FATSECT);we(M[3]),we(M[4]);for(var ce=0,ie=0,he=O.FileIndex[0];ce<O.FileIndex.length;++ce)he=O.FileIndex[ce],he.content&&(ie=he.content.length,!(ie<4096)&&(he.start=fe,we(ie+511>>9)));for(we(M[6]+7>>3);B.l&511;)B.write_shift(-4,le.ENDOFCHAIN);for(fe=V=0,ce=0;ce<O.FileIndex.length;++ce)he=O.FileIndex[ce],he.content&&(ie=he.content.length,!(!ie||ie>=4096)&&(he.start=fe,we(ie+63>>6)));for(;B.l&511;)B.write_shift(-4,le.ENDOFCHAIN);for(V=0;V<M[4]<<2;++V){var Fe=O.FullPaths[V];if(!Fe||Fe.length===0){for(ce=0;ce<17;++ce)B.write_shift(4,0);for(ce=0;ce<3;++ce)B.write_shift(4,-1);for(ce=0;ce<12;++ce)B.write_shift(4,0);continue}he=O.FileIndex[V],V===0&&(he.start=he.size?he.start-1:xe);var Le=V===0&&F.root||he.name;if(ie=2*(Le.length+1),B.write_shift(64,Le,"utf16le"),B.write_shift(2,ie),B.write_shift(1,he.type),B.write_shift(1,he.color),B.write_shift(-4,he.L),B.write_shift(-4,he.R),B.write_shift(-4,he.C),he.clsid)B.write_shift(16,he.clsid,"hex");else for(ce=0;ce<4;++ce)B.write_shift(4,0);B.write_shift(4,he.state||0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,he.start),B.write_shift(4,he.size),B.write_shift(4,0)}for(V=1;V<O.FileIndex.length;++V)if(he=O.FileIndex[V],he.size>=4096)if(B.l=he.start+1<<9,Tt&&Buffer.isBuffer(he.content))he.content.copy(B,B.l,0,he.size),B.l+=he.size+511&-512;else{for(ce=0;ce<he.size;++ce)B.write_shift(1,he.content[ce]);for(;ce&511;++ce)B.write_shift(1,0)}for(V=1;V<O.FileIndex.length;++V)if(he=O.FileIndex[V],he.size>0&&he.size<4096)if(Tt&&Buffer.isBuffer(he.content))he.content.copy(B,B.l,0,he.size),B.l+=he.size+63&-64;else{for(ce=0;ce<he.size;++ce)B.write_shift(1,he.content[ce]);for(;ce&63;++ce)B.write_shift(1,0)}if(Tt)B.l=B.length;else for(;B.l<B.length;)B.write_shift(1,0);return B}function ae(O,H){var F=O.FullPaths.map(function(ce){return ce.toUpperCase()}),M=F.map(function(ce){var ie=ce.split("/");return ie[ie.length-(ce.slice(-1)=="/"?2:1)]}),B=!1;H.charCodeAt(0)===47?(B=!0,H=F[0].slice(0,-1)+H):B=H.indexOf("/")!==-1;var V=H.toUpperCase(),fe=B===!0?F.indexOf(V):M.indexOf(V);if(fe!==-1)return O.FileIndex[fe];var we=!V.match(bc);for(V=V.replace(Ta,""),we&&(V=V.replace(bc,"!")),fe=0;fe<F.length;++fe)if((we?F[fe].replace(bc,"!"):F[fe]).replace(Ta,"")==V||(we?M[fe].replace(bc,"!"):M[fe]).replace(Ta,"")==V)return O.FileIndex[fe];return null}var Q=64,xe=-2,Oe="d0cf11e0a1b11ae1",Ae=[208,207,17,224,161,177,26,225],K="00000000000000000000000000000000",le={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:xe,FREESECT:-1,HEADER_SIGNATURE:Oe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:K,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function je(O,H,F){d();var M=re(O,F);h.writeFileSync(H,M)}function U(O){for(var H=new Array(O.length),F=0;F<O.length;++F)H[F]=String.fromCharCode(O[F]);return H.join("")}function ve(O,H){var F=re(O,H);switch(H&&H.type||"buffer"){case"file":return d(),h.writeFileSync(H.filename,F),F;case"binary":return typeof F=="string"?F:U(F);case"base64":return zc(typeof F=="string"?F:U(F));case"buffer":if(Tt)return Buffer.isBuffer(F)?F:ks(F);case"array":return typeof F=="string"?tn(F):F}return F}var G;function A(O){try{var H=O.InflateRaw,F=new H;if(F._processChunk(new Uint8Array([3,0]),F._finishFlushFlag),F.bytesRead)G=O;else throw new Error("zlib does not expose bytesRead")}catch(M){console.error("cannot use native zlib: "+(M.message||M))}}function z(O,H){if(!G)return Zn(O,H);var F=G.InflateRaw,M=new F,B=M._processChunk(O.slice(O.l),M._finishFlushFlag);return O.l+=M.bytesRead,B}function I(O){return G?G.deflateRawSync(O):pt(O)}var L=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],te=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],me=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ge(O){var H=(O<<1|O<<11)&139536|(O<<5|O<<15)&558144;return(H>>16|H>>8|H)&255}for(var pe=typeof Uint8Array<"u",Ee=pe?new Uint8Array(256):[],et=0;et<256;++et)Ee[et]=ge(et);function q(O,H){var F=Ee[O&255];return H<=8?F>>>8-H:(F=F<<8|Ee[O>>8&255],H<=16?F>>>16-H:(F=F<<8|Ee[O>>16&255],F>>>24-H))}function vt(O,H){var F=H&7,M=H>>>3;return(O[M]|(F<=6?0:O[M+1]<<8))>>>F&3}function nt(O,H){var F=H&7,M=H>>>3;return(O[M]|(F<=5?0:O[M+1]<<8))>>>F&7}function kt(O,H){var F=H&7,M=H>>>3;return(O[M]|(F<=4?0:O[M+1]<<8))>>>F&15}function gt(O,H){var F=H&7,M=H>>>3;return(O[M]|(F<=3?0:O[M+1]<<8))>>>F&31}function Re(O,H){var F=H&7,M=H>>>3;return(O[M]|(F<=1?0:O[M+1]<<8))>>>F&127}function jt(O,H,F){var M=H&7,B=H>>>3,V=(1<<F)-1,fe=O[B]>>>M;return F<8-M||(fe|=O[B+1]<<8-M,F<16-M)||(fe|=O[B+2]<<16-M,F<24-M)||(fe|=O[B+3]<<24-M),fe&V}function sr(O,H,F){var M=H&7,B=H>>>3;return M<=5?O[B]|=(F&7)<<M:(O[B]|=F<<M&255,O[B+1]=(F&7)>>8-M),H+3}function $r(O,H,F){var M=H&7,B=H>>>3;return F=(F&1)<<M,O[B]|=F,H+1}function wa(O,H,F){var M=H&7,B=H>>>3;return F<<=M,O[B]|=F&255,F>>>=8,O[B+1]=F,H+8}function Sn(O,H,F){var M=H&7,B=H>>>3;return F<<=M,O[B]|=F&255,F>>>=8,O[B+1]=F&255,O[B+2]=F>>>8,H+16}function ka(O,H){var F=O.length,M=2*F>H?2*F:H+5,B=0;if(F>=H)return O;if(Tt){var V=Fv(M);if(O.copy)O.copy(V);else for(;B<O.length;++B)V[B]=O[B];return V}else if(pe){var fe=new Uint8Array(M);if(fe.set)fe.set(O);else for(;B<F;++B)fe[B]=O[B];return fe}return O.length=M,O}function It(O){for(var H=new Array(O),F=0;F<O;++F)H[F]=0;return H}function Pa(O,H,F){var M=1,B=0,V=0,fe=0,we=0,ce=O.length,ie=pe?new Uint16Array(32):It(32);for(V=0;V<32;++V)ie[V]=0;for(V=ce;V<F;++V)O[V]=0;ce=O.length;var he=pe?new Uint16Array(ce):It(ce);for(V=0;V<ce;++V)ie[B=O[V]]++,M<B&&(M=B),he[V]=0;for(ie[0]=0,V=1;V<=M;++V)ie[V+16]=we=we+ie[V-1]<<1;for(V=0;V<ce;++V)we=O[V],we!=0&&(he[V]=ie[we+16]++);var Fe=0;for(V=0;V<ce;++V)if(Fe=O[V],Fe!=0)for(we=q(he[V],M)>>M-Fe,fe=(1<<M+4-Fe)-1;fe>=0;--fe)H[we|fe<<Fe]=Fe&15|V<<4;return M}var za=pe?new Uint16Array(512):It(512),Vr=pe?new Uint16Array(32):It(32);if(!pe){for(var hr=0;hr<512;++hr)za[hr]=0;for(hr=0;hr<32;++hr)Vr[hr]=0}(function(){for(var O=[],H=0;H<32;H++)O.push(5);Pa(O,Vr,32);var F=[];for(H=0;H<=143;H++)F.push(8);for(;H<=255;H++)F.push(9);for(;H<=279;H++)F.push(7);for(;H<=287;H++)F.push(8);Pa(F,za,288)})();var Qr=(function(){for(var H=pe?new Uint8Array(32768):[],F=0,M=0;F<me.length-1;++F)for(;M<me[F+1];++M)H[M]=F;for(;M<32768;++M)H[M]=29;var B=pe?new Uint8Array(259):[];for(F=0,M=0;F<te.length-1;++F)for(;M<te[F+1];++M)B[M]=F;function V(we,ce){for(var ie=0;ie<we.length;){var he=Math.min(65535,we.length-ie),Fe=ie+he==we.length;for(ce.write_shift(1,+Fe),ce.write_shift(2,he),ce.write_shift(2,~he&65535);he-- >0;)ce[ce.l++]=we[ie++]}return ce.l}function fe(we,ce){for(var ie=0,he=0,Fe=pe?new Uint16Array(32768):[];he<we.length;){var Le=Math.min(65535,we.length-he);if(Le<10){for(ie=sr(ce,ie,+(he+Le==we.length)),ie&7&&(ie+=8-(ie&7)),ce.l=ie/8|0,ce.write_shift(2,Le),ce.write_shift(2,~Le&65535);Le-- >0;)ce[ce.l++]=we[he++];ie=ce.l*8;continue}ie=sr(ce,ie,+(he+Le==we.length)+2);for(var qe=0;Le-- >0;){var De=we[he];qe=(qe<<5^De)&32767;var $e=-1,We=0;if(($e=Fe[qe])&&($e|=he&-32768,$e>he&&($e-=32768),$e<he))for(;we[$e+We]==we[he+We]&&We<250;)++We;if(We>2){De=B[We],De<=22?ie=wa(ce,ie,Ee[De+1]>>1)-1:(wa(ce,ie,3),ie+=5,wa(ce,ie,Ee[De-23]>>5),ie+=3);var Yt=De<8?0:De-4>>2;Yt>0&&(Sn(ce,ie,We-te[De]),ie+=Yt),De=H[he-$e],ie=wa(ce,ie,Ee[De]>>3),ie-=3;var Jt=De<4?0:De-2>>1;Jt>0&&(Sn(ce,ie,he-$e-me[De]),ie+=Jt);for(var Qt=0;Qt<We;++Qt)Fe[qe]=he&32767,qe=(qe<<5^we[he])&32767,++he;Le-=We-1}else De<=143?De=De+48:ie=$r(ce,ie,1),ie=wa(ce,ie,Ee[De]),Fe[qe]=he&32767,++he}ie=wa(ce,ie,0)-1}return ce.l=(ie+7)/8|0,ce.l}return function(ce,ie){return ce.length<8?V(ce,ie):fe(ce,ie)}})();function pt(O){var H=_e(50+Math.floor(O.length*1.1)),F=Qr(O,H);return H.slice(0,F)}var $t=pe?new Uint16Array(32768):It(32768),Gr=pe?new Uint16Array(32768):It(32768),Vt=pe?new Uint16Array(128):It(128),Pt=1,ca=1;function qr(O,H){var F=gt(O,H)+257;H+=5;var M=gt(O,H)+1;H+=5;var B=kt(O,H)+4;H+=4;for(var V=0,fe=pe?new Uint8Array(19):It(19),we=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ce=1,ie=pe?new Uint8Array(8):It(8),he=pe?new Uint8Array(8):It(8),Fe=fe.length,Le=0;Le<B;++Le)fe[L[Le]]=V=nt(O,H),ce<V&&(ce=V),ie[V]++,H+=3;var qe=0;for(ie[0]=0,Le=1;Le<=ce;++Le)he[Le]=qe=qe+ie[Le-1]<<1;for(Le=0;Le<Fe;++Le)(qe=fe[Le])!=0&&(we[Le]=he[qe]++);var De=0;for(Le=0;Le<Fe;++Le)if(De=fe[Le],De!=0){qe=Ee[we[Le]]>>8-De;for(var $e=(1<<7-De)-1;$e>=0;--$e)Vt[qe|$e<<De]=De&7|Le<<3}var We=[];for(ce=1;We.length<F+M;)switch(qe=Vt[Re(O,H)],H+=qe&7,qe>>>=3){case 16:for(V=3+vt(O,H),H+=2,qe=We[We.length-1];V-- >0;)We.push(qe);break;case 17:for(V=3+nt(O,H),H+=3;V-- >0;)We.push(0);break;case 18:for(V=11+Re(O,H),H+=7;V-- >0;)We.push(0);break;default:We.push(qe),ce<qe&&(ce=qe);break}var Yt=We.slice(0,F),Jt=We.slice(F);for(Le=F;Le<286;++Le)Yt[Le]=0;for(Le=M;Le<30;++Le)Jt[Le]=0;return Pt=Pa(Yt,$t,286),ca=Pa(Jt,Gr,30),H}function Qn(O,H){if(O[0]==3&&!(O[1]&3))return[oi(H),2];for(var F=0,M=0,B=Fv(H||1<<18),V=0,fe=B.length>>>0,we=0,ce=0;(M&1)==0;){if(M=nt(O,F),F+=3,M>>>1)M>>1==1?(we=9,ce=5):(F=qr(O,F),we=Pt,ce=ca);else{F&7&&(F+=8-(F&7));var ie=O[F>>>3]|O[(F>>>3)+1]<<8;if(F+=32,ie>0)for(!H&&fe<V+ie&&(B=ka(B,V+ie),fe=B.length);ie-- >0;)B[V++]=O[F>>>3],F+=8;continue}for(;;){!H&&fe<V+32767&&(B=ka(B,V+32767),fe=B.length);var he=jt(O,F,we),Fe=M>>>1==1?za[he]:$t[he];if(F+=Fe&15,Fe>>>=4,(Fe>>>8&255)===0)B[V++]=Fe;else{if(Fe==256)break;Fe-=257;var Le=Fe<8?0:Fe-4>>2;Le>5&&(Le=0);var qe=V+te[Fe];Le>0&&(qe+=jt(O,F,Le),F+=Le),he=jt(O,F,ce),Fe=M>>>1==1?Vr[he]:Gr[he],F+=Fe&15,Fe>>>=4;var De=Fe<4?0:Fe-2>>1,$e=me[Fe];for(De>0&&($e+=jt(O,F,De),F+=De),!H&&fe<qe&&(B=ka(B,qe+100),fe=B.length);V<qe;)B[V]=B[V-$e],++V}}}return H?[B,F+7>>>3]:[B.slice(0,V),F+7>>>3]}function Zn(O,H){var F=O.slice(O.l||0),M=Qn(F,H);return O.l+=M[1],M[0]}function fl(O,H){if(O)typeof console<"u"&&console.error(H);else throw new Error(H)}function ua(O,H){var F=O;la(F,0);var M=[],B=[],V={FileIndex:M,FullPaths:B};N(V,{root:H.root});for(var fe=F.length-4;(F[fe]!=80||F[fe+1]!=75||F[fe+2]!=5||F[fe+3]!=6)&&fe>=0;)--fe;F.l=fe+4,F.l+=4;var we=F.read_shift(2);F.l+=6;var ce=F.read_shift(4);for(F.l=ce,fe=0;fe<we;++fe){F.l+=20;var ie=F.read_shift(4),he=F.read_shift(4),Fe=F.read_shift(2),Le=F.read_shift(2),qe=F.read_shift(2);F.l+=8;var De=F.read_shift(4),$e=u(F.slice(F.l+Fe,F.l+Fe+Le));F.l+=Fe+Le+qe;var We=F.l;F.l=De+4,Ln(F,ie,he,V,$e),F.l=We}return V}function Ln(O,H,F,M,B){O.l+=2;var V=O.read_shift(2),fe=O.read_shift(2),we=c(O);if(V&8257)throw new Error("Unsupported ZIP encryption");for(var ce=O.read_shift(4),ie=O.read_shift(4),he=O.read_shift(4),Fe=O.read_shift(2),Le=O.read_shift(2),qe="",De=0;De<Fe;++De)qe+=String.fromCharCode(O[O.l++]);if(Le){var $e=u(O.slice(O.l,O.l+Le));($e[21589]||{}).mt&&(we=$e[21589].mt),((B||{})[21589]||{}).mt&&(we=B[21589].mt)}O.l+=Le;var We=O.slice(O.l,O.l+ie);switch(fe){case 8:We=z(O,he);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+fe)}var Yt=!1;V&8&&(ce=O.read_shift(4),ce==134695760&&(ce=O.read_shift(4),Yt=!0),ie=O.read_shift(4),he=O.read_shift(4)),ie!=H&&fl(Yt,"Bad compressed size: "+H+" != "+ie),he!=F&&fl(Yt,"Bad uncompressed size: "+F+" != "+he),Os(M,qe,We,{unsafe:!0,mt:we})}function Ns(O,H){var F=H||{},M=[],B=[],V=_e(1),fe=F.compression?8:0,we=0,ce=0,ie=0,he=0,Fe=0,Le=O.FullPaths[0],qe=Le,De=O.FileIndex[0],$e=[],We=0;for(ce=1;ce<O.FullPaths.length;++ce)if(qe=O.FullPaths[ce].slice(Le.length),De=O.FileIndex[ce],!(!De.size||!De.content||qe=="Sh33tJ5")){var Yt=he,Jt=_e(qe.length);for(ie=0;ie<qe.length;++ie)Jt.write_shift(1,qe.charCodeAt(ie)&127);Jt=Jt.slice(0,Jt.l),$e[Fe]=dA.buf(De.content,0);var Qt=De.content;fe==8&&(Qt=I(Qt)),V=_e(30),V.write_shift(4,67324752),V.write_shift(2,20),V.write_shift(2,we),V.write_shift(2,fe),De.mt?l(V,De.mt):V.write_shift(4,0),V.write_shift(-4,$e[Fe]),V.write_shift(4,Qt.length),V.write_shift(4,De.content.length),V.write_shift(2,Jt.length),V.write_shift(2,0),he+=V.length,M.push(V),he+=Jt.length,M.push(Jt),he+=Qt.length,M.push(Qt),V=_e(46),V.write_shift(4,33639248),V.write_shift(2,0),V.write_shift(2,20),V.write_shift(2,we),V.write_shift(2,fe),V.write_shift(4,0),V.write_shift(-4,$e[Fe]),V.write_shift(4,Qt.length),V.write_shift(4,De.content.length),V.write_shift(2,Jt.length),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(4,0),V.write_shift(4,Yt),We+=V.l,B.push(V),We+=Jt.length,B.push(Jt),++Fe}return V=_e(22),V.write_shift(4,101010256),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(2,Fe),V.write_shift(2,Fe),V.write_shift(4,We),V.write_shift(4,he),V.write_shift(2,0),Yr([Yr(M),Yr(B),V])}var Aa={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function es(O,H){if(O.ctype)return O.ctype;var F=O.name||"",M=F.match(/\.([^\.]+)$/);return M&&Aa[M[1]]||H&&(M=(F=H).match(/[\.\\]([^\.\\])+$/),M&&Aa[M[1]])?Aa[M[1]]:"application/octet-stream"}function ts(O){for(var H=zc(O),F=[],M=0;M<H.length;M+=76)F.push(H.slice(M,M+76));return F.join(`\r
`)+`\r
`}function ko(O){var H=O.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ie){var he=ie.charCodeAt(0).toString(16).toUpperCase();return"="+(he.length==1?"0"+he:he)});H=H.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),H.charAt(0)==`
`&&(H="=0D"+H.slice(1)),H=H.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var F=[],M=H.split(`\r
`),B=0;B<M.length;++B){var V=M[B];if(V.length==0){F.push("");continue}for(var fe=0;fe<V.length;){var we=76,ce=V.slice(fe,fe+we);ce.charAt(we-1)=="="?we--:ce.charAt(we-2)=="="?we-=2:ce.charAt(we-3)=="="&&(we-=3),ce=V.slice(fe,fe+we),fe+=we,fe<V.length&&(ce+="="),F.push(ce)}}return F.join(`\r
`)}function hl(O){for(var H=[],F=0;F<O.length;++F){for(var M=O[F];F<=O.length&&M.charAt(M.length-1)=="=";)M=M.slice(0,M.length-1)+O[++F];H.push(M)}for(var B=0;B<H.length;++B)H[B]=H[B].replace(/[=][0-9A-Fa-f]{2}/g,function(V){return String.fromCharCode(parseInt(V.slice(1),16))});return tn(H.join(`\r
`))}function gi(O,H,F){for(var M="",B="",V="",fe,we=0;we<10;++we){var ce=H[we];if(!ce||ce.match(/^\s*$/))break;var ie=ce.match(/^(.*?):\s*([^\s].*)$/);if(ie)switch(ie[1].toLowerCase()){case"content-location":M=ie[2].trim();break;case"content-type":V=ie[2].trim();break;case"content-transfer-encoding":B=ie[2].trim();break}}switch(++we,B.toLowerCase()){case"base64":fe=tn(an(H.slice(we).join("")));break;case"quoted-printable":fe=hl(H.slice(we));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+B)}var he=Os(O,M.slice(F.length),fe,{unsafe:!0});V&&(he.ctype=V)}function rs(O,H){if(U(O.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var F=H&&H.root||"",M=(Tt&&Buffer.isBuffer(O)?O.toString("binary"):U(O)).split(`\r
`),B=0,V="";for(B=0;B<M.length;++B)if(V=M[B],!!/^Content-Location:/i.test(V)&&(V=V.slice(V.indexOf("file")),F||(F=V.slice(0,V.lastIndexOf("/")+1)),V.slice(0,F.length)!=F))for(;F.length>0&&(F=F.slice(0,F.length-1),F=F.slice(0,F.lastIndexOf("/")+1),V.slice(0,F.length)!=F););var fe=(M[1]||"").match(/boundary="(.*?)"/);if(!fe)throw new Error("MAD cannot find boundary");var we="--"+(fe[1]||""),ce=[],ie=[],he={FileIndex:ce,FullPaths:ie};N(he);var Fe,Le=0;for(B=0;B<M.length;++B){var qe=M[B];qe!==we&&qe!==we+"--"||(Le++&&gi(he,M.slice(Fe,B),F),Fe=B)}return he}function Ao(O,H){var F=H||{},M=F.boundary||"SheetJS";M="------="+M;for(var B=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+M.slice(2)+'"',"","",""],V=O.FullPaths[0],fe=V,we=O.FileIndex[0],ce=1;ce<O.FullPaths.length;++ce)if(fe=O.FullPaths[ce].slice(V.length),we=O.FileIndex[ce],!(!we.size||!we.content||fe=="Sh33tJ5")){fe=fe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(We){return"_x"+We.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(We){return"_u"+We.charCodeAt(0).toString(16)+"_"});for(var ie=we.content,he=Tt&&Buffer.isBuffer(ie)?ie.toString("binary"):U(ie),Fe=0,Le=Math.min(1024,he.length),qe=0,De=0;De<=Le;++De)(qe=he.charCodeAt(De))>=32&&qe<128&&++Fe;var $e=Fe>=Le*4/5;B.push(M),B.push("Content-Location: "+(F.root||"file:///C:/SheetJS/")+fe),B.push("Content-Transfer-Encoding: "+($e?"quoted-printable":"base64")),B.push("Content-Type: "+es(we,fe)),B.push(""),B.push($e?ko(he):ts(he))}return B.push(M+`--\r
`),B.join(`\r
`)}function dl(O){var H={};return N(H,O),H}function Os(O,H,F,M){var B=M&&M.unsafe;B||N(O);var V=!B&&lt.find(O,H);if(!V){var fe=O.FullPaths[0];H.slice(0,fe.length)==fe?fe=H:(fe.slice(-1)!="/"&&(fe+="/"),fe=(fe+H).replace("//","/")),V={name:s(H),type:2},O.FileIndex.push(V),O.FullPaths.push(fe),B||lt.utils.cfb_gc(O)}return V.content=F,V.size=F?F.length:0,M&&(M.CLSID&&(V.clsid=M.CLSID),M.mt&&(V.mt=M.mt),M.ct&&(V.ct=M.ct)),V}function ml(O,H){N(O);var F=lt.find(O,H);if(F){for(var M=0;M<O.FileIndex.length;++M)if(O.FileIndex[M]==F)return O.FileIndex.splice(M,1),O.FullPaths.splice(M,1),!0}return!1}function pi(O,H,F){N(O);var M=lt.find(O,H);if(M){for(var B=0;B<O.FileIndex.length;++B)if(O.FileIndex[B]==M)return O.FileIndex[B].name=s(F),O.FullPaths[B]=F,!0}return!1}function xi(O){P(O,!0)}return t.find=ae,t.read=D,t.parse=g,t.write=ve,t.writeFile=je,t.utils={cfb_new:dl,cfb_add:Os,cfb_del:ml,cfb_mov:pi,cfb_gc:xi,ReadShift:kc,CheckField:X_,prep_blob:la,bconcat:Yr,use_zlib:A,_deflateRaw:pt,_inflateRaw:Zn,consts:le},t})();function mA(e){return typeof e=="string"?of(e):Array.isArray(e)?Pk(e):e}function au(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=of(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var a=r=="utf8"?Kn(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(a,e);if(typeof Blob<"u"){var s=new Blob([mA(a)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var l=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(l)},6e4),chrome.downloads.download({url:l,filename:e,saveAs:!0});var c=document.createElement("a");if(c.download!=null)return c.download=e,c.href=l,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(l)},6e4),l}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var u=File(e);return u.open("w"),u.encoding="binary",Array.isArray(t)&&(t=hi(t)),u.write(t),u.close(),t}catch(h){if(!h.message||!h.message.match(/onstruct/))throw h}throw new Error("cannot save file "+e)}function gA(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("Cannot access file "+e)}function br(e){for(var t=Object.keys(e),r=[],a=0;a<t.length;++a)Object.prototype.hasOwnProperty.call(e,t[a])&&r.push(t[a]);return r}function zv(e,t){for(var r=[],a=br(e),s=0;s!==a.length;++s)r[e[a[s]][t]]==null&&(r[e[a[s]][t]]=a[s]);return r}function uf(e){for(var t=[],r=br(e),a=0;a!==r.length;++a)t[e[r[a]]]=r[a];return t}function ff(e){for(var t=[],r=br(e),a=0;a!==r.length;++a)t[e[r[a]]]=parseInt(r[a],10);return t}function pA(e){for(var t=[],r=br(e),a=0;a!==r.length;++a)t[e[r[a]]]==null&&(t[e[r[a]]]=[]),t[e[r[a]]].push(r[a]);return t}var W0=new Date(1899,11,30,0,0,0);function Hr(e,t){var r=e.getTime(),a=W0.getTime()+(e.getTimezoneOffset()-W0.getTimezoneOffset())*6e4;return(r-a)/(1440*60*1e3)}var k_=new Date,xA=W0.getTime()+(k_.getTimezoneOffset()-W0.getTimezoneOffset())*6e4,Hv=k_.getTimezoneOffset();function hf(e){var t=new Date;return t.setTime(e*24*60*60*1e3+xA),t.getTimezoneOffset()!==Hv&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Hv)*6e4),t}function vA(e){var t=0,r=0,a=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var l=1;l!=s.length;++l)if(s[l]){switch(r=1,l>3&&(a=!0),s[l].slice(s[l].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[l].slice(s[l].length-1));case"D":r*=24;case"H":r*=60;case"M":if(a)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(s[l],10)}return t}var $v=new Date("2017-02-19T19:06:09.000Z"),A_=isNaN($v.getFullYear())?new Date("2/19/17"):$v,yA=A_.getFullYear()==2017;function ur(e,t){var r=new Date(e);if(yA)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(A_.getFullYear()==1917&&!isNaN(r.getFullYear())){var a=r.getFullYear();return e.indexOf(""+a)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],l=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(l=new Date(l.getTime()-l.getTimezoneOffset()*60*1e3)),l}function Ji(e,t){if(Tt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Kn(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Kn(m_(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Kn(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Kn(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(l){return r[l]||l})}catch{}for(var a=[],s=0;s!=e.length;++s)a.push(String.fromCharCode(e[s]));return a.join("")}function fr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=fr(e[r]));return t}function _r(e,t){for(var r="";r.length<t;)r+=e;return r}function jn(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(a))||(a=a.replace(/[(](.*)[)]/,function(s,l){return r=-r,l}),!isNaN(t=Number(a)))?t/r:t}var _A=["january","february","march","april","may","june","july","august","september","october","november","december"];function yo(e){var t=new Date(e),r=new Date(NaN),a=t.getYear(),s=t.getMonth(),l=t.getDate();if(isNaN(l))return r;var c=e.toLowerCase();if(c.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(c=c.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),c.length>3&&_A.indexOf(c)==-1)return r}else if(c.match(/[a-z]/))return r;return a<0||a>8099?r:(s>0||l>1)&&a!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var wA=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,a,s){if(e||typeof a=="string")return r.split(a);for(var l=r.split(a),c=[l[0]],u=1;u<l.length;++u)c.push(s),c.push(l[u]);return c}})();function C_(e){return e?e.content&&e.type?Ji(e.content,!0):e.data?wc(e.data):e.asNodeBuffer&&Tt?wc(e.asNodeBuffer().toString("binary")):e.asBinary?wc(e.asBinary()):e._data&&e._data.getContent?wc(Ji(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function N_(e){if(!e)return null;if(e.data)return Rv(e.data);if(e.asNodeBuffer&&Tt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?Rv(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function bA(e){return e&&e.name.slice(-4)===".bin"?N_(e):C_(e)}function vn(e,t){for(var r=e.FullPaths||br(e.files),a=t.toLowerCase().replace(/[\/]/g,"\\"),s=a.replace(/\\/g,"/"),l=0;l<r.length;++l){var c=r[l].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==c||s==c)return e.files?e.files[r[l]]:e.FileIndex[l]}return null}function Nm(e,t){var r=vn(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function jr(e,t,r){if(!r)return bA(Nm(e,t));if(!t)return null;try{return jr(e,t)}catch{return null}}function rn(e,t,r){if(!r)return C_(Nm(e,t));if(!t)return null;try{return rn(e,t)}catch{return null}}function SA(e,t,r){return N_(Nm(e,t))}function Vv(e){for(var t=e.FullPaths||br(e.files),r=[],a=0;a<t.length;++a)t[a].slice(-1)!="/"&&r.push(t[a].replace(/^Root Entry[\/]/,""));return r.sort()}function St(e,t,r){if(e.FullPaths){if(typeof r=="string"){var a;return Tt?a=ks(r):a=zk(r),lt.utils.cfb_add(e,t,a)}lt.utils.cfb_add(e,t,r)}else e.file(t,r)}function Om(){return lt.utils.cfb_new()}function O_(e,t){switch(t.type){case"base64":return lt.read(e,{type:"base64"});case"binary":return lt.read(e,{type:"binary"});case"buffer":case"array":return lt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Sc(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var a=e.split("/");a.length!==0;){var s=a.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var Cr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,EA=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Gv=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,TA=/<[^>]*>/g,_a=Cr.match(Gv)?Gv:TA,kA=/<\w*:/,AA=/<(\/?)\w+:/;function mt(e,t,r){for(var a={},s=0,l=0;s!==e.length&&!((l=e.charCodeAt(s))===32||l===10||l===13);++s);if(t||(a[0]=e.slice(0,s)),s===e.length)return a;var c=e.match(EA),u=0,h="",d=0,g="",x="",y=1;if(c)for(d=0;d!=c.length;++d){for(x=c[d],l=0;l!=x.length&&x.charCodeAt(l)!==61;++l);for(g=x.slice(0,l).trim();x.charCodeAt(l+1)==32;)++l;for(y=(s=x.charCodeAt(l+1))==34||s==39?1:0,h=x.slice(l+1+y,x.length-y),u=0;u!=g.length&&g.charCodeAt(u)!==58;++u);if(u===g.length)g.indexOf("_")>0&&(g=g.slice(0,g.indexOf("_"))),a[g]=h,a[g.toLowerCase()]=h;else{var _=(u===5&&g.slice(0,5)==="xmlns"?"xmlns":"")+g.slice(u+1);if(a[_]&&g.slice(u-3,u)=="ext")continue;a[_]=h,a[_.toLowerCase()]=h}}return a}function Yn(e){return e.replace(AA,"<$1")}var R_={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Rm=uf(R_),Ft=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(a){var s=a+"",l=s.indexOf("<![CDATA[");if(l==-1)return s.replace(e,function(u,h){return R_[u]||String.fromCharCode(parseInt(h,u.indexOf("x")>-1?16:10))||u}).replace(t,function(u,h){return String.fromCharCode(parseInt(h,16))});var c=s.indexOf("]]>");return r(s.slice(0,l))+s.slice(l+9,c)+r(s.slice(c+3))}})(),Dm=/[&<>'"]/g,CA=/[\u0000-\u0008\u000b-\u001f]/g;function Kt(e){var t=e+"";return t.replace(Dm,function(r){return Rm[r]}).replace(CA,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function qv(e){return Kt(e).replace(/ /g,"_x0020_")}var D_=/[\u0000-\u001f]/g;function Fm(e){var t=e+"";return t.replace(Dm,function(r){return Rm[r]}).replace(/\n/g,"<br/>").replace(D_,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function NA(e){var t=e+"";return t.replace(Dm,function(r){return Rm[r]}).replace(D_,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var Xv=(function(){var e=/&#(\d+);/g;function t(r,a){return String.fromCharCode(parseInt(a,10))}return function(a){return a.replace(e,t)}})();function OA(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function cr(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Dd(e){for(var t="",r=0,a=0,s=0,l=0,c=0,u=0;r<e.length;){if(a=e.charCodeAt(r++),a<128){t+=String.fromCharCode(a);continue}if(s=e.charCodeAt(r++),a>191&&a<224){c=(a&31)<<6,c|=s&63,t+=String.fromCharCode(c);continue}if(l=e.charCodeAt(r++),a<240){t+=String.fromCharCode((a&15)<<12|(s&63)<<6|l&63);continue}c=e.charCodeAt(r++),u=((a&7)<<18|(s&63)<<12|(l&63)<<6|c&63)-65536,t+=String.fromCharCode(55296+(u>>>10&1023)),t+=String.fromCharCode(56320+(u&1023))}return t}function Wv(e){var t=oi(2*e.length),r,a,s=1,l=0,c=0,u;for(a=0;a<e.length;a+=s)s=1,(u=e.charCodeAt(a))<128?r=u:u<224?(r=(u&31)*64+(e.charCodeAt(a+1)&63),s=2):u<240?(r=(u&15)*4096+(e.charCodeAt(a+1)&63)*64+(e.charCodeAt(a+2)&63),s=3):(s=4,r=(u&7)*262144+(e.charCodeAt(a+1)&63)*4096+(e.charCodeAt(a+2)&63)*64+(e.charCodeAt(a+3)&63),r-=65536,c=55296+(r>>>10&1023),r=56320+(r&1023)),c!==0&&(t[l++]=c&255,t[l++]=c>>>8,c=0),t[l++]=r%256,t[l++]=r>>>8;return t.slice(0,l).toString("ucs2")}function Kv(e){return ks(e,"binary").toString("utf8")}var N0="foo bar baz",rr=Tt&&(Kv(N0)==Dd(N0)&&Kv||Wv(N0)==Dd(N0)&&Wv)||Dd,Kn=Tt?function(e){return ks(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,a=0,s=0;r<e.length;)switch(a=e.charCodeAt(r++),!0){case a<128:t.push(String.fromCharCode(a));break;case a<2048:t.push(String.fromCharCode(192+(a>>6))),t.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,s=e.charCodeAt(r++)-56320+(a<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(a>>12))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)))}return t.join("")},$c=(function(){var e={};return function(r,a){var s=r+"|"+(a||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",a||"")}})(),F_=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var a=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)a=a.replace(e[s][0],e[s][1]);return a}})(),RA=(function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),DA=/<\/?(?:vt:)?variant>/g,FA=/<(?:vt:)([^>]*)>([\s\S]*)</;function Yv(e,t){var r=mt(e),a=e.match(RA(r.baseType))||[],s=[];if(a.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+a.length+" != "+r.size);return s}return a.forEach(function(l){var c=l.replace(DA,"").match(FA);c&&s.push({v:rr(c[2]),t:c[1]})}),s}var M_=/(^\s|\s$|\n)/;function oa(e,t){return"<"+e+(t.match(M_)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Vc(e){return br(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Ue(e,t,r){return"<"+e+(r!=null?Vc(r):"")+(t!=null?(t.match(M_)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function nm(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function MA(e,t){switch(typeof e){case"string":var r=Ue("vt:lpwstr",Kt(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Ue((e|0)==e?"vt:i4":"vt:r8",Kt(String(e)));case"boolean":return Ue("vt:bool",e?"true":"false")}if(e instanceof Date)return Ue("vt:filetime",nm(e));throw new Error("Unable to serialize "+e)}function Mm(e){if(Tt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return rr(hi(km(e)));throw new Error("Bad input format: expected Buffer or string")}var Gc=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,zr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},sl=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Ja={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function jA(e,t){for(var r=1-2*(e[t+7]>>>7),a=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,l=5;l>=0;--l)s=s*256+e[t+l];return a==2047?s==0?r*(1/0):NaN:(a==0?a=-1022:(a-=1023,s+=Math.pow(2,52)),r*Math.pow(2,a-52)*s)}function IA(e,t,r){var a=(t<0||1/t==-1/0?1:0)<<7,s=0,l=0,c=a?-t:t;isFinite(c)?c==0?s=l=0:(s=Math.floor(Math.log(c)/Math.LN2),l=c*Math.pow(2,52-s),s<=-1023&&(!isFinite(l)||l<Math.pow(2,52))?s=-1022:(l-=Math.pow(2,52),s+=1023)):(s=2047,l=isNaN(t)?26985:0);for(var u=0;u<=5;++u,l/=256)e[r+u]=l&255;e[r+6]=(s&15)<<4|l&15,e[r+7]=s>>4|a}var Jv=function(e){for(var t=[],r=10240,a=0;a<e[0].length;++a)if(e[0][a])for(var s=0,l=e[0][a].length;s<l;s+=r)t.push.apply(t,e[0][a].slice(s,s+r));return t},Qv=Tt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:ks(t)})):Jv(e)}:Jv,Zv=function(e,t,r){for(var a=[],s=t;s<r;s+=2)a.push(String.fromCharCode(_s(e,s)));return a.join("").replace(Ta,"")},jm=Tt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Ta,""):Zv(e,t,r)}:Zv,ey=function(e,t,r){for(var a=[],s=t;s<t+r;++s)a.push(("0"+e[s].toString(16)).slice(-2));return a.join("")},j_=Tt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):ey(e,t,r)}:ey,ty=function(e,t,r){for(var a=[],s=t;s<r;s++)a.push(String.fromCharCode(oo(e,s)));return a.join("")},nu=Tt?function(t,r,a){return Buffer.isBuffer(t)?t.toString("utf8",r,a):ty(t,r,a)}:ty,I_=function(e,t){var r=Qa(e,t);return r>0?nu(e,t+4,t+4+r-1):""},L_=I_,B_=function(e,t){var r=Qa(e,t);return r>0?nu(e,t+4,t+4+r-1):""},U_=B_,P_=function(e,t){var r=2*Qa(e,t);return r>0?nu(e,t+4,t+4+r-1):""},z_=P_,H_=function(t,r){var a=Qa(t,r);return a>0?jm(t,r+4,r+4+a):""},$_=H_,V_=function(e,t){var r=Qa(e,t);return r>0?nu(e,t+4,t+4+r):""},G_=V_,q_=function(e,t){return jA(e,t)},K0=q_,Im=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Tt&&(L_=function(t,r){if(!Buffer.isBuffer(t))return I_(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},U_=function(t,r){if(!Buffer.isBuffer(t))return B_(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},z_=function(t,r){if(!Buffer.isBuffer(t))return P_(t,r);var a=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a-1)},$_=function(t,r){if(!Buffer.isBuffer(t))return H_(t,r);var a=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a)},G_=function(t,r){if(!Buffer.isBuffer(t))return V_(t,r);var a=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+a)},K0=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):q_(t,r)},Im=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var oo=function(e,t){return e[t]},_s=function(e,t){return e[t+1]*256+e[t]},LA=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Qa=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Hi=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},BA=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function kc(e,t){var r="",a,s,l=[],c,u,h,d;switch(t){case"dbcs":if(d=this.l,Tt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(h=0;h<e;++h)r+=String.fromCharCode(_s(this,d)),d+=2;e*=2;break;case"utf8":r=nu(this,this.l,this.l+e);break;case"utf16le":e*=2,r=jm(this,this.l,this.l+e);break;case"wstr":return kc.call(this,e,"dbcs");case"lpstr-ansi":r=L_(this,this.l),e=4+Qa(this,this.l);break;case"lpstr-cp":r=U_(this,this.l),e=4+Qa(this,this.l);break;case"lpwstr":r=z_(this,this.l),e=4+2*Qa(this,this.l);break;case"lpp4":e=4+Qa(this,this.l),r=$_(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Qa(this,this.l),r=G_(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(c=oo(this,this.l+e++))!==0;)l.push(C0(c));r=l.join("");break;case"_wstr":for(e=0,r="";(c=_s(this,this.l+e))!==0;)l.push(C0(c)),e+=2;e+=2,r=l.join("");break;case"dbcs-cont":for(r="",d=this.l,h=0;h<e;++h){if(this.lens&&this.lens.indexOf(d)!==-1)return c=oo(this,d),this.l=d+1,u=kc.call(this,e-h,c?"dbcs-cont":"sbcs-cont"),l.join("")+u;l.push(C0(_s(this,d))),d+=2}r=l.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",d=this.l,h=0;h!=e;++h){if(this.lens&&this.lens.indexOf(d)!==-1)return c=oo(this,d),this.l=d+1,u=kc.call(this,e-h,c?"dbcs-cont":"sbcs-cont"),l.join("")+u;l.push(C0(oo(this,d))),d+=1}r=l.join("");break;default:switch(e){case 1:return a=oo(this,this.l),this.l++,a;case 2:return a=(t==="i"?LA:_s)(this,this.l),this.l+=2,a;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(a=(e>0?Hi:BA)(this,this.l),this.l+=4,a):(s=Qa(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=K0(this,this.l):s=K0([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=j_(this,this.l,e);break}}return this.l+=e,r}var UA=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},PA=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},zA=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function HA(e,t,r){var a=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)zA(this,t.charCodeAt(s),this.l+2*s);a=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;a=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var l=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var c=t.charCodeAt(s);this[this.l++]=c&255,this[this.l++]=c>>8}for(;this.l<l;)this[this.l++]=0;return this}else switch(e){case 1:a=1,this[this.l]=t&255;break;case 2:a=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:a=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:a=4,UA(this,t,this.l);break;case 8:if(a=8,r==="f"){IA(this,t,this.l);break}case 16:break;case-4:a=4,PA(this,t,this.l);break}return this.l+=a,this}function X_(e,t){var r=j_(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function la(e,t){e.l=t,e.read_shift=kc,e.chk=X_,e.write_shift=HA}function ya(e,t){e.l+=t}function _e(e){var t=oi(e);return la(t,0),t}function As(e,t,r){if(e){var a,s,l;la(e,e.l||0);for(var c=e.length,u=0,h=0;e.l<c;){u=e.read_shift(1),u&128&&(u=(u&127)+((e.read_shift(1)&127)<<7));var d=Jc[u]||Jc[65535];for(a=e.read_shift(1),l=a&127,s=1;s<4&&a&128;++s)l+=((a=e.read_shift(1))&127)<<7*s;h=e.l+l;var g=d.f&&d.f(e,l,r);if(e.l=h,t(g,d,u))return}}}function Ba(){var e=[],t=Tt?256:2048,r=function(d){var g=_e(d);return la(g,0),g},a=r(t),s=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&e.push(a),a=null)},l=function(d){return a&&d<a.length-a.l?a:(s(),a=r(Math.max(d+1,t)))},c=function(){return s(),Yr(e)},u=function(d){s(),a=d,a.l==null&&(a.l=a.length),l(t)};return{next:l,push:u,end:c,_bufs:e}}function Ne(e,t,r,a){var s=+t,l;if(!isNaN(s)){a||(a=Jc[s].p||(r||[]).length||0),l=1+(s>=128?1:0)+1,a>=128&&++l,a>=16384&&++l,a>=2097152&&++l;var c=e.next(l);s<=127?c.write_shift(1,s):(c.write_shift(1,(s&127)+128),c.write_shift(1,s>>7));for(var u=0;u!=4;++u)if(a>=128)c.write_shift(1,(a&127)+128),a>>=7;else{c.write_shift(1,a);break}a>0&&Im(r)&&e.push(r)}}function Ac(e,t,r){var a=fr(e);if(t.s?(a.cRel&&(a.c+=t.s.c),a.rRel&&(a.r+=t.s.r)):(a.cRel&&(a.c+=t.c),a.rRel&&(a.r+=t.r)),!r||r.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function ry(e,t,r){var a=fr(e);return a.s=Ac(a.s,t.s,r),a.e=Ac(a.e,t.s,r),a}function Cc(e,t){if(e.cRel&&e.c<0)for(e=fr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=fr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=ht(e);return!e.cRel&&e.cRel!=null&&(r=GA(r)),!e.rRel&&e.rRel!=null&&(r=$A(r)),r}function Fd(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+gr(e.s.c)+":"+(e.e.cRel?"":"$")+gr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Ar(e.s.r)+":"+(e.e.rRel?"":"$")+Ar(e.e.r):Cc(e.s,t.biff)+":"+Cc(e.e,t.biff)}function Lm(e){return parseInt(VA(e),10)-1}function Ar(e){return""+(e+1)}function $A(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function VA(e){return e.replace(/\$(\d+)$/,"$1")}function Bm(e){for(var t=qA(e),r=0,a=0;a!==t.length;++a)r=26*r+t.charCodeAt(a)-64;return r-1}function gr(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function GA(e){return e.replace(/^([A-Z])/,"$$$1")}function qA(e){return e.replace(/^\$([A-Z])/,"$1")}function XA(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function pr(e){for(var t=0,r=0,a=0;a<e.length;++a){var s=e.charCodeAt(a);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function ht(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Ua(e){var t=e.indexOf(":");return t==-1?{s:pr(e),e:pr(e)}:{s:pr(e.slice(0,t)),e:pr(e.slice(t+1))}}function _t(e,t){return typeof t>"u"||typeof t=="number"?_t(e.s,e.e):(typeof e!="string"&&(e=ht(e)),typeof t!="string"&&(t=ht(t)),e==t?e:e+":"+t)}function Mt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,a=0,s=0,l=e.length;for(r=0;a<l&&!((s=e.charCodeAt(a)-64)<1||s>26);++a)r=26*r+s;for(t.s.c=--r,r=0;a<l&&!((s=e.charCodeAt(a)-48)<0||s>9);++a)r=10*r+s;if(t.s.r=--r,a===l||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++a,r=0;a!=l&&!((s=e.charCodeAt(a)-64)<1||s>26);++a)r=26*r+s;for(t.e.c=--r,r=0;a!=l&&!((s=e.charCodeAt(a)-48)<0||s>9);++a)r=10*r+s;return t.e.r=--r,t}function ay(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=wn(e.z,r?Hr(t):t)}catch{}try{return e.w=wn((e.XF||{}).numFmtId||(r?14:0),r?Hr(t):t)}catch{return""+t}}function Es(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Cs[e.v]||e.v:t==null?ay(e,e.v):ay(e,t))}function di(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",a={};return a[r]=e,{SheetNames:[r],Sheets:a}}function W_(e,t,r){var a=r||{},s=e?Array.isArray(e):a.dense,l=e||(s?[]:{}),c=0,u=0;if(l&&a.origin!=null){if(typeof a.origin=="number")c=a.origin;else{var h=typeof a.origin=="string"?pr(a.origin):a.origin;c=h.r,u=h.c}l["!ref"]||(l["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(l["!ref"]){var g=Mt(l["!ref"]);d.s.c=g.s.c,d.s.r=g.s.r,d.e.c=Math.max(d.e.c,g.e.c),d.e.r=Math.max(d.e.r,g.e.r),c==-1&&(d.e.r=c=g.e.r+1)}for(var x=0;x!=t.length;++x)if(t[x]){if(!Array.isArray(t[x]))throw new Error("aoa_to_sheet expects an array of arrays");for(var y=0;y!=t[x].length;++y)if(!(typeof t[x][y]>"u")){var _={v:t[x][y]},b=c+x,w=u+y;if(d.s.r>b&&(d.s.r=b),d.s.c>w&&(d.s.c=w),d.e.r<b&&(d.e.r=b),d.e.c<w&&(d.e.c=w),t[x][y]&&typeof t[x][y]=="object"&&!Array.isArray(t[x][y])&&!(t[x][y]instanceof Date))_=t[x][y];else if(Array.isArray(_.v)&&(_.f=t[x][y][1],_.v=_.v[0]),_.v===null)if(_.f)_.t="n";else if(a.nullError)_.t="e",_.v=0;else if(a.sheetStubs)_.t="z";else continue;else typeof _.v=="number"?_.t="n":typeof _.v=="boolean"?_.t="b":_.v instanceof Date?(_.z=a.dateNF||ft[14],a.cellDates?(_.t="d",_.w=wn(_.z,Hr(_.v))):(_.t="n",_.v=Hr(_.v),_.w=wn(_.z,_.v))):_.t="s";if(s)l[b]||(l[b]=[]),l[b][w]&&l[b][w].z&&(_.z=l[b][w].z),l[b][w]=_;else{var S=ht({c:w,r:b});l[S]&&l[S].z&&(_.z=l[S].z),l[S]=_}}}return d.s.c<1e7&&(l["!ref"]=_t(d)),l}function Eo(e,t){return W_(null,e,t)}function WA(e){return e.read_shift(4,"i")}function In(e,t){return t||(t=_e(4)),t.write_shift(4,e),t}function va(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Jr(e,t){var r=!1;return t==null&&(r=!0,t=_e(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function KA(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function YA(e,t){return t||(t=_e(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Um(e,t){var r=e.l,a=e.read_shift(1),s=va(e),l=[],c={t:s,h:s};if((a&1)!==0){for(var u=e.read_shift(4),h=0;h!=u;++h)l.push(KA(e));c.r=l}else c.r=[{ich:0,ifnt:0}];return e.l=r+t,c}function JA(e,t){var r=!1;return t==null&&(r=!0,t=_e(15+4*e.t.length)),t.write_shift(1,0),Jr(e.t,t),r?t.slice(0,t.l):t}var QA=Um;function ZA(e,t){var r=!1;return t==null&&(r=!0,t=_e(23+4*e.t.length)),t.write_shift(1,1),Jr(e.t,t),t.write_shift(4,1),YA({},t),r?t.slice(0,t.l):t}function bn(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function il(e,t){return t==null&&(t=_e(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function ll(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function ol(e,t){return t==null&&(t=_e(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var e3=va,K_=Jr;function Pm(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Y0(e,t){var r=!1;return t==null&&(r=!0,t=_e(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var t3=va,sm=Pm,zm=Y0;function Hm(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,a=t[0]&2;e.l+=4;var s=a===0?K0([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Hi(t,0)>>2;return r?s/100:s}function Y_(e,t){t==null&&(t=_e(4));var r=0,a=0,s=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?a=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(a=1,r=1),a)t.write_shift(-4,((r?s:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function J_(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function r3(e,t){return t||(t=_e(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var cl=J_,To=r3;function xa(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Qi(e,t){return(t||_e(8)).write_shift(8,e,"f")}function a3(e){var t={},r=e.read_shift(1),a=r>>>1,s=e.read_shift(1),l=e.read_shift(2,"i"),c=e.read_shift(1),u=e.read_shift(1),h=e.read_shift(1);switch(e.l++,a){case 0:t.auto=1;break;case 1:t.index=s;var d=Gi[s];d&&(t.rgb=Xc(d));break;case 2:t.rgb=Xc([c,u,h]);break;case 3:t.theme=s;break}return l!=0&&(t.tint=l>0?l/32767:l/32768),t}function J0(e,t){if(t||(t=_e(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var a=e.rgb||"FFFFFF";typeof a=="number"&&(a=("000000"+a.toString(16)).slice(-6)),t.write_shift(1,parseInt(a.slice(0,2),16)),t.write_shift(1,parseInt(a.slice(2,4),16)),t.write_shift(1,parseInt(a.slice(4,6),16)),t.write_shift(1,255)}return t}function n3(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function s3(e,t){t||(t=_e(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function Q_(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},a=e.read_shift(4);switch(a){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(a>400)throw new Error("Unsupported Clipboard: "+a.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function i3(e){return Q_(e,1)}function l3(e){return Q_(e,2)}var $m=2,La=3,O0=11,ny=12,Q0=19,R0=64,o3=65,c3=71,u3=4108,f3=4126,Kr=80,Z_=81,h3=[Kr,Z_],im={1:{n:"CodePage",t:$m},2:{n:"Category",t:Kr},3:{n:"PresentationFormat",t:Kr},4:{n:"ByteCount",t:La},5:{n:"LineCount",t:La},6:{n:"ParagraphCount",t:La},7:{n:"SlideCount",t:La},8:{n:"NoteCount",t:La},9:{n:"HiddenCount",t:La},10:{n:"MultimediaClipCount",t:La},11:{n:"ScaleCrop",t:O0},12:{n:"HeadingPairs",t:u3},13:{n:"TitlesOfParts",t:f3},14:{n:"Manager",t:Kr},15:{n:"Company",t:Kr},16:{n:"LinksUpToDate",t:O0},17:{n:"CharacterCount",t:La},19:{n:"SharedDoc",t:O0},22:{n:"HyperlinksChanged",t:O0},23:{n:"AppVersion",t:La,p:"version"},24:{n:"DigSig",t:o3},26:{n:"ContentType",t:Kr},27:{n:"ContentStatus",t:Kr},28:{n:"Language",t:Kr},29:{n:"Version",t:Kr},255:{},2147483648:{n:"Locale",t:Q0},2147483651:{n:"Behavior",t:Q0},1919054434:{}},lm={1:{n:"CodePage",t:$m},2:{n:"Title",t:Kr},3:{n:"Subject",t:Kr},4:{n:"Author",t:Kr},5:{n:"Keywords",t:Kr},6:{n:"Comments",t:Kr},7:{n:"Template",t:Kr},8:{n:"LastAuthor",t:Kr},9:{n:"RevNumber",t:Kr},10:{n:"EditTime",t:R0},11:{n:"LastPrinted",t:R0},12:{n:"CreatedDate",t:R0},13:{n:"ModifiedDate",t:R0},14:{n:"PageCount",t:La},15:{n:"WordCount",t:La},16:{n:"CharCount",t:La},17:{n:"Thumbnail",t:c3},18:{n:"Application",t:Kr},19:{n:"DocSecurity",t:La},255:{},2147483648:{n:"Locale",t:Q0},2147483651:{n:"Behavior",t:Q0},1919054434:{}},sy={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},d3=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function m3(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var g3=m3([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Gi=fr(g3),Cs={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},e2={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},om={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},D0={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Vm(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function p3(e){var t=Vm();if(!e||!e.match)return t;var r={};if((e.match(_a)||[]).forEach(function(a){var s=mt(a);switch(s[0].replace(kA,"<")){case"<?xml":break;case"<Types":t.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":t[om[s.ContentType]]!==void 0&&t[om[s.ContentType]].push(s.PartName);break}}),t.xmlns!==zr.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function t2(e,t){var r=pA(om),a=[],s;a[a.length]=Cr,a[a.length]=Ue("Types",null,{xmlns:zr.CT,"xmlns:xsd":zr.xsd,"xmlns:xsi":zr.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(h){return Ue("Default",null,{Extension:h[0],ContentType:h[1]})}));var l=function(h){e[h]&&e[h].length>0&&(s=e[h][0],a[a.length]=Ue("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:D0[h][t.bookType]||D0[h].xlsx}))},c=function(h){(e[h]||[]).forEach(function(d){a[a.length]=Ue("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:D0[h][t.bookType]||D0[h].xlsx})})},u=function(h){(e[h]||[]).forEach(function(d){a[a.length]=Ue("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:r[h][0]})})};return l("workbooks"),c("sheets"),c("charts"),u("themes"),["strs","styles"].forEach(l),["coreprops","extprops","custprops"].forEach(u),u("vba"),u("comments"),u("threadedcomments"),u("drawings"),c("metadata"),u("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var At={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function qc(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Nc(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var a={};return(e.match(_a)||[]).forEach(function(s){var l=mt(s);if(l[0]==="<Relationship"){var c={};c.Type=l.Type,c.Target=l.Target,c.Id=l.Id,l.TargetMode&&(c.TargetMode=l.TargetMode);var u=l.TargetMode==="External"?l.Target:Sc(l.Target,t);r[u]=c,a[l.Id]=c}}),r["!id"]=a,r}function mo(e){var t=[Cr,Ue("Relationships",null,{xmlns:zr.RELS})];return br(e["!id"]).forEach(function(r){t[t.length]=Ue("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Wt(e,t,r,a,s,l){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,s.Id="rId"+t,s.Type=a,s.Target=r,[At.HLINK,At.XPATH,At.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,t}var x3="application/vnd.oasis.opendocument.spreadsheet";function v3(e,t){for(var r=Mm(e),a,s;a=Gc.exec(r);)switch(a[3]){case"manifest":break;case"file-entry":if(s=mt(a[0],!1),s.path=="/"&&s.type!==x3)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw a}}function y3(e){var t=[Cr];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function iy(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function _3(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function w3(e){var t=[Cr];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(iy(e[r][0],e[r][1])),t.push(_3("",e[r][0]));return t.push(iy("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function r2(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+V0.version+"</meta:generator></office:meta></office:document-meta>"}var _n=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],b3=(function(){for(var e=new Array(_n.length),t=0;t<_n.length;++t){var r=_n[t],a="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return e})();function a2(e){var t={};e=rr(e);for(var r=0;r<_n.length;++r){var a=_n[r],s=e.match(b3[r]);s!=null&&s.length>0&&(t[a[1]]=Ft(s[1])),a[2]==="date"&&t[a[1]]&&(t[a[1]]=ur(t[a[1]]))}return t}function Md(e,t,r,a,s){s[e]!=null||t==null||t===""||(s[e]=t,t=Kt(t),a[a.length]=r?Ue(e,t,r):oa(e,t))}function n2(e,t){var r=t||{},a=[Cr,Ue("cp:coreProperties",null,{"xmlns:cp":zr.CORE_PROPS,"xmlns:dc":zr.dc,"xmlns:dcterms":zr.dcterms,"xmlns:dcmitype":zr.dcmitype,"xmlns:xsi":zr.xsi})],s={};if(!e&&!r.Props)return a.join("");e&&(e.CreatedDate!=null&&Md("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:nm(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,s),e.ModifiedDate!=null&&Md("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:nm(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,s));for(var l=0;l!=_n.length;++l){var c=_n[l],u=r.Props&&r.Props[c[1]]!=null?r.Props[c[1]]:e?e[c[1]]:null;u===!0?u="1":u===!1?u="0":typeof u=="number"&&(u=String(u)),u!=null&&Md(c[0],u,null,a,s)}return a.length>2&&(a[a.length]="</cp:coreProperties>",a[1]=a[1].replace("/>",">")),a.join("")}var qi=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],s2=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function i2(e,t,r,a){var s=[];if(typeof e=="string")s=Yv(e,a);else for(var l=0;l<e.length;++l)s=s.concat(e[l].map(function(g){return{v:g}}));var c=typeof t=="string"?Yv(t,a).map(function(g){return g.v}):t,u=0,h=0;if(c.length>0)for(var d=0;d!==s.length;d+=2){switch(h=+s[d+1].v,s[d].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=h,r.SheetNames=c.slice(u,u+h);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=h,r.DefinedNames=c.slice(u,u+h);break;case"Charts":case"Diagramme":r.Chartsheets=h,r.ChartNames=c.slice(u,u+h);break}u+=h}}function S3(e,t,r){var a={};return t||(t={}),e=rr(e),qi.forEach(function(s){var l=(e.match($c(s[0]))||[])[1];switch(s[2]){case"string":l&&(t[s[1]]=Ft(l));break;case"bool":t[s[1]]=l==="true";break;case"raw":var c=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));c&&c.length>0&&(a[s[1]]=c[1]);break}}),a.HeadingPairs&&a.TitlesOfParts&&i2(a.HeadingPairs,a.TitlesOfParts,t,r),t}function l2(e){var t=[],r=Ue;return e||(e={}),e.Application="SheetJS",t[t.length]=Cr,t[t.length]=Ue("Properties",null,{xmlns:zr.EXT_PROPS,"xmlns:vt":zr.vt}),qi.forEach(function(a){if(e[a[1]]!==void 0){var s;switch(a[2]){case"string":s=Kt(String(e[a[1]]));break;case"bool":s=e[a[1]]?"true":"false";break}s!==void 0&&(t[t.length]=r(a[0],s))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(a){return"<vt:lpstr>"+Kt(a)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var E3=/<[^>]+>[^<]*/g;function T3(e,t){var r={},a="",s=e.match(E3);if(s)for(var l=0;l!=s.length;++l){var c=s[l],u=mt(c);switch(u[0]){case"<?xml":break;case"<Properties":break;case"<property":a=Ft(u.name);break;case"</property>":a=null;break;default:if(c.indexOf("<vt:")===0){var h=c.split(">"),d=h[0].slice(4),g=h[1];switch(d){case"lpstr":case"bstr":case"lpwstr":r[a]=Ft(g);break;case"bool":r[a]=cr(g);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[a]=parseInt(g,10);break;case"r4":case"r8":case"decimal":r[a]=parseFloat(g);break;case"filetime":case"date":r[a]=ur(g);break;case"cy":case"error":r[a]=Ft(g);break;default:if(d.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",c,d,h)}}else if(c.slice(0,2)!=="</"){if(t.WTF)throw new Error(c)}}}return r}function o2(e){var t=[Cr,Ue("Properties",null,{xmlns:zr.CUST_PROPS,"xmlns:vt":zr.vt})];if(!e)return t.join("");var r=1;return br(e).forEach(function(s){++r,t[t.length]=Ue("property",MA(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Kt(s)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var cm={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},jd;function k3(e,t,r){jd||(jd=uf(cm)),t=jd[t]||t,e[t]=r}function A3(e,t){var r=[];return br(cm).map(function(a){for(var s=0;s<_n.length;++s)if(_n[s][1]==a)return _n[s];for(s=0;s<qi.length;++s)if(qi[s][1]==a)return qi[s];throw a}).forEach(function(a){if(e[a[1]]!=null){var s=t&&t.Props&&t.Props[a[1]]!=null?t.Props[a[1]]:e[a[1]];a[2]==="date"&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"Z")),typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(oa(cm[a[1]]||a[1],s))}}),Ue("DocumentProperties",r.join(""),{xmlns:Ja.o})}function C3(e,t){var r=["Worksheets","SheetNames"],a="CustomDocumentProperties",s=[];return e&&br(e).forEach(function(l){if(Object.prototype.hasOwnProperty.call(e,l)){for(var c=0;c<_n.length;++c)if(l==_n[c][1])return;for(c=0;c<qi.length;++c)if(l==qi[c][1])return;for(c=0;c<r.length;++c)if(l==r[c])return;var u=e[l],h="string";typeof u=="number"?(h="float",u=String(u)):u===!0||u===!1?(h="boolean",u=u?"1":"0"):u=String(u),s.push(Ue(qv(l),u,{"dt:dt":h}))}}),t&&br(t).forEach(function(l){if(Object.prototype.hasOwnProperty.call(t,l)&&!(e&&Object.prototype.hasOwnProperty.call(e,l))){var c=t[l],u="string";typeof c=="number"?(u="float",c=String(c)):c===!0||c===!1?(u="boolean",c=c?"1":"0"):c instanceof Date?(u="dateTime.tz",c=c.toISOString()):c=String(c),s.push(Ue(qv(l),c,{"dt:dt":u}))}}),"<"+a+' xmlns="'+Ja.o+'">'+s.join("")+"</"+a+">"}function Gm(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function N3(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,a=r%Math.pow(2,32),s=(r-a)/Math.pow(2,32);a*=1e7,s*=1e7;var l=a/Math.pow(2,32)|0;l>0&&(a=a%Math.pow(2,32),s+=l);var c=_e(8);return c.write_shift(4,a),c.write_shift(4,s),c}function c2(e,t,r){var a=e.l,s=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-a&3;)++e.l;return s}function u2(e,t,r){var a=e.read_shift(0,"lpwstr");return a}function f2(e,t,r){return t===31?u2(e):c2(e,t,r)}function um(e,t,r){return f2(e,t,r===!1?0:4)}function O3(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return f2(e,t,0)}function R3(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a){var s=e.l;r[a]=e.read_shift(0,"lpwstr").replace(Ta,""),e.l-s&2&&(e.l+=2)}return r}function D3(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a)r[a]=e.read_shift(0,"lpstr-cp").replace(Ta,"");return r}function F3(e){var t=e.l,r=Z0(e,Z_);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var a=Z0(e,La);return[r,a]}function M3(e){for(var t=e.read_shift(4),r=[],a=0;a<t/2;++a)r.push(F3(e));return r}function ly(e,t){for(var r=e.read_shift(4),a={},s=0;s!=r;++s){var l=e.read_shift(4),c=e.read_shift(4);a[l]=e.read_shift(c,t===1200?"utf16le":"utf8").replace(Ta,"").replace(bc,"!"),t===1200&&c%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),a}function h2(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function j3(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Z0(e,t,r){var a=e.read_shift(2),s,l=r||{};if(e.l+=2,t!==ny&&a!==t&&h3.indexOf(t)===-1&&!((t&65534)==4126&&(a&65534)==4126))throw new Error("Expected type "+t+" saw "+a);switch(t===ny?a:t){case 2:return s=e.read_shift(2,"i"),l.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return c2(e,a,4).replace(Ta,"");case 31:return u2(e);case 64:return Gm(e);case 65:return h2(e);case 71:return j3(e);case 80:return um(e,a,!l.raw).replace(Ta,"");case 81:return O3(e,a).replace(Ta,"");case 4108:return M3(e);case 4126:case 4127:return a==4127?R3(e):D3(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+a)}}function oy(e,t){var r=_e(4),a=_e(4);switch(r.write_shift(4,e==80?31:e),e){case 3:a.write_shift(-4,t);break;case 5:a=_e(8),a.write_shift(8,t,"f");break;case 11:a.write_shift(4,t?1:0);break;case 64:a=N3(t);break;case 31:case 80:for(a=_e(4+2*(t.length+1)+(t.length%2?0:2)),a.write_shift(4,t.length+1),a.write_shift(0,t,"dbcs");a.l!=a.length;)a.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Yr([r,a])}function cy(e,t){var r=e.l,a=e.read_shift(4),s=e.read_shift(4),l=[],c=0,u=0,h=-1,d={};for(c=0;c!=s;++c){var g=e.read_shift(4),x=e.read_shift(4);l[c]=[g,x+r]}l.sort(function(C,T){return C[1]-T[1]});var y={};for(c=0;c!=s;++c){if(e.l!==l[c][1]){var _=!0;if(c>0&&t)switch(t[l[c-1][0]].t){case 2:e.l+2===l[c][1]&&(e.l+=2,_=!1);break;case 80:e.l<=l[c][1]&&(e.l=l[c][1],_=!1);break;case 4108:e.l<=l[c][1]&&(e.l=l[c][1],_=!1);break}if((!t||c==0)&&e.l<=l[c][1]&&(_=!1,e.l=l[c][1]),_)throw new Error("Read Error: Expected address "+l[c][1]+" at "+e.l+" :"+c)}if(t){var b=t[l[c][0]];if(y[b.n]=Z0(e,b.t,{raw:!0}),b.p==="version"&&(y[b.n]=String(y[b.n]>>16)+"."+("0000"+String(y[b.n]&65535)).slice(-4)),b.n=="CodePage")switch(y[b.n]){case 0:y[b.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Fn(u=y[b.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+y[b.n])}}else if(l[c][0]===1){if(u=y.CodePage=Z0(e,$m),Fn(u),h!==-1){var w=e.l;e.l=l[h][1],d=ly(e,u),e.l=w}}else if(l[c][0]===0){if(u===0){h=c,e.l=l[c+1][1];continue}d=ly(e,u)}else{var S=d[l[c][0]],k;switch(e[e.l]){case 65:e.l+=4,k=h2(e);break;case 30:e.l+=4,k=um(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,k=um(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,k=e.read_shift(4,"i");break;case 19:e.l+=4,k=e.read_shift(4);break;case 5:e.l+=4,k=e.read_shift(8,"f");break;case 11:e.l+=4,k=kr(e,4);break;case 64:e.l+=4,k=ur(Gm(e));break;default:throw new Error("unparsed value: "+e[e.l])}y[S]=k}}return e.l=r+a,y}var d2=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function I3(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function uy(e,t,r){var a=_e(8),s=[],l=[],c=8,u=0,h=_e(8),d=_e(8);if(h.write_shift(4,2),h.write_shift(4,1200),d.write_shift(4,1),l.push(h),s.push(d),c+=8+h.length,!t){d=_e(8),d.write_shift(4,0),s.unshift(d);var g=[_e(4)];for(g[0].write_shift(4,e.length),u=0;u<e.length;++u){var x=e[u][0];for(h=_e(8+2*(x.length+1)+(x.length%2?0:2)),h.write_shift(4,u+2),h.write_shift(4,x.length+1),h.write_shift(0,x,"dbcs");h.l!=h.length;)h.write_shift(1,0);g.push(h)}h=Yr(g),l.unshift(h),c+=8+h.length}for(u=0;u<e.length;++u)if(!(t&&!t[e[u][0]])&&!(d2.indexOf(e[u][0])>-1||s2.indexOf(e[u][0])>-1)&&e[u][1]!=null){var y=e[u][1],_=0;if(t){_=+t[e[u][0]];var b=r[_];if(b.p=="version"&&typeof y=="string"){var w=y.split(".");y=(+w[0]<<16)+(+w[1]||0)}h=oy(b.t,y)}else{var S=I3(y);S==-1&&(S=31,y=String(y)),h=oy(S,y)}l.push(h),d=_e(8),d.write_shift(4,t?_:2+u),s.push(d),c+=8+h.length}var k=8*(l.length+1);for(u=0;u<l.length;++u)s[u].write_shift(4,k),k+=l[u].length;return a.write_shift(4,c),a.write_shift(4,l.length),Yr([a].concat(s).concat(l))}function fy(e,t,r){var a=e.content;if(!a)return{};la(a,0);var s,l,c,u,h=0;a.chk("feff","Byte Order: "),a.read_shift(2);var d=a.read_shift(4),g=a.read_shift(16);if(g!==lt.utils.consts.HEADER_CLSID&&g!==r)throw new Error("Bad PropertySet CLSID "+g);if(s=a.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(l=a.read_shift(16),u=a.read_shift(4),s===1&&u!==a.l)throw new Error("Length mismatch: "+u+" !== "+a.l);s===2&&(c=a.read_shift(16),h=a.read_shift(4));var x=cy(a,t),y={SystemIdentifier:d};for(var _ in x)y[_]=x[_];if(y.FMTID=l,s===1)return y;if(h-a.l==2&&(a.l+=2),a.l!==h)throw new Error("Length mismatch 2: "+a.l+" !== "+h);var b;try{b=cy(a,null)}catch{}for(_ in b)y[_]=b[_];return y.FMTID=[l,c],y}function hy(e,t,r,a,s,l){var c=_e(s?68:48),u=[c];c.write_shift(2,65534),c.write_shift(2,0),c.write_shift(4,842412599),c.write_shift(16,lt.utils.consts.HEADER_CLSID,"hex"),c.write_shift(4,s?2:1),c.write_shift(16,t,"hex"),c.write_shift(4,s?68:48);var h=uy(e,r,a);if(u.push(h),s){var d=uy(s,null,null);c.write_shift(16,l,"hex"),c.write_shift(4,68+h.length),u.push(d)}return Yr(u)}function ti(e,t){return e.read_shift(t),null}function L3(e,t){t||(t=_e(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function B3(e,t,r){for(var a=[],s=e.l+t;e.l<s;)a.push(r(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return a}function kr(e,t){return e.read_shift(t)===1}function Ea(e,t){return t||(t=_e(2)),t.write_shift(2,+!!e),t}function Ir(e){return e.read_shift(2,"u")}function yn(e,t){return t||(t=_e(2)),t.write_shift(2,e),t}function m2(e,t){return B3(e,t,Ir)}function U3(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function g2(e,t,r){return r||(r=_e(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function su(e,t,r){var a=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var l=e.read_shift(1);l&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var c=a?e.read_shift(a,s):"";return c}function P3(e){var t=e.read_shift(2),r=e.read_shift(1),a=r&4,s=r&8,l=1+(r&1),c=0,u,h={};s&&(c=e.read_shift(2)),a&&(u=e.read_shift(4));var d=l==2?"dbcs-cont":"sbcs-cont",g=t===0?"":e.read_shift(t,d);return s&&(e.l+=4*c),a&&(e.l+=u),h.t=g,s||(h.raw="<t>"+h.t+"</t>",h.r=h.t),h}function z3(e){var t=e.t||"",r=_e(3);r.write_shift(2,t.length),r.write_shift(1,1);var a=_e(2*t.length);a.write_shift(2*t.length,t,"utf16le");var s=[r,a];return Yr(s)}function Zi(e,t,r){var a;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?a=e.read_shift(t,"sbcs-cont"):a=e.read_shift(t,"dbcs-cont"),a}function iu(e,t,r){var a=e.read_shift(r&&r.biff==2?1:2);return a===0?(e.l++,""):Zi(e,a,r)}function ul(e,t,r){if(r.biff>5)return iu(e,t,r);var a=e.read_shift(1);return a===0?(e.l++,""):e.read_shift(a,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function p2(e,t,r){return r||(r=_e(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function H3(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function $3(e){var t=e.read_shift(4),r=e.l,a=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(a=!0),e.l=r);var s=e.read_shift((a?t-24:t)>>1,"utf16le").replace(Ta,"");return a&&(e.l+=24),s}function V3(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var a=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return r+a.replace(/\\/g,"/");var l=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var c=e.read_shift(l>>1,"utf16le").replace(Ta,"");return r+c}function G3(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return $3(e);case"0303000000000000c000000000000046":return V3(e);default:throw new Error("Unsupported Moniker "+r)}}function F0(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Ta,""):"";return r}function dy(e,t){t||(t=_e(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function q3(e,t){var r=e.l+t,a=e.read_shift(4);if(a!==2)throw new Error("Unrecognized streamVersion: "+a);var s=e.read_shift(2);e.l+=2;var l,c,u,h,d="",g,x;s&16&&(l=F0(e,r-e.l)),s&128&&(c=F0(e,r-e.l)),(s&257)===257&&(u=F0(e,r-e.l)),(s&257)===1&&(h=G3(e,r-e.l)),s&8&&(d=F0(e,r-e.l)),s&32&&(g=e.read_shift(16)),s&64&&(x=Gm(e)),e.l=r;var y=c||u||h||"";y&&d&&(y+="#"+d),y||(y="#"+d),s&2&&y.charAt(0)=="/"&&y.charAt(1)!="/"&&(y="file://"+y);var _={Target:y};return g&&(_.guid=g),x&&(_.time=x),l&&(_.Tooltip=l),_}function X3(e){var t=_e(512),r=0,a=e.Target;a.slice(0,7)=="file://"&&(a=a.slice(7));var s=a.indexOf("#"),l=s>-1?31:23;switch(a.charAt(0)){case"#":l=28;break;case".":l&=-3;break}t.write_shift(4,2),t.write_shift(4,l);var c=[8,6815827,6619237,4849780,83];for(r=0;r<c.length;++r)t.write_shift(4,c[r]);if(l==28)a=a.slice(1),dy(a,t);else if(l&2){for(c="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<c.length;++r)t.write_shift(1,parseInt(c[r],16));var u=s>-1?a.slice(0,s):a;for(t.write_shift(4,2*(u.length+1)),r=0;r<u.length;++r)t.write_shift(2,u.charCodeAt(r));t.write_shift(2,0),l&8&&dy(s>-1?a.slice(s+1):"",t)}else{for(c="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<c.length;++r)t.write_shift(1,parseInt(c[r],16));for(var h=0;a.slice(h*3,h*3+3)=="../"||a.slice(h*3,h*3+3)=="..\\";)++h;for(t.write_shift(2,h),t.write_shift(4,a.length-3*h+1),r=0;r<a.length-3*h;++r)t.write_shift(1,a.charCodeAt(r+3*h)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function x2(e){var t=e.read_shift(1),r=e.read_shift(1),a=e.read_shift(1),s=e.read_shift(1);return[t,r,a,s]}function v2(e,t){var r=x2(e);return r[3]=0,r}function Jn(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return{r:t,c:r,ixfe:a}}function el(e,t,r,a){return a||(a=_e(6)),a.write_shift(2,e),a.write_shift(2,t),a.write_shift(2,r||0),a}function W3(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function K3(e,t,r){return t===0?"":ul(e,t,r)}function Y3(e,t,r){var a=r.biff>8?4:2,s=e.read_shift(a),l=e.read_shift(a,"i"),c=e.read_shift(a,"i");return[s,l,c]}function y2(e){var t=e.read_shift(2),r=Hm(e);return[t,r]}function J3(e,t,r){e.l+=4,t-=4;var a=e.l+t,s=su(e,t,r),l=e.read_shift(2);if(a-=e.l,l!==a)throw new Error("Malformed AddinUdf: padding = "+a+" != "+l);return e.l+=l,s}function df(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);return{s:{c:a,r:t},e:{c:s,r}}}function _2(e,t){return t||(t=_e(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function w2(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(1),s=e.read_shift(1);return{s:{c:a,r:t},e:{c:s,r}}}var Q3=w2;function b2(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return e.l+=12,[r,t,a]}function Z3(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function eC(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function da(e){e.l+=2,e.l+=e.read_shift(2)}var tC={0:da,4:da,5:da,6:da,7:eC,8:da,9:da,10:da,11:da,12:da,13:Z3,14:da,15:da,16:da,17:da,18:da,19:da,20:da,21:b2};function rC(e,t){for(var r=e.l+t,a=[];e.l<r;){var s=e.read_shift(2);e.l-=2;try{a.push(tC[s](e,r-e.l))}catch{return e.l=r,a}}return e.l!=r&&(e.l=r),a}function M0(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function qm(e,t,r){var a=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":a=1280,s=8;break;case"biff4":a=4,s=6;break;case"biff3":a=3,s=6;break;case"biff2":a=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var l=_e(s);return l.write_shift(2,a),l.write_shift(2,t),s>4&&l.write_shift(2,29282),s>6&&l.write_shift(2,1997),s>8&&(l.write_shift(2,49161),l.write_shift(2,1),l.write_shift(2,1798),l.write_shift(2,0)),l}function aC(e,t){return t===0||e.read_shift(2),1200}function nC(e,t,r){if(r.enc)return e.l+=t,"";var a=e.l,s=ul(e,0,r);return e.read_shift(t+a-e.l),s}function sC(e,t){var r=!t||t.biff==8,a=_e(r?112:54);for(a.write_shift(t.biff==8?2:1,7),r&&a.write_shift(1,0),a.write_shift(4,859007059),a.write_shift(4,5458548|(r?0:536870912));a.l<a.length;)a.write_shift(1,r?0:32);return a}function iC(e,t,r){var a=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:a&16,fBelow:a&64,fRight:a&128}}function lC(e,t,r){var a=e.read_shift(4),s=e.read_shift(1)&3,l=e.read_shift(1);switch(l){case 0:l="Worksheet";break;case 1:l="Macrosheet";break;case 2:l="Chartsheet";break;case 6:l="VBAModule";break}var c=su(e,0,r);return c.length===0&&(c="Sheet1"),{pos:a,hs:s,dt:l,name:c}}function oC(e,t){var r=!t||t.biff>=8?2:1,a=_e(8+r*e.name.length);a.write_shift(4,e.pos),a.write_shift(1,e.hs||0),a.write_shift(1,e.dt),a.write_shift(1,e.name.length),t.biff>=8&&a.write_shift(1,1),a.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var s=a.slice(0,a.l);return s.l=a.l,s}function cC(e,t){for(var r=e.l+t,a=e.read_shift(4),s=e.read_shift(4),l=[],c=0;c!=s&&e.l<r;++c)l.push(P3(e));return l.Count=a,l.Unique=s,l}function uC(e,t){var r=_e(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var a=[],s=0;s<e.length;++s)a[s]=z3(e[s]);var l=Yr([r].concat(a));return l.parts=[r.length].concat(a.map(function(c){return c.length})),l}function fC(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function hC(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var a=e.read_shift(1);return e.l+=3,a&7&&(t.level=a&7),a&32&&(t.hidden=!0),a&64&&(t.hpt=r/20),t}function dC(e){var t=W3(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function mC(e){return e.read_shift(2),e.read_shift(4)}function my(e,t,r){var a=0;r&&r.biff==2||(a=e.read_shift(2));var s=e.read_shift(2);r&&r.biff==2&&(a=1-(s>>15),s&=32767);var l={Unsynced:a&1,DyZero:(a&2)>>1,ExAsc:(a&4)>>2,ExDsc:(a&8)>>3};return[l,s]}function gC(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),u=e.read_shift(2),h=e.read_shift(2),d=e.read_shift(2);return{Pos:[t,r],Dim:[a,s],Flags:l,CurTab:c,FirstTab:u,Selected:h,TabRatio:d}}function pC(){var e=_e(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function xC(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var a=e.read_shift(2);return{RTL:a&64}}function vC(e){var t=_e(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function yC(){}function _C(e,t,r){var a={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return a.name=su(e,0,r),a}function wC(e,t){var r=e.name||"Arial",a=t&&t.biff==5,s=a?15+r.length:16+2*r.length,l=_e(s);return l.write_shift(2,e.sz*20),l.write_shift(4,0),l.write_shift(2,400),l.write_shift(4,0),l.write_shift(2,0),l.write_shift(1,r.length),a||l.write_shift(1,1),l.write_shift((a?1:2)*r.length,r,a?"sbcs":"utf16le"),l}function bC(e){var t=Jn(e);return t.isst=e.read_shift(4),t}function SC(e,t,r,a){var s=_e(10);return el(e,t,a,s),s.write_shift(4,r),s}function EC(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=e.l+t,s=Jn(e);r.biff==2&&e.l++;var l=iu(e,a-e.l,r);return s.val=l,s}function TC(e,t,r,a,s){var l=!s||s.biff==8,c=_e(8+ +l+(1+l)*r.length);return el(e,t,a,c),c.write_shift(2,r.length),l&&c.write_shift(1,1),c.write_shift((1+l)*r.length,r,l?"utf16le":"sbcs"),c}function kC(e,t,r){var a=e.read_shift(2),s=ul(e,0,r);return[a,s]}function AC(e,t,r,a){var s=r&&r.biff==5;a||(a=_e(s?3+t.length:5+2*t.length)),a.write_shift(2,e),a.write_shift(s?1:2,t.length),s||a.write_shift(1,1),a.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le");var l=a.length>a.l?a.slice(0,a.l):a;return l.l==null&&(l.l=l.length),l}var CC=ul;function gy(e,t,r){var a=e.l+t,s=r.biff==8||!r.biff?4:2,l=e.read_shift(s),c=e.read_shift(s),u=e.read_shift(2),h=e.read_shift(2);return e.l=a,{s:{r:l,c:u},e:{r:c,c:h}}}function NC(e,t){var r=t.biff==8||!t.biff?4:2,a=_e(2*r+6);return a.write_shift(r,e.s.r),a.write_shift(r,e.e.r+1),a.write_shift(2,e.s.c),a.write_shift(2,e.e.c+1),a.write_shift(2,0),a}function OC(e){var t=e.read_shift(2),r=e.read_shift(2),a=y2(e);return{r:t,c:r,ixfe:a[0],rknum:a[1]}}function RC(e,t){for(var r=e.l+t-2,a=e.read_shift(2),s=e.read_shift(2),l=[];e.l<r;)l.push(y2(e));if(e.l!==r)throw new Error("MulRK read error");var c=e.read_shift(2);if(l.length!=c-s+1)throw new Error("MulRK length mismatch");return{r:a,c:s,C:c,rkrec:l}}function DC(e,t){for(var r=e.l+t-2,a=e.read_shift(2),s=e.read_shift(2),l=[];e.l<r;)l.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var c=e.read_shift(2);if(l.length!=c-s+1)throw new Error("MulBlank length mismatch");return{r:a,c:s,C:c,ixfe:l}}function FC(e,t,r,a){var s={},l=e.read_shift(4),c=e.read_shift(4),u=e.read_shift(4),h=e.read_shift(2);return s.patternType=d3[u>>26],a.cellStyles&&(s.alc=l&7,s.fWrap=l>>3&1,s.alcV=l>>4&7,s.fJustLast=l>>7&1,s.trot=l>>8&255,s.cIndent=l>>16&15,s.fShrinkToFit=l>>20&1,s.iReadOrder=l>>22&2,s.fAtrNum=l>>26&1,s.fAtrFnt=l>>27&1,s.fAtrAlc=l>>28&1,s.fAtrBdr=l>>29&1,s.fAtrPat=l>>30&1,s.fAtrProt=l>>31&1,s.dgLeft=c&15,s.dgRight=c>>4&15,s.dgTop=c>>8&15,s.dgBottom=c>>12&15,s.icvLeft=c>>16&127,s.icvRight=c>>23&127,s.grbitDiag=c>>30&3,s.icvTop=u&127,s.icvBottom=u>>7&127,s.icvDiag=u>>14&127,s.dgDiag=u>>21&15,s.icvFore=h&127,s.icvBack=h>>7&127,s.fsxButton=h>>14&1),s}function MC(e,t,r){var a={};return a.ifnt=e.read_shift(2),a.numFmtId=e.read_shift(2),a.flags=e.read_shift(2),a.fStyle=a.flags>>2&1,t-=6,a.data=FC(e,t,a.fStyle,r),a}function py(e,t,r,a){var s=r&&r.biff==5;a||(a=_e(s?16:20)),a.write_shift(2,0),e.style?(a.write_shift(2,e.numFmtId||0),a.write_shift(2,65524)):(a.write_shift(2,e.numFmtId||0),a.write_shift(2,t<<4));var l=0;return e.numFmtId>0&&s&&(l|=1024),a.write_shift(4,l),a.write_shift(4,0),s||a.write_shift(4,0),a.write_shift(2,0),a}function jC(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function IC(e){var t=_e(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function xy(e,t,r){var a=Jn(e);(r.biff==2||t==9)&&++e.l;var s=U3(e);return a.val=s,a.t=s===!0||s===!1?"b":"e",a}function LC(e,t,r,a,s,l){var c=_e(8);return el(e,t,a,c),g2(r,l,c),c}function BC(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=Jn(e),s=xa(e);return a.val=s,a}function UC(e,t,r,a){var s=_e(14);return el(e,t,a,s),Qi(r,s),s}var vy=K3;function PC(e,t,r){var a=e.l+t,s=e.read_shift(2),l=e.read_shift(2);if(r.sbcch=l,l==1025||l==14849)return[l,s];if(l<1||l>255)throw new Error("Unexpected SupBook type: "+l);for(var c=Zi(e,l),u=[];a>e.l;)u.push(iu(e));return[l,s,c,u]}function yy(e,t,r){var a=e.read_shift(2),s,l={fBuiltIn:a&1,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return r.sbcch===14849&&(s=J3(e,t-2,r)),l.body=s||e.read_shift(t-2),typeof s=="string"&&(l.Name=s),l}var zC=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function _y(e,t,r){var a=e.l+t,s=e.read_shift(2),l=e.read_shift(1),c=e.read_shift(1),u=e.read_shift(r&&r.biff==2?1:2),h=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),h=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var d=Zi(e,c,r);s&32&&(d=zC[d.charCodeAt(0)]);var g=a-e.l;r&&r.biff==2&&--g;var x=a==e.l||u===0||!(g>0)?[]:r5(e,g,r,u);return{chKey:l,Name:d,itab:h,rgce:x}}function S2(e,t,r){if(r.biff<8)return HC(e,t,r);for(var a=[],s=e.l+t,l=e.read_shift(r.biff>8?4:2);l--!==0;)a.push(Y3(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return a}function HC(e,t,r){e[e.l+1]==3&&e[e.l]++;var a=su(e,t,r);return a.charCodeAt(0)==3?a.slice(1):a}function $C(e,t,r){if(r.biff<8){e.l+=t;return}var a=e.read_shift(2),s=e.read_shift(2),l=Zi(e,a,r),c=Zi(e,s,r);return[l,c]}function VC(e,t,r){var a=w2(e);e.l++;var s=e.read_shift(1);return t-=8,[a5(e,t,r),s,a]}function wy(e,t,r){var a=Q3(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[a,e5(e,t,r)]}function GC(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,a=e.read_shift(4);return[t,r,a]}function qC(e,t,r){if(!(r.biff<8)){var a=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),u=ul(e,0,r);return r.biff<8&&e.read_shift(1),[{r:a,c:s},u,c,l]}}function XC(e,t,r){return qC(e,t,r)}function WC(e,t){for(var r=[],a=e.read_shift(2);a--;)r.push(df(e));return r}function KC(e){var t=_e(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)_2(e[r],t);return t}function YC(e,t,r){if(r&&r.biff<8)return QC(e,t,r);var a=b2(e),s=rC(e,t-22,a[1]);return{cmo:a,ft:s}}var JC={8:function(e,t){var r=e.l+t;e.l+=10;var a=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=r,{fmt:a}}};function QC(e,t,r){e.l+=4;var a=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var c=[];return c.push((JC[a]||ya)(e,t,r)),{cmo:[s,a,l],ft:c}}function ZC(e,t,r){var a=e.l,s="";try{e.l+=4;var l=(r.lastobj||{cmo:[0,0]}).cmo[1],c;[0,5,7,11,12,14].indexOf(l)==-1?e.l+=6:c=H3(e,6,r);var u=e.read_shift(2);e.read_shift(2),Ir(e,2);var h=e.read_shift(2);e.l+=h;for(var d=1;d<e.lens.length-1;++d){if(e.l-a!=e.lens[d])throw new Error("TxO: bad continue record");var g=e[e.l],x=Zi(e,e.lens[d+1]-e.lens[d]-1);if(s+=x,s.length>=(g?u:2*u))break}if(s.length!==u&&s.length!==u*2)throw new Error("cchText: "+u+" != "+s.length);return e.l=a+t,{t:s}}catch{return e.l=a+t,{t:s}}}function eN(e,t){var r=df(e);e.l+=16;var a=q3(e,t-24);return[r,a]}function tN(e){var t=_e(24),r=pr(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var a="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)t.write_shift(1,parseInt(a[s],16));return Yr([t,X3(e[1])])}function rN(e,t){e.read_shift(2);var r=df(e),a=e.read_shift((t-10)/2,"dbcs-cont");return a=a.replace(Ta,""),[r,a]}function aN(e){var t=e[1].Tooltip,r=_e(10+2*(t.length+1));r.write_shift(2,2048);var a=pr(e[0]);r.write_shift(2,a.r),r.write_shift(2,a.r),r.write_shift(2,a.c),r.write_shift(2,a.c);for(var s=0;s<t.length;++s)r.write_shift(2,t.charCodeAt(s));return r.write_shift(2,0),r}function nN(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=sy[r]||r,r=e.read_shift(2),t[1]=sy[r]||r,t}function sN(e){return e||(e=_e(4)),e.write_shift(2,1),e.write_shift(2,1),e}function iN(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(v2(e));return r}function lN(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(v2(e));return r}function oN(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function E2(e,t,r){if(!r.cellStyles)return ya(e,t);var a=r&&r.biff>=12?4:2,s=e.read_shift(a),l=e.read_shift(a),c=e.read_shift(a),u=e.read_shift(a),h=e.read_shift(2);a==2&&(e.l+=2);var d={s,e:l,w:c,ixfe:u,flags:h};return(r.biff>=5||!r.biff)&&(d.level=h>>8&7),d}function cN(e,t){var r=_e(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var a=0;return e.hidden&&(a|=1),r.write_shift(1,a),a=e.level||0,r.write_shift(1,a),r.write_shift(2,0),r}function uN(e,t){var r={};return t<32||(e.l+=16,r.header=xa(e),r.footer=xa(e),e.l+=2),r}function fN(e,t,r){var a={area:!1};if(r.biff!=5)return e.l+=t,a;var s=e.read_shift(1);return e.l+=3,s&16&&(a.area=!0),a}function hN(e){for(var t=_e(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var dN=Jn,mN=m2,gN=iu;function pN(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),s={fmt:t,env:r,len:a,data:e.slice(e.l,e.l+a)};return e.l+=a,s}function xN(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var a=Jn(e);++e.l;var s=ul(e,t-7,r);return a.t="str",a.val=s,a}function vN(e){var t=Jn(e);++e.l;var r=xa(e);return t.t="n",t.val=r,t}function yN(e,t,r){var a=_e(15);return uu(a,e,t),a.write_shift(8,r,"f"),a}function _N(e){var t=Jn(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function wN(e,t,r){var a=_e(9);return uu(a,e,t),a.write_shift(2,r),a}function bN(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function SN(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function EN(e,t,r){var a=e.l+t,s=Jn(e),l=e.read_shift(2),c=Zi(e,l,r);return e.l=a,s.t="str",s.val=c,s}var TN=[2,3,48,49,131,139,140,245],fm=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=uf({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(u,h){var d=[],g=oi(1);switch(h.type){case"base64":g=tn(an(u));break;case"binary":g=tn(u);break;case"buffer":case"array":g=u;break}la(g,0);var x=g.read_shift(1),y=!!(x&136),_=!1,b=!1;switch(x){case 2:break;case 3:break;case 48:_=!0,y=!0;break;case 49:_=!0,y=!0;break;case 131:break;case 139:break;case 140:b=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+x.toString(16))}var w=0,S=521;x==2&&(w=g.read_shift(2)),g.l+=3,x!=2&&(w=g.read_shift(4)),w>1048576&&(w=1e6),x!=2&&(S=g.read_shift(2));var k=g.read_shift(2),C=h.codepage||1252;x!=2&&(g.l+=16,g.read_shift(1),g[g.l]!==0&&(C=e[g[g.l]]),g.l+=1,g.l+=2),b&&(g.l+=36);for(var T=[],j={},X=Math.min(g.length,x==2?521:S-10-(_?264:0)),D=b?32:11;g.l<X&&g[g.l]!=13;)switch(j={},j.name=Pc.utils.decode(C,g.slice(g.l,g.l+D)).replace(/[\u0000\r\n].*$/g,""),g.l+=D,j.type=String.fromCharCode(g.read_shift(1)),x!=2&&!b&&(j.offset=g.read_shift(4)),j.len=g.read_shift(1),x==2&&(j.offset=g.read_shift(2)),j.dec=g.read_shift(1),j.name.length&&T.push(j),x!=2&&(g.l+=b?13:14),j.type){case"B":(!_||j.len!=8)&&h.WTF&&console.log("Skipping "+j.name+":"+j.type);break;case"G":case"P":h.WTF&&console.log("Skipping "+j.name+":"+j.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+j.type)}if(g[g.l]!==13&&(g.l=S-1),g.read_shift(1)!==13)throw new Error("DBF Terminator not found "+g.l+" "+g[g.l]);g.l=S;var N=0,W=0;for(d[0]=[],W=0;W!=T.length;++W)d[0][W]=T[W].name;for(;w-- >0;){if(g[g.l]===42){g.l+=k;continue}for(++g.l,d[++N]=[],W=0,W=0;W!=T.length;++W){var P=g.slice(g.l,g.l+T[W].len);g.l+=T[W].len,la(P,0);var re=Pc.utils.decode(C,P);switch(T[W].type){case"C":re.trim().length&&(d[N][W]=re.replace(/\s+$/,""));break;case"D":re.length===8?d[N][W]=new Date(+re.slice(0,4),+re.slice(4,6)-1,+re.slice(6,8)):d[N][W]=re;break;case"F":d[N][W]=parseFloat(re.trim());break;case"+":case"I":d[N][W]=b?P.read_shift(-4,"i")^2147483648:P.read_shift(4,"i");break;case"L":switch(re.trim().toUpperCase()){case"Y":case"T":d[N][W]=!0;break;case"N":case"F":d[N][W]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+re+"|")}break;case"M":if(!y)throw new Error("DBF Unexpected MEMO for type "+x.toString(16));d[N][W]="##MEMO##"+(b?parseInt(re.trim(),10):P.read_shift(4));break;case"N":re=re.replace(/\u0000/g,"").trim(),re&&re!="."&&(d[N][W]=+re||0);break;case"@":d[N][W]=new Date(P.read_shift(-8,"f")-621356832e5);break;case"T":d[N][W]=new Date((P.read_shift(4)-2440588)*864e5+P.read_shift(4));break;case"Y":d[N][W]=P.read_shift(4,"i")/1e4+P.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[N][W]=-P.read_shift(-8,"f");break;case"B":if(_&&T[W].len==8){d[N][W]=P.read_shift(8,"f");break}case"G":case"P":P.l+=T[W].len;break;case"0":if(T[W].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+T[W].type)}}}if(x!=2&&g.l<g.length&&g[g.l++]!=26)throw new Error("DBF EOF Marker missing "+(g.l-1)+" of "+g.length+" "+g[g.l-1].toString(16));return h&&h.sheetRows&&(d=d.slice(0,h.sheetRows)),h.DBF=T,d}function a(u,h){var d=h||{};d.dateNF||(d.dateNF="yyyymmdd");var g=Eo(r(u,d),d);return g["!cols"]=d.DBF.map(function(x){return{wch:x.len,DBF:x}}),delete d.DBF,g}function s(u,h){try{return di(a(u,h),h)}catch(d){if(h&&h.WTF)throw d}return{SheetNames:[],Sheets:{}}}var l={B:8,C:250,L:1,D:8,"?":0,"":0};function c(u,h){var d=h||{};if(+d.codepage>=0&&Fn(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var g=Ba(),x=af(u,{header:1,raw:!0,cellDates:!0}),y=x[0],_=x.slice(1),b=u["!cols"]||[],w=0,S=0,k=0,C=1;for(w=0;w<y.length;++w){if(((b[w]||{}).DBF||{}).name){y[w]=b[w].DBF.name,++k;continue}if(y[w]!=null){if(++k,typeof y[w]=="number"&&(y[w]=y[w].toString(10)),typeof y[w]!="string")throw new Error("DBF Invalid column name "+y[w]+" |"+typeof y[w]+"|");if(y.indexOf(y[w])!==w){for(S=0;S<1024;++S)if(y.indexOf(y[w]+"_"+S)==-1){y[w]+="_"+S;break}}}}var T=Mt(u["!ref"]),j=[],X=[],D=[];for(w=0;w<=T.e.c-T.s.c;++w){var N="",W="",P=0,re=[];for(S=0;S<_.length;++S)_[S][w]!=null&&re.push(_[S][w]);if(re.length==0||y[w]==null){j[w]="?";continue}for(S=0;S<re.length;++S){switch(typeof re[S]){case"number":W="B";break;case"string":W="C";break;case"boolean":W="L";break;case"object":W=re[S]instanceof Date?"D":"C";break;default:W="C"}P=Math.max(P,String(re[S]).length),N=N&&N!=W?"C":W}P>250&&(P=250),W=((b[w]||{}).DBF||{}).type,W=="C"&&b[w].DBF.len>P&&(P=b[w].DBF.len),N=="B"&&W=="N"&&(N="N",D[w]=b[w].DBF.dec,P=b[w].DBF.len),X[w]=N=="C"||W=="N"?P:l[N]||0,C+=X[w],j[w]=N}var ae=g.next(32);for(ae.write_shift(4,318902576),ae.write_shift(4,_.length),ae.write_shift(2,296+32*k),ae.write_shift(2,C),w=0;w<4;++w)ae.write_shift(4,0);for(ae.write_shift(4,0|(+t[d_]||3)<<8),w=0,S=0;w<y.length;++w)if(y[w]!=null){var Q=g.next(32),xe=(y[w].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);Q.write_shift(1,xe,"sbcs"),Q.write_shift(1,j[w]=="?"?"C":j[w],"sbcs"),Q.write_shift(4,S),Q.write_shift(1,X[w]||l[j[w]]||0),Q.write_shift(1,D[w]||0),Q.write_shift(1,2),Q.write_shift(4,0),Q.write_shift(1,0),Q.write_shift(4,0),Q.write_shift(4,0),S+=X[w]||l[j[w]]||0}var Oe=g.next(264);for(Oe.write_shift(4,13),w=0;w<65;++w)Oe.write_shift(4,0);for(w=0;w<_.length;++w){var Ae=g.next(C);for(Ae.write_shift(1,0),S=0;S<y.length;++S)if(y[S]!=null)switch(j[S]){case"L":Ae.write_shift(1,_[w][S]==null?63:_[w][S]?84:70);break;case"B":Ae.write_shift(8,_[w][S]||0,"f");break;case"N":var K="0";for(typeof _[w][S]=="number"&&(K=_[w][S].toFixed(D[S]||0)),k=0;k<X[S]-K.length;++k)Ae.write_shift(1,32);Ae.write_shift(1,K,"sbcs");break;case"D":_[w][S]?(Ae.write_shift(4,("0000"+_[w][S].getFullYear()).slice(-4),"sbcs"),Ae.write_shift(2,("00"+(_[w][S].getMonth()+1)).slice(-2),"sbcs"),Ae.write_shift(2,("00"+_[w][S].getDate()).slice(-2),"sbcs")):Ae.write_shift(8,"00000000","sbcs");break;case"C":var le=String(_[w][S]!=null?_[w][S]:"").slice(0,X[S]);for(Ae.write_shift(1,le,"sbcs"),k=0;k<X[S]-le.length;++k)Ae.write_shift(1,32);break}}return g.next(1).write_shift(1,26),g.end()}return{to_workbook:s,to_sheet:a,from_sheet:c}})(),T2=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+br(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(y,_){var b=e[_];return typeof b=="number"?Dv(b):b},a=function(y,_,b){var w=_.charCodeAt(0)-32<<4|b.charCodeAt(0)-48;return w==59?y:Dv(w)};e["|"]=254;function s(y,_){switch(_.type){case"base64":return l(an(y),_);case"binary":return l(y,_);case"buffer":return l(Tt&&Buffer.isBuffer(y)?y.toString("binary"):hi(y),_);case"array":return l(Ji(y),_)}throw new Error("Unrecognized type "+_.type)}function l(y,_){var b=y.split(/[\n\r]+/),w=-1,S=-1,k=0,C=0,T=[],j=[],X=null,D={},N=[],W=[],P=[],re=0,ae;for(+_.codepage>=0&&Fn(+_.codepage);k!==b.length;++k){re=0;var Q=b[k].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(t,r),xe=Q.replace(/;;/g,"\0").split(";").map(function(L){return L.replace(/\u0000/g,";")}),Oe=xe[0],Ae;if(Q.length>0)switch(Oe){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":xe[1].charAt(0)=="P"&&j.push(Q.slice(3).replace(/;;/g,";"));break;case"C":var K=!1,le=!1,je=!1,U=!1,ve=-1,G=-1;for(C=1;C<xe.length;++C)switch(xe[C].charAt(0)){case"A":break;case"X":S=parseInt(xe[C].slice(1))-1,le=!0;break;case"Y":for(w=parseInt(xe[C].slice(1))-1,le||(S=0),ae=T.length;ae<=w;++ae)T[ae]=[];break;case"K":Ae=xe[C].slice(1),Ae.charAt(0)==='"'?Ae=Ae.slice(1,Ae.length-1):Ae==="TRUE"?Ae=!0:Ae==="FALSE"?Ae=!1:isNaN(jn(Ae))?isNaN(yo(Ae).getDate())||(Ae=ur(Ae)):(Ae=jn(Ae),X!==null&&bo(X)&&(Ae=hf(Ae))),K=!0;break;case"E":U=!0;var A=go(xe[C].slice(1),{r:w,c:S});T[w][S]=[T[w][S],A];break;case"S":je=!0,T[w][S]=[T[w][S],"S5S"];break;case"G":break;case"R":ve=parseInt(xe[C].slice(1))-1;break;case"C":G=parseInt(xe[C].slice(1))-1;break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+Q)}if(K&&(T[w][S]&&T[w][S].length==2?T[w][S][0]=Ae:T[w][S]=Ae,X=null),je){if(U)throw new Error("SYLK shared formula cannot have own formula");var z=ve>-1&&T[ve][G];if(!z||!z[1])throw new Error("SYLK shared formula cannot find base");T[w][S][1]=$2(z[1],{r:w-ve,c:S-G})}break;case"F":var I=0;for(C=1;C<xe.length;++C)switch(xe[C].charAt(0)){case"X":S=parseInt(xe[C].slice(1))-1,++I;break;case"Y":for(w=parseInt(xe[C].slice(1))-1,ae=T.length;ae<=w;++ae)T[ae]=[];break;case"M":re=parseInt(xe[C].slice(1))/20;break;case"F":break;case"G":break;case"P":X=j[parseInt(xe[C].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(P=xe[C].slice(1).split(" "),ae=parseInt(P[0],10);ae<=parseInt(P[1],10);++ae)re=parseInt(P[2],10),W[ae-1]=re===0?{hidden:!0}:{wch:re},ci(W[ae-1]);break;case"C":S=parseInt(xe[C].slice(1))-1,W[S]||(W[S]={});break;case"R":w=parseInt(xe[C].slice(1))-1,N[w]||(N[w]={}),re>0?(N[w].hpt=re,N[w].hpx=wo(re)):re===0&&(N[w].hidden=!0);break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+Q)}I<1&&(X=null);break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+Q)}}return N.length>0&&(D["!rows"]=N),W.length>0&&(D["!cols"]=W),_&&_.sheetRows&&(T=T.slice(0,_.sheetRows)),[T,D]}function c(y,_){var b=s(y,_),w=b[0],S=b[1],k=Eo(w,_);return br(S).forEach(function(C){k[C]=S[C]}),k}function u(y,_){return di(c(y,_),_)}function h(y,_,b,w){var S="C;Y"+(b+1)+";X"+(w+1)+";K";switch(y.t){case"n":S+=y.v||0,y.f&&!y.F&&(S+=";E"+Qm(y.f,{r:b,c:w}));break;case"b":S+=y.v?"TRUE":"FALSE";break;case"e":S+=y.w||y.v;break;case"d":S+='"'+(y.w||y.v)+'"';break;case"s":S+='"'+y.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return S}function d(y,_){_.forEach(function(b,w){var S="F;W"+(w+1)+" "+(w+1)+" ";b.hidden?S+="0":(typeof b.width=="number"&&!b.wpx&&(b.wpx=Wc(b.width)),typeof b.wpx=="number"&&!b.wch&&(b.wch=Kc(b.wpx)),typeof b.wch=="number"&&(S+=Math.round(b.wch))),S.charAt(S.length-1)!=" "&&y.push(S)})}function g(y,_){_.forEach(function(b,w){var S="F;";b.hidden?S+="M0;":b.hpt?S+="M"+20*b.hpt+";":b.hpx&&(S+="M"+20*Yc(b.hpx)+";"),S.length>2&&y.push(S+"R"+(w+1))})}function x(y,_){var b=["ID;PWXL;N;E"],w=[],S=Mt(y["!ref"]),k,C=Array.isArray(y),T=`\r
`;b.push("P;PGeneral"),b.push("F;P0;DG0G8;M255"),y["!cols"]&&d(b,y["!cols"]),y["!rows"]&&g(b,y["!rows"]),b.push("B;Y"+(S.e.r-S.s.r+1)+";X"+(S.e.c-S.s.c+1)+";D"+[S.s.c,S.s.r,S.e.c,S.e.r].join(" "));for(var j=S.s.r;j<=S.e.r;++j)for(var X=S.s.c;X<=S.e.c;++X){var D=ht({r:j,c:X});k=C?(y[j]||[])[X]:y[D],!(!k||k.v==null&&(!k.f||k.F))&&w.push(h(k,y,j,X))}return b.join(T)+T+w.join(T)+T+"E"+T}return{to_workbook:u,to_sheet:c,from_sheet:x}})(),k2=(function(){function e(l,c){switch(c.type){case"base64":return t(an(l),c);case"binary":return t(l,c);case"buffer":return t(Tt&&Buffer.isBuffer(l)?l.toString("binary"):hi(l),c);case"array":return t(Ji(l),c)}throw new Error("Unrecognized type "+c.type)}function t(l,c){for(var u=l.split(`
`),h=-1,d=-1,g=0,x=[];g!==u.length;++g){if(u[g].trim()==="BOT"){x[++h]=[],d=0;continue}if(!(h<0)){var y=u[g].trim().split(","),_=y[0],b=y[1];++g;for(var w=u[g]||"";(w.match(/["]/g)||[]).length&1&&g<u.length-1;)w+=`
`+u[++g];switch(w=w.trim(),+_){case-1:if(w==="BOT"){x[++h]=[],d=0;continue}else if(w!=="EOD")throw new Error("Unrecognized DIF special command "+w);break;case 0:w==="TRUE"?x[h][d]=!0:w==="FALSE"?x[h][d]=!1:isNaN(jn(b))?isNaN(yo(b).getDate())?x[h][d]=b:x[h][d]=ur(b):x[h][d]=jn(b),++d;break;case 1:w=w.slice(1,w.length-1),w=w.replace(/""/g,'"'),w&&w.match(/^=".*"$/)&&(w=w.slice(2,-1)),x[h][d++]=w!==""?w:null;break}if(w==="EOD")break}}return c&&c.sheetRows&&(x=x.slice(0,c.sheetRows)),x}function r(l,c){return Eo(e(l,c),c)}function a(l,c){return di(r(l,c),c)}var s=(function(){var l=function(h,d,g,x,y){h.push(d),h.push(g+","+x),h.push('"'+y.replace(/"/g,'""')+'"')},c=function(h,d,g,x){h.push(d+","+g),h.push(d==1?'"'+x.replace(/"/g,'""')+'"':x)};return function(h){var d=[],g=Mt(h["!ref"]),x,y=Array.isArray(h);l(d,"TABLE",0,1,"sheetjs"),l(d,"VECTORS",0,g.e.r-g.s.r+1,""),l(d,"TUPLES",0,g.e.c-g.s.c+1,""),l(d,"DATA",0,0,"");for(var _=g.s.r;_<=g.e.r;++_){c(d,-1,0,"BOT");for(var b=g.s.c;b<=g.e.c;++b){var w=ht({r:_,c:b});if(x=y?(h[_]||[])[b]:h[w],!x){c(d,1,0,"");continue}switch(x.t){case"n":var S=x.w;!S&&x.v!=null&&(S=x.v),S==null?x.f&&!x.F?c(d,1,0,"="+x.f):c(d,1,0,""):c(d,0,S,"V");break;case"b":c(d,0,x.v?1:0,x.v?"TRUE":"FALSE");break;case"s":c(d,1,0,isNaN(x.v)?x.v:'="'+x.v+'"');break;case"d":x.w||(x.w=wn(x.z||ft[14],Hr(ur(x.v)))),c(d,0,x.w,"V");break;default:c(d,1,0,"")}}}c(d,-1,0,"EOD");var k=`\r
`,C=d.join(k);return C}})();return{to_workbook:a,to_sheet:r,from_sheet:s}})(),A2=(function(){function e(x){return x.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(x){return x.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(x,y){for(var _=x.split(`
`),b=-1,w=-1,S=0,k=[];S!==_.length;++S){var C=_[S].trim().split(":");if(C[0]==="cell"){var T=pr(C[1]);if(k.length<=T.r)for(b=k.length;b<=T.r;++b)k[b]||(k[b]=[]);switch(b=T.r,w=T.c,C[2]){case"t":k[b][w]=e(C[3]);break;case"v":k[b][w]=+C[3];break;case"vtf":var j=C[C.length-1];case"vtc":C[3]==="nl"?k[b][w]=!!+C[4]:k[b][w]=+C[4],C[2]=="vtf"&&(k[b][w]=[k[b][w],j])}}}return y&&y.sheetRows&&(k=k.slice(0,y.sheetRows)),k}function a(x,y){return Eo(r(x,y),y)}function s(x,y){return di(a(x,y),y)}var l=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),c=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),h="--SocialCalcSpreadsheetControlSave--";function d(x){if(!x||!x["!ref"])return"";for(var y=[],_=[],b,w="",S=Ua(x["!ref"]),k=Array.isArray(x),C=S.s.r;C<=S.e.r;++C)for(var T=S.s.c;T<=S.e.c;++T)if(w=ht({r:C,c:T}),b=k?(x[C]||[])[T]:x[w],!(!b||b.v==null||b.t==="z")){switch(_=["cell",w,"t"],b.t){case"s":case"str":_.push(t(b.v));break;case"n":b.f?(_[2]="vtf",_[3]="n",_[4]=b.v,_[5]=t(b.f)):(_[2]="v",_[3]=b.v);break;case"b":_[2]="vt"+(b.f?"f":"c"),_[3]="nl",_[4]=b.v?"1":"0",_[5]=t(b.f||(b.v?"TRUE":"FALSE"));break;case"d":var j=Hr(ur(b.v));_[2]="vtc",_[3]="nd",_[4]=""+j,_[5]=b.w||wn(b.z||ft[14],j);break;case"e":continue}y.push(_.join(":"))}return y.push("sheet:c:"+(S.e.c-S.s.c+1)+":r:"+(S.e.r-S.s.r+1)+":tvf:1"),y.push("valueformat:1:text-wiki"),y.join(`
`)}function g(x){return[l,c,u,c,d(x),h].join(`
`)}return{to_workbook:s,to_sheet:a,from_sheet:g}})(),_o=(function(){function e(g,x,y,_,b){b.raw?x[y][_]=g:g===""||(g==="TRUE"?x[y][_]=!0:g==="FALSE"?x[y][_]=!1:isNaN(jn(g))?isNaN(yo(g).getDate())?x[y][_]=g:x[y][_]=ur(g):x[y][_]=jn(g))}function t(g,x){var y=x||{},_=[];if(!g||g.length===0)return _;for(var b=g.split(/[\r\n]/),w=b.length-1;w>=0&&b[w].length===0;)--w;for(var S=10,k=0,C=0;C<=w;++C)k=b[C].indexOf(" "),k==-1?k=b[C].length:k++,S=Math.max(S,k);for(C=0;C<=w;++C){_[C]=[];var T=0;for(e(b[C].slice(0,S).trim(),_,C,T,y),T=1;T<=(b[C].length-S)/10+1;++T)e(b[C].slice(S+(T-1)*10,S+T*10).trim(),_,C,T,y)}return y.sheetRows&&(_=_.slice(0,y.sheetRows)),_}var r={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function s(g){for(var x={},y=!1,_=0,b=0;_<g.length;++_)(b=g.charCodeAt(_))==34?y=!y:!y&&b in r&&(x[b]=(x[b]||0)+1);b=[];for(_ in x)Object.prototype.hasOwnProperty.call(x,_)&&b.push([x[_],_]);if(!b.length){x=a;for(_ in x)Object.prototype.hasOwnProperty.call(x,_)&&b.push([x[_],_])}return b.sort(function(w,S){return w[0]-S[0]||a[w[1]]-a[S[1]]}),r[b.pop()[1]]||44}function l(g,x){var y=x||{},_="",b=y.dense?[]:{},w={s:{c:0,r:0},e:{c:0,r:0}};g.slice(0,4)=="sep="?g.charCodeAt(5)==13&&g.charCodeAt(6)==10?(_=g.charAt(4),g=g.slice(7)):g.charCodeAt(5)==13||g.charCodeAt(5)==10?(_=g.charAt(4),g=g.slice(6)):_=s(g.slice(0,1024)):y&&y.FS?_=y.FS:_=s(g.slice(0,1024));var S=0,k=0,C=0,T=0,j=0,X=_.charCodeAt(0),D=!1,N=0,W=g.charCodeAt(0);g=g.replace(/\r\n/mg,`
`);var P=y.dateNF!=null?fA(y.dateNF):null;function re(){var ae=g.slice(T,j),Q={};if(ae.charAt(0)=='"'&&ae.charAt(ae.length-1)=='"'&&(ae=ae.slice(1,-1).replace(/""/g,'"')),ae.length===0)Q.t="z";else if(y.raw)Q.t="s",Q.v=ae;else if(ae.trim().length===0)Q.t="s",Q.v=ae;else if(ae.charCodeAt(0)==61)ae.charCodeAt(1)==34&&ae.charCodeAt(ae.length-1)==34?(Q.t="s",Q.v=ae.slice(2,-1).replace(/""/g,'"')):P8(ae)?(Q.t="n",Q.f=ae.slice(1)):(Q.t="s",Q.v=ae);else if(ae=="TRUE")Q.t="b",Q.v=!0;else if(ae=="FALSE")Q.t="b",Q.v=!1;else if(!isNaN(C=jn(ae)))Q.t="n",y.cellText!==!1&&(Q.w=ae),Q.v=C;else if(!isNaN(yo(ae).getDate())||P&&ae.match(P)){Q.z=y.dateNF||ft[14];var xe=0;P&&ae.match(P)&&(ae=hA(ae,y.dateNF,ae.match(P)||[]),xe=1),y.cellDates?(Q.t="d",Q.v=ur(ae,xe)):(Q.t="n",Q.v=Hr(ur(ae,xe))),y.cellText!==!1&&(Q.w=wn(Q.z,Q.v instanceof Date?Hr(Q.v):Q.v)),y.cellNF||delete Q.z}else Q.t="s",Q.v=ae;if(Q.t=="z"||(y.dense?(b[S]||(b[S]=[]),b[S][k]=Q):b[ht({c:k,r:S})]=Q),T=j+1,W=g.charCodeAt(T),w.e.c<k&&(w.e.c=k),w.e.r<S&&(w.e.r=S),N==X)++k;else if(k=0,++S,y.sheetRows&&y.sheetRows<=S)return!0}e:for(;j<g.length;++j)switch(N=g.charCodeAt(j)){case 34:W===34&&(D=!D);break;case X:case 10:case 13:if(!D&&re())break e;break}return j-T>0&&re(),b["!ref"]=_t(w),b}function c(g,x){return!(x&&x.PRN)||x.FS||g.slice(0,4)=="sep="||g.indexOf("	")>=0||g.indexOf(",")>=0||g.indexOf(";")>=0?l(g,x):Eo(t(g,x),x)}function u(g,x){var y="",_=x.type=="string"?[0,0,0,0]:i1(g,x);switch(x.type){case"base64":y=an(g);break;case"binary":y=g;break;case"buffer":x.codepage==65001?y=g.toString("utf8"):x.codepage&&typeof Pc<"u"||(y=Tt&&Buffer.isBuffer(g)?g.toString("binary"):hi(g));break;case"array":y=Ji(g);break;case"string":y=g;break;default:throw new Error("Unrecognized type "+x.type)}return _[0]==239&&_[1]==187&&_[2]==191?y=rr(y.slice(3)):x.type!="string"&&x.type!="buffer"&&x.codepage==65001?y=rr(y):x.type=="binary"&&typeof Pc<"u",y.slice(0,19)=="socialcalc:version:"?A2.to_sheet(x.type=="string"?y:rr(y),x):c(y,x)}function h(g,x){return di(u(g,x),x)}function d(g){for(var x=[],y=Mt(g["!ref"]),_,b=Array.isArray(g),w=y.s.r;w<=y.e.r;++w){for(var S=[],k=y.s.c;k<=y.e.c;++k){var C=ht({r:w,c:k});if(_=b?(g[w]||[])[k]:g[C],!_||_.v==null){S.push("          ");continue}for(var T=(_.w||(Es(_),_.w)||"").slice(0,10);T.length<10;)T+=" ";S.push(T+(k===0?" ":""))}x.push(S.join(""))}return x.join(`
`)}return{to_workbook:h,to_sheet:u,from_sheet:d}})();function kN(e,t){var r=t||{},a=!!r.WTF;r.WTF=!0;try{var s=T2.to_workbook(e,r);return r.WTF=a,s}catch(l){if(r.WTF=a,!l.message.match(/SYLK bad record ID/)&&a)throw l;return _o.to_workbook(e,t)}}var Xi=(function(){function e(A,z,I){if(A){la(A,A.l||0);for(var L=I.Enum||ve;A.l<A.length;){var te=A.read_shift(2),me=L[te]||L[65535],ge=A.read_shift(2),pe=A.l+ge,Ee=me.f&&me.f(A,ge,I);if(A.l=pe,z(Ee,me,te))return}}}function t(A,z){switch(z.type){case"base64":return r(tn(an(A)),z);case"binary":return r(tn(A),z);case"buffer":case"array":return r(A,z)}throw"Unsupported type "+z.type}function r(A,z){if(!A)return A;var I=z||{},L=I.dense?[]:{},te="Sheet1",me="",ge=0,pe={},Ee=[],et=[],q={s:{r:0,c:0},e:{r:0,c:0}},vt=I.sheetRows||0;if(A[2]==0&&(A[3]==8||A[3]==9)&&A.length>=16&&A[14]==5&&A[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(A[2]==2)I.Enum=ve,e(A,function(Re,jt,sr){switch(sr){case 0:I.vers=Re,Re>=4096&&(I.qpro=!0);break;case 6:q=Re;break;case 204:Re&&(me=Re);break;case 222:me=Re;break;case 15:case 51:I.qpro||(Re[1].v=Re[1].v.slice(1));case 13:case 14:case 16:sr==14&&(Re[2]&112)==112&&(Re[2]&15)>1&&(Re[2]&15)<15&&(Re[1].z=I.dateNF||ft[14],I.cellDates&&(Re[1].t="d",Re[1].v=hf(Re[1].v))),I.qpro&&Re[3]>ge&&(L["!ref"]=_t(q),pe[te]=L,Ee.push(te),L=I.dense?[]:{},q={s:{r:0,c:0},e:{r:0,c:0}},ge=Re[3],te=me||"Sheet"+(ge+1),me="");var $r=I.dense?(L[Re[0].r]||[])[Re[0].c]:L[ht(Re[0])];if($r){$r.t=Re[1].t,$r.v=Re[1].v,Re[1].z!=null&&($r.z=Re[1].z),Re[1].f!=null&&($r.f=Re[1].f);break}I.dense?(L[Re[0].r]||(L[Re[0].r]=[]),L[Re[0].r][Re[0].c]=Re[1]):L[ht(Re[0])]=Re[1];break}},I);else if(A[2]==26||A[2]==14)I.Enum=G,A[2]==14&&(I.qpro=!0,A.l=0),e(A,function(Re,jt,sr){switch(sr){case 204:te=Re;break;case 22:Re[1].v=Re[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Re[3]>ge&&(L["!ref"]=_t(q),pe[te]=L,Ee.push(te),L=I.dense?[]:{},q={s:{r:0,c:0},e:{r:0,c:0}},ge=Re[3],te="Sheet"+(ge+1)),vt>0&&Re[0].r>=vt)break;I.dense?(L[Re[0].r]||(L[Re[0].r]=[]),L[Re[0].r][Re[0].c]=Re[1]):L[ht(Re[0])]=Re[1],q.e.c<Re[0].c&&(q.e.c=Re[0].c),q.e.r<Re[0].r&&(q.e.r=Re[0].r);break;case 27:Re[14e3]&&(et[Re[14e3][0]]=Re[14e3][1]);break;case 1537:et[Re[0]]=Re[1],Re[0]==ge&&(te=Re[1]);break}},I);else throw new Error("Unrecognized LOTUS BOF "+A[2]);if(L["!ref"]=_t(q),pe[me||te]=L,Ee.push(me||te),!et.length)return{SheetNames:Ee,Sheets:pe};for(var nt={},kt=[],gt=0;gt<et.length;++gt)pe[Ee[gt]]?(kt.push(et[gt]||Ee[gt]),nt[et[gt]]=pe[et[gt]]||pe[Ee[gt]]):(kt.push(et[gt]),nt[et[gt]]={"!ref":"A1"});return{SheetNames:kt,Sheets:nt}}function a(A,z){var I=z||{};if(+I.codepage>=0&&Fn(+I.codepage),I.type=="string")throw new Error("Cannot write WK1 to JS string");var L=Ba(),te=Mt(A["!ref"]),me=Array.isArray(A),ge=[];He(L,0,l(1030)),He(L,6,h(te));for(var pe=Math.min(te.e.r,8191),Ee=te.s.r;Ee<=pe;++Ee)for(var et=Ar(Ee),q=te.s.c;q<=te.e.c;++q){Ee===te.s.r&&(ge[q]=gr(q));var vt=ge[q]+et,nt=me?(A[Ee]||[])[q]:A[vt];if(!(!nt||nt.t=="z"))if(nt.t=="n")(nt.v|0)==nt.v&&nt.v>=-32768&&nt.v<=32767?He(L,13,_(Ee,q,nt.v)):He(L,14,w(Ee,q,nt.v));else{var kt=Es(nt);He(L,15,x(Ee,q,kt.slice(0,239)))}}return He(L,1),L.end()}function s(A,z){var I=z||{};if(+I.codepage>=0&&Fn(+I.codepage),I.type=="string")throw new Error("Cannot write WK3 to JS string");var L=Ba();He(L,0,c(A));for(var te=0,me=0;te<A.SheetNames.length;++te)(A.Sheets[A.SheetNames[te]]||{})["!ref"]&&He(L,27,U(A.SheetNames[te],me++));var ge=0;for(te=0;te<A.SheetNames.length;++te){var pe=A.Sheets[A.SheetNames[te]];if(!(!pe||!pe["!ref"])){for(var Ee=Mt(pe["!ref"]),et=Array.isArray(pe),q=[],vt=Math.min(Ee.e.r,8191),nt=Ee.s.r;nt<=vt;++nt)for(var kt=Ar(nt),gt=Ee.s.c;gt<=Ee.e.c;++gt){nt===Ee.s.r&&(q[gt]=gr(gt));var Re=q[gt]+kt,jt=et?(pe[nt]||[])[gt]:pe[Re];if(!(!jt||jt.t=="z"))if(jt.t=="n")He(L,23,re(nt,gt,ge,jt.v));else{var sr=Es(jt);He(L,22,N(nt,gt,ge,sr.slice(0,239)))}}++ge}}return He(L,1),L.end()}function l(A){var z=_e(2);return z.write_shift(2,A),z}function c(A){var z=_e(26);z.write_shift(2,4096),z.write_shift(2,4),z.write_shift(4,0);for(var I=0,L=0,te=0,me=0;me<A.SheetNames.length;++me){var ge=A.SheetNames[me],pe=A.Sheets[ge];if(!(!pe||!pe["!ref"])){++te;var Ee=Ua(pe["!ref"]);I<Ee.e.r&&(I=Ee.e.r),L<Ee.e.c&&(L=Ee.e.c)}}return I>8191&&(I=8191),z.write_shift(2,I),z.write_shift(1,te),z.write_shift(1,L),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(1,1),z.write_shift(1,2),z.write_shift(4,0),z.write_shift(4,0),z}function u(A,z,I){var L={s:{c:0,r:0},e:{c:0,r:0}};return z==8&&I.qpro?(L.s.c=A.read_shift(1),A.l++,L.s.r=A.read_shift(2),L.e.c=A.read_shift(1),A.l++,L.e.r=A.read_shift(2),L):(L.s.c=A.read_shift(2),L.s.r=A.read_shift(2),z==12&&I.qpro&&(A.l+=2),L.e.c=A.read_shift(2),L.e.r=A.read_shift(2),z==12&&I.qpro&&(A.l+=2),L.s.c==65535&&(L.s.c=L.e.c=L.s.r=L.e.r=0),L)}function h(A){var z=_e(8);return z.write_shift(2,A.s.c),z.write_shift(2,A.s.r),z.write_shift(2,A.e.c),z.write_shift(2,A.e.r),z}function d(A,z,I){var L=[{c:0,r:0},{t:"n",v:0},0,0];return I.qpro&&I.vers!=20768?(L[0].c=A.read_shift(1),L[3]=A.read_shift(1),L[0].r=A.read_shift(2),A.l+=2):(L[2]=A.read_shift(1),L[0].c=A.read_shift(2),L[0].r=A.read_shift(2)),L}function g(A,z,I){var L=A.l+z,te=d(A,z,I);if(te[1].t="s",I.vers==20768){A.l++;var me=A.read_shift(1);return te[1].v=A.read_shift(me,"utf8"),te}return I.qpro&&A.l++,te[1].v=A.read_shift(L-A.l,"cstr"),te}function x(A,z,I){var L=_e(7+I.length);L.write_shift(1,255),L.write_shift(2,z),L.write_shift(2,A),L.write_shift(1,39);for(var te=0;te<L.length;++te){var me=I.charCodeAt(te);L.write_shift(1,me>=128?95:me)}return L.write_shift(1,0),L}function y(A,z,I){var L=d(A,z,I);return L[1].v=A.read_shift(2,"i"),L}function _(A,z,I){var L=_e(7);return L.write_shift(1,255),L.write_shift(2,z),L.write_shift(2,A),L.write_shift(2,I,"i"),L}function b(A,z,I){var L=d(A,z,I);return L[1].v=A.read_shift(8,"f"),L}function w(A,z,I){var L=_e(13);return L.write_shift(1,255),L.write_shift(2,z),L.write_shift(2,A),L.write_shift(8,I,"f"),L}function S(A,z,I){var L=A.l+z,te=d(A,z,I);if(te[1].v=A.read_shift(8,"f"),I.qpro)A.l=L;else{var me=A.read_shift(2);j(A.slice(A.l,A.l+me),te),A.l+=me}return te}function k(A,z,I){var L=z&32768;return z&=-32769,z=(L?A:0)+(z>=8192?z-16384:z),(L?"":"$")+(I?gr(z):Ar(z))}var C={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},T=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function j(A,z){la(A,0);for(var I=[],L=0,te="",me="",ge="",pe="";A.l<A.length;){var Ee=A[A.l++];switch(Ee){case 0:I.push(A.read_shift(8,"f"));break;case 1:me=k(z[0].c,A.read_shift(2),!0),te=k(z[0].r,A.read_shift(2),!1),I.push(me+te);break;case 2:{var et=k(z[0].c,A.read_shift(2),!0),q=k(z[0].r,A.read_shift(2),!1);me=k(z[0].c,A.read_shift(2),!0),te=k(z[0].r,A.read_shift(2),!1),I.push(et+q+":"+me+te)}break;case 3:if(A.l<A.length){console.error("WK1 premature formula end");return}break;case 4:I.push("("+I.pop()+")");break;case 5:I.push(A.read_shift(2));break;case 6:{for(var vt="";Ee=A[A.l++];)vt+=String.fromCharCode(Ee);I.push('"'+vt.replace(/"/g,'""')+'"')}break;case 8:I.push("-"+I.pop());break;case 23:I.push("+"+I.pop());break;case 22:I.push("NOT("+I.pop()+")");break;case 20:case 21:pe=I.pop(),ge=I.pop(),I.push(["AND","OR"][Ee-20]+"("+ge+","+pe+")");break;default:if(Ee<32&&T[Ee])pe=I.pop(),ge=I.pop(),I.push(ge+T[Ee]+pe);else if(C[Ee]){if(L=C[Ee][1],L==69&&(L=A[A.l++]),L>I.length){console.error("WK1 bad formula parse 0x"+Ee.toString(16)+":|"+I.join("|")+"|");return}var nt=I.slice(-L);I.length-=L,I.push(C[Ee][0]+"("+nt.join(",")+")")}else return Ee<=7?console.error("WK1 invalid opcode "+Ee.toString(16)):Ee<=24?console.error("WK1 unsupported op "+Ee.toString(16)):Ee<=30?console.error("WK1 invalid opcode "+Ee.toString(16)):Ee<=115?console.error("WK1 unsupported function opcode "+Ee.toString(16)):console.error("WK1 unrecognized opcode "+Ee.toString(16))}}I.length==1?z[1].f=""+I[0]:console.error("WK1 bad formula parse |"+I.join("|")+"|")}function X(A){var z=[{c:0,r:0},{t:"n",v:0},0];return z[0].r=A.read_shift(2),z[3]=A[A.l++],z[0].c=A[A.l++],z}function D(A,z){var I=X(A);return I[1].t="s",I[1].v=A.read_shift(z-4,"cstr"),I}function N(A,z,I,L){var te=_e(6+L.length);te.write_shift(2,A),te.write_shift(1,I),te.write_shift(1,z),te.write_shift(1,39);for(var me=0;me<L.length;++me){var ge=L.charCodeAt(me);te.write_shift(1,ge>=128?95:ge)}return te.write_shift(1,0),te}function W(A,z){var I=X(A);I[1].v=A.read_shift(2);var L=I[1].v>>1;if(I[1].v&1)switch(L&7){case 0:L=(L>>3)*5e3;break;case 1:L=(L>>3)*500;break;case 2:L=(L>>3)/20;break;case 3:L=(L>>3)/200;break;case 4:L=(L>>3)/2e3;break;case 5:L=(L>>3)/2e4;break;case 6:L=(L>>3)/16;break;case 7:L=(L>>3)/64;break}return I[1].v=L,I}function P(A,z){var I=X(A),L=A.read_shift(4),te=A.read_shift(4),me=A.read_shift(2);if(me==65535)return L===0&&te===3221225472?(I[1].t="e",I[1].v=15):L===0&&te===3489660928?(I[1].t="e",I[1].v=42):I[1].v=0,I;var ge=me&32768;return me=(me&32767)-16446,I[1].v=(1-ge*2)*(te*Math.pow(2,me+32)+L*Math.pow(2,me)),I}function re(A,z,I,L){var te=_e(14);if(te.write_shift(2,A),te.write_shift(1,I),te.write_shift(1,z),L==0)return te.write_shift(4,0),te.write_shift(4,0),te.write_shift(2,65535),te;var me=0,ge=0,pe=0,Ee=0;return L<0&&(me=1,L=-L),ge=Math.log2(L)|0,L/=Math.pow(2,ge-31),Ee=L>>>0,(Ee&2147483648)==0&&(L/=2,++ge,Ee=L>>>0),L-=Ee,Ee|=2147483648,Ee>>>=0,L*=Math.pow(2,32),pe=L>>>0,te.write_shift(4,pe),te.write_shift(4,Ee),ge+=16383+(me?32768:0),te.write_shift(2,ge),te}function ae(A,z){var I=P(A);return A.l+=z-14,I}function Q(A,z){var I=X(A),L=A.read_shift(4);return I[1].v=L>>6,I}function xe(A,z){var I=X(A),L=A.read_shift(8,"f");return I[1].v=L,I}function Oe(A,z){var I=xe(A);return A.l+=z-10,I}function Ae(A,z){return A[A.l+z-1]==0?A.read_shift(z,"cstr"):""}function K(A,z){var I=A[A.l++];I>z-1&&(I=z-1);for(var L="";L.length<I;)L+=String.fromCharCode(A[A.l++]);return L}function le(A,z,I){if(!(!I.qpro||z<21)){var L=A.read_shift(1);A.l+=17,A.l+=1,A.l+=2;var te=A.read_shift(z-21,"cstr");return[L,te]}}function je(A,z){for(var I={},L=A.l+z;A.l<L;){var te=A.read_shift(2);if(te==14e3){for(I[te]=[0,""],I[te][0]=A.read_shift(2);A[A.l];)I[te][1]+=String.fromCharCode(A[A.l]),A.l++;A.l++}}return I}function U(A,z){var I=_e(5+A.length);I.write_shift(2,14e3),I.write_shift(2,z);for(var L=0;L<A.length;++L){var te=A.charCodeAt(L);I[I.l++]=te>127?95:te}return I[I.l++]=0,I}var ve={0:{n:"BOF",f:Ir},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:y},14:{n:"NUMBER",f:b},15:{n:"LABEL",f:g},16:{n:"FORMULA",f:S},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:g},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Ae},222:{n:"SHEETNAMELP",f:K},65535:{n:""}},G={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:D},23:{n:"NUMBER17",f:P},24:{n:"NUMBER18",f:W},25:{n:"FORMULA19",f:ae},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:je},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:Q},38:{n:"??"},39:{n:"NUMBER27",f:xe},40:{n:"FORMULA28",f:Oe},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Ae},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:le},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:s,to_workbook:t}})();function AN(e){var t={},r=e.match(_a),a=0,s=!1;if(r)for(;a!=r.length;++a){var l=mt(r[a]);switch(l[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!l.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(l.val=="1")break;t.cp=Sm[parseInt(l.val,10)];break;case"<outline":if(!l.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=l.val;break;case"<sz":t.sz=l.val;break;case"<strike":if(!l.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!l.val)break;switch(l.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(l.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(l.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":l.rgb&&(t.color=l.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=l.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=l.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(l[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+l[0])}}return t}var CN=(function(){var e=$c("t"),t=$c("rPr");function r(l){var c=l.match(e);if(!c)return{t:"s",v:""};var u={t:"s",v:Ft(c[1])},h=l.match(t);return h&&(u.s=AN(h[1])),u}var a=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(c){return c.replace(a,"").split(s).map(r).filter(function(u){return u.v})}})(),NN=(function(){var t=/(\r\n|\n)/g;function r(s,l,c){var u=[];s.u&&u.push("text-decoration: underline;"),s.uval&&u.push("text-underline-style:"+s.uval+";"),s.sz&&u.push("font-size:"+s.sz+"pt;"),s.outline&&u.push("text-effect: outline;"),s.shadow&&u.push("text-shadow: auto;"),l.push('<span style="'+u.join("")+'">'),s.b&&(l.push("<b>"),c.push("</b>")),s.i&&(l.push("<i>"),c.push("</i>")),s.strike&&(l.push("<s>"),c.push("</s>"));var h=s.valign||"";return h=="superscript"||h=="super"?h="sup":h=="subscript"&&(h="sub"),h!=""&&(l.push("<"+h+">"),c.push("</"+h+">")),c.push("</span>"),s}function a(s){var l=[[],s.v,[]];return s.v?(s.s&&r(s.s,l[0],l[2]),l[0].join("")+l[1].replace(t,"<br/>")+l[2].join("")):""}return function(l){return l.map(a).join("")}})(),ON=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,RN=/<(?:\w+:)?r>/,DN=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Xm(e,t){var r=t?t.cellHTML:!0,a={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=Ft(rr(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=rr(e),r&&(a.h=Fm(a.t))):e.match(RN)&&(a.r=rr(e),a.t=Ft(rr((e.replace(DN,"").match(ON)||[]).join("").replace(_a,""))),r&&(a.h=NN(CN(a.r)))),a):{t:""}}var FN=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,MN=/<(?:\w+:)?(?:si|sstItem)>/g,jN=/<\/(?:\w+:)?(?:si|sstItem)>/;function IN(e,t){var r=[],a="";if(!e)return r;var s=e.match(FN);if(s){a=s[2].replace(MN,"").split(jN);for(var l=0;l!=a.length;++l){var c=Xm(a[l].trim(),t);c!=null&&(r[r.length]=c)}s=mt(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}var LN=/^\s|\s$|[\t\n\r]/;function C2(e,t){if(!t.bookSST)return"";var r=[Cr];r[r.length]=Ue("sst",null,{xmlns:sl[0],count:e.Count,uniqueCount:e.Unique});for(var a=0;a!=e.length;++a)if(e[a]!=null){var s=e[a],l="<si>";s.r?l+=s.r:(l+="<t",s.t||(s.t=""),s.t.match(LN)&&(l+=' xml:space="preserve"'),l+=">"+Kt(s.t)+"</t>"),l+="</si>",r[r.length]=l}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function BN(e){return[e.read_shift(4),e.read_shift(4)]}function UN(e,t){var r=[],a=!1;return As(e,function(l,c,u){switch(u){case 159:r.Count=l[0],r.Unique=l[1];break;case 19:r.push(l);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(c.T,!a||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}),r}function PN(e,t){return t||(t=_e(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var zN=JA;function HN(e){var t=Ba();Ne(t,159,PN(e));for(var r=0;r<e.length;++r)Ne(t,19,zN(e[r]));return Ne(t,160),t.end()}function N2(e){for(var t=[],r=e.split(""),a=0;a<r.length;++a)t[a]=r[a].charCodeAt(0);return t}function Ss(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function $N(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Ss(e,4),t.U=Ss(e,4),t.W=Ss(e,4),t}function VN(e){for(var t=e.read_shift(4),r=e.l+t-4,a={},s=e.read_shift(4),l=[];s-- >0;)l.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(a.name=e.read_shift(0,"lpp4"),a.comps=l,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return a}function GN(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(VN(e));return t}function qN(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function XN(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Ss(e,4),t.U=Ss(e,4),t.W=Ss(e,4),t}function WN(e){var t=XN(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function O2(e,t){var r=e.l+t,a={};a.Flags=e.read_shift(4)&63,e.l+=4,a.AlgID=e.read_shift(4);var s=!1;switch(a.AlgID){case 26126:case 26127:case 26128:s=a.Flags==36;break;case 26625:s=a.Flags==4;break;case 0:s=a.Flags==16||a.Flags==4||a.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=e.read_shift(4),a.KeySize=e.read_shift(4),a.ProviderType=e.read_shift(4),e.l+=8,a.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,a}function R2(e,t){var r={},a=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,a),e.l=a,r}function KN(e){var t=Ss(e);switch(t.Minor){case 2:return[t.Minor,YN(e)];case 3:return[t.Minor,JN()];case 4:return[t.Minor,QN(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function YN(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),a=O2(e,r),s=R2(e,e.length-e.l);return{t:"Std",h:a,v:s}}function JN(){throw new Error("File is password-protected: ECMA-376 Extensible")}function QN(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),a={};return r.replace(_a,function(l){var c=mt(l);switch(Yn(c[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(u){a[u]=c[u]});break;case"<dataIntegrity":a.encryptedHmacKey=c.encryptedHmacKey,a.encryptedHmacValue=c.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":a.uri=c.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":a.encs.push(c);break;default:throw c[0]}}),a}function ZN(e,t){var r={},a=r.EncryptionVersionInfo=Ss(e,4);if(t-=4,a.Minor!=2)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);r.Flags=e.read_shift(4),t-=4;var s=e.read_shift(4);return t-=4,r.EncryptionHeader=O2(e,s),t-=s,r.EncryptionVerifier=R2(e,t),r}function e6(e){var t={},r=t.EncryptionVersionInfo=Ss(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function Wm(e){var t=0,r,a=N2(e),s=a.length+1,l,c,u,h,d;for(r=oi(s),r[0]=a.length,l=1;l!=s;++l)r[l]=a[l-1];for(l=s-1;l>=0;--l)c=r[l],u=(t&16384)===0?0:1,h=t<<1&32767,d=u|h,t=d^c;return t^52811}var D2=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(c){return(c/2|c*128)&255},s=function(c,u){return a(c^u)},l=function(c){for(var u=t[c.length-1],h=104,d=c.length-1;d>=0;--d)for(var g=c[d],x=0;x!=7;++x)g&64&&(u^=r[h]),g*=2,--h;return u};return function(c){for(var u=N2(c),h=l(u),d=u.length,g=oi(16),x=0;x!=16;++x)g[x]=0;var y,_,b;for((d&1)===1&&(y=h>>8,g[d]=s(e[0],y),--d,y=h&255,_=u[u.length-1],g[d]=s(_,y));d>0;)--d,y=h>>8,g[d]=s(u[d],y),--d,y=h&255,g[d]=s(u[d],y);for(d=15,b=15-u.length;b>0;)y=h>>8,g[d]=s(e[b],y),--d,--b,y=h&255,g[d]=s(u[d],y),--d,--b;return g}})(),t6=function(e,t,r,a,s){s||(s=t),a||(a=D2(e));var l,c;for(l=0;l!=t.length;++l)c=t[l],c^=a[r],c=(c>>5|c<<3)&255,s[l]=c,++r;return[s,r,a]},r6=function(e){var t=0,r=D2(e);return function(a){var s=t6("",a,t,r);return t=s[1],s[0]}};function a6(e,t,r,a){var s={key:Ir(e),verificationBytes:Ir(e)};return r.password&&(s.verifier=Wm(r.password)),a.valid=s.verificationBytes===s.verifier,a.valid&&(a.insitu=r6(r.password)),s}function n6(e,t,r){var a=r||{};return a.Info=e.read_shift(2),e.l-=2,a.Info===1?a.Data=e6(e):a.Data=ZN(e,t),a}function s6(e,t,r){var a={Type:r.biff>=8?e.read_shift(2):0};return a.Type?n6(e,t-2,a):a6(e,r.biff>=8?t:t-2,r,a),a}var F2=(function(){function e(s,l){switch(l.type){case"base64":return t(an(s),l);case"binary":return t(s,l);case"buffer":return t(Tt&&Buffer.isBuffer(s)?s.toString("binary"):hi(s),l);case"array":return t(Ji(s),l)}throw new Error("Unrecognized type "+l.type)}function t(s,l){var c=l||{},u=c.dense?[]:{},h=s.match(/\\trowd.*?\\row\b/g);if(!h.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:h.length-1}};return h.forEach(function(g,x){Array.isArray(u)&&(u[x]=[]);for(var y=/\\\w+\b/g,_=0,b,w=-1;b=y.exec(g);){switch(b[0]){case"\\cell":var S=g.slice(_,y.lastIndex-b[0].length);if(S[0]==" "&&(S=S.slice(1)),++w,S.length){var k={v:S,t:"s"};Array.isArray(u)?u[x][w]=k:u[ht({r:x,c:w})]=k}break}_=y.lastIndex}w>d.e.c&&(d.e.c=w)}),u["!ref"]=_t(d),u}function r(s,l){return di(e(s,l),l)}function a(s){for(var l=["{\\rtf1\\ansi"],c=Mt(s["!ref"]),u,h=Array.isArray(s),d=c.s.r;d<=c.e.r;++d){l.push("\\trowd\\trautofit1");for(var g=c.s.c;g<=c.e.c;++g)l.push("\\cellx"+(g+1));for(l.push("\\pard\\intbl"),g=c.s.c;g<=c.e.c;++g){var x=ht({r:d,c:g});u=h?(s[d]||[])[g]:s[x],!(!u||u.v==null&&(!u.f||u.F))&&(l.push(" "+(u.w||(Es(u),u.w))),l.push("\\cell"))}l.push("\\pard\\intbl\\row")}return l.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:a}})();function i6(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Xc(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function l6(e){var t=e[0]/255,r=e[1]/255,a=e[2]/255,s=Math.max(t,r,a),l=Math.min(t,r,a),c=s-l;if(c===0)return[0,0,t];var u=0,h=0,d=s+l;switch(h=c/(d>1?2-d:d),s){case t:u=((r-a)/c+6)%6;break;case r:u=(a-t)/c+2;break;case a:u=(t-r)/c+4;break}return[u/6,h,d/2]}function o6(e){var t=e[0],r=e[1],a=e[2],s=r*2*(a<.5?a:1-a),l=a-s/2,c=[l,l,l],u=6*t,h;if(r!==0)switch(u|0){case 0:case 6:h=s*u,c[0]+=s,c[1]+=h;break;case 1:h=s*(2-u),c[0]+=h,c[1]+=s;break;case 2:h=s*(u-2),c[1]+=s,c[2]+=h;break;case 3:h=s*(4-u),c[1]+=h,c[2]+=s;break;case 4:h=s*(u-4),c[2]+=s,c[0]+=h;break;case 5:h=s*(6-u),c[2]+=h,c[0]+=s;break}for(var d=0;d!=3;++d)c[d]=Math.round(c[d]*255);return c}function ef(e,t){if(t===0)return e;var r=l6(i6(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Xc(o6(r))}var M2=6,c6=15,u6=1,pa=M2;function Wc(e){return Math.floor((e+Math.round(128/pa)/256)*pa)}function Kc(e){return Math.floor((e-5)/pa*100+.5)/100}function tf(e){return Math.round((e*pa+5)/pa*256)/256}function Id(e){return tf(Kc(Wc(e)))}function Km(e){var t=Math.abs(e-Id(e)),r=pa;if(t>.005)for(pa=u6;pa<c6;++pa)Math.abs(e-Id(e))<=t&&(t=Math.abs(e-Id(e)),r=pa);pa=r}function ci(e){e.width?(e.wpx=Wc(e.width),e.wch=Kc(e.wpx),e.MDW=pa):e.wpx?(e.wch=Kc(e.wpx),e.width=tf(e.wch),e.MDW=pa):typeof e.wch=="number"&&(e.width=tf(e.wch),e.wpx=Wc(e.width),e.MDW=pa),e.customWidth&&delete e.customWidth}var f6=96,j2=f6;function Yc(e){return e*96/j2}function wo(e){return e*j2/96}var h6={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function d6(e,t,r,a){t.Borders=[];var s={},l=!1;(e[0].match(_a)||[]).forEach(function(c){var u=mt(c);switch(Yn(u[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},u.diagonalUp&&(s.diagonalUp=cr(u.diagonalUp)),u.diagonalDown&&(s.diagonalDown=cr(u.diagonalDown)),t.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(a&&a.WTF&&!l)throw new Error("unrecognized "+u[0]+" in borders")}})}function m6(e,t,r,a){t.Fills=[];var s={},l=!1;(e[0].match(_a)||[]).forEach(function(c){var u=mt(c);switch(Yn(u[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},t.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":u.patternType&&(s.patternType=u.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),u.indexed&&(s.bgColor.indexed=parseInt(u.indexed,10)),u.theme&&(s.bgColor.theme=parseInt(u.theme,10)),u.tint&&(s.bgColor.tint=parseFloat(u.tint)),u.rgb&&(s.bgColor.rgb=u.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),u.theme&&(s.fgColor.theme=parseInt(u.theme,10)),u.tint&&(s.fgColor.tint=parseFloat(u.tint)),u.rgb!=null&&(s.fgColor.rgb=u.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(a&&a.WTF&&!l)throw new Error("unrecognized "+u[0]+" in fills")}})}function g6(e,t,r,a){t.Fonts=[];var s={},l=!1;(e[0].match(_a)||[]).forEach(function(c){var u=mt(c);switch(Yn(u[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(s),s={};break;case"<name":u.val&&(s.name=rr(u.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=u.val?cr(u.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=u.val?cr(u.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(u.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=u.val?cr(u.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=u.val?cr(u.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=u.val?cr(u.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=u.val?cr(u.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=u.val?cr(u.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":u.val&&(s.sz=+u.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":u.val&&(s.vertAlign=u.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":u.val&&(s.family=parseInt(u.val,10));break;case"<family/>":case"</family>":break;case"<scheme":u.val&&(s.scheme=u.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(u.val=="1")break;u.codepage=Sm[parseInt(u.val,10)];break;case"<color":if(s.color||(s.color={}),u.auto&&(s.color.auto=cr(u.auto)),u.rgb)s.color.rgb=u.rgb.slice(-6);else if(u.indexed){s.color.index=parseInt(u.indexed,10);var h=Gi[s.color.index];s.color.index==81&&(h=Gi[1]),h||(h=Gi[1]),s.color.rgb=h[0].toString(16)+h[1].toString(16)+h[2].toString(16)}else u.theme&&(s.color.theme=parseInt(u.theme,10),u.tint&&(s.color.tint=parseFloat(u.tint)),u.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=ef(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":l=!0;break;case"</AlternateContent>":l=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(a&&a.WTF&&!l)throw new Error("unrecognized "+u[0]+" in fonts")}})}function p6(e,t,r){t.NumberFmt=[];for(var a=br(ft),s=0;s<a.length;++s)t.NumberFmt[a[s]]=ft[a[s]];var l=e[0].match(_a);if(l)for(s=0;s<l.length;++s){var c=mt(l[s]);switch(Yn(c[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var u=Ft(rr(c.formatCode)),h=parseInt(c.numFmtId,10);if(t.NumberFmt[h]=u,h>0){if(h>392){for(h=392;h>60&&t.NumberFmt[h]!=null;--h);t.NumberFmt[h]=u}bs(u,h)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+c[0]+" in numFmts")}}}function x6(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)e[a]!=null&&(t[t.length]=Ue("numFmt",null,{numFmtId:a,formatCode:Kt(e[a])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Ue("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var j0=["numFmtId","fillId","fontId","borderId","xfId"],I0=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function v6(e,t,r){t.CellXf=[];var a,s=!1;(e[0].match(_a)||[]).forEach(function(l){var c=mt(l),u=0;switch(Yn(c[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(a=c,delete a[0],u=0;u<j0.length;++u)a[j0[u]]&&(a[j0[u]]=parseInt(a[j0[u]],10));for(u=0;u<I0.length;++u)a[I0[u]]&&(a[I0[u]]=cr(a[I0[u]]));if(t.NumberFmt&&a.numFmtId>392){for(u=392;u>60;--u)if(t.NumberFmt[a.numFmtId]==t.NumberFmt[u]){a.numFmtId=u;break}}t.CellXf.push(a);break;case"</xf>":break;case"<alignment":case"<alignment/>":var h={};c.vertical&&(h.vertical=c.vertical),c.horizontal&&(h.horizontal=c.horizontal),c.textRotation!=null&&(h.textRotation=c.textRotation),c.indent&&(h.indent=c.indent),c.wrapText&&(h.wrapText=cr(c.wrapText)),a.alignment=h;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+c[0]+" in cellXfs")}})}function y6(e){var t=[];return t[t.length]=Ue("cellXfs",null),e.forEach(function(r){t[t.length]=Ue("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Ue("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var _6=(function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,a=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,l=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(u,h,d){var g={};if(!u)return g;u=u.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var x;return(x=u.match(t))&&p6(x,g,d),(x=u.match(s))&&g6(x,g,h,d),(x=u.match(a))&&m6(x,g,h,d),(x=u.match(l))&&d6(x,g,h,d),(x=u.match(r))&&v6(x,g,d),g}})();function I2(e,t){var r=[Cr,Ue("styleSheet",null,{xmlns:sl[0],"xmlns:vt":zr.vt})],a;return e.SSF&&(a=x6(e.SSF))!=null&&(r[r.length]=a),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(a=y6(t.cellXfs))&&(r[r.length]=a),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function w6(e,t){var r=e.read_shift(2),a=va(e);return[r,a]}function b6(e,t,r){r||(r=_e(6+4*t.length)),r.write_shift(2,e),Jr(t,r);var a=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),a}function S6(e,t,r){var a={};a.sz=e.read_shift(2)/20;var s=n3(e);s.fItalic&&(a.italic=1),s.fCondense&&(a.condense=1),s.fExtend&&(a.extend=1),s.fShadow&&(a.shadow=1),s.fOutline&&(a.outline=1),s.fStrikeout&&(a.strike=1);var l=e.read_shift(2);switch(l===700&&(a.bold=1),e.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var c=e.read_shift(1);c!=0&&(a.underline=c);var u=e.read_shift(1);u>0&&(a.family=u);var h=e.read_shift(1);switch(h>0&&(a.charset=h),e.l++,a.color=a3(e),e.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=va(e),a}function E6(e,t){t||(t=_e(153)),t.write_shift(2,e.sz*20),s3(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),J0(e.color,t);var a=0;return a=2,t.write_shift(1,a),Jr(e.name,t),t.length>t.l?t.slice(0,t.l):t}var T6=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Ld,k6=ya;function by(e,t){t||(t=_e(84)),Ld||(Ld=uf(T6));var r=Ld[e.patternType];r==null&&(r=40),t.write_shift(4,r);var a=0;if(r!=40)for(J0({auto:1},t),J0({auto:1},t);a<12;++a)t.write_shift(4,0);else{for(;a<4;++a)t.write_shift(4,0);for(;a<12;++a)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function A6(e,t){var r=e.l+t,a=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:a,numFmtId:s}}function L2(e,t,r){r||(r=_e(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var a=0;return r.write_shift(1,a),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function yc(e,t){return t||(t=_e(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var C6=ya;function N6(e,t){return t||(t=_e(51)),t.write_shift(1,0),yc(null,t),yc(null,t),yc(null,t),yc(null,t),yc(null,t),t.length>t.l?t.slice(0,t.l):t}function O6(e,t){return t||(t=_e(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Y0(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function R6(e,t,r){var a=_e(2052);return a.write_shift(4,e),Y0(t,a),Y0(r,a),a.length>a.l?a.slice(0,a.l):a}function D6(e,t,r){var a={};a.NumberFmt=[];for(var s in ft)a.NumberFmt[s]=ft[s];a.CellXf=[],a.Fonts=[];var l=[],c=!1;return As(e,function(h,d,g){switch(g){case 44:a.NumberFmt[h[0]]=h[1],bs(h[1],h[0]);break;case 43:a.Fonts.push(h),h.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(h.color.rgb=ef(t.themeElements.clrScheme[h.color.theme].rgb,h.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:l[l.length-1]==617&&a.CellXf.push(h);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:c=!0;break;case 36:c=!1;break;case 37:l.push(g),c=!0;break;case 38:l.pop(),c=!1;break;default:if(d.T>0)l.push(g);else if(d.T<0)l.pop();else if(!c||r.WTF&&l[l.length-1]!=37)throw new Error("Unexpected record 0x"+g.toString(16))}}),a}function F6(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var s=a[0];s<=a[1];++s)t[s]!=null&&++r}),r!=0&&(Ne(e,615,In(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var s=a[0];s<=a[1];++s)t[s]!=null&&Ne(e,44,b6(s,t[s]))}),Ne(e,616))}}function M6(e){var t=1;Ne(e,611,In(t)),Ne(e,43,E6({sz:12,color:{theme:1},name:"Calibri",family:2})),Ne(e,612)}function j6(e){var t=2;Ne(e,603,In(t)),Ne(e,45,by({patternType:"none"})),Ne(e,45,by({patternType:"gray125"})),Ne(e,604)}function I6(e){var t=1;Ne(e,613,In(t)),Ne(e,46,N6()),Ne(e,614)}function L6(e){var t=1;Ne(e,626,In(t)),Ne(e,47,L2({numFmtId:0},65535)),Ne(e,627)}function B6(e,t){Ne(e,617,In(t.length)),t.forEach(function(r){Ne(e,47,L2(r,0))}),Ne(e,618)}function U6(e){var t=1;Ne(e,619,In(t)),Ne(e,48,O6({xfId:0,name:"Normal"})),Ne(e,620)}function P6(e){var t=0;Ne(e,505,In(t)),Ne(e,506)}function z6(e){var t=0;Ne(e,508,R6(t,"TableStyleMedium9","PivotStyleMedium4")),Ne(e,509)}function H6(e,t){var r=Ba();return Ne(r,278),F6(r,e.SSF),M6(r),j6(r),I6(r),L6(r),B6(r,t.cellXfs),U6(r),P6(r),z6(r),Ne(r,279),r.end()}var $6=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function V6(e,t,r){t.themeElements.clrScheme=[];var a={};(e[0].match(_a)||[]).forEach(function(s){var l=mt(s);switch(l[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=l.val;break;case"<a:sysClr":a.rgb=l.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":l[0].charAt(1)==="/"?(t.themeElements.clrScheme[$6.indexOf(l[0])]=a,a={}):a.name=l[0].slice(3,l[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+l[0]+" in clrScheme")}})}function G6(){}function q6(){}var X6=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,W6=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,K6=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function Y6(e,t,r){t.themeElements={};var a;[["clrScheme",X6,V6],["fontScheme",W6,G6],["fmtScheme",K6,q6]].forEach(function(s){if(!(a=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](a,t,r)})}var J6=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function B2(e,t){(!e||e.length===0)&&(e=Ym());var r,a={};if(!(r=e.match(J6)))throw new Error("themeElements not found in theme");return Y6(r[0],a,t),a.raw=e,a}function Ym(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Cr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Q6(e,t,r){var a=e.l+t,s=e.read_shift(4);if(s!==124226){if(!r.cellStyles){e.l=a;return}var l=e.slice(e.l);e.l=a;var c;try{c=O_(l,{type:"array"})}catch{return}var u=rn(c,"theme/theme/theme1.xml",!0);if(u)return B2(u,r)}}function Z6(e){return e.read_shift(4)}function e8(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=t8(e,4);break;case 2:t.xclrValue=x2(e);break;case 3:t.xclrValue=Z6(e);break;case 4:e.l+=4;break}return e.l+=8,t}function t8(e,t){return ya(e,t)}function r8(e,t){return ya(e,t)}function a8(e){var t=e.read_shift(2),r=e.read_shift(2)-4,a=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=e8(e);break;case 6:a[1]=r8(e,r);break;case 14:case 15:a[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return a}function n8(e,t){var r=e.l+t;e.l+=2;var a=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),l=[];s-- >0;)l.push(a8(e,r-e.l));return{ixfe:a,ext:l}}function s8(e,t){t.forEach(function(r){r[0]})}function i8(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:va(e)}}function l8(e){var t=_e(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Jr(e.name,t),t.slice(0,t.l)}function o8(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function c8(e){var t=_e(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function u8(e,t){var r=_e(8+2*t.length);return r.write_shift(4,e),Jr(t,r),r.slice(0,r.l)}function f8(e){return e.l+=4,e.read_shift(4)!=0}function h8(e,t){var r=_e(8);return r.write_shift(4,e),r.write_shift(4,1),r}function d8(e,t,r){var a={Types:[],Cell:[],Value:[]},s=r||{},l=[],c=!1,u=2;return As(e,function(h,d,g){switch(g){case 335:a.Types.push({name:h.name});break;case 51:h.forEach(function(x){u==1?a.Cell.push({type:a.Types[x[0]-1].name,index:x[1]}):u==0&&a.Value.push({type:a.Types[x[0]-1].name,index:x[1]})});break;case 337:u=h?1:0;break;case 338:u=2;break;case 35:l.push(g),c=!0;break;case 36:l.pop(),c=!1;break;default:if(!d.T){if(!c||s.WTF&&l[l.length-1]!=35)throw new Error("Unexpected record 0x"+g.toString(16))}}}),a}function m8(){var e=Ba();return Ne(e,332),Ne(e,334,In(1)),Ne(e,335,l8({name:"XLDAPR",version:12e4,flags:3496657072})),Ne(e,336),Ne(e,339,u8(1,"XLDAPR")),Ne(e,52),Ne(e,35,In(514)),Ne(e,4096,In(0)),Ne(e,4097,yn(1)),Ne(e,36),Ne(e,53),Ne(e,340),Ne(e,337,h8(1)),Ne(e,51,c8([[1,0]])),Ne(e,338),Ne(e,333),e.end()}function g8(e,t,r){var a={Types:[],Cell:[],Value:[]};if(!e)return a;var s=!1,l=2,c;return e.replace(_a,function(u){var h=mt(u);switch(Yn(h[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":a.Types.push({name:h.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<a.Types.length;++d)a.Types[d].name==h.name&&(c=a.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":l==1?a.Cell.push({type:a.Types[h.t-1].name,index:+h.v}):l==0&&a.Value.push({type:a.Types[h.t-1].name,index:+h.v});break;case"</rc>":break;case"<cellMetadata":l=1;break;case"</cellMetadata>":l=2;break;case"<valueMetadata":l=0;break;case"</valueMetadata>":l=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!c)break;c.offsets||(c.offsets=[]),c.offsets.push(+h.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+h[0]+" in metadata")}return u}),a}function U2(){var e=[Cr];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function p8(e){var t=[];if(!e)return t;var r=1;return(e.match(_a)||[]).forEach(function(a){var s=mt(a);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,t.push(s);break}}),t}function x8(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=ht(r);var a=e.read_shift(1);return a&2&&(t.l="1"),a&8&&(t.a="1"),t}function v8(e,t,r){var a=[];return As(e,function(l,c,u){switch(u){case 63:a.push(l);break;default:if(!c.T)throw new Error("Unexpected record 0x"+u.toString(16))}}),a}function y8(e,t,r,a){if(!e)return e;var s=a||{},l=!1;As(e,function(u,h,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:l=!0;break;case 36:l=!1;break;default:if(!h.T){if(!l||s.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},s)}function _8(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var uo=1024;function P2(e,t){for(var r=[21600,21600],a=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[Ue("xml",null,{"xmlns:v":Ja.v,"xmlns:o":Ja.o,"xmlns:x":Ja.x,"xmlns:mv":Ja.mv}).replace(/\/>/,">"),Ue("o:shapelayout",Ue("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Ue("v:shapetype",[Ue("v:stroke",null,{joinstyle:"miter"}),Ue("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:a})];uo<e*1e3;)uo+=1e3;return t.forEach(function(l){var c=pr(l[0]),u={color2:"#BEFF82",type:"gradient"};u.type=="gradient"&&(u.angle="-180");var h=u.type=="gradient"?Ue("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=Ue("v:fill",h,u),g={on:"t",obscured:"t"};++uo,s=s.concat(["<v:shape"+Vc({id:"_x0000_s"+uo,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(l[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,Ue("v:shadow",null,g),Ue("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",oa("x:Anchor",[c.c+1,0,c.r+1,0,c.c+3,20,c.r+5,20].join(",")),oa("x:AutoFill","False"),oa("x:Row",String(c.r)),oa("x:Column",String(c.c)),l[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function Sy(e,t,r,a){var s=Array.isArray(e),l;t.forEach(function(c){var u=pr(c.ref);if(s?(e[u.r]||(e[u.r]=[]),l=e[u.r][u.c]):l=e[c.ref],!l){l={t:"z"},s?e[u.r][u.c]=l:e[c.ref]=l;var h=Mt(e["!ref"]||"BDWGO1000001:A1");h.s.r>u.r&&(h.s.r=u.r),h.e.r<u.r&&(h.e.r=u.r),h.s.c>u.c&&(h.s.c=u.c),h.e.c<u.c&&(h.e.c=u.c);var d=_t(h);d!==e["!ref"]&&(e["!ref"]=d)}l.c||(l.c=[]);var g={a:c.author,t:c.t,r:c.r,T:r};c.h&&(g.h=c.h);for(var x=l.c.length-1;x>=0;--x){if(!r&&l.c[x].T)return;r&&!l.c[x].T&&l.c.splice(x,1)}if(r&&a){for(x=0;x<a.length;++x)if(g.a==a[x].id){g.a=a[x].name||g.a;break}}l.c.push(g)})}function w8(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],a=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(c){if(!(c===""||c.trim()==="")){var u=c.match(/<(?:\w+:)?author[^>]*>(.*)/);u&&r.push(u[1])}});var l=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return l&&l[1]&&l[1].split(/<\/\w*:?comment>/).forEach(function(c){if(!(c===""||c.trim()==="")){var u=c.match(/<(?:\w+:)?comment[^>]*>/);if(u){var h=mt(u[0]),d={author:h.authorId&&r[h.authorId]||"sheetjsghost",ref:h.ref,guid:h.guid},g=pr(h.ref);if(!(t.sheetRows&&t.sheetRows<=g.r)){var x=c.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),y=!!x&&!!x[1]&&Xm(x[1])||{r:"",t:"",h:""};d.r=y.r,y.r=="<t></t>"&&(y.t=y.h=""),d.t=(y.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(d.h=y.h),a.push(d)}}}}),a}function z2(e){var t=[Cr,Ue("comments",null,{xmlns:sl[0]})],r=[];return t.push("<authors>"),e.forEach(function(a){a[1].forEach(function(s){var l=Kt(s.a);r.indexOf(l)==-1&&(r.push(l),t.push("<author>"+l+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),t.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(a){var s=0,l=[];if(a[1][0]&&a[1][0].T&&a[1][0].ID?s=r.indexOf("tc="+a[1][0].ID):a[1].forEach(function(h){h.a&&(s=r.indexOf(Kt(h.a))),l.push(h.t||"")}),t.push('<comment ref="'+a[0]+'" authorId="'+s+'"><text>'),l.length<=1)t.push(oa("t",Kt(l[0]||"")));else{for(var c=`Comment:
    `+l[0]+`
`,u=1;u<l.length;++u)c+=`Reply:
    `+l[u]+`
`;t.push(oa("t",Kt(c)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function b8(e,t){var r=[],a=!1,s={},l=0;return e.replace(_a,function(u,h){var d=mt(u);switch(Yn(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":l=h+u.length;break;case"</text>":s.t=e.slice(l,h).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":a=!0;break;case"</mentions>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return u}),r}function S8(e,t,r){var a=[Cr,Ue("ThreadedComments",null,{xmlns:zr.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var l="";(s[1]||[]).forEach(function(c,u){if(!c.T){delete c.ID;return}c.a&&t.indexOf(c.a)==-1&&t.push(c.a);var h={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};u==0?l=h.id:h.parentId=l,c.ID=h.id,c.a&&(h.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(c.a)).slice(-12)+"}"),a.push(Ue("threadedComment",oa("text",c.t||""),h))})}),a.push("</ThreadedComments>"),a.join("")}function E8(e,t){var r=[],a=!1;return e.replace(_a,function(l){var c=mt(l);switch(Yn(c[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:c.displayname,id:c.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return l}),r}function T8(e){var t=[Cr,Ue("personList",null,{xmlns:zr.TCMNT,"xmlns:x":sl[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,a){t.push(Ue("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+a).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function k8(e){var t={};t.iauthor=e.read_shift(4);var r=cl(e);return t.rfx=r.s,t.ref=ht(r.s),e.l+=16,t}function A8(e,t){return t==null&&(t=_e(36)),t.write_shift(4,e[1].iauthor),To(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var C8=va;function N8(e){return Jr(e.slice(0,54))}function O8(e,t){var r=[],a=[],s={},l=!1;return As(e,function(u,h,d){switch(d){case 632:a.push(u);break;case 635:s=u;break;case 637:s.t=u.t,s.h=u.h,s.r=u.r;break;case 636:if(s.author=a[s.iauthor],delete s.iauthor,t.sheetRows&&s.rfx&&t.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!h.T){if(!l||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),r}function R8(e){var t=Ba(),r=[];return Ne(t,628),Ne(t,630),e.forEach(function(a){a[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),Ne(t,632,N8(s.a)))})}),Ne(t,631),Ne(t,633),e.forEach(function(a){a[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var l={s:pr(a[0]),e:pr(a[0])};Ne(t,635,A8([l,s])),s.t&&s.t.length>0&&Ne(t,637,ZA(s)),Ne(t,636),delete s.iauthor})}),Ne(t,634),Ne(t,629),t.end()}var D8="application/vnd.ms-office.vbaProject";function F8(e){var t=lt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,a){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");lt.utils.cfb_add(t,s,e.FileIndex[a].content)}}),lt.write(t)}function M8(e,t){t.FullPaths.forEach(function(r,a){if(a!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&lt.utils.cfb_add(e,s,t.FileIndex[a].content)}})}var H2=["xlsb","xlsm","xlam","biff8","xla"];function j8(){return{"!type":"dialog"}}function I8(){return{"!type":"dialog"}}function L8(){return{"!type":"macro"}}function B8(){return{"!type":"macro"}}var go=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(a,s,l,c){var u=!1,h=!1;l.length==0?h=!0:l.charAt(0)=="["&&(h=!0,l=l.slice(1,-1)),c.length==0?u=!0:c.charAt(0)=="["&&(u=!0,c=c.slice(1,-1));var d=l.length>0?parseInt(l,10)|0:0,g=c.length>0?parseInt(c,10)|0:0;return u?g+=t.c:--g,h?d+=t.r:--d,s+(u?"":"$")+gr(g)+(h?"":"$")+Ar(d)}return function(s,l){return t=l,s.replace(e,r)}})(),Jm=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Qm=(function(){return function(t,r){return t.replace(Jm,function(a,s,l,c,u,h){var d=Bm(c)-(l?0:r.c),g=Lm(h)-(u?0:r.r),x=g==0?"":u?g+1:"["+g+"]",y=d==0?"":l?d+1:"["+d+"]";return s+"R"+x+"C"+y})}})();function $2(e,t){return e.replace(Jm,function(r,a,s,l,c,u){return a+(s=="$"?s+l:gr(Bm(l)+t.c))+(c=="$"?c+u:Ar(Lm(u)+t.r))})}function U8(e,t,r){var a=Ua(t),s=a.s,l=pr(r),c={r:l.r-s.r,c:l.c-s.c};return $2(e,c)}function P8(e){return e.length!=1}function Ey(e){return e.replace(/_xlfn\./g,"")}function Mr(e){e.l+=1}function ui(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function V2(e,t,r){var a=2;if(r){if(r.biff>=2&&r.biff<=5)return G2(e);r.biff==12&&(a=4)}var s=e.read_shift(a),l=e.read_shift(a),c=ui(e),u=ui(e);return{s:{r:s,c:c[0],cRel:c[1],rRel:c[2]},e:{r:l,c:u[0],cRel:u[1],rRel:u[2]}}}function G2(e){var t=ui(e),r=ui(e),a=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:a,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function z8(e,t,r){if(r.biff<8)return G2(e);var a=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),l=ui(e),c=ui(e);return{s:{r:a,c:l[0],cRel:l[1],rRel:l[2]},e:{r:s,c:c[0],cRel:c[1],rRel:c[2]}}}function q2(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return H8(e);var a=e.read_shift(r&&r.biff==12?4:2),s=ui(e);return{r:a,c:s[0],cRel:s[1],rRel:s[2]}}function H8(e){var t=ui(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function $8(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function V8(e,t,r){var a=r&&r.biff?r.biff:8;if(a>=2&&a<=5)return G8(e);var s=e.read_shift(a>=12?4:2),l=e.read_shift(2),c=(l&16384)>>14,u=(l&32768)>>15;if(l&=16383,u==1)for(;s>524287;)s-=1048576;if(c==1)for(;l>8191;)l=l-16384;return{r:s,c:l,cRel:c,rRel:u}}function G8(e){var t=e.read_shift(2),r=e.read_shift(1),a=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,a==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:a}}function q8(e,t,r){var a=(e[e.l++]&96)>>5,s=V2(e,r.biff>=2&&r.biff<=5?6:8,r);return[a,s]}function X8(e,t,r){var a=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),l=8;if(r)switch(r.biff){case 5:e.l+=12,l=6;break;case 12:l=12;break}var c=V2(e,l,r);return[a,s,c]}function W8(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[a]}function K8(e,t,r){var a=(e[e.l++]&96)>>5,s=e.read_shift(2),l=8;if(r)switch(r.biff){case 5:e.l+=12,l=6;break;case 12:l=12;break}return e.l+=l,[a,s]}function Y8(e,t,r){var a=(e[e.l++]&96)>>5,s=z8(e,t-1,r);return[a,s]}function J8(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[a]}function Ty(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function Q8(e,t,r){e.l+=2;for(var a=e.read_shift(r&&r.biff==2?1:2),s=[],l=0;l<=a;++l)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function Z8(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function eO(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function tO(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function rO(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[a]}function X2(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function aO(e){return e.read_shift(2),X2(e)}function nO(e){return e.read_shift(2),X2(e)}function sO(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=q2(e,0,r);return[a,s]}function iO(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=V8(e,0,r);return[a,s]}function lO(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var l=q2(e,0,r);return[a,s,l]}function oO(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[f5[s],Y2[s],a]}function cO(e,t,r){var a=e[e.l++],s=e.read_shift(1),l=r&&r.biff<=3?[a==88?-1:0,e.read_shift(1)]:uO(e);return[s,(l[0]===0?Y2:u5)[l[1]]]}function uO(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function fO(e,t,r){e.l+=r&&r.biff==2?3:4}function hO(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var a=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[a,s]}function dO(e){return e.l++,Cs[e.read_shift(1)]}function mO(e){return e.l++,e.read_shift(2)}function gO(e){return e.l++,e.read_shift(1)!==0}function pO(e){return e.l++,xa(e)}function xO(e,t,r){return e.l++,su(e,t-1,r)}function vO(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=kr(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Cs[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=xa(e);break;case 2:r[1]=ul(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function yO(e,t,r){for(var a=e.read_shift(r.biff==12?4:2),s=[],l=0;l!=a;++l)s.push((r.biff==12?cl:df)(e));return s}function _O(e,t,r){var a=0,s=0;r.biff==12?(a=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),a=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--a,--s==0&&(s=256));for(var l=0,c=[];l!=a&&(c[l]=[]);++l)for(var u=0;u!=s;++u)c[l][u]=vO(e,r.biff);return c}function wO(e,t,r){var a=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,l=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[a,0,l]}function bO(e,t,r){if(r.biff==5)return SO(e);var a=e.read_shift(1)>>>5&3,s=e.read_shift(2),l=e.read_shift(4);return[a,s,l]}function SO(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var a=e.read_shift(2);return e.l+=12,[t,r,a]}function EO(e,t,r){var a=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[a,s]}function TO(e,t,r){var a=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[a,s]}function kO(e,t,r){var a=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[a]}function AO(e,t,r){var a=(e[e.l++]&96)>>5,s=e.read_shift(2),l=4;if(r)switch(r.biff){case 5:l=15;break;case 12:l=6;break}return e.l+=l,[a,s]}var CO=ya,NO=ya,OO=ya;function lu(e,t,r){return e.l+=2,[$8(e)]}function Zm(e){return e.l+=6,[]}var RO=lu,DO=Zm,FO=Zm,MO=lu;function W2(e){return e.l+=2,[Ir(e),e.read_shift(2)&1]}var jO=lu,IO=W2,LO=Zm,BO=lu,UO=lu,PO=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function zO(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),s=e.read_shift(2),l=e.read_shift(2),c=PO[r>>2&31];return{ixti:t,coltype:r&3,rt:c,idx:a,c:s,C:l}}function HO(e){return e.l+=2,[e.read_shift(4)]}function $O(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function VO(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function GO(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function qO(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function XO(e){return e.l+=4,[0,0]}var ky={1:{n:"PtgExp",f:hO},2:{n:"PtgTbl",f:OO},3:{n:"PtgAdd",f:Mr},4:{n:"PtgSub",f:Mr},5:{n:"PtgMul",f:Mr},6:{n:"PtgDiv",f:Mr},7:{n:"PtgPower",f:Mr},8:{n:"PtgConcat",f:Mr},9:{n:"PtgLt",f:Mr},10:{n:"PtgLe",f:Mr},11:{n:"PtgEq",f:Mr},12:{n:"PtgGe",f:Mr},13:{n:"PtgGt",f:Mr},14:{n:"PtgNe",f:Mr},15:{n:"PtgIsect",f:Mr},16:{n:"PtgUnion",f:Mr},17:{n:"PtgRange",f:Mr},18:{n:"PtgUplus",f:Mr},19:{n:"PtgUminus",f:Mr},20:{n:"PtgPercent",f:Mr},21:{n:"PtgParen",f:Mr},22:{n:"PtgMissArg",f:Mr},23:{n:"PtgStr",f:xO},26:{n:"PtgSheet",f:$O},27:{n:"PtgEndSheet",f:VO},28:{n:"PtgErr",f:dO},29:{n:"PtgBool",f:gO},30:{n:"PtgInt",f:mO},31:{n:"PtgNum",f:pO},32:{n:"PtgArray",f:J8},33:{n:"PtgFunc",f:oO},34:{n:"PtgFuncVar",f:cO},35:{n:"PtgName",f:wO},36:{n:"PtgRef",f:sO},37:{n:"PtgArea",f:q8},38:{n:"PtgMemArea",f:EO},39:{n:"PtgMemErr",f:CO},40:{n:"PtgMemNoMem",f:NO},41:{n:"PtgMemFunc",f:TO},42:{n:"PtgRefErr",f:kO},43:{n:"PtgAreaErr",f:W8},44:{n:"PtgRefN",f:iO},45:{n:"PtgAreaN",f:Y8},46:{n:"PtgMemAreaN",f:GO},47:{n:"PtgMemNoMemN",f:qO},57:{n:"PtgNameX",f:bO},58:{n:"PtgRef3d",f:lO},59:{n:"PtgArea3d",f:X8},60:{n:"PtgRefErr3d",f:AO},61:{n:"PtgAreaErr3d",f:K8},255:{}},WO={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},KO={1:{n:"PtgElfLel",f:W2},2:{n:"PtgElfRw",f:BO},3:{n:"PtgElfCol",f:RO},6:{n:"PtgElfRwV",f:UO},7:{n:"PtgElfColV",f:MO},10:{n:"PtgElfRadical",f:jO},11:{n:"PtgElfRadicalS",f:LO},13:{n:"PtgElfColS",f:DO},15:{n:"PtgElfColSV",f:FO},16:{n:"PtgElfRadicalLel",f:IO},25:{n:"PtgList",f:zO},29:{n:"PtgSxName",f:HO},255:{}},YO={0:{n:"PtgAttrNoop",f:XO},1:{n:"PtgAttrSemi",f:rO},2:{n:"PtgAttrIf",f:eO},4:{n:"PtgAttrChoose",f:Q8},8:{n:"PtgAttrGoto",f:Z8},16:{n:"PtgAttrSum",f:fO},32:{n:"PtgAttrBaxcel",f:Ty},33:{n:"PtgAttrBaxcel",f:Ty},64:{n:"PtgAttrSpace",f:aO},65:{n:"PtgAttrSpaceSemi",f:nO},128:{n:"PtgAttrIfError",f:tO},255:{}};function ou(e,t,r,a){if(a.biff<8)return ya(e,t);for(var s=e.l+t,l=[],c=0;c!==r.length;++c)switch(r[c][0]){case"PtgArray":r[c][1]=_O(e,0,a),l.push(r[c][1]);break;case"PtgMemArea":r[c][2]=yO(e,r[c][1],a),l.push(r[c][2]);break;case"PtgExp":a&&a.biff==12&&(r[c][1][1]=e.read_shift(4),l.push(r[c][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[c][0]}return t=s-e.l,t!==0&&l.push(ya(e,t)),l}function cu(e,t,r){for(var a=e.l+t,s,l,c=[];a!=e.l;)t=a-e.l,l=e[e.l],s=ky[l]||ky[WO[l]],(l===24||l===25)&&(s=(l===24?KO:YO)[e[e.l+1]]),!s||!s.f?ya(e,t):c.push([s.n,s.f(e,t,r)]);return c}function JO(e){for(var t=[],r=0;r<e.length;++r){for(var a=e[r],s=[],l=0;l<a.length;++l){var c=a[l];c?c[0]===2?s.push('"'+c[1].replace(/"/g,'""')+'"'):s.push(c[1]):s.push("")}t.push(s.join(","))}return t.join(";")}var QO={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function ZO(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function K2(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var a=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!a)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[a[0]][0]){case 357:return s=a[1]==-1?"#REF":e.SheetNames[a[1]],a[1]==a[2]?s:s+":"+e.SheetNames[a[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[a[0]][0];default:return"SH33TJSSRC"+e[a[0]][0]}switch(e[a[0]][0][0]){case 1025:return s=a[1]==-1?"#REF":e.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?s:s+":"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map(function(l){return l.Name}).join(";;");default:return e[a[0]][0][3]?(s=a[1]==-1?"#REF":e[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?s:s+":"+e[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function Ay(e,t,r){var a=K2(e,t,r);return a=="#REF"?a:ZO(a,r)}function ga(e,t,r,a,s){var l=s&&s.biff||8,c={s:{c:0,r:0}},u=[],h,d,g,x=0,y=0,_,b="";if(!e[0]||!e[0][0])return"";for(var w=-1,S="",k=0,C=e[0].length;k<C;++k){var T=e[0][k];switch(T[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(h=u.pop(),d=u.pop(),w>=0){switch(e[0][w][1][0]){case 0:S=_r(" ",e[0][w][1][1]);break;case 1:S=_r("\r",e[0][w][1][1]);break;default:if(S="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][w][1][0])}d=d+S,w=-1}u.push(d+QO[T[0]]+h);break;case"PtgIsect":h=u.pop(),d=u.pop(),u.push(d+" "+h);break;case"PtgUnion":h=u.pop(),d=u.pop(),u.push(d+","+h);break;case"PtgRange":h=u.pop(),d=u.pop(),u.push(d+":"+h);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":g=Ac(T[1][1],c,s),u.push(Cc(g,l));break;case"PtgRefN":g=r?Ac(T[1][1],r,s):T[1][1],u.push(Cc(g,l));break;case"PtgRef3d":x=T[1][1],g=Ac(T[1][2],c,s),b=Ay(a,x,s),u.push(b+"!"+Cc(g,l));break;case"PtgFunc":case"PtgFuncVar":var j=T[1][0],X=T[1][1];j||(j=0),j&=127;var D=j==0?[]:u.slice(-j);u.length-=j,X==="User"&&(X=D.shift()),u.push(X+"("+D.join(",")+")");break;case"PtgBool":u.push(T[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(T[1]);break;case"PtgNum":u.push(String(T[1]));break;case"PtgStr":u.push('"'+T[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(T[1]);break;case"PtgAreaN":_=ry(T[1][1],r?{s:r}:c,s),u.push(Fd(_,s));break;case"PtgArea":_=ry(T[1][1],c,s),u.push(Fd(_,s));break;case"PtgArea3d":x=T[1][1],_=T[1][2],b=Ay(a,x,s),u.push(b+"!"+Fd(_,s));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":y=T[1][2];var N=(a.names||[])[y-1]||(a[0]||[])[y],W=N?N.Name:"SH33TJSNAME"+String(y);W&&W.slice(0,6)=="_xlfn."&&!s.xlfn&&(W=W.slice(6)),u.push(W);break;case"PtgNameX":var P=T[1][1];y=T[1][2];var re;if(s.biff<=5)P<0&&(P=-P),a[P]&&(re=a[P][y]);else{var ae="";if(((a[P]||[])[0]||[])[0]==14849||(((a[P]||[])[0]||[])[0]==1025?a[P][y]&&a[P][y].itab>0&&(ae=a.SheetNames[a[P][y].itab-1]+"!"):ae=a.SheetNames[y-1]+"!"),a[P]&&a[P][y])ae+=a[P][y].Name;else if(a[0]&&a[0][y])ae+=a[0][y].Name;else{var Q=(K2(a,P,s)||"").split(";;");Q[y-1]?ae=Q[y-1]:ae+="SH33TJSERRX"}u.push(ae);break}re||(re={Name:"SH33TJSERRY"}),u.push(re.Name);break;case"PtgParen":var xe="(",Oe=")";if(w>=0){switch(S="",e[0][w][1][0]){case 2:xe=_r(" ",e[0][w][1][1])+xe;break;case 3:xe=_r("\r",e[0][w][1][1])+xe;break;case 4:Oe=_r(" ",e[0][w][1][1])+Oe;break;case 5:Oe=_r("\r",e[0][w][1][1])+Oe;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][w][1][0])}w=-1}u.push(xe+u.pop()+Oe);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":g={c:T[1][1],r:T[1][0]};var Ae={c:r.c,r:r.r};if(a.sharedf[ht(g)]){var K=a.sharedf[ht(g)];u.push(ga(K,c,Ae,a,s))}else{var le=!1;for(h=0;h!=a.arrayf.length;++h)if(d=a.arrayf[h],!(g.c<d[0].s.c||g.c>d[0].e.c)&&!(g.r<d[0].s.r||g.r>d[0].e.r)){u.push(ga(d[1],c,Ae,a,s)),le=!0;break}le||u.push(T[1])}break;case"PtgArray":u.push("{"+JO(T[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":w=k;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+T[1].idx+"[#"+T[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(T));default:throw new Error("Unrecognized Formula Token: "+String(T))}var je=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&w>=0&&je.indexOf(e[0][k][0])==-1){T=e[0][w];var U=!0;switch(T[1][0]){case 4:U=!1;case 0:S=_r(" ",T[1][1]);break;case 5:U=!1;case 1:S=_r("\r",T[1][1]);break;default:if(S="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+T[1][0])}u.push((U?S:"")+u.pop()+(U?"":S)),w=-1}}if(u.length>1&&s.WTF)throw new Error("bad formula stack");return u[0]}function e5(e,t,r){var a=e.l+t,s=r.biff==2?1:2,l,c=e.read_shift(s);if(c==65535)return[[],ya(e,t-2)];var u=cu(e,c,r);return t!==c+s&&(l=ou(e,t-c-s,u,r)),e.l=a,[u,l]}function t5(e,t,r){var a=e.l+t,s=r.biff==2?1:2,l,c=e.read_shift(s);if(c==65535)return[[],ya(e,t-2)];var u=cu(e,c,r);return t!==c+s&&(l=ou(e,t-c-s,u,r)),e.l=a,[u,l]}function r5(e,t,r,a){var s=e.l+t,l=cu(e,a,r),c;return s!==e.l&&(c=ou(e,s-e.l,l,r)),[l,c]}function a5(e,t,r){var a=e.l+t,s,l=e.read_shift(2),c=cu(e,l,r);return l==65535?[[],ya(e,t-2)]:(t!==l+2&&(s=ou(e,a-l-2,c,r)),[c,s])}function n5(e){var t;if(_s(e,e.l+6)!==65535)return[xa(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function s5(e){if(e==null){var t=_e(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Qi(e);return Qi(0)}function Bd(e,t,r){var a=e.l+t,s=Jn(e);r.biff==2&&++e.l;var l=n5(e),c=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var u=t5(e,a-e.l,r);return{cell:s,val:l[0],formula:u,shared:c>>3&1,tt:l[1]}}function i5(e,t,r,a,s){var l=el(t,r,s),c=s5(e.v),u=_e(6),h=33;u.write_shift(2,h),u.write_shift(4,0);for(var d=_e(e.bf.length),g=0;g<e.bf.length;++g)d[g]=e.bf[g];var x=Yr([l,c,u,d]);return x}function mf(e,t,r){var a=e.read_shift(4),s=cu(e,a,r),l=e.read_shift(4),c=l>0?ou(e,l,s,r):null;return[s,c]}var l5=mf,gf=mf,o5=mf,c5=mf,u5={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Y2={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},f5={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Cy(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function h5(e){var t="of:="+e.replace(Jm,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Ud(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function d5(e){return e.replace(/\./,"!")}var Oc={},po={},Rc=typeof Map<"u";function e1(e,t,r){var a=0,s=e.length;if(r){if(Rc?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var l=Rc?r.get(t):r[t];a<l.length;++a)if(e[l[a]].t===t)return e.Count++,l[a]}}else for(;a<s;++a)if(e[a].t===t)return e.Count++,a;return e[s]={t},e.Count++,e.Unique++,r&&(Rc?(r.has(t)||r.set(t,[]),r.get(t).push(s)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(s))),s}function pf(e,t){var r={min:e+1,max:e+1},a=-1;return t.MDW&&(pa=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?a=Kc(t.wpx):t.wch!=null&&(a=t.wch),a>-1?(r.width=tf(a),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Wi(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function mi(e,t,r){var a=r.revssf[t.z!=null?t.z:"General"],s=60,l=e.length;if(a==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){bs(t.z,s),r.ssf[s]=t.z,r.revssf[t.z]=a=s;break}}for(s=0;s!=l;++s)if(e[s].numFmtId===a)return s;return e[l]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},l}function J2(e,t,r,a,s,l){try{a.cellNF&&(e.z=ft[t])}catch(u){if(a.WTF)throw u}if(!(e.t==="z"&&!a.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=ur(e.v)),(!a||a.cellText!==!1)&&e.t!=="z")try{if(ft[t]==null&&bs(uA[t]||"General",t),e.t==="e")e.w=e.w||Cs[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Hc(e.v);else if(e.t==="d"){var c=Hr(e.v);(c|0)===c?e.w=c.toString(10):e.w=Hc(c)}else{if(e.v===void 0)return"";e.w=Yi(e.v,po)}else e.t==="d"?e.w=wn(t,Hr(e.v),po):e.w=wn(t,e.v,po)}catch(u){if(a.WTF)throw u}if(a.cellStyles&&r!=null)try{e.s=l.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=ef(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),a.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=ef(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),a.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(u){if(a.WTF&&l.Fills)throw u}}}function m5(e,t,r){if(e&&e["!ref"]){var a=Mt(e["!ref"]);if(a.e.c<a.s.c||a.e.r<a.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function g5(e,t){var r=Mt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=_t(r))}var p5=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,x5=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,v5=/<(?:\w:)?hyperlink [^>]*>/mg,y5=/"(\w*:\w*)"/,_5=/<(?:\w:)?col\b[^>]*[\/]?>/g,w5=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,b5=/<(?:\w:)?pageMargins[^>]*\/>/g,Q2=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,S5=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,E5=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function T5(e,t,r,a,s,l,c){if(!e)return e;a||(a={"!id":{}});var u=t.dense?[]:{},h={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",g="",x=e.match(x5);x?(d=e.slice(0,x.index),g=e.slice(x.index+x[0].length)):d=g=e;var y=d.match(Q2);y?t1(y[0],u,s,r):(y=d.match(S5))&&A5(y[0],y[1]||"",u,s,r);var _=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(_>0){var b=d.slice(_,_+50).match(y5);b&&g5(u,b[1])}var w=d.match(E5);w&&w[1]&&P5(w[1],s);var S=[];if(t.cellStyles){var k=d.match(_5);k&&j5(S,k)}x&&$5(x[1],u,t,h,l,c);var C=g.match(w5);C&&(u["!autofilter"]=L5(C[0]));var T=[],j=g.match(p5);if(j)for(_=0;_!=j.length;++_)T[_]=Mt(j[_].slice(j[_].indexOf('"')+1));var X=g.match(v5);X&&D5(u,X,a);var D=g.match(b5);if(D&&(u["!margins"]=F5(mt(D[0]))),!u["!ref"]&&h.e.c>=h.s.c&&h.e.r>=h.s.r&&(u["!ref"]=_t(h)),t.sheetRows>0&&u["!ref"]){var N=Mt(u["!ref"]);t.sheetRows<=+N.e.r&&(N.e.r=t.sheetRows-1,N.e.r>h.e.r&&(N.e.r=h.e.r),N.e.r<N.s.r&&(N.s.r=N.e.r),N.e.c>h.e.c&&(N.e.c=h.e.c),N.e.c<N.s.c&&(N.s.c=N.e.c),u["!fullref"]=u["!ref"],u["!ref"]=_t(N))}return S.length>0&&(u["!cols"]=S),T.length>0&&(u["!merges"]=T),u}function k5(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+_t(e[r])+'"/>';return t+"</mergeCells>"}function t1(e,t,r,a){var s=mt(e);r.Sheets[a]||(r.Sheets[a]={}),s.codeName&&(r.Sheets[a].CodeName=Ft(rr(s.codeName)))}function A5(e,t,r,a,s){t1(e.slice(0,e.indexOf(">")),r,a,s)}function C5(e,t,r,a,s){var l=!1,c={},u=null;if(a.bookType!=="xlsx"&&t.vbaraw){var h=t.SheetNames[r];try{t.Workbook&&(h=t.Workbook.Sheets[r].CodeName||h)}catch{}l=!0,c.codeName=Kn(Kt(h))}if(e&&e["!outline"]){var d={summaryBelow:1,summaryRight:1};e["!outline"].above&&(d.summaryBelow=0),e["!outline"].left&&(d.summaryRight=0),u=(u||"")+Ue("outlinePr",null,d)}!l&&!u||(s[s.length]=Ue("sheetPr",u,c))}var N5=["objects","scenarios","selectLockedCells","selectUnlockedCells"],O5=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function R5(e){var t={sheet:1};return N5.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),O5.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=Wm(e.password).toString(16).toUpperCase()),Ue("sheetProtection",null,t)}function D5(e,t,r){for(var a=Array.isArray(e),s=0;s!=t.length;++s){var l=mt(rr(t[s]),!0);if(!l.ref)return;var c=((r||{})["!id"]||[])[l.id];c?(l.Target=c.Target,l.location&&(l.Target+="#"+Ft(l.location))):(l.Target="#"+Ft(l.location),c={Target:l.Target,TargetMode:"Internal"}),l.Rel=c,l.tooltip&&(l.Tooltip=l.tooltip,delete l.tooltip);for(var u=Mt(l.ref),h=u.s.r;h<=u.e.r;++h)for(var d=u.s.c;d<=u.e.c;++d){var g=ht({c:d,r:h});a?(e[h]||(e[h]=[]),e[h][d]||(e[h][d]={t:"z",v:void 0}),e[h][d].l=l):(e[g]||(e[g]={t:"z",v:void 0}),e[g].l=l)}}}function F5(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function M5(e){return Wi(e),Ue("pageMargins",null,e)}function j5(e,t){for(var r=!1,a=0;a!=t.length;++a){var s=mt(t[a],!0);s.hidden&&(s.hidden=cr(s.hidden));var l=parseInt(s.min,10)-1,c=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,Km(s.width)),ci(s);l<=c;)e[l++]=fr(s)}}function I5(e,t){for(var r=["<cols>"],a,s=0;s!=t.length;++s)(a=t[s])&&(r[r.length]=Ue("col",null,pf(s,a)));return r[r.length]="</cols>",r.join("")}function L5(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function B5(e,t,r,a){var s=typeof e.ref=="string"?e.ref:_t(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var l=r.Workbook.Names,c=Ua(s);c.s.r==c.e.r&&(c.e.r=Ua(t["!ref"]).e.r,s=_t(c));for(var u=0;u<l.length;++u){var h=l[u];if(h.Name=="_xlnm._FilterDatabase"&&h.Sheet==a){h.Ref="'"+r.SheetNames[a]+"'!"+s;break}}return u==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+s}),Ue("autoFilter",null,{ref:s})}var U5=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function P5(e,t){t.Views||(t.Views=[{}]),(e.match(U5)||[]).forEach(function(r,a){var s=mt(r);t.Views[a]||(t.Views[a]={}),+s.zoomScale&&(t.Views[a].zoom=+s.zoomScale),cr(s.rightToLeft)&&(t.Views[a].RTL=!0)})}function z5(e,t,r,a){var s={workbookViewId:"0"};return(((a||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=a.Workbook.Views[0].RTL?"1":"0"),Ue("sheetViews",Ue("sheetView",null,s),{})}function H5(e,t,r,a){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",l=e.t,c=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=Cs[e.v];break;case"d":a&&a.cellDates?s=ur(e.v,-1).toISOString():(e=fr(e),e.t="n",s=""+(e.v=Hr(ur(e.v)))),typeof e.z>"u"&&(e.z=ft[14]);break;default:s=e.v;break}var u=oa("v",Kt(s)),h={r:t},d=mi(a.cellXfs,e,a);switch(d!==0&&(h.s=d),e.t){case"n":break;case"d":h.t="d";break;case"b":h.t="b";break;case"e":h.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(a&&a.bookSST){u=oa("v",""+e1(a.Strings,e.v,a.revStrings)),h.t="s";break}h.t="str";break}if(e.t!=l&&(e.t=l,e.v=c),typeof e.f=="string"&&e.f){var g=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;u=Ue("f",Kt(e.f),g)+(e.v!=null?u:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(h.cm=1),Ue("c",u,h)}var $5=(function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,l=$c("v"),c=$c("f");return function(h,d,g,x,y,_){for(var b=0,w="",S=[],k=[],C=0,T=0,j=0,X="",D,N,W=0,P=0,re,ae,Q=0,xe=0,Oe=Array.isArray(_.CellXf),Ae,K=[],le=[],je=Array.isArray(d),U=[],ve={},G=!1,A=!!g.sheetStubs,z=h.split(t),I=0,L=z.length;I!=L;++I){w=z[I].trim();var te=w.length;if(te!==0){var me=0;e:for(b=0;b<te;++b)switch(w[b]){case">":if(w[b-1]!="/"){++b;break e}if(g&&g.cellStyles){if(N=mt(w.slice(me,b),!0),W=N.r!=null?parseInt(N.r,10):W+1,P=-1,g.sheetRows&&g.sheetRows<W)continue;ve={},G=!1,N.ht&&(G=!0,ve.hpt=parseFloat(N.ht),ve.hpx=wo(ve.hpt)),N.hidden=="1"&&(G=!0,ve.hidden=!0),N.outlineLevel!=null&&(G=!0,ve.level=+N.outlineLevel),G&&(U[W-1]=ve)}break;case"<":me=b;break}if(me>=b)break;if(N=mt(w.slice(me,b),!0),W=N.r!=null?parseInt(N.r,10):W+1,P=-1,!(g.sheetRows&&g.sheetRows<W)){x.s.r>W-1&&(x.s.r=W-1),x.e.r<W-1&&(x.e.r=W-1),g&&g.cellStyles&&(ve={},G=!1,N.ht&&(G=!0,ve.hpt=parseFloat(N.ht),ve.hpx=wo(ve.hpt)),N.hidden=="1"&&(G=!0,ve.hidden=!0),N.outlineLevel!=null&&(G=!0,ve.level=+N.outlineLevel),G&&(U[W-1]=ve)),S=w.slice(b).split(e);for(var ge=0;ge!=S.length&&S[ge].trim().charAt(0)=="<";++ge);for(S=S.slice(ge),b=0;b!=S.length;++b)if(w=S[b].trim(),w.length!==0){if(k=w.match(r),C=b,T=0,j=0,w="<c "+(w.slice(0,1)=="<"?">":"")+w,k!=null&&k.length===2){for(C=0,X=k[1],T=0;T!=X.length&&!((j=X.charCodeAt(T)-64)<1||j>26);++T)C=26*C+j;--C,P=C}else++P;for(T=0;T!=w.length&&w.charCodeAt(T)!==62;++T);if(++T,N=mt(w.slice(0,T),!0),N.r||(N.r=ht({r:W-1,c:P})),X=w.slice(T),D={t:""},(k=X.match(l))!=null&&k[1]!==""&&(D.v=Ft(k[1])),g.cellFormula){if((k=X.match(c))!=null&&k[1]!==""){if(D.f=Ft(rr(k[1])).replace(/\r\n/g,`
`),g.xlfn||(D.f=Ey(D.f)),k[0].indexOf('t="array"')>-1)D.F=(X.match(s)||[])[1],D.F.indexOf(":")>-1&&K.push([Mt(D.F),D.F]);else if(k[0].indexOf('t="shared"')>-1){ae=mt(k[0]);var pe=Ft(rr(k[1]));g.xlfn||(pe=Ey(pe)),le[parseInt(ae.si,10)]=[ae,pe,N.r]}}else(k=X.match(/<f[^>]*\/>/))&&(ae=mt(k[0]),le[ae.si]&&(D.f=U8(le[ae.si][1],le[ae.si][2],N.r)));var Ee=pr(N.r);for(T=0;T<K.length;++T)Ee.r>=K[T][0].s.r&&Ee.r<=K[T][0].e.r&&Ee.c>=K[T][0].s.c&&Ee.c<=K[T][0].e.c&&(D.F=K[T][1])}if(N.t==null&&D.v===void 0)if(D.f||D.F)D.v=0,D.t="n";else if(A)D.t="z";else continue;else D.t=N.t||"n";switch(x.s.c>P&&(x.s.c=P),x.e.c<P&&(x.e.c=P),D.t){case"n":if(D.v==""||D.v==null){if(!A)continue;D.t="z"}else D.v=parseFloat(D.v);break;case"s":if(typeof D.v>"u"){if(!A)continue;D.t="z"}else re=Oc[parseInt(D.v,10)],D.v=re.t,D.r=re.r,g.cellHTML&&(D.h=re.h);break;case"str":D.t="s",D.v=D.v!=null?rr(D.v):"",g.cellHTML&&(D.h=Fm(D.v));break;case"inlineStr":k=X.match(a),D.t="s",k!=null&&(re=Xm(k[1]))?(D.v=re.t,g.cellHTML&&(D.h=re.h)):D.v="";break;case"b":D.v=cr(D.v);break;case"d":g.cellDates?D.v=ur(D.v,1):(D.v=Hr(ur(D.v,1)),D.t="n");break;case"e":(!g||g.cellText!==!1)&&(D.w=D.v),D.v=e2[D.v];break}if(Q=xe=0,Ae=null,Oe&&N.s!==void 0&&(Ae=_.CellXf[N.s],Ae!=null&&(Ae.numFmtId!=null&&(Q=Ae.numFmtId),g.cellStyles&&Ae.fillId!=null&&(xe=Ae.fillId))),J2(D,Q,xe,g,y,_),g.cellDates&&Oe&&D.t=="n"&&bo(ft[Q])&&(D.t="d",D.v=hf(D.v)),N.cm&&g.xlmeta){var et=(g.xlmeta.Cell||[])[+N.cm-1];et&&et.type=="XLDAPR"&&(D.D=!0)}if(je){var q=pr(N.r);d[q.r]||(d[q.r]=[]),d[q.r][q.c]=D}else d[N.r]=D}}}}U.length>0&&(d["!rows"]=U)}})();function V5(e,t,r,a){var s=[],l=[],c=Mt(e["!ref"]),u="",h,d="",g=[],x=0,y=0,_=e["!rows"],b=Array.isArray(e),w={r:d},S,k=-1;for(y=c.s.c;y<=c.e.c;++y)g[y]=gr(y);for(x=c.s.r;x<=c.e.r;++x){for(l=[],d=Ar(x),y=c.s.c;y<=c.e.c;++y){h=g[y]+d;var C=b?(e[x]||[])[y]:e[h];C!==void 0&&(u=H5(C,h,e,t))!=null&&l.push(u)}(l.length>0||_&&_[x])&&(w={r:d},_&&_[x]&&(S=_[x],S.hidden&&(w.hidden=1),k=-1,S.hpx?k=Yc(S.hpx):S.hpt&&(k=S.hpt),k>-1&&(w.ht=k,w.customHeight=1),S.level&&(w.outlineLevel=S.level)),s[s.length]=Ue("row",l.join(""),w))}if(_)for(;x<_.length;++x)_&&_[x]&&(w={r:x+1},S=_[x],S.hidden&&(w.hidden=1),k=-1,S.hpx?k=Yc(S.hpx):S.hpt&&(k=S.hpt),k>-1&&(w.ht=k,w.customHeight=1),S.level&&(w.outlineLevel=S.level),s[s.length]=Ue("row","",w));return s.join("")}function Z2(e,t,r,a){var s=[Cr,Ue("worksheet",null,{xmlns:sl[0],"xmlns:r":zr.r})],l=r.SheetNames[e],c=0,u="",h=r.Sheets[l];h==null&&(h={});var d=h["!ref"]||"A1",g=Mt(d);if(g.e.c>16383||g.e.r>1048575){if(t.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");g.e.c=Math.min(g.e.c,16383),g.e.r=Math.min(g.e.c,1048575),d=_t(g)}a||(a={}),h["!comments"]=[];var x=[];C5(h,r,e,t,s),s[s.length]=Ue("dimension",null,{ref:d}),s[s.length]=z5(h,t,e,r),t.sheetFormat&&(s[s.length]=Ue("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),h["!cols"]!=null&&h["!cols"].length>0&&(s[s.length]=I5(h,h["!cols"])),s[c=s.length]="<sheetData/>",h["!links"]=[],h["!ref"]!=null&&(u=V5(h,t),u.length>0&&(s[s.length]=u)),s.length>c+1&&(s[s.length]="</sheetData>",s[c]=s[c].replace("/>",">")),h["!protect"]&&(s[s.length]=R5(h["!protect"])),h["!autofilter"]!=null&&(s[s.length]=B5(h["!autofilter"],h,r,e)),h["!merges"]!=null&&h["!merges"].length>0&&(s[s.length]=k5(h["!merges"]));var y=-1,_,b=-1;return h["!links"].length>0&&(s[s.length]="<hyperlinks>",h["!links"].forEach(function(w){w[1].Target&&(_={ref:w[0]},w[1].Target.charAt(0)!="#"&&(b=Wt(a,-1,Kt(w[1].Target).replace(/#.*$/,""),At.HLINK),_["r:id"]="rId"+b),(y=w[1].Target.indexOf("#"))>-1&&(_.location=Kt(w[1].Target.slice(y+1))),w[1].Tooltip&&(_.tooltip=Kt(w[1].Tooltip)),s[s.length]=Ue("hyperlink",null,_))}),s[s.length]="</hyperlinks>"),delete h["!links"],h["!margins"]!=null&&(s[s.length]=M5(h["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(s[s.length]=oa("ignoredErrors",Ue("ignoredError",null,{numberStoredAsText:1,sqref:d}))),x.length>0&&(b=Wt(a,-1,"../drawings/drawing"+(e+1)+".xml",At.DRAW),s[s.length]=Ue("drawing",null,{"r:id":"rId"+b}),h["!drawing"]=x),h["!comments"].length>0&&(b=Wt(a,-1,"../drawings/vmlDrawing"+(e+1)+".vml",At.VML),s[s.length]=Ue("legacyDrawing",null,{"r:id":"rId"+b}),h["!legacy"]=b),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function G5(e,t){var r={},a=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var l=e.read_shift(1);return e.l=a,l&7&&(r.level=l&7),l&16&&(r.hidden=!0),l&32&&(r.hpt=s/20),r}function q5(e,t,r){var a=_e(145),s=(r["!rows"]||[])[e]||{};a.write_shift(4,e),a.write_shift(4,0);var l=320;s.hpx?l=Yc(s.hpx)*20:s.hpt&&(l=s.hpt*20),a.write_shift(2,l),a.write_shift(1,0);var c=0;s.level&&(c|=s.level),s.hidden&&(c|=16),(s.hpx||s.hpt)&&(c|=32),a.write_shift(1,c),a.write_shift(1,0);var u=0,h=a.l;a.l+=4;for(var d={r:e,c:0},g=0;g<16;++g)if(!(t.s.c>g+1<<10||t.e.c<g<<10)){for(var x=-1,y=-1,_=g<<10;_<g+1<<10;++_){d.c=_;var b=Array.isArray(r)?(r[d.r]||[])[d.c]:r[ht(d)];b&&(x<0&&(x=_),y=_)}x<0||(++u,a.write_shift(4,x),a.write_shift(4,y))}var w=a.l;return a.l=h,a.write_shift(4,u),a.l=w,a.length>a.l?a.slice(0,a.l):a}function X5(e,t,r,a){var s=q5(a,r,t);(s.length>17||(t["!rows"]||[])[a])&&Ne(e,0,s)}var W5=cl,K5=To;function Y5(){}function J5(e,t){var r={},a=e[e.l];return++e.l,r.above=!(a&64),r.left=!(a&128),e.l+=18,r.name=e3(e),r}function Q5(e,t,r){r==null&&(r=_e(84+4*e.length));var a=192;t&&(t.above&&(a&=-65),t.left&&(a&=-129)),r.write_shift(1,a);for(var s=1;s<3;++s)r.write_shift(1,0);return J0({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),K_(e,r),r.slice(0,r.l)}function Z5(e){var t=bn(e);return[t]}function eR(e,t,r){return r==null&&(r=_e(8)),il(t,r)}function tR(e){var t=ll(e);return[t]}function rR(e,t,r){return r==null&&(r=_e(4)),ol(t,r)}function aR(e){var t=bn(e),r=e.read_shift(1);return[t,r,"b"]}function nR(e,t,r){return r==null&&(r=_e(9)),il(t,r),r.write_shift(1,e.v?1:0),r}function sR(e){var t=ll(e),r=e.read_shift(1);return[t,r,"b"]}function iR(e,t,r){return r==null&&(r=_e(5)),ol(t,r),r.write_shift(1,e.v?1:0),r}function lR(e){var t=bn(e),r=e.read_shift(1);return[t,r,"e"]}function oR(e,t,r){return r==null&&(r=_e(9)),il(t,r),r.write_shift(1,e.v),r}function cR(e){var t=ll(e),r=e.read_shift(1);return[t,r,"e"]}function uR(e,t,r){return r==null&&(r=_e(8)),ol(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function fR(e){var t=bn(e),r=e.read_shift(4);return[t,r,"s"]}function hR(e,t,r){return r==null&&(r=_e(12)),il(t,r),r.write_shift(4,t.v),r}function dR(e){var t=ll(e),r=e.read_shift(4);return[t,r,"s"]}function mR(e,t,r){return r==null&&(r=_e(8)),ol(t,r),r.write_shift(4,t.v),r}function gR(e){var t=bn(e),r=xa(e);return[t,r,"n"]}function pR(e,t,r){return r==null&&(r=_e(16)),il(t,r),Qi(e.v,r),r}function ew(e){var t=ll(e),r=xa(e);return[t,r,"n"]}function xR(e,t,r){return r==null&&(r=_e(12)),ol(t,r),Qi(e.v,r),r}function vR(e){var t=bn(e),r=Hm(e);return[t,r,"n"]}function yR(e,t,r){return r==null&&(r=_e(12)),il(t,r),Y_(e.v,r),r}function _R(e){var t=ll(e),r=Hm(e);return[t,r,"n"]}function wR(e,t,r){return r==null&&(r=_e(8)),ol(t,r),Y_(e.v,r),r}function bR(e){var t=bn(e),r=Um(e);return[t,r,"is"]}function SR(e){var t=bn(e),r=va(e);return[t,r,"str"]}function ER(e,t,r){return r==null&&(r=_e(12+4*e.v.length)),il(t,r),Jr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function TR(e){var t=ll(e),r=va(e);return[t,r,"str"]}function kR(e,t,r){return r==null&&(r=_e(8+4*e.v.length)),ol(t,r),Jr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function AR(e,t,r){var a=e.l+t,s=bn(e);s.r=r["!row"];var l=e.read_shift(1),c=[s,l,"b"];if(r.cellFormula){e.l+=2;var u=gf(e,a-e.l,r);c[3]=ga(u,null,s,r.supbooks,r)}else e.l=a;return c}function CR(e,t,r){var a=e.l+t,s=bn(e);s.r=r["!row"];var l=e.read_shift(1),c=[s,l,"e"];if(r.cellFormula){e.l+=2;var u=gf(e,a-e.l,r);c[3]=ga(u,null,s,r.supbooks,r)}else e.l=a;return c}function NR(e,t,r){var a=e.l+t,s=bn(e);s.r=r["!row"];var l=xa(e),c=[s,l,"n"];if(r.cellFormula){e.l+=2;var u=gf(e,a-e.l,r);c[3]=ga(u,null,s,r.supbooks,r)}else e.l=a;return c}function OR(e,t,r){var a=e.l+t,s=bn(e);s.r=r["!row"];var l=va(e),c=[s,l,"str"];if(r.cellFormula){e.l+=2;var u=gf(e,a-e.l,r);c[3]=ga(u,null,s,r.supbooks,r)}else e.l=a;return c}var RR=cl,DR=To;function FR(e,t){return t==null&&(t=_e(4)),t.write_shift(4,e),t}function MR(e,t){var r=e.l+t,a=cl(e),s=Pm(e),l=va(e),c=va(e),u=va(e);e.l=r;var h={rfx:a,relId:s,loc:l,display:u};return c&&(h.Tooltip=c),h}function jR(e,t){var r=_e(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));To({s:pr(e[0]),e:pr(e[0])},r),zm("rId"+t,r);var a=e[1].Target.indexOf("#"),s=a==-1?"":e[1].Target.slice(a+1);return Jr(s||"",r),Jr(e[1].Tooltip||"",r),Jr("",r),r.slice(0,r.l)}function IR(){}function LR(e,t,r){var a=e.l+t,s=J_(e),l=e.read_shift(1),c=[s];if(c[2]=l,r.cellFormula){var u=l5(e,a-e.l,r);c[1]=u}else e.l=a;return c}function BR(e,t,r){var a=e.l+t,s=cl(e),l=[s];if(r.cellFormula){var c=c5(e,a-e.l,r);l[1]=c,e.l=a}else e.l=a;return l}function UR(e,t,r){r==null&&(r=_e(18));var a=pf(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(a.width||10)*256),r.write_shift(4,0);var s=0;return t.hidden&&(s|=1),typeof a.width=="number"&&(s|=2),t.level&&(s|=t.level<<8),r.write_shift(2,s),r}var tw=["left","right","top","bottom","header","footer"];function PR(e){var t={};return tw.forEach(function(r){t[r]=xa(e)}),t}function zR(e,t){return t==null&&(t=_e(48)),Wi(e),tw.forEach(function(r){Qi(e[r],t)}),t}function HR(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function $R(e,t,r){r==null&&(r=_e(30));var a=924;return(((t||{}).Views||[])[0]||{}).RTL&&(a|=32),r.write_shift(2,a),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function VR(e){var t=_e(24);return t.write_shift(4,4),t.write_shift(4,1),To(e,t),t}function GR(e,t){return t==null&&(t=_e(66)),t.write_shift(2,e.password?Wm(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function qR(){}function XR(){}function WR(e,t,r,a,s,l,c){if(!e)return e;var u=t||{};a||(a={"!id":{}});var h=u.dense?[]:{},d,g={s:{r:2e6,c:2e6},e:{r:0,c:0}},x=!1,y=!1,_,b,w,S,k,C,T,j,X,D=[];u.biff=12,u["!row"]=0;var N=0,W=!1,P=[],re={},ae=u.supbooks||s.supbooks||[[]];if(ae.sharedf=re,ae.arrayf=P,ae.SheetNames=s.SheetNames||s.Sheets.map(function(je){return je.name}),!u.supbooks&&(u.supbooks=ae,s.Names))for(var Q=0;Q<s.Names.length;++Q)ae[0][Q+1]=s.Names[Q];var xe=[],Oe=[],Ae=!1;Jc[16]={n:"BrtShortReal",f:ew};var K;if(As(e,function(U,ve,G){if(!y)switch(G){case 148:d=U;break;case 0:_=U,u.sheetRows&&u.sheetRows<=_.r&&(y=!0),j=Ar(S=_.r),u["!row"]=_.r,(U.hidden||U.hpt||U.level!=null)&&(U.hpt&&(U.hpx=wo(U.hpt)),Oe[U.r]=U);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(b={t:U[2]},U[2]){case"n":b.v=U[1];break;case"s":T=Oc[U[1]],b.v=T.t,b.r=T.r;break;case"b":b.v=!!U[1];break;case"e":b.v=U[1],u.cellText!==!1&&(b.w=Cs[b.v]);break;case"str":b.t="s",b.v=U[1];break;case"is":b.t="s",b.v=U[1].t;break}if((w=c.CellXf[U[0].iStyleRef])&&J2(b,w.numFmtId,null,u,l,c),k=U[0].c==-1?k+1:U[0].c,u.dense?(h[S]||(h[S]=[]),h[S][k]=b):h[gr(k)+j]=b,u.cellFormula){for(W=!1,N=0;N<P.length;++N){var A=P[N];_.r>=A[0].s.r&&_.r<=A[0].e.r&&k>=A[0].s.c&&k<=A[0].e.c&&(b.F=_t(A[0]),W=!0)}!W&&U.length>3&&(b.f=U[3])}if(g.s.r>_.r&&(g.s.r=_.r),g.s.c>k&&(g.s.c=k),g.e.r<_.r&&(g.e.r=_.r),g.e.c<k&&(g.e.c=k),u.cellDates&&w&&b.t=="n"&&bo(ft[w.numFmtId])){var z=Vi(b.v);z&&(b.t="d",b.v=new Date(z.y,z.m-1,z.d,z.H,z.M,z.S,z.u))}K&&(K.type=="XLDAPR"&&(b.D=!0),K=void 0);break;case 1:case 12:if(!u.sheetStubs||x)break;b={t:"z",v:void 0},k=U[0].c==-1?k+1:U[0].c,u.dense?(h[S]||(h[S]=[]),h[S][k]=b):h[gr(k)+j]=b,g.s.r>_.r&&(g.s.r=_.r),g.s.c>k&&(g.s.c=k),g.e.r<_.r&&(g.e.r=_.r),g.e.c<k&&(g.e.c=k),K&&(K.type=="XLDAPR"&&(b.D=!0),K=void 0);break;case 176:D.push(U);break;case 49:K=((u.xlmeta||{}).Cell||[])[U-1];break;case 494:var I=a["!id"][U.relId];for(I?(U.Target=I.Target,U.loc&&(U.Target+="#"+U.loc),U.Rel=I):U.relId==""&&(U.Target="#"+U.loc),S=U.rfx.s.r;S<=U.rfx.e.r;++S)for(k=U.rfx.s.c;k<=U.rfx.e.c;++k)u.dense?(h[S]||(h[S]=[]),h[S][k]||(h[S][k]={t:"z",v:void 0}),h[S][k].l=U):(C=ht({c:k,r:S}),h[C]||(h[C]={t:"z",v:void 0}),h[C].l=U);break;case 426:if(!u.cellFormula)break;P.push(U),X=u.dense?h[S][k]:h[gr(k)+j],X.f=ga(U[1],g,{r:_.r,c:k},ae,u),X.F=_t(U[0]);break;case 427:if(!u.cellFormula)break;re[ht(U[0].s)]=U[1],X=u.dense?h[S][k]:h[gr(k)+j],X.f=ga(U[1],g,{r:_.r,c:k},ae,u);break;case 60:if(!u.cellStyles)break;for(;U.e>=U.s;)xe[U.e--]={width:U.w/256,hidden:!!(U.flags&1),level:U.level},Ae||(Ae=!0,Km(U.w/256)),ci(xe[U.e+1]);break;case 161:h["!autofilter"]={ref:_t(U)};break;case 476:h["!margins"]=U;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),U.name&&(s.Sheets[r].CodeName=U.name),(U.above||U.left)&&(h["!outline"]={above:U.above,left:U.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),U.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:x=!0;break;case 36:x=!1;break;case 37:x=!0;break;case 38:x=!1;break;default:if(!ve.T){if(!x||u.WTF)throw new Error("Unexpected record 0x"+G.toString(16))}}},u),delete u.supbooks,delete u["!row"],!h["!ref"]&&(g.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(h["!ref"]=_t(d||g)),u.sheetRows&&h["!ref"]){var le=Mt(h["!ref"]);u.sheetRows<=+le.e.r&&(le.e.r=u.sheetRows-1,le.e.r>g.e.r&&(le.e.r=g.e.r),le.e.r<le.s.r&&(le.s.r=le.e.r),le.e.c>g.e.c&&(le.e.c=g.e.c),le.e.c<le.s.c&&(le.s.c=le.e.c),h["!fullref"]=h["!ref"],h["!ref"]=_t(le))}return D.length>0&&(h["!merges"]=D),xe.length>0&&(h["!cols"]=xe),Oe.length>0&&(h["!rows"]=Oe),h}function KR(e,t,r,a,s,l,c){if(t.v===void 0)return!1;var u="";switch(t.t){case"b":u=t.v?"1":"0";break;case"d":t=fr(t),t.z=t.z||ft[14],t.v=Hr(ur(t.v)),t.t="n";break;case"n":case"e":u=""+t.v;break;default:u=t.v;break}var h={r,c:a};switch(h.s=mi(s.cellXfs,t,s),t.l&&l["!links"].push([ht(h),t.l]),t.c&&l["!comments"].push([ht(h),t.c]),t.t){case"s":case"str":return s.bookSST?(u=e1(s.Strings,t.v,s.revStrings),h.t="s",h.v=u,c?Ne(e,18,mR(t,h)):Ne(e,7,hR(t,h))):(h.t="str",c?Ne(e,17,kR(t,h)):Ne(e,6,ER(t,h))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?c?Ne(e,13,wR(t,h)):Ne(e,2,yR(t,h)):c?Ne(e,16,xR(t,h)):Ne(e,5,pR(t,h)),!0;case"b":return h.t="b",c?Ne(e,15,iR(t,h)):Ne(e,4,nR(t,h)),!0;case"e":return h.t="e",c?Ne(e,14,uR(t,h)):Ne(e,3,oR(t,h)),!0}return c?Ne(e,12,rR(t,h)):Ne(e,1,eR(t,h)),!0}function YR(e,t,r,a){var s=Mt(t["!ref"]||"A1"),l,c="",u=[];Ne(e,145);var h=Array.isArray(t),d=s.e.r;t["!rows"]&&(d=Math.max(s.e.r,t["!rows"].length-1));for(var g=s.s.r;g<=d;++g){c=Ar(g),X5(e,t,s,g);var x=!1;if(g<=s.e.r)for(var y=s.s.c;y<=s.e.c;++y){g===s.s.r&&(u[y]=gr(y)),l=u[y]+c;var _=h?(t[g]||[])[y]:t[l];if(!_){x=!1;continue}x=KR(e,_,g,y,a,t,x)}}Ne(e,146)}function JR(e,t){!t||!t["!merges"]||(Ne(e,177,FR(t["!merges"].length)),t["!merges"].forEach(function(r){Ne(e,176,DR(r))}),Ne(e,178))}function QR(e,t){!t||!t["!cols"]||(Ne(e,390),t["!cols"].forEach(function(r,a){r&&Ne(e,60,UR(a,r))}),Ne(e,391))}function ZR(e,t){!t||!t["!ref"]||(Ne(e,648),Ne(e,649,VR(Mt(t["!ref"]))),Ne(e,650))}function eD(e,t,r){t["!links"].forEach(function(a){if(a[1].Target){var s=Wt(r,-1,a[1].Target.replace(/#.*$/,""),At.HLINK);Ne(e,494,jR(a,s))}}),delete t["!links"]}function tD(e,t,r,a){if(t["!comments"].length>0){var s=Wt(a,-1,"../drawings/vmlDrawing"+(r+1)+".vml",At.VML);Ne(e,551,zm("rId"+s)),t["!legacy"]=s}}function rD(e,t,r,a){if(t["!autofilter"]){var s=t["!autofilter"],l=typeof s.ref=="string"?s.ref:_t(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var c=r.Workbook.Names,u=Ua(l);u.s.r==u.e.r&&(u.e.r=Ua(t["!ref"]).e.r,l=_t(u));for(var h=0;h<c.length;++h){var d=c[h];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==a){d.Ref="'"+r.SheetNames[a]+"'!"+l;break}}h==c.length&&c.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+l}),Ne(e,161,To(Mt(l))),Ne(e,162)}}function aD(e,t,r){Ne(e,133),Ne(e,137,$R(t,r)),Ne(e,138),Ne(e,134)}function nD(e,t){t["!protect"]&&Ne(e,535,GR(t["!protect"]))}function sD(e,t,r,a){var s=Ba(),l=r.SheetNames[e],c=r.Sheets[l]||{},u=l;try{r&&r.Workbook&&(u=r.Workbook.Sheets[e].CodeName||u)}catch{}var h=Mt(c["!ref"]||"A1");if(h.e.c>16383||h.e.r>1048575){if(t.WTF)throw new Error("Range "+(c["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575)}return c["!links"]=[],c["!comments"]=[],Ne(s,129),(r.vbaraw||c["!outline"])&&Ne(s,147,Q5(u,c["!outline"])),Ne(s,148,K5(h)),aD(s,c,r.Workbook),QR(s,c),YR(s,c,e,t),nD(s,c),rD(s,c,r,e),JR(s,c),eD(s,c,a),c["!margins"]&&Ne(s,476,zR(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&ZR(s,c),tD(s,c,e,a),Ne(s,130),s.end()}function iD(e){var t=[],r=e.match(/^<c:numCache>/),a;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(l){var c=l.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);c&&(t[+c[1]]=r?+c[2]:c[2])});var s=Ft((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(l){a=l.replace(/<.*?>/g,"")}),[t,s,a]}function lD(e,t,r,a,s,l){var c=l||{"!type":"chart"};if(!e)return l;var u=0,h=0,d="A",g={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(x){var y=iD(x);g.s.r=g.s.c=0,g.e.c=u,d=gr(u),y[0].forEach(function(_,b){c[d+Ar(b)]={t:"n",v:_,z:y[1]},h=b}),g.e.r<h&&(g.e.r=h),++u}),u>0&&(c["!ref"]=_t(g)),c}function oD(e,t,r,a,s){if(!e)return e;a||(a={"!id":{}});var l={"!type":"chart","!drawel":null,"!rel":""},c,u=e.match(Q2);return u&&t1(u[0],l,s,r),(c=e.match(/drawing r:id="(.*?)"/))&&(l["!rel"]=c[1]),a["!id"][l["!rel"]]&&(l["!drawel"]=a["!id"][l["!rel"]]),l}function cD(e,t){e.l+=10;var r=va(e);return{name:r}}function uD(e,t,r,a,s){if(!e)return e;a||(a={"!id":{}});var l={"!type":"chart","!drawel":null,"!rel":""},c=!1;return As(e,function(h,d,g){switch(g){case 550:l["!rel"]=h;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),h.name&&(s.Sheets[r].CodeName=h.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:c=!0;break;case 36:c=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!c||t.WTF)throw new Error("Unexpected record 0x"+g.toString(16))}}}},t),a["!id"][l["!rel"]]&&(l["!drawel"]=a["!id"][l["!rel"]]),l}var r1=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],fD=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],hD=[],dD=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Ny(e,t){for(var r=0;r!=e.length;++r)for(var a=e[r],s=0;s!=t.length;++s){var l=t[s];if(a[l[0]]==null)a[l[0]]=l[1];else switch(l[2]){case"bool":typeof a[l[0]]=="string"&&(a[l[0]]=cr(a[l[0]]));break;case"int":typeof a[l[0]]=="string"&&(a[l[0]]=parseInt(a[l[0]],10));break}}}function Oy(e,t){for(var r=0;r!=t.length;++r){var a=t[r];if(e[a[0]]==null)e[a[0]]=a[1];else switch(a[2]){case"bool":typeof e[a[0]]=="string"&&(e[a[0]]=cr(e[a[0]]));break;case"int":typeof e[a[0]]=="string"&&(e[a[0]]=parseInt(e[a[0]],10));break}}}function rw(e){Oy(e.WBProps,r1),Oy(e.CalcPr,dD),Ny(e.WBView,fD),Ny(e.Sheets,hD),po.date1904=cr(e.WBProps.date1904)}function mD(e){return!e.Workbook||!e.Workbook.WBProps?"false":cr(e.Workbook.WBProps.date1904)?"true":"false"}var gD="][*?/\\".split("");function aw(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return gD.forEach(function(a){if(e.indexOf(a)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function pD(e,t,r){e.forEach(function(a,s){aw(a);for(var l=0;l<s;++l)if(a==e[l])throw new Error("Duplicate Sheet Name: "+a);if(r){var c=t&&t[s]&&t[s].CodeName||a;if(c.charCodeAt(0)==95&&c.length>22)throw new Error("Bad Code Name: Worksheet"+c)}})}function xD(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];pD(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)m5(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var vD=/<\w+:workbook/;function yD(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,s="xmlns",l={},c=0;if(e.replace(_a,function(h,d){var g=mt(h);switch(Yn(g[0])){case"<?xml":break;case"<workbook":h.match(vD)&&(s="xmlns"+h.match(/<(\w+):/)[1]),r.xmlns=g[s];break;case"</workbook>":break;case"<fileVersion":delete g[0],r.AppVersion=g;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":r1.forEach(function(x){if(g[x[0]]!=null)switch(x[2]){case"bool":r.WBProps[x[0]]=cr(g[x[0]]);break;case"int":r.WBProps[x[0]]=parseInt(g[x[0]],10);break;default:r.WBProps[x[0]]=g[x[0]]}}),g.codeName&&(r.WBProps.CodeName=rr(g.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete g[0],r.WBView.push(g);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(g.state){case"hidden":g.Hidden=1;break;case"veryHidden":g.Hidden=2;break;default:g.Hidden=0}delete g.state,g.name=Ft(rr(g.name)),delete g[0],r.Sheets.push(g);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":a=!0;break;case"</definedNames>":a=!1;break;case"<definedName":l={},l.Name=rr(g.name),g.comment&&(l.Comment=g.comment),g.localSheetId&&(l.Sheet=+g.localSheetId),cr(g.hidden||"0")&&(l.Hidden=!0),c=d+h.length;break;case"</definedName>":l.Ref=Ft(rr(e.slice(c,d))),r.Names.push(l);break;case"<definedName/>":break;case"<calcPr":delete g[0],r.CalcPr=g;break;case"<calcPr/>":delete g[0],r.CalcPr=g;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</AlternateContent>":a=!1;break;case"<revisionPtr":break;default:if(!a&&t.WTF)throw new Error("unrecognized "+g[0]+" in workbook")}return h}),sl.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return rw(r),r}function nw(e){var t=[Cr];t[t.length]=Ue("workbook",null,{xmlns:sl[0],"xmlns:r":zr.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,a={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(r1.forEach(function(u){e.Workbook.WBProps[u[0]]!=null&&e.Workbook.WBProps[u[0]]!=u[1]&&(a[u[0]]=e.Workbook.WBProps[u[0]])}),e.Workbook.WBProps.CodeName&&(a.codeName=e.Workbook.WBProps.CodeName,delete a.CodeName)),t[t.length]=Ue("workbookPr",null,a);var s=e.Workbook&&e.Workbook.Sheets||[],l=0;if(s&&s[0]&&s[0].Hidden){for(t[t.length]="<bookViews>",l=0;l!=e.SheetNames.length&&!(!s[l]||!s[l].Hidden);++l);l==e.SheetNames.length&&(l=0),t[t.length]='<workbookView firstSheet="'+l+'" activeTab="'+l+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",l=0;l!=e.SheetNames.length;++l){var c={name:Kt(e.SheetNames[l].slice(0,31))};if(c.sheetId=""+(l+1),c["r:id"]="rId"+(l+1),s[l])switch(s[l].Hidden){case 1:c.state="hidden";break;case 2:c.state="veryHidden";break}t[t.length]=Ue("sheet",null,c)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(u){var h={name:u.Name};u.Comment&&(h.comment=u.Comment),u.Sheet!=null&&(h.localSheetId=""+u.Sheet),u.Hidden&&(h.hidden="1"),u.Ref&&(t[t.length]=Ue("definedName",Kt(u.Ref),h))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function _D(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=sm(e),r.name=va(e),r}function wD(e,t){return t||(t=_e(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),zm(e.strRelID,t),Jr(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function bD(e,t){var r={},a=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?va(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(a&65536),r.backupFile=!!(a&64),r.checkCompatibility=!!(a&4096),r.date1904=!!(a&1),r.filterPrivacy=!!(a&8),r.hidePivotFieldList=!!(a&1024),r.promptedSolutions=!!(a&16),r.publishItems=!!(a&2048),r.refreshAllConnections=!!(a&262144),r.saveExternalLinkValues=!!(a&128),r.showBorderUnselectedTables=!!(a&4),r.showInkAnnotation=!!(a&32),r.showObjects=["all","placeholders","none"][a>>13&3],r.showPivotChartFilter=!!(a&32768),r.updateLinks=["userSet","never","always"][a>>8&3],r}function SD(e,t){t||(t=_e(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),K_(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function ED(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function TD(e,t,r){var a=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),l=t3(e),c=o5(e,0,r),u=Pm(e);e.l=a;var h={Name:l,Ptg:c};return s<268435455&&(h.Sheet=s),u&&(h.Comment=u),h}function kD(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],s=!1;t||(t={}),t.biff=12;var l=[],c=[[]];return c.SheetNames=[],c.XTI=[],Jc[16]={n:"BrtFRTArchID$",f:ED},As(e,function(h,d,g){switch(g){case 156:c.SheetNames.push(h.name),r.Sheets.push(h);break;case 153:r.WBProps=h;break;case 39:h.Sheet!=null&&(t.SID=h.Sheet),h.Ref=ga(h.Ptg,null,null,c,t),delete t.SID,delete h.Ptg,l.push(h);break;case 1036:break;case 357:case 358:case 355:case 667:c[0].length?c.push([g,h]):c[0]=[g,h],c[c.length-1].XTI=[];break;case 362:c.length===0&&(c[0]=[],c[0].XTI=[]),c[c.length-1].XTI=c[c.length-1].XTI.concat(h),c.XTI=c.XTI.concat(h);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:a.push(g),s=!0;break;case 36:a.pop(),s=!1;break;case 37:a.push(g),s=!0;break;case 38:a.pop(),s=!1;break;case 16:break;default:if(!d.T){if(!s||t.WTF&&a[a.length-1]!=37&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+g.toString(16))}}},t),rw(r),r.Names=l,r.supbooks=c,r}function AD(e,t){Ne(e,143);for(var r=0;r!=t.SheetNames.length;++r){var a=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,s={Hidden:a,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};Ne(e,156,wD(s))}Ne(e,144)}function CD(e,t){t||(t=_e(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Jr("SheetJS",t),Jr(V0.version,t),Jr(V0.version,t),Jr("7262",t),t.length>t.l?t.slice(0,t.l):t}function ND(e,t){t||(t=_e(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function OD(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,a=0,s=-1,l=-1;a<r.length;++a)!r[a]||!r[a].Hidden&&s==-1?s=a:r[a].Hidden==1&&l==-1&&(l=a);l>s||(Ne(e,135),Ne(e,158,ND(s)),Ne(e,136))}}function RD(e,t){var r=Ba();return Ne(r,131),Ne(r,128,CD()),Ne(r,153,SD(e.Workbook&&e.Workbook.WBProps||null)),OD(r,e),AD(r,e),Ne(r,132),r.end()}function DD(e,t,r){return t.slice(-4)===".bin"?kD(e,r):yD(e,r)}function FD(e,t,r,a,s,l,c,u){return t.slice(-4)===".bin"?WR(e,a,r,s,l,c,u):T5(e,a,r,s,l,c,u)}function MD(e,t,r,a,s,l,c,u){return t.slice(-4)===".bin"?uD(e,a,r,s,l):oD(e,a,r,s,l)}function jD(e,t,r,a,s,l,c,u){return t.slice(-4)===".bin"?L8():B8()}function ID(e,t,r,a,s,l,c,u){return t.slice(-4)===".bin"?j8():I8()}function LD(e,t,r,a){return t.slice(-4)===".bin"?D6(e,r,a):_6(e,r,a)}function BD(e,t,r){return B2(e,r)}function UD(e,t,r){return t.slice(-4)===".bin"?UN(e,r):IN(e,r)}function PD(e,t,r){return t.slice(-4)===".bin"?O8(e,r):w8(e,r)}function zD(e,t,r){return t.slice(-4)===".bin"?v8(e):p8(e)}function HD(e,t,r,a){return r.slice(-4)===".bin"?y8(e,t,r,a):void 0}function $D(e,t,r){return t.slice(-4)===".bin"?d8(e,t,r):g8(e,t,r)}function VD(e,t,r){return(t.slice(-4)===".bin"?RD:nw)(e)}function GD(e,t,r,a,s){return(t.slice(-4)===".bin"?sD:Z2)(e,r,a,s)}function qD(e,t,r){return(t.slice(-4)===".bin"?H6:I2)(e,r)}function XD(e,t,r){return(t.slice(-4)===".bin"?HN:C2)(e,r)}function WD(e,t,r){return(t.slice(-4)===".bin"?R8:z2)(e)}function KD(e){return(e.slice(-4)===".bin"?m8:U2)()}var sw=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,iw=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Nn(e,t){var r=e.split(/\s+/),a=[];if(a[0]=r[0],r.length===1)return a;var s=e.match(sw),l,c,u,h;if(s)for(h=0;h!=s.length;++h)l=s[h].match(iw),(c=l[1].indexOf(":"))===-1?a[l[1]]=l[2].slice(1,l[2].length-1):(l[1].slice(0,6)==="xmlns:"?u="xmlns"+l[1].slice(6):u=l[1].slice(c+1),a[u]=l[2].slice(1,l[2].length-1));return a}function YD(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var a=e.match(sw),s,l,c,u;if(a)for(u=0;u!=a.length;++u)s=a[u].match(iw),(l=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?c="xmlns"+s[1].slice(6):c=s[1].slice(l+1),r[c]=s[2].slice(1,s[2].length-1));return r}var Dc;function JD(e,t){var r=Dc[e]||Ft(e);return r==="General"?Yi(t):wn(r,t)}function QD(e,t,r,a){var s=a;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=cr(a);break;case"i2":case"int":s=parseInt(a,10);break;case"r4":case"float":s=parseFloat(a);break;case"date":case"dateTime.tz":s=ur(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Ft(t)]=s}function ZD(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Cs[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Hc(e.v):e.w=Yi(e.v):e.w=JD(t||"General",e.v)}catch(l){if(r.WTF)throw l}try{var a=Dc[t]||t||"General";if(r.cellNF&&(e.z=a),r.cellDates&&e.t=="n"&&bo(a)){var s=Vi(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(l){if(r.WTF)throw l}}}function eF(e,t,r){if(r.cellStyles&&t.Interior){var a=t.Interior;a.Pattern&&(a.patternType=h6[a.Pattern]||a.Pattern)}e[t.ID]=t}function tF(e,t,r,a,s,l,c,u,h,d){var g="General",x=a.StyleID,y={};d=d||{};var _=[],b=0;for(x===void 0&&u&&(x=u.StyleID),x===void 0&&c&&(x=c.StyleID);l[x]!==void 0&&(l[x].nf&&(g=l[x].nf),l[x].Interior&&_.push(l[x].Interior),!!l[x].Parent);)x=l[x].Parent;switch(r.Type){case"Boolean":a.t="b",a.v=cr(e);break;case"String":a.t="s",a.r=Xv(Ft(e)),a.v=e.indexOf("<")>-1?Ft(t||e).replace(/<.*?>/g,""):a.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),a.v=(ur(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),a.v!==a.v?a.v=Ft(e):a.v<60&&(a.v=a.v-1),(!g||g=="General")&&(g="yyyy-mm-dd");case"Number":a.v===void 0&&(a.v=+e),a.t||(a.t="n");break;case"Error":a.t="e",a.v=e2[e],d.cellText!==!1&&(a.w=e);break;default:e==""&&t==""?a.t="z":(a.t="s",a.v=Xv(t||e));break}if(ZD(a,g,d),d.cellFormula!==!1)if(a.Formula){var w=Ft(a.Formula);w.charCodeAt(0)==61&&(w=w.slice(1)),a.f=go(w,s),delete a.Formula,a.ArrayRange=="RC"?a.F=go("RC:RC",s):a.ArrayRange&&(a.F=go(a.ArrayRange,s),h.push([Mt(a.F),a.F]))}else for(b=0;b<h.length;++b)s.r>=h[b][0].s.r&&s.r<=h[b][0].e.r&&s.c>=h[b][0].s.c&&s.c<=h[b][0].e.c&&(a.F=h[b][1]);d.cellStyles&&(_.forEach(function(S){!y.patternType&&S.patternType&&(y.patternType=S.patternType)}),a.s=y),a.StyleID!==void 0&&(a.ixfe=a.StyleID)}function rF(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Pd(e,t){var r=t||{};So();var a=wc(Mm(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(a=rr(a));var s=a.slice(0,1024).toLowerCase(),l=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var c=fr(r);return c.type="string",_o.to_workbook(a,c)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(jt){s.indexOf("<"+jt)>=0&&(l=!0)}),l)return zF(a,r);Dc={"General Number":"General","General Date":ft[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ft[15],"Short Date":ft[14],"Long Time":ft[19],"Medium Time":ft[18],"Short Time":ft[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ft[2],Standard:ft[4],Percent:ft[10],Scientific:ft[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var u,h=[],d,g={},x=[],y=r.dense?[]:{},_="",b={},w={},S=Nn('<Data ss:Type="String">'),k=0,C=0,T=0,j={s:{r:2e6,c:2e6},e:{r:0,c:0}},X={},D={},N="",W=0,P=[],re={},ae={},Q=0,xe=[],Oe=[],Ae={},K=[],le,je=!1,U=[],ve=[],G={},A=0,z=0,I={Sheets:[],WBProps:{date1904:!1}},L={};Gc.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"");for(var te="";u=Gc.exec(a);)switch(u[3]=(te=u[3]).toLowerCase()){case"data":if(te=="data"){if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break}if(h[h.length-1][1])break;u[1]==="/"?tF(a.slice(k,u.index),N,S,h[h.length-1][0]=="comment"?Ae:b,{c:C,r:T},X,K[C],w,U,r):(N="",S=Nn(u[0]),k=u.index+u[0].length);break;case"cell":if(u[1]==="/")if(Oe.length>0&&(b.c=Oe),(!r.sheetRows||r.sheetRows>T)&&b.v!==void 0&&(r.dense?(y[T]||(y[T]=[]),y[T][C]=b):y[gr(C)+Ar(T)]=b),b.HRef&&(b.l={Target:Ft(b.HRef)},b.HRefScreenTip&&(b.l.Tooltip=b.HRefScreenTip),delete b.HRef,delete b.HRefScreenTip),(b.MergeAcross||b.MergeDown)&&(A=C+(parseInt(b.MergeAcross,10)|0),z=T+(parseInt(b.MergeDown,10)|0),P.push({s:{c:C,r:T},e:{c:A,r:z}})),!r.sheetStubs)b.MergeAcross?C=A+1:++C;else if(b.MergeAcross||b.MergeDown){for(var me=C;me<=A;++me)for(var ge=T;ge<=z;++ge)(me>C||ge>T)&&(r.dense?(y[ge]||(y[ge]=[]),y[ge][me]={t:"z"}):y[gr(me)+Ar(ge)]={t:"z"});C=A+1}else++C;else b=YD(u[0]),b.Index&&(C=+b.Index-1),C<j.s.c&&(j.s.c=C),C>j.e.c&&(j.e.c=C),u[0].slice(-2)==="/>"&&++C,Oe=[];break;case"row":u[1]==="/"||u[0].slice(-2)==="/>"?(T<j.s.r&&(j.s.r=T),T>j.e.r&&(j.e.r=T),u[0].slice(-2)==="/>"&&(w=Nn(u[0]),w.Index&&(T=+w.Index-1)),C=0,++T):(w=Nn(u[0]),w.Index&&(T=+w.Index-1),G={},(w.AutoFitHeight=="0"||w.Height)&&(G.hpx=parseInt(w.Height,10),G.hpt=Yc(G.hpx),ve[T]=G),w.Hidden=="1"&&(G.hidden=!0,ve[T]=G));break;case"worksheet":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"));x.push(_),j.s.r<=j.e.r&&j.s.c<=j.e.c&&(y["!ref"]=_t(j),r.sheetRows&&r.sheetRows<=j.e.r&&(y["!fullref"]=y["!ref"],j.e.r=r.sheetRows-1,y["!ref"]=_t(j))),P.length&&(y["!merges"]=P),K.length>0&&(y["!cols"]=K),ve.length>0&&(y["!rows"]=ve),g[_]=y}else j={s:{r:2e6,c:2e6},e:{r:0,c:0}},T=C=0,h.push([u[3],!1]),d=Nn(u[0]),_=Ft(d.Name),y=r.dense?[]:{},P=[],U=[],ve=[],L={name:_,Hidden:0},I.Sheets.push(L);break;case"table":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else{if(u[0].slice(-2)=="/>")break;h.push([u[3],!1]),K=[],je=!1}break;case"style":u[1]==="/"?eF(X,D,r):D=Nn(u[0]);break;case"numberformat":D.nf=Ft(Nn(u[0]).Format||"General"),Dc[D.nf]&&(D.nf=Dc[D.nf]);for(var pe=0;pe!=392&&ft[pe]!=D.nf;++pe);if(pe==392){for(pe=57;pe!=392;++pe)if(ft[pe]==null){bs(D.nf,pe);break}}break;case"column":if(h[h.length-1][0]!=="table")break;if(le=Nn(u[0]),le.Hidden&&(le.hidden=!0,delete le.Hidden),le.Width&&(le.wpx=parseInt(le.Width,10)),!je&&le.wpx>10){je=!0,pa=M2;for(var Ee=0;Ee<K.length;++Ee)K[Ee]&&ci(K[Ee])}je&&ci(le),K[le.Index-1||K.length]=le;for(var et=0;et<+le.Span;++et)K[K.length]=fr(le);break;case"namedrange":if(u[1]==="/")break;I.Names||(I.Names=[]);var q=mt(u[0]),vt={Name:q.Name,Ref:go(q.RefersTo.slice(1),{r:0,c:0})};I.Sheets.length>0&&(vt.Sheet=I.Sheets.length-1),I.Names.push(vt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(u[0].slice(-2)==="/>")break;u[1]==="/"?N+=a.slice(W,u.index):W=u.index+u[0].length;break;case"interior":if(!r.cellStyles)break;D.Interior=Nn(u[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(u[0].slice(-2)==="/>")break;u[1]==="/"?k3(re,te,a.slice(Q,u.index)):Q=u.index+u[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else h.push([u[3],!1]);break;case"comment":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"));rF(Ae),Oe.push(Ae)}else h.push([u[3],!1]),d=Nn(u[0]),Ae={a:d.Author};break;case"autofilter":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else if(u[0].charAt(u[0].length-2)!=="/"){var nt=Nn(u[0]);y["!autofilter"]={ref:go(nt.Range).replace(/\$/g,"")},h.push([u[3],!0])}break;case"name":break;case"datavalidation":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break;case"null":break;default:if(h.length==0&&u[3]=="document"||h.length==0&&u[3]=="uof")return jy(a,r);var kt=!0;switch(h[h.length-1][0]){case"officedocumentsettings":switch(u[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:kt=!1}break;case"componentoptions":switch(u[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:kt=!1}break;case"excelworkbook":switch(u[3]){case"date1904":I.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:kt=!1}break;case"workbookoptions":switch(u[3]){case"owcversion":break;case"height":break;case"width":break;default:kt=!1}break;case"worksheetoptions":switch(u[3]){case"visible":if(u[0].slice(-2)!=="/>")if(u[1]==="/")switch(a.slice(Q,u.index)){case"SheetHidden":L.Hidden=1;break;case"SheetVeryHidden":L.Hidden=2;break}else Q=u.index+u[0].length;break;case"header":y["!margins"]||Wi(y["!margins"]={},"xlml"),isNaN(+mt(u[0]).Margin)||(y["!margins"].header=+mt(u[0]).Margin);break;case"footer":y["!margins"]||Wi(y["!margins"]={},"xlml"),isNaN(+mt(u[0]).Margin)||(y["!margins"].footer=+mt(u[0]).Margin);break;case"pagemargins":var gt=mt(u[0]);y["!margins"]||Wi(y["!margins"]={},"xlml"),isNaN(+gt.Top)||(y["!margins"].top=+gt.Top),isNaN(+gt.Left)||(y["!margins"].left=+gt.Left),isNaN(+gt.Right)||(y["!margins"].right=+gt.Right),isNaN(+gt.Bottom)||(y["!margins"].bottom=+gt.Bottom);break;case"displayrighttoleft":I.Views||(I.Views=[]),I.Views[0]||(I.Views[0]={}),I.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":y["!outline"]||(y["!outline"]={}),y["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":y["!outline"]||(y["!outline"]={}),y["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:kt=!1}break;case"pivottable":case"pivotcache":switch(u[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:kt=!1}break;case"pagebreaks":switch(u[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:kt=!1}break;case"autofilter":switch(u[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:kt=!1}break;case"querytable":switch(u[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:kt=!1}break;case"datavalidation":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:kt=!1}break;case"sorting":case"conditionalformatting":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:kt=!1}break;case"mapinfo":case"schema":case"data":switch(u[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:kt=!1}break;case"smarttags":break;default:kt=!1;break}if(kt||u[3].match(/!\[CDATA/))break;if(!h[h.length-1][1])throw"Unrecognized tag: "+u[3]+"|"+h.join("|");if(h[h.length-1][0]==="customdocumentproperties"){if(u[0].slice(-2)==="/>")break;u[1]==="/"?QD(ae,te,xe,a.slice(Q,u.index)):(xe=u,Q=u.index+u[0].length);break}if(r.WTF)throw"Unrecognized tag: "+u[3]+"|"+h.join("|")}var Re={};return!r.bookSheets&&!r.bookProps&&(Re.Sheets=g),Re.SheetNames=x,Re.Workbook=I,Re.SSF=fr(ft),Re.Props=re,Re.Custprops=ae,Re}function hm(e,t){switch(n1(t=t||{}),t.type||"base64"){case"base64":return Pd(an(e),t);case"binary":case"buffer":case"file":return Pd(e,t);case"array":return Pd(hi(e),t)}}function aF(e,t){var r=[];return e.Props&&r.push(A3(e.Props,t)),e.Custprops&&r.push(C3(e.Props,e.Custprops)),r.join("")}function nF(){return""}function sF(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(a,s){var l=[];l.push(Ue("NumberFormat",null,{"ss:Format":Kt(ft[a.numFmtId])}));var c={"ss:ID":"s"+(21+s)};r.push(Ue("Style",l.join(""),c))}),Ue("Styles",r.join(""))}function lw(e){return Ue("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Qm(e.Ref,{r:0,c:0})})}function iF(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],a=0;a<t.length;++a){var s=t[a];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(lw(s)))}return Ue("Names",r.join(""))}function lF(e,t,r,a){if(!e||!((a||{}).Workbook||{}).Names)return"";for(var s=a.Workbook.Names,l=[],c=0;c<s.length;++c){var u=s[c];u.Sheet==r&&(u.Name.match(/^_xlfn\./)||l.push(lw(u)))}return l.join("")}function oF(e,t,r,a){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(Ue("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(Ue("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(Ue("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),a&&a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[r])if(a.Workbook.Sheets[r].Hidden)s.push(Ue("Visible",a.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var l=0;l<r&&!(a.Workbook.Sheets[l]&&!a.Workbook.Sheets[l].Hidden);++l);l==r&&s.push("<Selected/>")}return((((a||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(oa("ProtectContents","True")),e["!protect"].objects&&s.push(oa("ProtectObjects","True")),e["!protect"].scenarios&&s.push(oa("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(oa("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(oa("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(c){e["!protect"][c[0]]&&s.push("<"+c[1]+"/>")})),s.length==0?"":Ue("WorksheetOptions",s.join(""),{xmlns:Ja.x})}function cF(e){return e.map(function(t){var r=OA(t.t||""),a=Ue("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ue("Comment",a,{"ss:Author":t.a})}).join("")}function uF(e,t,r,a,s,l,c){if(!e||e.v==null&&e.f==null)return"";var u={};if(e.f&&(u["ss:Formula"]="="+Kt(Qm(e.f,c))),e.F&&e.F.slice(0,t.length)==t){var h=pr(e.F.slice(t.length+1));u["ss:ArrayRange"]="RC:R"+(h.r==c.r?"":"["+(h.r-c.r)+"]")+"C"+(h.c==c.c?"":"["+(h.c-c.c)+"]")}if(e.l&&e.l.Target&&(u["ss:HRef"]=Kt(e.l.Target),e.l.Tooltip&&(u["x:HRefScreenTip"]=Kt(e.l.Tooltip))),r["!merges"])for(var d=r["!merges"],g=0;g!=d.length;++g)d[g].s.c!=c.c||d[g].s.r!=c.r||(d[g].e.c>d[g].s.c&&(u["ss:MergeAcross"]=d[g].e.c-d[g].s.c),d[g].e.r>d[g].s.r&&(u["ss:MergeDown"]=d[g].e.r-d[g].s.r));var x="",y="";switch(e.t){case"z":if(!a.sheetStubs)return"";break;case"n":x="Number",y=String(e.v);break;case"b":x="Boolean",y=e.v?"1":"0";break;case"e":x="Error",y=Cs[e.v];break;case"d":x="DateTime",y=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||ft[14]);break;case"s":x="String",y=NA(e.v||"");break}var _=mi(a.cellXfs,e,a);u["ss:StyleID"]="s"+(21+_),u["ss:Index"]=c.c+1;var b=e.v!=null?y:"",w=e.t=="z"?"":'<Data ss:Type="'+x+'">'+b+"</Data>";return(e.c||[]).length>0&&(w+=cF(e.c)),Ue("Cell",w,u)}function fF(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=wo(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function hF(e,t,r,a){if(!e["!ref"])return"";var s=Mt(e["!ref"]),l=e["!merges"]||[],c=0,u=[];e["!cols"]&&e["!cols"].forEach(function(S,k){ci(S);var C=!!S.width,T=pf(k,S),j={"ss:Index":k+1};C&&(j["ss:Width"]=Wc(T.width)),S.hidden&&(j["ss:Hidden"]="1"),u.push(Ue("Column",null,j))});for(var h=Array.isArray(e),d=s.s.r;d<=s.e.r;++d){for(var g=[fF(d,(e["!rows"]||[])[d])],x=s.s.c;x<=s.e.c;++x){var y=!1;for(c=0;c!=l.length;++c)if(!(l[c].s.c>x)&&!(l[c].s.r>d)&&!(l[c].e.c<x)&&!(l[c].e.r<d)){(l[c].s.c!=x||l[c].s.r!=d)&&(y=!0);break}if(!y){var _={r:d,c:x},b=ht(_),w=h?(e[d]||[])[x]:e[b];g.push(uF(w,b,e,t,r,a,_))}}g.push("</Row>"),g.length>2&&u.push(g.join(""))}return u.join("")}function dF(e,t,r){var a=[],s=r.SheetNames[e],l=r.Sheets[s],c=l?lF(l,t,e,r):"";return c.length>0&&a.push("<Names>"+c+"</Names>"),c=l?hF(l,t,e,r):"",c.length>0&&a.push("<Table>"+c+"</Table>"),a.push(oF(l,t,e,r)),a.join("")}function mF(e,t){t||(t={}),e.SSF||(e.SSF=fr(ft)),e.SSF&&(So(),cf(e.SSF),t.revssf=ff(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],mi(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(aF(e,t)),r.push(nF()),r.push(""),r.push("");for(var a=0;a<e.SheetNames.length;++a)r.push(Ue("Worksheet",dF(a,t,e),{"ss:Name":Kt(e.SheetNames[a])}));return r[2]=sF(e,t),r[3]=iF(e),Cr+Ue("Workbook",r.join(""),{xmlns:Ja.ss,"xmlns:o":Ja.o,"xmlns:x":Ja.x,"xmlns:ss":Ja.ss,"xmlns:dt":Ja.dt,"xmlns:html":Ja.html})}function gF(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=i3(r),r.length-r.l<=4)return t;var a=r.read_shift(4);if(a==0||a>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(a=r.read_shift(4),a!==1907505652)||(t.UnicodeClipboardFormat=l3(r),a=r.read_shift(4),a==0||a>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var pF=[60,1084,2066,2165,2175];function xF(e,t,r,a,s){var l=a,c=[],u=r.slice(r.l,r.l+l);if(s&&s.enc&&s.enc.insitu&&u.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(u)}c.push(u),r.l+=l;for(var h=_s(r,r.l),d=dm[h],g=0;d!=null&&pF.indexOf(h)>-1;)l=_s(r,r.l+2),g=r.l+4,h==2066?g+=4:(h==2165||h==2175)&&(g+=12),u=r.slice(g,r.l+4+l),c.push(u),r.l+=4+l,d=dm[h=_s(r,r.l)];var x=Yr(c);la(x,0);var y=0;x.lens=[];for(var _=0;_<c.length;++_)x.lens.push(y),y+=c[_].length;if(x.length<a)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+x.length+" < "+a;return t.f(x,x.length,s)}function Gn(e,t,r){if(e.t!=="z"&&e.XF){var a=0;try{a=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=ft[a])}catch(l){if(t.WTF)throw l}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Cs[e.v]:a===0||a=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Hc(e.v):e.w=Yi(e.v):e.w=wn(a,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(l){if(t.WTF)throw l}if(t.cellDates&&a&&e.t=="n"&&bo(ft[a]||String(a))){var s=Vi(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function L0(e,t,r){return{v:e,ixfe:t,t:r}}function vF(e,t){var r={opts:{}},a={},s=t.dense?[]:{},l={},c={},u=null,h=[],d="",g={},x,y="",_,b,w,S,k={},C=[],T,j,X=[],D=[],N={Sheets:[],WBProps:{date1904:!1},Views:[{}]},W={},P=function(pt){return pt<8?Gi[pt]:pt<64&&D[pt-8]||Gi[pt]},re=function(pt,$t,Gr){var Vt=$t.XF.data;if(!(!Vt||!Vt.patternType||!Gr||!Gr.cellStyles)){$t.s={},$t.s.patternType=Vt.patternType;var Pt;(Pt=Xc(P(Vt.icvFore)))&&($t.s.fgColor={rgb:Pt}),(Pt=Xc(P(Vt.icvBack)))&&($t.s.bgColor={rgb:Pt})}},ae=function(pt,$t,Gr){if(!(G>1)&&!(Gr.sheetRows&&pt.r>=Gr.sheetRows)){if(Gr.cellStyles&&$t.XF&&$t.XF.data&&re(pt,$t,Gr),delete $t.ixfe,delete $t.XF,x=pt,y=ht(pt),(!c||!c.s||!c.e)&&(c={s:{r:0,c:0},e:{r:0,c:0}}),pt.r<c.s.r&&(c.s.r=pt.r),pt.c<c.s.c&&(c.s.c=pt.c),pt.r+1>c.e.r&&(c.e.r=pt.r+1),pt.c+1>c.e.c&&(c.e.c=pt.c+1),Gr.cellFormula&&$t.f){for(var Vt=0;Vt<C.length;++Vt)if(!(C[Vt][0].s.c>pt.c||C[Vt][0].s.r>pt.r)&&!(C[Vt][0].e.c<pt.c||C[Vt][0].e.r<pt.r)){$t.F=_t(C[Vt][0]),(C[Vt][0].s.c!=pt.c||C[Vt][0].s.r!=pt.r)&&delete $t.f,$t.f&&($t.f=""+ga(C[Vt][1],c,pt,U,Q));break}}Gr.dense?(s[pt.r]||(s[pt.r]=[]),s[pt.r][pt.c]=$t):s[y]=$t}},Q={enc:!1,sbcch:0,snames:[],sharedf:k,arrayf:C,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(Q.password=t.password);var xe,Oe=[],Ae=[],K=[],le=[],je=!1,U=[];U.SheetNames=Q.snames,U.sharedf=Q.sharedf,U.arrayf=Q.arrayf,U.names=[],U.XTI=[];var ve=0,G=0,A=0,z=[],I=[],L;Q.codepage=1200,Fn(1200);for(var te=!1;e.l<e.length-1;){var me=e.l,ge=e.read_shift(2);if(ge===0&&ve===10)break;var pe=e.l===e.length?0:e.read_shift(2),Ee=dm[ge];if(Ee&&Ee.f){if(t.bookSheets&&ve===133&&ge!==133)break;if(ve=ge,Ee.r===2||Ee.r==12){var et=e.read_shift(2);if(pe-=2,!Q.enc&&et!==ge&&((et&255)<<8|et>>8)!==ge)throw new Error("rt mismatch: "+et+"!="+ge);Ee.r==12&&(e.l+=10,pe-=10)}var q={};if(ge===10?q=Ee.f(e,pe,Q):q=xF(ge,Ee,e,pe,Q),G==0&&[9,521,1033,2057].indexOf(ve)===-1)continue;switch(ge){case 34:r.opts.Date1904=N.WBProps.date1904=q;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(Q.enc||(e.l=0),Q.enc=q,!t.password)throw new Error("File is password-protected");if(q.valid==null)throw new Error("Encryption scheme unsupported");if(!q.valid)throw new Error("Password is incorrect");break;case 92:Q.lastuser=q;break;case 66:var vt=Number(q);switch(vt){case 21010:vt=1200;break;case 32768:vt=1e4;break;case 32769:vt=1252;break}Fn(Q.codepage=vt),te=!0;break;case 317:Q.rrtabid=q;break;case 25:Q.winlocked=q;break;case 439:r.opts.RefreshAll=q;break;case 12:r.opts.CalcCount=q;break;case 16:r.opts.CalcDelta=q;break;case 17:r.opts.CalcIter=q;break;case 13:r.opts.CalcMode=q;break;case 14:r.opts.CalcPrecision=q;break;case 95:r.opts.CalcSaveRecalc=q;break;case 15:Q.CalcRefMode=q;break;case 2211:r.opts.FullCalc=q;break;case 129:q.fDialog&&(s["!type"]="dialog"),q.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),q.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:X.push(q);break;case 430:U.push([q]),U[U.length-1].XTI=[];break;case 35:case 547:U[U.length-1].push(q);break;case 24:case 536:L={Name:q.Name,Ref:ga(q.rgce,c,null,U,Q)},q.itab>0&&(L.Sheet=q.itab-1),U.names.push(L),U[0]||(U[0]=[],U[0].XTI=[]),U[U.length-1].push(q),q.Name=="_xlnm._FilterDatabase"&&q.itab>0&&q.rgce&&q.rgce[0]&&q.rgce[0][0]&&q.rgce[0][0][0]=="PtgArea3d"&&(I[q.itab-1]={ref:_t(q.rgce[0][0][1][2])});break;case 22:Q.ExternCount=q;break;case 23:U.length==0&&(U[0]=[],U[0].XTI=[]),U[U.length-1].XTI=U[U.length-1].XTI.concat(q),U.XTI=U.XTI.concat(q);break;case 2196:if(Q.biff<8)break;L!=null&&(L.Comment=q[1]);break;case 18:s["!protect"]=q;break;case 19:q!==0&&Q.WTF&&console.error("Password verifier: "+q);break;case 133:l[q.pos]=q,Q.snames.push(q.name);break;case 10:{if(--G)break;if(c.e){if(c.e.r>0&&c.e.c>0){if(c.e.r--,c.e.c--,s["!ref"]=_t(c),t.sheetRows&&t.sheetRows<=c.e.r){var nt=c.e.r;c.e.r=t.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=_t(c),c.e.r=nt}c.e.r++,c.e.c++}Oe.length>0&&(s["!merges"]=Oe),Ae.length>0&&(s["!objects"]=Ae),K.length>0&&(s["!cols"]=K),le.length>0&&(s["!rows"]=le),N.Sheets.push(W)}d===""?g=s:a[d]=s,s=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(Q.biff===8&&(Q.biff={9:2,521:3,1033:4}[ge]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[q.BIFFVer]||8),Q.biffguess=q.BIFFVer==0,q.BIFFVer==0&&q.dt==4096&&(Q.biff=5,te=!0,Fn(Q.codepage=28591)),Q.biff==8&&q.BIFFVer==0&&q.dt==16&&(Q.biff=2),G++)break;if(s=t.dense?[]:{},Q.biff<8&&!te&&(te=!0,Fn(Q.codepage=t.codepage||1252)),Q.biff<5||q.BIFFVer==0&&q.dt==4096){d===""&&(d="Sheet1"),c={s:{r:0,c:0},e:{r:0,c:0}};var kt={pos:e.l-pe,name:d};l[kt.pos]=kt,Q.snames.push(d)}else d=(l[me]||{name:""}).name;q.dt==32&&(s["!type"]="chart"),q.dt==64&&(s["!type"]="macro"),Oe=[],Ae=[],Q.arrayf=C=[],K=[],le=[],je=!1,W={Hidden:(l[me]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(t.dense?(s[q.r]||[])[q.c]:s[ht({c:q.c,r:q.r})])&&++q.c,T={ixfe:q.ixfe,XF:X[q.ixfe]||{},v:q.val,t:"n"},A>0&&(T.z=z[T.ixfe>>8&63]),Gn(T,t,r.opts.Date1904),ae({c:q.c,r:q.r},T,t);break;case 5:case 517:T={ixfe:q.ixfe,XF:X[q.ixfe],v:q.val,t:q.t},A>0&&(T.z=z[T.ixfe>>8&63]),Gn(T,t,r.opts.Date1904),ae({c:q.c,r:q.r},T,t);break;case 638:T={ixfe:q.ixfe,XF:X[q.ixfe],v:q.rknum,t:"n"},A>0&&(T.z=z[T.ixfe>>8&63]),Gn(T,t,r.opts.Date1904),ae({c:q.c,r:q.r},T,t);break;case 189:for(var gt=q.c;gt<=q.C;++gt){var Re=q.rkrec[gt-q.c][0];T={ixfe:Re,XF:X[Re],v:q.rkrec[gt-q.c][1],t:"n"},A>0&&(T.z=z[T.ixfe>>8&63]),Gn(T,t,r.opts.Date1904),ae({c:gt,r:q.r},T,t)}break;case 6:case 518:case 1030:{if(q.val=="String"){u=q;break}if(T=L0(q.val,q.cell.ixfe,q.tt),T.XF=X[T.ixfe],t.cellFormula){var jt=q.formula;if(jt&&jt[0]&&jt[0][0]&&jt[0][0][0]=="PtgExp"){var sr=jt[0][0][1][0],$r=jt[0][0][1][1],wa=ht({r:sr,c:$r});k[wa]?T.f=""+ga(q.formula,c,q.cell,U,Q):T.F=((t.dense?(s[sr]||[])[$r]:s[wa])||{}).F}else T.f=""+ga(q.formula,c,q.cell,U,Q)}A>0&&(T.z=z[T.ixfe>>8&63]),Gn(T,t,r.opts.Date1904),ae(q.cell,T,t),u=q}break;case 7:case 519:if(u)u.val=q,T=L0(q,u.cell.ixfe,"s"),T.XF=X[T.ixfe],t.cellFormula&&(T.f=""+ga(u.formula,c,u.cell,U,Q)),A>0&&(T.z=z[T.ixfe>>8&63]),Gn(T,t,r.opts.Date1904),ae(u.cell,T,t),u=null;else throw new Error("String record expects Formula");break;case 33:case 545:{C.push(q);var Sn=ht(q[0].s);if(_=t.dense?(s[q[0].s.r]||[])[q[0].s.c]:s[Sn],t.cellFormula&&_){if(!u||!Sn||!_)break;_.f=""+ga(q[1],c,q[0],U,Q),_.F=_t(q[0])}}break;case 1212:{if(!t.cellFormula)break;if(y){if(!u)break;k[ht(u.cell)]=q[0],_=t.dense?(s[u.cell.r]||[])[u.cell.c]:s[ht(u.cell)],(_||{}).f=""+ga(q[0],c,x,U,Q)}}break;case 253:T=L0(h[q.isst].t,q.ixfe,"s"),h[q.isst].h&&(T.h=h[q.isst].h),T.XF=X[T.ixfe],A>0&&(T.z=z[T.ixfe>>8&63]),Gn(T,t,r.opts.Date1904),ae({c:q.c,r:q.r},T,t);break;case 513:t.sheetStubs&&(T={ixfe:q.ixfe,XF:X[q.ixfe],t:"z"},A>0&&(T.z=z[T.ixfe>>8&63]),Gn(T,t,r.opts.Date1904),ae({c:q.c,r:q.r},T,t));break;case 190:if(t.sheetStubs)for(var ka=q.c;ka<=q.C;++ka){var It=q.ixfe[ka-q.c];T={ixfe:It,XF:X[It],t:"z"},A>0&&(T.z=z[T.ixfe>>8&63]),Gn(T,t,r.opts.Date1904),ae({c:ka,r:q.r},T,t)}break;case 214:case 516:case 4:T=L0(q.val,q.ixfe,"s"),T.XF=X[T.ixfe],A>0&&(T.z=z[T.ixfe>>8&63]),Gn(T,t,r.opts.Date1904),ae({c:q.c,r:q.r},T,t);break;case 0:case 512:G===1&&(c=q);break;case 252:h=q;break;case 1054:if(Q.biff==4){z[A++]=q[1];for(var Pa=0;Pa<A+163&&ft[Pa]!=q[1];++Pa);Pa>=163&&bs(q[1],A+163)}else bs(q[1],q[0]);break;case 30:{z[A++]=q;for(var za=0;za<A+163&&ft[za]!=q;++za);za>=163&&bs(q,A+163)}break;case 229:Oe=Oe.concat(q);break;case 93:Ae[q.cmo[0]]=Q.lastobj=q;break;case 438:Q.lastobj.TxO=q;break;case 127:Q.lastobj.ImData=q;break;case 440:for(S=q[0].s.r;S<=q[0].e.r;++S)for(w=q[0].s.c;w<=q[0].e.c;++w)_=t.dense?(s[S]||[])[w]:s[ht({c:w,r:S})],_&&(_.l=q[1]);break;case 2048:for(S=q[0].s.r;S<=q[0].e.r;++S)for(w=q[0].s.c;w<=q[0].e.c;++w)_=t.dense?(s[S]||[])[w]:s[ht({c:w,r:S})],_&&_.l&&(_.l.Tooltip=q[1]);break;case 28:{if(Q.biff<=5&&Q.biff>=2)break;_=t.dense?(s[q[0].r]||[])[q[0].c]:s[ht(q[0])];var Vr=Ae[q[2]];_||(t.dense?(s[q[0].r]||(s[q[0].r]=[]),_=s[q[0].r][q[0].c]={t:"z"}):_=s[ht(q[0])]={t:"z"},c.e.r=Math.max(c.e.r,q[0].r),c.s.r=Math.min(c.s.r,q[0].r),c.e.c=Math.max(c.e.c,q[0].c),c.s.c=Math.min(c.s.c,q[0].c)),_.c||(_.c=[]),b={a:q[1],t:Vr.TxO.t},_.c.push(b)}break;case 2173:s8(X[q.ixfe],q.ext);break;case 125:{if(!Q.cellStyles)break;for(;q.e>=q.s;)K[q.e--]={width:q.w/256,level:q.level||0,hidden:!!(q.flags&1)},je||(je=!0,Km(q.w/256)),ci(K[q.e+1])}break;case 520:{var hr={};q.level!=null&&(le[q.r]=hr,hr.level=q.level),q.hidden&&(le[q.r]=hr,hr.hidden=!0),q.hpt&&(le[q.r]=hr,hr.hpt=q.hpt,hr.hpx=wo(q.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||Wi(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ge]]=q;break;case 161:s["!margins"]||Wi(s["!margins"]={}),s["!margins"].header=q.header,s["!margins"].footer=q.footer;break;case 574:q.RTL&&(N.Views[0].RTL=!0);break;case 146:D=q;break;case 2198:xe=q;break;case 140:j=q;break;case 442:d?W.CodeName=q||W.name:N.WBProps.CodeName=q||"ThisWorkbook";break}}else Ee||console.error("Missing Info for XLS Record 0x"+ge.toString(16)),e.l+=pe}return r.SheetNames=br(l).sort(function(Qr,pt){return Number(Qr)-Number(pt)}).map(function(Qr){return l[Qr].name}),t.bookSheets||(r.Sheets=a),!r.SheetNames.length&&g["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=g)):r.Preamble=g,r.Sheets&&I.forEach(function(Qr,pt){r.Sheets[r.SheetNames[pt]]["!autofilter"]=Qr}),r.Strings=h,r.SSF=fr(ft),Q.enc&&(r.Encryption=Q.enc),xe&&(r.Themes=xe),r.Metadata={},j!==void 0&&(r.Metadata.Country=j),U.names.length>0&&(N.Names=U.names),r.Workbook=N,r}var Fc={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function yF(e,t,r){var a=lt.find(e,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var s=fy(a,im,Fc.DSI);for(var l in s)t[l]=s[l]}catch(d){if(r.WTF)throw d}var c=lt.find(e,"/!SummaryInformation");if(c&&c.size>0)try{var u=fy(c,lm,Fc.SI);for(var h in u)t[h]==null&&(t[h]=u[h])}catch(d){if(r.WTF)throw d}t.HeadingPairs&&t.TitlesOfParts&&(i2(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function _F(e,t){var r=[],a=[],s=[],l=0,c,u=zv(im,"n"),h=zv(lm,"n");if(e.Props)for(c=br(e.Props),l=0;l<c.length;++l)(Object.prototype.hasOwnProperty.call(u,c[l])?r:Object.prototype.hasOwnProperty.call(h,c[l])?a:s).push([c[l],e.Props[c[l]]]);if(e.Custprops)for(c=br(e.Custprops),l=0;l<c.length;++l)Object.prototype.hasOwnProperty.call(e.Props||{},c[l])||(Object.prototype.hasOwnProperty.call(u,c[l])?r:Object.prototype.hasOwnProperty.call(h,c[l])?a:s).push([c[l],e.Custprops[c[l]]]);var d=[];for(l=0;l<s.length;++l)d2.indexOf(s[l][0])>-1||s2.indexOf(s[l][0])>-1||s[l][1]!=null&&d.push(s[l]);a.length&&lt.utils.cfb_add(t,"/SummaryInformation",hy(a,Fc.SI,h,lm)),(r.length||d.length)&&lt.utils.cfb_add(t,"/DocumentSummaryInformation",hy(r,Fc.DSI,u,im,d.length?d:null,Fc.UDI))}function ow(e,t){t||(t={}),n1(t),Tm(),t.codepage&&Em(t.codepage);var r,a;if(e.FullPaths){if(lt.find(e,"/encryption"))throw new Error("File is password-protected");r=lt.find(e,"!CompObj"),a=lt.find(e,"/Workbook")||lt.find(e,"/Book")}else{switch(t.type){case"base64":e=tn(an(e));break;case"binary":e=tn(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}la(e,0),a={content:e}}var s,l;if(r&&gF(r),t.bookProps&&!t.bookSheets)s={};else{var c=Tt?"buffer":"array";if(a&&a.content)s=vF(a.content,t);else if((l=lt.find(e,"PerfectOffice_MAIN"))&&l.content)s=Xi.to_workbook(l.content,(t.type=c,t));else if((l=lt.find(e,"NativeContent_MAIN"))&&l.content)s=Xi.to_workbook(l.content,(t.type=c,t));else throw(l=lt.find(e,"MN0"))&&l.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&lt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=F8(e))}var u={};return e.FullPaths&&yF(e,u,t),s.Props=s.Custprops=u,t.bookFiles&&(s.cfb=e),s}function wF(e,t){var r=t||{},a=lt.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return lt.utils.cfb_add(a,s,cw(e,r)),r.biff==8&&(e.Props||e.Custprops)&&_F(e,a),r.biff==8&&e.vbaraw&&M8(a,lt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),a}var Jc={0:{f:G5},1:{f:Z5},2:{f:vR},3:{f:lR},4:{f:aR},5:{f:gR},6:{f:SR},7:{f:fR},8:{f:OR},9:{f:NR},10:{f:AR},11:{f:CR},12:{f:tR},13:{f:_R},14:{f:cR},15:{f:sR},16:{f:ew},17:{f:TR},18:{f:dR},19:{f:Um},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:TD},40:{},42:{},43:{f:S6},44:{f:w6},45:{f:k6},46:{f:C6},47:{f:A6},48:{},49:{f:WA},50:{},51:{f:o8},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:E2},62:{f:bR},63:{f:x8},64:{f:qR},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:ya,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:HR},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:J5},148:{f:W5,p:16},151:{f:IR},152:{},153:{f:bD},154:{},155:{},156:{f:_D},157:{},158:{},159:{T:1,f:BN},160:{T:-1},161:{T:1,f:cl},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:RR},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:i8},336:{T:-1},337:{f:f8,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:sm},357:{},358:{},359:{},360:{T:1},361:{},362:{f:S2},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:LR},427:{f:BR},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:PR},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Y5},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:MR},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:sm},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:C8},633:{T:1},634:{T:-1},635:{T:1,f:k8},636:{T:-1},637:{f:QA},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:cD},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:XR},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},dm={6:{f:Bd},10:{f:ti},12:{f:Ir},13:{f:Ir},14:{f:kr},15:{f:kr},16:{f:xa},17:{f:kr},18:{f:kr},19:{f:Ir},20:{f:vy},21:{f:vy},23:{f:S2},24:{f:_y},25:{f:kr},26:{},27:{},28:{f:XC},29:{},34:{f:kr},35:{f:yy},38:{f:xa},39:{f:xa},40:{f:xa},41:{f:xa},42:{f:kr},43:{f:kr},47:{f:s6},49:{f:_C},51:{f:Ir},60:{},61:{f:gC},64:{f:kr},65:{f:yC},66:{f:Ir},77:{},80:{},81:{},82:{},85:{f:Ir},89:{},90:{},91:{},92:{f:nC},93:{f:YC},94:{},95:{f:kr},96:{},97:{},99:{f:kr},125:{f:E2},128:{f:jC},129:{f:iC},130:{f:Ir},131:{f:kr},132:{f:kr},133:{f:lC},134:{},140:{f:nN},141:{f:Ir},144:{},146:{f:lN},151:{},152:{},153:{},154:{},155:{},156:{f:Ir},157:{},158:{},160:{f:mN},161:{f:uN},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:RC},190:{f:DC},193:{f:ti},197:{},198:{},199:{},200:{},201:{},202:{f:kr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Ir},220:{},221:{f:kr},222:{},224:{f:MC},225:{f:aC},226:{f:ti},227:{},229:{f:WC},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:cC},253:{f:bC},255:{f:fC},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:m2},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:kr},353:{f:ti},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:PC},431:{f:kr},432:{},433:{},434:{},437:{},438:{f:ZC},439:{f:kr},440:{f:eN},441:{},442:{f:iu},443:{},444:{f:Ir},445:{},446:{},448:{f:ti},449:{f:mC,r:2},450:{f:ti},512:{f:gy},513:{f:dN},515:{f:BC},516:{f:EC},517:{f:xy},519:{f:gN},520:{f:hC},523:{},545:{f:wy},549:{f:my},566:{},574:{f:xC},638:{f:OC},659:{},1048:{},1054:{f:kC},1084:{},1212:{f:VC},2048:{f:rN},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:M0},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:ti},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:oN,r:12},2173:{f:n8,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:kr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:$C,r:12},2197:{},2198:{f:Q6,r:12},2199:{},2200:{},2201:{},2202:{f:GC,r:12},2203:{f:ti},2204:{},2205:{},2206:{},2207:{},2211:{f:dC},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Ir},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:fN},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:iN},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:gy},1:{},2:{f:_N},3:{f:vN},4:{f:xN},5:{f:xy},7:{f:bN},8:{},9:{f:M0},11:{},22:{f:Ir},30:{f:CC},31:{},32:{},33:{f:wy},36:{},37:{f:my},50:{f:SN},62:{},52:{},67:{},68:{f:Ir},69:{},86:{},126:{},127:{f:pN},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:EN},223:{},234:{},354:{},421:{},518:{f:Bd},521:{f:M0},536:{f:_y},547:{f:yy},561:{},579:{},1030:{f:Bd},1033:{f:M0},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function He(e,t,r,a){var s=t;if(!isNaN(s)){var l=a||(r||[]).length||0,c=e.next(4);c.write_shift(2,s),c.write_shift(2,l),l>0&&Im(r)&&e.push(r)}}function bF(e,t,r,a){var s=(r||[]).length||0;if(s<=8224)return He(e,t,r,s);var l=t;if(!isNaN(l)){for(var c=r.parts||[],u=0,h=0,d=0;d+(c[u]||8224)<=8224;)d+=c[u]||8224,u++;var g=e.next(4);for(g.write_shift(2,l),g.write_shift(2,d),e.push(r.slice(h,h+d)),h+=d;h<s;){for(g=e.next(4),g.write_shift(2,60),d=0;d+(c[u]||8224)<=8224;)d+=c[u]||8224,u++;g.write_shift(2,d),e.push(r.slice(h,h+d)),h+=d}}}function uu(e,t,r){return e||(e=_e(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function SF(e,t,r,a){var s=_e(9);return uu(s,e,t),g2(r,a||"b",s),s}function EF(e,t,r){var a=_e(8+2*r.length);return uu(a,e,t),a.write_shift(1,r.length),a.write_shift(r.length,r,"sbcs"),a.l<a.length?a.slice(0,a.l):a}function TF(e,t,r,a){if(t.v!=null)switch(t.t){case"d":case"n":var s=t.t=="d"?Hr(ur(t.v)):t.v;s==(s|0)&&s>=0&&s<65536?He(e,2,wN(r,a,s)):He(e,3,yN(r,a,s));return;case"b":case"e":He(e,5,SF(r,a,t.v,t.t));return;case"s":case"str":He(e,4,EF(r,a,(t.v||"").slice(0,255)));return}He(e,1,uu(null,r,a))}function kF(e,t,r,a){var s=Array.isArray(t),l=Mt(t["!ref"]||"A1"),c,u="",h=[];if(l.e.c>255||l.e.r>16383){if(a.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");l.e.c=Math.min(l.e.c,255),l.e.r=Math.min(l.e.c,16383),c=_t(l)}for(var d=l.s.r;d<=l.e.r;++d){u=Ar(d);for(var g=l.s.c;g<=l.e.c;++g){d===l.s.r&&(h[g]=gr(g)),c=h[g]+u;var x=s?(t[d]||[])[g]:t[c];x&&TF(e,x,d,g)}}}function AF(e,t){for(var r=t||{},a=Ba(),s=0,l=0;l<e.SheetNames.length;++l)e.SheetNames[l]==r.sheet&&(s=l);if(s==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return He(a,r.biff==4?1033:r.biff==3?521:9,qm(e,16,r)),kF(a,e.Sheets[e.SheetNames[s]],s,r),He(a,10),a.end()}function CF(e,t,r){He(e,49,wC({sz:12,name:"Arial"},r))}function NF(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var s=a[0];s<=a[1];++s)t[s]!=null&&He(e,1054,AC(s,t[s],r))})}function OF(e,t){var r=_e(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),He(e,2151,r),r=_e(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),_2(Mt(t["!ref"]||"A1"),r),r.write_shift(4,4),He(e,2152,r)}function RF(e,t){for(var r=0;r<16;++r)He(e,224,py({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(a){He(e,224,py(a,0,t))})}function DF(e,t){for(var r=0;r<t["!links"].length;++r){var a=t["!links"][r];He(e,440,tN(a)),a[1].Tooltip&&He(e,2048,aN(a))}delete t["!links"]}function FF(e,t){if(t){var r=0;t.forEach(function(a,s){++r<=256&&a&&He(e,125,cN(pf(s,a),s))})}}function MF(e,t,r,a,s){var l=16+mi(s.cellXfs,t,s);if(t.v==null&&!t.bf){He(e,513,el(r,a,l));return}if(t.bf)He(e,6,i5(t,r,a,s,l));else switch(t.t){case"d":case"n":var c=t.t=="d"?Hr(ur(t.v)):t.v;He(e,515,UC(r,a,c,l));break;case"b":case"e":He(e,517,LC(r,a,t.v,l,s,t.t));break;case"s":case"str":if(s.bookSST){var u=e1(s.Strings,t.v,s.revStrings);He(e,253,SC(r,a,u,l))}else He(e,516,TC(r,a,(t.v||"").slice(0,255),l,s));break;default:He(e,513,el(r,a,l))}}function jF(e,t,r){var a=Ba(),s=r.SheetNames[e],l=r.Sheets[s]||{},c=(r||{}).Workbook||{},u=(c.Sheets||[])[e]||{},h=Array.isArray(l),d=t.biff==8,g,x="",y=[],_=Mt(l["!ref"]||"A1"),b=d?65536:16384;if(_.e.c>255||_.e.r>=b){if(t.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:IV16384");_.e.c=Math.min(_.e.c,255),_.e.r=Math.min(_.e.c,b-1)}He(a,2057,qm(r,16,t)),He(a,13,yn(1)),He(a,12,yn(100)),He(a,15,Ea(!0)),He(a,17,Ea(!1)),He(a,16,Qi(.001)),He(a,95,Ea(!0)),He(a,42,Ea(!1)),He(a,43,Ea(!1)),He(a,130,yn(1)),He(a,128,IC()),He(a,131,Ea(!1)),He(a,132,Ea(!1)),d&&FF(a,l["!cols"]),He(a,512,NC(_,t)),d&&(l["!links"]=[]);for(var w=_.s.r;w<=_.e.r;++w){x=Ar(w);for(var S=_.s.c;S<=_.e.c;++S){w===_.s.r&&(y[S]=gr(S)),g=y[S]+x;var k=h?(l[w]||[])[S]:l[g];k&&(MF(a,k,w,S,t),d&&k.l&&l["!links"].push([g,k.l]))}}var C=u.CodeName||u.name||s;return d&&He(a,574,vC((c.Views||[])[0])),d&&(l["!merges"]||[]).length&&He(a,229,KC(l["!merges"])),d&&DF(a,l),He(a,442,p2(C)),d&&OF(a,l),He(a,10),a.end()}function IF(e,t,r){var a=Ba(),s=(e||{}).Workbook||{},l=s.Sheets||[],c=s.WBProps||{},u=r.biff==8,h=r.biff==5;if(He(a,2057,qm(e,5,r)),r.bookType=="xla"&&He(a,135),He(a,225,u?yn(1200):null),He(a,193,L3(2)),h&&He(a,191),h&&He(a,192),He(a,226),He(a,92,sC("SheetJS",r)),He(a,66,yn(u?1200:1252)),u&&He(a,353,yn(0)),u&&He(a,448),He(a,317,hN(e.SheetNames.length)),u&&e.vbaraw&&He(a,211),u&&e.vbaraw){var d=c.CodeName||"ThisWorkbook";He(a,442,p2(d))}He(a,156,yn(17)),He(a,25,Ea(!1)),He(a,18,Ea(!1)),He(a,19,yn(0)),u&&He(a,431,Ea(!1)),u&&He(a,444,yn(0)),He(a,61,pC()),He(a,64,Ea(!1)),He(a,141,yn(0)),He(a,34,Ea(mD(e)=="true")),He(a,14,Ea(!0)),u&&He(a,439,Ea(!1)),He(a,218,yn(0)),CF(a,e,r),NF(a,e.SSF,r),RF(a,r),u&&He(a,352,Ea(!1));var g=a.end(),x=Ba();u&&He(x,140,sN()),u&&r.Strings&&bF(x,252,uC(r.Strings)),He(x,10);var y=x.end(),_=Ba(),b=0,w=0;for(w=0;w<e.SheetNames.length;++w)b+=(u?12:11)+(u?2:1)*e.SheetNames[w].length;var S=g.length+b+y.length;for(w=0;w<e.SheetNames.length;++w){var k=l[w]||{};He(_,133,oC({pos:S,hs:k.Hidden||0,dt:0,name:e.SheetNames[w]},r)),S+=t[w].length}var C=_.end();if(b!=C.length)throw new Error("BS8 "+b+" != "+C.length);var T=[];return g.length&&T.push(g),C.length&&T.push(C),y.length&&T.push(y),Yr(T)}function LF(e,t){var r=t||{},a=[];e&&!e.SSF&&(e.SSF=fr(ft)),e&&e.SSF&&(So(),cf(e.SSF),r.revssf=ff(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,s1(r),r.cellXfs=[],mi(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)a[a.length]=jF(s,r,e);return a.unshift(IF(e,a,r)),Yr(a)}function cw(e,t){for(var r=0;r<=e.SheetNames.length;++r){var a=e.Sheets[e.SheetNames[r]];if(!(!a||!a["!ref"])){var s=Ua(a["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var l=t||{};switch(l.biff||2){case 8:case 5:return LF(e,t);case 4:case 3:case 2:return AF(e,t)}throw new Error("invalid type "+l.bookType+" for BIFF")}function Ry(e,t){var r=t||{},a=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var l=e.match(/<\/table/i),c=s.index,u=l&&l.index||e.length,h=wA(e.slice(c,u),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,g=0,x=0,y=0,_={s:{r:1e7,c:1e7},e:{r:0,c:0}},b=[];for(c=0;c<h.length;++c){var w=h[c].trim(),S=w.slice(0,3).toLowerCase();if(S=="<tr"){if(++d,r.sheetRows&&r.sheetRows<=d){--d;break}g=0;continue}if(!(S!="<td"&&S!="<th")){var k=w.split(/<\/t[dh]>/i);for(u=0;u<k.length;++u){var C=k[u].trim();if(C.match(/<t[dh]/i)){for(var T=C,j=0;T.charAt(0)=="<"&&(j=T.indexOf(">"))>-1;)T=T.slice(j+1);for(var X=0;X<b.length;++X){var D=b[X];D.s.c==g&&D.s.r<d&&d<=D.e.r&&(g=D.e.c+1,X=-1)}var N=mt(C.slice(0,C.indexOf(">")));y=N.colspan?+N.colspan:1,((x=+N.rowspan)>1||y>1)&&b.push({s:{r:d,c:g},e:{r:d+(x||1)-1,c:g+y-1}});var W=N.t||N["data-t"]||"";if(!T.length){g+=y;continue}if(T=F_(T),_.s.r>d&&(_.s.r=d),_.e.r<d&&(_.e.r=d),_.s.c>g&&(_.s.c=g),_.e.c<g&&(_.e.c=g),!T.length){g+=y;continue}var P={t:"s",v:T};r.raw||!T.trim().length||W=="s"||(T==="TRUE"?P={t:"b",v:!0}:T==="FALSE"?P={t:"b",v:!1}:isNaN(jn(T))?isNaN(yo(T).getDate())||(P={t:"d",v:ur(T)},r.cellDates||(P={t:"n",v:Hr(P.v)}),P.z=r.dateNF||ft[14]):P={t:"n",v:jn(T)}),r.dense?(a[d]||(a[d]=[]),a[d][g]=P):a[ht({r:d,c:g})]=P,g+=y}}}}return a["!ref"]=_t(_),b.length&&(a["!merges"]=b),a}function BF(e,t,r,a){for(var s=e["!merges"]||[],l=[],c=t.s.c;c<=t.e.c;++c){for(var u=0,h=0,d=0;d<s.length;++d)if(!(s[d].s.r>r||s[d].s.c>c)&&!(s[d].e.r<r||s[d].e.c<c)){if(s[d].s.r<r||s[d].s.c<c){u=-1;break}u=s[d].e.r-s[d].s.r+1,h=s[d].e.c-s[d].s.c+1;break}if(!(u<0)){var g=ht({r,c}),x=a.dense?(e[r]||[])[c]:e[g],y=x&&x.v!=null&&(x.h||Fm(x.w||(Es(x),x.w)||""))||"",_={};u>1&&(_.rowspan=u),h>1&&(_.colspan=h),a.editable?y='<span contenteditable="true">'+y+"</span>":x&&(_["data-t"]=x&&x.t||"z",x.v!=null&&(_["data-v"]=x.v),x.z!=null&&(_["data-z"]=x.z),x.l&&(x.l.Target||"#").charAt(0)!="#"&&(y='<a href="'+x.l.Target+'">'+y+"</a>")),_.id=(a.id||"sjs")+"-"+g,l.push(Ue("td",y,_))}}var b="<tr>";return b+l.join("")+"</tr>"}var UF='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',PF="</body></html>";function zF(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return di(Ry(r[0],t),t);var a=o1();return r.forEach(function(s,l){c1(a,Ry(s,t),"Sheet"+(l+1))}),a}function HF(e,t,r){var a=[];return a.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function uw(e,t){var r=t||{},a=r.header!=null?r.header:UF,s=r.footer!=null?r.footer:PF,l=[a],c=Ua(e["!ref"]);r.dense=Array.isArray(e),l.push(HF(e,c,r));for(var u=c.s.r;u<=c.e.r;++u)l.push(BF(e,c,u,r));return l.push("</table>"+s),l.join("")}function fw(e,t,r){var a=r||{},s=0,l=0;if(a.origin!=null)if(typeof a.origin=="number")s=a.origin;else{var c=typeof a.origin=="string"?pr(a.origin):a.origin;s=c.r,l=c.c}var u=t.getElementsByTagName("tr"),h=Math.min(a.sheetRows||1e7,u.length),d={s:{r:0,c:0},e:{r:s,c:l}};if(e["!ref"]){var g=Ua(e["!ref"]);d.s.r=Math.min(d.s.r,g.s.r),d.s.c=Math.min(d.s.c,g.s.c),d.e.r=Math.max(d.e.r,g.e.r),d.e.c=Math.max(d.e.c,g.e.c),s==-1&&(d.e.r=s=g.e.r+1)}var x=[],y=0,_=e["!rows"]||(e["!rows"]=[]),b=0,w=0,S=0,k=0,C=0,T=0;for(e["!cols"]||(e["!cols"]=[]);b<u.length&&w<h;++b){var j=u[b];if(Dy(j)){if(a.display)continue;_[w]={hidden:!0}}var X=j.children;for(S=k=0;S<X.length;++S){var D=X[S];if(!(a.display&&Dy(D))){var N=D.hasAttribute("data-v")?D.getAttribute("data-v"):D.hasAttribute("v")?D.getAttribute("v"):F_(D.innerHTML),W=D.getAttribute("data-z")||D.getAttribute("z");for(y=0;y<x.length;++y){var P=x[y];P.s.c==k+l&&P.s.r<w+s&&w+s<=P.e.r&&(k=P.e.c+1-l,y=-1)}T=+D.getAttribute("colspan")||1,((C=+D.getAttribute("rowspan")||1)>1||T>1)&&x.push({s:{r:w+s,c:k+l},e:{r:w+s+(C||1)-1,c:k+l+(T||1)-1}});var re={t:"s",v:N},ae=D.getAttribute("data-t")||D.getAttribute("t")||"";N!=null&&(N.length==0?re.t=ae||"z":a.raw||N.trim().length==0||ae=="s"||(N==="TRUE"?re={t:"b",v:!0}:N==="FALSE"?re={t:"b",v:!1}:isNaN(jn(N))?isNaN(yo(N).getDate())||(re={t:"d",v:ur(N)},a.cellDates||(re={t:"n",v:Hr(re.v)}),re.z=a.dateNF||ft[14]):re={t:"n",v:jn(N)})),re.z===void 0&&W!=null&&(re.z=W);var Q="",xe=D.getElementsByTagName("A");if(xe&&xe.length)for(var Oe=0;Oe<xe.length&&!(xe[Oe].hasAttribute("href")&&(Q=xe[Oe].getAttribute("href"),Q.charAt(0)!="#"));++Oe);Q&&Q.charAt(0)!="#"&&(re.l={Target:Q}),a.dense?(e[w+s]||(e[w+s]=[]),e[w+s][k+l]=re):e[ht({c:k+l,r:w+s})]=re,d.e.c<k+l&&(d.e.c=k+l),k+=T}}++w}return x.length&&(e["!merges"]=(e["!merges"]||[]).concat(x)),d.e.r=Math.max(d.e.r,w-1+s),e["!ref"]=_t(d),w>=h&&(e["!fullref"]=_t((d.e.r=u.length-b+w-1+s,d))),e}function hw(e,t){var r=t||{},a=r.dense?[]:{};return fw(a,e,t)}function $F(e,t){return di(hw(e,t),t)}function Dy(e){var t="",r=VF(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function VF(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function GF(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(a,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Ft(t.replace(/<[^>]*>/g,""));return[r]}var Fy={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function dw(e,t){var r=t||{},a=Mm(e),s=[],l,c,u={name:""},h="",d=0,g,x,y={},_=[],b=r.dense?[]:{},w,S,k={value:""},C="",T=0,j=[],X=-1,D=-1,N={s:{r:1e6,c:1e7},e:{r:0,c:0}},W=0,P={},re=[],ae={},Q=0,xe=0,Oe=[],Ae=1,K=1,le=[],je={Names:[]},U={},ve=["",""],G=[],A={},z="",I=0,L=!1,te=!1,me=0;for(Gc.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");w=Gc.exec(a);)switch(w[3]=w[3].replace(/_.*$/,"")){case"table":case"":w[1]==="/"?(N.e.c>=N.s.c&&N.e.r>=N.s.r?b["!ref"]=_t(N):b["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=N.e.r&&(b["!fullref"]=b["!ref"],N.e.r=r.sheetRows-1,b["!ref"]=_t(N)),re.length&&(b["!merges"]=re),Oe.length&&(b["!rows"]=Oe),g.name=g.||g.name,typeof JSON<"u"&&JSON.stringify(g),_.push(g.name),y[g.name]=b,te=!1):w[0].charAt(w[0].length-2)!=="/"&&(g=mt(w[0],!1),X=D=-1,N.s.r=N.s.c=1e7,N.e.r=N.e.c=0,b=r.dense?[]:{},re=[],Oe=[],te=!0);break;case"table-row-group":w[1]==="/"?--W:++W;break;case"table-row":case"":if(w[1]==="/"){X+=Ae,Ae=1;break}if(x=mt(w[0],!1),x.?X=x.-1:X==-1&&(X=0),Ae=+x["number-rows-repeated"]||1,Ae<10)for(me=0;me<Ae;++me)W>0&&(Oe[X+me]={level:W});D=-1;break;case"covered-table-cell":w[1]!=="/"&&++D,r.sheetStubs&&(r.dense?(b[X]||(b[X]=[]),b[X][D]={t:"z"}):b[ht({r:X,c:D})]={t:"z"}),C="",j=[];break;case"table-cell":case"":if(w[0].charAt(w[0].length-2)==="/")++D,k=mt(w[0],!1),K=parseInt(k["number-columns-repeated"]||"1",10),S={t:"z",v:null},k.formula&&r.cellFormula!=!1&&(S.f=Cy(Ft(k.formula))),(k.||k["value-type"])=="string"&&(S.t="s",S.v=Ft(k["string-value"]||""),r.dense?(b[X]||(b[X]=[]),b[X][D]=S):b[ht({r:X,c:D})]=S),D+=K-1;else if(w[1]!=="/"){++D,C="",T=0,j=[],K=1;var ge=Ae?X+Ae-1:X;if(D>N.e.c&&(N.e.c=D),D<N.s.c&&(N.s.c=D),X<N.s.r&&(N.s.r=X),ge>N.e.r&&(N.e.r=ge),k=mt(w[0],!1),G=[],A={},S={t:k.||k["value-type"],v:null},r.cellFormula)if(k.formula&&(k.formula=Ft(k.formula)),k["number-matrix-columns-spanned"]&&k["number-matrix-rows-spanned"]&&(Q=parseInt(k["number-matrix-rows-spanned"],10)||0,xe=parseInt(k["number-matrix-columns-spanned"],10)||0,ae={s:{r:X,c:D},e:{r:X+Q-1,c:D+xe-1}},S.F=_t(ae),le.push([ae,S.F])),k.formula)S.f=Cy(k.formula);else for(me=0;me<le.length;++me)X>=le[me][0].s.r&&X<=le[me][0].e.r&&D>=le[me][0].s.c&&D<=le[me][0].e.c&&(S.F=le[me][1]);switch((k["number-columns-spanned"]||k["number-rows-spanned"])&&(Q=parseInt(k["number-rows-spanned"],10)||0,xe=parseInt(k["number-columns-spanned"],10)||0,ae={s:{r:X,c:D},e:{r:X+Q-1,c:D+xe-1}},re.push(ae)),k["number-columns-repeated"]&&(K=parseInt(k["number-columns-repeated"],10)),S.t){case"boolean":S.t="b",S.v=cr(k["boolean-value"]);break;case"float":S.t="n",S.v=parseFloat(k.value);break;case"percentage":S.t="n",S.v=parseFloat(k.value);break;case"currency":S.t="n",S.v=parseFloat(k.value);break;case"date":S.t="d",S.v=ur(k["date-value"]),r.cellDates||(S.t="n",S.v=Hr(S.v)),S.z="m/d/yy";break;case"time":S.t="n",S.v=vA(k["time-value"])/86400,r.cellDates&&(S.t="d",S.v=hf(S.v)),S.z="HH:MM:SS";break;case"number":S.t="n",S.v=parseFloat(k.);break;default:if(S.t==="string"||S.t==="text"||!S.t)S.t="s",k["string-value"]!=null&&(C=Ft(k["string-value"]),j=[]);else throw new Error("Unsupported value type "+S.t)}}else{if(L=!1,S.t==="s"&&(S.v=C||"",j.length&&(S.R=j),L=T==0),U.Target&&(S.l=U),G.length>0&&(S.c=G,G=[]),C&&r.cellText!==!1&&(S.w=C),L&&(S.t="z",delete S.v),(!L||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=X))for(var pe=0;pe<Ae;++pe){if(K=parseInt(k["number-columns-repeated"]||"1",10),r.dense)for(b[X+pe]||(b[X+pe]=[]),b[X+pe][D]=pe==0?S:fr(S);--K>0;)b[X+pe][D+K]=fr(S);else for(b[ht({r:X+pe,c:D})]=S;--K>0;)b[ht({r:X+pe,c:D+K})]=fr(S);N.e.c<=D&&(N.e.c=D)}K=parseInt(k["number-columns-repeated"]||"1",10),D+=K-1,K=0,S={},C="",j=[]}U={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(w[1]==="/"){if((l=s.pop())[0]!==w[3])throw"Bad state: "+l}else w[0].charAt(w[0].length-2)!=="/"&&s.push([w[3],!0]);break;case"annotation":if(w[1]==="/"){if((l=s.pop())[0]!==w[3])throw"Bad state: "+l;A.t=C,j.length&&(A.R=j),A.a=z,G.push(A)}else w[0].charAt(w[0].length-2)!=="/"&&s.push([w[3],!1]);z="",I=0,C="",T=0,j=[];break;case"creator":w[1]==="/"?z=a.slice(I,w.index):I=w.index+w[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(w[1]==="/"){if((l=s.pop())[0]!==w[3])throw"Bad state: "+l}else w[0].charAt(w[0].length-2)!=="/"&&s.push([w[3],!1]);C="",T=0,j=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(w[1]==="/"){if(P[u.name]=h,(l=s.pop())[0]!==w[3])throw"Bad state: "+l}else w[0].charAt(w[0].length-2)!=="/"&&(h="",u=mt(w[0],!1),s.push([w[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":c=mt(w[0],!1),h+=Fy[w[3]][c.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":c=mt(w[0],!1),h+=Fy[w[3]][c.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(w[0].slice(-2)==="/>")break;if(w[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":h+=a.slice(d,w.index);break}else d=w.index+w[0].length;break;case"named-range":c=mt(w[0],!1),ve=Ud(c["cell-range-address"]);var Ee={Name:c.name,Ref:ve[0]+"!"+ve[1]};te&&(Ee.Sheet=_.length),je.Names.push(Ee);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(w[1]==="/"&&(!k||!k["string-value"])){var et=GF(a.slice(T,w.index));C=(C.length>0?C+`
`:"")+et[0]}else mt(w[0],!1),T=w.index+w[0].length;break;case"s":break;case"database-range":if(w[1]==="/")break;try{ve=Ud(mt(w[0])["target-range-address"]),y[ve[0]]["!autofilter"]={ref:ve[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(w[1]!=="/"){if(U=mt(w[0],!1),!U.href)break;U.Target=Ft(U.href),delete U.href,U.Target.charAt(0)=="#"&&U.Target.indexOf(".")>-1?(ve=Ud(U.Target.slice(1)),U.Target="#"+ve[0]+"!"+ve[1]):U.Target.match(/^\.\.[\\\/]/)&&(U.Target=U.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(w[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(w)}}var q={Sheets:y,SheetNames:_,Workbook:je};return r.bookSheets&&delete q.Sheets,q}function My(e,t){t=t||{},vn(e,"META-INF/manifest.xml")&&v3(jr(e,"META-INF/manifest.xml"),t);var r=rn(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var a=dw(rr(r),t);return vn(e,"meta.xml")&&(a.Props=a2(jr(e,"meta.xml"))),a}function jy(e,t){return dw(e,t)}var qF=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Vc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Cr+t}})(),Iy=(function(){var e=function(l){return Kt(l).replace(/  +/g,function(c){return'<text:s text:c="'+c.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,a=function(l,c,u){var h=[];h.push('      <table:table table:name="'+Kt(c.SheetNames[u])+`" table:style-name="ta1">
`);var d=0,g=0,x=Ua(l["!ref"]||"A1"),y=l["!merges"]||[],_=0,b=Array.isArray(l);if(l["!cols"])for(g=0;g<=x.e.c;++g)h.push("        <table:table-column"+(l["!cols"][g]?' table:style-name="co'+l["!cols"][g].ods+'"':"")+`></table:table-column>
`);var w="",S=l["!rows"]||[];for(d=0;d<x.s.r;++d)w=S[d]?' table:style-name="ro'+S[d].ods+'"':"",h.push("        <table:table-row"+w+`></table:table-row>
`);for(;d<=x.e.r;++d){for(w=S[d]?' table:style-name="ro'+S[d].ods+'"':"",h.push("        <table:table-row"+w+`>
`),g=0;g<x.s.c;++g)h.push(t);for(;g<=x.e.c;++g){var k=!1,C={},T="";for(_=0;_!=y.length;++_)if(!(y[_].s.c>g)&&!(y[_].s.r>d)&&!(y[_].e.c<g)&&!(y[_].e.r<d)){(y[_].s.c!=g||y[_].s.r!=d)&&(k=!0),C["table:number-columns-spanned"]=y[_].e.c-y[_].s.c+1,C["table:number-rows-spanned"]=y[_].e.r-y[_].s.r+1;break}if(k){h.push(r);continue}var j=ht({r:d,c:g}),X=b?(l[d]||[])[g]:l[j];if(X&&X.f&&(C["table:formula"]=Kt(h5(X.f)),X.F&&X.F.slice(0,j.length)==j)){var D=Ua(X.F);C["table:number-matrix-columns-spanned"]=D.e.c-D.s.c+1,C["table:number-matrix-rows-spanned"]=D.e.r-D.s.r+1}if(!X){h.push(t);continue}switch(X.t){case"b":T=X.v?"TRUE":"FALSE",C["office:value-type"]="boolean",C["office:boolean-value"]=X.v?"true":"false";break;case"n":T=X.w||String(X.v||0),C["office:value-type"]="float",C["office:value"]=X.v||0;break;case"s":case"str":T=X.v==null?"":X.v,C["office:value-type"]="string";break;case"d":T=X.w||ur(X.v).toISOString(),C["office:value-type"]="date",C["office:date-value"]=ur(X.v).toISOString(),C["table:style-name"]="ce1";break;default:h.push(t);continue}var N=e(T);if(X.l&&X.l.Target){var W=X.l.Target;W=W.charAt(0)=="#"?"#"+d5(W.slice(1)):W,W.charAt(0)!="#"&&!W.match(/^\w+:/)&&(W="../"+W),N=Ue("text:a",N,{"xlink:href":W.replace(/&/g,"&amp;")})}h.push("          "+Ue("table:table-cell",Ue("text:p",N,{}),C)+`
`)}h.push(`        </table:table-row>
`)}return h.push(`      </table:table>
`),h.join("")},s=function(l,c){l.push(` <office:automatic-styles>
`),l.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),l.push(`   <number:month number:style="long"/>
`),l.push(`   <number:text>/</number:text>
`),l.push(`   <number:day number:style="long"/>
`),l.push(`   <number:text>/</number:text>
`),l.push(`   <number:year/>
`),l.push(`  </number:date-style>
`);var u=0;c.SheetNames.map(function(d){return c.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var g=0;g<d["!cols"].length;++g)if(d["!cols"][g]){var x=d["!cols"][g];if(x.width==null&&x.wpx==null&&x.wch==null)continue;ci(x),x.ods=u;var y=d["!cols"][g].wpx+"px";l.push('  <style:style style:name="co'+u+`" style:family="table-column">
`),l.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+y+`"/>
`),l.push(`  </style:style>
`),++u}}});var h=0;c.SheetNames.map(function(d){return c.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var g=0;g<d["!rows"].length;++g)if(d["!rows"][g]){d["!rows"][g].ods=h;var x=d["!rows"][g].hpx+"px";l.push('  <style:style style:name="ro'+h+`" style:family="table-row">
`),l.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+x+`"/>
`),l.push(`  </style:style>
`),++h}}}),l.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),l.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),l.push(`  </style:style>
`),l.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),l.push(` </office:automatic-styles>
`)};return function(c,u){var h=[Cr],d=Vc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),g=Vc({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});u.bookType=="fods"?(h.push("<office:document"+d+g+`>
`),h.push(r2().replace(/office:document-meta/g,"office:meta"))):h.push("<office:document-content"+d+`>
`),s(h,c),h.push(`  <office:body>
`),h.push(`    <office:spreadsheet>
`);for(var x=0;x!=c.SheetNames.length;++x)h.push(a(c.Sheets[c.SheetNames[x]],c,x));return h.push(`    </office:spreadsheet>
`),h.push(`  </office:body>
`),u.bookType=="fods"?h.push("</office:document>"):h.push("</office:document-content>"),h.join("")}})();function mw(e,t){if(t.bookType=="fods")return Iy(e,t);var r=Om(),a="",s=[],l=[];return a="mimetype",St(r,a,"application/vnd.oasis.opendocument.spreadsheet"),a="content.xml",St(r,a,Iy(e,t)),s.push([a,"text/xml"]),l.push([a,"ContentFile"]),a="styles.xml",St(r,a,qF(e,t)),s.push([a,"text/xml"]),l.push([a,"StylesFile"]),a="meta.xml",St(r,a,Cr+r2()),s.push([a,"text/xml"]),l.push([a,"MetadataFile"]),a="manifest.rdf",St(r,a,w3(l)),s.push([a,"application/rdf+xml"]),a="META-INF/manifest.xml",St(r,a,y3(s)),r}function tl(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function mm(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):rr(hi(e))}function XF(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):tn(Kn(e))}function WF(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var a=0;a<t.length;++a)if(e[r+a]!=t[a])continue e;return!0}return!1}function fi(e){var t=e.reduce(function(s,l){return s+l.length},0),r=new Uint8Array(t),a=0;return e.forEach(function(s){r.set(s,a),a+=s.length}),r}function Ly(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function KF(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,a=e[t+14]&1,s=t+13;s>=t;--s)a=a*256+e[s];return(e[t+15]&128?-a:a)*Math.pow(10,r-6176)}function YF(e,t,r){var a=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,a-6176);e[t+15]|=a>>7,e[t+14]|=(a&127)<<1;for(var l=0;s>=1;++l,s/=256)e[t+l]=s&255;e[t+15]|=r>=0?0:128}function Qc(e,t){var r=t?t[0]:0,a=e[r]&127;e:if(e[r++]>=128&&(a|=(e[r]&127)<<7,e[r++]<128||(a|=(e[r]&127)<<14,e[r++]<128)||(a|=(e[r]&127)<<21,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),a}function Xt(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function wr(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Ut(e){for(var t=[],r=[0];r[0]<e.length;){var a=r[0],s=Qc(e,r),l=s&7;s=Math.floor(s/8);var c=0,u;if(s==0)break;switch(l){case 0:{for(var h=r[0];e[r[0]++]>=128;);u=e.slice(h,r[0])}break;case 5:c=4,u=e.slice(r[0],r[0]+c),r[0]+=c;break;case 1:c=8,u=e.slice(r[0],r[0]+c),r[0]+=c;break;case 2:c=Qc(e,r),u=e.slice(r[0],r[0]+c),r[0]+=c;break;default:throw new Error("PB Type ".concat(l," for Field ").concat(s," at offset ").concat(a))}var d={data:u,type:l};t[s]==null?t[s]=[d]:t[s].push(d)}return t}function ia(e){var t=[];return e.forEach(function(r,a){r.forEach(function(s){s.data&&(t.push(Xt(a*8+s.type)),s.type==2&&t.push(Xt(s.data.length)),t.push(s.data))})}),fi(t)}function a1(e,t){return e?.map(function(r){return t(r.data)})||[]}function pn(e){for(var t,r=[],a=[0];a[0]<e.length;){var s=Qc(e,a),l=Ut(e.slice(a[0],a[0]+s));a[0]+=s;var c={id:wr(l[1][0].data),messages:[]};l[2].forEach(function(u){var h=Ut(u.data),d=wr(h[3][0].data);c.messages.push({meta:h,data:e.slice(a[0],a[0]+d)}),a[0]+=d}),(t=l[3])!=null&&t[0]&&(c.merge=wr(l[3][0].data)>>>0>0),r.push(c)}return r}function ao(e){var t=[];return e.forEach(function(r){var a=[];a[1]=[{data:Xt(r.id),type:0}],a[2]=[],r.merge!=null&&(a[3]=[{data:Xt(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(c){s.push(c.data),c.meta[3]=[{type:0,data:Xt(c.data.length)}],a[2].push({data:ia(c.meta),type:2})});var l=ia(a);t.push(Xt(l.length)),t.push(l),s.forEach(function(c){return t.push(c)})}),fi(t)}function JF(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],a=Qc(t,r),s=[];r[0]<t.length;){var l=t[r[0]]&3;if(l==0){var c=t[r[0]++]>>2;if(c<60)++c;else{var u=c-59;c=t[r[0]],u>1&&(c|=t[r[0]+1]<<8),u>2&&(c|=t[r[0]+2]<<16),u>3&&(c|=t[r[0]+3]<<24),c>>>=0,c++,r[0]+=u}s.push(t.slice(r[0],r[0]+c)),r[0]+=c;continue}else{var h=0,d=0;if(l==1?(d=(t[r[0]]>>2&7)+4,h=(t[r[0]++]&224)<<3,h|=t[r[0]++]):(d=(t[r[0]++]>>2)+1,l==2?(h=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(h=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[fi(s)],h==0)throw new Error("Invalid offset 0");if(h>s[0].length)throw new Error("Invalid offset beyond length");if(d>=h)for(s.push(s[0].slice(-h)),d-=h;d>=s[s.length-1].length;)s.push(s[s.length-1]),d-=s[s.length-1].length;s.push(s[0].slice(-h,-h+d))}}var g=fi(s);if(g.length!=a)throw new Error("Unexpected length: ".concat(g.length," != ").concat(a));return g}function xn(e){for(var t=[],r=0;r<e.length;){var a=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(JF(a,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return fi(t)}function no(e){for(var t=[],r=0;r<e.length;){var a=Math.min(e.length-r,268435455),s=new Uint8Array(4);t.push(s);var l=Xt(a),c=l.length;t.push(l),a<=60?(c++,t.push(new Uint8Array([a-1<<2]))):a<=256?(c+=2,t.push(new Uint8Array([240,a-1&255]))):a<=65536?(c+=3,t.push(new Uint8Array([244,a-1&255,a-1>>8&255]))):a<=16777216?(c+=4,t.push(new Uint8Array([248,a-1&255,a-1>>8&255,a-1>>16&255]))):a<=4294967296&&(c+=5,t.push(new Uint8Array([252,a-1&255,a-1>>8&255,a-1>>16&255,a-1>>>24&255]))),t.push(e.slice(r,r+a)),c+=a,s[0]=0,s[1]=c&255,s[2]=c>>8&255,s[3]=c>>16&255,r+=a}return fi(t)}function QF(e,t,r,a){var s=tl(e),l=s.getUint32(4,!0),c=(a>1?12:8)+Ly(l&(a>1?3470:398))*4,u=-1,h=-1,d=NaN,g=new Date(2001,0,1);l&512&&(u=s.getUint32(c,!0),c+=4),c+=Ly(l&(a>1?12288:4096))*4,l&16&&(h=s.getUint32(c,!0),c+=4),l&32&&(d=s.getFloat64(c,!0),c+=8),l&64&&(g.setTime(g.getTime()+s.getFloat64(c,!0)*1e3),c+=8);var x;switch(e[2]){case 0:break;case 2:x={t:"n",v:d};break;case 3:x={t:"s",v:t[h]};break;case 5:x={t:"d",v:g};break;case 6:x={t:"b",v:d>0};break;case 7:x={t:"n",v:d/86400};break;case 8:x={t:"e",v:0};break;case 9:if(u>-1)x={t:"s",v:r[u]};else if(h>-1)x={t:"s",v:t[h]};else if(!isNaN(d))x={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return x}function ZF(e,t,r){var a=tl(e),s=a.getUint32(8,!0),l=12,c=-1,u=-1,h=NaN,d=NaN,g=new Date(2001,0,1);s&1&&(h=KF(e,l),l+=16),s&2&&(d=a.getFloat64(l,!0),l+=8),s&4&&(g.setTime(g.getTime()+a.getFloat64(l,!0)*1e3),l+=8),s&8&&(u=a.getUint32(l,!0),l+=4),s&16&&(c=a.getUint32(l,!0),l+=4);var x;switch(e[1]){case 0:break;case 2:x={t:"n",v:h};break;case 3:x={t:"s",v:t[u]};break;case 5:x={t:"d",v:g};break;case 6:x={t:"b",v:d>0};break;case 7:x={t:"n",v:d/86400};break;case 8:x={t:"e",v:0};break;case 9:if(c>-1)x={t:"s",v:r[c]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:x={t:"n",v:h};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return x}function zd(e,t){var r=new Uint8Array(32),a=tl(r),s=12,l=0;switch(r[0]=5,e.t){case"n":r[1]=2,YF(r,s,e.v),l|=1,s+=16;break;case"b":r[1]=6,a.setFloat64(s,e.v?1:0,!0),l|=2,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,a.setUint32(s,t.indexOf(e.v),!0),l|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(8,l,!0),r.slice(0,s)}function Hd(e,t){var r=new Uint8Array(32),a=tl(r),s=12,l=0;switch(r[0]=3,e.t){case"n":r[2]=2,a.setFloat64(s,e.v,!0),l|=32,s+=8;break;case"b":r[2]=6,a.setFloat64(s,e.v?1:0,!0),l|=32,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,a.setUint32(s,t.indexOf(e.v),!0),l|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(4,l,!0),r.slice(0,s)}function eM(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return QF(e,t,r,e[0]);case 5:return ZF(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function ma(e){var t=Ut(e);return Qc(t[1][0].data)}function By(e,t){var r=Ut(t.data),a=wr(r[1][0].data),s=r[3],l=[];return(s||[]).forEach(function(c){var u=Ut(c.data),h=wr(u[1][0].data)>>>0;switch(a){case 1:l[h]=mm(u[3][0].data);break;case 8:{var d=e[ma(u[9][0].data)][0],g=Ut(d.data),x=e[ma(g[1][0].data)][0],y=wr(x.meta[1][0].data);if(y!=2001)throw new Error("2000 unexpected reference to ".concat(y));var _=Ut(x.data);l[h]=_[3].map(function(b){return mm(b.data)}).join("")}break}}),l}function tM(e,t){var r,a,s,l,c,u,h,d,g,x,y,_,b,w,S=Ut(e),k=wr(S[1][0].data)>>>0,C=wr(S[2][0].data)>>>0,T=((a=(r=S[8])==null?void 0:r[0])==null?void 0:a.data)&&wr(S[8][0].data)>0||!1,j,X;if((l=(s=S[7])==null?void 0:s[0])!=null&&l.data&&t!=0)j=(u=(c=S[7])==null?void 0:c[0])==null?void 0:u.data,X=(d=(h=S[6])==null?void 0:h[0])==null?void 0:d.data;else if((x=(g=S[4])==null?void 0:g[0])!=null&&x.data&&t!=1)j=(_=(y=S[4])==null?void 0:y[0])==null?void 0:_.data,X=(w=(b=S[3])==null?void 0:b[0])==null?void 0:w.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var D=T?4:1,N=tl(j),W=[],P=0;P<j.length/2;++P){var re=N.getUint16(P*2,!0);re<65535&&W.push([P,re])}if(W.length!=C)throw"Expected ".concat(C," cells, found ").concat(W.length);var ae=[];for(P=0;P<W.length-1;++P)ae[W[P][0]]=X.subarray(W[P][1]*D,W[P+1][1]*D);return W.length>=1&&(ae[W[W.length-1][0]]=X.subarray(W[W.length-1][1]*D)),{R:k,cells:ae}}function rM(e,t){var r,a=Ut(t.data),s=(r=a?.[7])!=null&&r[0]?wr(a[7][0].data)>>>0>0?1:0:-1,l=a1(a[5],function(c){return tM(c,s)});return{nrows:wr(a[4][0].data)>>>0,data:l.reduce(function(c,u){return c[u.R]||(c[u.R]=[]),u.cells.forEach(function(h,d){if(c[u.R][d])throw new Error("Duplicate cell r=".concat(u.R," c=").concat(d));c[u.R][d]=h}),c},[])}}function aM(e,t,r){var a,s=Ut(t.data),l={s:{r:0,c:0},e:{r:0,c:0}};if(l.e.r=(wr(s[6][0].data)>>>0)-1,l.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(l.e.c=(wr(s[7][0].data)>>>0)-1,l.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=_t(l);var c=Ut(s[4][0].data),u=By(e,e[ma(c[4][0].data)][0]),h=(a=c[17])!=null&&a[0]?By(e,e[ma(c[17][0].data)][0]):[],d=Ut(c[3][0].data),g=0;d[1].forEach(function(x){var y=Ut(x.data),_=e[ma(y[2][0].data)][0],b=wr(_.meta[1][0].data);if(b!=6002)throw new Error("6001 unexpected reference to ".concat(b));var w=rM(e,_);w.data.forEach(function(S,k){S.forEach(function(C,T){var j=ht({r:g+k,c:T}),X=eM(C,u,h);X&&(r[j]=X)})}),g+=w.nrows})}function nM(e,t){var r=Ut(t.data),a={"!ref":"A1"},s=e[ma(r[2][0].data)],l=wr(s[0].meta[1][0].data);if(l!=6001)throw new Error("6000 unexpected reference to ".concat(l));return aM(e,s[0],a),a}function sM(e,t){var r,a=Ut(t.data),s={name:(r=a[1])!=null&&r[0]?mm(a[1][0].data):"",sheets:[]},l=a1(a[2],ma);return l.forEach(function(c){e[c].forEach(function(u){var h=wr(u.meta[1][0].data);h==6e3&&s.sheets.push(nM(e,u))})}),s}function iM(e,t){var r=o1(),a=Ut(t.data),s=a1(a[1],ma);if(s.forEach(function(l){e[l].forEach(function(c){var u=wr(c.meta[1][0].data);if(u==2){var h=sM(e,c);h.sheets.forEach(function(d,g){c1(r,d,g==0?h.name:h.name+"_"+g,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function $d(e){var t,r,a,s,l={},c=[];if(e.FullPaths.forEach(function(h){if(h.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(h){if(h.name.match(/\.iwa$/)){var d;try{d=xn(h.content)}catch(x){return console.log("?? "+h.content.length+" "+(x.message||x))}var g;try{g=pn(d)}catch(x){return console.log("## "+(x.message||x))}g.forEach(function(x){l[x.id]=x.messages,c.push(x.id)})}}),!c.length)throw new Error("File has no messages");var u=((s=(a=(r=(t=l?.[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:a[1])==null?void 0:s[0].data)&&wr(l[1][0].meta[1][0].data)==1&&l[1][0];if(u||c.forEach(function(h){l[h].forEach(function(d){var g=wr(d.meta[1][0].data)>>>0;if(g==1)if(!u)u=d;else throw new Error("Document has multiple roots")})}),!u)throw new Error("Cannot find Document root");return iM(l,u)}function lM(e,t,r){var a,s,l,c;if(!((a=e[6])!=null&&a[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var u=((c=(l=e[8])==null?void 0:l[0])==null?void 0:c.data)&&wr(e[8][0].data)>0||!1;if(u)throw"Math only works with normal offsets";for(var h=0,d=tl(e[7][0].data),g=0,x=[],y=tl(e[4][0].data),_=0,b=[],w=0;w<t.length;++w){if(t[w]==null){d.setUint16(w*2,65535,!0),y.setUint16(w*2,65535);continue}d.setUint16(w*2,g,!0),y.setUint16(w*2,_,!0);var S,k;switch(typeof t[w]){case"string":S=zd({t:"s",v:t[w]},r),k=Hd({t:"s",v:t[w]},r);break;case"number":S=zd({t:"n",v:t[w]},r),k=Hd({t:"n",v:t[w]},r);break;case"boolean":S=zd({t:"b",v:t[w]},r),k=Hd({t:"b",v:t[w]},r);break;default:throw new Error("Unsupported value "+t[w])}x.push(S),g+=S.length,b.push(k),_+=k.length,++h}for(e[2][0].data=Xt(h);w<e[7][0].data.length/2;++w)d.setUint16(w*2,65535,!0),y.setUint16(w*2,65535,!0);return e[6][0].data=fi(x),e[3][0].data=fi(b),h}function oM(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var a=Ua(r["!ref"]);a.s.r=a.s.c=0;var s=!1;a.e.c>9&&(s=!0,a.e.c=9),a.e.r>49&&(s=!0,a.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(_t(a)));var l=af(r,{range:a,header:1}),c=["~Sh33tJ5~"];l.forEach(function(z){return z.forEach(function(I){typeof I=="string"&&c.push(I)})});var u={},h=[],d=lt.read(t.numbers,{type:"base64"});d.FileIndex.map(function(z,I){return[z,d.FullPaths[I]]}).forEach(function(z){var I=z[0],L=z[1];if(I.type==2&&I.name.match(/\.iwa/)){var te=I.content,me=xn(te),ge=pn(me);ge.forEach(function(pe){h.push(pe.id),u[pe.id]={deps:[],location:L,type:wr(pe.messages[0].meta[1][0].data)}})}}),h.sort(function(z,I){return z-I});var g=h.filter(function(z){return z>1}).map(function(z){return[z,Xt(z)]});d.FileIndex.map(function(z,I){return[z,d.FullPaths[I]]}).forEach(function(z){var I=z[0];if(z[1],!!I.name.match(/\.iwa/)){var L=pn(xn(I.content));L.forEach(function(te){te.messages.forEach(function(me){g.forEach(function(ge){te.messages.some(function(pe){return wr(pe.meta[1][0].data)!=11006&&WF(pe.data,ge[1])})&&u[ge[0]].deps.push(te.id)})})})}});for(var x=lt.find(d,u[1].location),y=pn(xn(x.content)),_,b=0;b<y.length;++b){var w=y[b];w.id==1&&(_=w)}var S=ma(Ut(_.messages[0].data)[1][0].data);for(x=lt.find(d,u[S].location),y=pn(xn(x.content)),b=0;b<y.length;++b)w=y[b],w.id==S&&(_=w);for(S=ma(Ut(_.messages[0].data)[2][0].data),x=lt.find(d,u[S].location),y=pn(xn(x.content)),b=0;b<y.length;++b)w=y[b],w.id==S&&(_=w);for(S=ma(Ut(_.messages[0].data)[2][0].data),x=lt.find(d,u[S].location),y=pn(xn(x.content)),b=0;b<y.length;++b)w=y[b],w.id==S&&(_=w);var k=Ut(_.messages[0].data);{k[6][0].data=Xt(a.e.r+1),k[7][0].data=Xt(a.e.c+1);var C=ma(k[46][0].data),T=lt.find(d,u[C].location),j=pn(xn(T.content));{for(var X=0;X<j.length&&j[X].id!=C;++X);if(j[X].id!=C)throw"Bad ColumnRowUIDMapArchive";var D=Ut(j[X].messages[0].data);D[1]=[],D[2]=[],D[3]=[];for(var N=0;N<=a.e.c;++N){var W=[];W[1]=W[2]=[{type:0,data:Xt(N+420690)}],D[1].push({type:2,data:ia(W)}),D[2].push({type:0,data:Xt(N)}),D[3].push({type:0,data:Xt(N)})}D[4]=[],D[5]=[],D[6]=[];for(var P=0;P<=a.e.r;++P)W=[],W[1]=W[2]=[{type:0,data:Xt(P+726270)}],D[4].push({type:2,data:ia(W)}),D[5].push({type:0,data:Xt(P)}),D[6].push({type:0,data:Xt(P)});j[X].messages[0].data=ia(D)}T.content=no(ao(j)),T.size=T.content.length,delete k[46];var re=Ut(k[4][0].data);{re[7][0].data=Xt(a.e.r+1);var ae=Ut(re[1][0].data),Q=ma(ae[2][0].data);T=lt.find(d,u[Q].location),j=pn(xn(T.content));{if(j[0].id!=Q)throw"Bad HeaderStorageBucket";var xe=Ut(j[0].messages[0].data);for(P=0;P<l.length;++P){var Oe=Ut(xe[2][0].data);Oe[1][0].data=Xt(P),Oe[4][0].data=Xt(l[P].length),xe[2][P]={type:xe[2][0].type,data:ia(Oe)}}j[0].messages[0].data=ia(xe)}T.content=no(ao(j)),T.size=T.content.length;var Ae=ma(re[2][0].data);T=lt.find(d,u[Ae].location),j=pn(xn(T.content));{if(j[0].id!=Ae)throw"Bad HeaderStorageBucket";for(xe=Ut(j[0].messages[0].data),N=0;N<=a.e.c;++N)Oe=Ut(xe[2][0].data),Oe[1][0].data=Xt(N),Oe[4][0].data=Xt(a.e.r+1),xe[2][N]={type:xe[2][0].type,data:ia(Oe)};j[0].messages[0].data=ia(xe)}T.content=no(ao(j)),T.size=T.content.length;var K=ma(re[4][0].data);(function(){for(var z=lt.find(d,u[K].location),I=pn(xn(z.content)),L,te=0;te<I.length;++te){var me=I[te];me.id==K&&(L=me)}var ge=Ut(L.messages[0].data);{ge[3]=[];var pe=[];c.forEach(function(q,vt){pe[1]=[{type:0,data:Xt(vt)}],pe[2]=[{type:0,data:Xt(1)}],pe[3]=[{type:2,data:XF(q)}],ge[3].push({type:2,data:ia(pe)})})}L.messages[0].data=ia(ge);var Ee=ao(I),et=no(Ee);z.content=et,z.size=z.content.length})();var le=Ut(re[3][0].data);{var je=le[1][0];delete le[2];var U=Ut(je.data);{var ve=ma(U[2][0].data);(function(){for(var z=lt.find(d,u[ve].location),I=pn(xn(z.content)),L,te=0;te<I.length;++te){var me=I[te];me.id==ve&&(L=me)}var ge=Ut(L.messages[0].data);{delete ge[6],delete le[7];var pe=new Uint8Array(ge[5][0].data);ge[5]=[];for(var Ee=0,et=0;et<=a.e.r;++et){var q=Ut(pe);Ee+=lM(q,l[et],c),q[1][0].data=Xt(et),ge[5].push({data:ia(q),type:2})}ge[1]=[{type:0,data:Xt(a.e.c+1)}],ge[2]=[{type:0,data:Xt(a.e.r+1)}],ge[3]=[{type:0,data:Xt(Ee)}],ge[4]=[{type:0,data:Xt(a.e.r+1)}]}L.messages[0].data=ia(ge);var vt=ao(I),nt=no(vt);z.content=nt,z.size=z.content.length})()}je.data=ia(U)}re[3][0].data=ia(le)}k[4][0].data=ia(re)}_.messages[0].data=ia(k);var G=ao(y),A=no(G);return x.content=A,x.size=x.content.length,d}function gw(e){return function(r){for(var a=0;a!=e.length;++a){var s=e[a];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function n1(e){gw([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function s1(e){gw([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function cM(e){return At.WS.indexOf(e)>-1?"sheet":e==At.CS?"chart":e==At.DS?"dialog":e==At.MS?"macro":e&&e.length?e:"sheet"}function uM(e,t){if(!e)return 0;try{e=t.map(function(a){return a.id||(a.id=a.strRelID),[a.name,e["!id"][a.id].Target,cM(e["!id"][a.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function fM(e,t,r,a,s,l,c,u,h,d,g,x){try{l[a]=Nc(rn(e,r,!0),t);var y=jr(e,t),_;switch(u){case"sheet":_=FD(y,t,s,h,l[a],d,g,x);break;case"chart":if(_=MD(y,t,s,h,l[a],d,g,x),!_||!_["!drawel"])break;var b=Sc(_["!drawel"].Target,t),w=qc(b),S=_8(rn(e,b,!0),Nc(rn(e,w,!0),b)),k=Sc(S,b),C=qc(k);_=lD(rn(e,k,!0),k,h,Nc(rn(e,C,!0),k),d,_);break;case"macro":_=jD(y,t,s,h,l[a],d,g,x);break;case"dialog":_=ID(y,t,s,h,l[a],d,g,x);break;default:throw new Error("Unrecognized sheet type "+u)}c[a]=_;var T=[];l&&l[a]&&br(l[a]).forEach(function(j){var X="";if(l[a][j].Type==At.CMNT){X=Sc(l[a][j].Target,t);var D=PD(jr(e,X,!0),X,h);if(!D||!D.length)return;Sy(_,D,!1)}l[a][j].Type==At.TCMNT&&(X=Sc(l[a][j].Target,t),T=T.concat(b8(jr(e,X,!0),h)))}),T&&T.length&&Sy(_,T,!0,h.people||[])}catch(j){if(h.WTF)throw j}}function mn(e){return e.charAt(0)=="/"?e.slice(1):e}function hM(e,t){if(So(),t=t||{},n1(t),vn(e,"META-INF/manifest.xml")||vn(e,"objectdata.xml"))return My(e,t);if(vn(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof $d<"u"){if(e.FileIndex)return $d(e);var r=lt.utils.cfb_new();return Vv(e).forEach(function(Oe){St(r,Oe,SA(e,Oe))}),$d(r)}throw new Error("Unsupported NUMBERS file")}if(!vn(e,"[Content_Types].xml"))throw vn(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):vn(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var a=Vv(e),s=p3(rn(e,"[Content_Types].xml")),l=!1,c,u;if(s.workbooks.length===0&&(u="xl/workbook.xml",jr(e,u,!0)&&s.workbooks.push(u)),s.workbooks.length===0){if(u="xl/workbook.bin",!jr(e,u,!0))throw new Error("Could not find workbook");s.workbooks.push(u),l=!0}s.workbooks[0].slice(-3)=="bin"&&(l=!0);var h={},d={};if(!t.bookSheets&&!t.bookProps){if(Oc=[],s.sst)try{Oc=UD(jr(e,mn(s.sst)),s.sst,t)}catch(Oe){if(t.WTF)throw Oe}t.cellStyles&&s.themes.length&&(h=BD(rn(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(d=LD(jr(e,mn(s.style)),s.style,h,t))}s.links.map(function(Oe){try{var Ae=Nc(rn(e,qc(mn(Oe))),Oe);return HD(jr(e,mn(Oe)),Ae,Oe,t)}catch{}});var g=DD(jr(e,mn(s.workbooks[0])),s.workbooks[0],t),x={},y="";s.coreprops.length&&(y=jr(e,mn(s.coreprops[0]),!0),y&&(x=a2(y)),s.extprops.length!==0&&(y=jr(e,mn(s.extprops[0]),!0),y&&S3(y,x,t)));var _={};(!t.bookSheets||t.bookProps)&&s.custprops.length!==0&&(y=rn(e,mn(s.custprops[0]),!0),y&&(_=T3(y,t)));var b={};if((t.bookSheets||t.bookProps)&&(g.Sheets?c=g.Sheets.map(function(Ae){return Ae.name}):x.Worksheets&&x.SheetNames.length>0&&(c=x.SheetNames),t.bookProps&&(b.Props=x,b.Custprops=_),t.bookSheets&&typeof c<"u"&&(b.SheetNames=c),t.bookSheets?b.SheetNames:t.bookProps))return b;c={};var w={};t.bookDeps&&s.calcchain&&(w=zD(jr(e,mn(s.calcchain)),s.calcchain));var S=0,k={},C,T;{var j=g.Sheets;x.Worksheets=j.length,x.SheetNames=[];for(var X=0;X!=j.length;++X)x.SheetNames[X]=j[X].name}var D=l?"bin":"xml",N=s.workbooks[0].lastIndexOf("/"),W=(s.workbooks[0].slice(0,N+1)+"_rels/"+s.workbooks[0].slice(N+1)+".rels").replace(/^\//,"");vn(e,W)||(W="xl/_rels/workbook."+D+".rels");var P=Nc(rn(e,W,!0),W.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=$D(jr(e,mn(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=E8(jr(e,mn(s.people[0])),t)),P&&(P=uM(P,g.Sheets));var re=jr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(S=0;S!=x.Worksheets;++S){var ae="sheet";if(P&&P[S]?(C="xl/"+P[S][1].replace(/[\/]?xl\//,""),vn(e,C)||(C=P[S][1]),vn(e,C)||(C=W.replace(/_rels\/.*$/,"")+P[S][1]),ae=P[S][2]):(C="xl/worksheets/sheet"+(S+1-re)+"."+D,C=C.replace(/sheet0\./,"sheet.")),T=C.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(S!=t.sheets)continue e;break;case"string":if(x.SheetNames[S].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var Q=!1,xe=0;xe!=t.sheets.length;++xe)typeof t.sheets[xe]=="number"&&t.sheets[xe]==S&&(Q=1),typeof t.sheets[xe]=="string"&&t.sheets[xe].toLowerCase()==x.SheetNames[S].toLowerCase()&&(Q=1);if(!Q)continue e}}fM(e,C,T,x.SheetNames[S],S,k,c,ae,t,g,h,d)}return b={Directory:s,Workbook:g,Props:x,Custprops:_,Deps:w,Sheets:c,SheetNames:x.SheetNames,Strings:Oc,Styles:d,Themes:h,SSF:fr(ft)},t&&t.bookFiles&&(e.files?(b.keys=a,b.files=e.files):(b.keys=[],b.files={},e.FullPaths.forEach(function(Oe,Ae){Oe=Oe.replace(/^Root Entry[\/]/,""),b.keys.push(Oe),b.files[Oe]=e.FileIndex[Ae]}))),t&&t.bookVBA&&(s.vba.length>0?b.vbaraw=jr(e,mn(s.vba[0]),!0):s.defaults&&s.defaults.bin===D8&&(b.vbaraw=jr(e,"xl/vbaProject.bin",!0))),b}function dM(e,t){var r=t||{},a="Workbook",s=lt.find(e,a);try{if(a="/!DataSpaces/Version",s=lt.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);if($N(s.content),a="/!DataSpaces/DataSpaceMap",s=lt.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);var l=GN(s.content);if(l.length!==1||l[0].comps.length!==1||l[0].comps[0].t!==0||l[0].name!=="StrongEncryptionDataSpace"||l[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=lt.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);var c=qN(s.content);if(c.length!=1||c[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=lt.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);WN(s.content)}catch{}if(a="/EncryptionInfo",s=lt.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);var u=KN(s.content);if(a="/EncryptedPackage",s=lt.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(u[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(u[1],s.content,r.password||"",r);if(u[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(u[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function mM(e,t){return t.bookType=="ods"?mw(e,t):t.bookType=="numbers"?oM(e,t):t.bookType=="xlsb"?gM(e,t):pM(e,t)}function gM(e,t){uo=1024,e&&!e.SSF&&(e.SSF=fr(ft)),e&&e.SSF&&(So(),cf(e.SSF),t.revssf=ff(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Rc?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",a=H2.indexOf(t.bookType)>-1,s=Vm();s1(t=t||{});var l=Om(),c="",u=0;if(t.cellXfs=[],mi(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),c="docProps/core.xml",St(l,c,n2(e.Props,t)),s.coreprops.push(c),Wt(t.rels,2,c,At.CORE_PROPS),c="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var h=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&h.push(e.SheetNames[d]);e.Props.SheetNames=h}for(e.Props.Worksheets=e.Props.SheetNames.length,St(l,c,l2(e.Props)),s.extprops.push(c),Wt(t.rels,3,c,At.EXT_PROPS),e.Custprops!==e.Props&&br(e.Custprops||{}).length>0&&(c="docProps/custom.xml",St(l,c,o2(e.Custprops)),s.custprops.push(c),Wt(t.rels,4,c,At.CUST_PROPS)),u=1;u<=e.SheetNames.length;++u){var g={"!id":{}},x=e.Sheets[e.SheetNames[u-1]],y=(x||{})["!type"]||"sheet";if(c="xl/worksheets/sheet"+u+"."+r,St(l,c,GD(u-1,c,t,e,g)),s.sheets.push(c),Wt(t.wbrels,-1,"worksheets/sheet"+u+"."+r,At.WS[0]),x){var _=x["!comments"],b=!1,w="";_&&_.length>0&&(w="xl/comments"+u+"."+r,St(l,w,WD(_,w)),s.comments.push(w),Wt(g,-1,"../comments"+u+"."+r,At.CMNT),b=!0),x["!legacy"]&&b&&St(l,"xl/drawings/vmlDrawing"+u+".vml",P2(u,x["!comments"])),delete x["!comments"],delete x["!legacy"]}g["!id"].rId1&&St(l,qc(c),mo(g))}return t.Strings!=null&&t.Strings.length>0&&(c="xl/sharedStrings."+r,St(l,c,XD(t.Strings,c,t)),s.strs.push(c),Wt(t.wbrels,-1,"sharedStrings."+r,At.SST)),c="xl/workbook."+r,St(l,c,VD(e,c)),s.workbooks.push(c),Wt(t.rels,1,c,At.WB),c="xl/theme/theme1.xml",St(l,c,Ym(e.Themes,t)),s.themes.push(c),Wt(t.wbrels,-1,"theme/theme1.xml",At.THEME),c="xl/styles."+r,St(l,c,qD(e,c,t)),s.styles.push(c),Wt(t.wbrels,-1,"styles."+r,At.STY),e.vbaraw&&a&&(c="xl/vbaProject.bin",St(l,c,e.vbaraw),s.vba.push(c),Wt(t.wbrels,-1,"vbaProject.bin",At.VBA)),c="xl/metadata."+r,St(l,c,KD(c)),s.metadata.push(c),Wt(t.wbrels,-1,"metadata."+r,At.XLMETA),St(l,"[Content_Types].xml",t2(s,t)),St(l,"_rels/.rels",mo(t.rels)),St(l,"xl/_rels/workbook."+r+".rels",mo(t.wbrels)),delete t.revssf,delete t.ssf,l}function pM(e,t){uo=1024,e&&!e.SSF&&(e.SSF=fr(ft)),e&&e.SSF&&(So(),cf(e.SSF),t.revssf=ff(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Rc?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",a=H2.indexOf(t.bookType)>-1,s=Vm();s1(t=t||{});var l=Om(),c="",u=0;if(t.cellXfs=[],mi(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),c="docProps/core.xml",St(l,c,n2(e.Props,t)),s.coreprops.push(c),Wt(t.rels,2,c,At.CORE_PROPS),c="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var h=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&h.push(e.SheetNames[d]);e.Props.SheetNames=h}e.Props.Worksheets=e.Props.SheetNames.length,St(l,c,l2(e.Props)),s.extprops.push(c),Wt(t.rels,3,c,At.EXT_PROPS),e.Custprops!==e.Props&&br(e.Custprops||{}).length>0&&(c="docProps/custom.xml",St(l,c,o2(e.Custprops)),s.custprops.push(c),Wt(t.rels,4,c,At.CUST_PROPS));var g=["SheetJ5"];for(t.tcid=0,u=1;u<=e.SheetNames.length;++u){var x={"!id":{}},y=e.Sheets[e.SheetNames[u-1]],_=(y||{})["!type"]||"sheet";if(c="xl/worksheets/sheet"+u+"."+r,St(l,c,Z2(u-1,t,e,x)),s.sheets.push(c),Wt(t.wbrels,-1,"worksheets/sheet"+u+"."+r,At.WS[0]),y){var b=y["!comments"],w=!1,S="";if(b&&b.length>0){var k=!1;b.forEach(function(C){C[1].forEach(function(T){T.T==!0&&(k=!0)})}),k&&(S="xl/threadedComments/threadedComment"+u+"."+r,St(l,S,S8(b,g,t)),s.threadedcomments.push(S),Wt(x,-1,"../threadedComments/threadedComment"+u+"."+r,At.TCMNT)),S="xl/comments"+u+"."+r,St(l,S,z2(b)),s.comments.push(S),Wt(x,-1,"../comments"+u+"."+r,At.CMNT),w=!0}y["!legacy"]&&w&&St(l,"xl/drawings/vmlDrawing"+u+".vml",P2(u,y["!comments"])),delete y["!comments"],delete y["!legacy"]}x["!id"].rId1&&St(l,qc(c),mo(x))}return t.Strings!=null&&t.Strings.length>0&&(c="xl/sharedStrings."+r,St(l,c,C2(t.Strings,t)),s.strs.push(c),Wt(t.wbrels,-1,"sharedStrings."+r,At.SST)),c="xl/workbook."+r,St(l,c,nw(e)),s.workbooks.push(c),Wt(t.rels,1,c,At.WB),c="xl/theme/theme1.xml",St(l,c,Ym(e.Themes,t)),s.themes.push(c),Wt(t.wbrels,-1,"theme/theme1.xml",At.THEME),c="xl/styles."+r,St(l,c,I2(e,t)),s.styles.push(c),Wt(t.wbrels,-1,"styles."+r,At.STY),e.vbaraw&&a&&(c="xl/vbaProject.bin",St(l,c,e.vbaraw),s.vba.push(c),Wt(t.wbrels,-1,"vbaProject.bin",At.VBA)),c="xl/metadata."+r,St(l,c,U2()),s.metadata.push(c),Wt(t.wbrels,-1,"metadata."+r,At.XLMETA),g.length>1&&(c="xl/persons/person.xml",St(l,c,T8(g)),s.people.push(c),Wt(t.wbrels,-1,"persons/person.xml",At.PEOPLE)),St(l,"[Content_Types].xml",t2(s,t)),St(l,"_rels/.rels",mo(t.rels)),St(l,"xl/_rels/workbook."+r+".rels",mo(t.wbrels)),delete t.revssf,delete t.ssf,l}function i1(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=an(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function xM(e,t){return lt.find(e,"EncryptedPackage")?dM(e,t):ow(e,t)}function vM(e,t){var r,a=e,s=t||{};return s.type||(s.type=Tt&&Buffer.isBuffer(e)?"buffer":"base64"),r=O_(a,s),hM(r,s)}function pw(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return hm(e.slice(r),t);default:break e}return _o.to_workbook(e,t)}function yM(e,t){var r="",a=i1(e,t);switch(t.type){case"base64":r=an(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Ji(e);break;default:throw new Error("Unrecognized type "+t.type)}return a[0]==239&&a[1]==187&&a[2]==191&&(r=rr(r)),t.type="binary",pw(r,t)}function _M(e,t){var r=e;return t.type=="base64"&&(r=an(r)),r=Pc.utils.decode(1200,r.slice(2),"str"),t.type="binary",pw(r,t)}function wM(e){return e.match(/[^\x00-\x7F]/)?Kn(e):e}function Vd(e,t,r,a){return a?(r.type="string",_o.to_workbook(e,r)):_o.to_workbook(t,r)}function rf(e,t){Tm();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return rf(new Uint8Array(e),(r=fr(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var a=e,s=[0,0,0,0],l=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),po={},r.dateNF&&(po.dateNF=r.dateNF),r.type||(r.type=Tt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Tt?"buffer":"binary",a=gA(e),typeof Uint8Array<"u"&&!Tt&&(r.type="array")),r.type=="string"&&(l=!0,r.type="binary",r.codepage=65001,a=wM(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var c=new ArrayBuffer(3),u=new Uint8Array(c);if(u.foo="bar",!u.foo)return r=fr(r),r.type="array",rf(km(a),r)}switch((s=i1(a,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return xM(lt.read(a,r),r);break;case 9:if(s[1]<=8)return ow(a,r);break;case 60:return hm(a,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return kN(a,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return k2.to_workbook(a,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?vM(a,r):Vd(e,a,r,l);case 239:return s[3]===60?hm(a,r):Vd(e,a,r,l);case 255:if(s[1]===254)return _M(a,r);if(s[1]===0&&s[2]===2&&s[3]===0)return Xi.to_workbook(a,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return Xi.to_workbook(a,r);break;case 3:case 131:case 139:case 140:return fm.to_workbook(a,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return F2.to_workbook(a,r);break;case 10:case 13:case 32:return yM(a,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return TN.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?fm.to_workbook(a,r):Vd(e,a,r,l)}function xw(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return au(t.file,lt.write(e,{type:Tt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return lt.write(e,t)}function bM(e,t){var r=fr(t||{}),a=mM(e,r);return SM(a,r)}function SM(e,t){var r={},a=Tt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=a;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=a;break;default:throw new Error("Unrecognized type "+t.type)}var s=e.FullPaths?lt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(t.type=="binary"||t.type=="base64")return s;s=new Uint8Array(of(s))}return t.password&&typeof encrypt_agile<"u"?xw(encrypt_agile(s,t.password),t):t.type==="file"?au(t.file,s):t.type=="string"?rr(s):s}function EM(e,t){var r=t||{},a=wF(e,r);return xw(a,r)}function Wn(e,t,r){r||(r="");var a=r+e;switch(t.type){case"base64":return zc(Kn(a));case"binary":return Kn(a);case"string":return e;case"file":return au(t.file,a,"utf8");case"buffer":return Tt?ks(a,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(a):Wn(a,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function TM(e,t){switch(t.type){case"base64":return zc(e);case"binary":return e;case"string":return e;case"file":return au(t.file,e,"binary");case"buffer":return Tt?ks(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function B0(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",a=0;a<e.length;++a)r+=String.fromCharCode(e[a]);return t.type=="base64"?zc(r):t.type=="string"?rr(r):r;case"file":return au(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function vw(e,t){Tm(),xD(e);var r=fr(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var a=vw(e,r);return r.type="array",of(a)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=e.SheetNames.indexOf(r.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Wn(mF(e,r),r);case"slk":case"sylk":return Wn(T2.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"htm":case"html":return Wn(uw(e.Sheets[e.SheetNames[s]],r),r);case"txt":return TM(yw(e.Sheets[e.SheetNames[s]],r),r);case"csv":return Wn(l1(e.Sheets[e.SheetNames[s]],r),r,"\uFEFF");case"dif":return Wn(k2.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"dbf":return B0(fm.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"prn":return Wn(_o.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"rtf":return Wn(F2.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"eth":return Wn(A2.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"fods":return Wn(mw(e,r),r);case"wk1":return B0(Xi.sheet_to_wk1(e.Sheets[e.SheetNames[s]],r),r);case"wk3":return B0(Xi.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),B0(cw(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),EM(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return bM(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function kM(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function Uy(e,t,r){var a={};return a.type="file",a.file=t,kM(a),vw(e,a)}function AM(e,t,r,a,s,l,c,u){var h=Ar(r),d=u.defval,g=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),x=!0,y=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(y,"__rowNum__",{value:r,enumerable:!1})}catch{y.__rowNum__=r}else y.__rowNum__=r;if(!c||e[r])for(var _=t.s.c;_<=t.e.c;++_){var b=c?e[r][_]:e[a[_]+h];if(b===void 0||b.t===void 0){if(d===void 0)continue;l[_]!=null&&(y[l[_]]=d);continue}var w=b.v;switch(b.t){case"z":if(w==null)break;continue;case"e":w=w==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+b.t)}if(l[_]!=null){if(w==null)if(b.t=="e"&&w===null)y[l[_]]=null;else if(d!==void 0)y[l[_]]=d;else if(g&&w===null)y[l[_]]=null;else continue;else y[l[_]]=g&&(b.t!=="n"||b.t==="n"&&u.rawNumbers!==!1)?w:Es(b,w,u);w!=null&&(x=!1)}}return{row:y,isempty:x}}function af(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},a=0,s=1,l=[],c=0,u="",h={s:{r:0,c:0},e:{r:0,c:0}},d=t||{},g=d.range!=null?d.range:e["!ref"];switch(d.header===1?a=1:d.header==="A"?a=2:Array.isArray(d.header)?a=3:d.header==null&&(a=0),typeof g){case"string":h=Mt(g);break;case"number":h=Mt(e["!ref"]),h.s.r=g;break;default:h=g}a>0&&(s=0);var x=Ar(h.s.r),y=[],_=[],b=0,w=0,S=Array.isArray(e),k=h.s.r,C=0,T={};S&&!e[k]&&(e[k]=[]);var j=d.skipHidden&&e["!cols"]||[],X=d.skipHidden&&e["!rows"]||[];for(C=h.s.c;C<=h.e.c;++C)if(!(j[C]||{}).hidden)switch(y[C]=gr(C),r=S?e[k][C]:e[y[C]+x],a){case 1:l[C]=C-h.s.c;break;case 2:l[C]=y[C];break;case 3:l[C]=d.header[C-h.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),u=c=Es(r,null,d),w=T[c]||0,!w)T[c]=1;else{do u=c+"_"+w++;while(T[u]);T[c]=w,T[u]=1}l[C]=u}for(k=h.s.r+s;k<=h.e.r;++k)if(!(X[k]||{}).hidden){var D=AM(e,h,k,y,a,l,S,d);(D.isempty===!1||(a===1?d.blankrows!==!1:d.blankrows))&&(_[b++]=D.row)}return _.length=b,_}var Py=/"/g;function CM(e,t,r,a,s,l,c,u){for(var h=!0,d=[],g="",x=Ar(r),y=t.s.c;y<=t.e.c;++y)if(a[y]){var _=u.dense?(e[r]||[])[y]:e[a[y]+x];if(_==null)g="";else if(_.v!=null){h=!1,g=""+(u.rawNumbers&&_.t=="n"?_.v:Es(_,null,u));for(var b=0,w=0;b!==g.length;++b)if((w=g.charCodeAt(b))===s||w===l||w===34||u.forceQuotes){g='"'+g.replace(Py,'""')+'"';break}g=="ID"&&(g='"ID"')}else _.f!=null&&!_.F?(h=!1,g="="+_.f,g.indexOf(",")>=0&&(g='"'+g.replace(Py,'""')+'"')):g="";d.push(g)}return u.blankrows===!1&&h?null:d.join(c)}function l1(e,t){var r=[],a=t??{};if(e==null||e["!ref"]==null)return"";var s=Mt(e["!ref"]),l=a.FS!==void 0?a.FS:",",c=l.charCodeAt(0),u=a.RS!==void 0?a.RS:`
`,h=u.charCodeAt(0),d=new RegExp((l=="|"?"\\|":l)+"+$"),g="",x=[];a.dense=Array.isArray(e);for(var y=a.skipHidden&&e["!cols"]||[],_=a.skipHidden&&e["!rows"]||[],b=s.s.c;b<=s.e.c;++b)(y[b]||{}).hidden||(x[b]=gr(b));for(var w=0,S=s.s.r;S<=s.e.r;++S)(_[S]||{}).hidden||(g=CM(e,s,S,x,c,h,l,a),g!=null&&(a.strip&&(g=g.replace(d,"")),(g||a.blankrows!==!1)&&r.push((w++?u:"")+g)));return delete a.dense,r.join("")}function yw(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=l1(e,t);return r}function NM(e){var t="",r,a="";if(e==null||e["!ref"]==null)return[];var s=Mt(e["!ref"]),l="",c=[],u,h=[],d=Array.isArray(e);for(u=s.s.c;u<=s.e.c;++u)c[u]=gr(u);for(var g=s.s.r;g<=s.e.r;++g)for(l=Ar(g),u=s.s.c;u<=s.e.c;++u)if(t=c[u]+l,r=d?(e[g]||[])[u]:e[t],a="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;a=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)a=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)a=""+r.v;else if(r.t=="b")a=r.v?"TRUE":"FALSE";else if(r.w!==void 0)a="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?a="'"+r.v:a=""+r.v}}h[h.length]=t+"="+a}return h}function _w(e,t,r){var a=r||{},s=+!a.skipHeader,l=e||{},c=0,u=0;if(l&&a.origin!=null)if(typeof a.origin=="number")c=a.origin;else{var h=typeof a.origin=="string"?pr(a.origin):a.origin;c=h.r,u=h.c}var d,g={s:{c:0,r:0},e:{c:u,r:c+t.length-1+s}};if(l["!ref"]){var x=Mt(l["!ref"]);g.e.c=Math.max(g.e.c,x.e.c),g.e.r=Math.max(g.e.r,x.e.r),c==-1&&(c=x.e.r+1,g.e.r=c+t.length-1+s)}else c==-1&&(c=0,g.e.r=t.length-1+s);var y=a.header||[],_=0;t.forEach(function(w,S){br(w).forEach(function(k){(_=y.indexOf(k))==-1&&(y[_=y.length]=k);var C=w[k],T="z",j="",X=ht({c:u+_,r:c+S+s});d=Zc(l,X),C&&typeof C=="object"&&!(C instanceof Date)?l[X]=C:(typeof C=="number"?T="n":typeof C=="boolean"?T="b":typeof C=="string"?T="s":C instanceof Date?(T="d",a.cellDates||(T="n",C=Hr(C)),j=a.dateNF||ft[14]):C===null&&a.nullError&&(T="e",C=0),d?(d.t=T,d.v=C,delete d.w,delete d.R,j&&(d.z=j)):l[X]=d={t:T,v:C},j&&(d.z=j))})}),g.e.c=Math.max(g.e.c,u+y.length-1);var b=Ar(c);if(s)for(_=0;_<y.length;++_)l[gr(_+u)+b]={t:"s",v:y[_]};return l["!ref"]=_t(g),l}function OM(e,t){return _w(null,e,t)}function Zc(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var a=pr(t);return e[a.r]||(e[a.r]=[]),e[a.r][a.c]||(e[a.r][a.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Zc(e,ht(t)):Zc(e,ht({r:t,c:r||0}))}function RM(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function o1(){return{SheetNames:[],Sheets:{}}}function c1(e,t,r,a){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&e.SheetNames.indexOf(r)>=0){var l=r.match(/(^.*?)(\d+)$/);s=l&&+l[2]||0;var c=l&&l[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=c+s)!=-1;++s);}if(aw(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function DM(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var a=RM(e,t);switch(e.Workbook.Sheets[a]||(e.Workbook.Sheets[a]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[a].Hidden=r}function FM(e,t){return e.z=t,e}function ww(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function MM(e,t,r){return ww(e,"#"+t,r)}function jM(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function IM(e,t,r,a){for(var s=typeof t!="string"?t:Mt(t),l=typeof t=="string"?t:_t(t),c=s.s.r;c<=s.e.r;++c)for(var u=s.s.c;u<=s.e.c;++u){var h=Zc(e,c,u);h.t="n",h.F=l,delete h.v,c==s.s.r&&u==s.s.c&&(h.f=r,a&&(h.D=!0))}return e}var ri={encode_col:gr,encode_row:Ar,encode_cell:ht,encode_range:_t,decode_col:Bm,decode_row:Lm,split_cell:XA,decode_cell:pr,decode_range:Ua,format_cell:Es,sheet_add_aoa:W_,sheet_add_json:_w,sheet_add_dom:fw,aoa_to_sheet:Eo,json_to_sheet:OM,table_to_sheet:hw,table_to_book:$F,sheet_to_csv:l1,sheet_to_txt:yw,sheet_to_json:af,sheet_to_html:uw,sheet_to_formulae:NM,sheet_to_row_object_array:af,sheet_get_cell:Zc,book_new:o1,book_append_sheet:c1,book_set_sheet_visibility:DM,cell_set_number_format:FM,cell_set_hyperlink:ww,cell_set_internal_link:MM,cell_add_comment:jM,sheet_set_array_formula:IM,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function Gd(e){const t=String(e??"").trim();if(!t)return 0;const r=t.replace(/\s/g,""),a=r.includes(","),s=r.includes(".");let l=r;a&&s?l=r.replace(/,/g,""):a&&!s&&(l=r.replace(/,/g,"."));const c=Number.parseFloat(l);return Number.isFinite(c)?c:0}function LM(e,t){if(!e||!t)return null;const r=t.getTime()-e.getTime();return Math.ceil(r/(1440*60*1e3))}function BM(e,t){const r=new Date(`${t}T00:00:00`);return(e??[]).map(s=>{const l=s?.scheduled_receipt_date?String(s.scheduled_receipt_date):"",c=l?new Date(`${l.slice(0,10)}T00:00:00`):null;return c&&Number.isFinite(c.getTime())?c:null}).filter(Boolean).filter(s=>s.getTime()>=r.getTime()).sort((s,l)=>s.getTime()-l.getTime())[0]??null}function UM(e){const t=String(e??"").trim();if(!t)return null;const r=t.slice(0,10);if(!/^\d{4}-\d{2}-\d{2}$/.test(r))return null;const s=new Date(`${r}T00:00:00`).getTime();return Number.isFinite(s)?s:null}function PM(){const[e,t]=Ce.useState(()=>new Date().toISOString().slice(0,10)),[r,a]=Ce.useState("inventory"),[s,l]=Ce.useState(!0),[c,u]=Ce.useState([]),[h,d]=Ce.useState(""),[g,x]=Ce.useState("772"),[y,_]=Ce.useState(!1),[b,w]=Ce.useState(!1),[S,k]=Ce.useState(50),[C,T]=Ce.useState({771:1,772:1}),[j,X]=Ce.useState(!1),[D,N]=Ce.useState(null),[W,P]=Ce.useState({loading:!0,message:"",type:""}),re=Ce.useRef(null),ae=Ce.useRef(null),[Q,xe]=Ce.useState({loading:!1,message:"",type:""}),Oe=Ce.useRef(null),[Ae,K]=Ce.useState({loading:!1,message:"",type:""}),le=Ce.useRef(null),[je,U]=Ce.useState({loading:!1,message:"",type:""}),[ve,G]=Ce.useState([]),[A,z]=Ce.useState(null),I=Ce.useRef(null),[L,te]=Ce.useState({loading:!1,message:"",type:""}),[me,ge]=Ce.useState([]),[pe,Ee]=Ce.useState(""),[et,q]=Ce.useState(1),[vt,nt]=Ce.useState(50),kt=Ce.useRef(null),[gt,Re]=Ce.useState({loading:!1,message:"",type:""}),[jt,sr]=Ce.useState([]),[$r,wa]=Ce.useState(""),[Sn,ka]=Ce.useState(1),[It,Pa]=Ce.useState(50),[za,Vr]=Ce.useState({loading:!1,message:"",type:""}),[hr,Qr]=Ce.useState([]),pt=J=>{const Z=J?.message?String(J.message):"";return Z.toLowerCase().includes("schema cache")||Z.toLowerCase().includes("could not find the table")?"Parece que en Supabase an no existe (o no se ha refrescado) la tabla `public.tertiary_packaging`. Ejecuta `supabase/schema.sql` en Supabase (SQL Editor) y luego recarga el schema con: NOTIFY pgrst, 'reload schema';":""},$t=J=>{const Z=J?.message?String(J.message):"";return Z.toLowerCase().includes("schema cache")||Z.toLowerCase().includes("could not find the table")?"Parece que en Supabase an no existe (o no se ha refrescado) la tabla `public.medication_categories`. Ejecuta `supabase/schema.sql` en Supabase (SQL Editor) y luego recarga el schema con: NOTIFY pgrst, 'reload schema';":""},Gr=J=>{const Z=J?.message?String(J.message):"";return Z.toLowerCase().includes("schema cache")||Z.toLowerCase().includes("could not find the table")?"Parece que en Supabase an no existe (o no se ha refrescado) la tabla `public.order_calendar`. Ejecuta `supabase/schema.sql` en Supabase (SQL Editor) y luego recarga el schema con: NOTIFY pgrst, 'reload schema';":""};Ce.useEffect(()=>{let J=!1;async function Z(){P({loading:!0,message:ni?"Conectando a Supabase...":"Cargando datos locales...",type:"info"});try{const[se,Te,Me]=await Promise.all([bt.getMedications(),bt.getMonthlyBatches(),bt.getSelectedMonthlyBatchId?.()]);if(J)return;u(se??[]);const Ie=(Te??[]).map(Xe=>({...Xe,id:Xe?.id!=null?String(Xe.id):Xe.id}));G(Ie);try{const Xe=await bt.getTertiaryPackaging?.()??[];J||ge(Xe??[])}catch(Xe){const Pe=pt(Xe);J||(ge([]),te({loading:!1,message:Pe?`${String(Xe?.message||Xe||"Error al cargar Empaque Terciario.")}. ${Pe}`:String(Xe?.message||Xe||"Error al cargar Empaque Terciario."),type:"error"}))}try{const Xe=await bt.getMedicationCategories?.()??[];J||sr(Xe??[])}catch(Xe){const Pe=$t(Xe);J||(sr([]),Re({loading:!1,message:Pe?`${String(Xe?.message||Xe||"Error al cargar Categoras.")}. ${Pe}`:String(Xe?.message||Xe||"Error al cargar Categoras."),type:"error"}))}try{const Xe=await bt.getOrderCalendar?.()??[];J||Qr(Xe??[])}catch(Xe){const Pe=Gr(Xe);J||(Qr([]),Vr({loading:!1,message:Pe?`${String(Xe?.message||Xe||"Error al cargar Calendario.")}. ${Pe}`:String(Xe?.message||Xe||"Error al cargar Calendario."),type:"error"}))}const Ve=Me!=null?String(Me):null,Je=Ie?.[0]?.id??null,rt=Ve&&Ie.some(Xe=>Xe.id===Ve)?Ve:Je;z(rt),await bt.setSelectedMonthlyBatchId?.(rt),P({loading:!1,message:"",type:""})}catch(se){if(J)return;P({loading:!1,message:se?.message?String(se.message):"No se pudieron cargar los datos.",type:"error"})}}return Z(),()=>{J=!0}},[]);const Vt=J=>{const Z=J==null?null:String(J);z(Z),bt.setSelectedMonthlyBatchId?.(Z)},Pt=J=>{const Z=String(J??"").trim();if(!Z)return"";const se=Z.replace(/\D/g,"");return se.length===9?`${se.slice(0,3)}-${se.slice(3,5)}-${se.slice(5,9)}`:Z.replace(/\s+/g," ")};Ce.useEffect(()=>{const J=new Date,Z=new Date(J.getFullYear(),J.getMonth(),J.getDate()+1,0,0,0,50),se=Math.max(1e3,Z.getTime()-J.getTime()),Te=window.setTimeout(()=>t(new Date().toISOString().slice(0,10)),se);return()=>window.clearTimeout(Te)},[e]);const ca=Ce.useMemo(()=>BM(hr,e),[hr,e]),qr=Ce.useMemo(()=>{const J=(ve??[]).filter(se=>(se?.items??[]).length>0).slice(0,3),Z=new Map;for(const se of J){const Te=new Map;for(const Me of se?.items??[]){const Ie=String(Me?.siges_code||"").trim();Ie&&Te.set(Ie,(Te.get(Ie)||0)+Gd(Me?.quantity))}for(const[Me,Ie]of Te.entries()){const Ve=Z.get(Me)||[];Ve.push(Ie),Z.set(Me,Ve)}}for(const[se,Te]of Z.entries()){for(;Te.length<3;)Te.push(0);const Me=(Te[0]+Te[1]+Te[2])/3;Z.set(se,Me)}return Z},[ve]),Qn=Ce.useMemo(()=>{const J=(ve??[]).filter(se=>(se?.items??[]).length>0).slice(0,4),Z=new Map;for(const se of J)for(const Te of se?.items??[]){const Me=String(Te?.siges_code||"").trim();Me&&Z.set(Me,(Z.get(Me)||0)+Gd(Te?.quantity))}return Z},[ve]),Zn=Ce.useMemo(()=>{const J=new Date(`${e}T00:00:00`),Z=ca?LM(J,ca):null,se=Math.max(0,Number(Z)||0)+4,Te=new Map;for(const Ie of c??[]){const Ve=String(Ie?.siges_code||"").trim();if(!Ve)continue;const Je=Te.get(Ve),st=Number(Ie?.stock)||0,rt=Number(Ie?.min_stock)||0,Xe=String(Ie?.name||"").trim(),Pe=UM(Ie?.expiry_date),Ye=!Je||String(Je?.inventory_type||"772")!=="772"&&String(Ie?.inventory_type||"772")==="772";if(!Je)Te.set(Ve,{...Ie,siges_code:Ve,name:Xe,stock:st,min_stock:rt,_sumStock:st,_minExpiryMs:Pe,nearest_expiry_date:Pe?String(Ie?.expiry_date).slice(0,10):""});else{const Be=Je?._minExpiryMs??null,ze=Pe==null?Be:Be==null?Pe:Math.min(Be,Pe),Ze=ze==null?"":ze===Be?String(Je?.nearest_expiry_date||""):String(Ie?.expiry_date||"").slice(0,10);Te.set(Ve,{...Ye?{...Je,...Ie}:Je,siges_code:Ve,name:Ye&&Xe||Je.name,min_stock:Math.max(Je.min_stock||0,rt),_sumStock:(Je._sumStock||0)+st,_minExpiryMs:ze,nearest_expiry_date:Ze})}}const Me=[];for(const Ie of Te.values()){const Ve=String(Ie.siges_code||"").trim(),Je=Number(Ie._sumStock)||0,st=qr.get(Ve)||0,rt=Qn.get(Ve)||0,Xe=st/30,Pe=Number(Ie.min_stock)||0,Ye=ca?Xe*se:Pe,Be=Number.isFinite(Ye)?Ye:Pe;rt<=0||Je<=Be&&Me.push({...Ie,stock:Je,computed_min_stock:Be,_daysToReceipt:Z})}return Me.sort((Ie,Ve)=>(Number(Ve.computed_min_stock)||0)-(Number(Ve.stock)||0)-((Number(Ie.computed_min_stock)||0)-(Number(Ie.stock)||0))),Me},[qr,c,Qn,ca,e]),fl=Ce.useMemo(()=>({totalItems:c.length,lowStockCount:Zn.length,totalStockValue:c.reduce((J,Z)=>J+Z.stock,0),recentConsumptions:ve[0]?.items?.length||0}),[c,Zn,ve]),ua=Ce.useMemo(()=>{const J=String(g||"772"),Z=h.trim().toLowerCase(),se=(ve??[]).some(Pe=>(Pe?.items??[]).length>0),Te=({siges_code:Pe,name:Ye})=>{const Be=String(Pe||"").trim();if(Be)return`code:${Be.toLowerCase()}`;const ze=String(Ye||"").trim().toLowerCase();return ze?`name:${ze}`:""},Me=Pe=>{const Ye=String(Pe??"").trim(),Be=Ye.replace(/\D/g,""),ze=Be.slice(0,3),Ze=ze==="110"?0:ze==="111"?2:1,Ke=Be.length>=4?Be.slice(-4):Be,dt=Ke?Number.parseInt(Ke,10):Number.POSITIVE_INFINITY;return{rank:Ze,last4Num:Number.isFinite(dt)?dt:Number.POSITIVE_INFINITY,raw:Ye}},Ie=(Pe,Ye)=>{const Be=Me(Pe?.siges_code),ze=Me(Ye?.siges_code);if(Be.rank!==ze.rank)return Be.rank-ze.rank;if(Be.last4Num!==ze.last4Num)return Be.last4Num-ze.last4Num;const Ze=String(Be.raw||"").localeCompare(String(ze.raw||""),"es",{numeric:!0,sensitivity:"base"});return Ze!==0?Ze:String(Pe?.name||"").localeCompare(String(Ye?.name||""),"es",{numeric:!0,sensitivity:"base"})},Ve=Pe=>{Pe.sort((Ye,Be)=>{const ze=String(Ye.batch).localeCompare(String(Be.batch));return ze!==0?ze:String(Ye.expiry_date).localeCompare(String(Be.expiry_date))})},Je=Pe=>{const Ye=[],Be=new Map;for(const ze of Pe){const Ze=String(ze.siges_code||"").trim(),Ke=String(ze.name||"").trim(),dt=`${Ze}||${Ke}`.toLowerCase(),Ge=Be.get(dt),Et={id:ze.id,batch:String(ze.batch||"").trim()||"S/N",expiry_date:ze.expiry_date?String(ze.expiry_date).trim():"",stock:Number(ze.stock)||0};if(Ge)Ge.lots.push(Et),Ge.stock+=Et.stock;else{const zt={id:`group:${dt}`,inventory_type:"771",siges_code:Ze,name:Ke,lots:[Et],stock:Et.stock};Be.set(dt,zt),Ye.push(zt)}}for(const ze of Ye)Ve(ze.lots);return Ye};if(J==="771"){const Pe=c.filter(Ze=>String(Ze.inventory_type||"772")==="771"),Ye=Je(Pe),Be=y&&se?Ye.filter(Ze=>{const Ke=String(Ze?.siges_code||"").trim();return Ke?(Qn.get(Ke)||0)>0:!0}):Ye,ze=Z?Be.filter(Ze=>{const Ke=Ze.lots.map(Ge=>`${Ge.batch} ${Ge.expiry_date} ${Ge.stock}`).join(" ");return`${Ze.siges_code} ${Ze.name} ${Ke}`.toLowerCase().includes(Z)}):Be;return ze.sort(Ie),ze}if(J==="total"){const Pe=(()=>{const dt=(ve??[]).slice().sort((Et,zt)=>{const Br=new Date(Et?.created_at||Et?.updated_at||0).getTime();return new Date(zt?.created_at||zt?.updated_at||0).getTime()-Br}).slice(0,4),Ge=new Map;for(const Et of dt)for(const zt of Et?.items??[]){const Br=Pt(zt?.siges_code);if(!Br)continue;const Zr=Number(zt?.quantity)||0;Ge.set(Br,(Ge.get(Br)||0)+Zr)}return Ge})(),Ye=new Map,Be=({siges_code:Ke,name:dt})=>{const Ge=Te({siges_code:Ke,name:dt});if(!Ge)return null;const Et=Ye.get(Ge);if(Et)return Et;const zt={id:`total:${Ge}`,inventory_type:"total",siges_code:String(Ke||"").trim(),name:String(dt||"").trim(),lots:[],stock772:0,stock771:0,stock:0};return Ye.set(Ge,zt),zt};for(const Ke of c){const dt=String(Ke.inventory_type||"772");if(dt!=="771"&&dt!=="772")continue;const Ge=Be({siges_code:Ke.siges_code,name:Ke.name});if(Ge)if(Ge.siges_code||(Ge.siges_code=String(Ke.siges_code||"").trim()),Ge.name||(Ge.name=String(Ke.name||"").trim()),dt==="772")Ge.stock772+=Number(Ke.stock)||0;else{const Et={id:Ke.id,batch:String(Ke.batch||"").trim()||"S/N",expiry_date:Ke.expiry_date?String(Ke.expiry_date).trim():"",stock:Number(Ke.stock)||0};Ge.lots.push(Et),Ge.stock771+=Et.stock}}const ze=Array.from(Ye.values()).map(Ke=>(Ve(Ke.lots),Ke.stock=Ke.stock772+Ke.stock771,Ke)),Ze=b&&se?ze.filter(Ke=>{const dt=String(Ke.siges_code||"").trim();return dt?(Pe.get(dt)||0)>0:!1}):ze;return Z?Ze.filter(Ke=>{const dt=Ke.lots.map(Et=>`${Et.batch} ${Et.expiry_date} ${Et.stock}`).join(" ");return`${Ke.siges_code} ${Ke.name} ${Ke.stock772} ${Ke.stock771} ${Ke.stock} ${dt}`.toLowerCase().includes(Z)}):Ze}const st=c.filter(Pe=>String(Pe.inventory_type||"772")===J),rt=y&&se?st.filter(Pe=>{const Ye=String(Pe?.siges_code||"").trim();return Ye?(Qn.get(Ye)||0)>0:!0}):st,Xe=Z?rt.filter(Pe=>`${Pe.siges_code} ${Pe.name} ${Pe.category} ${Pe.batch} ${Pe.expiry_date} ${Pe.unit}`.toLowerCase().includes(Z)):rt;return Xe.sort(Ie),Xe},[y,b,h,c,g,ve,Qn]),Ln=C?.[String(g||"772")]??1,Ns=Ce.useMemo(()=>{const J=S||50,Z=Math.max(1,Math.ceil(ua.length/J)),Te=(Math.min(Math.max(Ln,1),Z)-1)*J;return ua.slice(Te,Te+J)},[ua,Ln,S]),Aa=Ce.useMemo(()=>{const J=String(g||"772");return J==="total"?ua.length:J!=="771"?c.filter(Z=>String(Z.inventory_type||"772")===J).length:ua.length},[ua,g,c]),es=Ce.useMemo(()=>(ve??[]).some(J=>(J?.items??[]).length>0),[ve]),ts=async()=>{try{te({loading:!0,message:"Sincronizando...",type:"info"});const J=await bt.getTertiaryPackaging?.()??[];ge(J),te({loading:!1,message:`Sincronizado: ${J.length} registros.`,type:"success"}),window.setTimeout(()=>te({loading:!1,message:"",type:""}),4e3)}catch(J){const Z=pt(J);te({loading:!1,message:Z?`${String(J?.message||"No se pudo sincronizar.")}. ${Z}`:J?.message?String(J.message):"No se pudo sincronizar.",type:"error"})}},ko=async J=>{try{te({loading:!0,message:"Guardando...",type:"info"}),await bt.upsertTertiaryPackaging?.([J]);const Z=await bt.getTertiaryPackaging?.()??[];ge(Z),te({loading:!1,message:"Empaque terciario actualizado.",type:"success"}),window.setTimeout(()=>te({loading:!1,message:"",type:""}),2500)}catch(Z){const se=pt(Z);te({loading:!1,message:se?`${String(Z?.message||"No se pudo guardar.")}. ${se}`:Z?.message?String(Z.message):"No se pudo guardar.",type:"error"})}},hl=async()=>{try{Re({loading:!0,message:"Sincronizando...",type:"info"});const J=await bt.getMedicationCategories?.()??[];sr(J),Re({loading:!1,message:`Sincronizado: ${J.length} registros.`,type:"success"}),window.setTimeout(()=>Re({loading:!1,message:"",type:""}),4e3)}catch(J){const Z=$t(J);Re({loading:!1,message:Z?`${String(J?.message||"No se pudo sincronizar.")}. ${Z}`:J?.message?String(J.message):"No se pudo sincronizar.",type:"error"})}},gi=async()=>{try{Vr({loading:!0,message:"Sincronizando...",type:"info"});const J=await bt.getOrderCalendar?.()??[];Qr(J),Vr({loading:!1,message:`Sincronizado: ${J.length} registros.`,type:"success"}),window.setTimeout(()=>Vr({loading:!1,message:"",type:""}),4e3)}catch(J){const Z=Gr(J);Vr({loading:!1,message:Z?`${String(J?.message||"No se pudo sincronizar.")}. ${Z}`:J?.message?String(J.message):"No se pudo sincronizar.",type:"error"})}},rs=async J=>{try{Vr({loading:!0,message:"Guardando...",type:"info"}),await bt.upsertOrderCalendarEntries?.(J);const Z=await bt.getOrderCalendar?.()??[];Qr(Z),Vr({loading:!1,message:"Calendario actualizado.",type:"success"}),window.setTimeout(()=>Vr({loading:!1,message:"",type:""}),2500)}catch(Z){const se=Gr(Z);Vr({loading:!1,message:se?`${String(Z?.message||"No se pudo guardar.")}. ${se}`:Z?.message?String(Z.message):"No se pudo guardar.",type:"error"})}},Ao=async J=>{try{Re({loading:!0,message:"Guardando...",type:"info"}),await bt.upsertMedicationCategories?.([J]);const Z=await bt.getMedicationCategories?.()??[];sr(Z),Re({loading:!1,message:"Categora actualizada.",type:"success"}),window.setTimeout(()=>Re({loading:!1,message:"",type:""}),2500)}catch(Z){const se=$t(Z);Re({loading:!1,message:se?`${String(Z?.message||"No se pudo guardar.")}. ${se}`:Z?.message?String(Z.message):"No se pudo guardar.",type:"error"})}},dl=async J=>{if(!(!J?.id||!window.confirm("Desea eliminar esta categora?")))try{Re({loading:!0,message:"Eliminando...",type:"info"}),await bt.deleteMedicationCategory?.(J.id);const se=await bt.getMedicationCategories?.()??[];sr(se),Re({loading:!1,message:"Categora eliminada.",type:"success"}),window.setTimeout(()=>Re({loading:!1,message:"",type:""}),2500)}catch(se){const Te=$t(se);Re({loading:!1,message:Te?`${String(se?.message||"No se pudo eliminar.")}. ${Te}`:se?.message?String(se.message):"No se pudo eliminar.",type:"error"})}},Os=()=>{const J=[["CODIGO","MEDICAMENTO","EMPAQUE TERCIARIO"],["110-16-0010","PARACETAMOL 500 MG., TABLETAS",200]],Z=ri.aoa_to_sheet(J),se=ri.book_new();ri.book_append_sheet(se,Z,"Empaque"),Uy(se,"empaque_terciario.xlsx")},ml=async()=>{if(window.confirm("Desea eliminar toda la carga de Empaque Terciario? Esta accin no se puede deshacer."))try{te({loading:!0,message:"Eliminando...",type:"info"}),await bt.clearTertiaryPackaging?.(),ge([]),te({loading:!1,message:"Carga eliminada.",type:"success"}),window.setTimeout(()=>te({loading:!1,message:"",type:""}),4e3)}catch(Z){const se=pt(Z);te({loading:!1,message:se?`${String(Z?.message||"No se pudo eliminar la carga.")}. ${se}`:Z?.message?String(Z.message):"No se pudo eliminar la carga.",type:"error"})}},pi=J=>{const Z=J.target.files?.[0];if(!Z)return;te({loading:!0,message:`Procesando: ${Z.name}`,type:"info"});const se=new FileReader;se.onerror=()=>{te({loading:!1,message:"No se pudo leer el archivo.",type:"error"})},se.onload=async Te=>{try{const Me=Te.target?.result,Ie=rf(Me,{type:"array"}),Ve=Ie.SheetNames?.[0];if(!Ve)throw new Error("El XLSX no tiene hojas.");const Je=Ie.Sheets[Ve],st=ri.sheet_to_json(Je,{header:1,raw:!1,blankrows:!1}),rt=Array.isArray(st)?st:[],Pe=(Ze=>{const Ke=zt=>String(zt??"").trim().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]/g,""),dt=Ke(Ze?.[0]),Ge=Ke(Ze?.[1]),Et=Ke(Ze?.[2]);return dt.includes("siges")||dt.includes("codigo")||Ge.includes("medicamento")||Et.includes("cantidad")})(rt?.[0])?rt.slice(1):rt,Ye=new Map((c??[]).map(Ze=>[Pt(Ze.siges_code),String(Ze.name||"").trim()]).filter(([Ze])=>!!Ze)),Be=Pe.map((Ze,Ke)=>{const dt=Pt(Ze?.[0]),Et=String(Ze?.[1]??"").trim()||Ye.get(dt)||"",zt=Gd(Ze?.[2]);return dt?{id:globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():String(Date.now())+Ke,siges_code:dt,medication_name:Et,tertiary_quantity:zt}:null}).filter(Boolean),ze=await bt.upsertTertiaryPackaging?.(Be)??Be;ge(ze),te({loading:!1,message:`Empaque Terciario: ${Be.length} registros importados/actualizados.`,type:"success"}),window.setTimeout(()=>te({loading:!1,message:"",type:""}),4e3)}catch(Me){const Ie=pt(Me);te({loading:!1,message:Ie?`${String(Me?.message||"Error al procesar/guardar el XLSX.")}. ${Ie}`:Me?.message?String(Me.message):"Error al procesar/guardar el XLSX.",type:"error"})}},se.readAsArrayBuffer(Z),J.target.value=null},xi=J=>{const Z=String(J??"").trim();if(!Z)return"";const se=Z.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s+/g," ").trim();return se==="ordinario"?"Ordinario":se==="frio"?"Fro":se==="estupefaciente"?"Estupefaciente":se==="psicotropico"?"Psicotrpico":se==="alcohol"?"Alcohol":se==="suero"?"Suero":se==="compra local"||se==="compralocal"?"Compra Local":""},O=()=>{const J=[["CODIGO","MEDICAMENTO","CATEGORIA"],["110-16-0010","PARACETAMOL 500 MG., TABLETAS","Ordinario"]],Z=ri.aoa_to_sheet(J),se=ri.book_new();ri.book_append_sheet(se,Z,"Categorias"),Uy(se,"categorias.xlsx")},H=async()=>{if(window.confirm("Desea eliminar toda la carga de Categoras? Esta accin no se puede deshacer."))try{Re({loading:!0,message:"Eliminando...",type:"info"}),await bt.clearMedicationCategories?.(),sr([]),Re({loading:!1,message:"Carga eliminada.",type:"success"}),window.setTimeout(()=>Re({loading:!1,message:"",type:""}),4e3)}catch(Z){const se=$t(Z);Re({loading:!1,message:se?`${String(Z?.message||"No se pudo eliminar la carga.")}. ${se}`:Z?.message?String(Z.message):"No se pudo eliminar la carga.",type:"error"})}},F=J=>{const Z=J.target.files?.[0];if(!Z)return;Re({loading:!0,message:`Procesando: ${Z.name}`,type:"info"});const se=new FileReader;se.onerror=()=>{Re({loading:!1,message:"No se pudo leer el archivo.",type:"error"})},se.onload=async Te=>{try{const Me=Te.target?.result,Ie=rf(Me,{type:"array"}),Ve=Ie.SheetNames?.[0];if(!Ve)throw new Error("El XLSX no tiene hojas.");const Je=Ie.Sheets[Ve],st=ri.sheet_to_json(Je,{header:1,raw:!1,blankrows:!1}),rt=Array.isArray(st)?st:[],Pe=(Ze=>{const Ke=zt=>String(zt??"").trim().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]/g,""),dt=Ke(Ze?.[0]),Ge=Ke(Ze?.[1]),Et=Ke(Ze?.[2]);return dt.includes("codigo")||dt.includes("siges")||Ge.includes("medicamento")||Et.includes("categoria")})(rt?.[0])?rt.slice(1):rt,Ye=[];let Be=0;for(let Ze=0;Ze<Pe.length;Ze+=1){const Ke=Pe[Ze],dt=Pt(Ke?.[0]),Ge=String(Ke?.[1]??"").trim(),Et=xi(Ke?.[2]);if(dt){if(!Et){Be+=1;continue}Ye.push({id:globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():String(Date.now())+Ze,siges_code:dt,medication_name:Ge,category:Et})}}const ze=await bt.upsertMedicationCategories?.(Ye)??Ye;sr(ze),Re({loading:!1,message:`Categoras: ${Ye.length} registros importados/actualizados.${Be?` (${Be} filas con categora invlida omitidas)`:""}`,type:"success"}),window.setTimeout(()=>Re({loading:!1,message:"",type:""}),4e3)}catch(Me){const Ie=$t(Me);Re({loading:!1,message:Ie?`${String(Me?.message||"Error al procesar/guardar el XLSX.")}. ${Ie}`:Me?.message?String(Me.message):"Error al procesar/guardar el XLSX.",type:"error"})}},se.readAsArrayBuffer(Z),J.target.value=null},M=Ce.useMemo(()=>{const J=$r.trim().toLowerCase(),Z=(jt??[]).map(se=>({...se,siges_code:Pt(se?.siges_code),medication_name:String(se?.medication_name||"").trim(),category:String(se?.category||"").trim()}));return J?Z.filter(se=>`${se.siges_code} ${se.medication_name} ${se.category}`.toLowerCase().includes(J)):Z},[$r,jt]),B=Ce.useMemo(()=>{const J=It||50,Z=Math.max(1,Math.ceil(M.length/J)),Te=(Math.min(Math.max(Sn,1),Z)-1)*J;return M.slice(Te,Te+J)},[Sn,It,M]),V=Ce.useMemo(()=>{const J=pe.trim().toLowerCase(),Z=(me??[]).map(se=>{const Te=Pt(se?.siges_code),Me=(c??[]).find(Ie=>Pt(Ie.siges_code)===Te)?.name;return{...se,siges_code:Te,medication_name:String(se?.medication_name||Me||"").trim(),tertiary_quantity:Number(se?.tertiary_quantity)||0}});return J?Z.filter(se=>`${se.siges_code} ${se.medication_name}`.toLowerCase().includes(J)):Z},[c,me,pe]),fe=Ce.useMemo(()=>{const J=vt||50,Z=Math.max(1,Math.ceil(V.length/J)),Te=(Math.min(Math.max(et,1),Z)-1)*J;return V.slice(Te,Te+J)},[V,et,vt]),we=()=>{N(null),X(!0)},ce=J=>{N(J),X(!0)},ie=async()=>{const J=await bt.getMedications();u(J??[])},he=async J=>{J.preventDefault();const Z=new FormData(J.target),se={id:D?D.id:globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():Date.now(),inventory_type:D?.inventory_type??String(g||"772"),siges_code:String(Z.get("siges_code")??D?.siges_code??"").trim(),sicop_classifier:String(Z.get("sicop_classifier")??D?.sicop_classifier??"").trim(),sicop_identifier:String(Z.get("sicop_identifier")??D?.sicop_identifier??"").trim(),name:String(Z.get("name")||"").trim(),category:String(Z.get("category")||"").trim(),batch:String(Z.get("batch")||"").trim(),expiry_date:String(Z.get("expiry_date")||"").trim(),stock:Number.parseFloat(String(Z.get("stock")||"0"))||0,min_stock:Number.parseFloat(String(Z.get("min_stock")||"0"))||0,unit:String(Z.get("unit")||"").trim()};try{P({loading:!0,message:"Guardando...",type:"info"}),await bt.upsertMedication(se),await ie(),N(null),X(!1),P({loading:!1,message:"",type:""})}catch(Te){P({loading:!1,message:Te?.message?String(Te.message):"No se pudo guardar el medicamento.",type:"error"})}},Fe=async J=>{try{P({loading:!0,message:"Eliminando...",type:"info"}),await bt.deleteMedication(J),await ie(),P({loading:!1,message:"",type:""})}catch(Z){P({loading:!1,message:Z?.message?String(Z.message):"No se pudo eliminar el medicamento.",type:"error"})}},Le=async()=>{try{P({loading:!0,message:"Eliminando catlogo...",type:"info"}),await bt.clearMedications(),await ie(),P({loading:!1,message:"",type:""})}catch(J){P({loading:!1,message:J?.message?String(J.message):"No se pudo limpiar el catlogo.",type:"error"})}},qe=({siges_code:J,name:Z})=>{const se=String(J||"").trim();if(se)return`code:${se}`;const Te=String(Z||"").trim().toLowerCase();return Te?`name:${Te}`:""},De=J=>{const Z=String(J??"").trim();if(!Z)return 0;const se=Z.replace(/\s/g,""),Te=se.includes(","),Me=se.includes(".");let Ie=se;Te&&Me?Ie=se.replace(/,/g,""):Te&&!Me&&(Ie=se.replace(/,/g,"."));const Ve=Number.parseFloat(Ie);return Number.isFinite(Ve)?Ve:0},$e=J=>{const Z=String(J??"").trim();if(!Z)return null;const se=Z.slice(0,10);if(/^\d{4}-\d{2}-\d{2}$/.test(se))return se;const Te=Z.replace(/\D/g,"");if(Te.length===8){const Ve=Te.slice(0,4),Je=Te.slice(4,6),st=Te.slice(6,8);return`${Ve}-${Je}-${st}`}const Me=Z.match(/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/);if(Me){const Ve=Me[1].padStart(2,"0"),Je=Me[2].padStart(2,"0");return`${Me[3]}-${Je}-${Ve}`}const Ie=new Date(Z);return Number.isNaN(Ie.getTime())?null:Ie.toISOString().slice(0,10)},We=(J,Z,se=[])=>{if(!J)return"";for(const Te of Z){const Me=J.getElementsByTagName(Te)?.[0],Ie=Me?.textContent!=null?String(Me.textContent).trim():"";if(Ie)return Ie}for(const Te of se){const Me=J.getAttribute?.(Te);if(Me!=null&&String(Me).trim())return String(Me).trim()}return""},Yt=J=>{const se=Array.from(J.getElementsByTagNameNS("*","FormattedAreaPair")).filter(Ve=>Ve.getAttribute("Level")==="4"&&Ve.getAttribute("Type")==="Group");if(!se.length)return null;const Te=(Ve,Je)=>{const st=Array.from(Ve.getElementsByTagNameNS("*","FormattedReportObject"));for(const rt of st){const Xe=rt.getAttribute?.("FieldName");if(!Xe||!Je(Xe))continue;const Pe=rt.getElementsByTagNameNS("*","Value")?.[0],Ye=rt.getElementsByTagNameNS("*","FormattedValue")?.[0],ze=((Pe?.textContent!=null?String(Pe.textContent):"")||(Ye?.textContent!=null?String(Ye.textContent):"")).trim();if(ze)return ze}return""},Me=Ve=>Je=>String(Je).includes(Ve),Ie=[];for(const Ve of se){const Je=Te(Ve,Me(".PRODUCTO}")),st=Te(Ve,Me(".DSC_PRODUCTO}")),rt=Pt(Je),Xe=String(st||"").trim();if(!rt||!Xe)continue;const Pe=Array.from(Ve.getElementsByTagNameNS("*","FormattedAreaPair")).filter(Ye=>Ye.getAttribute("Level")==="5"&&Ye.getAttribute("Type")==="Details");for(const Ye of Pe){const Be=Te(Ye,Me(".IDE_LOTE}"))||"S/N",ze=Te(Ye,Me(".CAN_LOTE}"))||"0",Ze=Te(Ye,Me(".FEC_VENCIMIENTO}")),Ke=De(ze),dt=$e(Ze);Ie.push({siges_code:rt,name:Xe,batch:String(Be).trim()||"S/N",expiry_date:dt,stock:Ke})}}return Ie},Jt=J=>{const se=new DOMParser().parseFromString(String(J||""),"application/xml");if(se.querySelector("parsererror"))throw new Error("XML invlido o mal formado.");const Te=Yt(se);if(Array.isArray(Te))return Te;const Me=["CodigoSIGES","CodigoSiges","codigoSIGES","codigoSiges","Codigo","codigo","SIGES","Siges","siges_code"],Ie=["Medicamento","medicamento","Nombre","nombre","Descripcion","descripcion","Medication"],Ve=["Lote","lote","Batch","batch","LoteMedicamento","loteMedicamento"],Je=["Vencimiento","vencimiento","FechaVencimiento","fechaVencimiento","FechaCaducidad","fechaCaducidad","expiry_date","ExpiryDate"],st=["Inventario","inventario","Stock","stock","Existencia","existencia","Cantidad","cantidad"],rt=new Set;for(const Pe of Me){const Ye=se.getElementsByTagName(Pe);for(const Be of Ye){let ze=Be.parentElement,Ze=0;for(;ze&&ze!==se.documentElement&&Ze<6;){const Ke=!!We(ze,Ve,["lote","Lote","batch","Batch"]),dt=!!We(ze,Je,["vencimiento","Vencimiento","expiry","Expiry"]),Ge=!!We(ze,st,["inventario","Inventario","stock","Stock"]);if(Ke||dt||Ge)break;ze=ze.parentElement,Ze+=1}ze&&rt.add(ze)}}const Xe=[];for(const Pe of rt){const Ye=We(Pe,Me,["CodigoSIGES","codigoSIGES","siges_code","Codigo","codigo"]),Be=We(Pe,Ie,["Medicamento","medicamento","Nombre","nombre"]).trim(),ze=We(Pe,Ve,["Lote","lote","Batch","batch"]).trim(),Ze=We(Pe,Je,["Vencimiento","vencimiento","ExpiryDate","expiry_date"]).trim(),Ke=We(Pe,st,["Inventario","inventario","Stock","stock"]).trim();!Ye||!Be||Xe.push({siges_code:Pt(Ye),name:Be||"Sin nombre",batch:ze||"S/N",expiry_date:$e(Ze),stock:De(Ke)})}return Xe},Qt=({siges_code:J,name:Z,batch:se,expiry_date:Te})=>{const Me=String(J||"").trim(),Ie=String(Z||"").trim().toLowerCase(),Ve=String(se||"").trim().toLowerCase(),Je=Te?String(Te).trim():"";return Me?`code:${Me}|lot:${Ve}|exp:${Je}`:`name:${Ie}|lot:${Ve}|exp:${Je}`},Ca=async({text:J})=>{const se=Jt(J),Te=[],Me=new Set;for(const Be of se){const ze=Qt(Be);!ze||Me.has(ze)||(Me.add(ze),Te.push(Be))}const Ve=(await bt.getMedications()??[]).filter(Be=>String(Be.inventory_type||"772")==="771"),Je=new Map(Ve.map(Be=>[Qt(Be),Be.id]).filter(([Be])=>!!Be)),st=Date.now(),rt=Te.map((Be,ze)=>{const Ze=Qt(Be);return{id:Je.get(Ze)??(globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():st+ze),inventory_type:"771",siges_code:Be.siges_code,sicop_classifier:"",sicop_identifier:"",name:Be.name,category:"General",batch:Be.batch||"S/N",expiry_date:Be.expiry_date,stock:Be.stock,min_stock:0,unit:"Unidad"}});await bt.upsertMedications(rt);const Xe=await bt.getMedications()??[],Pe=Xe.filter(Be=>String(Be.inventory_type||"772")==="771").length,Ye=Xe.reduce((Be,ze)=>{const Ze=String(ze.inventory_type||"772");return Be[Ze]=(Be[Ze]||0)+1,Be},{});return await ie(),{importedCount:rt.length,visibleCountForType:Pe,totalCountByType:Ye}},as=J=>{const Z=Ie=>String(Ie??"").trim().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]/g,""),se=Z(J?.[0]),Te=Z(J?.[1]),Me=Z(J?.[2]);return se.includes("siges")||se.includes("codigosiges")||Te.includes("medicamento")||Te.includes("nombre")||Me.includes("inventario")||Me.includes("stock")},Bn=async({text:J,type:Z})=>{const se=String(Z||"772").trim()||"772",Te=sv(J),Me=as(Te?.[0]),Ie=Me?Te.slice(1):Te,Ve=Me?wd(J):null,st=(await bt.getMedications()??[]).filter(Ge=>String(Ge.inventory_type||"772")===se),rt=new Map(st.map(Ge=>[qe(Ge),Ge]).filter(([Ge])=>!!Ge)),Xe=new Map(Array.from(rt.entries()).map(([Ge,Et])=>[Ge,Et.id])),Pe=Date.now(),Ye=(Ie??[]).map((Ge,Et)=>{if(Me)return null;const zt=String(Ge?.[0]??"").trim(),Br=String(Ge?.[1]??"").trim();if(!zt||!Br)return null;const Zr=qe({siges_code:zt,name:Br});if(!Zr)return null;const xl=Xe.get(Zr),Sr=rt.get(Zr);return{id:xl??(globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():Pe+Et),inventory_type:se,siges_code:zt,sicop_classifier:String(Sr?.sicop_classifier||"").trim(),sicop_identifier:String(Sr?.sicop_identifier||"").trim(),name:Br||String(Sr?.name||"").trim()||"Sin nombre",category:String(Sr?.category||"").trim()||"General",batch:String(Sr?.batch||"").trim()||"S/N",expiry_date:String(Sr?.expiry_date||"").trim()||w0(""),stock:De(Ge?.[2]),min_stock:Number(Sr?.min_stock)||0,unit:String(Sr?.unit||"").trim()||"Unidad"}}).filter(Boolean),Be=(Ve??[]).map((Ge,Et)=>{if(!Me)return null;const zt=String(Ge.CodigoSIGES||"").trim(),Br=String(Ge.Medicamento||Ge.Nombre||"").trim(),Zr=qe({siges_code:zt,name:Br});if(!Zr)return null;const xl=Xe.get(Zr),Sr=rt.get(Zr),No=xl??(globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():Pe+Et),yi=String(Ge.ClasificadorSICOP||"").trim(),Tn=String(Ge.IdentificadorSICOP||"").trim(),Oo=String(Ge.Categoria||"").trim(),_i=String(Ge.Lote||"").trim(),Un=String(Ge.Unidad||"").trim(),vl=Ge.Vencimiento,Rs=Ge.StockMinimo,hu=Ge.Stock??Ge.Inventario??Ge.Existencia??Ge.Saldo;return{id:No,inventory_type:se,siges_code:zt,sicop_classifier:yi||String(Sr?.sicop_classifier||"").trim(),sicop_identifier:Tn||String(Sr?.sicop_identifier||"").trim(),name:Br||String(Sr?.name||"").trim()||"Sin nombre",category:Oo||String(Sr?.category||"").trim()||"General",batch:_i||String(Sr?.batch||"").trim()||"S/N",expiry_date:vl?w0(vl):String(Sr?.expiry_date||"").trim()||w0(""),stock:De(hu),min_stock:Rs!=null&&String(Rs).trim()!==""?De(Rs):Number(Sr?.min_stock)||0,unit:Un||String(Sr?.unit||"").trim()||"Unidad"}}).filter(Boolean),ze=Me?Be:Ye;await bt.upsertMedications(ze);const Ze=await bt.getMedications()??[],Ke=Ze.filter(Ge=>String(Ge.inventory_type||"772")===se).length,dt=Ze.reduce((Ge,Et)=>{const zt=String(Et.inventory_type||"772");return Ge[zt]=(Ge[zt]||0)+1,Ge},{});return await ie(),{importedCount:ze.length,visibleCountForType:Ke,totalCountByType:dt}},nn=J=>{const Z=J.target.files?.[0];if(!Z)return;xe({loading:!0,message:"Procesando archivo...",type:"info"});const se=new FileReader;se.onerror=()=>{xe({loading:!1,message:"No se pudo leer el archivo.",type:"error"})},se.onload=async Te=>{try{const Me=String(Te.target?.result||""),Ie=wd(Me),Ve=Date.now(),Je=Ie.map((st,rt)=>({id:globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():Ve+rt,inventory_type:"772",siges_code:String(st.CodigoSIGES||"").trim(),sicop_classifier:String(st.ClasificadorSICOP||"").trim(),sicop_identifier:String(st.IdentificadorSICOP||"").trim(),name:st.Medicamento||st.Nombre||"Sin nombre",category:st.Categoria||"General",batch:st.Lote||"S/N",expiry_date:w0(st.Vencimiento),stock:De(st.Stock),min_stock:De(st.StockMinimo||10),unit:st.Unidad||"Unidad"}));await bt.upsertMedications(Je),await ie(),xe({loading:!1,message:`Se han importado ${Je.length} medicamentos con xito.`,type:"success"}),window.setTimeout(()=>xe({loading:!1,message:"",type:""}),4e3)}catch(Me){const Ie=Me?.message?String(Me.message):"",Je=Ie.includes("invalid input syntax for type integer")?"Tu base de datos en Supabase tiene `stock`/`min_stock` como INTEGER. Ejecuta `supabase/schema.sql` (ALTER COLUMN a NUMERIC) o usa valores enteros.":"";xe({loading:!1,message:Je?`${Ie}. ${Je}`:Ie||"Error al procesar/guardar el CSV.",type:"error"})}},se.readAsText(Z),J.target.value=null},vi=J=>{const Z=J.target.files?.[0];if(!Z)return;xe({loading:!0,message:"Procesando SICOP...",type:"info"});const se=new FileReader;se.onerror=()=>{xe({loading:!1,message:"No se pudo leer el archivo.",type:"error"})},se.onload=async Te=>{try{const Me=String(Te.target?.result||""),Ie=wd(Me),Ve=new Map;for(const rt of Ie??[]){const Xe=String(rt?.CodigoSIGES||"").trim();if(!Xe)continue;const Pe=String(rt?.ClasificadorSICOP||"").trim(),Ye=String(rt?.IdentificadorSICOP||"").trim();!Pe&&!Ye||Ve.set(Xe,{classifier:Pe,identifier:Ye})}if(Ve.size===0){xe({loading:!1,message:"No se encontraron filas con CodigoSIGES y valores SICOP.",type:"error"});return}const st=(await bt.getMedications()??[]).map(rt=>{const Xe=String(rt?.siges_code||"").trim(),Pe=Ve.get(Xe);return Pe?{...rt,sicop_classifier:Pe.classifier||String(rt?.sicop_classifier||"").trim(),sicop_identifier:Pe.identifier||String(rt?.sicop_identifier||"").trim()}:rt});await bt.upsertMedications(st),await ie(),xe({loading:!1,message:`SICOP actualizado para ${Ve.size} cdigos SIGES.`,type:"success"}),window.setTimeout(()=>xe({loading:!1,message:"",type:""}),4e3)}catch(Me){xe({loading:!1,message:Me?.message?String(Me.message):"Error al procesar/guardar el CSV de SICOP.",type:"error"})}},se.readAsText(Z),J.target.value=null},fa=J=>{const Z=String(J||g||"772");if(Z!=="total")return Z==="771"?eT(Z):ZE(Z)},gl=J=>{const Z=J.target.files?.[0];if(!Z)return;const se=String(g||"772");if(se==="total"){K({loading:!1,message:"Inventario total no admite carga de archivos.",type:"error"}),J.target.value=null;return}const Te=String(Z.name||"").toLowerCase(),Me=Te.endsWith(".xml"),Ie=Te.endsWith(".csv");if(se==="771"&&!Me){K({loading:!1,message:"Para inventario 771, selecciona un archivo .xml.",type:"error"}),J.target.value=null;return}if(se!=="771"&&!Ie){K({loading:!1,message:"Para inventario 772, selecciona un archivo .csv.",type:"error"}),J.target.value=null;return}K({loading:!0,message:`Procesando inventario ${se}: ${Z.name}`,type:"info"});const Ve=new FileReader;Ve.onerror=()=>{K({loading:!1,message:"No se pudo leer el archivo.",type:"error"})},Ve.onload=async Je=>{try{const st=String(Je.target?.result||""),rt=se==="771"?await Ca({text:st}):await Bn({text:st,type:se}),Xe=rt?.importedCount??0,Pe=rt?.visibleCountForType??0,Ye=Xe>0&&Pe===0&&A0==="supabase"&&ni?"Import datos pero no se pueden listar. Revisa RLS/policies en Supabase para `medications` (SELECT/ALL para `anon`).":"";K({loading:!1,message:`Inventario ${se}: ${Xe} medicamentos importados/actualizados.${Ye?` ${Ye}`:""}`,type:"success"}),window.setTimeout(()=>K({loading:!1,message:"",type:""}),4e3)}catch(st){const rt=st?.message?String(st.message):"",Pe=rt.includes("invalid input syntax for type integer")?"Tu base de datos en Supabase tiene `stock`/`min_stock` como INTEGER. Ejecuta `supabase/schema.sql` (ALTER COLUMN a NUMERIC) y vuelve a intentar.":"";K({loading:!1,message:Pe?`${rt}. ${Pe}`:rt||`Error al procesar/guardar el ${se==="771"?"XML":"CSV"}.`,type:"error"})}},Ve.readAsText(Z),J.target.value=null},En=async J=>{const Z=String(J||g||"772");if(!(Z==="total"||!window.confirm(`Desea eliminar toda la carga del inventario ${Z}? Esta accin no se puede deshacer.`)))try{K({loading:!0,message:`Eliminando inventario ${Z}...`,type:"info"}),await bt.clearMedicationsByInventoryType?.(Z),await ie(),K({loading:!1,message:`Inventario ${Z} eliminado.`,type:"success"}),window.setTimeout(()=>K({loading:!1,message:"",type:""}),4e3)}catch(Te){K({loading:!1,message:Te?.message?String(Te.message):"No se pudo eliminar el inventario.",type:"error"})}},Na=J=>String(J||"").replace(/\.[^/.]+$/,"").trim()||"Mes sin nombre",fu=J=>{const Z=J.target.files?.[0];if(!Z)return;const se=Na(Z.name);U({loading:!0,message:`Procesando: ${Z.name}`,type:"info"});const Te=new FileReader;Te.onerror=()=>{U({loading:!1,message:"No se pudo leer el archivo.",type:"error"})},Te.onload=async Me=>{try{const Ie=String(Me.target?.result||""),Ve=sv(Ie),Je=Be=>(Be||[]).some(ze=>/codigo|siges|medicamento|consumo|costo/i.test(String(ze||""))),st=Be=>{const ze=String(Be??"").trim();if(!ze)return 0;const Ze=ze.includes(",")&&ze.includes(".")?ze.replace(/,/g,""):ze.includes(",")&&!ze.includes(".")?ze.replace(/,/g,"."):ze,Ke=Number.parseFloat(Ze.replace(/\s+/g,""));return Number.isFinite(Ke)?Ke:0},Xe=(Je(Ve[0])?Ve.slice(1):Ve).map(Be=>{const ze=String(Be?.[0]??"").trim(),Ze=String(Be?.[1]??"").trim(),Ke=st(Be?.[2]),dt=st(Be?.[3]);return!ze||!Ze?null:{id:globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():String(Date.now())+Math.random(),siges_code:ze,medication_name:Ze,quantity:Ke,cost:dt}}).filter(Boolean),Pe=await bt.saveMonthlyBatch({id:globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():String(Date.now()),label:se,items:Xe}),Ye=await bt.getMonthlyBatches();G(Ye??[]),Vt(Pe?.id??null),U({loading:!1,message:`Mes "${se}": ${Xe.length} registros importados.`,type:"success"}),window.setTimeout(()=>U({loading:!1,message:"",type:""}),4e3)}catch(Ie){U({loading:!1,message:Ie?.message?String(Ie.message):"Error al procesar/guardar el CSV.",type:"error"})}},Te.readAsText(Z),J.target.value=null},Co=async()=>{try{U({loading:!0,message:"Sincronizando consumos...",type:"info"});const Z=(await bt.getMonthlyBatches()??[]).map(Je=>({...Je,id:Je?.id!=null?String(Je.id):Je.id}));G(Z);const se=A!=null?String(A):null,Me=se&&Z.some(Je=>Je.id===se)?se:Z?.[0]?.id??null;Vt(Me);const Ie=A0==="supabase"&&ni?`supabase${k0?` (${k0})`:""}`:`local${ni?" (Supabase disponible pero no seleccionado)":" (Supabase no configurado)"}`,Ve=Z.length===0&&A0==="supabase"&&ni?"Si en Supabase ves meses cargados, revisa RLS/policies para `anon` (SELECT en `monthly_batches`).":Z.length===0?"Si tus consumos estn en Supabase, configura `VITE_SUPABASE_URL` y `VITE_SUPABASE_ANON_KEY` y usa `VITE_DATA_PROVIDER=supabase`.":"";U({loading:!1,message:`Sincronizado (${Ie}): ${Z.length} meses encontrados.${Ve?` ${Ve}`:""}`,type:"success"}),window.setTimeout(()=>U({loading:!1,message:"",type:""}),4e3)}catch(J){U({loading:!1,message:J?.message?String(J.message):"No se pudieron sincronizar los consumos.",type:"error"})}},pl=async()=>{try{K({loading:!0,message:"Sincronizando inventarios...",type:"info"});const J=await bt.getMedications()??[];u(J);const Z=J.reduce((Te,Me)=>{const Ie=String(Me.inventory_type||"772");return Te[Ie]=(Te[Ie]||0)+1,Te},{771:0,772:0}),se=A0==="supabase"&&ni?`supabase${k0?` (${k0})`:""}`:"local";K({loading:!1,message:`Sincronizado (${se}): 771=${Z[771]||0}, 772=${Z[772]||0}.`,type:"success"}),window.setTimeout(()=>K({loading:!1,message:"",type:""}),4e3)}catch(J){K({loading:!1,message:J?.message?String(J.message):"No se pudieron sincronizar los inventarios.",type:"error"})}};return v.jsxs("div",{className:"flex h-screen bg-slate-50 font-sans text-slate-900 overflow-hidden",children:[v.jsx(AE,{activeTab:r,isSidebarOpen:s,onSelectTab:a,onToggleSidebar:()=>l(J=>!J)}),v.jsxs("main",{className:"flex-1 overflow-y-auto p-8",children:[v.jsx(EE,{activeTab:r,onNewMedication:we}),W.message&&v.jsxs("div",{className:`mb-6 p-3 rounded-lg text-xs flex items-center justify-between gap-3 ${W.type==="error"?"bg-red-50 text-red-700 border border-red-100":"bg-blue-50 text-blue-700 border border-blue-100"}`,children:[v.jsx("span",{children:W.message}),v.jsx("button",{type:"button",onClick:()=>P({loading:!1,message:"",type:""}),className:"text-[11px] font-bold hover:underline",children:"Cerrar"})]}),r==="catalog"&&v.jsx(NE,{medications:c,excelStatus:Q,fileInputRef:re,sicopFileInputRef:ae,onChooseFile:()=>re.current?.click(),onChooseSicopFile:()=>ae.current?.click(),onDownloadTemplate:JE,onFileChange:nn,onSicopFileChange:vi,onEditMedication:ce,onDeleteMedication:Fe,onClearCatalog:Le}),r==="dashboard"&&v.jsx(ME,{stats:fl,consumptions:ve[0]?.items||[],lowStockItems:Zn,medicationCategories:jt,onViewAllConsumptions:()=>a("consumption-monthly")}),r==="inventory"&&v.jsx(jE,{inventoryType:g,onInventoryTypeChange:J=>{x(J),d(""),T(Z=>({...Z,[String(J||"772")]:1})),K({loading:!1,message:"",type:""})},inventoryStatus:Ae,fileInputRef:Oe,onChooseFile:()=>Oe.current?.click(),onFileChange:gl,onDownloadTemplate:fa,onRefresh:pl,canClear:String(g||"772")!=="total"&&Aa>0,onClearInventory:En,hideNoMovement:b,canToggleHideNoMovement:es,onToggleHideNoMovement:()=>{w(J=>!J),T(J=>({...J,total:1}))},hideNoMovement4m:y,canToggleHideNoMovement4m:es,onToggleHideNoMovement4m:()=>{_(J=>!J),T(J=>({...J,[String(g||"772")]:1}))},search:h,onSearchChange:J=>{d(J),T(Z=>({...Z,[String(g||"772")]:1}))},items:Ns,totalItems:ua.length,page:Ln,pageSize:S,onPageChange:J=>{const Z=Math.max(1,Math.ceil(ua.length/(S||1))),se=Math.min(Math.max(Number(J)||1,1),Z);T(Te=>({...Te,[String(g||"772")]:se}))},onPageSizeChange:J=>{k(J),T(Z=>({...Z,[String(g||"772")]:1}))}}),r==="inventory-take"&&v.jsx(IE,{medications:c}),r==="consumption-monthly"&&v.jsx(BE,{months:ve,selectedMonthId:A,onSelectMonth:Vt,monthlyStatus:je,fileInputRef:le,onChooseFile:()=>le.current?.click(),onFileChange:fu,onDownloadTemplate:QE,onRefresh:Co}),r==="consumption-summary"&&v.jsx(FE,{months:ve,onRefresh:Co,status:je}),r==="order-request"&&v.jsx(zE,{medications:c,months:ve,tertiaryPackaging:me,medicationCategories:jt,inventoryStatus:Ae,monthlyStatus:je,onRefreshInventories:pl,onRefreshConsumptions:Co}),r==="calendar"&&v.jsx(qE,{status:za,entries:hr,onRefresh:gi,onSave:rs}),r==="tertiary-packaging"&&v.jsx(HE,{status:L,fileInputRef:I,onChooseFile:()=>I.current?.click(),onFileChange:pi,onDownloadTemplate:Os,onRefresh:ts,canClear:(me??[]).length>0,onClear:ml,onEdit:ko,search:pe,onSearchChange:J=>{Ee(J),q(1)},items:fe,totalItems:V.length,page:et,pageSize:vt,onPageChange:J=>{const Z=Math.max(1,Math.ceil(V.length/(vt||1))),se=Math.min(Math.max(Number(J)||1,1),Z);q(se)},onPageSizeChange:J=>{nt(J),q(1)}}),r==="categories"&&v.jsx($E,{status:gt,fileInputRef:kt,onChooseFile:()=>kt.current?.click(),onFileChange:F,onDownloadTemplate:O,onRefresh:hl,canClear:(jt??[]).length>0,onClear:H,onEdit:Ao,onDelete:dl,search:$r,onSearchChange:J=>{wa(J),ka(1)},items:B,totalItems:M.length,page:Sn,pageSize:It,onPageChange:J=>{const Z=Math.max(1,Math.ceil(M.length/(It||1))),se=Math.min(Math.max(Number(J)||1,1),Z);ka(se)},onPageSizeChange:J=>{Pa(J),ka(1)}}),r==="alerts"&&v.jsx(CE,{lowStockItems:Zn,onEditMedication:ce})]}),j&&v.jsx(SE,{editingMed:D,onClose:()=>X(!1),onSubmit:he})]})}function zM(){return v.jsx(PM,{})}FS.createRoot(document.getElementById("root")).render(v.jsx(Ce.StrictMode,{children:v.jsx(zM,{})}));
